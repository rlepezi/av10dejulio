(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();var Y_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nv(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Z_={exports:{}},xt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ku=Symbol.for("react.element"),TT=Symbol.for("react.portal"),PT=Symbol.for("react.fragment"),RT=Symbol.for("react.strict_mode"),DT=Symbol.for("react.profiler"),LT=Symbol.for("react.provider"),MT=Symbol.for("react.context"),VT=Symbol.for("react.forward_ref"),OT=Symbol.for("react.suspense"),jT=Symbol.for("react.memo"),FT=Symbol.for("react.lazy"),JE=Symbol.iterator;function zT(a){return a===null||typeof a!="object"?null:(a=JE&&a[JE]||a["@@iterator"],typeof a=="function"?a:null)}var X_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},e1=Object.assign,t1={};function Ul(a,e,n){this.props=a,this.context=e,this.refs=t1,this.updater=n||X_}Ul.prototype.isReactComponent={};Ul.prototype.setState=function(a,e){if(typeof a!="object"&&typeof a!="function"&&a!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,a,e,"setState")};Ul.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,"forceUpdate")};function a1(){}a1.prototype=Ul.prototype;function rv(a,e,n){this.props=a,this.context=e,this.refs=t1,this.updater=n||X_}var sv=rv.prototype=new a1;sv.constructor=rv;e1(sv,Ul.prototype);sv.isPureReactComponent=!0;var YE=Array.isArray,n1=Object.prototype.hasOwnProperty,ov={current:null},r1={key:!0,ref:!0,__self:!0,__source:!0};function s1(a,e,n){var r,s={},o=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)n1.call(e,r)&&!r1.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(a&&a.defaultProps)for(r in l=a.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Ku,type:a,key:o,ref:i,props:s,_owner:ov.current}}function UT(a,e){return{$$typeof:Ku,type:a.type,key:e,ref:a.ref,props:a.props,_owner:a._owner}}function iv(a){return typeof a=="object"&&a!==null&&a.$$typeof===Ku}function $T(a){var e={"=":"=0",":":"=2"};return"$"+a.replace(/[=:]/g,function(n){return e[n]})}var ZE=/\/+/g;function mf(a,e){return typeof a=="object"&&a!==null&&a.key!=null?$T(""+a.key):e.toString(36)}function wm(a,e,n,r,s){var o=typeof a;(o==="undefined"||o==="boolean")&&(a=null);var i=!1;if(a===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(a.$$typeof){case Ku:case TT:i=!0}}if(i)return i=a,s=s(i),a=r===""?"."+mf(i,0):r,YE(s)?(n="",a!=null&&(n=a.replace(ZE,"$&/")+"/"),wm(s,e,n,"",function(u){return u})):s!=null&&(iv(s)&&(s=UT(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(ZE,"$&/")+"/")+a)),e.push(s)),1;if(i=0,r=r===""?".":r+":",YE(a))for(var l=0;l<a.length;l++){o=a[l];var c=r+mf(o,l);i+=wm(o,e,n,c,s)}else if(c=zT(a),typeof c=="function")for(a=c.call(a),l=0;!(o=a.next()).done;)o=o.value,c=r+mf(o,l++),i+=wm(o,e,n,c,s);else if(o==="object")throw e=String(a),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Wd(a,e,n){if(a==null)return a;var r=[],s=0;return wm(a,r,"","",function(o){return e.call(n,o,s++)}),r}function BT(a){if(a._status===-1){var e=a._result;e=e(),e.then(function(n){(a._status===0||a._status===-1)&&(a._status=1,a._result=n)},function(n){(a._status===0||a._status===-1)&&(a._status=2,a._result=n)}),a._status===-1&&(a._status=0,a._result=e)}if(a._status===1)return a._result.default;throw a._result}var ln={current:null},_m={transition:null},qT={ReactCurrentDispatcher:ln,ReactCurrentBatchConfig:_m,ReactCurrentOwner:ov};function o1(){throw Error("act(...) is not supported in production builds of React.")}xt.Children={map:Wd,forEach:function(a,e,n){Wd(a,function(){e.apply(this,arguments)},n)},count:function(a){var e=0;return Wd(a,function(){e++}),e},toArray:function(a){return Wd(a,function(e){return e})||[]},only:function(a){if(!iv(a))throw Error("React.Children.only expected to receive a single React element child.");return a}};xt.Component=Ul;xt.Fragment=PT;xt.Profiler=DT;xt.PureComponent=rv;xt.StrictMode=RT;xt.Suspense=OT;xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qT;xt.act=o1;xt.cloneElement=function(a,e,n){if(a==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+a+".");var r=e1({},a.props),s=a.key,o=a.ref,i=a._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=ov.current),e.key!==void 0&&(s=""+e.key),a.type&&a.type.defaultProps)var l=a.type.defaultProps;for(c in e)n1.call(e,c)&&!r1.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Ku,type:a.type,key:s,ref:o,props:r,_owner:i}};xt.createContext=function(a){return a={$$typeof:MT,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},a.Provider={$$typeof:LT,_context:a},a.Consumer=a};xt.createElement=s1;xt.createFactory=function(a){var e=s1.bind(null,a);return e.type=a,e};xt.createRef=function(){return{current:null}};xt.forwardRef=function(a){return{$$typeof:VT,render:a}};xt.isValidElement=iv;xt.lazy=function(a){return{$$typeof:FT,_payload:{_status:-1,_result:a},_init:BT}};xt.memo=function(a,e){return{$$typeof:jT,type:a,compare:e===void 0?null:e}};xt.startTransition=function(a){var e=_m.transition;_m.transition={};try{a()}finally{_m.transition=e}};xt.unstable_act=o1;xt.useCallback=function(a,e){return ln.current.useCallback(a,e)};xt.useContext=function(a){return ln.current.useContext(a)};xt.useDebugValue=function(){};xt.useDeferredValue=function(a){return ln.current.useDeferredValue(a)};xt.useEffect=function(a,e){return ln.current.useEffect(a,e)};xt.useId=function(){return ln.current.useId()};xt.useImperativeHandle=function(a,e,n){return ln.current.useImperativeHandle(a,e,n)};xt.useInsertionEffect=function(a,e){return ln.current.useInsertionEffect(a,e)};xt.useLayoutEffect=function(a,e){return ln.current.useLayoutEffect(a,e)};xt.useMemo=function(a,e){return ln.current.useMemo(a,e)};xt.useReducer=function(a,e,n){return ln.current.useReducer(a,e,n)};xt.useRef=function(a){return ln.current.useRef(a)};xt.useState=function(a){return ln.current.useState(a)};xt.useSyncExternalStore=function(a,e,n){return ln.current.useSyncExternalStore(a,e,n)};xt.useTransition=function(){return ln.current.useTransition()};xt.version="18.3.1";Z_.exports=xt;var p=Z_.exports;const t=nv(p);var yh={},i1={exports:{}},In={},l1={exports:{}},c1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(a){function e(j,U){var Q=j.length;j.push(U);e:for(;0<Q;){var te=Q-1>>>1,se=j[te];if(0<s(se,U))j[te]=U,j[Q]=se,Q=te;else break e}}function n(j){return j.length===0?null:j[0]}function r(j){if(j.length===0)return null;var U=j[0],Q=j.pop();if(Q!==U){j[0]=Q;e:for(var te=0,se=j.length,X=se>>>1;te<X;){var ye=2*(te+1)-1,Y=j[ye],Se=ye+1,de=j[Se];if(0>s(Y,Q))Se<se&&0>s(de,Y)?(j[te]=de,j[Se]=Q,te=Se):(j[te]=Y,j[ye]=Q,te=ye);else if(Se<se&&0>s(de,Q))j[te]=de,j[Se]=Q,te=Se;else break e}}return U}function s(j,U){var Q=j.sortIndex-U.sortIndex;return Q!==0?Q:j.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;a.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();a.unstable_now=function(){return i.now()-l}}var c=[],u=[],d=1,m=null,h=3,C=!1,S=!1,w=!1,f=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(j){for(var U=n(u);U!==null;){if(U.callback===null)r(u);else if(U.startTime<=j)r(u),U.sortIndex=U.expirationTime,e(c,U);else break;U=n(u)}}function A(j){if(w=!1,I(j),!S)if(n(c)!==null)S=!0,V(N);else{var U=n(u);U!==null&&z(A,U.startTime-j)}}function N(j,U){S=!1,w&&(w=!1,b(E),E=-1),C=!0;var Q=h;try{for(I(U),m=n(c);m!==null&&(!(m.expirationTime>U)||j&&!k());){var te=m.callback;if(typeof te=="function"){m.callback=null,h=m.priorityLevel;var se=te(m.expirationTime<=U);U=a.unstable_now(),typeof se=="function"?m.callback=se:m===n(c)&&r(c),I(U)}else r(c);m=n(c)}if(m!==null)var X=!0;else{var ye=n(u);ye!==null&&z(A,ye.startTime-U),X=!1}return X}finally{m=null,h=Q,C=!1}}var x=!1,y=null,E=-1,_=5,P=-1;function k(){return!(a.unstable_now()-P<_)}function D(){if(y!==null){var j=a.unstable_now();P=j;var U=!0;try{U=y(!0,j)}finally{U?M():(x=!1,y=null)}}else x=!1}var M;if(typeof v=="function")M=function(){v(D)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,q=$.port2;$.port1.onmessage=D,M=function(){q.postMessage(null)}}else M=function(){f(D,0)};function V(j){y=j,x||(x=!0,M())}function z(j,U){E=f(function(){j(a.unstable_now())},U)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(j){j.callback=null},a.unstable_continueExecution=function(){S||C||(S=!0,V(N))},a.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<j?Math.floor(1e3/j):5},a.unstable_getCurrentPriorityLevel=function(){return h},a.unstable_getFirstCallbackNode=function(){return n(c)},a.unstable_next=function(j){switch(h){case 1:case 2:case 3:var U=3;break;default:U=h}var Q=h;h=U;try{return j()}finally{h=Q}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=function(){},a.unstable_runWithPriority=function(j,U){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var Q=h;h=j;try{return U()}finally{h=Q}},a.unstable_scheduleCallback=function(j,U,Q){var te=a.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?te+Q:te):Q=te,j){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=Q+se,j={id:d++,callback:U,priorityLevel:j,startTime:Q,expirationTime:se,sortIndex:-1},Q>te?(j.sortIndex=Q,e(u,j),n(c)===null&&j===n(u)&&(w?(b(E),E=-1):w=!0,z(A,Q-te))):(j.sortIndex=se,e(c,j),S||C||(S=!0,V(N))),j},a.unstable_shouldYield=k,a.unstable_wrapCallback=function(j){var U=h;return function(){var Q=h;h=U;try{return j.apply(this,arguments)}finally{h=Q}}}})(c1);l1.exports=c1;var WT=l1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GT=p,Sn=WT;function Ce(a){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+a,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+a+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u1=new Set,du={};function di(a,e){gl(a,e),gl(a+"Capture",e)}function gl(a,e){for(du[a]=e,a=0;a<e.length;a++)u1.add(e[a])}var Gr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nh=Object.prototype.hasOwnProperty,HT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,XE={},ex={};function KT(a){return Nh.call(ex,a)?!0:Nh.call(XE,a)?!1:HT.test(a)?ex[a]=!0:(XE[a]=!0,!1)}function QT(a,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function JT(a,e,n,r){if(e===null||typeof e>"u"||QT(a,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function cn(a,e,n,r,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=a,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var Ua={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){Ua[a]=new cn(a,0,!1,a,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var e=a[0];Ua[e]=new cn(e,1,!1,a[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(a){Ua[a]=new cn(a,2,!1,a.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){Ua[a]=new cn(a,2,!1,a,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){Ua[a]=new cn(a,3,!1,a.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(a){Ua[a]=new cn(a,3,!0,a,null,!1,!1)});["capture","download"].forEach(function(a){Ua[a]=new cn(a,4,!1,a,null,!1,!1)});["cols","rows","size","span"].forEach(function(a){Ua[a]=new cn(a,6,!1,a,null,!1,!1)});["rowSpan","start"].forEach(function(a){Ua[a]=new cn(a,5,!1,a.toLowerCase(),null,!1,!1)});var lv=/[\-:]([a-z])/g;function cv(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var e=a.replace(lv,cv);Ua[e]=new cn(e,1,!1,a,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var e=a.replace(lv,cv);Ua[e]=new cn(e,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(a){var e=a.replace(lv,cv);Ua[e]=new cn(e,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(a){Ua[a]=new cn(a,1,!1,a.toLowerCase(),null,!1,!1)});Ua.xlinkHref=new cn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(a){Ua[a]=new cn(a,1,!1,a.toLowerCase(),null,!0,!0)});function uv(a,e,n,r){var s=Ua.hasOwnProperty(e)?Ua[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(JT(e,n,s,r)&&(n=null),r||s===null?KT(e)&&(n===null?a.removeAttribute(e):a.setAttribute(e,""+n)):s.mustUseProperty?a[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?a.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?a.setAttributeNS(r,e,n):a.setAttribute(e,n))))}var as=GT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Gd=Symbol.for("react.element"),zi=Symbol.for("react.portal"),Ui=Symbol.for("react.fragment"),dv=Symbol.for("react.strict_mode"),wh=Symbol.for("react.profiler"),d1=Symbol.for("react.provider"),m1=Symbol.for("react.context"),mv=Symbol.for("react.forward_ref"),_h=Symbol.for("react.suspense"),Ch=Symbol.for("react.suspense_list"),pv=Symbol.for("react.memo"),xs=Symbol.for("react.lazy"),p1=Symbol.for("react.offscreen"),tx=Symbol.iterator;function vc(a){return a===null||typeof a!="object"?null:(a=tx&&a[tx]||a["@@iterator"],typeof a=="function"?a:null)}var ia=Object.assign,pf;function Vc(a){if(pf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);pf=e&&e[1]||""}return`
`+pf+a}var gf=!1;function ff(a,e){if(!a||gf)return"";gf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(a,[],e)}else{try{e.call()}catch(u){r=u}a.call(e.prototype)}else{try{throw Error()}catch(u){r=u}a()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,l=o.length-1;1<=i&&0<=l&&s[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==o[l]){if(i!==1||l!==1)do if(i--,l--,0>l||s[i]!==o[l]){var c=`
`+s[i].replace(" at new "," at ");return a.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",a.displayName)),c}while(1<=i&&0<=l);break}}}finally{gf=!1,Error.prepareStackTrace=n}return(a=a?a.displayName||a.name:"")?Vc(a):""}function YT(a){switch(a.tag){case 5:return Vc(a.type);case 16:return Vc("Lazy");case 13:return Vc("Suspense");case 19:return Vc("SuspenseList");case 0:case 2:case 15:return a=ff(a.type,!1),a;case 11:return a=ff(a.type.render,!1),a;case 1:return a=ff(a.type,!0),a;default:return""}}function Sh(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case Ui:return"Fragment";case zi:return"Portal";case wh:return"Profiler";case dv:return"StrictMode";case _h:return"Suspense";case Ch:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case m1:return(a.displayName||"Context")+".Consumer";case d1:return(a._context.displayName||"Context")+".Provider";case mv:var e=a.render;return a=a.displayName,a||(a=e.displayName||e.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case pv:return e=a.displayName||null,e!==null?e:Sh(a.type)||"Memo";case xs:e=a._payload,a=a._init;try{return Sh(a(e))}catch{}}return null}function ZT(a){var e=a.type;switch(a.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=e.render,a=a.displayName||a.name||"",e.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Sh(e);case 8:return e===dv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Gs(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function g1(a){var e=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function XT(a){var e=g1(a)?"checked":"value",n=Object.getOwnPropertyDescriptor(a.constructor.prototype,e),r=""+a[e];if(!a.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(a,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(a,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){a._valueTracker=null,delete a[e]}}}}function Hd(a){a._valueTracker||(a._valueTracker=XT(a))}function f1(a){if(!a)return!1;var e=a._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return a&&(r=g1(a)?a.checked?"true":"false":a.value),a=r,a!==n?(e.setValue(a),!0):!1}function Jm(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function kh(a,e){var n=e.checked;return ia({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??a._wrapperState.initialChecked})}function ax(a,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Gs(e.value!=null?e.value:n),a._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function h1(a,e){e=e.checked,e!=null&&uv(a,"checked",e,!1)}function Ih(a,e){h1(a,e);var n=Gs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&a.value===""||a.value!=n)&&(a.value=""+n):a.value!==""+n&&(a.value=""+n);else if(r==="submit"||r==="reset"){a.removeAttribute("value");return}e.hasOwnProperty("value")?Ah(a,e.type,n):e.hasOwnProperty("defaultValue")&&Ah(a,e.type,Gs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(a.defaultChecked=!!e.defaultChecked)}function nx(a,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+a._wrapperState.initialValue,n||e===a.value||(a.value=e),a.defaultValue=e}n=a.name,n!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,n!==""&&(a.name=n)}function Ah(a,e,n){(e!=="number"||Jm(a.ownerDocument)!==a)&&(n==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+n&&(a.defaultValue=""+n))}var Oc=Array.isArray;function tl(a,e,n,r){if(a=a.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<a.length;n++)s=e.hasOwnProperty("$"+a[n].value),a[n].selected!==s&&(a[n].selected=s),s&&r&&(a[n].defaultSelected=!0)}else{for(n=""+Gs(n),e=null,s=0;s<a.length;s++){if(a[s].value===n){a[s].selected=!0,r&&(a[s].defaultSelected=!0);return}e!==null||a[s].disabled||(e=a[s])}e!==null&&(e.selected=!0)}}function Th(a,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ce(91));return ia({},e,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function rx(a,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Ce(92));if(Oc(n)){if(1<n.length)throw Error(Ce(93));n=n[0]}e=n}e==null&&(e=""),n=e}a._wrapperState={initialValue:Gs(n)}}function v1(a,e){var n=Gs(e.value),r=Gs(e.defaultValue);n!=null&&(n=""+n,n!==a.value&&(a.value=n),e.defaultValue==null&&a.defaultValue!==n&&(a.defaultValue=n)),r!=null&&(a.defaultValue=""+r)}function sx(a){var e=a.textContent;e===a._wrapperState.initialValue&&e!==""&&e!==null&&(a.value=e)}function b1(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ph(a,e){return a==null||a==="http://www.w3.org/1999/xhtml"?b1(e):a==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Kd,E1=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return a(e,n,r,s)})}:a}(function(a,e){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=e;else{for(Kd=Kd||document.createElement("div"),Kd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Kd.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;e.firstChild;)a.appendChild(e.firstChild)}});function mu(a,e){if(e){var n=a.firstChild;if(n&&n===a.lastChild&&n.nodeType===3){n.nodeValue=e;return}}a.textContent=e}var Gc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eP=["Webkit","ms","Moz","O"];Object.keys(Gc).forEach(function(a){eP.forEach(function(e){e=e+a.charAt(0).toUpperCase()+a.substring(1),Gc[e]=Gc[a]})});function x1(a,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Gc.hasOwnProperty(a)&&Gc[a]?(""+e).trim():e+"px"}function y1(a,e){a=a.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=x1(n,e[n],r);n==="float"&&(n="cssFloat"),r?a.setProperty(n,s):a[n]=s}}var tP=ia({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rh(a,e){if(e){if(tP[a]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ce(137,a));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ce(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ce(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ce(62))}}function Dh(a,e){if(a.indexOf("-")===-1)return typeof e.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lh=null;function gv(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Mh=null,al=null,nl=null;function ox(a){if(a=Yu(a)){if(typeof Mh!="function")throw Error(Ce(280));var e=a.stateNode;e&&(e=og(e),Mh(a.stateNode,a.type,e))}}function N1(a){al?nl?nl.push(a):nl=[a]:al=a}function w1(){if(al){var a=al,e=nl;if(nl=al=null,ox(a),e)for(a=0;a<e.length;a++)ox(e[a])}}function _1(a,e){return a(e)}function C1(){}var hf=!1;function S1(a,e,n){if(hf)return a(e,n);hf=!0;try{return _1(a,e,n)}finally{hf=!1,(al!==null||nl!==null)&&(C1(),w1())}}function pu(a,e){var n=a.stateNode;if(n===null)return null;var r=og(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(a=a.type,r=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!r;break e;default:a=!1}if(a)return null;if(n&&typeof n!="function")throw Error(Ce(231,e,typeof n));return n}var Vh=!1;if(Gr)try{var bc={};Object.defineProperty(bc,"passive",{get:function(){Vh=!0}}),window.addEventListener("test",bc,bc),window.removeEventListener("test",bc,bc)}catch{Vh=!1}function aP(a,e,n,r,s,o,i,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Hc=!1,Ym=null,Zm=!1,Oh=null,nP={onError:function(a){Hc=!0,Ym=a}};function rP(a,e,n,r,s,o,i,l,c){Hc=!1,Ym=null,aP.apply(nP,arguments)}function sP(a,e,n,r,s,o,i,l,c){if(rP.apply(this,arguments),Hc){if(Hc){var u=Ym;Hc=!1,Ym=null}else throw Error(Ce(198));Zm||(Zm=!0,Oh=u)}}function mi(a){var e=a,n=a;if(a.alternate)for(;e.return;)e=e.return;else{a=e;do e=a,e.flags&4098&&(n=e.return),a=e.return;while(a)}return e.tag===3?n:null}function k1(a){if(a.tag===13){var e=a.memoizedState;if(e===null&&(a=a.alternate,a!==null&&(e=a.memoizedState)),e!==null)return e.dehydrated}return null}function ix(a){if(mi(a)!==a)throw Error(Ce(188))}function oP(a){var e=a.alternate;if(!e){if(e=mi(a),e===null)throw Error(Ce(188));return e!==a?null:a}for(var n=a,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return ix(s),a;if(o===r)return ix(s),e;o=o.sibling}throw Error(Ce(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,l=s.child;l;){if(l===n){i=!0,n=s,r=o;break}if(l===r){i=!0,r=s,n=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===n){i=!0,n=o,r=s;break}if(l===r){i=!0,r=o,n=s;break}l=l.sibling}if(!i)throw Error(Ce(189))}}if(n.alternate!==r)throw Error(Ce(190))}if(n.tag!==3)throw Error(Ce(188));return n.stateNode.current===n?a:e}function I1(a){return a=oP(a),a!==null?A1(a):null}function A1(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var e=A1(a);if(e!==null)return e;a=a.sibling}return null}var T1=Sn.unstable_scheduleCallback,lx=Sn.unstable_cancelCallback,iP=Sn.unstable_shouldYield,lP=Sn.unstable_requestPaint,ga=Sn.unstable_now,cP=Sn.unstable_getCurrentPriorityLevel,fv=Sn.unstable_ImmediatePriority,P1=Sn.unstable_UserBlockingPriority,Xm=Sn.unstable_NormalPriority,uP=Sn.unstable_LowPriority,R1=Sn.unstable_IdlePriority,ag=null,xr=null;function dP(a){if(xr&&typeof xr.onCommitFiberRoot=="function")try{xr.onCommitFiberRoot(ag,a,void 0,(a.current.flags&128)===128)}catch{}}var Zn=Math.clz32?Math.clz32:gP,mP=Math.log,pP=Math.LN2;function gP(a){return a>>>=0,a===0?32:31-(mP(a)/pP|0)|0}var Qd=64,Jd=4194304;function jc(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function ep(a,e){var n=a.pendingLanes;if(n===0)return 0;var r=0,s=a.suspendedLanes,o=a.pingedLanes,i=n&268435455;if(i!==0){var l=i&~s;l!==0?r=jc(l):(o&=i,o!==0&&(r=jc(o)))}else i=n&~s,i!==0?r=jc(i):o!==0&&(r=jc(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=a.entangledLanes,e!==0)for(a=a.entanglements,e&=r;0<e;)n=31-Zn(e),s=1<<n,r|=a[n],e&=~s;return r}function fP(a,e){switch(a){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hP(a,e){for(var n=a.suspendedLanes,r=a.pingedLanes,s=a.expirationTimes,o=a.pendingLanes;0<o;){var i=31-Zn(o),l=1<<i,c=s[i];c===-1?(!(l&n)||l&r)&&(s[i]=fP(l,e)):c<=e&&(a.expiredLanes|=l),o&=~l}}function jh(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function D1(){var a=Qd;return Qd<<=1,!(Qd&4194240)&&(Qd=64),a}function vf(a){for(var e=[],n=0;31>n;n++)e.push(a);return e}function Qu(a,e,n){a.pendingLanes|=e,e!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,e=31-Zn(e),a[e]=n}function vP(a,e){var n=a.pendingLanes&~e;a.pendingLanes=e,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=e,a.mutableReadLanes&=e,a.entangledLanes&=e,e=a.entanglements;var r=a.eventTimes;for(a=a.expirationTimes;0<n;){var s=31-Zn(n),o=1<<s;e[s]=0,r[s]=-1,a[s]=-1,n&=~o}}function hv(a,e){var n=a.entangledLanes|=e;for(a=a.entanglements;n;){var r=31-Zn(n),s=1<<r;s&e|a[r]&e&&(a[r]|=e),n&=~s}}var Mt=0;function L1(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var M1,vv,V1,O1,j1,Fh=!1,Yd=[],Vs=null,Os=null,js=null,gu=new Map,fu=new Map,ws=[],bP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cx(a,e){switch(a){case"focusin":case"focusout":Vs=null;break;case"dragenter":case"dragleave":Os=null;break;case"mouseover":case"mouseout":js=null;break;case"pointerover":case"pointerout":gu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fu.delete(e.pointerId)}}function Ec(a,e,n,r,s,o){return a===null||a.nativeEvent!==o?(a={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=Yu(e),e!==null&&vv(e)),a):(a.eventSystemFlags|=r,e=a.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),a)}function EP(a,e,n,r,s){switch(e){case"focusin":return Vs=Ec(Vs,a,e,n,r,s),!0;case"dragenter":return Os=Ec(Os,a,e,n,r,s),!0;case"mouseover":return js=Ec(js,a,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return gu.set(o,Ec(gu.get(o)||null,a,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,fu.set(o,Ec(fu.get(o)||null,a,e,n,r,s)),!0}return!1}function F1(a){var e=Do(a.target);if(e!==null){var n=mi(e);if(n!==null){if(e=n.tag,e===13){if(e=k1(n),e!==null){a.blockedOn=e,j1(a.priority,function(){V1(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){a.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Cm(a){if(a.blockedOn!==null)return!1;for(var e=a.targetContainers;0<e.length;){var n=zh(a.domEventName,a.eventSystemFlags,e[0],a.nativeEvent);if(n===null){n=a.nativeEvent;var r=new n.constructor(n.type,n);Lh=r,n.target.dispatchEvent(r),Lh=null}else return e=Yu(n),e!==null&&vv(e),a.blockedOn=n,!1;e.shift()}return!0}function ux(a,e,n){Cm(a)&&n.delete(e)}function xP(){Fh=!1,Vs!==null&&Cm(Vs)&&(Vs=null),Os!==null&&Cm(Os)&&(Os=null),js!==null&&Cm(js)&&(js=null),gu.forEach(ux),fu.forEach(ux)}function xc(a,e){a.blockedOn===e&&(a.blockedOn=null,Fh||(Fh=!0,Sn.unstable_scheduleCallback(Sn.unstable_NormalPriority,xP)))}function hu(a){function e(s){return xc(s,a)}if(0<Yd.length){xc(Yd[0],a);for(var n=1;n<Yd.length;n++){var r=Yd[n];r.blockedOn===a&&(r.blockedOn=null)}}for(Vs!==null&&xc(Vs,a),Os!==null&&xc(Os,a),js!==null&&xc(js,a),gu.forEach(e),fu.forEach(e),n=0;n<ws.length;n++)r=ws[n],r.blockedOn===a&&(r.blockedOn=null);for(;0<ws.length&&(n=ws[0],n.blockedOn===null);)F1(n),n.blockedOn===null&&ws.shift()}var rl=as.ReactCurrentBatchConfig,tp=!0;function yP(a,e,n,r){var s=Mt,o=rl.transition;rl.transition=null;try{Mt=1,bv(a,e,n,r)}finally{Mt=s,rl.transition=o}}function NP(a,e,n,r){var s=Mt,o=rl.transition;rl.transition=null;try{Mt=4,bv(a,e,n,r)}finally{Mt=s,rl.transition=o}}function bv(a,e,n,r){if(tp){var s=zh(a,e,n,r);if(s===null)kf(a,e,r,ap,n),cx(a,r);else if(EP(s,a,e,n,r))r.stopPropagation();else if(cx(a,r),e&4&&-1<bP.indexOf(a)){for(;s!==null;){var o=Yu(s);if(o!==null&&M1(o),o=zh(a,e,n,r),o===null&&kf(a,e,r,ap,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else kf(a,e,r,null,n)}}var ap=null;function zh(a,e,n,r){if(ap=null,a=gv(r),a=Do(a),a!==null)if(e=mi(a),e===null)a=null;else if(n=e.tag,n===13){if(a=k1(e),a!==null)return a;a=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;a=null}else e!==a&&(a=null);return ap=a,null}function z1(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cP()){case fv:return 1;case P1:return 4;case Xm:case uP:return 16;case R1:return 536870912;default:return 16}default:return 16}}var Ds=null,Ev=null,Sm=null;function U1(){if(Sm)return Sm;var a,e=Ev,n=e.length,r,s="value"in Ds?Ds.value:Ds.textContent,o=s.length;for(a=0;a<n&&e[a]===s[a];a++);var i=n-a;for(r=1;r<=i&&e[n-r]===s[o-r];r++);return Sm=s.slice(a,1<r?1-r:void 0)}function km(a){var e=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&e===13&&(a=13)):a=e,a===10&&(a=13),32<=a||a===13?a:0}function Zd(){return!0}function dx(){return!1}function An(a){function e(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var l in a)a.hasOwnProperty(l)&&(n=a[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Zd:dx,this.isPropagationStopped=dx,this}return ia(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Zd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Zd)},persist:function(){},isPersistent:Zd}),e}var $l={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xv=An($l),Ju=ia({},$l,{view:0,detail:0}),wP=An(Ju),bf,Ef,yc,ng=ia({},Ju,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yv,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==yc&&(yc&&a.type==="mousemove"?(bf=a.screenX-yc.screenX,Ef=a.screenY-yc.screenY):Ef=bf=0,yc=a),bf)},movementY:function(a){return"movementY"in a?a.movementY:Ef}}),mx=An(ng),_P=ia({},ng,{dataTransfer:0}),CP=An(_P),SP=ia({},Ju,{relatedTarget:0}),xf=An(SP),kP=ia({},$l,{animationName:0,elapsedTime:0,pseudoElement:0}),IP=An(kP),AP=ia({},$l,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),TP=An(AP),PP=ia({},$l,{data:0}),px=An(PP),RP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},DP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},LP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function MP(a){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(a):(a=LP[a])?!!e[a]:!1}function yv(){return MP}var VP=ia({},Ju,{key:function(a){if(a.key){var e=RP[a.key]||a.key;if(e!=="Unidentified")return e}return a.type==="keypress"?(a=km(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?DP[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yv,charCode:function(a){return a.type==="keypress"?km(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?km(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),OP=An(VP),jP=ia({},ng,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gx=An(jP),FP=ia({},Ju,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yv}),zP=An(FP),UP=ia({},$l,{propertyName:0,elapsedTime:0,pseudoElement:0}),$P=An(UP),BP=ia({},ng,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),qP=An(BP),WP=[9,13,27,32],Nv=Gr&&"CompositionEvent"in window,Kc=null;Gr&&"documentMode"in document&&(Kc=document.documentMode);var GP=Gr&&"TextEvent"in window&&!Kc,$1=Gr&&(!Nv||Kc&&8<Kc&&11>=Kc),fx=String.fromCharCode(32),hx=!1;function B1(a,e){switch(a){case"keyup":return WP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function q1(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var $i=!1;function HP(a,e){switch(a){case"compositionend":return q1(e);case"keypress":return e.which!==32?null:(hx=!0,fx);case"textInput":return a=e.data,a===fx&&hx?null:a;default:return null}}function KP(a,e){if($i)return a==="compositionend"||!Nv&&B1(a,e)?(a=U1(),Sm=Ev=Ds=null,$i=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $1&&e.locale!=="ko"?null:e.data;default:return null}}var QP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vx(a){var e=a&&a.nodeName&&a.nodeName.toLowerCase();return e==="input"?!!QP[a.type]:e==="textarea"}function W1(a,e,n,r){N1(r),e=np(e,"onChange"),0<e.length&&(n=new xv("onChange","change",null,n,r),a.push({event:n,listeners:e}))}var Qc=null,vu=null;function JP(a){a2(a,0)}function rg(a){var e=Wi(a);if(f1(e))return a}function YP(a,e){if(a==="change")return e}var G1=!1;if(Gr){var yf;if(Gr){var Nf="oninput"in document;if(!Nf){var bx=document.createElement("div");bx.setAttribute("oninput","return;"),Nf=typeof bx.oninput=="function"}yf=Nf}else yf=!1;G1=yf&&(!document.documentMode||9<document.documentMode)}function Ex(){Qc&&(Qc.detachEvent("onpropertychange",H1),vu=Qc=null)}function H1(a){if(a.propertyName==="value"&&rg(vu)){var e=[];W1(e,vu,a,gv(a)),S1(JP,e)}}function ZP(a,e,n){a==="focusin"?(Ex(),Qc=e,vu=n,Qc.attachEvent("onpropertychange",H1)):a==="focusout"&&Ex()}function XP(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return rg(vu)}function eR(a,e){if(a==="click")return rg(e)}function tR(a,e){if(a==="input"||a==="change")return rg(e)}function aR(a,e){return a===e&&(a!==0||1/a===1/e)||a!==a&&e!==e}var tr=typeof Object.is=="function"?Object.is:aR;function bu(a,e){if(tr(a,e))return!0;if(typeof a!="object"||a===null||typeof e!="object"||e===null)return!1;var n=Object.keys(a),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Nh.call(e,s)||!tr(a[s],e[s]))return!1}return!0}function xx(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function yx(a,e){var n=xx(a);a=0;for(var r;n;){if(n.nodeType===3){if(r=a+n.textContent.length,a<=e&&r>=e)return{node:n,offset:e-a};a=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=xx(n)}}function K1(a,e){return a&&e?a===e?!0:a&&a.nodeType===3?!1:e&&e.nodeType===3?K1(a,e.parentNode):"contains"in a?a.contains(e):a.compareDocumentPosition?!!(a.compareDocumentPosition(e)&16):!1:!1}function Q1(){for(var a=window,e=Jm();e instanceof a.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)a=e.contentWindow;else break;e=Jm(a.document)}return e}function wv(a){var e=a&&a.nodeName&&a.nodeName.toLowerCase();return e&&(e==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||e==="textarea"||a.contentEditable==="true")}function nR(a){var e=Q1(),n=a.focusedElem,r=a.selectionRange;if(e!==n&&n&&n.ownerDocument&&K1(n.ownerDocument.documentElement,n)){if(r!==null&&wv(n)){if(e=r.start,a=r.end,a===void 0&&(a=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(a,n.value.length);else if(a=(e=n.ownerDocument||document)&&e.defaultView||window,a.getSelection){a=a.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!a.extend&&o>r&&(s=r,r=o,o=s),s=yx(n,o);var i=yx(n,r);s&&i&&(a.rangeCount!==1||a.anchorNode!==s.node||a.anchorOffset!==s.offset||a.focusNode!==i.node||a.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),a.removeAllRanges(),o>r?(a.addRange(e),a.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),a.addRange(e)))}}for(e=[],a=n;a=a.parentNode;)a.nodeType===1&&e.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)a=e[n],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var rR=Gr&&"documentMode"in document&&11>=document.documentMode,Bi=null,Uh=null,Jc=null,$h=!1;function Nx(a,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;$h||Bi==null||Bi!==Jm(r)||(r=Bi,"selectionStart"in r&&wv(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Jc&&bu(Jc,r)||(Jc=r,r=np(Uh,"onSelect"),0<r.length&&(e=new xv("onSelect","select",null,e,n),a.push({event:e,listeners:r}),e.target=Bi)))}function Xd(a,e){var n={};return n[a.toLowerCase()]=e.toLowerCase(),n["Webkit"+a]="webkit"+e,n["Moz"+a]="moz"+e,n}var qi={animationend:Xd("Animation","AnimationEnd"),animationiteration:Xd("Animation","AnimationIteration"),animationstart:Xd("Animation","AnimationStart"),transitionend:Xd("Transition","TransitionEnd")},wf={},J1={};Gr&&(J1=document.createElement("div").style,"AnimationEvent"in window||(delete qi.animationend.animation,delete qi.animationiteration.animation,delete qi.animationstart.animation),"TransitionEvent"in window||delete qi.transitionend.transition);function sg(a){if(wf[a])return wf[a];if(!qi[a])return a;var e=qi[a],n;for(n in e)if(e.hasOwnProperty(n)&&n in J1)return wf[a]=e[n];return a}var Y1=sg("animationend"),Z1=sg("animationiteration"),X1=sg("animationstart"),e2=sg("transitionend"),t2=new Map,wx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function no(a,e){t2.set(a,e),di(e,[a])}for(var _f=0;_f<wx.length;_f++){var Cf=wx[_f],sR=Cf.toLowerCase(),oR=Cf[0].toUpperCase()+Cf.slice(1);no(sR,"on"+oR)}no(Y1,"onAnimationEnd");no(Z1,"onAnimationIteration");no(X1,"onAnimationStart");no("dblclick","onDoubleClick");no("focusin","onFocus");no("focusout","onBlur");no(e2,"onTransitionEnd");gl("onMouseEnter",["mouseout","mouseover"]);gl("onMouseLeave",["mouseout","mouseover"]);gl("onPointerEnter",["pointerout","pointerover"]);gl("onPointerLeave",["pointerout","pointerover"]);di("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));di("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));di("onBeforeInput",["compositionend","keypress","textInput","paste"]);di("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));di("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));di("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iR=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fc));function _x(a,e,n){var r=a.type||"unknown-event";a.currentTarget=n,sP(r,e,void 0,a),a.currentTarget=null}function a2(a,e){e=(e&4)!==0;for(var n=0;n<a.length;n++){var r=a[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var i=r.length-1;0<=i;i--){var l=r[i],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==o&&s.isPropagationStopped())break e;_x(s,l,u),o=c}else for(i=0;i<r.length;i++){if(l=r[i],c=l.instance,u=l.currentTarget,l=l.listener,c!==o&&s.isPropagationStopped())break e;_x(s,l,u),o=c}}}if(Zm)throw a=Oh,Zm=!1,Oh=null,a}function Wt(a,e){var n=e[Hh];n===void 0&&(n=e[Hh]=new Set);var r=a+"__bubble";n.has(r)||(n2(e,a,2,!1),n.add(r))}function Sf(a,e,n){var r=0;e&&(r|=4),n2(n,a,r,e)}var em="_reactListening"+Math.random().toString(36).slice(2);function Eu(a){if(!a[em]){a[em]=!0,u1.forEach(function(n){n!=="selectionchange"&&(iR.has(n)||Sf(n,!1,a),Sf(n,!0,a))});var e=a.nodeType===9?a:a.ownerDocument;e===null||e[em]||(e[em]=!0,Sf("selectionchange",!1,e))}}function n2(a,e,n,r){switch(z1(e)){case 1:var s=yP;break;case 4:s=NP;break;default:s=bv}n=s.bind(null,e,n,a),s=void 0,!Vh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?a.addEventListener(e,n,{capture:!0,passive:s}):a.addEventListener(e,n,!0):s!==void 0?a.addEventListener(e,n,{passive:s}):a.addEventListener(e,n,!1)}function kf(a,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;l!==null;){if(i=Do(l),i===null)return;if(c=i.tag,c===5||c===6){r=o=i;continue e}l=l.parentNode}}r=r.return}S1(function(){var u=o,d=gv(n),m=[];e:{var h=t2.get(a);if(h!==void 0){var C=xv,S=a;switch(a){case"keypress":if(km(n)===0)break e;case"keydown":case"keyup":C=OP;break;case"focusin":S="focus",C=xf;break;case"focusout":S="blur",C=xf;break;case"beforeblur":case"afterblur":C=xf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=mx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=CP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=zP;break;case Y1:case Z1:case X1:C=IP;break;case e2:C=$P;break;case"scroll":C=wP;break;case"wheel":C=qP;break;case"copy":case"cut":case"paste":C=TP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=gx}var w=(e&4)!==0,f=!w&&a==="scroll",b=w?h!==null?h+"Capture":null:h;w=[];for(var v=u,I;v!==null;){I=v;var A=I.stateNode;if(I.tag===5&&A!==null&&(I=A,b!==null&&(A=pu(v,b),A!=null&&w.push(xu(v,A,I)))),f)break;v=v.return}0<w.length&&(h=new C(h,S,null,n,d),m.push({event:h,listeners:w}))}}if(!(e&7)){e:{if(h=a==="mouseover"||a==="pointerover",C=a==="mouseout"||a==="pointerout",h&&n!==Lh&&(S=n.relatedTarget||n.fromElement)&&(Do(S)||S[Hr]))break e;if((C||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,C?(S=n.relatedTarget||n.toElement,C=u,S=S?Do(S):null,S!==null&&(f=mi(S),S!==f||S.tag!==5&&S.tag!==6)&&(S=null)):(C=null,S=u),C!==S)){if(w=mx,A="onMouseLeave",b="onMouseEnter",v="mouse",(a==="pointerout"||a==="pointerover")&&(w=gx,A="onPointerLeave",b="onPointerEnter",v="pointer"),f=C==null?h:Wi(C),I=S==null?h:Wi(S),h=new w(A,v+"leave",C,n,d),h.target=f,h.relatedTarget=I,A=null,Do(d)===u&&(w=new w(b,v+"enter",S,n,d),w.target=I,w.relatedTarget=f,A=w),f=A,C&&S)t:{for(w=C,b=S,v=0,I=w;I;I=Ai(I))v++;for(I=0,A=b;A;A=Ai(A))I++;for(;0<v-I;)w=Ai(w),v--;for(;0<I-v;)b=Ai(b),I--;for(;v--;){if(w===b||b!==null&&w===b.alternate)break t;w=Ai(w),b=Ai(b)}w=null}else w=null;C!==null&&Cx(m,h,C,w,!1),S!==null&&f!==null&&Cx(m,f,S,w,!0)}}e:{if(h=u?Wi(u):window,C=h.nodeName&&h.nodeName.toLowerCase(),C==="select"||C==="input"&&h.type==="file")var N=YP;else if(vx(h))if(G1)N=tR;else{N=XP;var x=ZP}else(C=h.nodeName)&&C.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(N=eR);if(N&&(N=N(a,u))){W1(m,N,n,d);break e}x&&x(a,h,u),a==="focusout"&&(x=h._wrapperState)&&x.controlled&&h.type==="number"&&Ah(h,"number",h.value)}switch(x=u?Wi(u):window,a){case"focusin":(vx(x)||x.contentEditable==="true")&&(Bi=x,Uh=u,Jc=null);break;case"focusout":Jc=Uh=Bi=null;break;case"mousedown":$h=!0;break;case"contextmenu":case"mouseup":case"dragend":$h=!1,Nx(m,n,d);break;case"selectionchange":if(rR)break;case"keydown":case"keyup":Nx(m,n,d)}var y;if(Nv)e:{switch(a){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else $i?B1(a,n)&&(E="onCompositionEnd"):a==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&($1&&n.locale!=="ko"&&($i||E!=="onCompositionStart"?E==="onCompositionEnd"&&$i&&(y=U1()):(Ds=d,Ev="value"in Ds?Ds.value:Ds.textContent,$i=!0)),x=np(u,E),0<x.length&&(E=new px(E,a,null,n,d),m.push({event:E,listeners:x}),y?E.data=y:(y=q1(n),y!==null&&(E.data=y)))),(y=GP?HP(a,n):KP(a,n))&&(u=np(u,"onBeforeInput"),0<u.length&&(d=new px("onBeforeInput","beforeinput",null,n,d),m.push({event:d,listeners:u}),d.data=y))}a2(m,e)})}function xu(a,e,n){return{instance:a,listener:e,currentTarget:n}}function np(a,e){for(var n=e+"Capture",r=[];a!==null;){var s=a,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=pu(a,n),o!=null&&r.unshift(xu(a,o,s)),o=pu(a,e),o!=null&&r.push(xu(a,o,s))),a=a.return}return r}function Ai(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function Cx(a,e,n,r,s){for(var o=e._reactName,i=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=pu(n,o),c!=null&&i.unshift(xu(n,c,l))):s||(c=pu(n,o),c!=null&&i.push(xu(n,c,l)))),n=n.return}i.length!==0&&a.push({event:e,listeners:i})}var lR=/\r\n?/g,cR=/\u0000|\uFFFD/g;function Sx(a){return(typeof a=="string"?a:""+a).replace(lR,`
`).replace(cR,"")}function tm(a,e,n){if(e=Sx(e),Sx(a)!==e&&n)throw Error(Ce(425))}function rp(){}var Bh=null,qh=null;function Wh(a,e){return a==="textarea"||a==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Gh=typeof setTimeout=="function"?setTimeout:void 0,uR=typeof clearTimeout=="function"?clearTimeout:void 0,kx=typeof Promise=="function"?Promise:void 0,dR=typeof queueMicrotask=="function"?queueMicrotask:typeof kx<"u"?function(a){return kx.resolve(null).then(a).catch(mR)}:Gh;function mR(a){setTimeout(function(){throw a})}function If(a,e){var n=e,r=0;do{var s=n.nextSibling;if(a.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){a.removeChild(s),hu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);hu(e)}function Fs(a){for(;a!=null;a=a.nextSibling){var e=a.nodeType;if(e===1||e===3)break;if(e===8){if(e=a.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return a}function Ix(a){a=a.previousSibling;for(var e=0;a;){if(a.nodeType===8){var n=a.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return a;e--}else n==="/$"&&e++}a=a.previousSibling}return null}var Bl=Math.random().toString(36).slice(2),hr="__reactFiber$"+Bl,yu="__reactProps$"+Bl,Hr="__reactContainer$"+Bl,Hh="__reactEvents$"+Bl,pR="__reactListeners$"+Bl,gR="__reactHandles$"+Bl;function Do(a){var e=a[hr];if(e)return e;for(var n=a.parentNode;n;){if(e=n[Hr]||n[hr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(a=Ix(a);a!==null;){if(n=a[hr])return n;a=Ix(a)}return e}a=n,n=a.parentNode}return null}function Yu(a){return a=a[hr]||a[Hr],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function Wi(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(Ce(33))}function og(a){return a[yu]||null}var Kh=[],Gi=-1;function ro(a){return{current:a}}function Ht(a){0>Gi||(a.current=Kh[Gi],Kh[Gi]=null,Gi--)}function Bt(a,e){Gi++,Kh[Gi]=a.current,a.current=e}var Hs={},Xa=ro(Hs),fn=ro(!1),qo=Hs;function fl(a,e){var n=a.type.contextTypes;if(!n)return Hs;var r=a.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=s),s}function hn(a){return a=a.childContextTypes,a!=null}function sp(){Ht(fn),Ht(Xa)}function Ax(a,e,n){if(Xa.current!==Hs)throw Error(Ce(168));Bt(Xa,e),Bt(fn,n)}function r2(a,e,n){var r=a.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Ce(108,ZT(a)||"Unknown",s));return ia({},n,r)}function op(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Hs,qo=Xa.current,Bt(Xa,a),Bt(fn,fn.current),!0}function Tx(a,e,n){var r=a.stateNode;if(!r)throw Error(Ce(169));n?(a=r2(a,e,qo),r.__reactInternalMemoizedMergedChildContext=a,Ht(fn),Ht(Xa),Bt(Xa,a)):Ht(fn),Bt(fn,n)}var Vr=null,ig=!1,Af=!1;function s2(a){Vr===null?Vr=[a]:Vr.push(a)}function fR(a){ig=!0,s2(a)}function so(){if(!Af&&Vr!==null){Af=!0;var a=0,e=Mt;try{var n=Vr;for(Mt=1;a<n.length;a++){var r=n[a];do r=r(!0);while(r!==null)}Vr=null,ig=!1}catch(s){throw Vr!==null&&(Vr=Vr.slice(a+1)),T1(fv,so),s}finally{Mt=e,Af=!1}}return null}var Hi=[],Ki=0,ip=null,lp=0,Rn=[],Dn=0,Wo=null,Or=1,jr="";function _o(a,e){Hi[Ki++]=lp,Hi[Ki++]=ip,ip=a,lp=e}function o2(a,e,n){Rn[Dn++]=Or,Rn[Dn++]=jr,Rn[Dn++]=Wo,Wo=a;var r=Or;a=jr;var s=32-Zn(r)-1;r&=~(1<<s),n+=1;var o=32-Zn(e)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,Or=1<<32-Zn(e)+s|n<<s|r,jr=o+a}else Or=1<<o|n<<s|r,jr=a}function _v(a){a.return!==null&&(_o(a,1),o2(a,1,0))}function Cv(a){for(;a===ip;)ip=Hi[--Ki],Hi[Ki]=null,lp=Hi[--Ki],Hi[Ki]=null;for(;a===Wo;)Wo=Rn[--Dn],Rn[Dn]=null,jr=Rn[--Dn],Rn[Dn]=null,Or=Rn[--Dn],Rn[Dn]=null}var Cn=null,wn=null,Jt=!1,Jn=null;function i2(a,e){var n=Ln(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=a,e=a.deletions,e===null?(a.deletions=[n],a.flags|=16):e.push(n)}function Px(a,e){switch(a.tag){case 5:var n=a.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(a.stateNode=e,Cn=a,wn=Fs(e.firstChild),!0):!1;case 6:return e=a.pendingProps===""||e.nodeType!==3?null:e,e!==null?(a.stateNode=e,Cn=a,wn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Wo!==null?{id:Or,overflow:jr}:null,a.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ln(18,null,null,0),n.stateNode=e,n.return=a,a.child=n,Cn=a,wn=null,!0):!1;default:return!1}}function Qh(a){return(a.mode&1)!==0&&(a.flags&128)===0}function Jh(a){if(Jt){var e=wn;if(e){var n=e;if(!Px(a,e)){if(Qh(a))throw Error(Ce(418));e=Fs(n.nextSibling);var r=Cn;e&&Px(a,e)?i2(r,n):(a.flags=a.flags&-4097|2,Jt=!1,Cn=a)}}else{if(Qh(a))throw Error(Ce(418));a.flags=a.flags&-4097|2,Jt=!1,Cn=a}}}function Rx(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Cn=a}function am(a){if(a!==Cn)return!1;if(!Jt)return Rx(a),Jt=!0,!1;var e;if((e=a.tag!==3)&&!(e=a.tag!==5)&&(e=a.type,e=e!=="head"&&e!=="body"&&!Wh(a.type,a.memoizedProps)),e&&(e=wn)){if(Qh(a))throw l2(),Error(Ce(418));for(;e;)i2(a,e),e=Fs(e.nextSibling)}if(Rx(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Ce(317));e:{for(a=a.nextSibling,e=0;a;){if(a.nodeType===8){var n=a.data;if(n==="/$"){if(e===0){wn=Fs(a.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}a=a.nextSibling}wn=null}}else wn=Cn?Fs(a.stateNode.nextSibling):null;return!0}function l2(){for(var a=wn;a;)a=Fs(a.nextSibling)}function hl(){wn=Cn=null,Jt=!1}function Sv(a){Jn===null?Jn=[a]:Jn.push(a)}var hR=as.ReactCurrentBatchConfig;function Nc(a,e,n){if(a=n.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Ce(309));var r=n.stateNode}if(!r)throw Error(Ce(147,a));var s=r,o=""+a;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var l=s.refs;i===null?delete l[o]:l[o]=i},e._stringRef=o,e)}if(typeof a!="string")throw Error(Ce(284));if(!n._owner)throw Error(Ce(290,a))}return a}function nm(a,e){throw a=Object.prototype.toString.call(e),Error(Ce(31,a==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":a))}function Dx(a){var e=a._init;return e(a._payload)}function c2(a){function e(b,v){if(a){var I=b.deletions;I===null?(b.deletions=[v],b.flags|=16):I.push(v)}}function n(b,v){if(!a)return null;for(;v!==null;)e(b,v),v=v.sibling;return null}function r(b,v){for(b=new Map;v!==null;)v.key!==null?b.set(v.key,v):b.set(v.index,v),v=v.sibling;return b}function s(b,v){return b=Bs(b,v),b.index=0,b.sibling=null,b}function o(b,v,I){return b.index=I,a?(I=b.alternate,I!==null?(I=I.index,I<v?(b.flags|=2,v):I):(b.flags|=2,v)):(b.flags|=1048576,v)}function i(b){return a&&b.alternate===null&&(b.flags|=2),b}function l(b,v,I,A){return v===null||v.tag!==6?(v=Vf(I,b.mode,A),v.return=b,v):(v=s(v,I),v.return=b,v)}function c(b,v,I,A){var N=I.type;return N===Ui?d(b,v,I.props.children,A,I.key):v!==null&&(v.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===xs&&Dx(N)===v.type)?(A=s(v,I.props),A.ref=Nc(b,v,I),A.return=b,A):(A=Lm(I.type,I.key,I.props,null,b.mode,A),A.ref=Nc(b,v,I),A.return=b,A)}function u(b,v,I,A){return v===null||v.tag!==4||v.stateNode.containerInfo!==I.containerInfo||v.stateNode.implementation!==I.implementation?(v=Of(I,b.mode,A),v.return=b,v):(v=s(v,I.children||[]),v.return=b,v)}function d(b,v,I,A,N){return v===null||v.tag!==7?(v=zo(I,b.mode,A,N),v.return=b,v):(v=s(v,I),v.return=b,v)}function m(b,v,I){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Vf(""+v,b.mode,I),v.return=b,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Gd:return I=Lm(v.type,v.key,v.props,null,b.mode,I),I.ref=Nc(b,null,v),I.return=b,I;case zi:return v=Of(v,b.mode,I),v.return=b,v;case xs:var A=v._init;return m(b,A(v._payload),I)}if(Oc(v)||vc(v))return v=zo(v,b.mode,I,null),v.return=b,v;nm(b,v)}return null}function h(b,v,I,A){var N=v!==null?v.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return N!==null?null:l(b,v,""+I,A);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Gd:return I.key===N?c(b,v,I,A):null;case zi:return I.key===N?u(b,v,I,A):null;case xs:return N=I._init,h(b,v,N(I._payload),A)}if(Oc(I)||vc(I))return N!==null?null:d(b,v,I,A,null);nm(b,I)}return null}function C(b,v,I,A,N){if(typeof A=="string"&&A!==""||typeof A=="number")return b=b.get(I)||null,l(v,b,""+A,N);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Gd:return b=b.get(A.key===null?I:A.key)||null,c(v,b,A,N);case zi:return b=b.get(A.key===null?I:A.key)||null,u(v,b,A,N);case xs:var x=A._init;return C(b,v,I,x(A._payload),N)}if(Oc(A)||vc(A))return b=b.get(I)||null,d(v,b,A,N,null);nm(v,A)}return null}function S(b,v,I,A){for(var N=null,x=null,y=v,E=v=0,_=null;y!==null&&E<I.length;E++){y.index>E?(_=y,y=null):_=y.sibling;var P=h(b,y,I[E],A);if(P===null){y===null&&(y=_);break}a&&y&&P.alternate===null&&e(b,y),v=o(P,v,E),x===null?N=P:x.sibling=P,x=P,y=_}if(E===I.length)return n(b,y),Jt&&_o(b,E),N;if(y===null){for(;E<I.length;E++)y=m(b,I[E],A),y!==null&&(v=o(y,v,E),x===null?N=y:x.sibling=y,x=y);return Jt&&_o(b,E),N}for(y=r(b,y);E<I.length;E++)_=C(y,b,E,I[E],A),_!==null&&(a&&_.alternate!==null&&y.delete(_.key===null?E:_.key),v=o(_,v,E),x===null?N=_:x.sibling=_,x=_);return a&&y.forEach(function(k){return e(b,k)}),Jt&&_o(b,E),N}function w(b,v,I,A){var N=vc(I);if(typeof N!="function")throw Error(Ce(150));if(I=N.call(I),I==null)throw Error(Ce(151));for(var x=N=null,y=v,E=v=0,_=null,P=I.next();y!==null&&!P.done;E++,P=I.next()){y.index>E?(_=y,y=null):_=y.sibling;var k=h(b,y,P.value,A);if(k===null){y===null&&(y=_);break}a&&y&&k.alternate===null&&e(b,y),v=o(k,v,E),x===null?N=k:x.sibling=k,x=k,y=_}if(P.done)return n(b,y),Jt&&_o(b,E),N;if(y===null){for(;!P.done;E++,P=I.next())P=m(b,P.value,A),P!==null&&(v=o(P,v,E),x===null?N=P:x.sibling=P,x=P);return Jt&&_o(b,E),N}for(y=r(b,y);!P.done;E++,P=I.next())P=C(y,b,E,P.value,A),P!==null&&(a&&P.alternate!==null&&y.delete(P.key===null?E:P.key),v=o(P,v,E),x===null?N=P:x.sibling=P,x=P);return a&&y.forEach(function(D){return e(b,D)}),Jt&&_o(b,E),N}function f(b,v,I,A){if(typeof I=="object"&&I!==null&&I.type===Ui&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case Gd:e:{for(var N=I.key,x=v;x!==null;){if(x.key===N){if(N=I.type,N===Ui){if(x.tag===7){n(b,x.sibling),v=s(x,I.props.children),v.return=b,b=v;break e}}else if(x.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===xs&&Dx(N)===x.type){n(b,x.sibling),v=s(x,I.props),v.ref=Nc(b,x,I),v.return=b,b=v;break e}n(b,x);break}else e(b,x);x=x.sibling}I.type===Ui?(v=zo(I.props.children,b.mode,A,I.key),v.return=b,b=v):(A=Lm(I.type,I.key,I.props,null,b.mode,A),A.ref=Nc(b,v,I),A.return=b,b=A)}return i(b);case zi:e:{for(x=I.key;v!==null;){if(v.key===x)if(v.tag===4&&v.stateNode.containerInfo===I.containerInfo&&v.stateNode.implementation===I.implementation){n(b,v.sibling),v=s(v,I.children||[]),v.return=b,b=v;break e}else{n(b,v);break}else e(b,v);v=v.sibling}v=Of(I,b.mode,A),v.return=b,b=v}return i(b);case xs:return x=I._init,f(b,v,x(I._payload),A)}if(Oc(I))return S(b,v,I,A);if(vc(I))return w(b,v,I,A);nm(b,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,v!==null&&v.tag===6?(n(b,v.sibling),v=s(v,I),v.return=b,b=v):(n(b,v),v=Vf(I,b.mode,A),v.return=b,b=v),i(b)):n(b,v)}return f}var vl=c2(!0),u2=c2(!1),cp=ro(null),up=null,Qi=null,kv=null;function Iv(){kv=Qi=up=null}function Av(a){var e=cp.current;Ht(cp),a._currentValue=e}function Yh(a,e,n){for(;a!==null;){var r=a.alternate;if((a.childLanes&e)!==e?(a.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),a===n)break;a=a.return}}function sl(a,e){up=a,kv=Qi=null,a=a.dependencies,a!==null&&a.firstContext!==null&&(a.lanes&e&&(dn=!0),a.firstContext=null)}function Vn(a){var e=a._currentValue;if(kv!==a)if(a={context:a,memoizedValue:e,next:null},Qi===null){if(up===null)throw Error(Ce(308));Qi=a,up.dependencies={lanes:0,firstContext:a}}else Qi=Qi.next=a;return e}var Lo=null;function Tv(a){Lo===null?Lo=[a]:Lo.push(a)}function d2(a,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Tv(e)):(n.next=s.next,s.next=n),e.interleaved=n,Kr(a,r)}function Kr(a,e){a.lanes|=e;var n=a.alternate;for(n!==null&&(n.lanes|=e),n=a,a=a.return;a!==null;)a.childLanes|=e,n=a.alternate,n!==null&&(n.childLanes|=e),n=a,a=a.return;return n.tag===3?n.stateNode:null}var ys=!1;function Pv(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function m2(a,e){a=a.updateQueue,e.updateQueue===a&&(e.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Br(a,e){return{eventTime:a,lane:e,tag:0,payload:null,callback:null,next:null}}function zs(a,e,n){var r=a.updateQueue;if(r===null)return null;if(r=r.shared,kt&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Kr(a,n)}return s=r.interleaved,s===null?(e.next=e,Tv(r)):(e.next=s.next,s.next=e),r.interleaved=e,Kr(a,n)}function Im(a,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=a.pendingLanes,n|=r,e.lanes=n,hv(a,n)}}function Lx(a,e){var n=a.updateQueue,r=a.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},a.updateQueue=n;return}a=n.lastBaseUpdate,a===null?n.firstBaseUpdate=e:a.next=e,n.lastBaseUpdate=e}function dp(a,e,n,r){var s=a.updateQueue;ys=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,i===null?o=u:i.next=u,i=c;var d=a.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==i&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(o!==null){var m=s.baseState;i=0,d=u=c=null,l=o;do{var h=l.lane,C=l.eventTime;if((r&h)===h){d!==null&&(d=d.next={eventTime:C,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var S=a,w=l;switch(h=e,C=n,w.tag){case 1:if(S=w.payload,typeof S=="function"){m=S.call(C,m,h);break e}m=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=w.payload,h=typeof S=="function"?S.call(C,m,h):S,h==null)break e;m=ia({},m,h);break e;case 2:ys=!0}}l.callback!==null&&l.lane!==0&&(a.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else C={eventTime:C,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=C,c=m):d=d.next=C,i|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(1);if(d===null&&(c=m),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);Ho|=i,a.lanes=i,a.memoizedState=m}}function Mx(a,e,n){if(a=e.effects,e.effects=null,a!==null)for(e=0;e<a.length;e++){var r=a[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Ce(191,s));s.call(r)}}}var Zu={},yr=ro(Zu),Nu=ro(Zu),wu=ro(Zu);function Mo(a){if(a===Zu)throw Error(Ce(174));return a}function Rv(a,e){switch(Bt(wu,e),Bt(Nu,a),Bt(yr,Zu),a=e.nodeType,a){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ph(null,"");break;default:a=a===8?e.parentNode:e,e=a.namespaceURI||null,a=a.tagName,e=Ph(e,a)}Ht(yr),Bt(yr,e)}function bl(){Ht(yr),Ht(Nu),Ht(wu)}function p2(a){Mo(wu.current);var e=Mo(yr.current),n=Ph(e,a.type);e!==n&&(Bt(Nu,a),Bt(yr,n))}function Dv(a){Nu.current===a&&(Ht(yr),Ht(Nu))}var ra=ro(0);function mp(a){for(var e=a;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===a)break;for(;e.sibling===null;){if(e.return===null||e.return===a)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Tf=[];function Lv(){for(var a=0;a<Tf.length;a++)Tf[a]._workInProgressVersionPrimary=null;Tf.length=0}var Am=as.ReactCurrentDispatcher,Pf=as.ReactCurrentBatchConfig,Go=0,oa=null,xa=null,Ta=null,pp=!1,Yc=!1,_u=0,vR=0;function Wa(){throw Error(Ce(321))}function Mv(a,e){if(e===null)return!1;for(var n=0;n<e.length&&n<a.length;n++)if(!tr(a[n],e[n]))return!1;return!0}function Vv(a,e,n,r,s,o){if(Go=o,oa=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Am.current=a===null||a.memoizedState===null?yR:NR,a=n(r,s),Yc){o=0;do{if(Yc=!1,_u=0,25<=o)throw Error(Ce(301));o+=1,Ta=xa=null,e.updateQueue=null,Am.current=wR,a=n(r,s)}while(Yc)}if(Am.current=gp,e=xa!==null&&xa.next!==null,Go=0,Ta=xa=oa=null,pp=!1,e)throw Error(Ce(300));return a}function Ov(){var a=_u!==0;return _u=0,a}function fr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ta===null?oa.memoizedState=Ta=a:Ta=Ta.next=a,Ta}function On(){if(xa===null){var a=oa.alternate;a=a!==null?a.memoizedState:null}else a=xa.next;var e=Ta===null?oa.memoizedState:Ta.next;if(e!==null)Ta=e,xa=a;else{if(a===null)throw Error(Ce(310));xa=a,a={memoizedState:xa.memoizedState,baseState:xa.baseState,baseQueue:xa.baseQueue,queue:xa.queue,next:null},Ta===null?oa.memoizedState=Ta=a:Ta=Ta.next=a}return Ta}function Cu(a,e){return typeof e=="function"?e(a):e}function Rf(a){var e=On(),n=e.queue;if(n===null)throw Error(Ce(311));n.lastRenderedReducer=a;var r=xa,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var l=i=null,c=null,u=o;do{var d=u.lane;if((Go&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:a(r,u.action);else{var m={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=m,i=r):c=c.next=m,oa.lanes|=d,Ho|=d}u=u.next}while(u!==null&&u!==o);c===null?i=r:c.next=l,tr(r,e.memoizedState)||(dn=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=c,n.lastRenderedState=r}if(a=n.interleaved,a!==null){s=a;do o=s.lane,oa.lanes|=o,Ho|=o,s=s.next;while(s!==a)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Df(a){var e=On(),n=e.queue;if(n===null)throw Error(Ce(311));n.lastRenderedReducer=a;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=a(o,i.action),i=i.next;while(i!==s);tr(o,e.memoizedState)||(dn=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function g2(){}function f2(a,e){var n=oa,r=On(),s=e(),o=!tr(r.memoizedState,s);if(o&&(r.memoizedState=s,dn=!0),r=r.queue,jv(b2.bind(null,n,r,a),[a]),r.getSnapshot!==e||o||Ta!==null&&Ta.memoizedState.tag&1){if(n.flags|=2048,Su(9,v2.bind(null,n,r,s,e),void 0,null),Ra===null)throw Error(Ce(349));Go&30||h2(n,e,s)}return s}function h2(a,e,n){a.flags|=16384,a={getSnapshot:e,value:n},e=oa.updateQueue,e===null?(e={lastEffect:null,stores:null},oa.updateQueue=e,e.stores=[a]):(n=e.stores,n===null?e.stores=[a]:n.push(a))}function v2(a,e,n,r){e.value=n,e.getSnapshot=r,E2(e)&&x2(a)}function b2(a,e,n){return n(function(){E2(e)&&x2(a)})}function E2(a){var e=a.getSnapshot;a=a.value;try{var n=e();return!tr(a,n)}catch{return!0}}function x2(a){var e=Kr(a,1);e!==null&&Xn(e,a,1,-1)}function Vx(a){var e=fr();return typeof a=="function"&&(a=a()),e.memoizedState=e.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Cu,lastRenderedState:a},e.queue=a,a=a.dispatch=xR.bind(null,oa,a),[e.memoizedState,a]}function Su(a,e,n,r){return a={tag:a,create:e,destroy:n,deps:r,next:null},e=oa.updateQueue,e===null?(e={lastEffect:null,stores:null},oa.updateQueue=e,e.lastEffect=a.next=a):(n=e.lastEffect,n===null?e.lastEffect=a.next=a:(r=n.next,n.next=a,a.next=r,e.lastEffect=a)),a}function y2(){return On().memoizedState}function Tm(a,e,n,r){var s=fr();oa.flags|=a,s.memoizedState=Su(1|e,n,void 0,r===void 0?null:r)}function lg(a,e,n,r){var s=On();r=r===void 0?null:r;var o=void 0;if(xa!==null){var i=xa.memoizedState;if(o=i.destroy,r!==null&&Mv(r,i.deps)){s.memoizedState=Su(e,n,o,r);return}}oa.flags|=a,s.memoizedState=Su(1|e,n,o,r)}function Ox(a,e){return Tm(8390656,8,a,e)}function jv(a,e){return lg(2048,8,a,e)}function N2(a,e){return lg(4,2,a,e)}function w2(a,e){return lg(4,4,a,e)}function _2(a,e){if(typeof e=="function")return a=a(),e(a),function(){e(null)};if(e!=null)return a=a(),e.current=a,function(){e.current=null}}function C2(a,e,n){return n=n!=null?n.concat([a]):null,lg(4,4,_2.bind(null,e,a),n)}function Fv(){}function S2(a,e){var n=On();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Mv(e,r[1])?r[0]:(n.memoizedState=[a,e],a)}function k2(a,e){var n=On();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Mv(e,r[1])?r[0]:(a=a(),n.memoizedState=[a,e],a)}function I2(a,e,n){return Go&21?(tr(n,e)||(n=D1(),oa.lanes|=n,Ho|=n,a.baseState=!0),e):(a.baseState&&(a.baseState=!1,dn=!0),a.memoizedState=n)}function bR(a,e){var n=Mt;Mt=n!==0&&4>n?n:4,a(!0);var r=Pf.transition;Pf.transition={};try{a(!1),e()}finally{Mt=n,Pf.transition=r}}function A2(){return On().memoizedState}function ER(a,e,n){var r=$s(a);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},T2(a))P2(e,n);else if(n=d2(a,e,n,r),n!==null){var s=sn();Xn(n,a,r,s),R2(n,e,r)}}function xR(a,e,n){var r=$s(a),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(T2(a))P2(e,s);else{var o=a.alternate;if(a.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,l=o(i,n);if(s.hasEagerState=!0,s.eagerState=l,tr(l,i)){var c=e.interleaved;c===null?(s.next=s,Tv(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=d2(a,e,s,r),n!==null&&(s=sn(),Xn(n,a,r,s),R2(n,e,r))}}function T2(a){var e=a.alternate;return a===oa||e!==null&&e===oa}function P2(a,e){Yc=pp=!0;var n=a.pending;n===null?e.next=e:(e.next=n.next,n.next=e),a.pending=e}function R2(a,e,n){if(n&4194240){var r=e.lanes;r&=a.pendingLanes,n|=r,e.lanes=n,hv(a,n)}}var gp={readContext:Vn,useCallback:Wa,useContext:Wa,useEffect:Wa,useImperativeHandle:Wa,useInsertionEffect:Wa,useLayoutEffect:Wa,useMemo:Wa,useReducer:Wa,useRef:Wa,useState:Wa,useDebugValue:Wa,useDeferredValue:Wa,useTransition:Wa,useMutableSource:Wa,useSyncExternalStore:Wa,useId:Wa,unstable_isNewReconciler:!1},yR={readContext:Vn,useCallback:function(a,e){return fr().memoizedState=[a,e===void 0?null:e],a},useContext:Vn,useEffect:Ox,useImperativeHandle:function(a,e,n){return n=n!=null?n.concat([a]):null,Tm(4194308,4,_2.bind(null,e,a),n)},useLayoutEffect:function(a,e){return Tm(4194308,4,a,e)},useInsertionEffect:function(a,e){return Tm(4,2,a,e)},useMemo:function(a,e){var n=fr();return e=e===void 0?null:e,a=a(),n.memoizedState=[a,e],a},useReducer:function(a,e,n){var r=fr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:e},r.queue=a,a=a.dispatch=ER.bind(null,oa,a),[r.memoizedState,a]},useRef:function(a){var e=fr();return a={current:a},e.memoizedState=a},useState:Vx,useDebugValue:Fv,useDeferredValue:function(a){return fr().memoizedState=a},useTransition:function(){var a=Vx(!1),e=a[0];return a=bR.bind(null,a[1]),fr().memoizedState=a,[e,a]},useMutableSource:function(){},useSyncExternalStore:function(a,e,n){var r=oa,s=fr();if(Jt){if(n===void 0)throw Error(Ce(407));n=n()}else{if(n=e(),Ra===null)throw Error(Ce(349));Go&30||h2(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,Ox(b2.bind(null,r,o,a),[a]),r.flags|=2048,Su(9,v2.bind(null,r,o,n,e),void 0,null),n},useId:function(){var a=fr(),e=Ra.identifierPrefix;if(Jt){var n=jr,r=Or;n=(r&~(1<<32-Zn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=_u++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=vR++,e=":"+e+"r"+n.toString(32)+":";return a.memoizedState=e},unstable_isNewReconciler:!1},NR={readContext:Vn,useCallback:S2,useContext:Vn,useEffect:jv,useImperativeHandle:C2,useInsertionEffect:N2,useLayoutEffect:w2,useMemo:k2,useReducer:Rf,useRef:y2,useState:function(){return Rf(Cu)},useDebugValue:Fv,useDeferredValue:function(a){var e=On();return I2(e,xa.memoizedState,a)},useTransition:function(){var a=Rf(Cu)[0],e=On().memoizedState;return[a,e]},useMutableSource:g2,useSyncExternalStore:f2,useId:A2,unstable_isNewReconciler:!1},wR={readContext:Vn,useCallback:S2,useContext:Vn,useEffect:jv,useImperativeHandle:C2,useInsertionEffect:N2,useLayoutEffect:w2,useMemo:k2,useReducer:Df,useRef:y2,useState:function(){return Df(Cu)},useDebugValue:Fv,useDeferredValue:function(a){var e=On();return xa===null?e.memoizedState=a:I2(e,xa.memoizedState,a)},useTransition:function(){var a=Df(Cu)[0],e=On().memoizedState;return[a,e]},useMutableSource:g2,useSyncExternalStore:f2,useId:A2,unstable_isNewReconciler:!1};function Kn(a,e){if(a&&a.defaultProps){e=ia({},e),a=a.defaultProps;for(var n in a)e[n]===void 0&&(e[n]=a[n]);return e}return e}function Zh(a,e,n,r){e=a.memoizedState,n=n(r,e),n=n==null?e:ia({},e,n),a.memoizedState=n,a.lanes===0&&(a.updateQueue.baseState=n)}var cg={isMounted:function(a){return(a=a._reactInternals)?mi(a)===a:!1},enqueueSetState:function(a,e,n){a=a._reactInternals;var r=sn(),s=$s(a),o=Br(r,s);o.payload=e,n!=null&&(o.callback=n),e=zs(a,o,s),e!==null&&(Xn(e,a,s,r),Im(e,a,s))},enqueueReplaceState:function(a,e,n){a=a._reactInternals;var r=sn(),s=$s(a),o=Br(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=zs(a,o,s),e!==null&&(Xn(e,a,s,r),Im(e,a,s))},enqueueForceUpdate:function(a,e){a=a._reactInternals;var n=sn(),r=$s(a),s=Br(n,r);s.tag=2,e!=null&&(s.callback=e),e=zs(a,s,r),e!==null&&(Xn(e,a,r,n),Im(e,a,r))}};function jx(a,e,n,r,s,o,i){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(r,o,i):e.prototype&&e.prototype.isPureReactComponent?!bu(n,r)||!bu(s,o):!0}function D2(a,e,n){var r=!1,s=Hs,o=e.contextType;return typeof o=="object"&&o!==null?o=Vn(o):(s=hn(e)?qo:Xa.current,r=e.contextTypes,o=(r=r!=null)?fl(a,s):Hs),e=new e(n,o),a.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=cg,a.stateNode=e,e._reactInternals=a,r&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=s,a.__reactInternalMemoizedMaskedChildContext=o),e}function Fx(a,e,n,r){a=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==a&&cg.enqueueReplaceState(e,e.state,null)}function Xh(a,e,n,r){var s=a.stateNode;s.props=n,s.state=a.memoizedState,s.refs={},Pv(a);var o=e.contextType;typeof o=="object"&&o!==null?s.context=Vn(o):(o=hn(e)?qo:Xa.current,s.context=fl(a,o)),s.state=a.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Zh(a,e,o,n),s.state=a.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&cg.enqueueReplaceState(s,s.state,null),dp(a,n,s,r),s.state=a.memoizedState),typeof s.componentDidMount=="function"&&(a.flags|=4194308)}function El(a,e){try{var n="",r=e;do n+=YT(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:a,source:e,stack:s,digest:null}}function Lf(a,e,n){return{value:a,source:null,stack:n??null,digest:e??null}}function e0(a,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var _R=typeof WeakMap=="function"?WeakMap:Map;function L2(a,e,n){n=Br(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){hp||(hp=!0,u0=r),e0(a,e)},n}function M2(a,e,n){n=Br(-1,n),n.tag=3;var r=a.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){e0(a,e)}}var o=a.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){e0(a,e),typeof r!="function"&&(Us===null?Us=new Set([this]):Us.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function zx(a,e,n){var r=a.pingCache;if(r===null){r=a.pingCache=new _R;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),a=jR.bind(null,a,e,n),e.then(a,a))}function Ux(a){do{var e;if((e=a.tag===13)&&(e=a.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return a;a=a.return}while(a!==null);return null}function $x(a,e,n,r,s){return a.mode&1?(a.flags|=65536,a.lanes=s,a):(a===e?a.flags|=65536:(a.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Br(-1,1),e.tag=2,zs(n,e,1))),n.lanes|=1),a)}var CR=as.ReactCurrentOwner,dn=!1;function nn(a,e,n,r){e.child=a===null?u2(e,null,n,r):vl(e,a.child,n,r)}function Bx(a,e,n,r,s){n=n.render;var o=e.ref;return sl(e,s),r=Vv(a,e,n,r,o,s),n=Ov(),a!==null&&!dn?(e.updateQueue=a.updateQueue,e.flags&=-2053,a.lanes&=~s,Qr(a,e,s)):(Jt&&n&&_v(e),e.flags|=1,nn(a,e,r,s),e.child)}function qx(a,e,n,r,s){if(a===null){var o=n.type;return typeof o=="function"&&!Hv(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,V2(a,e,o,r,s)):(a=Lm(n.type,null,r,e,e.mode,s),a.ref=e.ref,a.return=e,e.child=a)}if(o=a.child,!(a.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:bu,n(i,r)&&a.ref===e.ref)return Qr(a,e,s)}return e.flags|=1,a=Bs(o,r),a.ref=e.ref,a.return=e,e.child=a}function V2(a,e,n,r,s){if(a!==null){var o=a.memoizedProps;if(bu(o,r)&&a.ref===e.ref)if(dn=!1,e.pendingProps=r=o,(a.lanes&s)!==0)a.flags&131072&&(dn=!0);else return e.lanes=a.lanes,Qr(a,e,s)}return t0(a,e,n,r,s)}function O2(a,e,n){var r=e.pendingProps,s=r.children,o=a!==null?a.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Bt(Yi,yn),yn|=n;else{if(!(n&1073741824))return a=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:a,cachePool:null,transitions:null},e.updateQueue=null,Bt(Yi,yn),yn|=a,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Bt(Yi,yn),yn|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,Bt(Yi,yn),yn|=r;return nn(a,e,s,n),e.child}function j2(a,e){var n=e.ref;(a===null&&n!==null||a!==null&&a.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function t0(a,e,n,r,s){var o=hn(n)?qo:Xa.current;return o=fl(e,o),sl(e,s),n=Vv(a,e,n,r,o,s),r=Ov(),a!==null&&!dn?(e.updateQueue=a.updateQueue,e.flags&=-2053,a.lanes&=~s,Qr(a,e,s)):(Jt&&r&&_v(e),e.flags|=1,nn(a,e,n,s),e.child)}function Wx(a,e,n,r,s){if(hn(n)){var o=!0;op(e)}else o=!1;if(sl(e,s),e.stateNode===null)Pm(a,e),D2(e,n,r),Xh(e,n,r,s),r=!0;else if(a===null){var i=e.stateNode,l=e.memoizedProps;i.props=l;var c=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=Vn(u):(u=hn(n)?qo:Xa.current,u=fl(e,u));var d=n.getDerivedStateFromProps,m=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";m||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==r||c!==u)&&Fx(e,i,r,u),ys=!1;var h=e.memoizedState;i.state=h,dp(e,r,i,s),c=e.memoizedState,l!==r||h!==c||fn.current||ys?(typeof d=="function"&&(Zh(e,n,d,r),c=e.memoizedState),(l=ys||jx(e,n,l,r,h,c,u))?(m||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),i.props=r,i.state=c,i.context=u,r=l):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,m2(a,e),l=e.memoizedProps,u=e.type===e.elementType?l:Kn(e.type,l),i.props=u,m=e.pendingProps,h=i.context,c=n.contextType,typeof c=="object"&&c!==null?c=Vn(c):(c=hn(n)?qo:Xa.current,c=fl(e,c));var C=n.getDerivedStateFromProps;(d=typeof C=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==m||h!==c)&&Fx(e,i,r,c),ys=!1,h=e.memoizedState,i.state=h,dp(e,r,i,s);var S=e.memoizedState;l!==m||h!==S||fn.current||ys?(typeof C=="function"&&(Zh(e,n,C,r),S=e.memoizedState),(u=ys||jx(e,n,u,r,h,S,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,S,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,S,c)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===a.memoizedProps&&h===a.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===a.memoizedProps&&h===a.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=S),i.props=r,i.state=S,i.context=c,r=u):(typeof i.componentDidUpdate!="function"||l===a.memoizedProps&&h===a.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===a.memoizedProps&&h===a.memoizedState||(e.flags|=1024),r=!1)}return a0(a,e,n,r,o,s)}function a0(a,e,n,r,s,o){j2(a,e);var i=(e.flags&128)!==0;if(!r&&!i)return s&&Tx(e,n,!1),Qr(a,e,o);r=e.stateNode,CR.current=e;var l=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,a!==null&&i?(e.child=vl(e,a.child,null,o),e.child=vl(e,null,l,o)):nn(a,e,l,o),e.memoizedState=r.state,s&&Tx(e,n,!0),e.child}function F2(a){var e=a.stateNode;e.pendingContext?Ax(a,e.pendingContext,e.pendingContext!==e.context):e.context&&Ax(a,e.context,!1),Rv(a,e.containerInfo)}function Gx(a,e,n,r,s){return hl(),Sv(s),e.flags|=256,nn(a,e,n,r),e.child}var n0={dehydrated:null,treeContext:null,retryLane:0};function r0(a){return{baseLanes:a,cachePool:null,transitions:null}}function z2(a,e,n){var r=e.pendingProps,s=ra.current,o=!1,i=(e.flags&128)!==0,l;if((l=i)||(l=a!==null&&a.memoizedState===null?!1:(s&2)!==0),l?(o=!0,e.flags&=-129):(a===null||a.memoizedState!==null)&&(s|=1),Bt(ra,s&1),a===null)return Jh(e),a=e.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?(e.mode&1?a.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,a=r.fallback,o?(r=e.mode,o=e.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=mg(i,r,0,null),a=zo(a,r,n,null),o.return=e,a.return=e,o.sibling=a,e.child=o,e.child.memoizedState=r0(n),e.memoizedState=n0,a):zv(e,i));if(s=a.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return SR(a,e,i,r,l,s,n);if(o){o=r.fallback,i=e.mode,s=a.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(i&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Bs(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?o=Bs(l,o):(o=zo(o,i,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,i=a.child.memoizedState,i=i===null?r0(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=a.childLanes&~n,e.memoizedState=n0,r}return o=a.child,a=o.sibling,r=Bs(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,a!==null&&(n=e.deletions,n===null?(e.deletions=[a],e.flags|=16):n.push(a)),e.child=r,e.memoizedState=null,r}function zv(a,e){return e=mg({mode:"visible",children:e},a.mode,0,null),e.return=a,a.child=e}function rm(a,e,n,r){return r!==null&&Sv(r),vl(e,a.child,null,n),a=zv(e,e.pendingProps.children),a.flags|=2,e.memoizedState=null,a}function SR(a,e,n,r,s,o,i){if(n)return e.flags&256?(e.flags&=-257,r=Lf(Error(Ce(422))),rm(a,e,i,r)):e.memoizedState!==null?(e.child=a.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=mg({mode:"visible",children:r.children},s,0,null),o=zo(o,s,i,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&vl(e,a.child,null,i),e.child.memoizedState=r0(i),e.memoizedState=n0,o);if(!(e.mode&1))return rm(a,e,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(Ce(419)),r=Lf(o,r,void 0),rm(a,e,i,r)}if(l=(i&a.childLanes)!==0,dn||l){if(r=Ra,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,Kr(a,s),Xn(r,a,s,-1))}return Gv(),r=Lf(Error(Ce(421))),rm(a,e,i,r)}return s.data==="$?"?(e.flags|=128,e.child=a.child,e=FR.bind(null,a),s._reactRetry=e,null):(a=o.treeContext,wn=Fs(s.nextSibling),Cn=e,Jt=!0,Jn=null,a!==null&&(Rn[Dn++]=Or,Rn[Dn++]=jr,Rn[Dn++]=Wo,Or=a.id,jr=a.overflow,Wo=e),e=zv(e,r.children),e.flags|=4096,e)}function Hx(a,e,n){a.lanes|=e;var r=a.alternate;r!==null&&(r.lanes|=e),Yh(a.return,e,n)}function Mf(a,e,n,r,s){var o=a.memoizedState;o===null?a.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function U2(a,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(nn(a,e,r.children,n),r=ra.current,r&2)r=r&1|2,e.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=e.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Hx(a,n,e);else if(a.tag===19)Hx(a,n,e);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break e;for(;a.sibling===null;){if(a.return===null||a.return===e)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}r&=1}if(Bt(ra,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)a=n.alternate,a!==null&&mp(a)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Mf(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(a=s.alternate,a!==null&&mp(a)===null){e.child=s;break}a=s.sibling,s.sibling=n,n=s,s=a}Mf(e,!0,n,null,o);break;case"together":Mf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Pm(a,e){!(e.mode&1)&&a!==null&&(a.alternate=null,e.alternate=null,e.flags|=2)}function Qr(a,e,n){if(a!==null&&(e.dependencies=a.dependencies),Ho|=e.lanes,!(n&e.childLanes))return null;if(a!==null&&e.child!==a.child)throw Error(Ce(153));if(e.child!==null){for(a=e.child,n=Bs(a,a.pendingProps),e.child=n,n.return=e;a.sibling!==null;)a=a.sibling,n=n.sibling=Bs(a,a.pendingProps),n.return=e;n.sibling=null}return e.child}function kR(a,e,n){switch(e.tag){case 3:F2(e),hl();break;case 5:p2(e);break;case 1:hn(e.type)&&op(e);break;case 4:Rv(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Bt(cp,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Bt(ra,ra.current&1),e.flags|=128,null):n&e.child.childLanes?z2(a,e,n):(Bt(ra,ra.current&1),a=Qr(a,e,n),a!==null?a.sibling:null);Bt(ra,ra.current&1);break;case 19:if(r=(n&e.childLanes)!==0,a.flags&128){if(r)return U2(a,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Bt(ra,ra.current),r)break;return null;case 22:case 23:return e.lanes=0,O2(a,e,n)}return Qr(a,e,n)}var $2,s0,B2,q2;$2=function(a,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)a.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};s0=function(){};B2=function(a,e,n,r){var s=a.memoizedProps;if(s!==r){a=e.stateNode,Mo(yr.current);var o=null;switch(n){case"input":s=kh(a,s),r=kh(a,r),o=[];break;case"select":s=ia({},s,{value:void 0}),r=ia({},r,{value:void 0}),o=[];break;case"textarea":s=Th(a,s),r=Th(a,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(a.onclick=rp)}Rh(n,r);var i;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(du.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(o=o||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(du.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Wt("scroll",a),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};q2=function(a,e,n,r){n!==r&&(e.flags|=4)};function wc(a,e){if(!Jt)switch(a.tailMode){case"hidden":e=a.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?a.tail=null:n.sibling=null;break;case"collapsed":n=a.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||a.tail===null?a.tail=null:a.tail.sibling=null:r.sibling=null}}function Ga(a){var e=a.alternate!==null&&a.alternate.child===a.child,n=0,r=0;if(e)for(var s=a.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=a,s=s.sibling;else for(s=a.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=a,s=s.sibling;return a.subtreeFlags|=r,a.childLanes=n,e}function IR(a,e,n){var r=e.pendingProps;switch(Cv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ga(e),null;case 1:return hn(e.type)&&sp(),Ga(e),null;case 3:return r=e.stateNode,bl(),Ht(fn),Ht(Xa),Lv(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(a===null||a.child===null)&&(am(e)?e.flags|=4:a===null||a.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Jn!==null&&(p0(Jn),Jn=null))),s0(a,e),Ga(e),null;case 5:Dv(e);var s=Mo(wu.current);if(n=e.type,a!==null&&e.stateNode!=null)B2(a,e,n,r,s),a.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Ce(166));return Ga(e),null}if(a=Mo(yr.current),am(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[hr]=e,r[yu]=o,a=(e.mode&1)!==0,n){case"dialog":Wt("cancel",r),Wt("close",r);break;case"iframe":case"object":case"embed":Wt("load",r);break;case"video":case"audio":for(s=0;s<Fc.length;s++)Wt(Fc[s],r);break;case"source":Wt("error",r);break;case"img":case"image":case"link":Wt("error",r),Wt("load",r);break;case"details":Wt("toggle",r);break;case"input":ax(r,o),Wt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Wt("invalid",r);break;case"textarea":rx(r,o),Wt("invalid",r)}Rh(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&tm(r.textContent,l,a),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&tm(r.textContent,l,a),s=["children",""+l]):du.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&Wt("scroll",r)}switch(n){case"input":Hd(r),nx(r,o,!0);break;case"textarea":Hd(r),sx(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=rp)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=b1(n)),a==="http://www.w3.org/1999/xhtml"?n==="script"?(a=i.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof r.is=="string"?a=i.createElement(n,{is:r.is}):(a=i.createElement(n),n==="select"&&(i=a,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):a=i.createElementNS(a,n),a[hr]=e,a[yu]=r,$2(a,e,!1,!1),e.stateNode=a;e:{switch(i=Dh(n,r),n){case"dialog":Wt("cancel",a),Wt("close",a),s=r;break;case"iframe":case"object":case"embed":Wt("load",a),s=r;break;case"video":case"audio":for(s=0;s<Fc.length;s++)Wt(Fc[s],a);s=r;break;case"source":Wt("error",a),s=r;break;case"img":case"image":case"link":Wt("error",a),Wt("load",a),s=r;break;case"details":Wt("toggle",a),s=r;break;case"input":ax(a,r),s=kh(a,r),Wt("invalid",a);break;case"option":s=r;break;case"select":a._wrapperState={wasMultiple:!!r.multiple},s=ia({},r,{value:void 0}),Wt("invalid",a);break;case"textarea":rx(a,r),s=Th(a,r),Wt("invalid",a);break;default:s=r}Rh(n,s),l=s;for(o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="style"?y1(a,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&E1(a,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&mu(a,c):typeof c=="number"&&mu(a,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(du.hasOwnProperty(o)?c!=null&&o==="onScroll"&&Wt("scroll",a):c!=null&&uv(a,o,c,i))}switch(n){case"input":Hd(a),nx(a,r,!1);break;case"textarea":Hd(a),sx(a);break;case"option":r.value!=null&&a.setAttribute("value",""+Gs(r.value));break;case"select":a.multiple=!!r.multiple,o=r.value,o!=null?tl(a,!!r.multiple,o,!1):r.defaultValue!=null&&tl(a,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(a.onclick=rp)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ga(e),null;case 6:if(a&&e.stateNode!=null)q2(a,e,a.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Ce(166));if(n=Mo(wu.current),Mo(yr.current),am(e)){if(r=e.stateNode,n=e.memoizedProps,r[hr]=e,(o=r.nodeValue!==n)&&(a=Cn,a!==null))switch(a.tag){case 3:tm(r.nodeValue,n,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&tm(r.nodeValue,n,(a.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[hr]=e,e.stateNode=r}return Ga(e),null;case 13:if(Ht(ra),r=e.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Jt&&wn!==null&&e.mode&1&&!(e.flags&128))l2(),hl(),e.flags|=98560,o=!1;else if(o=am(e),r!==null&&r.dehydrated!==null){if(a===null){if(!o)throw Error(Ce(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(Ce(317));o[hr]=e}else hl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ga(e),o=!1}else Jn!==null&&(p0(Jn),Jn=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(a!==null&&a.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(a===null||ra.current&1?Na===0&&(Na=3):Gv())),e.updateQueue!==null&&(e.flags|=4),Ga(e),null);case 4:return bl(),s0(a,e),a===null&&Eu(e.stateNode.containerInfo),Ga(e),null;case 10:return Av(e.type._context),Ga(e),null;case 17:return hn(e.type)&&sp(),Ga(e),null;case 19:if(Ht(ra),o=e.memoizedState,o===null)return Ga(e),null;if(r=(e.flags&128)!==0,i=o.rendering,i===null)if(r)wc(o,!1);else{if(Na!==0||a!==null&&a.flags&128)for(a=e.child;a!==null;){if(i=mp(a),i!==null){for(e.flags|=128,wc(o,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,a=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=a,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,a=i.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),n=n.sibling;return Bt(ra,ra.current&1|2),e.child}a=a.sibling}o.tail!==null&&ga()>xl&&(e.flags|=128,r=!0,wc(o,!1),e.lanes=4194304)}else{if(!r)if(a=mp(i),a!==null){if(e.flags|=128,r=!0,n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),wc(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!Jt)return Ga(e),null}else 2*ga()-o.renderingStartTime>xl&&n!==1073741824&&(e.flags|=128,r=!0,wc(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=ga(),e.sibling=null,n=ra.current,Bt(ra,r?n&1|2:n&1),e):(Ga(e),null);case 22:case 23:return Wv(),r=e.memoizedState!==null,a!==null&&a.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?yn&1073741824&&(Ga(e),e.subtreeFlags&6&&(e.flags|=8192)):Ga(e),null;case 24:return null;case 25:return null}throw Error(Ce(156,e.tag))}function AR(a,e){switch(Cv(e),e.tag){case 1:return hn(e.type)&&sp(),a=e.flags,a&65536?(e.flags=a&-65537|128,e):null;case 3:return bl(),Ht(fn),Ht(Xa),Lv(),a=e.flags,a&65536&&!(a&128)?(e.flags=a&-65537|128,e):null;case 5:return Dv(e),null;case 13:if(Ht(ra),a=e.memoizedState,a!==null&&a.dehydrated!==null){if(e.alternate===null)throw Error(Ce(340));hl()}return a=e.flags,a&65536?(e.flags=a&-65537|128,e):null;case 19:return Ht(ra),null;case 4:return bl(),null;case 10:return Av(e.type._context),null;case 22:case 23:return Wv(),null;case 24:return null;default:return null}}var sm=!1,Qa=!1,TR=typeof WeakSet=="function"?WeakSet:Set,Ve=null;function Ji(a,e){var n=a.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ua(a,e,r)}else n.current=null}function o0(a,e,n){try{n()}catch(r){ua(a,e,r)}}var Kx=!1;function PR(a,e){if(Bh=tp,a=Q1(),wv(a)){if("selectionStart"in a)var n={start:a.selectionStart,end:a.selectionEnd};else e:{n=(n=a.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,l=-1,c=-1,u=0,d=0,m=a,h=null;t:for(;;){for(var C;m!==n||s!==0&&m.nodeType!==3||(l=i+s),m!==o||r!==0&&m.nodeType!==3||(c=i+r),m.nodeType===3&&(i+=m.nodeValue.length),(C=m.firstChild)!==null;)h=m,m=C;for(;;){if(m===a)break t;if(h===n&&++u===s&&(l=i),h===o&&++d===r&&(c=i),(C=m.nextSibling)!==null)break;m=h,h=m.parentNode}m=C}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(qh={focusedElem:a,selectionRange:n},tp=!1,Ve=e;Ve!==null;)if(e=Ve,a=e.child,(e.subtreeFlags&1028)!==0&&a!==null)a.return=e,Ve=a;else for(;Ve!==null;){e=Ve;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var w=S.memoizedProps,f=S.memoizedState,b=e.stateNode,v=b.getSnapshotBeforeUpdate(e.elementType===e.type?w:Kn(e.type,w),f);b.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ce(163))}}catch(A){ua(e,e.return,A)}if(a=e.sibling,a!==null){a.return=e.return,Ve=a;break}Ve=e.return}return S=Kx,Kx=!1,S}function Zc(a,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&a)===a){var o=s.destroy;s.destroy=void 0,o!==void 0&&o0(e,n,o)}s=s.next}while(s!==r)}}function ug(a,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&a)===a){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function i0(a){var e=a.ref;if(e!==null){var n=a.stateNode;switch(a.tag){case 5:a=n;break;default:a=n}typeof e=="function"?e(a):e.current=a}}function W2(a){var e=a.alternate;e!==null&&(a.alternate=null,W2(e)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(e=a.stateNode,e!==null&&(delete e[hr],delete e[yu],delete e[Hh],delete e[pR],delete e[gR])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function G2(a){return a.tag===5||a.tag===3||a.tag===4}function Qx(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||G2(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function l0(a,e,n){var r=a.tag;if(r===5||r===6)a=a.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(a,e):n.insertBefore(a,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(a,n)):(e=n,e.appendChild(a)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=rp));else if(r!==4&&(a=a.child,a!==null))for(l0(a,e,n),a=a.sibling;a!==null;)l0(a,e,n),a=a.sibling}function c0(a,e,n){var r=a.tag;if(r===5||r===6)a=a.stateNode,e?n.insertBefore(a,e):n.appendChild(a);else if(r!==4&&(a=a.child,a!==null))for(c0(a,e,n),a=a.sibling;a!==null;)c0(a,e,n),a=a.sibling}var Va=null,Qn=!1;function fs(a,e,n){for(n=n.child;n!==null;)H2(a,e,n),n=n.sibling}function H2(a,e,n){if(xr&&typeof xr.onCommitFiberUnmount=="function")try{xr.onCommitFiberUnmount(ag,n)}catch{}switch(n.tag){case 5:Qa||Ji(n,e);case 6:var r=Va,s=Qn;Va=null,fs(a,e,n),Va=r,Qn=s,Va!==null&&(Qn?(a=Va,n=n.stateNode,a.nodeType===8?a.parentNode.removeChild(n):a.removeChild(n)):Va.removeChild(n.stateNode));break;case 18:Va!==null&&(Qn?(a=Va,n=n.stateNode,a.nodeType===8?If(a.parentNode,n):a.nodeType===1&&If(a,n),hu(a)):If(Va,n.stateNode));break;case 4:r=Va,s=Qn,Va=n.stateNode.containerInfo,Qn=!0,fs(a,e,n),Va=r,Qn=s;break;case 0:case 11:case 14:case 15:if(!Qa&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&o0(n,e,i),s=s.next}while(s!==r)}fs(a,e,n);break;case 1:if(!Qa&&(Ji(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ua(n,e,l)}fs(a,e,n);break;case 21:fs(a,e,n);break;case 22:n.mode&1?(Qa=(r=Qa)||n.memoizedState!==null,fs(a,e,n),Qa=r):fs(a,e,n);break;default:fs(a,e,n)}}function Jx(a){var e=a.updateQueue;if(e!==null){a.updateQueue=null;var n=a.stateNode;n===null&&(n=a.stateNode=new TR),e.forEach(function(r){var s=zR.bind(null,a,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Hn(a,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=a,i=e,l=i;e:for(;l!==null;){switch(l.tag){case 5:Va=l.stateNode,Qn=!1;break e;case 3:Va=l.stateNode.containerInfo,Qn=!0;break e;case 4:Va=l.stateNode.containerInfo,Qn=!0;break e}l=l.return}if(Va===null)throw Error(Ce(160));H2(o,i,s),Va=null,Qn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){ua(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)K2(e,a),e=e.sibling}function K2(a,e){var n=a.alternate,r=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(Hn(e,a),pr(a),r&4){try{Zc(3,a,a.return),ug(3,a)}catch(w){ua(a,a.return,w)}try{Zc(5,a,a.return)}catch(w){ua(a,a.return,w)}}break;case 1:Hn(e,a),pr(a),r&512&&n!==null&&Ji(n,n.return);break;case 5:if(Hn(e,a),pr(a),r&512&&n!==null&&Ji(n,n.return),a.flags&32){var s=a.stateNode;try{mu(s,"")}catch(w){ua(a,a.return,w)}}if(r&4&&(s=a.stateNode,s!=null)){var o=a.memoizedProps,i=n!==null?n.memoizedProps:o,l=a.type,c=a.updateQueue;if(a.updateQueue=null,c!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&h1(s,o),Dh(l,i);var u=Dh(l,o);for(i=0;i<c.length;i+=2){var d=c[i],m=c[i+1];d==="style"?y1(s,m):d==="dangerouslySetInnerHTML"?E1(s,m):d==="children"?mu(s,m):uv(s,d,m,u)}switch(l){case"input":Ih(s,o);break;case"textarea":v1(s,o);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var C=o.value;C!=null?tl(s,!!o.multiple,C,!1):h!==!!o.multiple&&(o.defaultValue!=null?tl(s,!!o.multiple,o.defaultValue,!0):tl(s,!!o.multiple,o.multiple?[]:"",!1))}s[yu]=o}catch(w){ua(a,a.return,w)}}break;case 6:if(Hn(e,a),pr(a),r&4){if(a.stateNode===null)throw Error(Ce(162));s=a.stateNode,o=a.memoizedProps;try{s.nodeValue=o}catch(w){ua(a,a.return,w)}}break;case 3:if(Hn(e,a),pr(a),r&4&&n!==null&&n.memoizedState.isDehydrated)try{hu(e.containerInfo)}catch(w){ua(a,a.return,w)}break;case 4:Hn(e,a),pr(a);break;case 13:Hn(e,a),pr(a),s=a.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(Bv=ga())),r&4&&Jx(a);break;case 22:if(d=n!==null&&n.memoizedState!==null,a.mode&1?(Qa=(u=Qa)||d,Hn(e,a),Qa=u):Hn(e,a),pr(a),r&8192){if(u=a.memoizedState!==null,(a.stateNode.isHidden=u)&&!d&&a.mode&1)for(Ve=a,d=a.child;d!==null;){for(m=Ve=d;Ve!==null;){switch(h=Ve,C=h.child,h.tag){case 0:case 11:case 14:case 15:Zc(4,h,h.return);break;case 1:Ji(h,h.return);var S=h.stateNode;if(typeof S.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(w){ua(r,n,w)}}break;case 5:Ji(h,h.return);break;case 22:if(h.memoizedState!==null){Zx(m);continue}}C!==null?(C.return=h,Ve=C):Zx(m)}d=d.sibling}e:for(d=null,m=a;;){if(m.tag===5){if(d===null){d=m;try{s=m.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=m.stateNode,c=m.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=x1("display",i))}catch(w){ua(a,a.return,w)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(w){ua(a,a.return,w)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===a)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===a)break e;for(;m.sibling===null;){if(m.return===null||m.return===a)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Hn(e,a),pr(a),r&4&&Jx(a);break;case 21:break;default:Hn(e,a),pr(a)}}function pr(a){var e=a.flags;if(e&2){try{e:{for(var n=a.return;n!==null;){if(G2(n)){var r=n;break e}n=n.return}throw Error(Ce(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(mu(s,""),r.flags&=-33);var o=Qx(a);c0(a,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,l=Qx(a);l0(a,l,i);break;default:throw Error(Ce(161))}}catch(c){ua(a,a.return,c)}a.flags&=-3}e&4096&&(a.flags&=-4097)}function RR(a,e,n){Ve=a,Q2(a)}function Q2(a,e,n){for(var r=(a.mode&1)!==0;Ve!==null;){var s=Ve,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||sm;if(!i){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Qa;l=sm;var u=Qa;if(sm=i,(Qa=c)&&!u)for(Ve=s;Ve!==null;)i=Ve,c=i.child,i.tag===22&&i.memoizedState!==null?Xx(s):c!==null?(c.return=i,Ve=c):Xx(s);for(;o!==null;)Ve=o,Q2(o),o=o.sibling;Ve=s,sm=l,Qa=u}Yx(a)}else s.subtreeFlags&8772&&o!==null?(o.return=s,Ve=o):Yx(a)}}function Yx(a){for(;Ve!==null;){var e=Ve;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Qa||ug(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Qa)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Kn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Mx(e,o,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Mx(e,i,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&hu(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ce(163))}Qa||e.flags&512&&i0(e)}catch(h){ua(e,e.return,h)}}if(e===a){Ve=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ve=n;break}Ve=e.return}}function Zx(a){for(;Ve!==null;){var e=Ve;if(e===a){Ve=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ve=n;break}Ve=e.return}}function Xx(a){for(;Ve!==null;){var e=Ve;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ug(4,e)}catch(c){ua(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){ua(e,s,c)}}var o=e.return;try{i0(e)}catch(c){ua(e,o,c)}break;case 5:var i=e.return;try{i0(e)}catch(c){ua(e,i,c)}}}catch(c){ua(e,e.return,c)}if(e===a){Ve=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Ve=l;break}Ve=e.return}}var DR=Math.ceil,fp=as.ReactCurrentDispatcher,Uv=as.ReactCurrentOwner,Mn=as.ReactCurrentBatchConfig,kt=0,Ra=null,Ea=null,Fa=0,yn=0,Yi=ro(0),Na=0,ku=null,Ho=0,dg=0,$v=0,Xc=null,un=null,Bv=0,xl=1/0,Lr=null,hp=!1,u0=null,Us=null,om=!1,Ls=null,vp=0,eu=0,d0=null,Rm=-1,Dm=0;function sn(){return kt&6?ga():Rm!==-1?Rm:Rm=ga()}function $s(a){return a.mode&1?kt&2&&Fa!==0?Fa&-Fa:hR.transition!==null?(Dm===0&&(Dm=D1()),Dm):(a=Mt,a!==0||(a=window.event,a=a===void 0?16:z1(a.type)),a):1}function Xn(a,e,n,r){if(50<eu)throw eu=0,d0=null,Error(Ce(185));Qu(a,n,r),(!(kt&2)||a!==Ra)&&(a===Ra&&(!(kt&2)&&(dg|=n),Na===4&&_s(a,Fa)),vn(a,r),n===1&&kt===0&&!(e.mode&1)&&(xl=ga()+500,ig&&so()))}function vn(a,e){var n=a.callbackNode;hP(a,e);var r=ep(a,a===Ra?Fa:0);if(r===0)n!==null&&lx(n),a.callbackNode=null,a.callbackPriority=0;else if(e=r&-r,a.callbackPriority!==e){if(n!=null&&lx(n),e===1)a.tag===0?fR(ey.bind(null,a)):s2(ey.bind(null,a)),dR(function(){!(kt&6)&&so()}),n=null;else{switch(L1(r)){case 1:n=fv;break;case 4:n=P1;break;case 16:n=Xm;break;case 536870912:n=R1;break;default:n=Xm}n=nC(n,J2.bind(null,a))}a.callbackPriority=e,a.callbackNode=n}}function J2(a,e){if(Rm=-1,Dm=0,kt&6)throw Error(Ce(327));var n=a.callbackNode;if(ol()&&a.callbackNode!==n)return null;var r=ep(a,a===Ra?Fa:0);if(r===0)return null;if(r&30||r&a.expiredLanes||e)e=bp(a,r);else{e=r;var s=kt;kt|=2;var o=Z2();(Ra!==a||Fa!==e)&&(Lr=null,xl=ga()+500,Fo(a,e));do try{VR();break}catch(l){Y2(a,l)}while(1);Iv(),fp.current=o,kt=s,Ea!==null?e=0:(Ra=null,Fa=0,e=Na)}if(e!==0){if(e===2&&(s=jh(a),s!==0&&(r=s,e=m0(a,s))),e===1)throw n=ku,Fo(a,0),_s(a,r),vn(a,ga()),n;if(e===6)_s(a,r);else{if(s=a.current.alternate,!(r&30)&&!LR(s)&&(e=bp(a,r),e===2&&(o=jh(a),o!==0&&(r=o,e=m0(a,o))),e===1))throw n=ku,Fo(a,0),_s(a,r),vn(a,ga()),n;switch(a.finishedWork=s,a.finishedLanes=r,e){case 0:case 1:throw Error(Ce(345));case 2:Co(a,un,Lr);break;case 3:if(_s(a,r),(r&130023424)===r&&(e=Bv+500-ga(),10<e)){if(ep(a,0)!==0)break;if(s=a.suspendedLanes,(s&r)!==r){sn(),a.pingedLanes|=a.suspendedLanes&s;break}a.timeoutHandle=Gh(Co.bind(null,a,un,Lr),e);break}Co(a,un,Lr);break;case 4:if(_s(a,r),(r&4194240)===r)break;for(e=a.eventTimes,s=-1;0<r;){var i=31-Zn(r);o=1<<i,i=e[i],i>s&&(s=i),r&=~o}if(r=s,r=ga()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*DR(r/1960))-r,10<r){a.timeoutHandle=Gh(Co.bind(null,a,un,Lr),r);break}Co(a,un,Lr);break;case 5:Co(a,un,Lr);break;default:throw Error(Ce(329))}}}return vn(a,ga()),a.callbackNode===n?J2.bind(null,a):null}function m0(a,e){var n=Xc;return a.current.memoizedState.isDehydrated&&(Fo(a,e).flags|=256),a=bp(a,e),a!==2&&(e=un,un=n,e!==null&&p0(e)),a}function p0(a){un===null?un=a:un.push.apply(un,a)}function LR(a){for(var e=a;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!tr(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===a)break;for(;e.sibling===null;){if(e.return===null||e.return===a)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function _s(a,e){for(e&=~$v,e&=~dg,a.suspendedLanes|=e,a.pingedLanes&=~e,a=a.expirationTimes;0<e;){var n=31-Zn(e),r=1<<n;a[n]=-1,e&=~r}}function ey(a){if(kt&6)throw Error(Ce(327));ol();var e=ep(a,0);if(!(e&1))return vn(a,ga()),null;var n=bp(a,e);if(a.tag!==0&&n===2){var r=jh(a);r!==0&&(e=r,n=m0(a,r))}if(n===1)throw n=ku,Fo(a,0),_s(a,e),vn(a,ga()),n;if(n===6)throw Error(Ce(345));return a.finishedWork=a.current.alternate,a.finishedLanes=e,Co(a,un,Lr),vn(a,ga()),null}function qv(a,e){var n=kt;kt|=1;try{return a(e)}finally{kt=n,kt===0&&(xl=ga()+500,ig&&so())}}function Ko(a){Ls!==null&&Ls.tag===0&&!(kt&6)&&ol();var e=kt;kt|=1;var n=Mn.transition,r=Mt;try{if(Mn.transition=null,Mt=1,a)return a()}finally{Mt=r,Mn.transition=n,kt=e,!(kt&6)&&so()}}function Wv(){yn=Yi.current,Ht(Yi)}function Fo(a,e){a.finishedWork=null,a.finishedLanes=0;var n=a.timeoutHandle;if(n!==-1&&(a.timeoutHandle=-1,uR(n)),Ea!==null)for(n=Ea.return;n!==null;){var r=n;switch(Cv(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&sp();break;case 3:bl(),Ht(fn),Ht(Xa),Lv();break;case 5:Dv(r);break;case 4:bl();break;case 13:Ht(ra);break;case 19:Ht(ra);break;case 10:Av(r.type._context);break;case 22:case 23:Wv()}n=n.return}if(Ra=a,Ea=a=Bs(a.current,null),Fa=yn=e,Na=0,ku=null,$v=dg=Ho=0,un=Xc=null,Lo!==null){for(e=0;e<Lo.length;e++)if(n=Lo[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}Lo=null}return a}function Y2(a,e){do{var n=Ea;try{if(Iv(),Am.current=gp,pp){for(var r=oa.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}pp=!1}if(Go=0,Ta=xa=oa=null,Yc=!1,_u=0,Uv.current=null,n===null||n.return===null){Na=1,ku=e,Ea=null;break}e:{var o=a,i=n.return,l=n,c=e;if(e=Fa,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var C=Ux(i);if(C!==null){C.flags&=-257,$x(C,i,l,o,e),C.mode&1&&zx(o,u,e),e=C,c=u;var S=e.updateQueue;if(S===null){var w=new Set;w.add(c),e.updateQueue=w}else S.add(c);break e}else{if(!(e&1)){zx(o,u,e),Gv();break e}c=Error(Ce(426))}}else if(Jt&&l.mode&1){var f=Ux(i);if(f!==null){!(f.flags&65536)&&(f.flags|=256),$x(f,i,l,o,e),Sv(El(c,l));break e}}o=c=El(c,l),Na!==4&&(Na=2),Xc===null?Xc=[o]:Xc.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var b=L2(o,c,e);Lx(o,b);break e;case 1:l=c;var v=o.type,I=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Us===null||!Us.has(I)))){o.flags|=65536,e&=-e,o.lanes|=e;var A=M2(o,l,e);Lx(o,A);break e}}o=o.return}while(o!==null)}eC(n)}catch(N){e=N,Ea===n&&n!==null&&(Ea=n=n.return);continue}break}while(1)}function Z2(){var a=fp.current;return fp.current=gp,a===null?gp:a}function Gv(){(Na===0||Na===3||Na===2)&&(Na=4),Ra===null||!(Ho&268435455)&&!(dg&268435455)||_s(Ra,Fa)}function bp(a,e){var n=kt;kt|=2;var r=Z2();(Ra!==a||Fa!==e)&&(Lr=null,Fo(a,e));do try{MR();break}catch(s){Y2(a,s)}while(1);if(Iv(),kt=n,fp.current=r,Ea!==null)throw Error(Ce(261));return Ra=null,Fa=0,Na}function MR(){for(;Ea!==null;)X2(Ea)}function VR(){for(;Ea!==null&&!iP();)X2(Ea)}function X2(a){var e=aC(a.alternate,a,yn);a.memoizedProps=a.pendingProps,e===null?eC(a):Ea=e,Uv.current=null}function eC(a){var e=a;do{var n=e.alternate;if(a=e.return,e.flags&32768){if(n=AR(n,e),n!==null){n.flags&=32767,Ea=n;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Na=6,Ea=null;return}}else if(n=IR(n,e,yn),n!==null){Ea=n;return}if(e=e.sibling,e!==null){Ea=e;return}Ea=e=a}while(e!==null);Na===0&&(Na=5)}function Co(a,e,n){var r=Mt,s=Mn.transition;try{Mn.transition=null,Mt=1,OR(a,e,n,r)}finally{Mn.transition=s,Mt=r}return null}function OR(a,e,n,r){do ol();while(Ls!==null);if(kt&6)throw Error(Ce(327));n=a.finishedWork;var s=a.finishedLanes;if(n===null)return null;if(a.finishedWork=null,a.finishedLanes=0,n===a.current)throw Error(Ce(177));a.callbackNode=null,a.callbackPriority=0;var o=n.lanes|n.childLanes;if(vP(a,o),a===Ra&&(Ea=Ra=null,Fa=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||om||(om=!0,nC(Xm,function(){return ol(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Mn.transition,Mn.transition=null;var i=Mt;Mt=1;var l=kt;kt|=4,Uv.current=null,PR(a,n),K2(n,a),nR(qh),tp=!!Bh,qh=Bh=null,a.current=n,RR(n),lP(),kt=l,Mt=i,Mn.transition=o}else a.current=n;if(om&&(om=!1,Ls=a,vp=s),o=a.pendingLanes,o===0&&(Us=null),dP(n.stateNode),vn(a,ga()),e!==null)for(r=a.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(hp)throw hp=!1,a=u0,u0=null,a;return vp&1&&a.tag!==0&&ol(),o=a.pendingLanes,o&1?a===d0?eu++:(eu=0,d0=a):eu=0,so(),null}function ol(){if(Ls!==null){var a=L1(vp),e=Mn.transition,n=Mt;try{if(Mn.transition=null,Mt=16>a?16:a,Ls===null)var r=!1;else{if(a=Ls,Ls=null,vp=0,kt&6)throw Error(Ce(331));var s=kt;for(kt|=4,Ve=a.current;Ve!==null;){var o=Ve,i=o.child;if(Ve.flags&16){var l=o.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Ve=u;Ve!==null;){var d=Ve;switch(d.tag){case 0:case 11:case 15:Zc(8,d,o)}var m=d.child;if(m!==null)m.return=d,Ve=m;else for(;Ve!==null;){d=Ve;var h=d.sibling,C=d.return;if(W2(d),d===u){Ve=null;break}if(h!==null){h.return=C,Ve=h;break}Ve=C}}}var S=o.alternate;if(S!==null){var w=S.child;if(w!==null){S.child=null;do{var f=w.sibling;w.sibling=null,w=f}while(w!==null)}}Ve=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,Ve=i;else e:for(;Ve!==null;){if(o=Ve,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Zc(9,o,o.return)}var b=o.sibling;if(b!==null){b.return=o.return,Ve=b;break e}Ve=o.return}}var v=a.current;for(Ve=v;Ve!==null;){i=Ve;var I=i.child;if(i.subtreeFlags&2064&&I!==null)I.return=i,Ve=I;else e:for(i=v;Ve!==null;){if(l=Ve,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ug(9,l)}}catch(N){ua(l,l.return,N)}if(l===i){Ve=null;break e}var A=l.sibling;if(A!==null){A.return=l.return,Ve=A;break e}Ve=l.return}}if(kt=s,so(),xr&&typeof xr.onPostCommitFiberRoot=="function")try{xr.onPostCommitFiberRoot(ag,a)}catch{}r=!0}return r}finally{Mt=n,Mn.transition=e}}return!1}function ty(a,e,n){e=El(n,e),e=L2(a,e,1),a=zs(a,e,1),e=sn(),a!==null&&(Qu(a,1,e),vn(a,e))}function ua(a,e,n){if(a.tag===3)ty(a,a,n);else for(;e!==null;){if(e.tag===3){ty(e,a,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Us===null||!Us.has(r))){a=El(n,a),a=M2(e,a,1),e=zs(e,a,1),a=sn(),e!==null&&(Qu(e,1,a),vn(e,a));break}}e=e.return}}function jR(a,e,n){var r=a.pingCache;r!==null&&r.delete(e),e=sn(),a.pingedLanes|=a.suspendedLanes&n,Ra===a&&(Fa&n)===n&&(Na===4||Na===3&&(Fa&130023424)===Fa&&500>ga()-Bv?Fo(a,0):$v|=n),vn(a,e)}function tC(a,e){e===0&&(a.mode&1?(e=Jd,Jd<<=1,!(Jd&130023424)&&(Jd=4194304)):e=1);var n=sn();a=Kr(a,e),a!==null&&(Qu(a,e,n),vn(a,n))}function FR(a){var e=a.memoizedState,n=0;e!==null&&(n=e.retryLane),tC(a,n)}function zR(a,e){var n=0;switch(a.tag){case 13:var r=a.stateNode,s=a.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=a.stateNode;break;default:throw Error(Ce(314))}r!==null&&r.delete(e),tC(a,n)}var aC;aC=function(a,e,n){if(a!==null)if(a.memoizedProps!==e.pendingProps||fn.current)dn=!0;else{if(!(a.lanes&n)&&!(e.flags&128))return dn=!1,kR(a,e,n);dn=!!(a.flags&131072)}else dn=!1,Jt&&e.flags&1048576&&o2(e,lp,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Pm(a,e),a=e.pendingProps;var s=fl(e,Xa.current);sl(e,n),s=Vv(null,e,r,a,s,n);var o=Ov();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,hn(r)?(o=!0,op(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Pv(e),s.updater=cg,e.stateNode=s,s._reactInternals=e,Xh(e,r,a,n),e=a0(null,e,r,!0,o,n)):(e.tag=0,Jt&&o&&_v(e),nn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Pm(a,e),a=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=$R(r),a=Kn(r,a),s){case 0:e=t0(null,e,r,a,n);break e;case 1:e=Wx(null,e,r,a,n);break e;case 11:e=Bx(null,e,r,a,n);break e;case 14:e=qx(null,e,r,Kn(r.type,a),n);break e}throw Error(Ce(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Kn(r,s),t0(a,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Kn(r,s),Wx(a,e,r,s,n);case 3:e:{if(F2(e),a===null)throw Error(Ce(387));r=e.pendingProps,o=e.memoizedState,s=o.element,m2(a,e),dp(e,r,null,n);var i=e.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=El(Error(Ce(423)),e),e=Gx(a,e,r,n,s);break e}else if(r!==s){s=El(Error(Ce(424)),e),e=Gx(a,e,r,n,s);break e}else for(wn=Fs(e.stateNode.containerInfo.firstChild),Cn=e,Jt=!0,Jn=null,n=u2(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(hl(),r===s){e=Qr(a,e,n);break e}nn(a,e,r,n)}e=e.child}return e;case 5:return p2(e),a===null&&Jh(e),r=e.type,s=e.pendingProps,o=a!==null?a.memoizedProps:null,i=s.children,Wh(r,s)?i=null:o!==null&&Wh(r,o)&&(e.flags|=32),j2(a,e),nn(a,e,i,n),e.child;case 6:return a===null&&Jh(e),null;case 13:return z2(a,e,n);case 4:return Rv(e,e.stateNode.containerInfo),r=e.pendingProps,a===null?e.child=vl(e,null,r,n):nn(a,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Kn(r,s),Bx(a,e,r,s,n);case 7:return nn(a,e,e.pendingProps,n),e.child;case 8:return nn(a,e,e.pendingProps.children,n),e.child;case 12:return nn(a,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,i=s.value,Bt(cp,r._currentValue),r._currentValue=i,o!==null)if(tr(o.value,i)){if(o.children===s.children&&!fn.current){e=Qr(a,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){i=o.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(o.tag===1){c=Br(-1,n&-n),c.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),Yh(o.return,n,e),l.lanes|=n;break}c=c.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(Ce(341));i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Yh(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}nn(a,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,sl(e,n),s=Vn(s),r=r(s),e.flags|=1,nn(a,e,r,n),e.child;case 14:return r=e.type,s=Kn(r,e.pendingProps),s=Kn(r.type,s),qx(a,e,r,s,n);case 15:return V2(a,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Kn(r,s),Pm(a,e),e.tag=1,hn(r)?(a=!0,op(e)):a=!1,sl(e,n),D2(e,r,s),Xh(e,r,s,n),a0(null,e,r,!0,a,n);case 19:return U2(a,e,n);case 22:return O2(a,e,n)}throw Error(Ce(156,e.tag))};function nC(a,e){return T1(a,e)}function UR(a,e,n,r){this.tag=a,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(a,e,n,r){return new UR(a,e,n,r)}function Hv(a){return a=a.prototype,!(!a||!a.isReactComponent)}function $R(a){if(typeof a=="function")return Hv(a)?1:0;if(a!=null){if(a=a.$$typeof,a===mv)return 11;if(a===pv)return 14}return 2}function Bs(a,e){var n=a.alternate;return n===null?(n=Ln(a.tag,e,a.key,a.mode),n.elementType=a.elementType,n.type=a.type,n.stateNode=a.stateNode,n.alternate=a,a.alternate=n):(n.pendingProps=e,n.type=a.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=a.flags&14680064,n.childLanes=a.childLanes,n.lanes=a.lanes,n.child=a.child,n.memoizedProps=a.memoizedProps,n.memoizedState=a.memoizedState,n.updateQueue=a.updateQueue,e=a.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=a.sibling,n.index=a.index,n.ref=a.ref,n}function Lm(a,e,n,r,s,o){var i=2;if(r=a,typeof a=="function")Hv(a)&&(i=1);else if(typeof a=="string")i=5;else e:switch(a){case Ui:return zo(n.children,s,o,e);case dv:i=8,s|=8;break;case wh:return a=Ln(12,n,e,s|2),a.elementType=wh,a.lanes=o,a;case _h:return a=Ln(13,n,e,s),a.elementType=_h,a.lanes=o,a;case Ch:return a=Ln(19,n,e,s),a.elementType=Ch,a.lanes=o,a;case p1:return mg(n,s,o,e);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case d1:i=10;break e;case m1:i=9;break e;case mv:i=11;break e;case pv:i=14;break e;case xs:i=16,r=null;break e}throw Error(Ce(130,a==null?a:typeof a,""))}return e=Ln(i,n,e,s),e.elementType=a,e.type=r,e.lanes=o,e}function zo(a,e,n,r){return a=Ln(7,a,r,e),a.lanes=n,a}function mg(a,e,n,r){return a=Ln(22,a,r,e),a.elementType=p1,a.lanes=n,a.stateNode={isHidden:!1},a}function Vf(a,e,n){return a=Ln(6,a,null,e),a.lanes=n,a}function Of(a,e,n){return e=Ln(4,a.children!==null?a.children:[],a.key,e),e.lanes=n,e.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},e}function BR(a,e,n,r,s){this.tag=e,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vf(0),this.expirationTimes=vf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vf(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Kv(a,e,n,r,s,o,i,l,c){return a=new BR(a,e,n,l,c),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Ln(3,null,null,e),a.current=o,o.stateNode=a,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pv(o),a}function qR(a,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zi,key:r==null?null:""+r,children:a,containerInfo:e,implementation:n}}function rC(a){if(!a)return Hs;a=a._reactInternals;e:{if(mi(a)!==a||a.tag!==1)throw Error(Ce(170));var e=a;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(hn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ce(171))}if(a.tag===1){var n=a.type;if(hn(n))return r2(a,n,e)}return e}function sC(a,e,n,r,s,o,i,l,c){return a=Kv(n,r,!0,a,s,o,i,l,c),a.context=rC(null),n=a.current,r=sn(),s=$s(n),o=Br(r,s),o.callback=e??null,zs(n,o,s),a.current.lanes=s,Qu(a,s,r),vn(a,r),a}function pg(a,e,n,r){var s=e.current,o=sn(),i=$s(s);return n=rC(n),e.context===null?e.context=n:e.pendingContext=n,e=Br(o,i),e.payload={element:a},r=r===void 0?null:r,r!==null&&(e.callback=r),a=zs(s,e,i),a!==null&&(Xn(a,s,i,o),Im(a,s,i)),i}function Ep(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function ay(a,e){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var n=a.retryLane;a.retryLane=n!==0&&n<e?n:e}}function Qv(a,e){ay(a,e),(a=a.alternate)&&ay(a,e)}function WR(){return null}var oC=typeof reportError=="function"?reportError:function(a){console.error(a)};function Jv(a){this._internalRoot=a}gg.prototype.render=Jv.prototype.render=function(a){var e=this._internalRoot;if(e===null)throw Error(Ce(409));pg(a,e,null,null)};gg.prototype.unmount=Jv.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var e=a.containerInfo;Ko(function(){pg(null,a,null,null)}),e[Hr]=null}};function gg(a){this._internalRoot=a}gg.prototype.unstable_scheduleHydration=function(a){if(a){var e=O1();a={blockedOn:null,target:a,priority:e};for(var n=0;n<ws.length&&e!==0&&e<ws[n].priority;n++);ws.splice(n,0,a),n===0&&F1(a)}};function Yv(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function fg(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function ny(){}function GR(a,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var u=Ep(i);o.call(u)}}var i=sC(e,r,a,0,null,!1,!1,"",ny);return a._reactRootContainer=i,a[Hr]=i.current,Eu(a.nodeType===8?a.parentNode:a),Ko(),i}for(;s=a.lastChild;)a.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Ep(c);l.call(u)}}var c=Kv(a,0,!1,null,null,!1,!1,"",ny);return a._reactRootContainer=c,a[Hr]=c.current,Eu(a.nodeType===8?a.parentNode:a),Ko(function(){pg(e,c,n,r)}),c}function hg(a,e,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var l=s;s=function(){var c=Ep(i);l.call(c)}}pg(e,i,a,s)}else i=GR(n,e,a,s,r);return Ep(i)}M1=function(a){switch(a.tag){case 3:var e=a.stateNode;if(e.current.memoizedState.isDehydrated){var n=jc(e.pendingLanes);n!==0&&(hv(e,n|1),vn(e,ga()),!(kt&6)&&(xl=ga()+500,so()))}break;case 13:Ko(function(){var r=Kr(a,1);if(r!==null){var s=sn();Xn(r,a,1,s)}}),Qv(a,1)}};vv=function(a){if(a.tag===13){var e=Kr(a,134217728);if(e!==null){var n=sn();Xn(e,a,134217728,n)}Qv(a,134217728)}};V1=function(a){if(a.tag===13){var e=$s(a),n=Kr(a,e);if(n!==null){var r=sn();Xn(n,a,e,r)}Qv(a,e)}};O1=function(){return Mt};j1=function(a,e){var n=Mt;try{return Mt=a,e()}finally{Mt=n}};Mh=function(a,e,n){switch(e){case"input":if(Ih(a,n),e=n.name,n.type==="radio"&&e!=null){for(n=a;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==a&&r.form===a.form){var s=og(r);if(!s)throw Error(Ce(90));f1(r),Ih(r,s)}}}break;case"textarea":v1(a,n);break;case"select":e=n.value,e!=null&&tl(a,!!n.multiple,e,!1)}};_1=qv;C1=Ko;var HR={usingClientEntryPoint:!1,Events:[Yu,Wi,og,N1,w1,qv]},_c={findFiberByHostInstance:Do,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},KR={bundleType:_c.bundleType,version:_c.version,rendererPackageName:_c.rendererPackageName,rendererConfig:_c.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:as.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=I1(a),a===null?null:a.stateNode},findFiberByHostInstance:_c.findFiberByHostInstance||WR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var im=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!im.isDisabled&&im.supportsFiber)try{ag=im.inject(KR),xr=im}catch{}}In.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HR;In.createPortal=function(a,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yv(e))throw Error(Ce(200));return qR(a,e,null,n)};In.createRoot=function(a,e){if(!Yv(a))throw Error(Ce(299));var n=!1,r="",s=oC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Kv(a,1,!1,null,null,n,!1,r,s),a[Hr]=e.current,Eu(a.nodeType===8?a.parentNode:a),new Jv(e)};In.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var e=a._reactInternals;if(e===void 0)throw typeof a.render=="function"?Error(Ce(188)):(a=Object.keys(a).join(","),Error(Ce(268,a)));return a=I1(e),a=a===null?null:a.stateNode,a};In.flushSync=function(a){return Ko(a)};In.hydrate=function(a,e,n){if(!fg(e))throw Error(Ce(200));return hg(null,a,e,!0,n)};In.hydrateRoot=function(a,e,n){if(!Yv(a))throw Error(Ce(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=oC;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=sC(e,null,a,1,n??null,s,!1,o,i),a[Hr]=e.current,Eu(a),r)for(a=0;a<r.length;a++)n=r[a],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new gg(e)};In.render=function(a,e,n){if(!fg(e))throw Error(Ce(200));return hg(null,a,e,!1,n)};In.unmountComponentAtNode=function(a){if(!fg(a))throw Error(Ce(40));return a._reactRootContainer?(Ko(function(){hg(null,null,a,!1,function(){a._reactRootContainer=null,a[Hr]=null})}),!0):!1};In.unstable_batchedUpdates=qv;In.unstable_renderSubtreeIntoContainer=function(a,e,n,r){if(!fg(n))throw Error(Ce(200));if(a==null||a._reactInternals===void 0)throw Error(Ce(38));return hg(a,e,n,!1,r)};In.version="18.3.1-next-f1338f8080-20240426";function iC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(iC)}catch(a){console.error(a)}}iC(),i1.exports=In;var pi=i1.exports,ry=pi;yh.createRoot=ry.createRoot,yh.hydrateRoot=ry.hydrateRoot;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lC=function(a){const e=[];let n=0;for(let r=0;r<a.length;r++){let s=a.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<a.length&&(a.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(a.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},QR=function(a){const e=[];let n=0,r=0;for(;n<a.length;){const s=a[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const o=a[n++];e[r++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=a[n++],i=a[n++],l=a[n++],c=((s&7)<<18|(o&63)<<12|(i&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const o=a[n++],i=a[n++];e[r++]=String.fromCharCode((s&15)<<12|(o&63)<<6|i&63)}}return e.join("")},cC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(a,e){if(!Array.isArray(a))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<a.length;s+=3){const o=a[s],i=s+1<a.length,l=i?a[s+1]:0,c=s+2<a.length,u=c?a[s+2]:0,d=o>>2,m=(o&3)<<4|l>>4;let h=(l&15)<<2|u>>6,C=u&63;c||(C=64,i||(h=64)),r.push(n[d],n[m],n[h],n[C])}return r.join("")},encodeString(a,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(a):this.encodeByteArray(lC(a),e)},decodeString(a,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(a):QR(this.decodeStringToByteArray(a,e))},decodeStringToByteArray(a,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<a.length;){const o=n[a.charAt(s++)],l=s<a.length?n[a.charAt(s)]:0;++s;const u=s<a.length?n[a.charAt(s)]:64;++s;const m=s<a.length?n[a.charAt(s)]:64;if(++s,o==null||l==null||u==null||m==null)throw new JR;const h=o<<2|l>>4;if(r.push(h),u!==64){const C=l<<4&240|u>>2;if(r.push(C),m!==64){const S=u<<6&192|m;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let a=0;a<this.ENCODED_VALS.length;a++)this.byteToCharMap_[a]=this.ENCODED_VALS.charAt(a),this.charToByteMap_[this.byteToCharMap_[a]]=a,this.byteToCharMapWebSafe_[a]=this.ENCODED_VALS_WEBSAFE.charAt(a),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[a]]=a,a>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(a)]=a,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(a)]=a)}}};class JR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const YR=function(a){const e=lC(a);return cC.encodeByteArray(e,!0)},xp=function(a){return YR(a).replace(/\./g,"")},uC=function(a){try{return cC.decodeString(a,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR=()=>ZR().__FIREBASE_DEFAULTS__,e4=()=>{if(typeof process>"u"||typeof process.env>"u")return;const a={}.__FIREBASE_DEFAULTS__;if(a)return JSON.parse(a)},t4=()=>{if(typeof document>"u")return;let a;try{a=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=a&&uC(a[1]);return e&&JSON.parse(e)},vg=()=>{try{return XR()||e4()||t4()}catch(a){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${a}`);return}},dC=a=>{var e,n;return(n=(e=vg())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[a]},mC=a=>{const e=dC(a);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},pC=()=>{var a;return(a=vg())===null||a===void 0?void 0:a.config},gC=a=>{var e;return(e=vg())===null||e===void 0?void 0:e[`_${a}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a4{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fC(a,e){if(a.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=a.iat||0,o=a.sub||a.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},a),l="";return[xp(JSON.stringify(n)),xp(JSON.stringify(i)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _a(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function n4(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_a())}function r4(){var a;const e=(a=vg())===null||a===void 0?void 0:a.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function s4(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function o4(){const a=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof a=="object"&&a.id!==void 0}function i4(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function l4(){const a=_a();return a.indexOf("MSIE ")>=0||a.indexOf("Trident/")>=0}function hC(){return!r4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Zv(){try{return typeof indexedDB=="object"}catch{return!1}}function vC(){return new Promise((a,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),a(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){e(n)}})}function c4(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u4="FirebaseError";class rr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=u4,Object.setPrototypeOf(this,rr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,gi.prototype.create)}}class gi{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,o=this.errors[e],i=o?d4(o,r):"Error",l=`${this.serviceName}: ${i} (${s}).`;return new rr(s,l,r)}}function d4(a,e){return a.replace(m4,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const m4=/\{\$([^}]+)}/g;function p4(a){for(const e in a)if(Object.prototype.hasOwnProperty.call(a,e))return!1;return!0}function Ks(a,e){if(a===e)return!0;const n=Object.keys(a),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const o=a[s],i=e[s];if(sy(o)&&sy(i)){if(!Ks(o,i))return!1}else if(o!==i)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function sy(a){return a!==null&&typeof a=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xu(a){const e=[];for(const[n,r]of Object.entries(a))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function zc(a){const e={};return a.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,o]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function Uc(a){const e=a.indexOf("?");if(!e)return"";const n=a.indexOf("#",e);return a.substring(e,n>0?n:void 0)}function g4(a,e){const n=new f4(a,e);return n.subscribe.bind(n)}class f4{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");h4(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=jf),s.error===void 0&&(s.error=jf),s.complete===void 0&&(s.complete=jf);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function h4(a,e){if(typeof a!="object"||a===null)return!1;for(const n of e)if(n in a&&typeof a[n]=="function")return!0;return!1}function jf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(a){return a&&a._delegate?a._delegate:a}class jn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const So="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v4{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new a4;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(E4(e))try{this.getOrInitializeService({instanceIdentifier:So})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:s});r.resolve(o)}catch{}}}}clearInstance(e=So){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=So){return this.instances.has(e)}getOptions(e=So){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);r===l&&i.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),o=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(s,o);const i=this.instances.get(s);return i&&e(i,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:b4(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=So){return this.component?this.component.multipleInstances?e:So:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function b4(a){return a===So?void 0:a}function E4(a){return a.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new v4(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yt;(function(a){a[a.DEBUG=0]="DEBUG",a[a.VERBOSE=1]="VERBOSE",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.SILENT=5]="SILENT"})(yt||(yt={}));const y4={debug:yt.DEBUG,verbose:yt.VERBOSE,info:yt.INFO,warn:yt.WARN,error:yt.ERROR,silent:yt.SILENT},N4=yt.INFO,w4={[yt.DEBUG]:"log",[yt.VERBOSE]:"log",[yt.INFO]:"info",[yt.WARN]:"warn",[yt.ERROR]:"error"},_4=(a,e,...n)=>{if(e<a.logLevel)return;const r=new Date().toISOString(),s=w4[e];if(s)console[s](`[${r}]  ${a.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Xv{constructor(e){this.name=e,this._logLevel=N4,this._logHandler=_4,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?y4[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,yt.DEBUG,...e),this._logHandler(this,yt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,yt.VERBOSE,...e),this._logHandler(this,yt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,yt.INFO,...e),this._logHandler(this,yt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,yt.WARN,...e),this._logHandler(this,yt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,yt.ERROR,...e),this._logHandler(this,yt.ERROR,...e)}}const C4=(a,e)=>e.some(n=>a instanceof n);let oy,iy;function S4(){return oy||(oy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function k4(){return iy||(iy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const bC=new WeakMap,g0=new WeakMap,EC=new WeakMap,Ff=new WeakMap,eb=new WeakMap;function I4(a){const e=new Promise((n,r)=>{const s=()=>{a.removeEventListener("success",o),a.removeEventListener("error",i)},o=()=>{n(qr(a.result)),s()},i=()=>{r(a.error),s()};a.addEventListener("success",o),a.addEventListener("error",i)});return e.then(n=>{n instanceof IDBCursor&&bC.set(n,a)}).catch(()=>{}),eb.set(e,a),e}function A4(a){if(g0.has(a))return;const e=new Promise((n,r)=>{const s=()=>{a.removeEventListener("complete",o),a.removeEventListener("error",i),a.removeEventListener("abort",i)},o=()=>{n(),s()},i=()=>{r(a.error||new DOMException("AbortError","AbortError")),s()};a.addEventListener("complete",o),a.addEventListener("error",i),a.addEventListener("abort",i)});g0.set(a,e)}let f0={get(a,e,n){if(a instanceof IDBTransaction){if(e==="done")return g0.get(a);if(e==="objectStoreNames")return a.objectStoreNames||EC.get(a);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return qr(a[e])},set(a,e,n){return a[e]=n,!0},has(a,e){return a instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in a}};function T4(a){f0=a(f0)}function P4(a){return a===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=a.call(zf(this),e,...n);return EC.set(r,e.sort?e.sort():[e]),qr(r)}:k4().includes(a)?function(...e){return a.apply(zf(this),e),qr(bC.get(this))}:function(...e){return qr(a.apply(zf(this),e))}}function R4(a){return typeof a=="function"?P4(a):(a instanceof IDBTransaction&&A4(a),C4(a,S4())?new Proxy(a,f0):a)}function qr(a){if(a instanceof IDBRequest)return I4(a);if(Ff.has(a))return Ff.get(a);const e=R4(a);return e!==a&&(Ff.set(a,e),eb.set(e,a)),e}const zf=a=>eb.get(a);function bg(a,e,{blocked:n,upgrade:r,blocking:s,terminated:o}={}){const i=indexedDB.open(a,e),l=qr(i);return r&&i.addEventListener("upgradeneeded",c=>{r(qr(i.result),c.oldVersion,c.newVersion,qr(i.transaction),c)}),n&&i.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{o&&c.addEventListener("close",()=>o()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}function Uf(a,{blocked:e}={}){const n=indexedDB.deleteDatabase(a);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),qr(n).then(()=>{})}const D4=["get","getKey","getAll","getAllKeys","count"],L4=["put","add","delete","clear"],$f=new Map;function ly(a,e){if(!(a instanceof IDBDatabase&&!(e in a)&&typeof e=="string"))return;if($f.get(e))return $f.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=L4.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||D4.includes(n)))return;const o=async function(i,...l){const c=this.transaction(i,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return $f.set(e,o),o}T4(a=>({...a,get:(e,n,r)=>ly(e,n)||a.get(e,n,r),has:(e,n)=>!!ly(e,n)||a.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(V4(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function V4(a){const e=a.getComponent();return(e==null?void 0:e.type)==="VERSION"}const h0="@firebase/app",cy="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr=new Xv("@firebase/app"),O4="@firebase/app-compat",j4="@firebase/analytics-compat",F4="@firebase/analytics",z4="@firebase/app-check-compat",U4="@firebase/app-check",$4="@firebase/auth",B4="@firebase/auth-compat",q4="@firebase/database",W4="@firebase/data-connect",G4="@firebase/database-compat",H4="@firebase/functions",K4="@firebase/functions-compat",Q4="@firebase/installations",J4="@firebase/installations-compat",Y4="@firebase/messaging",Z4="@firebase/messaging-compat",X4="@firebase/performance",e6="@firebase/performance-compat",t6="@firebase/remote-config",a6="@firebase/remote-config-compat",n6="@firebase/storage",r6="@firebase/storage-compat",s6="@firebase/firestore",o6="@firebase/vertexai-preview",i6="@firebase/firestore-compat",l6="firebase",c6="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yp="[DEFAULT]",u6={[h0]:"fire-core",[O4]:"fire-core-compat",[F4]:"fire-analytics",[j4]:"fire-analytics-compat",[U4]:"fire-app-check",[z4]:"fire-app-check-compat",[$4]:"fire-auth",[B4]:"fire-auth-compat",[q4]:"fire-rtdb",[W4]:"fire-data-connect",[G4]:"fire-rtdb-compat",[H4]:"fire-fn",[K4]:"fire-fn-compat",[Q4]:"fire-iid",[J4]:"fire-iid-compat",[Y4]:"fire-fcm",[Z4]:"fire-fcm-compat",[X4]:"fire-perf",[e6]:"fire-perf-compat",[t6]:"fire-rc",[a6]:"fire-rc-compat",[n6]:"fire-gcs",[r6]:"fire-gcs-compat",[s6]:"fire-fst",[i6]:"fire-fst-compat",[o6]:"fire-vertex","fire-js":"fire-js",[l6]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Np=new Map,d6=new Map,v0=new Map;function uy(a,e){try{a.container.addComponent(e)}catch(n){Jr.debug(`Component ${e.name} failed to register with FirebaseApp ${a.name}`,n)}}function ar(a){const e=a.name;if(v0.has(e))return Jr.debug(`There were multiple attempts to register component ${e}.`),!1;v0.set(e,a);for(const n of Np.values())uy(n,a);for(const n of d6.values())uy(n,a);return!0}function ns(a,e){const n=a.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),a.container.getProvider(e)}function m6(a,e,n=yp){ns(a,e).clearInstance(n)}function Yn(a){return a.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p6={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qs=new gi("app","Firebase",p6);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new jn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi=c6;function xC(a,e={}){let n=a;typeof e!="object"&&(e={name:e});const r=Object.assign({name:yp,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw qs.create("bad-app-name",{appName:String(s)});if(n||(n=pC()),!n)throw qs.create("no-options");const o=Np.get(s);if(o){if(Ks(n,o.options)&&Ks(r,o.config))return o;throw qs.create("duplicate-app",{appName:s})}const i=new x4(s);for(const c of v0.values())i.addComponent(c);const l=new g6(n,r,i);return Np.set(s,l),l}function Eg(a=yp){const e=Np.get(a);if(!e&&a===yp&&pC())return xC();if(!e)throw qs.create("no-app",{appName:a});return e}function bn(a,e,n){var r;let s=(r=u6[a])!==null&&r!==void 0?r:a;n&&(s+=`-${n}`);const o=s.match(/\s|\//),i=e.match(/\s|\//);if(o||i){const l=[`Unable to register library "${s}" with version "${e}":`];o&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&i&&l.push("and"),i&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Jr.warn(l.join(" "));return}ar(new jn(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f6="firebase-heartbeat-database",h6=1,Iu="firebase-heartbeat-store";let Bf=null;function yC(){return Bf||(Bf=bg(f6,h6,{upgrade:(a,e)=>{switch(e){case 0:try{a.createObjectStore(Iu)}catch(n){console.warn(n)}}}}).catch(a=>{throw qs.create("idb-open",{originalErrorMessage:a.message})})),Bf}async function v6(a){try{const n=(await yC()).transaction(Iu),r=await n.objectStore(Iu).get(NC(a));return await n.done,r}catch(e){if(e instanceof rr)Jr.warn(e.message);else{const n=qs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Jr.warn(n.message)}}}async function dy(a,e){try{const r=(await yC()).transaction(Iu,"readwrite");await r.objectStore(Iu).put(e,NC(a)),await r.done}catch(n){if(n instanceof rr)Jr.warn(n.message);else{const r=qs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Jr.warn(r.message)}}}function NC(a){return`${a.name}!${a.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b6=1024,E6=30*24*60*60*1e3;class x6{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new N6(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=my();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(i=>i.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const l=new Date(i.date).valueOf();return Date.now()-l<=E6}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Jr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=my(),{heartbeatsToSend:r,unsentEntries:s}=y6(this._heartbeatsCache.heartbeats),o=xp(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return Jr.warn(n),""}}}function my(){return new Date().toISOString().substring(0,10)}function y6(a,e=b6){const n=[];let r=a.slice();for(const s of a){const o=n.find(i=>i.agent===s.agent);if(o){if(o.dates.push(s.date),py(n)>e){o.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),py(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class N6{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Zv()?vC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await v6(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return dy(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return dy(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function py(a){return xp(JSON.stringify({version:2,heartbeats:a})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w6(a){ar(new jn("platform-logger",e=>new M4(e),"PRIVATE")),ar(new jn("heartbeat",e=>new x6(e),"PRIVATE")),bn(h0,cy,a),bn(h0,cy,"esm2017"),bn("fire-js","")}w6("");var _6="firebase",C6="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bn(_6,C6,"app");var gy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Uo,wC;(function(){var a;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(y,E){function _(){}_.prototype=E.prototype,y.D=E.prototype,y.prototype=new _,y.prototype.constructor=y,y.C=function(P,k,D){for(var M=Array(arguments.length-2),$=2;$<arguments.length;$++)M[$-2]=arguments[$];return E.prototype[k].apply(P,M)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(y,E,_){_||(_=0);var P=Array(16);if(typeof E=="string")for(var k=0;16>k;++k)P[k]=E.charCodeAt(_++)|E.charCodeAt(_++)<<8|E.charCodeAt(_++)<<16|E.charCodeAt(_++)<<24;else for(k=0;16>k;++k)P[k]=E[_++]|E[_++]<<8|E[_++]<<16|E[_++]<<24;E=y.g[0],_=y.g[1],k=y.g[2];var D=y.g[3],M=E+(D^_&(k^D))+P[0]+3614090360&4294967295;E=_+(M<<7&4294967295|M>>>25),M=D+(k^E&(_^k))+P[1]+3905402710&4294967295,D=E+(M<<12&4294967295|M>>>20),M=k+(_^D&(E^_))+P[2]+606105819&4294967295,k=D+(M<<17&4294967295|M>>>15),M=_+(E^k&(D^E))+P[3]+3250441966&4294967295,_=k+(M<<22&4294967295|M>>>10),M=E+(D^_&(k^D))+P[4]+4118548399&4294967295,E=_+(M<<7&4294967295|M>>>25),M=D+(k^E&(_^k))+P[5]+1200080426&4294967295,D=E+(M<<12&4294967295|M>>>20),M=k+(_^D&(E^_))+P[6]+2821735955&4294967295,k=D+(M<<17&4294967295|M>>>15),M=_+(E^k&(D^E))+P[7]+4249261313&4294967295,_=k+(M<<22&4294967295|M>>>10),M=E+(D^_&(k^D))+P[8]+1770035416&4294967295,E=_+(M<<7&4294967295|M>>>25),M=D+(k^E&(_^k))+P[9]+2336552879&4294967295,D=E+(M<<12&4294967295|M>>>20),M=k+(_^D&(E^_))+P[10]+4294925233&4294967295,k=D+(M<<17&4294967295|M>>>15),M=_+(E^k&(D^E))+P[11]+2304563134&4294967295,_=k+(M<<22&4294967295|M>>>10),M=E+(D^_&(k^D))+P[12]+1804603682&4294967295,E=_+(M<<7&4294967295|M>>>25),M=D+(k^E&(_^k))+P[13]+4254626195&4294967295,D=E+(M<<12&4294967295|M>>>20),M=k+(_^D&(E^_))+P[14]+2792965006&4294967295,k=D+(M<<17&4294967295|M>>>15),M=_+(E^k&(D^E))+P[15]+1236535329&4294967295,_=k+(M<<22&4294967295|M>>>10),M=E+(k^D&(_^k))+P[1]+4129170786&4294967295,E=_+(M<<5&4294967295|M>>>27),M=D+(_^k&(E^_))+P[6]+3225465664&4294967295,D=E+(M<<9&4294967295|M>>>23),M=k+(E^_&(D^E))+P[11]+643717713&4294967295,k=D+(M<<14&4294967295|M>>>18),M=_+(D^E&(k^D))+P[0]+3921069994&4294967295,_=k+(M<<20&4294967295|M>>>12),M=E+(k^D&(_^k))+P[5]+3593408605&4294967295,E=_+(M<<5&4294967295|M>>>27),M=D+(_^k&(E^_))+P[10]+38016083&4294967295,D=E+(M<<9&4294967295|M>>>23),M=k+(E^_&(D^E))+P[15]+3634488961&4294967295,k=D+(M<<14&4294967295|M>>>18),M=_+(D^E&(k^D))+P[4]+3889429448&4294967295,_=k+(M<<20&4294967295|M>>>12),M=E+(k^D&(_^k))+P[9]+568446438&4294967295,E=_+(M<<5&4294967295|M>>>27),M=D+(_^k&(E^_))+P[14]+3275163606&4294967295,D=E+(M<<9&4294967295|M>>>23),M=k+(E^_&(D^E))+P[3]+4107603335&4294967295,k=D+(M<<14&4294967295|M>>>18),M=_+(D^E&(k^D))+P[8]+1163531501&4294967295,_=k+(M<<20&4294967295|M>>>12),M=E+(k^D&(_^k))+P[13]+2850285829&4294967295,E=_+(M<<5&4294967295|M>>>27),M=D+(_^k&(E^_))+P[2]+4243563512&4294967295,D=E+(M<<9&4294967295|M>>>23),M=k+(E^_&(D^E))+P[7]+1735328473&4294967295,k=D+(M<<14&4294967295|M>>>18),M=_+(D^E&(k^D))+P[12]+2368359562&4294967295,_=k+(M<<20&4294967295|M>>>12),M=E+(_^k^D)+P[5]+4294588738&4294967295,E=_+(M<<4&4294967295|M>>>28),M=D+(E^_^k)+P[8]+2272392833&4294967295,D=E+(M<<11&4294967295|M>>>21),M=k+(D^E^_)+P[11]+1839030562&4294967295,k=D+(M<<16&4294967295|M>>>16),M=_+(k^D^E)+P[14]+4259657740&4294967295,_=k+(M<<23&4294967295|M>>>9),M=E+(_^k^D)+P[1]+2763975236&4294967295,E=_+(M<<4&4294967295|M>>>28),M=D+(E^_^k)+P[4]+1272893353&4294967295,D=E+(M<<11&4294967295|M>>>21),M=k+(D^E^_)+P[7]+4139469664&4294967295,k=D+(M<<16&4294967295|M>>>16),M=_+(k^D^E)+P[10]+3200236656&4294967295,_=k+(M<<23&4294967295|M>>>9),M=E+(_^k^D)+P[13]+681279174&4294967295,E=_+(M<<4&4294967295|M>>>28),M=D+(E^_^k)+P[0]+3936430074&4294967295,D=E+(M<<11&4294967295|M>>>21),M=k+(D^E^_)+P[3]+3572445317&4294967295,k=D+(M<<16&4294967295|M>>>16),M=_+(k^D^E)+P[6]+76029189&4294967295,_=k+(M<<23&4294967295|M>>>9),M=E+(_^k^D)+P[9]+3654602809&4294967295,E=_+(M<<4&4294967295|M>>>28),M=D+(E^_^k)+P[12]+3873151461&4294967295,D=E+(M<<11&4294967295|M>>>21),M=k+(D^E^_)+P[15]+530742520&4294967295,k=D+(M<<16&4294967295|M>>>16),M=_+(k^D^E)+P[2]+3299628645&4294967295,_=k+(M<<23&4294967295|M>>>9),M=E+(k^(_|~D))+P[0]+4096336452&4294967295,E=_+(M<<6&4294967295|M>>>26),M=D+(_^(E|~k))+P[7]+1126891415&4294967295,D=E+(M<<10&4294967295|M>>>22),M=k+(E^(D|~_))+P[14]+2878612391&4294967295,k=D+(M<<15&4294967295|M>>>17),M=_+(D^(k|~E))+P[5]+4237533241&4294967295,_=k+(M<<21&4294967295|M>>>11),M=E+(k^(_|~D))+P[12]+1700485571&4294967295,E=_+(M<<6&4294967295|M>>>26),M=D+(_^(E|~k))+P[3]+2399980690&4294967295,D=E+(M<<10&4294967295|M>>>22),M=k+(E^(D|~_))+P[10]+4293915773&4294967295,k=D+(M<<15&4294967295|M>>>17),M=_+(D^(k|~E))+P[1]+2240044497&4294967295,_=k+(M<<21&4294967295|M>>>11),M=E+(k^(_|~D))+P[8]+1873313359&4294967295,E=_+(M<<6&4294967295|M>>>26),M=D+(_^(E|~k))+P[15]+4264355552&4294967295,D=E+(M<<10&4294967295|M>>>22),M=k+(E^(D|~_))+P[6]+2734768916&4294967295,k=D+(M<<15&4294967295|M>>>17),M=_+(D^(k|~E))+P[13]+1309151649&4294967295,_=k+(M<<21&4294967295|M>>>11),M=E+(k^(_|~D))+P[4]+4149444226&4294967295,E=_+(M<<6&4294967295|M>>>26),M=D+(_^(E|~k))+P[11]+3174756917&4294967295,D=E+(M<<10&4294967295|M>>>22),M=k+(E^(D|~_))+P[2]+718787259&4294967295,k=D+(M<<15&4294967295|M>>>17),M=_+(D^(k|~E))+P[9]+3951481745&4294967295,y.g[0]=y.g[0]+E&4294967295,y.g[1]=y.g[1]+(k+(M<<21&4294967295|M>>>11))&4294967295,y.g[2]=y.g[2]+k&4294967295,y.g[3]=y.g[3]+D&4294967295}r.prototype.u=function(y,E){E===void 0&&(E=y.length);for(var _=E-this.blockSize,P=this.B,k=this.h,D=0;D<E;){if(k==0)for(;D<=_;)s(this,y,D),D+=this.blockSize;if(typeof y=="string"){for(;D<E;)if(P[k++]=y.charCodeAt(D++),k==this.blockSize){s(this,P),k=0;break}}else for(;D<E;)if(P[k++]=y[D++],k==this.blockSize){s(this,P),k=0;break}}this.h=k,this.o+=E},r.prototype.v=function(){var y=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);y[0]=128;for(var E=1;E<y.length-8;++E)y[E]=0;var _=8*this.o;for(E=y.length-8;E<y.length;++E)y[E]=_&255,_/=256;for(this.u(y),y=Array(16),E=_=0;4>E;++E)for(var P=0;32>P;P+=8)y[_++]=this.g[E]>>>P&255;return y};function o(y,E){var _=l;return Object.prototype.hasOwnProperty.call(_,y)?_[y]:_[y]=E(y)}function i(y,E){this.h=E;for(var _=[],P=!0,k=y.length-1;0<=k;k--){var D=y[k]|0;P&&D==E||(_[k]=D,P=!1)}this.g=_}var l={};function c(y){return-128<=y&&128>y?o(y,function(E){return new i([E|0],0>E?-1:0)}):new i([y|0],0>y?-1:0)}function u(y){if(isNaN(y)||!isFinite(y))return m;if(0>y)return f(u(-y));for(var E=[],_=1,P=0;y>=_;P++)E[P]=y/_|0,_*=4294967296;return new i(E,0)}function d(y,E){if(y.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(y.charAt(0)=="-")return f(d(y.substring(1),E));if(0<=y.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=u(Math.pow(E,8)),P=m,k=0;k<y.length;k+=8){var D=Math.min(8,y.length-k),M=parseInt(y.substring(k,k+D),E);8>D?(D=u(Math.pow(E,D)),P=P.j(D).add(u(M))):(P=P.j(_),P=P.add(u(M)))}return P}var m=c(0),h=c(1),C=c(16777216);a=i.prototype,a.m=function(){if(w(this))return-f(this).m();for(var y=0,E=1,_=0;_<this.g.length;_++){var P=this.i(_);y+=(0<=P?P:4294967296+P)*E,E*=4294967296}return y},a.toString=function(y){if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(S(this))return"0";if(w(this))return"-"+f(this).toString(y);for(var E=u(Math.pow(y,6)),_=this,P="";;){var k=A(_,E).g;_=b(_,k.j(E));var D=((0<_.g.length?_.g[0]:_.h)>>>0).toString(y);if(_=k,S(_))return D+P;for(;6>D.length;)D="0"+D;P=D+P}},a.i=function(y){return 0>y?0:y<this.g.length?this.g[y]:this.h};function S(y){if(y.h!=0)return!1;for(var E=0;E<y.g.length;E++)if(y.g[E]!=0)return!1;return!0}function w(y){return y.h==-1}a.l=function(y){return y=b(this,y),w(y)?-1:S(y)?0:1};function f(y){for(var E=y.g.length,_=[],P=0;P<E;P++)_[P]=~y.g[P];return new i(_,~y.h).add(h)}a.abs=function(){return w(this)?f(this):this},a.add=function(y){for(var E=Math.max(this.g.length,y.g.length),_=[],P=0,k=0;k<=E;k++){var D=P+(this.i(k)&65535)+(y.i(k)&65535),M=(D>>>16)+(this.i(k)>>>16)+(y.i(k)>>>16);P=M>>>16,D&=65535,M&=65535,_[k]=M<<16|D}return new i(_,_[_.length-1]&-2147483648?-1:0)};function b(y,E){return y.add(f(E))}a.j=function(y){if(S(this)||S(y))return m;if(w(this))return w(y)?f(this).j(f(y)):f(f(this).j(y));if(w(y))return f(this.j(f(y)));if(0>this.l(C)&&0>y.l(C))return u(this.m()*y.m());for(var E=this.g.length+y.g.length,_=[],P=0;P<2*E;P++)_[P]=0;for(P=0;P<this.g.length;P++)for(var k=0;k<y.g.length;k++){var D=this.i(P)>>>16,M=this.i(P)&65535,$=y.i(k)>>>16,q=y.i(k)&65535;_[2*P+2*k]+=M*q,v(_,2*P+2*k),_[2*P+2*k+1]+=D*q,v(_,2*P+2*k+1),_[2*P+2*k+1]+=M*$,v(_,2*P+2*k+1),_[2*P+2*k+2]+=D*$,v(_,2*P+2*k+2)}for(P=0;P<E;P++)_[P]=_[2*P+1]<<16|_[2*P];for(P=E;P<2*E;P++)_[P]=0;return new i(_,0)};function v(y,E){for(;(y[E]&65535)!=y[E];)y[E+1]+=y[E]>>>16,y[E]&=65535,E++}function I(y,E){this.g=y,this.h=E}function A(y,E){if(S(E))throw Error("division by zero");if(S(y))return new I(m,m);if(w(y))return E=A(f(y),E),new I(f(E.g),f(E.h));if(w(E))return E=A(y,f(E)),new I(f(E.g),E.h);if(30<y.g.length){if(w(y)||w(E))throw Error("slowDivide_ only works with positive integers.");for(var _=h,P=E;0>=P.l(y);)_=N(_),P=N(P);var k=x(_,1),D=x(P,1);for(P=x(P,2),_=x(_,2);!S(P);){var M=D.add(P);0>=M.l(y)&&(k=k.add(_),D=M),P=x(P,1),_=x(_,1)}return E=b(y,k.j(E)),new I(k,E)}for(k=m;0<=y.l(E);){for(_=Math.max(1,Math.floor(y.m()/E.m())),P=Math.ceil(Math.log(_)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),D=u(_),M=D.j(E);w(M)||0<M.l(y);)_-=P,D=u(_),M=D.j(E);S(D)&&(D=h),k=k.add(D),y=b(y,M)}return new I(k,y)}a.A=function(y){return A(this,y).h},a.and=function(y){for(var E=Math.max(this.g.length,y.g.length),_=[],P=0;P<E;P++)_[P]=this.i(P)&y.i(P);return new i(_,this.h&y.h)},a.or=function(y){for(var E=Math.max(this.g.length,y.g.length),_=[],P=0;P<E;P++)_[P]=this.i(P)|y.i(P);return new i(_,this.h|y.h)},a.xor=function(y){for(var E=Math.max(this.g.length,y.g.length),_=[],P=0;P<E;P++)_[P]=this.i(P)^y.i(P);return new i(_,this.h^y.h)};function N(y){for(var E=y.g.length+1,_=[],P=0;P<E;P++)_[P]=y.i(P)<<1|y.i(P-1)>>>31;return new i(_,y.h)}function x(y,E){var _=E>>5;E%=32;for(var P=y.g.length-_,k=[],D=0;D<P;D++)k[D]=0<E?y.i(D+_)>>>E|y.i(D+_+1)<<32-E:y.i(D+_);return new i(k,y.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,wC=r,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=u,i.fromString=d,Uo=i}).apply(typeof gy<"u"?gy:typeof self<"u"?self:typeof window<"u"?window:{});var lm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _C,$c,CC,Mm,b0,SC,kC,IC;(function(){var a,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(g,T,R){return g==Array.prototype||g==Object.prototype||(g[T]=R.value),g};function n(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof lm=="object"&&lm];for(var T=0;T<g.length;++T){var R=g[T];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var r=n(this);function s(g,T){if(T)e:{var R=r;g=g.split(".");for(var O=0;O<g.length-1;O++){var J=g[O];if(!(J in R))break e;R=R[J]}g=g[g.length-1],O=R[g],T=T(O),T!=O&&T!=null&&e(R,g,{configurable:!0,writable:!0,value:T})}}function o(g,T){g instanceof String&&(g+="");var R=0,O=!1,J={next:function(){if(!O&&R<g.length){var re=R++;return{value:T(re,g[re]),done:!1}}return O=!0,{done:!0,value:void 0}}};return J[Symbol.iterator]=function(){return J},J}s("Array.prototype.values",function(g){return g||function(){return o(this,function(T,R){return R})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},l=this||self;function c(g){var T=typeof g;return T=T!="object"?T:g?Array.isArray(g)?"array":T:"null",T=="array"||T=="object"&&typeof g.length=="number"}function u(g){var T=typeof g;return T=="object"&&g!=null||T=="function"}function d(g,T,R){return g.call.apply(g.bind,arguments)}function m(g,T,R){if(!g)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var J=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(J,O),g.apply(T,J)}}return function(){return g.apply(T,arguments)}}function h(g,T,R){return h=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:m,h.apply(null,arguments)}function C(g,T){var R=Array.prototype.slice.call(arguments,1);return function(){var O=R.slice();return O.push.apply(O,arguments),g.apply(this,O)}}function S(g,T){function R(){}R.prototype=T.prototype,g.aa=T.prototype,g.prototype=new R,g.prototype.constructor=g,g.Qb=function(O,J,re){for(var Ie=Array(arguments.length-2),Ft=2;Ft<arguments.length;Ft++)Ie[Ft-2]=arguments[Ft];return T.prototype[J].apply(O,Ie)}}function w(g){const T=g.length;if(0<T){const R=Array(T);for(let O=0;O<T;O++)R[O]=g[O];return R}return[]}function f(g,T){for(let R=1;R<arguments.length;R++){const O=arguments[R];if(c(O)){const J=g.length||0,re=O.length||0;g.length=J+re;for(let Ie=0;Ie<re;Ie++)g[J+Ie]=O[Ie]}else g.push(O)}}class b{constructor(T,R){this.i=T,this.j=R,this.h=0,this.g=null}get(){let T;return 0<this.h?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function v(g){return/^[\s\xa0]*$/.test(g)}function I(){var g=l.navigator;return g&&(g=g.userAgent)?g:""}function A(g){return A[" "](g),g}A[" "]=function(){};var N=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function x(g,T,R){for(const O in g)T.call(R,g[O],O,g)}function y(g,T){for(const R in g)T.call(void 0,g[R],R,g)}function E(g){const T={};for(const R in g)T[R]=g[R];return T}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(g,T){let R,O;for(let J=1;J<arguments.length;J++){O=arguments[J];for(R in O)g[R]=O[R];for(let re=0;re<_.length;re++)R=_[re],Object.prototype.hasOwnProperty.call(O,R)&&(g[R]=O[R])}}function k(g){var T=1;g=g.split(":");const R=[];for(;0<T&&g.length;)R.push(g.shift()),T--;return g.length&&R.push(g.join(":")),R}function D(g){l.setTimeout(()=>{throw g},0)}function M(){var g=U;let T=null;return g.g&&(T=g.g,g.g=g.g.next,g.g||(g.h=null),T.next=null),T}class ${constructor(){this.h=this.g=null}add(T,R){const O=q.get();O.set(T,R),this.h?this.h.next=O:this.g=O,this.h=O}}var q=new b(()=>new V,g=>g.reset());class V{constructor(){this.next=this.g=this.h=null}set(T,R){this.h=T,this.g=R,this.next=null}reset(){this.next=this.g=this.h=null}}let z,j=!1,U=new $,Q=()=>{const g=l.Promise.resolve(void 0);z=()=>{g.then(te)}};var te=()=>{for(var g;g=M();){try{g.h.call(g.g)}catch(R){D(R)}var T=q;T.j(g),100>T.h&&(T.h++,g.next=T.g,T.g=g)}j=!1};function se(){this.s=this.s,this.C=this.C}se.prototype.s=!1,se.prototype.ma=function(){this.s||(this.s=!0,this.N())},se.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function X(g,T){this.type=g,this.g=this.target=T,this.defaultPrevented=!1}X.prototype.h=function(){this.defaultPrevented=!0};var ye=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var g=!1,T=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const R=()=>{};l.addEventListener("test",R,T),l.removeEventListener("test",R,T)}catch{}return g}();function Y(g,T){if(X.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g){var R=this.type=g.type,O=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;if(this.target=g.target||g.srcElement,this.g=T,T=g.relatedTarget){if(N){e:{try{A(T.nodeName);var J=!0;break e}catch{}J=!1}J||(T=null)}}else R=="mouseover"?T=g.fromElement:R=="mouseout"&&(T=g.toElement);this.relatedTarget=T,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=typeof g.pointerType=="string"?g.pointerType:Se[g.pointerType]||"",this.state=g.state,this.i=g,g.defaultPrevented&&Y.aa.h.call(this)}}S(Y,X);var Se={2:"touch",3:"pen",4:"mouse"};Y.prototype.h=function(){Y.aa.h.call(this);var g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),oe=0;function ge(g,T,R,O,J){this.listener=g,this.proxy=null,this.src=T,this.type=R,this.capture=!!O,this.ha=J,this.key=++oe,this.da=this.fa=!1}function me(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function he(g){this.src=g,this.g={},this.h=0}he.prototype.add=function(g,T,R,O,J){var re=g.toString();g=this.g[re],g||(g=this.g[re]=[],this.h++);var Ie=we(g,T,O,J);return-1<Ie?(T=g[Ie],R||(T.fa=!1)):(T=new ge(T,this.src,re,!!O,J),T.fa=R,g.push(T)),T};function G(g,T){var R=T.type;if(R in g.g){var O=g.g[R],J=Array.prototype.indexOf.call(O,T,void 0),re;(re=0<=J)&&Array.prototype.splice.call(O,J,1),re&&(me(T),g.g[R].length==0&&(delete g.g[R],g.h--))}}function we(g,T,R,O){for(var J=0;J<g.length;++J){var re=g[J];if(!re.da&&re.listener==T&&re.capture==!!R&&re.ha==O)return J}return-1}var Te="closure_lm_"+(1e6*Math.random()|0),B={};function ve(g,T,R,O,J){if(O&&O.once)return H(g,T,R,O,J);if(Array.isArray(T)){for(var re=0;re<T.length;re++)ve(g,T[re],R,O,J);return null}return R=qe(R),g&&g[de]?g.K(T,R,u(O)?!!O.capture:!!O,J):je(g,T,R,!1,O,J)}function je(g,T,R,O,J,re){if(!T)throw Error("Invalid event type");var Ie=u(J)?!!J.capture:!!J,Ft=be(g);if(Ft||(g[Te]=Ft=new he(g)),R=Ft.add(T,R,O,Ie,re),R.proxy)return R;if(O=_e(),R.proxy=O,O.src=g,O.listener=R,g.addEventListener)ye||(J=Ie),J===void 0&&(J=!1),g.addEventListener(T.toString(),O,J);else if(g.attachEvent)g.attachEvent(it(T.toString()),O);else if(g.addListener&&g.removeListener)g.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return R}function _e(){function g(R){return T.call(g.src,g.listener,R)}const T=mt;return g}function H(g,T,R,O,J){if(Array.isArray(T)){for(var re=0;re<T.length;re++)H(g,T[re],R,O,J);return null}return R=qe(R),g&&g[de]?g.L(T,R,u(O)?!!O.capture:!!O,J):je(g,T,R,!0,O,J)}function Pe(g,T,R,O,J){if(Array.isArray(T))for(var re=0;re<T.length;re++)Pe(g,T[re],R,O,J);else O=u(O)?!!O.capture:!!O,R=qe(R),g&&g[de]?(g=g.i,T=String(T).toString(),T in g.g&&(re=g.g[T],R=we(re,R,O,J),-1<R&&(me(re[R]),Array.prototype.splice.call(re,R,1),re.length==0&&(delete g.g[T],g.h--)))):g&&(g=be(g))&&(T=g.g[T.toString()],g=-1,T&&(g=we(T,R,O,J)),(R=-1<g?T[g]:null)&&Ye(R))}function Ye(g){if(typeof g!="number"&&g&&!g.da){var T=g.src;if(T&&T[de])G(T.i,g);else{var R=g.type,O=g.proxy;T.removeEventListener?T.removeEventListener(R,O,g.capture):T.detachEvent?T.detachEvent(it(R),O):T.addListener&&T.removeListener&&T.removeListener(O),(R=be(T))?(G(R,g),R.h==0&&(R.src=null,T[Te]=null)):me(g)}}}function it(g){return g in B?B[g]:B[g]="on"+g}function mt(g,T){if(g.da)g=!0;else{T=new Y(T,this);var R=g.listener,O=g.ha||g.src;g.fa&&Ye(g),g=R.call(O,T)}return g}function be(g){return g=g[Te],g instanceof he?g:null}var Re="__closure_events_fn_"+(1e9*Math.random()>>>0);function qe(g){return typeof g=="function"?g:(g[Re]||(g[Re]=function(T){return g.handleEvent(T)}),g[Re])}function Me(){se.call(this),this.i=new he(this),this.M=this,this.F=null}S(Me,se),Me.prototype[de]=!0,Me.prototype.removeEventListener=function(g,T,R,O){Pe(this,g,T,R,O)};function Xe(g,T){var R,O=g.F;if(O)for(R=[];O;O=O.F)R.push(O);if(g=g.M,O=T.type||T,typeof T=="string")T=new X(T,g);else if(T instanceof X)T.target=T.target||g;else{var J=T;T=new X(O,g),P(T,J)}if(J=!0,R)for(var re=R.length-1;0<=re;re--){var Ie=T.g=R[re];J=ft(Ie,O,!0,T)&&J}if(Ie=T.g=g,J=ft(Ie,O,!0,T)&&J,J=ft(Ie,O,!1,T)&&J,R)for(re=0;re<R.length;re++)Ie=T.g=R[re],J=ft(Ie,O,!1,T)&&J}Me.prototype.N=function(){if(Me.aa.N.call(this),this.i){var g=this.i,T;for(T in g.g){for(var R=g.g[T],O=0;O<R.length;O++)me(R[O]);delete g.g[T],g.h--}}this.F=null},Me.prototype.K=function(g,T,R,O){return this.i.add(String(g),T,!1,R,O)},Me.prototype.L=function(g,T,R,O){return this.i.add(String(g),T,!0,R,O)};function ft(g,T,R,O){if(T=g.i.g[String(T)],!T)return!0;T=T.concat();for(var J=!0,re=0;re<T.length;++re){var Ie=T[re];if(Ie&&!Ie.da&&Ie.capture==R){var Ft=Ie.listener,Ma=Ie.ha||Ie.src;Ie.fa&&G(g.i,Ie),J=Ft.call(Ma,O)!==!1&&J}}return J&&!O.defaultPrevented}function ca(g,T,R){if(typeof g=="function")R&&(g=h(g,R));else if(g&&typeof g.handleEvent=="function")g=h(g.handleEvent,g);else throw Error("Invalid listener argument");return 2147483647<Number(T)?-1:l.setTimeout(g,T||0)}function ea(g){g.g=ca(()=>{g.g=null,g.i&&(g.i=!1,ea(g))},g.l);const T=g.h;g.h=null,g.m.apply(null,T)}class Tt extends se{constructor(T,R){super(),this.m=T,this.l=R,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:ea(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function He(g){se.call(this),this.h=g,this.g={}}S(He,se);var $t=[];function ne(g){x(g.g,function(T,R){this.g.hasOwnProperty(R)&&Ye(T)},g),g.g={}}He.prototype.N=function(){He.aa.N.call(this),ne(this)},He.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var K=l.JSON.stringify,Ge=l.JSON.parse,Ke=class{stringify(g){return l.JSON.stringify(g,void 0)}parse(g){return l.JSON.parse(g,void 0)}};function Ze(){}Ze.prototype.h=null;function et(g){return g.h||(g.h=g.i())}function Ue(){}var Je={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function We(){X.call(this,"d")}S(We,X);function Rt(){X.call(this,"c")}S(Rt,X);var lt={},Dt=null;function ut(){return Dt=Dt||new Me}lt.La="serverreachability";function ka(g){X.call(this,lt.La,g)}S(ka,X);function tt(g){const T=ut();Xe(T,new ka(T))}lt.STAT_EVENT="statevent";function ir(g,T){X.call(this,lt.STAT_EVENT,g),this.stat=T}S(ir,X);function $e(g){const T=ut();Xe(T,new ir(T,g))}lt.Ma="timingevent";function rc(g,T){X.call(this,lt.Ma,g),this.size=T}S(rc,X);function ta(g,T){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){g()},T)}function Un(){this.g=!0}Un.prototype.xa=function(){this.g=!1};function ef(g,T,R,O,J,re){g.info(function(){if(g.g)if(re)for(var Ie="",Ft=re.split("&"),Ma=0;Ma<Ft.length;Ma++){var It=Ft[Ma].split("=");if(1<It.length){var Ba=It[0];It=It[1];var qa=Ba.split("_");Ie=2<=qa.length&&qa[1]=="type"?Ie+(Ba+"="+It+"&"):Ie+(Ba+"=redacted&")}}else Ie=null;else Ie=re;return"XMLHTTP REQ ("+O+") [attempt "+J+"]: "+T+`
`+R+`
`+Ie})}function tf(g,T,R,O,J,re,Ie){g.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+J+"]: "+T+`
`+R+`
`+re+" "+Ie})}function cs(g,T,R,O){g.info(function(){return"XMLHTTP TEXT ("+T+"): "+Pr(g,R)+(O?" "+O:"")})}function af(g,T){g.info(function(){return"TIMEOUT: "+T})}Un.prototype.info=function(){};function Pr(g,T){if(!g.g)return T;if(!T)return null;try{var R=JSON.parse(T);if(R){for(g=0;g<R.length;g++)if(Array.isArray(R[g])){var O=R[g];if(!(2>O.length)){var J=O[1];if(Array.isArray(J)&&!(1>J.length)){var re=J[0];if(re!="noop"&&re!="stop"&&re!="close")for(var Ie=1;Ie<J.length;Ie++)J[Ie]=""}}}}return K(R)}catch{return T}}var La={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},$n={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},sc;function wi(){}S(wi,Ze),wi.prototype.g=function(){return new XMLHttpRequest},wi.prototype.i=function(){return{}},sc=new wi;function lr(g,T,R,O){this.j=g,this.i=T,this.l=R,this.R=O||1,this.U=new He(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new xd}function xd(){this.i=null,this.g="",this.h=!1}var yd={},oc={};function us(g,T,R){g.L=1,g.v=vo(Tn(T)),g.m=R,g.P=!0,mo(g,null)}function mo(g,T){g.F=Date.now(),_i(g),g.A=Tn(g.v);var R=g.A,O=g.R;Array.isArray(O)||(O=[String(O)]),pc(R.i,"t",O),g.C=0,R=g.j.J,g.h=new xd,g.g=GE(g.j,R?T:null,!g.m),0<g.O&&(g.M=new Tt(h(g.Y,g,g.g),g.O)),T=g.U,R=g.g,O=g.ca;var J="readystatechange";Array.isArray(J)||(J&&($t[0]=J.toString()),J=$t);for(var re=0;re<J.length;re++){var Ie=ve(R,J[re],O||T.handleEvent,!1,T.h||T);if(!Ie)break;T.g[Ie.key]=Ie}T=g.H?E(g.H):{},g.m?(g.u||(g.u="POST"),T["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.A,g.u,g.m,T)):(g.u="GET",g.g.ea(g.A,g.u,null,T)),tt(),ef(g.i,g.u,g.A,g.l,g.R,g.m)}lr.prototype.ca=function(g){g=g.target;const T=this.M;T&&Wn(g)==3?T.j():this.Y(g)},lr.prototype.Y=function(g){try{if(g==this.g)e:{const qa=Wn(this.g);var T=this.g.Ba();const Ii=this.g.Z();if(!(3>qa)&&(qa!=3||this.g&&(this.h.h||this.g.oa()||zd(this.g)))){this.J||qa!=4||T==7||(T==8||0>=Ii?tt(3):tt(2)),po(this);var R=this.g.Z();this.X=R;t:if(Nd(this)){var O=zd(this.g);g="";var J=O.length,re=Wn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){cr(this),ds(this);var Ie="";break t}this.h.i=new l.TextDecoder}for(T=0;T<J;T++)this.h.h=!0,g+=this.h.i.decode(O[T],{stream:!(re&&T==J-1)});O.length=0,this.h.g+=g,this.C=0,Ie=this.h.g}else Ie=this.g.oa();if(this.o=R==200,tf(this.i,this.u,this.A,this.l,this.R,qa,R),this.o){if(this.T&&!this.K){t:{if(this.g){var Ft,Ma=this.g;if((Ft=Ma.g?Ma.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(Ft)){var It=Ft;break t}}It=null}if(R=It)cs(this.i,this.l,R,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ic(this,R);else{this.o=!1,this.s=3,$e(12),cr(this),ds(this);break e}}if(this.P){R=!0;let Gn;for(;!this.J&&this.C<Ie.length;)if(Gn=nf(this,Ie),Gn==oc){qa==4&&(this.s=4,$e(14),R=!1),cs(this.i,this.l,null,"[Incomplete Response]");break}else if(Gn==yd){this.s=4,$e(15),cs(this.i,this.l,Ie,"[Invalid Chunk]"),R=!1;break}else cs(this.i,this.l,Gn,null),ic(this,Gn);if(Nd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qa!=4||Ie.length!=0||this.h.h||(this.s=1,$e(16),R=!1),this.o=this.o&&R,!R)cs(this.i,this.l,Ie,"[Invalid Chunked Response]"),cr(this),ds(this);else if(0<Ie.length&&!this.W){this.W=!0;var Ba=this.j;Ba.g==this&&Ba.ba&&!Ba.M&&(Ba.j.info("Great, no buffering proxy detected. Bytes received: "+Ie.length),uf(Ba),Ba.M=!0,$e(11))}}else cs(this.i,this.l,Ie,null),ic(this,Ie);qa==4&&cr(this),this.o&&!this.J&&(qa==4?$E(this.j,this):(this.o=!1,_i(this)))}else lf(this.g),R==400&&0<Ie.indexOf("Unknown SID")?(this.s=3,$e(12)):(this.s=0,$e(13)),cr(this),ds(this)}}}catch{}finally{}};function Nd(g){return g.g?g.u=="GET"&&g.L!=2&&g.j.Ca:!1}function nf(g,T){var R=g.C,O=T.indexOf(`
`,R);return O==-1?oc:(R=Number(T.substring(R,O)),isNaN(R)?yd:(O+=1,O+R>T.length?oc:(T=T.slice(O,O+R),g.C=O+R,T)))}lr.prototype.cancel=function(){this.J=!0,cr(this)};function _i(g){g.S=Date.now()+g.I,wd(g,g.I)}function wd(g,T){if(g.B!=null)throw Error("WatchDog timer not null");g.B=ta(h(g.ba,g),T)}function po(g){g.B&&(l.clearTimeout(g.B),g.B=null)}lr.prototype.ba=function(){this.B=null;const g=Date.now();0<=g-this.S?(af(this.i,this.A),this.L!=2&&(tt(),$e(17)),cr(this),this.s=2,ds(this)):wd(this,this.S-g)};function ds(g){g.j.G==0||g.J||$E(g.j,g)}function cr(g){po(g);var T=g.M;T&&typeof T.ma=="function"&&T.ma(),g.M=null,ne(g.U),g.g&&(T=g.g,g.g=null,T.abort(),T.ma())}function ic(g,T){try{var R=g.j;if(R.G!=0&&(R.g==g||lc(R.h,g))){if(!g.K&&lc(R.h,g)&&R.G==3){try{var O=R.Da.g.parse(T)}catch{O=null}if(Array.isArray(O)&&O.length==3){var J=O;if(J[0]==0){e:if(!R.u){if(R.g)if(R.g.F+3e3<g.F)$d(R),fc(R);else break e;cf(R),$e(18)}}else R.za=J[1],0<R.za-R.T&&37500>J[2]&&R.F&&R.v==0&&!R.C&&(R.C=ta(h(R.Za,R),6e3));if(1>=Cd(R.h)&&R.ca){try{R.ca()}catch{}R.ca=void 0}}else yo(R,11)}else if((g.K||R.g==g)&&$d(R),!v(T))for(J=R.Da.g.parse(T),T=0;T<J.length;T++){let It=J[T];if(R.T=It[0],It=It[1],R.G==2)if(It[0]=="c"){R.K=It[1],R.ia=It[2];const Ba=It[3];Ba!=null&&(R.la=Ba,R.j.info("VER="+R.la));const qa=It[4];qa!=null&&(R.Aa=qa,R.j.info("SVER="+R.Aa));const Ii=It[5];Ii!=null&&typeof Ii=="number"&&0<Ii&&(O=1.5*Ii,R.L=O,R.j.info("backChannelRequestTimeoutMs_="+O)),O=R;const Gn=g.g;if(Gn){const qd=Gn.g?Gn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(qd){var re=O.h;re.g||qd.indexOf("spdy")==-1&&qd.indexOf("quic")==-1&&qd.indexOf("h2")==-1||(re.j=re.l,re.g=new Set,re.h&&(Rr(re,re.h),re.h=null))}if(O.D){const df=Gn.g?Gn.g.getResponseHeader("X-HTTP-Session-Id"):null;df&&(O.ya=df,Vt(O.I,O.D,df))}}R.G=3,R.l&&R.l.ua(),R.ba&&(R.R=Date.now()-g.F,R.j.info("Handshake RTT: "+R.R+"ms")),O=R;var Ie=g;if(O.qa=WE(O,O.J?O.ia:null,O.W),Ie.K){Sd(O.h,Ie);var Ft=Ie,Ma=O.L;Ma&&(Ft.I=Ma),Ft.B&&(po(Ft),_i(Ft)),O.g=Ie}else zE(O);0<R.i.length&&Ud(R)}else It[0]!="stop"&&It[0]!="close"||yo(R,7);else R.G==3&&(It[0]=="stop"||It[0]=="close"?It[0]=="stop"?yo(R,7):xo(R):It[0]!="noop"&&R.l&&R.l.ta(It),R.v=0)}}tt(4)}catch{}}var _d=class{constructor(g,T){this.g=g,this.map=T}};function Ci(g){this.l=g||10,l.PerformanceNavigationTiming?(g=l.performance.getEntriesByType("navigation"),g=0<g.length&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Si(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function Cd(g){return g.h?1:g.g?g.g.size:0}function lc(g,T){return g.h?g.h==T:g.g?g.g.has(T):!1}function Rr(g,T){g.g?g.g.add(T):g.h=T}function Sd(g,T){g.h&&g.h==T?g.h=null:g.g&&g.g.has(T)&&g.g.delete(T)}Ci.prototype.cancel=function(){if(this.i=kd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function kd(g){if(g.h!=null)return g.i.concat(g.h.D);if(g.g!=null&&g.g.size!==0){let T=g.i;for(const R of g.g.values())T=T.concat(R.D);return T}return w(g.i)}function rf(g){if(g.V&&typeof g.V=="function")return g.V();if(typeof Map<"u"&&g instanceof Map||typeof Set<"u"&&g instanceof Set)return Array.from(g.values());if(typeof g=="string")return g.split("");if(c(g)){for(var T=[],R=g.length,O=0;O<R;O++)T.push(g[O]);return T}T=[],R=0;for(O in g)T[R++]=g[O];return T}function sf(g){if(g.na&&typeof g.na=="function")return g.na();if(!g.V||typeof g.V!="function"){if(typeof Map<"u"&&g instanceof Map)return Array.from(g.keys());if(!(typeof Set<"u"&&g instanceof Set)){if(c(g)||typeof g=="string"){var T=[];g=g.length;for(var R=0;R<g;R++)T.push(R);return T}T=[],R=0;for(const O in g)T[R++]=O;return T}}}function go(g,T){if(g.forEach&&typeof g.forEach=="function")g.forEach(T,void 0);else if(c(g)||typeof g=="string")Array.prototype.forEach.call(g,T,void 0);else for(var R=sf(g),O=rf(g),J=O.length,re=0;re<J;re++)T.call(void 0,O[re],R&&R[re],g)}var Id=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function of(g,T){if(g){g=g.split("&");for(var R=0;R<g.length;R++){var O=g[R].indexOf("="),J=null;if(0<=O){var re=g[R].substring(0,O);J=g[R].substring(O+1)}else re=g[R];T(re,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function ur(g){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,g instanceof ur){this.h=g.h,fo(this,g.j),this.o=g.o,this.g=g.g,ho(this,g.s),this.l=g.l;var T=g.i,R=new gs;R.i=T.i,T.g&&(R.g=new Map(T.g),R.h=T.h),cc(this,R),this.m=g.m}else g&&(T=String(g).match(Id))?(this.h=!1,fo(this,T[1]||"",!0),this.o=ms(T[2]||""),this.g=ms(T[3]||"",!0),ho(this,T[4]),this.l=ms(T[5]||"",!0),cc(this,T[6]||"",!0),this.m=ms(T[7]||"")):(this.h=!1,this.i=new gs(null,this.h))}ur.prototype.toString=function(){var g=[],T=this.j;T&&g.push(ps(T,uc,!0),":");var R=this.g;return(R||T=="file")&&(g.push("//"),(T=this.o)&&g.push(ps(T,uc,!0),"@"),g.push(encodeURIComponent(String(R)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R=this.s,R!=null&&g.push(":",String(R))),(R=this.l)&&(this.g&&R.charAt(0)!="/"&&g.push("/"),g.push(ps(R,R.charAt(0)=="/"?Pd:Td,!0))),(R=this.i.toString())&&g.push("?",R),(R=this.m)&&g.push("#",ps(R,Dd)),g.join("")};function Tn(g){return new ur(g)}function fo(g,T,R){g.j=R?ms(T,!0):T,g.j&&(g.j=g.j.replace(/:$/,""))}function ho(g,T){if(T){if(T=Number(T),isNaN(T)||0>T)throw Error("Bad port number "+T);g.s=T}else g.s=null}function cc(g,T,R){T instanceof gs?(g.i=T,Ld(g.i,g.h)):(R||(T=ps(T,Rd)),g.i=new gs(T,g.h))}function Vt(g,T,R){g.i.set(T,R)}function vo(g){return Vt(g,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),g}function ms(g,T){return g?T?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function ps(g,T,R){return typeof g=="string"?(g=encodeURI(g).replace(T,Ad),R&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Ad(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var uc=/[#\/\?@]/g,Td=/[#\?:]/g,Pd=/[#\?]/g,Rd=/[#\?@]/g,Dd=/#/g;function gs(g,T){this.h=this.g=null,this.i=g||null,this.j=!!T}function Bn(g){g.g||(g.g=new Map,g.h=0,g.i&&of(g.i,function(T,R){g.add(decodeURIComponent(T.replace(/\+/g," ")),R)}))}a=gs.prototype,a.add=function(g,T){Bn(this),this.i=null,g=Dr(this,g);var R=this.g.get(g);return R||this.g.set(g,R=[]),R.push(T),this.h+=1,this};function dc(g,T){Bn(g),T=Dr(g,T),g.g.has(T)&&(g.i=null,g.h-=g.g.get(T).length,g.g.delete(T))}function mc(g,T){return Bn(g),T=Dr(g,T),g.g.has(T)}a.forEach=function(g,T){Bn(this),this.g.forEach(function(R,O){R.forEach(function(J){g.call(T,J,O,this)},this)},this)},a.na=function(){Bn(this);const g=Array.from(this.g.values()),T=Array.from(this.g.keys()),R=[];for(let O=0;O<T.length;O++){const J=g[O];for(let re=0;re<J.length;re++)R.push(T[O])}return R},a.V=function(g){Bn(this);let T=[];if(typeof g=="string")mc(this,g)&&(T=T.concat(this.g.get(Dr(this,g))));else{g=Array.from(this.g.values());for(let R=0;R<g.length;R++)T=T.concat(g[R])}return T},a.set=function(g,T){return Bn(this),this.i=null,g=Dr(this,g),mc(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[T]),this.h+=1,this},a.get=function(g,T){return g?(g=this.V(g),0<g.length?String(g[0]):T):T};function pc(g,T,R){dc(g,T),0<R.length&&(g.i=null,g.g.set(Dr(g,T),w(R)),g.h+=R.length)}a.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],T=Array.from(this.g.keys());for(var R=0;R<T.length;R++){var O=T[R];const re=encodeURIComponent(String(O)),Ie=this.V(O);for(O=0;O<Ie.length;O++){var J=re;Ie[O]!==""&&(J+="="+encodeURIComponent(String(Ie[O]))),g.push(J)}}return this.i=g.join("&")};function Dr(g,T){return T=String(T),g.j&&(T=T.toLowerCase()),T}function Ld(g,T){T&&!g.j&&(Bn(g),g.i=null,g.g.forEach(function(R,O){var J=O.toLowerCase();O!=J&&(dc(this,O),pc(this,J,R))},g)),g.j=T}function Md(g,T){const R=new Un;if(l.Image){const O=new Image;O.onload=C(qn,R,"TestLoadImage: loaded",!0,T,O),O.onerror=C(qn,R,"TestLoadImage: error",!1,T,O),O.onabort=C(qn,R,"TestLoadImage: abort",!1,T,O),O.ontimeout=C(qn,R,"TestLoadImage: timeout",!1,T,O),l.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=g}else T(!1)}function Vd(g,T){const R=new Un,O=new AbortController,J=setTimeout(()=>{O.abort(),qn(R,"TestPingServer: timeout",!1,T)},1e4);fetch(g,{signal:O.signal}).then(re=>{clearTimeout(J),re.ok?qn(R,"TestPingServer: ok",!0,T):qn(R,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(J),qn(R,"TestPingServer: error",!1,T)})}function qn(g,T,R,O,J){try{J&&(J.onload=null,J.onerror=null,J.onabort=null,J.ontimeout=null),O(R)}catch{}}function Od(){this.g=new Ke}function jd(g,T,R){const O=R||"";try{go(g,function(J,re){let Ie=J;u(J)&&(Ie=K(J)),T.push(O+re+"="+encodeURIComponent(Ie))})}catch(J){throw T.push(O+"type="+encodeURIComponent("_badmap")),J}}function bo(g){this.l=g.Ub||null,this.j=g.eb||!1}S(bo,Ze),bo.prototype.g=function(){return new L(this.l,this.j)},bo.prototype.i=function(g){return function(){return g}}({});function L(g,T){Me.call(this),this.D=g,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(L,Me),a=L.prototype,a.open=function(g,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=g,this.A=T,this.readyState=1,Oe(this)},a.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const T={headers:this.u,method:this.B,credentials:this.m,cache:void 0};g&&(T.body=g),(this.D||l).fetch(new Request(this.A,T)).then(this.Sa.bind(this),this.ga.bind(this))},a.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ie(this)),this.readyState=0},a.Sa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,Oe(this)),this.g&&(this.readyState=3,Oe(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ee(this)}else g.text().then(this.Ra.bind(this),this.ga.bind(this))};function ee(g){g.j.read().then(g.Pa.bind(g)).catch(g.ga.bind(g))}a.Pa=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var T=g.value?g.value:new Uint8Array(0);(T=this.v.decode(T,{stream:!g.done}))&&(this.response=this.responseText+=T)}g.done?ie(this):Oe(this),this.readyState==3&&ee(this)}},a.Ra=function(g){this.g&&(this.response=this.responseText=g,ie(this))},a.Qa=function(g){this.g&&(this.response=g,ie(this))},a.ga=function(){this.g&&ie(this)};function ie(g){g.readyState=4,g.l=null,g.j=null,g.v=null,Oe(g)}a.setRequestHeader=function(g,T){this.u.append(g,T)},a.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},a.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],T=this.h.entries();for(var R=T.next();!R.done;)R=R.value,g.push(R[0]+": "+R[1]),R=T.next();return g.join(`\r
`)};function Oe(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(L.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Qe(g){let T="";return x(g,function(R,O){T+=O,T+=":",T+=R,T+=`\r
`}),T}function _t(g,T,R){e:{for(O in R){var O=!1;break e}O=!0}O||(R=Qe(R),typeof g=="string"?R!=null&&encodeURIComponent(String(R)):Vt(g,T,R))}function nt(g){Me.call(this),this.headers=new Map,this.o=g||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(nt,Me);var aa=/^https?$/i,Ia=["POST","PUT"];a=nt.prototype,a.Ha=function(g){this.J=g},a.ea=function(g,T,R,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);T=T?T.toUpperCase():"GET",this.D=g,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():sc.g(),this.v=this.o?et(this.o):et(sc),this.g.onreadystatechange=h(this.Ea,this);try{this.B=!0,this.g.open(T,String(g),!0),this.B=!1}catch(re){tn(this,re);return}if(g=R||"",R=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var J in O)R.set(J,O[J]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const re of O.keys())R.set(re,O.get(re));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(R.keys()).find(re=>re.toLowerCase()=="content-type"),J=l.FormData&&g instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Ia,T,void 0))||O||J||R.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[re,Ie]of R)this.g.setRequestHeader(re,Ie);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Fd(this),this.u=!0,this.g.send(g),this.u=!1}catch(re){tn(this,re)}};function tn(g,T){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=T,g.m=5,dr(g),Eo(g)}function dr(g){g.A||(g.A=!0,Xe(g,"complete"),Xe(g,"error"))}a.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=g||7,Xe(this,"complete"),Xe(this,"abort"),Eo(this))},a.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Eo(this,!0)),nt.aa.N.call(this)},a.Ea=function(){this.s||(this.B||this.u||this.j?gc(this):this.bb())},a.bb=function(){gc(this)};function gc(g){if(g.h&&typeof i<"u"&&(!g.v[1]||Wn(g)!=4||g.Z()!=2)){if(g.u&&Wn(g)==4)ca(g.Ea,0,g);else if(Xe(g,"readystatechange"),Wn(g)==4){g.h=!1;try{const Ie=g.Z();e:switch(Ie){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var R;if(!(R=T)){var O;if(O=Ie===0){var J=String(g.D).match(Id)[1]||null;!J&&l.self&&l.self.location&&(J=l.self.location.protocol.slice(0,-1)),O=!aa.test(J?J.toLowerCase():"")}R=O}if(R)Xe(g,"complete"),Xe(g,"success");else{g.m=6;try{var re=2<Wn(g)?g.g.statusText:""}catch{re=""}g.l=re+" ["+g.Z()+"]",dr(g)}}finally{Eo(g)}}}}function Eo(g,T){if(g.g){Fd(g);const R=g.g,O=g.v[0]?()=>{}:null;g.g=null,g.v=null,T||Xe(g,"ready");try{R.onreadystatechange=O}catch{}}}function Fd(g){g.I&&(l.clearTimeout(g.I),g.I=null)}a.isActive=function(){return!!this.g};function Wn(g){return g.g?g.g.readyState:0}a.Z=function(){try{return 2<Wn(this)?this.g.status:-1}catch{return-1}},a.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},a.Oa=function(g){if(this.g){var T=this.g.responseText;return g&&T.indexOf(g)==0&&(T=T.substring(g.length)),Ge(T)}};function zd(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.H){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function lf(g){const T={};g=(g.g&&2<=Wn(g)&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<g.length;O++){if(v(g[O]))continue;var R=k(g[O]);const J=R[0];if(R=R[1],typeof R!="string")continue;R=R.trim();const re=T[J]||[];T[J]=re,re.push(R)}y(T,function(O){return O.join(", ")})}a.Ba=function(){return this.m},a.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function pt(g,T,R){return R&&R.internalChannelParams&&R.internalChannelParams[g]||T}function mr(g){this.Aa=0,this.i=[],this.j=new Un,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=pt("failFast",!1,g),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=pt("baseRetryDelayMs",5e3,g),this.cb=pt("retryDelaySeedMs",1e4,g),this.Wa=pt("forwardChannelMaxRetries",2,g),this.wa=pt("forwardChannelRequestTimeoutMs",2e4,g),this.pa=g&&g.xmlHttpFactory||void 0,this.Xa=g&&g.Tb||void 0,this.Ca=g&&g.useFetchStreams||!1,this.L=void 0,this.J=g&&g.supportsCrossDomainXhr||!1,this.K="",this.h=new Ci(g&&g.concurrentRequestLimit),this.Da=new Od,this.P=g&&g.fastHandshake||!1,this.O=g&&g.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=g&&g.Rb||!1,g&&g.xa&&this.j.xa(),g&&g.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&g&&g.detectBufferingProxy||!1,this.ja=void 0,g&&g.longPollingTimeout&&0<g.longPollingTimeout&&(this.ja=g.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}a=mr.prototype,a.la=8,a.G=1,a.connect=function(g,T,R,O){$e(0),this.W=g,this.H=T||{},R&&O!==void 0&&(this.H.OSID=R,this.H.OAID=O),this.F=this.X,this.I=WE(this,null,this.W),Ud(this)};function xo(g){if(OE(g),g.G==3){var T=g.U++,R=Tn(g.I);if(Vt(R,"SID",g.K),Vt(R,"RID",T),Vt(R,"TYPE","terminate"),hc(g,R),T=new lr(g,g.j,T),T.L=2,T.v=vo(Tn(R)),R=!1,l.navigator&&l.navigator.sendBeacon)try{R=l.navigator.sendBeacon(T.v.toString(),"")}catch{}!R&&l.Image&&(new Image().src=T.v,R=!0),R||(T.g=GE(T.j,null),T.g.ea(T.v)),T.F=Date.now(),_i(T)}qE(g)}function fc(g){g.g&&(uf(g),g.g.cancel(),g.g=null)}function OE(g){fc(g),g.u&&(l.clearTimeout(g.u),g.u=null),$d(g),g.h.cancel(),g.s&&(typeof g.s=="number"&&l.clearTimeout(g.s),g.s=null)}function Ud(g){if(!Si(g.h)&&!g.s){g.s=!0;var T=g.Ga;z||Q(),j||(z(),j=!0),U.add(T,g),g.B=0}}function AT(g,T){return Cd(g.h)>=g.h.j-(g.s?1:0)?!1:g.s?(g.i=T.D.concat(g.i),!0):g.G==1||g.G==2||g.B>=(g.Va?0:g.Wa)?!1:(g.s=ta(h(g.Ga,g,T),BE(g,g.B)),g.B++,!0)}a.Ga=function(g){if(this.s)if(this.s=null,this.G==1){if(!g){this.U=Math.floor(1e5*Math.random()),g=this.U++;const J=new lr(this,this.j,g);let re=this.o;if(this.S&&(re?(re=E(re),P(re,this.S)):re=this.S),this.m!==null||this.O||(J.H=re,re=null),this.P)e:{for(var T=0,R=0;R<this.i.length;R++){t:{var O=this.i[R];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(T+=O,4096<T){T=R;break e}if(T===4096||R===this.i.length-1){T=R+1;break e}}T=1e3}else T=1e3;T=FE(this,J,T),R=Tn(this.I),Vt(R,"RID",g),Vt(R,"CVER",22),this.D&&Vt(R,"X-HTTP-Session-Id",this.D),hc(this,R),re&&(this.O?T="headers="+encodeURIComponent(String(Qe(re)))+"&"+T:this.m&&_t(R,this.m,re)),Rr(this.h,J),this.Ua&&Vt(R,"TYPE","init"),this.P?(Vt(R,"$req",T),Vt(R,"SID","null"),J.T=!0,us(J,R,null)):us(J,R,T),this.G=2}}else this.G==3&&(g?jE(this,g):this.i.length==0||Si(this.h)||jE(this))};function jE(g,T){var R;T?R=T.l:R=g.U++;const O=Tn(g.I);Vt(O,"SID",g.K),Vt(O,"RID",R),Vt(O,"AID",g.T),hc(g,O),g.m&&g.o&&_t(O,g.m,g.o),R=new lr(g,g.j,R,g.B+1),g.m===null&&(R.H=g.o),T&&(g.i=T.D.concat(g.i)),T=FE(g,R,1e3),R.I=Math.round(.5*g.wa)+Math.round(.5*g.wa*Math.random()),Rr(g.h,R),us(R,O,T)}function hc(g,T){g.H&&x(g.H,function(R,O){Vt(T,O,R)}),g.l&&go({},function(R,O){Vt(T,O,R)})}function FE(g,T,R){R=Math.min(g.i.length,R);var O=g.l?h(g.l.Na,g.l,g):null;e:{var J=g.i;let re=-1;for(;;){const Ie=["count="+R];re==-1?0<R?(re=J[0].g,Ie.push("ofs="+re)):re=0:Ie.push("ofs="+re);let Ft=!0;for(let Ma=0;Ma<R;Ma++){let It=J[Ma].g;const Ba=J[Ma].map;if(It-=re,0>It)re=Math.max(0,J[Ma].g-100),Ft=!1;else try{jd(Ba,Ie,"req"+It+"_")}catch{O&&O(Ba)}}if(Ft){O=Ie.join("&");break e}}}return g=g.i.splice(0,R),T.D=g,O}function zE(g){if(!g.g&&!g.u){g.Y=1;var T=g.Fa;z||Q(),j||(z(),j=!0),U.add(T,g),g.v=0}}function cf(g){return g.g||g.u||3<=g.v?!1:(g.Y++,g.u=ta(h(g.Fa,g),BE(g,g.v)),g.v++,!0)}a.Fa=function(){if(this.u=null,UE(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var g=2*this.R;this.j.info("BP detection timer enabled: "+g),this.A=ta(h(this.ab,this),g)}},a.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,$e(10),fc(this),UE(this))};function uf(g){g.A!=null&&(l.clearTimeout(g.A),g.A=null)}function UE(g){g.g=new lr(g,g.j,"rpc",g.Y),g.m===null&&(g.g.H=g.o),g.g.O=0;var T=Tn(g.qa);Vt(T,"RID","rpc"),Vt(T,"SID",g.K),Vt(T,"AID",g.T),Vt(T,"CI",g.F?"0":"1"),!g.F&&g.ja&&Vt(T,"TO",g.ja),Vt(T,"TYPE","xmlhttp"),hc(g,T),g.m&&g.o&&_t(T,g.m,g.o),g.L&&(g.g.I=g.L);var R=g.g;g=g.ia,R.L=1,R.v=vo(Tn(T)),R.m=null,R.P=!0,mo(R,g)}a.Za=function(){this.C!=null&&(this.C=null,fc(this),cf(this),$e(19))};function $d(g){g.C!=null&&(l.clearTimeout(g.C),g.C=null)}function $E(g,T){var R=null;if(g.g==T){$d(g),uf(g),g.g=null;var O=2}else if(lc(g.h,T))R=T.D,Sd(g.h,T),O=1;else return;if(g.G!=0){if(T.o)if(O==1){R=T.m?T.m.length:0,T=Date.now()-T.F;var J=g.B;O=ut(),Xe(O,new rc(O,R)),Ud(g)}else zE(g);else if(J=T.s,J==3||J==0&&0<T.X||!(O==1&&AT(g,T)||O==2&&cf(g)))switch(R&&0<R.length&&(T=g.h,T.i=T.i.concat(R)),J){case 1:yo(g,5);break;case 4:yo(g,10);break;case 3:yo(g,6);break;default:yo(g,2)}}}function BE(g,T){let R=g.Ta+Math.floor(Math.random()*g.cb);return g.isActive()||(R*=2),R*T}function yo(g,T){if(g.j.info("Error code "+T),T==2){var R=h(g.fb,g),O=g.Xa;const J=!O;O=new ur(O||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||fo(O,"https"),vo(O),J?Md(O.toString(),R):Vd(O.toString(),R)}else $e(2);g.G=0,g.l&&g.l.sa(T),qE(g),OE(g)}a.fb=function(g){g?(this.j.info("Successfully pinged google.com"),$e(2)):(this.j.info("Failed to ping google.com"),$e(1))};function qE(g){if(g.G=0,g.ka=[],g.l){const T=kd(g.h);(T.length!=0||g.i.length!=0)&&(f(g.ka,T),f(g.ka,g.i),g.h.i.length=0,w(g.i),g.i.length=0),g.l.ra()}}function WE(g,T,R){var O=R instanceof ur?Tn(R):new ur(R);if(O.g!="")T&&(O.g=T+"."+O.g),ho(O,O.s);else{var J=l.location;O=J.protocol,T=T?T+"."+J.hostname:J.hostname,J=+J.port;var re=new ur(null);O&&fo(re,O),T&&(re.g=T),J&&ho(re,J),R&&(re.l=R),O=re}return R=g.D,T=g.ya,R&&T&&Vt(O,R,T),Vt(O,"VER",g.la),hc(g,O),O}function GE(g,T,R){if(T&&!g.J)throw Error("Can't create secondary domain capable XhrIo object.");return T=g.Ca&&!g.pa?new nt(new bo({eb:R})):new nt(g.pa),T.Ha(g.J),T}a.isActive=function(){return!!this.l&&this.l.isActive(this)};function HE(){}a=HE.prototype,a.ua=function(){},a.ta=function(){},a.sa=function(){},a.ra=function(){},a.isActive=function(){return!0},a.Na=function(){};function Bd(){}Bd.prototype.g=function(g,T){return new xn(g,T)};function xn(g,T){Me.call(this),this.g=new mr(T),this.l=g,this.h=T&&T.messageUrlParams||null,g=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(g?g["X-WebChannel-Content-Type"]=T.messageContentType:g={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.va&&(g?g["X-WebChannel-Client-Profile"]=T.va:g={"X-WebChannel-Client-Profile":T.va}),this.g.S=g,(g=T&&T.Sb)&&!v(g)&&(this.g.m=g),this.v=T&&T.supportsCrossDomainXhr||!1,this.u=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!v(T)&&(this.g.D=T,g=this.h,g!==null&&T in g&&(g=this.h,T in g&&delete g[T])),this.j=new ki(this)}S(xn,Me),xn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},xn.prototype.close=function(){xo(this.g)},xn.prototype.o=function(g){var T=this.g;if(typeof g=="string"){var R={};R.__data__=g,g=R}else this.u&&(R={},R.__data__=K(g),g=R);T.i.push(new _d(T.Ya++,g)),T.G==3&&Ud(T)},xn.prototype.N=function(){this.g.l=null,delete this.j,xo(this.g),delete this.g,xn.aa.N.call(this)};function KE(g){We.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var T=g.__sm__;if(T){e:{for(const R in T){g=R;break e}g=void 0}(this.i=g)&&(g=this.i,T=T!==null&&g in T?T[g]:void 0),this.data=T}else this.data=g}S(KE,We);function QE(){Rt.call(this),this.status=1}S(QE,Rt);function ki(g){this.g=g}S(ki,HE),ki.prototype.ua=function(){Xe(this.g,"a")},ki.prototype.ta=function(g){Xe(this.g,new KE(g))},ki.prototype.sa=function(g){Xe(this.g,new QE)},ki.prototype.ra=function(){Xe(this.g,"b")},Bd.prototype.createWebChannel=Bd.prototype.g,xn.prototype.send=xn.prototype.o,xn.prototype.open=xn.prototype.m,xn.prototype.close=xn.prototype.close,IC=function(){return new Bd},kC=function(){return ut()},SC=lt,b0={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},La.NO_ERROR=0,La.TIMEOUT=8,La.HTTP_ERROR=6,Mm=La,$n.COMPLETE="complete",CC=$n,Ue.EventType=Je,Je.OPEN="a",Je.CLOSE="b",Je.ERROR="c",Je.MESSAGE="d",Me.prototype.listen=Me.prototype.K,$c=Ue,nt.prototype.listenOnce=nt.prototype.L,nt.prototype.getLastError=nt.prototype.Ka,nt.prototype.getLastErrorCode=nt.prototype.Ba,nt.prototype.getStatus=nt.prototype.Z,nt.prototype.getResponseJson=nt.prototype.Oa,nt.prototype.getResponseText=nt.prototype.oa,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Ha,_C=nt}).apply(typeof lm<"u"?lm:typeof self<"u"?self:typeof window<"u"?window:{});const fy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Pa.UNAUTHENTICATED=new Pa(null),Pa.GOOGLE_CREDENTIALS=new Pa("google-credentials-uid"),Pa.FIRST_PARTY=new Pa("first-party-uid"),Pa.MOCK_USER=new Pa("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ql="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qs=new Xv("@firebase/firestore");function Vi(){return Qs.logLevel}function aB(a){Qs.setLogLevel(a)}function Ee(a,...e){if(Qs.logLevel<=yt.DEBUG){const n=e.map(tb);Qs.debug(`Firestore (${ql}): ${a}`,...n)}}function fa(a,...e){if(Qs.logLevel<=yt.ERROR){const n=e.map(tb);Qs.error(`Firestore (${ql}): ${a}`,...n)}}function Fn(a,...e){if(Qs.logLevel<=yt.WARN){const n=e.map(tb);Qs.warn(`Firestore (${ql}): ${a}`,...n)}}function tb(a){if(typeof a=="string")return a;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(a)}catch{return a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(a="Unexpected state"){const e=`FIRESTORE (${ql}) INTERNAL ASSERTION FAILED: `+a;throw fa(e),new Error(e)}function Fe(a,e){a||Le()}function nB(a,e){a||Le()}function ke(a,e){return a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class xe extends rr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class S6{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Pa.UNAUTHENTICATED))}shutdown(){}}class k6{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class I6{constructor(e){this.t=e,this.currentUser=Pa.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Fe(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let o=new Da;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Da,e.enqueueRetryable(()=>s(this.currentUser))};const i=()=>{const c=o;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{Ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Da)}},0),i()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Fe(typeof r.accessToken=="string"),new AC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Fe(e===null||typeof e=="string"),new Pa(e)}}class A6{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Pa.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class T6{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new A6(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Pa.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class TC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class P6{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Fe(this.o===void 0);const r=o=>{o.error!=null&&Ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const i=o.token!==this.R;return this.R=o.token,Ee("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const s=o=>{Ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>s(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?s(o):Ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Fe(typeof n.token=="string"),this.R=n.token,new TC(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class rB{getToken(){return Promise.resolve(new TC(""))}invalidateToken(){}start(e,n){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R6(a){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(a);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<a;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=R6(40);for(let o=0;o<s.length;++o)r.length<20&&s[o]<n&&(r+=e.charAt(s[o]%e.length))}return r}}function rt(a,e){return a<e?-1:a>e?1:0}function yl(a,e,n){return a.length===e.length&&a.every((r,s)=>n(r,e[s]))}function RC(a){return a+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new xe(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new xe(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new xe(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new xe(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Kt.fromMillis(Date.now())}static fromDate(e){return Kt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Kt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?rt(this.nanoseconds,e.nanoseconds):rt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Be(e)}static min(){return new Be(new Kt(0,0))}static max(){return new Be(new Kt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,n,r){n===void 0?n=0:n>e.length&&Le(),r===void 0?r=e.length-n:r>e.length-n&&Le(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Au.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Au?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const o=e.get(s),i=n.get(s);if(o<i)return-1;if(o>i)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Nt extends Au{construct(e,n,r){return new Nt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new xe(ae.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Nt(n)}static emptyPath(){return new Nt([])}}const D6=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Yt extends Au{construct(e,n,r){return new Yt(e,n,r)}static isValidIdentifier(e){return D6.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Yt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Yt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const o=()=>{if(r.length===0)throw new xe(ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let i=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new xe(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new xe(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(i=!i,s++):l!=="."||i?(r+=l,s++):(o(),s++)}if(o(),i)throw new xe(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Yt(n)}static emptyPath(){return new Yt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e){this.path=e}static fromPath(e){return new Ae(Nt.fromString(e))}static fromName(e){return new Ae(Nt.fromString(e).popFirst(5))}static empty(){return new Ae(Nt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Nt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Nt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ae(new Nt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function E0(a){return a.fields.find(e=>e.kind===2)}function ko(a){return a.fields.filter(e=>e.kind!==2)}function L6(a,e){let n=rt(a.collectionGroup,e.collectionGroup);if(n!==0)return n;for(let r=0;r<Math.min(a.fields.length,e.fields.length);++r)if(n=M6(a.fields[r],e.fields[r]),n!==0)return n;return rt(a.fields.length,e.fields.length)}Nl.UNKNOWN_ID=-1;class $o{constructor(e,n){this.fieldPath=e,this.kind=n}}function M6(a,e){const n=Yt.comparator(a.fieldPath,e.fieldPath);return n!==0?n:rt(a.kind,e.kind)}class wl{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new wl(0,kn.min())}}function DC(a,e){const n=a.toTimestamp().seconds,r=a.toTimestamp().nanoseconds+1,s=Be.fromTimestamp(r===1e9?new Kt(n+1,0):new Kt(n,r));return new kn(s,Ae.empty(),e)}function LC(a){return new kn(a.readTime,a.key,-1)}class kn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new kn(Be.min(),Ae.empty(),-1)}static max(){return new kn(Be.max(),Ae.empty(),-1)}}function ab(a,e){let n=a.readTime.compareTo(e.readTime);return n!==0?n:(n=Ae.comparator(a.documentKey,e.documentKey),n!==0?n:rt(a.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class VC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oo(a){if(a.code!==ae.FAILED_PRECONDITION||a.message!==MC)throw a;Ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Le(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Z((r,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,s)},this.catchCallback=o=>{this.wrapFailure(n,o).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Z?n:Z.resolve(n)}catch(n){return Z.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Z.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Z.reject(n)}static resolve(e){return new Z((n,r)=>{n(e)})}static reject(e){return new Z((n,r)=>{r(e)})}static waitFor(e){return new Z((n,r)=>{let s=0,o=0,i=!1;e.forEach(l=>{++s,l.next(()=>{++o,i&&o===s&&n()},c=>r(c))}),i=!0,o===s&&n()})}static or(e){let n=Z.resolve(!1);for(const r of e)n=n.next(s=>s?Z.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,o)=>{r.push(n.call(this,s,o))}),this.waitFor(r)}static mapArray(e,n){return new Z((r,s)=>{const o=e.length,i=new Array(o);let l=0;for(let c=0;c<o;c++){const u=c;n(e[u]).next(d=>{i[u]=d,++l,l===o&&r(i)},d=>s(d))}})}static doWhile(e,n){return new Z((r,s)=>{const o=()=>{e()===!0?n().next(()=>{o()},s):r()};o()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xg{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Da,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new tu(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=nb(r.target.error);this.V.reject(new tu(e,s))}}static open(e,n,r,s){try{return new xg(n,e.transaction(s,r))}catch(o){throw new tu(n,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Ee("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new O6(n)}}class Nr{constructor(e,n,r){this.name=e,this.version=n,this.p=r,Nr.S(_a())===12.2&&fa("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Ee("SimpleDb","Removing database:",e),Io(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Zv())return!1;if(Nr.v())return!0;const e=_a(),n=Nr.S(e),r=0<n&&n<10,s=OC(e),o=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(Ee("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=o=>{const i=o.target.result;n(i)},s.onblocked=()=>{r(new tu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const i=o.target.error;i.name==="VersionError"?r(new xe(ae.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):i.name==="InvalidStateError"?r(new xe(ae.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+i)):r(new tu(e,i))},s.onupgradeneeded=o=>{Ee("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const i=o.target.result;this.p.O(i,s.transaction,o.oldVersion,this.version).next(()=>{Ee("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const o=n==="readonly";let i=0;for(;;){++i;try{this.db=await this.M(e);const l=xg.open(this.db,e,o?"readonly":"readwrite",r),c=s(l).next(u=>(l.g(),u)).catch(u=>(l.abort(u),Z.reject(u))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&i<3;if(Ee("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function OC(a){const e=a.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class V6{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Io(this.B.delete())}}class tu extends xe{constructor(e,n){super(ae.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function io(a){return a.name==="IndexedDbTransactionError"}class O6{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(Ee("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(Ee("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Io(r)}add(e){return Ee("SimpleDb","ADD",this.store.name,e,e),Io(this.store.add(e))}get(e){return Io(this.store.get(e)).next(n=>(n===void 0&&(n=null),Ee("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return Ee("SimpleDb","DELETE",this.store.name,e),Io(this.store.delete(e))}count(){return Ee("SimpleDb","COUNT",this.store.name),Io(this.store.count())}U(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const o=s.getAll(r.range);return new Z((i,l)=>{o.onerror=c=>{l(c.target.error)},o.onsuccess=c=>{i(c.target.result)}})}{const o=this.cursor(r),i=[];return this.W(o,(l,c)=>{i.push(c)}).next(()=>i)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new Z((s,o)=>{r.onerror=i=>{o(i.target.error)},r.onsuccess=i=>{s(i.target.result)}})}j(e,n){Ee("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const s=this.cursor(r);return this.W(s,(o,i,l)=>l.delete())}J(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.W(s,n)}Y(e){const n=this.cursor({});return new Z((r,s)=>{n.onerror=o=>{const i=nb(o.target.error);s(i)},n.onsuccess=o=>{const i=o.target.result;i?e(i.primaryKey,i.value).next(l=>{l?i.continue():r()}):r()}})}W(e,n){const r=[];return new Z((s,o)=>{e.onerror=i=>{o(i.target.error)},e.onsuccess=i=>{const l=i.target.result;if(!l)return void s();const c=new V6(l),u=n(l.primaryKey,l.value,c);if(u instanceof Z){const d=u.catch(m=>(c.done(),Z.reject(m)));r.push(d)}c.isDone?s():c.K===null?l.continue():l.continue(c.K)}}).next(()=>Z.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Io(a){return new Z((e,n)=>{a.onsuccess=r=>{const s=r.target.result;e(s)},a.onerror=r=>{const s=nb(r.target.error);n(s)}})}let hy=!1;function nb(a){const e=Nr.S(_a());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(a.message.indexOf(n)>=0){const r=new xe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return hy||(hy=!0,setTimeout(()=>{throw r},0)),r}}return a}class j6{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){Ee("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Ee("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){io(n)?Ee("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await oo(n)}await this.X(6e4)})}}class F6{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let s=n,o=!0;return Z.doWhile(()=>o===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(i=>{if(i!==null&&!r.has(i))return Ee("IndexBackfiller",`Processing collection: ${i}`),this.ne(e,i,s).next(l=>{s-=l,r.add(i)});o=!1})).next(()=>n-s)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(o=>{const i=o.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this.re(s,o)).next(l=>(Ee("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,n,l))).next(()=>i.size)}))}re(e,n){let r=e;return n.changes.forEach((s,o)=>{const i=LC(o);ab(i,r)>0&&(r=i)}),new kn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}mn.oe=-1;function ed(a){return a==null}function Tu(a){return a===0&&1/a==-1/0}function jC(a){return typeof a=="number"&&Number.isInteger(a)&&!Tu(a)&&a<=Number.MAX_SAFE_INTEGER&&a>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ja(a){let e="";for(let n=0;n<a.length;n++)e.length>0&&(e=vy(e)),e=z6(a.get(n),e);return vy(e)}function z6(a,e){let n=e;const r=a.length;for(let s=0;s<r;s++){const o=a.charAt(s);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function vy(a){return a+""}function vr(a){const e=a.length;if(Fe(e>=2),e===2)return Fe(a.charAt(0)===""&&a.charAt(1)===""),Nt.emptyPath();const n=e-2,r=[];let s="";for(let o=0;o<e;){const i=a.indexOf("",o);switch((i<0||i>n)&&Le(),a.charAt(i+1)){case"":const l=a.substring(o,i);let c;s.length===0?c=l:(s+=l,c=s,s=""),r.push(c);break;case"":s+=a.substring(o,i),s+="\0";break;case"":s+=a.substring(o,i+1);break;default:Le()}o=i+2}return new Nt(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const by=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vm(a,e){return[a,Ja(e)]}function FC(a,e,n){return[a,Ja(e),n]}const U6={},$6=["prefixPath","collectionGroup","readTime","documentId"],B6=["prefixPath","collectionGroup","documentId"],q6=["collectionGroup","readTime","prefixPath","documentId"],W6=["canonicalId","targetId"],G6=["targetId","path"],H6=["path","targetId"],K6=["collectionId","parent"],Q6=["indexId","uid"],J6=["uid","sequenceNumber"],Y6=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Z6=["indexId","uid","orderedDocumentKey"],X6=["userId","collectionPath","documentId"],eD=["userId","collectionPath","largestBatchId"],tD=["userId","collectionGroup","largestBatchId"],zC=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],aD=[...zC,"documentOverlays"],UC=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],$C=UC,rb=[...$C,"indexConfiguration","indexState","indexEntries"],nD=rb,rD=[...rb,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0 extends VC{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function Sa(a,e){const n=ke(a);return Nr.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ey(a){let e=0;for(const n in a)Object.prototype.hasOwnProperty.call(a,n)&&e++;return e}function lo(a,e){for(const n in a)Object.prototype.hasOwnProperty.call(a,n)&&e(n,a[n])}function BC(a,e){const n=[];for(const r in a)Object.prototype.hasOwnProperty.call(a,r)&&n.push(e(a[r],r,a));return n}function qC(a){for(const e in a)if(Object.prototype.hasOwnProperty.call(a,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e,n){this.comparator=e,this.root=n||Oa.EMPTY}insert(e,n){return new qt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Oa.BLACK,null,null))}remove(e){return new qt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Oa.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new cm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new cm(this.root,e,this.comparator,!1)}getReverseIterator(){return new cm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new cm(this.root,e,this.comparator,!0)}}class cm{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,n&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Oa{constructor(e,n,r,s,o){this.key=e,this.value=n,this.color=r??Oa.RED,this.left=s??Oa.EMPTY,this.right=o??Oa.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,o){return new Oa(e??this.key,n??this.value,r??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const o=r(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,n,r),null):o===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Oa.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Oa.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Oa.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Oa.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Le();const e=this.left.check();if(e!==this.right.check())throw Le();return e+(this.isRed()?0:1)}}Oa.EMPTY=null,Oa.RED=!0,Oa.BLACK=!1;Oa.EMPTY=new class{constructor(){this.size=0}get key(){throw Le()}get value(){throw Le()}get color(){throw Le()}get left(){throw Le()}get right(){throw Le()}copy(e,n,r,s,o){return this}insert(e,n,r){return new Oa(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.comparator=e,this.data=new qt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new xy(this.data.getIterator())}getIteratorFrom(e){return new xy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof jt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,o=r.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new jt(this.comparator);return n.data=e,n}}class xy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ti(a){return a.hasNext()?a.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.fields=e,e.sort(Yt.comparator)}static empty(){return new pn([])}unionWith(e){let n=new jt(Yt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new pn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return yl(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oB(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new WC("Invalid base64 string: "+o):o}}(e);return new da(n)}static fromUint8Array(e){const n=function(s){let o="";for(let i=0;i<s.length;++i)o+=String.fromCharCode(s[i]);return o}(e);return new da(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return rt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}da.EMPTY_BYTE_STRING=new da("");const sD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yr(a){if(Fe(!!a),typeof a=="string"){let e=0;const n=sD.exec(a);if(Fe(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(a);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Qt(a.seconds),nanos:Qt(a.nanos)}}function Qt(a){return typeof a=="number"?a:typeof a=="string"?Number(a):0}function Zr(a){return typeof a=="string"?da.fromBase64String(a):da.fromUint8Array(a)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(a){var e,n;return((n=(((e=a==null?void 0:a.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Ng(a){const e=a.mapValue.fields.__previous_value__;return yg(e)?Ng(e):e}function Pu(a){const e=Yr(a.mapValue.fields.__local_write_time__.timestampValue);return new Kt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(e,n,r,s,o,i,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=o,this.forceLongPolling=i,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class Qo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Qo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Qo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ms={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Om={nullValue:"NULL_VALUE"};function Js(a){return"nullValue"in a?0:"booleanValue"in a?1:"integerValue"in a||"doubleValue"in a?2:"timestampValue"in a?3:"stringValue"in a?5:"bytesValue"in a?6:"referenceValue"in a?7:"geoPointValue"in a?8:"arrayValue"in a?9:"mapValue"in a?yg(a)?4:GC(a)?9007199254740991:wg(a)?10:11:Le()}function Ir(a,e){if(a===e)return!0;const n=Js(a);if(n!==Js(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return a.booleanValue===e.booleanValue;case 4:return Pu(a).isEqual(Pu(e));case 3:return function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const i=Yr(s.timestampValue),l=Yr(o.timestampValue);return i.seconds===l.seconds&&i.nanos===l.nanos}(a,e);case 5:return a.stringValue===e.stringValue;case 6:return function(s,o){return Zr(s.bytesValue).isEqual(Zr(o.bytesValue))}(a,e);case 7:return a.referenceValue===e.referenceValue;case 8:return function(s,o){return Qt(s.geoPointValue.latitude)===Qt(o.geoPointValue.latitude)&&Qt(s.geoPointValue.longitude)===Qt(o.geoPointValue.longitude)}(a,e);case 2:return function(s,o){if("integerValue"in s&&"integerValue"in o)return Qt(s.integerValue)===Qt(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const i=Qt(s.doubleValue),l=Qt(o.doubleValue);return i===l?Tu(i)===Tu(l):isNaN(i)&&isNaN(l)}return!1}(a,e);case 9:return yl(a.arrayValue.values||[],e.arrayValue.values||[],Ir);case 10:case 11:return function(s,o){const i=s.mapValue.fields||{},l=o.mapValue.fields||{};if(Ey(i)!==Ey(l))return!1;for(const c in i)if(i.hasOwnProperty(c)&&(l[c]===void 0||!Ir(i[c],l[c])))return!1;return!0}(a,e);default:return Le()}}function Ru(a,e){return(a.values||[]).find(n=>Ir(n,e))!==void 0}function Ys(a,e){if(a===e)return 0;const n=Js(a),r=Js(e);if(n!==r)return rt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return rt(a.booleanValue,e.booleanValue);case 2:return function(o,i){const l=Qt(o.integerValue||o.doubleValue),c=Qt(i.integerValue||i.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(a,e);case 3:return yy(a.timestampValue,e.timestampValue);case 4:return yy(Pu(a),Pu(e));case 5:return rt(a.stringValue,e.stringValue);case 6:return function(o,i){const l=Zr(o),c=Zr(i);return l.compareTo(c)}(a.bytesValue,e.bytesValue);case 7:return function(o,i){const l=o.split("/"),c=i.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=rt(l[u],c[u]);if(d!==0)return d}return rt(l.length,c.length)}(a.referenceValue,e.referenceValue);case 8:return function(o,i){const l=rt(Qt(o.latitude),Qt(i.latitude));return l!==0?l:rt(Qt(o.longitude),Qt(i.longitude))}(a.geoPointValue,e.geoPointValue);case 9:return Ny(a.arrayValue,e.arrayValue);case 10:return function(o,i){var l,c,u,d;const m=o.fields||{},h=i.fields||{},C=(l=m.value)===null||l===void 0?void 0:l.arrayValue,S=(c=h.value)===null||c===void 0?void 0:c.arrayValue,w=rt(((u=C==null?void 0:C.values)===null||u===void 0?void 0:u.length)||0,((d=S==null?void 0:S.values)===null||d===void 0?void 0:d.length)||0);return w!==0?w:Ny(C,S)}(a.mapValue,e.mapValue);case 11:return function(o,i){if(o===Ms.mapValue&&i===Ms.mapValue)return 0;if(o===Ms.mapValue)return 1;if(i===Ms.mapValue)return-1;const l=o.fields||{},c=Object.keys(l),u=i.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let m=0;m<c.length&&m<d.length;++m){const h=rt(c[m],d[m]);if(h!==0)return h;const C=Ys(l[c[m]],u[d[m]]);if(C!==0)return C}return rt(c.length,d.length)}(a.mapValue,e.mapValue);default:throw Le()}}function yy(a,e){if(typeof a=="string"&&typeof e=="string"&&a.length===e.length)return rt(a,e);const n=Yr(a),r=Yr(e),s=rt(n.seconds,r.seconds);return s!==0?s:rt(n.nanos,r.nanos)}function Ny(a,e){const n=a.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const o=Ys(n[s],r[s]);if(o)return o}return rt(n.length,r.length)}function _l(a){return y0(a)}function y0(a){return"nullValue"in a?"null":"booleanValue"in a?""+a.booleanValue:"integerValue"in a?""+a.integerValue:"doubleValue"in a?""+a.doubleValue:"timestampValue"in a?function(n){const r=Yr(n);return`time(${r.seconds},${r.nanos})`}(a.timestampValue):"stringValue"in a?a.stringValue:"bytesValue"in a?function(n){return Zr(n).toBase64()}(a.bytesValue):"referenceValue"in a?function(n){return Ae.fromName(n).toString()}(a.referenceValue):"geoPointValue"in a?function(n){return`geo(${n.latitude},${n.longitude})`}(a.geoPointValue):"arrayValue"in a?function(n){let r="[",s=!0;for(const o of n.values||[])s?s=!1:r+=",",r+=y0(o);return r+"]"}(a.arrayValue):"mapValue"in a?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",o=!0;for(const i of r)o?o=!1:s+=",",s+=`${i}:${y0(n.fields[i])}`;return s+"}"}(a.mapValue):Le()}function jm(a){switch(Js(a)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ng(a);return e?16+jm(e):16;case 5:return 2*a.stringValue.length;case 6:return Zr(a.bytesValue).approximateByteSize();case 7:return a.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,o)=>s+jm(o),0)}(a.arrayValue);case 10:case 11:return function(r){let s=0;return lo(r.fields,(o,i)=>{s+=o.length+jm(i)}),s}(a.mapValue);default:throw Le()}}function Jo(a,e){return{referenceValue:`projects/${a.projectId}/databases/${a.database}/documents/${e.path.canonicalString()}`}}function N0(a){return!!a&&"integerValue"in a}function Du(a){return!!a&&"arrayValue"in a}function wy(a){return!!a&&"nullValue"in a}function _y(a){return!!a&&"doubleValue"in a&&isNaN(Number(a.doubleValue))}function Fm(a){return!!a&&"mapValue"in a}function wg(a){var e,n;return((n=(((e=a==null?void 0:a.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function au(a){if(a.geoPointValue)return{geoPointValue:Object.assign({},a.geoPointValue)};if(a.timestampValue&&typeof a.timestampValue=="object")return{timestampValue:Object.assign({},a.timestampValue)};if(a.mapValue){const e={mapValue:{fields:{}}};return lo(a.mapValue.fields,(n,r)=>e.mapValue.fields[n]=au(r)),e}if(a.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(a.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=au(a.arrayValue.values[n]);return e}return Object.assign({},a)}function GC(a){return(((a.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const HC={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function iD(a){return"nullValue"in a?Om:"booleanValue"in a?{booleanValue:!1}:"integerValue"in a||"doubleValue"in a?{doubleValue:NaN}:"timestampValue"in a?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in a?{stringValue:""}:"bytesValue"in a?{bytesValue:""}:"referenceValue"in a?Jo(Qo.empty(),Ae.empty()):"geoPointValue"in a?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in a?{arrayValue:{}}:"mapValue"in a?wg(a)?HC:{mapValue:{}}:Le()}function lD(a){return"nullValue"in a?{booleanValue:!1}:"booleanValue"in a?{doubleValue:NaN}:"integerValue"in a||"doubleValue"in a?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in a?{stringValue:""}:"stringValue"in a?{bytesValue:""}:"bytesValue"in a?Jo(Qo.empty(),Ae.empty()):"referenceValue"in a?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in a?{arrayValue:{}}:"arrayValue"in a?HC:"mapValue"in a?wg(a)?{mapValue:{}}:Ms:Le()}function Cy(a,e){const n=Ys(a.value,e.value);return n!==0?n:a.inclusive&&!e.inclusive?-1:!a.inclusive&&e.inclusive?1:0}function Sy(a,e){const n=Ys(a.value,e.value);return n!==0?n:a.inclusive&&!e.inclusive?1:!a.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e){this.value=e}static empty(){return new ja({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Fm(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=au(n)}setAll(e){let n=Yt.emptyPath(),r={},s=[];e.forEach((i,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}i?r[l.lastSegment()]=au(i):s.push(l.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,r,s)}delete(e){const n=this.field(e.popLast());Fm(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ir(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Fm(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){lo(n,(s,o)=>e[s]=o);for(const s of r)delete e[s]}clone(){return new ja(au(this.value))}}function KC(a){const e=[];return lo(a.fields,(n,r)=>{const s=new Yt([n]);if(Fm(r)){const o=KC(r.mapValue).fields;if(o.length===0)e.push(s);else for(const i of o)e.push(s.child(i))}else e.push(s)}),new pn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e,n,r,s,o,i,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=o,this.data=i,this.documentState=l}static newInvalidDocument(e){return new Gt(e,0,Be.min(),Be.min(),Be.min(),ja.empty(),0)}static newFoundDocument(e,n,r,s){return new Gt(e,1,n,Be.min(),r,s,0)}static newNoDocument(e,n){return new Gt(e,2,n,Be.min(),Be.min(),ja.empty(),0)}static newUnknownDocument(e,n){return new Gt(e,3,n,Be.min(),Be.min(),ja.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Be.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ja.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ja.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Be.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Gt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Gt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e,n){this.position=e,this.inclusive=n}}function ky(a,e,n){let r=0;for(let s=0;s<a.position.length;s++){const o=e[s],i=a.position[s];if(o.field.isKeyField()?r=Ae.comparator(Ae.fromName(i.referenceValue),n.key):r=Ys(i,n.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function Iy(a,e){if(a===null)return e===null;if(e===null||a.inclusive!==e.inclusive||a.position.length!==e.position.length)return!1;for(let n=0;n<a.position.length;n++)if(!Ir(a.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,n="asc"){this.field=e,this.dir=n}}function cD(a,e){return a.dir===e.dir&&a.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{}class wt extends QC{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new uD(e,n,r):n==="array-contains"?new pD(e,r):n==="in"?new tS(e,r):n==="not-in"?new gD(e,r):n==="array-contains-any"?new fD(e,r):new wt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new dD(e,r):new mD(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ys(n,this.value)):n!==null&&Js(this.value)===Js(n)&&this.matchesComparison(Ys(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Le()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Lt extends QC{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Lt(e,n)}matches(e){return Cl(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Cl(a){return a.op==="and"}function w0(a){return a.op==="or"}function sb(a){return JC(a)&&Cl(a)}function JC(a){for(const e of a.filters)if(e instanceof Lt)return!1;return!0}function _0(a){if(a instanceof wt)return a.field.canonicalString()+a.op.toString()+_l(a.value);if(sb(a))return a.filters.map(e=>_0(e)).join(",");{const e=a.filters.map(n=>_0(n)).join(",");return`${a.op}(${e})`}}function YC(a,e){return a instanceof wt?function(r,s){return s instanceof wt&&r.op===s.op&&r.field.isEqual(s.field)&&Ir(r.value,s.value)}(a,e):a instanceof Lt?function(r,s){return s instanceof Lt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((o,i,l)=>o&&YC(i,s.filters[l]),!0):!1}(a,e):void Le()}function ZC(a,e){const n=a.filters.concat(e);return Lt.create(n,a.op)}function XC(a){return a instanceof wt?function(n){return`${n.field.canonicalString()} ${n.op} ${_l(n.value)}`}(a):a instanceof Lt?function(n){return n.op.toString()+" {"+n.getFilters().map(XC).join(" ,")+"}"}(a):"Filter"}class uD extends wt{constructor(e,n,r){super(e,n,r),this.key=Ae.fromName(r.referenceValue)}matches(e){const n=Ae.comparator(e.key,this.key);return this.matchesComparison(n)}}class dD extends wt{constructor(e,n){super(e,"in",n),this.keys=eS("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class mD extends wt{constructor(e,n){super(e,"not-in",n),this.keys=eS("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function eS(a,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Ae.fromName(r.referenceValue))}class pD extends wt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Du(n)&&Ru(n.arrayValue,this.value)}}class tS extends wt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ru(this.value.arrayValue,n)}}class gD extends wt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ru(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Ru(this.value.arrayValue,n)}}class fD extends wt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Du(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ru(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e,n=null,r=[],s=[],o=null,i=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=o,this.startAt=i,this.endAt=l,this.ue=null}}function C0(a,e=null,n=[],r=[],s=null,o=null,i=null){return new hD(a,e,n,r,s,o,i)}function Yo(a){const e=ke(a);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>_0(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),ed(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>_l(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>_l(r)).join(",")),e.ue=n}return e.ue}function td(a,e){if(a.limit!==e.limit||a.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<a.orderBy.length;n++)if(!cD(a.orderBy[n],e.orderBy[n]))return!1;if(a.filters.length!==e.filters.length)return!1;for(let n=0;n<a.filters.length;n++)if(!YC(a.filters[n],e.filters[n]))return!1;return a.collectionGroup===e.collectionGroup&&!!a.path.isEqual(e.path)&&!!Iy(a.startAt,e.startAt)&&Iy(a.endAt,e.endAt)}function wp(a){return Ae.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}function _p(a,e){return a.filters.filter(n=>n instanceof wt&&n.field.isEqual(e))}function Ay(a,e,n){let r=Om,s=!0;for(const o of _p(a,e)){let i=Om,l=!0;switch(o.op){case"<":case"<=":i=iD(o.value);break;case"==":case"in":case">=":i=o.value;break;case">":i=o.value,l=!1;break;case"!=":case"not-in":i=Om}Cy({value:r,inclusive:s},{value:i,inclusive:l})<0&&(r=i,s=l)}if(n!==null){for(let o=0;o<a.orderBy.length;++o)if(a.orderBy[o].field.isEqual(e)){const i=n.position[o];Cy({value:r,inclusive:s},{value:i,inclusive:n.inclusive})<0&&(r=i,s=n.inclusive);break}}return{value:r,inclusive:s}}function Ty(a,e,n){let r=Ms,s=!0;for(const o of _p(a,e)){let i=Ms,l=!0;switch(o.op){case">=":case">":i=lD(o.value),l=!1;break;case"==":case"in":case"<=":i=o.value;break;case"<":i=o.value,l=!1;break;case"!=":case"not-in":i=Ms}Sy({value:r,inclusive:s},{value:i,inclusive:l})>0&&(r=i,s=l)}if(n!==null){for(let o=0;o<a.orderBy.length;++o)if(a.orderBy[o].field.isEqual(e)){const i=n.position[o];Sy({value:r,inclusive:s},{value:i,inclusive:n.inclusive})>0&&(r=i,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,n=null,r=[],s=[],o=null,i="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=o,this.limitType=i,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function aS(a,e,n,r,s,o,i,l){return new rs(a,e,n,r,s,o,i,l)}function Wl(a){return new rs(a)}function Py(a){return a.filters.length===0&&a.limit===null&&a.startAt==null&&a.endAt==null&&(a.explicitOrderBy.length===0||a.explicitOrderBy.length===1&&a.explicitOrderBy[0].field.isKeyField())}function ob(a){return a.collectionGroup!==null}function il(a){const e=ke(a);if(e.ce===null){e.ce=[];const n=new Set;for(const o of e.explicitOrderBy)e.ce.push(o),n.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(i){let l=new jt(Yt.comparator);return i.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(o=>{n.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Lu(o,r))}),n.has(Yt.keyField().canonicalString())||e.ce.push(new Lu(Yt.keyField(),r))}return e.ce}function Ya(a){const e=ke(a);return e.le||(e.le=rS(e,il(a))),e.le}function nS(a){const e=ke(a);return e.he||(e.he=rS(e,a.explicitOrderBy)),e.he}function rS(a,e){if(a.limitType==="F")return C0(a.path,a.collectionGroup,e,a.filters,a.limit,a.startAt,a.endAt);{e=e.map(s=>{const o=s.dir==="desc"?"asc":"desc";return new Lu(s.field,o)});const n=a.endAt?new Zs(a.endAt.position,a.endAt.inclusive):null,r=a.startAt?new Zs(a.startAt.position,a.startAt.inclusive):null;return C0(a.path,a.collectionGroup,e,a.filters,a.limit,n,r)}}function S0(a,e){const n=a.filters.concat([e]);return new rs(a.path,a.collectionGroup,a.explicitOrderBy.slice(),n,a.limit,a.limitType,a.startAt,a.endAt)}function Cp(a,e,n){return new rs(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),e,n,a.startAt,a.endAt)}function ad(a,e){return td(Ya(a),Ya(e))&&a.limitType===e.limitType}function sS(a){return`${Yo(Ya(a))}|lt:${a.limitType}`}function Oi(a){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>XC(s)).join(", ")}]`),ed(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>_l(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>_l(s)).join(",")),`Target(${r})`}(Ya(a))}; limitType=${a.limitType})`}function nd(a,e){return e.isFoundDocument()&&function(r,s){const o=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):Ae.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(a,e)&&function(r,s){for(const o of il(r))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0}(a,e)&&function(r,s){for(const o of r.filters)if(!o.matches(s))return!1;return!0}(a,e)&&function(r,s){return!(r.startAt&&!function(i,l,c){const u=ky(i,l,c);return i.inclusive?u<=0:u<0}(r.startAt,il(r),s)||r.endAt&&!function(i,l,c){const u=ky(i,l,c);return i.inclusive?u>=0:u>0}(r.endAt,il(r),s))}(a,e)}function oS(a){return a.collectionGroup||(a.path.length%2==1?a.path.lastSegment():a.path.get(a.path.length-2))}function iS(a){return(e,n)=>{let r=!1;for(const s of il(a)){const o=vD(s,e,n);if(o!==0)return o;r=r||s.field.isKeyField()}return 0}}function vD(a,e,n){const r=a.field.isKeyField()?Ae.comparator(e.key,n.key):function(o,i,l){const c=i.data.field(o),u=l.data.field(o);return c!==null&&u!==null?Ys(c,u):Le()}(a.field,e,n);switch(a.dir){case"asc":return r;case"desc":return-1*r;default:return Le()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,o]of r)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){lo(this.inner,(n,r)=>{for(const[s,o]of r)e(s,o)})}isEmpty(){return qC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD=new qt(Ae.comparator);function gn(){return bD}const lS=new qt(Ae.comparator);function Bc(...a){let e=lS;for(const n of a)e=e.insert(n.key,n);return e}function cS(a){let e=lS;return a.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function br(){return nu()}function uS(){return nu()}function nu(){return new ss(a=>a.toString(),(a,e)=>a.isEqual(e))}const ED=new qt(Ae.comparator),xD=new jt(Ae.comparator);function ct(...a){let e=xD;for(const n of a)e=e.add(n);return e}const yD=new jt(rt);function ib(){return yD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lb(a,e){if(a.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Tu(e)?"-0":e}}function dS(a){return{integerValue:""+a}}function mS(a,e){return jC(e)?dS(e):lb(a,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _g{constructor(){this._=void 0}}function ND(a,e,n){return a instanceof Sl?function(s,o){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&yg(o)&&(o=Ng(o)),o&&(i.fields.__previous_value__=o),{mapValue:i}}(n,e):a instanceof Zo?gS(a,e):a instanceof Xo?fS(a,e):function(s,o){const i=pS(s,o),l=Ry(i)+Ry(s.Pe);return N0(i)&&N0(s.Pe)?dS(l):lb(s.serializer,l)}(a,e)}function wD(a,e,n){return a instanceof Zo?gS(a,e):a instanceof Xo?fS(a,e):n}function pS(a,e){return a instanceof kl?function(r){return N0(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}class Sl extends _g{}class Zo extends _g{constructor(e){super(),this.elements=e}}function gS(a,e){const n=hS(e);for(const r of a.elements)n.some(s=>Ir(s,r))||n.push(r);return{arrayValue:{values:n}}}class Xo extends _g{constructor(e){super(),this.elements=e}}function fS(a,e){let n=hS(e);for(const r of a.elements)n=n.filter(s=>!Ir(s,r));return{arrayValue:{values:n}}}class kl extends _g{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Ry(a){return Qt(a.integerValue||a.doubleValue)}function hS(a){return Du(a)&&a.arrayValue.values?a.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e,n){this.field=e,this.transform=n}}function _D(a,e){return a.field.isEqual(e.field)&&function(r,s){return r instanceof Zo&&s instanceof Zo||r instanceof Xo&&s instanceof Xo?yl(r.elements,s.elements,Ir):r instanceof kl&&s instanceof kl?Ir(r.Pe,s.Pe):r instanceof Sl&&s instanceof Sl}(a.transform,e.transform)}class CD{constructor(e,n){this.version=e,this.transformResults=n}}class Zt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Zt}static exists(e){return new Zt(void 0,e)}static updateTime(e){return new Zt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function zm(a,e){return a.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(a.updateTime):a.exists===void 0||a.exists===e.isFoundDocument()}class Cg{}function vS(a,e){if(!a.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return a.isNoDocument()?new Hl(a.key,Zt.none()):new Gl(a.key,a.data,Zt.none());{const n=a.data,r=ja.empty();let s=new jt(Yt.comparator);for(let o of e.fields)if(!s.has(o)){let i=n.field(o);i===null&&o.length>1&&(o=o.popLast(),i=n.field(o)),i===null?r.delete(o):r.set(o,i),s=s.add(o)}return new os(a.key,r,new pn(s.toArray()),Zt.none())}}function SD(a,e,n){a instanceof Gl?function(s,o,i){const l=s.value.clone(),c=Ly(s.fieldTransforms,o,i.transformResults);l.setAll(c),o.convertToFoundDocument(i.version,l).setHasCommittedMutations()}(a,e,n):a instanceof os?function(s,o,i){if(!zm(s.precondition,o))return void o.convertToUnknownDocument(i.version);const l=Ly(s.fieldTransforms,o,i.transformResults),c=o.data;c.setAll(bS(s)),c.setAll(l),o.convertToFoundDocument(i.version,c).setHasCommittedMutations()}(a,e,n):function(s,o,i){o.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function ru(a,e,n,r){return a instanceof Gl?function(o,i,l,c){if(!zm(o.precondition,i))return l;const u=o.value.clone(),d=My(o.fieldTransforms,c,i);return u.setAll(d),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),null}(a,e,n,r):a instanceof os?function(o,i,l,c){if(!zm(o.precondition,i))return l;const u=My(o.fieldTransforms,c,i),d=i.data;return d.setAll(bS(o)),d.setAll(u),i.convertToFoundDocument(i.version,d).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(m=>m.field))}(a,e,n,r):function(o,i,l){return zm(o.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):l}(a,e,n)}function kD(a,e){let n=null;for(const r of a.fieldTransforms){const s=e.data.field(r.field),o=pS(r.transform,s||null);o!=null&&(n===null&&(n=ja.empty()),n.set(r.field,o))}return n||null}function Dy(a,e){return a.type===e.type&&!!a.key.isEqual(e.key)&&!!a.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&yl(r,s,(o,i)=>_D(o,i))}(a.fieldTransforms,e.fieldTransforms)&&(a.type===0?a.value.isEqual(e.value):a.type!==1||a.data.isEqual(e.data)&&a.fieldMask.isEqual(e.fieldMask))}class Gl extends Cg{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class os extends Cg{constructor(e,n,r,s,o=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function bS(a){const e=new Map;return a.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=a.data.field(n);e.set(n,r)}}),e}function Ly(a,e,n){const r=new Map;Fe(a.length===n.length);for(let s=0;s<n.length;s++){const o=a[s],i=o.transform,l=e.data.field(o.field);r.set(o.field,wD(i,l,n[s]))}return r}function My(a,e,n){const r=new Map;for(const s of a){const o=s.transform,i=n.data.field(s.field);r.set(s.field,ND(o,i,e))}return r}class Hl extends Cg{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class cb extends Cg{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(e.key)&&SD(o,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ru(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ru(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=uS();return this.mutations.forEach(s=>{const o=e.get(s.key),i=o.overlayedDocument;let l=this.applyToLocalView(i,o.mutatedFields);l=n.has(s.key)?null:l;const c=vS(i,l);c!==null&&r.set(s.key,c),i.isValidDocument()||i.convertToNoDocument(Be.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ct())}isEqual(e){return this.batchId===e.batchId&&yl(this.mutations,e.mutations,(n,r)=>Dy(n,r))&&yl(this.baseMutations,e.baseMutations,(n,r)=>Dy(n,r))}}class db{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Fe(e.mutations.length===r.length);let s=function(){return ED}();const o=e.mutations;for(let i=0;i<o.length;i++)s=s.insert(o[i].key,r[i].version);return new db(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ba,St;function xS(a){switch(a){default:return Le();case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0}}function yS(a){if(a===void 0)return fa("GRPC error has no .code"),ae.UNKNOWN;switch(a){case ba.OK:return ae.OK;case ba.CANCELLED:return ae.CANCELLED;case ba.UNKNOWN:return ae.UNKNOWN;case ba.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case ba.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case ba.INTERNAL:return ae.INTERNAL;case ba.UNAVAILABLE:return ae.UNAVAILABLE;case ba.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case ba.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case ba.NOT_FOUND:return ae.NOT_FOUND;case ba.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case ba.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case ba.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case ba.ABORTED:return ae.ABORTED;case ba.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case ba.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case ba.DATA_LOSS:return ae.DATA_LOSS;default:return Le()}}(St=ba||(ba={}))[St.OK=0]="OK",St[St.CANCELLED=1]="CANCELLED",St[St.UNKNOWN=2]="UNKNOWN",St[St.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",St[St.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",St[St.NOT_FOUND=5]="NOT_FOUND",St[St.ALREADY_EXISTS=6]="ALREADY_EXISTS",St[St.PERMISSION_DENIED=7]="PERMISSION_DENIED",St[St.UNAUTHENTICATED=16]="UNAUTHENTICATED",St[St.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",St[St.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",St[St.ABORTED=10]="ABORTED",St[St.OUT_OF_RANGE=11]="OUT_OF_RANGE",St[St.UNIMPLEMENTED=12]="UNIMPLEMENTED",St[St.INTERNAL=13]="INTERNAL",St[St.UNAVAILABLE=14]="UNAVAILABLE",St[St.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sp=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD=new Uo([4294967295,4294967295],0);function Vy(a){const e=NS().encode(a),n=new wC;return n.update(e),new Uint8Array(n.digest())}function Oy(a){const e=new DataView(a.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Uo([n,r],0),new Uo([s,o],0)]}class pb{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new qc(`Invalid padding: ${n}`);if(r<0)throw new qc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new qc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new qc(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Uo.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Uo.fromNumber(r)));return s.compare(AD)===1&&(s=new Uo([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Vy(e),[r,s]=Oy(n);for(let o=0;o<this.hashCount;o++){const i=this.Ee(r,s,o);if(!this.de(i))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),i=new pb(o,s,n);return r.forEach(l=>i.insert(l)),i}insert(e){if(this.Ie===0)return;const n=Vy(e),[r,s]=Oy(n);for(let o=0;o<this.hashCount;o++){const i=this.Ee(r,s,o);this.Ae(i)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class qc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd{constructor(e,n,r,s,o){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,od.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new sd(Be.min(),s,new qt(rt),gn(),ct())}}class od{constructor(e,n,r,s,o){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new od(r,n,ct(),ct(),ct())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class wS{constructor(e,n){this.targetId=e,this.me=n}}class _S{constructor(e,n,r=da.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class jy{constructor(){this.fe=0,this.ge=zy(),this.pe=da.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ct(),n=ct(),r=ct();return this.ge.forEach((s,o)=>{switch(o){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Le()}}),new od(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=zy()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Fe(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class TD{constructor(e){this.Le=e,this.Be=new Map,this.ke=gn(),this.qe=Fy(),this.Qe=new qt(rt)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:Le()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const o=s.target;if(wp(o))if(r===0){const i=new Ae(o.path);this.Ue(n,i,Gt.newNoDocument(i,Be.min()))}else Fe(r===1);else{const i=this.Ye(n);if(i!==r){const l=this.Ze(e),c=l?this.Xe(l,e,i):1;if(c!==0){this.je(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}Sp==null||Sp.et(function(d,m,h,C,S){var w,f,b,v,I,A;const N={localCacheCount:d,existenceFilterCount:m.count,databaseId:h.database,projectId:h.projectId},x=m.unchangedNames;return x&&(N.bloomFilter={applied:S===0,hashCount:(w=x==null?void 0:x.hashCount)!==null&&w!==void 0?w:0,bitmapLength:(v=(b=(f=x==null?void 0:x.bits)===null||f===void 0?void 0:f.bitmap)===null||b===void 0?void 0:b.length)!==null&&v!==void 0?v:0,padding:(A=(I=x==null?void 0:x.bits)===null||I===void 0?void 0:I.padding)!==null&&A!==void 0?A:0,mightContain:y=>{var E;return(E=C==null?void 0:C.mightContain(y))!==null&&E!==void 0&&E}}),N}(i,e.me,this.Le.tt(),l,c))}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:o=0}=n;let i,l;try{i=Zr(r).toUint8Array()}catch(c){if(c instanceof WC)return Fn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new pb(i,s,o)}catch(c){return Fn(c instanceof qc?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(o=>{const i=this.Le.tt(),l=`projects/${i.projectId}/databases/${i.database}/documents/${o.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,o,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((o,i)=>{const l=this.Je(i);if(l){if(o.current&&wp(l.target)){const c=new Ae(l.target.path);this.ke.get(c)!==null||this.it(i,c)||this.Ue(i,c,Gt.newNoDocument(c,e))}o.be&&(n.set(i,o.ve()),o.Ce())}});let r=ct();this.qe.forEach((o,i)=>{let l=!0;i.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(o))}),this.ke.forEach((o,i)=>i.setReadTime(e));const s=new sd(e,n,this.Qe,this.ke,r);return this.ke=gn(),this.qe=Fy(),this.Qe=new qt(rt),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new jy,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new jt(rt),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||Ee("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new jy),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Fy(){return new qt(Ae.comparator)}function zy(){return new qt(Ae.comparator)}const PD=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),RD=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),DD=(()=>({and:"AND",or:"OR"}))();class LD{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function k0(a,e){return a.useProto3Json||ed(e)?e:{value:e}}function Il(a,e){return a.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function CS(a,e){return a.useProto3Json?e.toBase64():e.toUint8Array()}function MD(a,e){return Il(a,e.toTimestamp())}function ha(a){return Fe(!!a),Be.fromTimestamp(function(n){const r=Yr(n);return new Kt(r.seconds,r.nanos)}(a))}function gb(a,e){return I0(a,e).canonicalString()}function I0(a,e){const n=function(s){return new Nt(["projects",s.projectId,"databases",s.database])}(a).child("documents");return e===void 0?n:n.child(e)}function SS(a){const e=Nt.fromString(a);return Fe(VS(e)),e}function Mu(a,e){return gb(a.databaseId,e.path)}function wr(a,e){const n=SS(e);if(n.get(1)!==a.databaseId.projectId)throw new xe(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+a.databaseId.projectId);if(n.get(3)!==a.databaseId.database)throw new xe(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+a.databaseId.database);return new Ae(AS(n))}function kS(a,e){return gb(a.databaseId,e)}function IS(a){const e=SS(a);return e.length===4?Nt.emptyPath():AS(e)}function A0(a){return new Nt(["projects",a.databaseId.projectId,"databases",a.databaseId.database]).canonicalString()}function AS(a){return Fe(a.length>4&&a.get(4)==="documents"),a.popFirst(5)}function Uy(a,e,n){return{name:Mu(a,e),fields:n.value.mapValue.fields}}function TS(a,e,n){const r=wr(a,e.name),s=ha(e.updateTime),o=e.createTime?ha(e.createTime):Be.min(),i=new ja({mapValue:{fields:e.fields}}),l=Gt.newFoundDocument(r,s,o,i);return n&&l.setHasCommittedMutations(),n?l.setHasCommittedMutations():l}function VD(a,e){return"found"in e?function(r,s){Fe(!!s.found),s.found.name,s.found.updateTime;const o=wr(r,s.found.name),i=ha(s.found.updateTime),l=s.found.createTime?ha(s.found.createTime):Be.min(),c=new ja({mapValue:{fields:s.found.fields}});return Gt.newFoundDocument(o,i,l,c)}(a,e):"missing"in e?function(r,s){Fe(!!s.missing),Fe(!!s.readTime);const o=wr(r,s.missing),i=ha(s.readTime);return Gt.newNoDocument(o,i)}(a,e):Le()}function OD(a,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Le()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=function(u,d){return u.useProto3Json?(Fe(d===void 0||typeof d=="string"),da.fromBase64String(d||"")):(Fe(d===void 0||d instanceof Buffer||d instanceof Uint8Array),da.fromUint8Array(d||new Uint8Array))}(a,e.targetChange.resumeToken),i=e.targetChange.cause,l=i&&function(u){const d=u.code===void 0?ae.UNKNOWN:yS(u.code);return new xe(d,u.message||"")}(i);n=new _S(r,s,o,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=wr(a,r.document.name),o=ha(r.document.updateTime),i=r.document.createTime?ha(r.document.createTime):Be.min(),l=new ja({mapValue:{fields:r.document.fields}}),c=Gt.newFoundDocument(s,o,i,l),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Um(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=wr(a,r.document),o=r.readTime?ha(r.readTime):Be.min(),i=Gt.newNoDocument(s,o),l=r.removedTargetIds||[];n=new Um([],l,i.key,i)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=wr(a,r.document),o=r.removedTargetIds||[];n=new Um([],o,s,null)}else{if(!("filter"in e))return Le();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:o}=r,i=new ID(s,o),l=r.targetId;n=new wS(l,i)}}return n}function Vu(a,e){let n;if(e instanceof Gl)n={update:Uy(a,e.key,e.value)};else if(e instanceof Hl)n={delete:Mu(a,e.key)};else if(e instanceof os)n={update:Uy(a,e.key,e.data),updateMask:BD(e.fieldMask)};else{if(!(e instanceof cb))return Le();n={verify:Mu(a,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(o,i){const l=i.transform;if(l instanceof Sl)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Zo)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Xo)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof kl)return{fieldPath:i.field.canonicalString(),increment:l.Pe};throw Le()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,o){return o.updateTime!==void 0?{updateTime:MD(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Le()}(a,e.precondition)),n}function T0(a,e){const n=e.currentDocument?function(o){return o.updateTime!==void 0?Zt.updateTime(ha(o.updateTime)):o.exists!==void 0?Zt.exists(o.exists):Zt.none()}(e.currentDocument):Zt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(i,l){let c=null;if("setToServerValue"in l)Fe(l.setToServerValue==="REQUEST_TIME"),c=new Sl;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];c=new Zo(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];c=new Xo(d)}else"increment"in l?c=new kl(i,l.increment):Le();const u=Yt.fromServerFormat(l.fieldPath);return new rd(u,c)}(a,s)):[];if(e.update){e.update.name;const s=wr(a,e.update.name),o=new ja({mapValue:{fields:e.update.fields}});if(e.updateMask){const i=function(c){const u=c.fieldPaths||[];return new pn(u.map(d=>Yt.fromServerFormat(d)))}(e.updateMask);return new os(s,o,i,n,r)}return new Gl(s,o,n,r)}if(e.delete){const s=wr(a,e.delete);return new Hl(s,n)}if(e.verify){const s=wr(a,e.verify);return new cb(s,n)}return Le()}function jD(a,e){return a&&a.length>0?(Fe(e!==void 0),a.map(n=>function(s,o){let i=s.updateTime?ha(s.updateTime):ha(o);return i.isEqual(Be.min())&&(i=ha(o)),new CD(i,s.transformResults||[])}(n,e))):[]}function PS(a,e){return{documents:[kS(a,e.path)]}}function Sg(a,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=kS(a,s);const o=function(u){if(u.length!==0)return MS(Lt.create(u,"and"))}(e.filters);o&&(n.structuredQuery.where=o);const i=function(u){if(u.length!==0)return u.map(d=>function(h){return{field:Cs(h.field),direction:zD(h.dir)}}(d))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const l=k0(a,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:s}}function RS(a,e,n,r){const{_t:s,parent:o}=Sg(a,e),i={},l=[];let c=0;return n.forEach(u=>{const d=r?u.alias:"aggregate_"+c++;i[d]=u.alias,u.aggregateType==="count"?l.push({alias:d,count:{}}):u.aggregateType==="avg"?l.push({alias:d,avg:{field:Cs(u.fieldPath)}}):u.aggregateType==="sum"&&l.push({alias:d,sum:{field:Cs(u.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:l,structuredQuery:s.structuredQuery},parent:s.parent},ut:i,parent:o}}function DS(a){let e=IS(a.parent);const n=a.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Fe(r===1);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let o=[];n.where&&(o=function(m){const h=LS(m);return h instanceof Lt&&sb(h)?h.getFilters():[h]}(n.where));let i=[];n.orderBy&&(i=function(m){return m.map(h=>function(S){return new Lu(ji(S.field),function(f){switch(f){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(h))}(n.orderBy));let l=null;n.limit&&(l=function(m){let h;return h=typeof m=="object"?m.value:m,ed(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(m){const h=!!m.before,C=m.values||[];return new Zs(C,h)}(n.startAt));let u=null;return n.endAt&&(u=function(m){const h=!m.before,C=m.values||[];return new Zs(C,h)}(n.endAt)),aS(e,s,i,o,l,"F",c,u)}function FD(a,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function LS(a){return a.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ji(n.unaryFilter.field);return wt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=ji(n.unaryFilter.field);return wt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=ji(n.unaryFilter.field);return wt.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=ji(n.unaryFilter.field);return wt.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Le()}}(a):a.fieldFilter!==void 0?function(n){return wt.create(ji(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Le()}}(n.fieldFilter.op),n.fieldFilter.value)}(a):a.compositeFilter!==void 0?function(n){return Lt.create(n.compositeFilter.filters.map(r=>LS(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Le()}}(n.compositeFilter.op))}(a):Le()}function zD(a){return PD[a]}function UD(a){return RD[a]}function $D(a){return DD[a]}function Cs(a){return{fieldPath:a.canonicalString()}}function ji(a){return Yt.fromServerFormat(a.fieldPath)}function MS(a){return a instanceof wt?function(n){if(n.op==="=="){if(_y(n.value))return{unaryFilter:{field:Cs(n.field),op:"IS_NAN"}};if(wy(n.value))return{unaryFilter:{field:Cs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(_y(n.value))return{unaryFilter:{field:Cs(n.field),op:"IS_NOT_NAN"}};if(wy(n.value))return{unaryFilter:{field:Cs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Cs(n.field),op:UD(n.op),value:n.value}}}(a):a instanceof Lt?function(n){const r=n.getFilters().map(s=>MS(s));return r.length===1?r[0]:{compositeFilter:{op:$D(n.op),filters:r}}}(a):Le()}function BD(a){const e=[];return a.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function VS(a){return a.length>=4&&a.get(0)==="projects"&&a.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e,n,r,s,o=Be.min(),i=Be.min(),l=da.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Fr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Fr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Fr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Fr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e){this.ct=e}}function qD(a,e){let n;if(e.document)n=TS(a.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Ae.fromSegments(e.noDocument.path),s=ti(e.noDocument.readTime);n=Gt.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Le();{const r=Ae.fromSegments(e.unknownDocument.path),s=ti(e.unknownDocument.version);n=Gt.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const o=new Kt(s[0],s[1]);return Be.fromTimestamp(o)}(e.readTime)),n}function $y(a,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:kp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,i){return{name:Mu(o,i.key),fields:i.data.value.mapValue.fields,updateTime:Il(o,i.version.toTimestamp()),createTime:Il(o,i.createTime.toTimestamp())}}(a.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ei(e.version)};else{if(!e.isUnknownDocument())return Le();r.unknownDocument={path:n.path.toArray(),version:ei(e.version)}}return r}function kp(a){const e=a.toTimestamp();return[e.seconds,e.nanoseconds]}function ei(a){const e=a.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ti(a){const e=new Kt(a.seconds,a.nanoseconds);return Be.fromTimestamp(e)}function Ao(a,e){const n=(e.baseMutations||[]).map(o=>T0(a.ct,o));for(let o=0;o<e.mutations.length-1;++o){const i=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const l=e.mutations[o+1];i.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const r=e.mutations.map(o=>T0(a.ct,o)),s=Kt.fromMillis(e.localWriteTimeMs);return new ub(e.batchId,s,n,r)}function Wc(a){const e=ti(a.readTime),n=a.lastLimboFreeSnapshotVersion!==void 0?ti(a.lastLimboFreeSnapshotVersion):Be.min();let r;return r=function(o){return o.documents!==void 0}(a.query)?function(o){return Fe(o.documents.length===1),Ya(Wl(IS(o.documents[0])))}(a.query):function(o){return Ya(DS(o))}(a.query),new Fr(r,a.targetId,"TargetPurposeListen",a.lastListenSequenceNumber,e,n,da.fromBase64String(a.resumeToken))}function jS(a,e){const n=ei(e.snapshotVersion),r=ei(e.lastLimboFreeSnapshotVersion);let s;s=wp(e.target)?PS(a.ct,e.target):Sg(a.ct,e.target)._t;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Yo(e.target),readTime:n,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function fb(a){const e=DS({parent:a.parent,structuredQuery:a.structuredQuery});return a.limitType==="LAST"?Cp(e,e.limit,"L"):e}function qf(a,e){return new mb(e.largestBatchId,T0(a.ct,e.overlayMutation))}function By(a,e){const n=e.path.lastSegment();return[a,Ja(e.path.popLast()),n]}function qy(a,e,n,r){return{indexId:a,uid:e,sequenceNumber:n,readTime:ei(r.readTime),documentKey:Ja(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{getBundleMetadata(e,n){return Wy(e).get(n).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:ti(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,n){return Wy(e).put(function(s){return{bundleId:s.id,createTime:ei(ha(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return Gy(e).get(n).next(r=>{if(r)return function(o){return{name:o.name,query:fb(o.bundledQuery),readTime:ti(o.readTime)}}(r)})}saveNamedQuery(e,n){return Gy(e).put(function(s){return{name:s.name,readTime:ei(ha(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function Wy(a){return Sa(a,"bundles")}function Gy(a){return Sa(a,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new kg(e,r)}getOverlay(e,n){return Cc(e).get(By(this.userId,n)).next(r=>r?qf(this.serializer,r):null)}getOverlays(e,n){const r=br();return Z.forEach(n,s=>this.getOverlay(e,s).next(o=>{o!==null&&r.set(s,o)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((o,i)=>{const l=new mb(n,i);s.push(this.ht(e,l))}),Z.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(i=>s.add(Ja(i.getCollectionPath())));const o=[];return s.forEach(i=>{const l=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,r+1],!1,!0);o.push(Cc(e).j("collectionPathOverlayIndex",l))}),Z.waitFor(o)}getOverlaysForCollection(e,n,r){const s=br(),o=Ja(n),i=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Cc(e).U("collectionPathOverlayIndex",i).next(l=>{for(const c of l){const u=qf(this.serializer,c);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const o=br();let i;const l=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Cc(e).J({index:"collectionGroupOverlayIndex",range:l},(c,u,d)=>{const m=qf(this.serializer,u);o.size()<s||m.largestBatchId===i?(o.set(m.getKey(),m),i=m.largestBatchId):d.done()}).next(()=>o)}ht(e,n){return Cc(e).put(function(s,o,i){const[l,c,u]=By(o,i.mutation.key);return{userId:o,collectionPath:c,documentId:u,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:Vu(s.ct,i.mutation)}}(this.serializer,this.userId,n))}}function Cc(a){return Sa(a,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{Pt(e){return Sa(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?da.fromUint8Array(r):da.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(Qt(e.integerValue));else if("doubleValue"in e){const r=Qt(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),Tu(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=Yr(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(Zr(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?GC(e)?this.dt(n,Number.MAX_SAFE_INTEGER):wg(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):Le()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const s of Object.keys(r))this.Vt(s,n),this.Tt(r[s],n)}wt(e,n){var r,s;const o=e.fields||{};this.dt(n,53);const i="value",l=((s=(r=o[i].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(n,15),n.At(Qt(l)),this.Vt(i,n),this.Tt(o[i],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const s of r)this.Tt(s,n)}yt(e,n){this.dt(n,37),Ae.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}To.vt=new To;function HD(a){if(a===0)return 8;let e=0;return!(a>>4)&&(e+=4,a<<=4),!(a>>6)&&(e+=2,a<<=2),!(a>>7)&&(e+=1),e}function Hy(a){const e=64-function(r){let s=0;for(let o=0;o<8;++o){const i=HD(255&r[o]);if(s+=i,i!==8)break}return s}(a);return Math.ceil(e/8)}class KD{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=n.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=n.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const n=this.qt(e),r=Hy(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}Kt(e){const n=this.qt(e),r=Hy(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(o){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,o,!1),new Uint8Array(i.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class QD{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class JD{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Sc{constructor(){this.jt=new KD,this.Ht=new QD(this.jt),this.Jt=new JD(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(e,n,r,s){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Po(this.indexId,this.documentKey,this.arrayValue,r)}}function hs(a,e){let n=a.indexId-e.indexId;return n!==0?n:(n=Ky(a.arrayValue,e.arrayValue),n!==0?n:(n=Ky(a.directionalValue,e.directionalValue),n!==0?n:Ae.comparator(a.documentKey,e.documentKey)))}function Ky(a,e){for(let n=0;n<a.length&&n<e.length;++n){const r=a[n]-e[n];if(r!==0)return r}return a.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(e){this.Xt=new jt((n,r)=>Yt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Fe(e.collectionGroup===this.collectionId),this.nn)return!1;const n=E0(e);if(n!==void 0&&!this.sn(n))return!1;const r=ko(e);let s=new Set,o=0,i=0;for(;o<r.length&&this.sn(r[o]);++o)s=s.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=r[o];if(!this.on(l,c)||!this._n(this.en[i++],c))return!1}++o}for(;o<r.length;++o){const l=r[o];if(i>=this.en.length||!this._n(this.en[i++],l))return!1}return!0}an(){if(this.nn)return null;let e=new jt(Yt.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new $o(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new $o(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new $o(r.field,r.dir==="asc"?0:1)));return new Nl(Nl.UNKNOWN_ID,this.collectionId,n,wl.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FS(a){var e,n;if(Fe(a instanceof wt||a instanceof Lt),a instanceof wt){if(a instanceof tS){const s=((n=(e=a.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(o=>wt.create(a.field,"==",o)))||[];return Lt.create(s,"or")}return a}const r=a.filters.map(s=>FS(s));return Lt.create(r,a.op)}function YD(a){if(a.getFilters().length===0)return[];const e=D0(FS(a));return Fe(zS(e)),P0(e)||R0(e)?[e]:e.getFilters()}function P0(a){return a instanceof wt}function R0(a){return a instanceof Lt&&sb(a)}function zS(a){return P0(a)||R0(a)||function(n){if(n instanceof Lt&&w0(n)){for(const r of n.getFilters())if(!P0(r)&&!R0(r))return!1;return!0}return!1}(a)}function D0(a){if(Fe(a instanceof wt||a instanceof Lt),a instanceof wt)return a;if(a.filters.length===1)return D0(a.filters[0]);const e=a.filters.map(r=>D0(r));let n=Lt.create(e,a.op);return n=Ip(n),zS(n)?n:(Fe(n instanceof Lt),Fe(Cl(n)),Fe(n.filters.length>1),n.filters.reduce((r,s)=>hb(r,s)))}function hb(a,e){let n;return Fe(a instanceof wt||a instanceof Lt),Fe(e instanceof wt||e instanceof Lt),n=a instanceof wt?e instanceof wt?function(s,o){return Lt.create([s,o],"and")}(a,e):Jy(a,e):e instanceof wt?Jy(e,a):function(s,o){if(Fe(s.filters.length>0&&o.filters.length>0),Cl(s)&&Cl(o))return ZC(s,o.getFilters());const i=w0(s)?s:o,l=w0(s)?o:s,c=i.filters.map(u=>hb(u,l));return Lt.create(c,"or")}(a,e),Ip(n)}function Jy(a,e){if(Cl(e))return ZC(e,a.getFilters());{const n=e.filters.map(r=>hb(a,r));return Lt.create(n,"or")}}function Ip(a){if(Fe(a instanceof wt||a instanceof Lt),a instanceof wt)return a;const e=a.getFilters();if(e.length===1)return Ip(e[0]);if(JC(a))return a;const n=e.map(s=>Ip(s)),r=[];return n.forEach(s=>{s instanceof wt?r.push(s):s instanceof Lt&&(s.op===a.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Lt.create(r,a.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(){this.un=new vb}addToCollectionParentIndex(e,n){return this.un.add(n),Z.resolve()}getCollectionParents(e,n){return Z.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return Z.resolve()}deleteFieldIndex(e,n){return Z.resolve()}deleteAllFieldIndexes(e){return Z.resolve()}createTargetIndexes(e,n){return Z.resolve()}getDocumentsMatchingTarget(e,n){return Z.resolve(null)}getIndexType(e,n){return Z.resolve(0)}getFieldIndexes(e,n){return Z.resolve([])}getNextCollectionGroupToUpdate(e){return Z.resolve(null)}getMinOffset(e,n){return Z.resolve(kn.min())}getMinOffsetFromCollectionGroup(e,n){return Z.resolve(kn.min())}updateCollectionGroup(e,n,r){return Z.resolve()}updateIndexEntries(e,n){return Z.resolve()}}class vb{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new jt(Nt.comparator),o=!s.has(r);return this.index[n]=s.add(r),o}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new jt(Nt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const um=new Uint8Array(0);class XD{constructor(e,n){this.databaseId=n,this.cn=new vb,this.ln=new ss(r=>Yo(r),(r,s)=>td(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const o={collectionId:r,parent:Ja(s)};return Yy(e).put(o)}return Z.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[RC(n),""],!1,!0);return Yy(e).U(s).next(o=>{for(const i of o){if(i.collectionId!==n)break;r.push(vr(i.parent))}return r})}addFieldIndex(e,n){const r=kc(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const o=r.add(s);if(n.indexState){const i=Ri(e);return o.next(l=>{i.put(qy(l,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return o.next()}deleteFieldIndex(e,n){const r=kc(e),s=Ri(e),o=Pi(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=kc(e),r=Pi(e),s=Ri(e);return n.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,n){return Z.forEach(this.hn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const o=new Qy(r).an();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,n){const r=Pi(e);let s=!0;const o=new Map;return Z.forEach(this.hn(n),i=>this.Pn(e,i).next(l=>{s&&(s=!!l),o.set(i,l)})).next(()=>{if(s){let i=ct();const l=[];return Z.forEach(o,(c,u)=>{Ee("IndexedDbIndexManager",`Using index ${function(I){return`id=${I.indexId}|cg=${I.collectionGroup}|f=${I.fields.map(A=>`${A.fieldPath}:${A.kind}`).join(",")}`}(c)} to execute ${Yo(n)}`);const d=function(I,A){const N=E0(A);if(N===void 0)return null;for(const x of _p(I,N.fieldPath))switch(x.op){case"array-contains-any":return x.value.arrayValue.values||[];case"array-contains":return[x.value]}return null}(u,c),m=function(I,A){const N=new Map;for(const x of ko(A))for(const y of _p(I,x.fieldPath))switch(y.op){case"==":case"in":N.set(x.fieldPath.canonicalString(),y.value);break;case"not-in":case"!=":return N.set(x.fieldPath.canonicalString(),y.value),Array.from(N.values())}return null}(u,c),h=function(I,A){const N=[];let x=!0;for(const y of ko(A)){const E=y.kind===0?Ay(I,y.fieldPath,I.startAt):Ty(I,y.fieldPath,I.startAt);N.push(E.value),x&&(x=E.inclusive)}return new Zs(N,x)}(u,c),C=function(I,A){const N=[];let x=!0;for(const y of ko(A)){const E=y.kind===0?Ty(I,y.fieldPath,I.endAt):Ay(I,y.fieldPath,I.endAt);N.push(E.value),x&&(x=E.inclusive)}return new Zs(N,x)}(u,c),S=this.In(c,u,h),w=this.In(c,u,C),f=this.Tn(c,u,m),b=this.En(c.indexId,d,S,h.inclusive,w,C.inclusive,f);return Z.forEach(b,v=>r.G(v,n.limit).next(I=>{I.forEach(A=>{const N=Ae.fromSegments(A.documentKey);i.has(N)||(i=i.add(N),l.push(N))})}))}).next(()=>l)}return Z.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=YD(Lt.create(e.filters,"and")).map(r=>C0(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,s,o,i,l){const c=(n!=null?n.length:1)*Math.max(r.length,o.length),u=c/(n!=null?n.length:1),d=[];for(let m=0;m<c;++m){const h=n?this.dn(n[m/u]):um,C=this.An(e,h,r[m%u],s),S=this.Rn(e,h,o[m%u],i),w=l.map(f=>this.An(e,h,f,!0));d.push(...this.createRange(C,S,w))}return d}An(e,n,r,s){const o=new Po(e,Ae.empty(),n,r);return s?o:o.Zt()}Rn(e,n,r,s){const o=new Po(e,Ae.empty(),n,r);return s?o.Zt():o}Pn(e,n){const r=new Qy(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(o=>{let i=null;for(const l of o)r.rn(l)&&(!i||l.fields.length>i.fields.length)&&(i=l);return i})}getIndexType(e,n){let r=2;const s=this.hn(n);return Z.forEach(s,o=>this.Pn(e,o).next(i=>{i?r!==0&&i.fields.length<function(c){let u=new jt(Yt.comparator),d=!1;for(const m of c.filters)for(const h of m.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?d=!0:u=u.add(h.field));for(const m of c.orderBy)m.field.isKeyField()||(u=u.add(m.field));return u.size+(d?1:0)}(o)&&(r=1):r=0})).next(()=>function(i){return i.limit!==null}(n)&&s.length>1&&r===2?1:r)}Vn(e,n){const r=new Sc;for(const s of ko(e)){const o=n.data.field(s.fieldPath);if(o==null)return null;const i=r.Yt(s.kind);To.vt.It(o,i)}return r.zt()}dn(e){const n=new Sc;return To.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new Sc;return To.vt.It(Jo(this.databaseId,n),r.Yt(function(o){const i=ko(o);return i.length===0?0:i[i.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let s=[];s.push(new Sc);let o=0;for(const i of ko(e)){const l=r[o++];for(const c of s)if(this.fn(n,i.fieldPath)&&Du(l))s=this.gn(s,i,l);else{const u=c.Yt(i.kind);To.vt.It(l,u)}}return this.pn(s)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const s=[...e],o=[];for(const i of r.arrayValue.values||[])for(const l of s){const c=new Sc;c.seed(l.zt()),To.vt.It(i,c.Yt(n.kind)),o.push(c)}return o}fn(e,n){return!!e.filters.find(r=>r instanceof wt&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=kc(e),s=Ri(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(o=>{const i=[];return Z.forEach(o,l=>s.get([l.indexId,this.uid]).next(c=>{i.push(function(d,m){const h=m?new wl(m.sequenceNumber,new kn(ti(m.readTime),new Ae(vr(m.documentKey)),m.largestBatchId)):wl.empty(),C=d.fields.map(([S,w])=>new $o(Yt.fromServerFormat(S),w));return new Nl(d.indexId,d.collectionGroup,C,h)}(l,c))})).next(()=>i)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const o=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return o!==0?o:rt(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=kc(e),o=Ri(e);return this.yn(e).next(i=>s.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(l=>Z.forEach(l,c=>o.put(qy(c.indexId,this.uid,i,r)))))}updateIndexEntries(e,n){const r=new Map;return Z.forEach(n,(s,o)=>{const i=r.get(s.collectionGroup);return(i?Z.resolve(i):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(r.set(s.collectionGroup,l),Z.forEach(l,c=>this.wn(e,s,c).next(u=>{const d=this.Sn(o,c);return u.isEqual(d)?Z.resolve():this.bn(e,o,c,u,d)}))))})}Dn(e,n,r,s){return Pi(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,s){return Pi(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const s=Pi(e);let o=new jt(hs);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(i,l)=>{o=o.add(new Po(r.indexId,n,l.arrayValue,l.directionalValue))}).next(()=>o)}Sn(e,n){let r=new jt(hs);const s=this.Vn(n,e);if(s==null)return r;const o=E0(n);if(o!=null){const i=e.data.field(o.fieldPath);if(Du(i))for(const l of i.arrayValue.values||[])r=r.add(new Po(n.indexId,e.key,this.dn(l),s))}else r=r.add(new Po(n.indexId,e.key,um,s));return r}bn(e,n,r,s,o){Ee("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const i=[];return function(c,u,d,m,h){const C=c.getIterator(),S=u.getIterator();let w=Ti(C),f=Ti(S);for(;w||f;){let b=!1,v=!1;if(w&&f){const I=d(w,f);I<0?v=!0:I>0&&(b=!0)}else w!=null?v=!0:b=!0;b?(m(f),f=Ti(S)):v?(h(w),w=Ti(C)):(w=Ti(C),f=Ti(S))}}(s,o,hs,l=>{i.push(this.Dn(e,n,r,l))},l=>{i.push(this.vn(e,n,r,l))}),Z.waitFor(i)}yn(e){let n=1;return Ri(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,o)=>{o.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((i,l)=>hs(i,l)).filter((i,l,c)=>!l||hs(i,c[l-1])!==0);const s=[];s.push(e);for(const i of r){const l=hs(i,e),c=hs(i,n);if(l===0)s[0]=e.Zt();else if(l>0&&c<0)s.push(i),s.push(i.Zt());else if(c>0)break}s.push(n);const o=[];for(let i=0;i<s.length;i+=2){if(this.Cn(s[i],s[i+1]))return[];const l=[s[i].indexId,this.uid,s[i].arrayValue,s[i].directionalValue,um,[]],c=[s[i+1].indexId,this.uid,s[i+1].arrayValue,s[i+1].directionalValue,um,[]];o.push(IDBKeyRange.bound(l,c))}return o}Cn(e,n){return hs(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Zy)}getMinOffset(e,n){return Z.mapArray(this.hn(n),r=>this.Pn(e,r).next(s=>s||Le())).next(Zy)}}function Yy(a){return Sa(a,"collectionParents")}function Pi(a){return Sa(a,"indexEntries")}function kc(a){return Sa(a,"indexConfiguration")}function Ri(a){return Sa(a,"indexState")}function Zy(a){Fe(a.length!==0);let e=a[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<a.length;r++){const s=a[r].indexState.offset;ab(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new kn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ka{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Ka(e,Ka.DEFAULT_COLLECTION_PERCENTILE,Ka.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function US(a,e,n){const r=a.store("mutations"),s=a.store("documentMutations"),o=[],i=IDBKeyRange.only(n.batchId);let l=0;const c=r.J({range:i},(d,m,h)=>(l++,h.delete()));o.push(c.next(()=>{Fe(l===1)}));const u=[];for(const d of n.mutations){const m=FC(e,d.key.path,n.batchId);o.push(s.delete(m)),u.push(d.key)}return Z.waitFor(o).next(()=>u)}function Ap(a){if(!a)return 0;let e;if(a.document)e=a.document;else if(a.unknownDocument)e=a.unknownDocument;else{if(!a.noDocument)throw Le();e=a.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ka.DEFAULT_COLLECTION_PERCENTILE=10,Ka.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ka.DEFAULT=new Ka(41943040,Ka.DEFAULT_COLLECTION_PERCENTILE,Ka.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ka.DISABLED=new Ka(-1,0,0);class Ig{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,n,r,s){Fe(e.uid!=="");const o=e.isAuthenticated()?e.uid:"";return new Ig(o,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return vs(e).J({index:"userMutationsIndex",range:r},(s,o,i)=>{n=!1,i.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const o=Fi(e),i=vs(e);return i.add({}).next(l=>{Fe(typeof l=="number");const c=new ub(l,n,r,s),u=function(C,S,w){const f=w.baseMutations.map(v=>Vu(C.ct,v)),b=w.mutations.map(v=>Vu(C.ct,v));return{userId:S,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:f,mutations:b}}(this.serializer,this.userId,c),d=[];let m=new jt((h,C)=>rt(h.canonicalString(),C.canonicalString()));for(const h of s){const C=FC(this.userId,h.key.path,l);m=m.add(h.key.path.popLast()),d.push(i.put(u)),d.push(o.put(C,U6))}return m.forEach(h=>{d.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),Z.waitFor(d).next(()=>c)})}lookupMutationBatch(e,n){return vs(e).get(n).next(r=>r?(Fe(r.userId===this.userId),Ao(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?Z.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Fn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let o=null;return vs(e).J({index:"userMutationsIndex",range:s},(i,l,c)=>{l.userId===this.userId&&(Fe(l.batchId>=r),o=Ao(this.serializer,l)),c.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return vs(e).J({index:"userMutationsIndex",range:n,reverse:!0},(s,o,i)=>{r=o.batchId,i.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return vs(e).U("userMutationsIndex",n).next(r=>r.map(s=>Ao(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Vm(this.userId,n.path),s=IDBKeyRange.lowerBound(r),o=[];return Fi(e).J({range:s},(i,l,c)=>{const[u,d,m]=i,h=vr(d);if(u===this.userId&&n.path.isEqual(h))return vs(e).get(m).next(C=>{if(!C)throw Le();Fe(C.userId===this.userId),o.push(Ao(this.serializer,C))});c.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new jt(rt);const s=[];return n.forEach(o=>{const i=Vm(this.userId,o.path),l=IDBKeyRange.lowerBound(i),c=Fi(e).J({range:l},(u,d,m)=>{const[h,C,S]=u,w=vr(C);h===this.userId&&o.path.isEqual(w)?r=r.add(S):m.done()});s.push(c)}),Z.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,o=Vm(this.userId,r),i=IDBKeyRange.lowerBound(o);let l=new jt(rt);return Fi(e).J({range:i},(c,u,d)=>{const[m,h,C]=c,S=vr(h);m===this.userId&&r.isPrefixOf(S)?S.length===s&&(l=l.add(C)):d.done()}).next(()=>this.xn(e,l))}xn(e,n){const r=[],s=[];return n.forEach(o=>{s.push(vs(e).get(o).next(i=>{if(i===null)throw Le();Fe(i.userId===this.userId),r.push(Ao(this.serializer,i))}))}),Z.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return US(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),Z.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return Z.resolve();const r=IDBKeyRange.lowerBound(function(i){return[i]}(this.userId)),s=[];return Fi(e).J({range:r},(o,i,l)=>{if(o[0]===this.userId){const c=vr(o[1]);s.push(c)}else l.done()}).next(()=>{Fe(s.length===0)})})}containsKey(e,n){return $S(e,this.userId,n)}Nn(e){return BS(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function $S(a,e,n){const r=Vm(e,n.path),s=r[1],o=IDBKeyRange.lowerBound(r);let i=!1;return Fi(a).J({range:o,H:!0},(l,c,u)=>{const[d,m,h]=l;d===e&&m===s&&(i=!0),u.done()}).next(()=>i)}function vs(a){return Sa(a,"mutations")}function Fi(a){return Sa(a,"documentMutations")}function BS(a){return Sa(a,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ai(0)}static kn(){return new ai(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new ai(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>Be.fromTimestamp(new Kt(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Qn(e,s)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Di(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(Fe(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let s=0;const o=[];return Di(e).J((i,l)=>{const c=Wc(l);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,o.push(this.removeTargetData(e,c)))}).next(()=>Z.waitFor(o)).next(()=>s)}forEachTarget(e,n){return Di(e).J((r,s)=>{const o=Wc(s);n(o)})}qn(e){return eN(e).get("targetGlobalKey").next(n=>(Fe(n!==null),n))}Qn(e,n){return eN(e).put("targetGlobalKey",n)}Kn(e,n){return Di(e).put(jS(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Yo(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let o=null;return Di(e).J({range:s,index:"queryTargetsIndex"},(i,l,c)=>{const u=Wc(l);td(n,u.target)&&(o=u,c.done())}).next(()=>o)}addMatchingKeys(e,n,r){const s=[],o=Ss(e);return n.forEach(i=>{const l=Ja(i.path);s.push(o.put({targetId:r,path:l})),s.push(this.referenceDelegate.addReference(e,r,i))}),Z.waitFor(s)}removeMatchingKeys(e,n,r){const s=Ss(e);return Z.forEach(n,o=>{const i=Ja(o.path);return Z.waitFor([s.delete([r,i]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,n){const r=Ss(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Ss(e);let o=ct();return s.J({range:r,H:!0},(i,l,c)=>{const u=vr(i[1]),d=new Ae(u);o=o.add(d)}).next(()=>o)}containsKey(e,n){const r=Ja(n.path),s=IDBKeyRange.bound([r],[RC(r)],!1,!0);let o=0;return Ss(e).J({index:"documentTargetsIndex",H:!0,range:s},([i,l],c,u)=>{i!==0&&(o++,u.done())}).next(()=>o>0)}ot(e,n){return Di(e).get(n).next(r=>r?Wc(r):null)}}function Di(a){return Sa(a,"targets")}function eN(a){return Sa(a,"targetGlobal")}function Ss(a){return Sa(a,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tN([a,e],[n,r]){const s=rt(a,n);return s===0?rt(e,r):s}class tL{constructor(e){this.Un=e,this.buffer=new jt(tN),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();tN(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class qS{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){Ee("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){io(n)?Ee("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await oo(n)}await this.Hn(3e5)})}}class aL{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return Z.resolve(mn.oe);const r=new tL(n);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Ee("LruGarbageCollector","Garbage collection skipped; disabled"),Z.resolve(Xy)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Xy):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,s,o,i,l,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(Ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,i=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,l=Date.now(),this.removeTargets(e,r,n))).next(m=>(o=m,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(u=Date.now(),Vi()<=yt.DEBUG&&Ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${i-d}ms
	Determined least recently used ${s} in `+(l-i)+`ms
	Removed ${o} targets in `+(c-l)+`ms
	Removed ${m} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),Z.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:m})))}}function WS(a,e){return new aL(a,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(e,n){this.db=e,this.garbageCollector=WS(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,s)=>n(s))}addReference(e,n,r){return dm(e,r)}removeReference(e,n,r){return dm(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return dm(e,n)}nr(e,n){return function(s,o){let i=!1;return BS(s).Y(l=>$S(s,l,o).next(c=>(c&&(i=!0),Z.resolve(!c)))).next(()=>i)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let o=0;return this.tr(e,(i,l)=>{if(l<=n){const c=this.nr(e,i).next(u=>{if(!u)return o++,r.getEntry(e,i).next(()=>(r.removeEntry(i,Be.min()),Ss(e).delete(function(m){return[0,Ja(m.path)]}(i))))});s.push(c)}}).next(()=>Z.waitFor(s)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return dm(e,n)}tr(e,n){const r=Ss(e);let s,o=mn.oe;return r.J({index:"documentTargetsIndex"},([i,l],{path:c,sequenceNumber:u})=>{i===0?(o!==mn.oe&&n(new Ae(vr(s)),o),o=u,s=c):o=mn.oe}).next(()=>{o!==mn.oe&&n(new Ae(vr(s)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function dm(a,e){return Ss(a).put(function(r,s){return{targetId:0,path:Ja(r.path),sequenceNumber:s}}(e,a.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(){this.changes=new ss(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Gt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?Z.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return No(e).put(r)}removeEntry(e,n,r){return No(e).delete(function(o,i){const l=o.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],kp(i),l[l.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=Gt.newInvalidDocument(n);return No(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ic(n))},(s,o)=>{r=this.ir(n,o)}).next(()=>r)}sr(e,n){let r={size:0,document:Gt.newInvalidDocument(n)};return No(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ic(n))},(s,o)=>{r={document:this.ir(n,o),size:Ap(o)}}).next(()=>r)}getEntries(e,n){let r=gn();return this._r(e,n,(s,o)=>{const i=this.ir(s,o);r=r.insert(s,i)}).next(()=>r)}ar(e,n){let r=gn(),s=new qt(Ae.comparator);return this._r(e,n,(o,i)=>{const l=this.ir(o,i);r=r.insert(o,l),s=s.insert(o,Ap(i))}).next(()=>({documents:r,ur:s}))}_r(e,n,r){if(n.isEmpty())return Z.resolve();let s=new jt(rN);n.forEach(c=>s=s.add(c));const o=IDBKeyRange.bound(Ic(s.first()),Ic(s.last())),i=s.getIterator();let l=i.getNext();return No(e).J({index:"documentKeyIndex",range:o},(c,u,d)=>{const m=Ae.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&rN(l,m)<0;)r(l,null),l=i.getNext();l&&l.isEqual(m)&&(r(l,u),l=i.hasNext()?i.getNext():null),l?d.$(Ic(l)):d.done()}).next(()=>{for(;l;)r(l,null),l=i.hasNext()?i.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,o){const i=n.path,l=[i.popLast().toArray(),i.lastSegment(),kp(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return No(e).U(IDBKeyRange.bound(l,c,!0)).next(u=>{o==null||o.incrementDocumentReadCount(u.length);let d=gn();for(const m of u){const h=this.ir(Ae.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);h.isFoundDocument()&&(nd(n,h)||s.has(h.key))&&(d=d.insert(h.key,h))}return d})}getAllFromCollectionGroup(e,n,r,s){let o=gn();const i=nN(n,r),l=nN(n,kn.max());return No(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(i,l,!0)},(c,u,d)=>{const m=this.ir(Ae.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);o=o.insert(m.key,m),o.size===s&&d.done()}).next(()=>o)}newChangeBuffer(e){return new sL(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return aN(e).get("remoteDocumentGlobalKey").next(n=>(Fe(!!n),n))}rr(e,n){return aN(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=qD(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Be.min())))return r}return Gt.newInvalidDocument(e)}}function HS(a){return new rL(a)}class sL extends GS{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new ss(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new jt((o,i)=>rt(o.canonicalString(),i.canonicalString()));return this.changes.forEach((o,i)=>{const l=this.lr.get(o);if(n.push(this.cr.removeEntry(e,o,l.readTime)),i.isValidDocument()){const c=$y(this.cr.serializer,i);s=s.add(o.path.popLast());const u=Ap(c);r+=u-l.size,n.push(this.cr.addEntry(e,o,c))}else if(r-=l.size,this.trackRemovals){const c=$y(this.cr.serializer,i.convertToNoDocument(Be.min()));n.push(this.cr.addEntry(e,o,c))}}),s.forEach(o=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,o))}),n.push(this.cr.updateMetadata(e,r)),Z.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:s})=>(s.forEach((o,i)=>{this.lr.set(o,{size:i,readTime:r.get(o).readTime})}),r))}}function aN(a){return Sa(a,"remoteDocumentGlobal")}function No(a){return Sa(a,"remoteDocumentsV14")}function Ic(a){const e=a.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function nN(a,e){const n=e.documentKey.path.toArray();return[a,kp(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function rN(a,e){const n=a.path.toArray(),r=e.path.toArray();let s=0;for(let o=0;o<n.length-2&&o<r.length-2;++o)if(s=rt(n[o],r[o]),s)return s;return s=rt(n.length,r.length),s||(s=rt(n[n.length-2],r[r.length-2]),s||rt(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oL{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&ru(r.mutation,s,pn.empty(),Kt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ct()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ct()){const s=br();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(o=>{let i=Bc();return o.forEach((l,c)=>{i=i.insert(l,c.overlayedDocument)}),i}))}getOverlayedDocuments(e,n){const r=br();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ct()))}populateOverlays(e,n,r){const s=[];return r.forEach(o=>{n.has(o)||s.push(o)}),this.documentOverlayCache.getOverlays(e,s).next(o=>{o.forEach((i,l)=>{n.set(i,l)})})}computeViews(e,n,r,s){let o=gn();const i=nu(),l=function(){return nu()}();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof os)?o=o.insert(u.key,u):d!==void 0?(i.set(u.key,d.mutation.getFieldMask()),ru(d.mutation,u,d.mutation.getFieldMask(),Kt.now())):i.set(u.key,pn.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((u,d)=>i.set(u,d)),n.forEach((u,d)=>{var m;return l.set(u,new oL(d,(m=i.get(u))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,n){const r=nu();let s=new qt((i,l)=>i-l),o=ct();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(i=>{for(const l of i)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||pn.empty();d=l.applyToLocalView(u,d),r.set(c,d);const m=(s.get(l.batchId)||ct()).add(c);s=s.insert(l.batchId,m)})}).next(()=>{const i=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,m=uS();d.forEach(h=>{if(!o.has(h)){const C=vS(n.get(h),r.get(h));C!==null&&m.set(h,C),o=o.add(h)}}),i.push(this.documentOverlayCache.saveOverlays(e,u,m))}return Z.waitFor(i)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(i){return Ae.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):ob(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(o=>{const i=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-o.size):Z.resolve(br());let l=-1,c=o;return i.next(u=>Z.forEach(u,(d,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),o.get(d)?Z.resolve():this.remoteDocumentCache.getEntry(e,d).next(h=>{c=c.insert(d,h)}))).next(()=>this.populateOverlays(e,u,o)).next(()=>this.computeViews(e,c,u,ct())).next(d=>({batchId:l,changes:cS(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ae(n)).next(r=>{let s=Bc();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const o=n.collectionGroup;let i=Bc();return this.indexManager.getCollectionParents(e,o).next(l=>Z.forEach(l,c=>{const u=function(m,h){return new rs(h,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((m,h)=>{i=i.insert(m,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,r,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(i=>(o=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,o,s))).next(i=>{o.forEach((c,u)=>{const d=u.getKey();i.get(d)===null&&(i=i.insert(d,Gt.newInvalidDocument(d)))});let l=Bc();return i.forEach((c,u)=>{const d=o.get(c);d!==void 0&&ru(d.mutation,u,pn.empty(),Kt.now()),nd(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return Z.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:ha(s.createTime)}}(n)),Z.resolve()}getNamedQuery(e,n){return Z.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:fb(s.bundledQuery),readTime:ha(s.readTime)}}(n)),Z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{constructor(){this.overlays=new qt(Ae.comparator),this.Ir=new Map}getOverlay(e,n){return Z.resolve(this.overlays.get(n))}getOverlays(e,n){const r=br();return Z.forEach(n,s=>this.getOverlay(e,s).next(o=>{o!==null&&r.set(s,o)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,o)=>{this.ht(e,n,o)}),Z.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),Z.resolve()}getOverlaysForCollection(e,n,r){const s=br(),o=n.length+1,i=new Ae(n.child("")),l=this.overlays.getIteratorFrom(i);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===o&&c.largestBatchId>r&&s.set(c.getKey(),c)}return Z.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let o=new qt((u,d)=>u-d);const i=this.overlays.getIterator();for(;i.hasNext();){const u=i.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=o.get(u.largestBatchId);d===null&&(d=br(),o=o.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=br(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return Z.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const i=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,i)}this.overlays=this.overlays.insert(r.key,new mb(n,r));let o=this.Ir.get(n);o===void 0&&(o=ct(),this.Ir.set(n,o)),this.Ir.set(n,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(){this.sessionToken=da.EMPTY_BYTE_STRING}getSessionToken(e){return Z.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(){this.Tr=new jt(Aa.Er),this.dr=new jt(Aa.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Aa(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Aa(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new Ae(new Nt([])),r=new Aa(n,e),s=new Aa(n,e+1),o=[];return this.dr.forEachInRange([r,s],i=>{this.Vr(i),o.push(i.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new Ae(new Nt([])),r=new Aa(n,e),s=new Aa(n,e+1);let o=ct();return this.dr.forEachInRange([r,s],i=>{o=o.add(i.key)}),o}containsKey(e){const n=new Aa(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Aa{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return Ae.comparator(e.key,n.key)||rt(e.wr,n.wr)}static Ar(e,n){return rt(e.wr,n.wr)||Ae.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new jt(Aa.Er)}checkEmpty(e){return Z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new ub(o,n,r,s);this.mutationQueue.push(i);for(const l of s)this.br=this.br.add(new Aa(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Z.resolve(i)}lookupMutationBatch(e,n){return Z.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),o=s<0?0:s;return Z.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return Z.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Aa(n,0),s=new Aa(n,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,s],i=>{const l=this.Dr(i.wr);o.push(l)}),Z.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new jt(rt);return n.forEach(s=>{const o=new Aa(s,0),i=new Aa(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,i],l=>{r=r.add(l.wr)})}),Z.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let o=r;Ae.isDocumentKey(o)||(o=o.child(""));const i=new Aa(new Ae(o),0);let l=new jt(rt);return this.br.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.wr)),!0)},i),Z.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Fe(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return Z.forEach(n.mutations,s=>{const o=new Aa(s.key,n.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Aa(n,0),s=this.br.firstAfterOrEqual(r);return Z.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Z.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e){this.Mr=e,this.docs=function(){return new qt(Ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),o=s?s.size:0,i=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:i}),this.size+=i-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return Z.resolve(r?r.document.mutableCopy():Gt.newInvalidDocument(n))}getEntries(e,n){let r=gn();return n.forEach(s=>{const o=this.docs.get(s);r=r.insert(s,o?o.document.mutableCopy():Gt.newInvalidDocument(s))}),Z.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let o=gn();const i=n.path,l=new Ae(i.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!i.isPrefixOf(u.path))break;u.path.length>i.length+1||ab(LC(d),r)<=0||(s.has(d.key)||nd(n,d))&&(o=o.insert(d.key,d.mutableCopy()))}return Z.resolve(o)}getAllFromCollectionGroup(e,n,r,s){Le()}Or(e,n){return Z.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new mL(this)}getSize(e){return Z.resolve(this.size)}}class mL extends GS{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),Z.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(e){this.persistence=e,this.Nr=new ss(n=>Yo(n),td),this.lastRemoteSnapshotVersion=Be.min(),this.highestTargetId=0,this.Lr=0,this.Br=new bb,this.targetCount=0,this.kr=ai.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),Z.resolve()}getLastRemoteSnapshotVersion(e){return Z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Z.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Z.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),Z.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ai(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,Z.resolve()}updateTargetData(e,n){return this.Kn(n),Z.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,Z.resolve()}removeTargets(e,n,r){let s=0;const o=[];return this.Nr.forEach((i,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(i),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),Z.waitFor(o).next(()=>s)}getTargetCount(e){return Z.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return Z.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),Z.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,o=[];return s&&n.forEach(i=>{o.push(s.markPotentiallyOrphaned(e,i))}),Z.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),Z.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return Z.resolve(r)}containsKey(e,n){return Z.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb{constructor(e,n){this.qr={},this.overlays={},this.Qr=new mn(0),this.Kr=!1,this.Kr=!0,this.$r=new cL,this.referenceDelegate=e(this),this.Ur=new pL(this),this.indexManager=new ZD,this.remoteDocumentCache=function(s){return new dL(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new OS(n),this.Gr=new iL(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new lL,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new uL(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){Ee("MemoryPersistence","Starting transaction:",e);const s=new gL(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(o=>this.referenceDelegate.jr(s).next(()=>o)).toPromise().then(o=>(s.raiseOnCommittedEvent(),o))}Hr(e,n){return Z.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class gL extends VC{constructor(e){super(),this.currentSequenceNumber=e}}class Ag{constructor(e){this.persistence=e,this.Jr=new bb,this.Yr=null}static Zr(e){return new Ag(e)}get Xr(){if(this.Yr)return this.Yr;throw Le()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),Z.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),Z.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),Z.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Z.forEach(this.Xr,r=>{const s=Ae.fromPath(r);return this.ei(e,s).next(o=>{o||n.removeEntry(s,Be.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return Z.or([()=>Z.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}class Tp{constructor(e,n){this.persistence=e,this.ti=new ss(r=>Ja(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=WS(this,n)}static Zr(e,n){return new Tp(e,n)}zr(){}jr(e){return Z.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}Yn(e){const n=this.er(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}Zn(e,n){return Z.forEach(this.ti,(r,s)=>this.nr(e,r,s).next(o=>o?Z.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.Or(e,i=>this.nr(e,i,n).next(l=>{l||(r++,o.removeEntry(i,Be.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.ti.set(n,e.currentSequenceNumber),Z.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.ti.set(r,e.currentSequenceNumber),Z.resolve()}removeReference(e,n,r){return this.ti.set(r,e.currentSequenceNumber),Z.resolve()}updateLimboDocument(e,n){return this.ti.set(n,e.currentSequenceNumber),Z.resolve()}Wr(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=jm(e.data.value)),n}nr(e,n,r){return Z.or([()=>this.persistence.Hr(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.ti.get(n);return Z.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(e){this.serializer=e}O(e,n,r,s){const o=new xg("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",by,{unique:!0}),c.createObjectStore("documentMutations")}(e),sN(e),function(c){c.createObjectStore("remoteDocuments")}(e));let i=Z.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),sN(e)),i=i.next(()=>function(c){const u=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Be.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(o))),r<4&&s>=4&&(r!==0&&(i=i.next(()=>function(c,u){return u.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",by,{unique:!0});const m=u.store("mutations"),h=d.map(C=>m.put(C));return Z.waitFor(h)})}(e,o))),i=i.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(i=i.next(()=>this.ni(o))),r<6&&s>=6&&(i=i.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(o)))),r<7&&s>=7&&(i=i.next(()=>this.ii(o))),r<8&&s>=8&&(i=i.next(()=>this.si(e,o))),r<9&&s>=9&&(i=i.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(i=i.next(()=>this.oi(o))),r<11&&s>=11&&(i=i.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(i=i.next(()=>{(function(c){const u=c.createObjectStore("documentOverlays",{keyPath:X6});u.createIndex("collectionPathOverlayIndex",eD,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",tD,{unique:!1})})(e)})),r<13&&s>=13&&(i=i.next(()=>function(c){const u=c.createObjectStore("remoteDocumentsV14",{keyPath:$6});u.createIndex("documentKeyIndex",B6),u.createIndex("collectionGroupIndex",q6)}(e)).next(()=>this._i(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(i=i.next(()=>this.ai(e,o))),r<15&&s>=15&&(i=i.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:Q6}).createIndex("sequenceNumberIndex",J6,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:Y6}).createIndex("documentKeyIndex",Z6,{unique:!1})}(e))),r<16&&s>=16&&(i=i.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&s>=17&&(i=i.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),i}ri(e){let n=0;return e.store("remoteDocuments").J((r,s)=>{n+=Ap(s)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(s=>Z.forEach(s,o=>{const i=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",i).next(l=>Z.forEach(l,c=>{Fe(c.userId===o.userId);const u=Ao(this.serializer,c);return US(e,o.userId,u).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const o=[];return r.J((i,l)=>{const c=new Nt(i),u=function(m){return[0,Ja(m)]}(c);o.push(n.get(u).next(d=>d?Z.resolve():(m=>n.put({targetId:0,path:Ja(m),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>Z.waitFor(o))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:K6});const r=n.store("collectionParents"),s=new vb,o=i=>{if(s.add(i)){const l=i.lastSegment(),c=i.popLast();return r.put({collectionId:l,parent:Ja(c)})}};return n.store("remoteDocuments").J({H:!0},(i,l)=>{const c=new Nt(i);return o(c.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([i,l,c],u)=>{const d=vr(l);return o(d.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,s)=>{const o=Wc(s),i=jS(this.serializer,o);return n.put(i)})}_i(e,n){const r=n.store("remoteDocuments"),s=[];return r.J((o,i)=>{const l=n.store("remoteDocumentsV14"),c=function(m){return m.document?new Ae(Nt.fromString(m.document.name).popFirst(5)):m.noDocument?Ae.fromSegments(m.noDocument.path):m.unknownDocument?Ae.fromSegments(m.unknownDocument.path):Le()}(i).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:i.readTime||[0,0],unknownDocument:i.unknownDocument,noDocument:i.noDocument,document:i.document,hasCommittedMutations:!!i.hasCommittedMutations};s.push(l.put(u))}).next(()=>Z.waitFor(s))}ai(e,n){const r=n.store("mutations"),s=HS(this.serializer),o=new Eb(Ag.Zr,this.serializer.ct);return r.U().next(i=>{const l=new Map;return i.forEach(c=>{var u;let d=(u=l.get(c.userId))!==null&&u!==void 0?u:ct();Ao(this.serializer,c).keys().forEach(m=>d=d.add(m)),l.set(c.userId,d)}),Z.forEach(l,(c,u)=>{const d=new Pa(u),m=kg.lt(this.serializer,d),h=o.getIndexManager(d),C=Ig.lt(d,this.serializer,h,o.referenceDelegate);return new KS(s,C,m,h).recalculateAndSaveOverlaysForDocumentKeys(new x0(n,mn.oe),c).next()})})}}function sN(a){a.createObjectStore("targetDocuments",{keyPath:G6}).createIndex("documentTargetsIndex",H6,{unique:!0}),a.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",W6,{unique:!0}),a.createObjectStore("targetGlobal")}const Wf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class xb{constructor(e,n,r,s,o,i,l,c,u,d,m=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=o,this.window=i,this.document=l,this.ci=u,this.li=d,this.hi=m,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=h=>Promise.resolve(),!xb.D())throw new xe(ae.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new nL(this,s),this.Ai=n+"main",this.serializer=new OS(c),this.Ri=new Nr(this.Ai,this.hi,new fL(this.serializer)),this.$r=new GD,this.Ur=new eL(this.referenceDelegate,this.serializer),this.remoteDocumentCache=HS(this.serializer),this.Gr=new WD,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&fa("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new xe(ae.FAILED_PRECONDITION,Wf);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new mn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>mm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(io(e))return Ee("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ee("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Ac(e).get("owner").next(n=>Z.resolve(this.vi(n)))}Ci(e){return mm(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Sa(n,"clientMetadata");return r.U().next(s=>{const o=this.xi(s,18e5),i=s.filter(l=>o.indexOf(l)===-1);return Z.forEach(i,l=>r.delete(l.clientId)).next(()=>i)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?Z.resolve(!0):Ac(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new xe(ae.FAILED_PRECONDITION,Wf);return!1}}return!(!this.networkEnabled||!this.inForeground)||mm(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const o=!this.networkEnabled&&s.networkEnabled,i=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(o||i&&l)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&Ee("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new x0(e,mn.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>mm(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return Ig.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new XD(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return kg.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){Ee("IndexedDbPersistence","Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",o=function(c){return c===17?rD:c===16?nD:c===15?rb:c===14?$C:c===13?UC:c===12?aD:c===11?zC:void Le()}(this.hi);let i;return this.Ri.runTransaction(e,s,o,l=>(i=new x0(l,this.Qr?this.Qr.next():mn.oe),n==="readwrite-primary"?this.wi(i).next(c=>!!c||this.Si(i)).next(c=>{if(!c)throw fa(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new xe(ae.FAILED_PRECONDITION,MC);return r(i)}).next(c=>this.Di(i).next(()=>c)):this.Ki(i).next(()=>r(i)))).then(l=>(i.raiseOnCommittedEvent(),l))}Ki(e){return Ac(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new xe(ae.FAILED_PRECONDITION,Wf)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ac(e).put("owner",n)}static D(){return Nr.D()}bi(e){const n=Ac(e);return n.get("owner").next(r=>this.vi(r)?(Ee("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):Z.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(fa(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;hC()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return Ee("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return fa("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){fa("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ac(a){return Sa(a,"owner")}function mm(a){return Sa(a,"clientMetadata")}function yb(a,e){let n=a.projectId;return a.isDefaultDatabase||(n+="."+a.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=ct(),s=ct();for(const o of n.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new Nb(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return hC()?8:OC(_a())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const o={result:null};return this.Yi(e,n).next(i=>{o.result=i}).next(()=>{if(!o.result)return this.Zi(e,n,s,r).next(i=>{o.result=i})}).next(()=>{if(o.result)return;const i=new hL;return this.Xi(e,n,i).next(l=>{if(o.result=l,this.zi)return this.es(e,n,i,l.size)})}).next(()=>o.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Vi()<=yt.DEBUG&&Ee("QueryEngine","SDK will not create cache indexes for query:",Oi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Z.resolve()):(Vi()<=yt.DEBUG&&Ee("QueryEngine","Query:",Oi(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Vi()<=yt.DEBUG&&Ee("QueryEngine","The SDK decides to create cache indexes for query:",Oi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ya(n))):Z.resolve())}Yi(e,n){if(Py(n))return Z.resolve(null);let r=Ya(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Cp(n,null,"F"),r=Ya(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{const i=ct(...o);return this.Ji.getDocuments(e,i).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ts(n,l);return this.ns(n,u,i,c.readTime)?this.Yi(e,Cp(n,null,"F")):this.rs(e,u,n,c)}))})))}Zi(e,n,r,s){return Py(n)||s.isEqual(Be.min())?Z.resolve(null):this.Ji.getDocuments(e,r).next(o=>{const i=this.ts(n,o);return this.ns(n,i,r,s)?Z.resolve(null):(Vi()<=yt.DEBUG&&Ee("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Oi(n)),this.rs(e,i,n,DC(s,-1)).next(l=>l))})}ts(e,n){let r=new jt(iS(e));return n.forEach((s,o)=>{nd(e,o)&&(r=r.add(o))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Xi(e,n,r){return Vi()<=yt.DEBUG&&Ee("QueryEngine","Using full collection scan to execute query:",Oi(n)),this.Ji.getDocumentsMatchingQuery(e,n,kn.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(o=>(n.forEach(i=>{o=o.insert(i.key,i)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vL{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new qt(rt),this._s=new ss(o=>Yo(o),td),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new KS(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function JS(a,e,n,r){return new vL(a,e,n,r)}async function YS(a,e){const n=ke(a);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(o=>(s=o,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(o=>{const i=[],l=[];let c=ct();for(const u of s){i.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of o){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:i,addedBatchIds:l}))})})}function bL(a,e){const n=ke(a);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),o=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const m=u.batch,h=m.keys();let C=Z.resolve();return h.forEach(S=>{C=C.next(()=>d.getEntry(c,S)).next(w=>{const f=u.docVersions.get(S);Fe(f!==null),w.version.compareTo(f)<0&&(m.applyToRemoteDocument(w,u),w.isValidDocument()&&(w.setReadTime(u.commitVersion),d.addEntry(w)))})}),C.next(()=>l.mutationQueue.removeMutationBatch(c,m))}(n,r,e,o).next(()=>o.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=ct();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function ZS(a){const e=ke(a);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function EL(a,e){const n=ke(a),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const i=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((d,m)=>{const h=s.get(m);if(!h)return;l.push(n.Ur.removeMatchingKeys(o,d.removedDocuments,m).next(()=>n.Ur.addMatchingKeys(o,d.addedDocuments,m)));let C=h.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(m)!==null?C=C.withResumeToken(da.EMPTY_BYTE_STRING,Be.min()).withLastLimboFreeSnapshotVersion(Be.min()):d.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(d.resumeToken,r)),s=s.insert(m,C),function(w,f,b){return w.resumeToken.approximateByteSize()===0||f.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(h,C,d)&&l.push(n.Ur.updateTargetData(o,C))});let c=gn(),u=ct();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(o,d))}),l.push(XS(o,i,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!r.isEqual(Be.min())){const d=n.Ur.getLastRemoteSnapshotVersion(o).next(m=>n.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));l.push(d)}return Z.waitFor(l).next(()=>i.apply(o)).next(()=>n.localDocuments.getLocalViewOfDocuments(o,c,u)).next(()=>c)}).then(o=>(n.os=s,o))}function XS(a,e,n){let r=ct(),s=ct();return n.forEach(o=>r=r.add(o)),e.getEntries(a,r).next(o=>{let i=gn();return n.forEach((l,c)=>{const u=o.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(Be.min())?(e.removeEntry(l,c.readTime),i=i.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),i=i.insert(l,c)):Ee("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:i,Is:s}})}function xL(a,e){const n=ke(a);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Al(a,e){const n=ke(a);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(o=>o?(s=o,Z.resolve(s)):n.Ur.allocateTargetId(r).next(i=>(s=new Fr(e,i,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Tl(a,e,n){const r=ke(a),s=r.os.get(e),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,i=>r.persistence.referenceDelegate.removeTarget(i,s))}catch(i){if(!io(i))throw i;Ee("LocalStore",`Failed to update sequence numbers for target ${e}: ${i}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Pp(a,e,n){const r=ke(a);let s=Be.min(),o=ct();return r.persistence.runTransaction("Execute query","readwrite",i=>function(c,u,d){const m=ke(c),h=m._s.get(d);return h!==void 0?Z.resolve(m.os.get(h)):m.Ur.getTargetData(u,d)}(r,i,Ya(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(i,l.targetId).next(c=>{o=c})}).next(()=>r.ss.getDocumentsMatchingQuery(i,e,n?s:Be.min(),n?o:ct())).next(l=>(ak(r,oS(e),l),{documents:l,Ts:o})))}function ek(a,e){const n=ke(a),r=ke(n.Ur),s=n.os.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",o=>r.ot(o,e).next(i=>i?i.target:null))}function tk(a,e){const n=ke(a),r=n.us.get(e)||Be.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.cs.getAllFromCollectionGroup(s,e,DC(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(ak(n,e,s),s))}function ak(a,e,n){let r=a.us.get(e)||Be.min();n.forEach((s,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),a.us.set(e,r)}async function yL(a,e,n,r){const s=ke(a);let o=ct(),i=gn();for(const u of n){const d=e.Es(u.metadata.name);u.document&&(o=o.add(d));const m=e.ds(u);m.setReadTime(e.As(u.metadata.readTime)),i=i.insert(d,m)}const l=s.cs.newChangeBuffer({trackRemovals:!0}),c=await Al(s,function(d){return Ya(Wl(Nt.fromString(`__bundle__/docs/${d}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",u=>XS(u,l,i).next(d=>(l.apply(u),d)).next(d=>s.Ur.removeMatchingKeysForTargetId(u,c.targetId).next(()=>s.Ur.addMatchingKeys(u,o,c.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(u,d.Ps,d.Is)).next(()=>d.Ps)))}async function NL(a,e,n=ct()){const r=await Al(a,Ya(fb(e.bundledQuery))),s=ke(a);return s.persistence.runTransaction("Save named query","readwrite",o=>{const i=ha(e.readTime);if(r.snapshotVersion.compareTo(i)>=0)return s.Gr.saveNamedQuery(o,e);const l=r.withResumeToken(da.EMPTY_BYTE_STRING,i);return s.os=s.os.insert(l.targetId,l),s.Ur.updateTargetData(o,l).next(()=>s.Ur.removeMatchingKeysForTargetId(o,r.targetId)).next(()=>s.Ur.addMatchingKeys(o,n,r.targetId)).next(()=>s.Gr.saveNamedQuery(o,e))})}function oN(a,e){return`firestore_clients_${a}_${e}`}function iN(a,e,n){let r=`firestore_mutations_${a}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Gf(a,e){return`firestore_targets_${a}_${e}`}class Rp{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static Rs(e,n,r){const s=JSON.parse(r);let o,i=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return i&&s.error&&(i=typeof s.error.message=="string"&&typeof s.error.code=="string",i&&(o=new xe(s.error.code,s.error.message))),i?new Rp(e,n,s.state,o):(fa("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class su{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let s,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(s=new xe(r.error.code,r.error.message))),o?new su(e,r.state,s):(fa("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Dp{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,o=ib();for(let i=0;s&&i<r.activeTargetIds.length;++i)s=jC(r.activeTargetIds[i]),o=o.add(r.activeTargetIds[i]);return s?new Dp(e,o):(fa("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class wb{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new wb(n.clientId,n.onlineState):(fa("SharedClientState",`Failed to parse online state: ${e}`),null)}}class L0{constructor(){this.activeTargetIds=ib()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Hf{constructor(e,n,r,s,o){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new qt(rt),this.started=!1,this.bs=[];const i=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ds=oN(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new L0),this.Cs=new RegExp(`^firestore_clients_${i}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${i}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${i}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const s=this.getItem(oN(this.persistenceKey,r));if(s){const o=Dp.Rs(r,s);o&&(this.Ss=this.Ss.insert(o.clientId,o))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Gf(this.persistenceKey,e));if(s){const o=su.Rs(e,s);o&&(r=o.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Gf(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.Qs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return Ee("SharedClientState","READ",e,n),n}setItem(e,n){Ee("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){Ee("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(Ee("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void fa("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(o){let i=mn.oe;if(o!=null)try{const l=JSON.parse(o);Fe(typeof l=="number"),i=l}catch(l){fa("SharedClientState","Failed to read sequence number from WebStorage",l)}return i}(n.newValue);r!==mn.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const s=new Rp(this.currentUser,e,n,r),o=iN(this.persistenceKey,this.currentUser,e);this.setItem(o,s.Vs())}Qs(e){const n=iN(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const s=Gf(this.persistenceKey,e),o=new su(e,n,r);this.setItem(s,o.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return Dp.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),s=Number(r[1]),o=r[2]!==void 0?r[2]:null;return Rp.Rs(new Pa(o),s,n)}Ys(e,n){const r=this.Ms.exec(e),s=Number(r[1]);return su.Rs(s,n)}Ls(e){return wb.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);Ee("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),s=this.ks(this.Ss),o=this.ks(r),i=[],l=[];return o.forEach(c=>{s.has(c)||i.push(c)}),s.forEach(c=>{o.has(c)||l.push(c)}),this.syncEngine.io(i,l).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=ib();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class nk{constructor(){this.so=new L0,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new L0,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wL{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Ee("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Ee("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pm=null;function Kf(){return pm===null?pm=function(){return 268435456+Math.round(2147483648*Math.random())}():pm++,"0x"+pm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _L={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CL{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ha="WebChannelConnection";class SL extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${o}`}get Fo(){return!1}Mo(n,r,s,o,i){const l=Kf(),c=this.xo(n,r.toUriEncodedString());Ee("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,o,i),this.No(n,c,u,s).then(d=>(Ee("RestConnection",`Received RPC '${n}' ${l}: `,d),d),d=>{throw Fn("RestConnection",`RPC '${n}' ${l} failed with error: `,d,"url: ",c,"request:",s),d})}Lo(n,r,s,o,i,l){return this.Mo(n,r,s,o,i)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ql}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,i)=>n[i]=o),s&&s.headers.forEach((o,i)=>n[i]=o)}xo(n,r){const s=_L[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const o=Kf();return new Promise((i,l)=>{const c=new _C;c.setWithCredentials(!0),c.listenOnce(CC.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Mm.NO_ERROR:const d=c.getResponseJson();Ee(Ha,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(d)),i(d);break;case Mm.TIMEOUT:Ee(Ha,`RPC '${e}' ${o} timed out`),l(new xe(ae.DEADLINE_EXCEEDED,"Request time out"));break;case Mm.HTTP_ERROR:const m=c.getStatus();if(Ee(Ha,`RPC '${e}' ${o} failed with status:`,m,"response text:",c.getResponseText()),m>0){let h=c.getResponseJson();Array.isArray(h)&&(h=h[0]);const C=h==null?void 0:h.error;if(C&&C.status&&C.message){const S=function(f){const b=f.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(b)>=0?b:ae.UNKNOWN}(C.status);l(new xe(S,C.message))}else l(new xe(ae.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new xe(ae.UNAVAILABLE,"Connection failed."));break;default:Le()}}finally{Ee(Ha,`RPC '${e}' ${o} completed.`)}});const u=JSON.stringify(s);Ee(Ha,`RPC '${e}' ${o} sending request:`,s),c.send(n,"POST",u,r,15)})}Bo(e,n,r){const s=Kf(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=IC(),l=kC(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=o.join("");Ee(Ha,`Creating RPC '${e}' stream ${s}: ${d}`,c);const m=i.createWebChannel(d,c);let h=!1,C=!1;const S=new CL({Io:f=>{C?Ee(Ha,`Not sending because RPC '${e}' stream ${s} is closed:`,f):(h||(Ee(Ha,`Opening RPC '${e}' stream ${s} transport.`),m.open(),h=!0),Ee(Ha,`RPC '${e}' stream ${s} sending:`,f),m.send(f))},To:()=>m.close()}),w=(f,b,v)=>{f.listen(b,I=>{try{v(I)}catch(A){setTimeout(()=>{throw A},0)}})};return w(m,$c.EventType.OPEN,()=>{C||(Ee(Ha,`RPC '${e}' stream ${s} transport opened.`),S.yo())}),w(m,$c.EventType.CLOSE,()=>{C||(C=!0,Ee(Ha,`RPC '${e}' stream ${s} transport closed`),S.So())}),w(m,$c.EventType.ERROR,f=>{C||(C=!0,Fn(Ha,`RPC '${e}' stream ${s} transport errored:`,f),S.So(new xe(ae.UNAVAILABLE,"The operation could not be completed")))}),w(m,$c.EventType.MESSAGE,f=>{var b;if(!C){const v=f.data[0];Fe(!!v);const I=v,A=I.error||((b=I[0])===null||b===void 0?void 0:b.error);if(A){Ee(Ha,`RPC '${e}' stream ${s} received error:`,A);const N=A.status;let x=function(_){const P=ba[_];if(P!==void 0)return yS(P)}(N),y=A.message;x===void 0&&(x=ae.INTERNAL,y="Unknown error status: "+N+" with message "+A.message),C=!0,S.So(new xe(x,y)),m.close()}else Ee(Ha,`RPC '${e}' stream ${s} received:`,v),S.bo(v)}}),w(l,SC.STAT_EVENT,f=>{f.stat===b0.PROXY?Ee(Ha,`RPC '${e}' stream ${s} detected buffering proxy`):f.stat===b0.NOPROXY&&Ee(Ha,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{S.wo()},0),S}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rk(){return typeof window<"u"?window:null}function $m(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function id(a){return new LD(a,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{constructor(e,n,r=1e3,s=1.5,o=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&Ee("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e,n,r,s,o,i,l,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=o,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new _b(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===ae.RESOURCE_EXHAUSTED?(fa(n.toString()),fa("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new xe(ae.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Ee("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(Ee("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class kL extends sk{constructor(e,n,r,s,o,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,i),this.serializer=o}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=OD(this.serializer,e),r=function(o){if(!("targetChange"in o))return Be.min();const i=o.targetChange;return i.targetIds&&i.targetIds.length?Be.min():i.readTime?ha(i.readTime):Be.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=A0(this.serializer),n.addTarget=function(o,i){let l;const c=i.target;if(l=wp(c)?{documents:PS(o,c)}:{query:Sg(o,c)._t},l.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){l.resumeToken=CS(o,i.resumeToken);const u=k0(o,i.expectedCount);u!==null&&(l.expectedCount=u)}else if(i.snapshotVersion.compareTo(Be.min())>0){l.readTime=Il(o,i.snapshotVersion.toTimestamp());const u=k0(o,i.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=FD(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=A0(this.serializer),n.removeTarget=e,this.a_(n)}}class IL extends sk{constructor(e,n,r,s,o,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,i),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Fe(!!e.streamToken),this.lastStreamToken=e.streamToken,Fe(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Fe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=jD(e.writeResults,e.commitTime),r=ha(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=A0(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Vu(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AL extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new xe(ae.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,i])=>this.connection.Mo(e,I0(n,r),s,o,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new xe(ae.UNKNOWN,o.toString())})}Lo(e,n,r,s,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,l])=>this.connection.Lo(e,I0(n,r),s,i,l,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new xe(ae.UNKNOWN,i.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class TL{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(fa(n),this.D_=!1):Ee("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(e,n,r,s,o){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(i=>{r.enqueueAndForget(async()=>{co(this)&&(Ee("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=ke(c);u.L_.add(4),await Kl(u),u.q_.set("Unknown"),u.L_.delete(4),await ld(u)}(this))})}),this.q_=new TL(r,s)}}async function ld(a){if(co(a))for(const e of a.B_)await e(!0)}async function Kl(a){for(const e of a.B_)await e(!1)}function Tg(a,e){const n=ke(a);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),kb(n)?Sb(n):Jl(n).r_()&&Cb(n,e))}function Pl(a,e){const n=ke(a),r=Jl(n);n.N_.delete(e),r.r_()&&ok(n,e),n.N_.size===0&&(r.r_()?r.o_():co(n)&&n.q_.set("Unknown"))}function Cb(a,e){if(a.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Be.min())>0){const n=a.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Jl(a).A_(e)}function ok(a,e){a.Q_.xe(e),Jl(a).R_(e)}function Sb(a){a.Q_=new TD({getRemoteKeysForTarget:e=>a.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>a.N_.get(e)||null,tt:()=>a.datastore.serializer.databaseId}),Jl(a).start(),a.q_.v_()}function kb(a){return co(a)&&!Jl(a).n_()&&a.N_.size>0}function co(a){return ke(a).L_.size===0}function ik(a){a.Q_=void 0}async function RL(a){a.q_.set("Online")}async function DL(a){a.N_.forEach((e,n)=>{Cb(a,e)})}async function LL(a,e){ik(a),kb(a)?(a.q_.M_(e),Sb(a)):a.q_.set("Unknown")}async function ML(a,e,n){if(a.q_.set("Online"),e instanceof _S&&e.state===2&&e.cause)try{await async function(s,o){const i=o.cause;for(const l of o.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,i),s.N_.delete(l),s.Q_.removeTarget(l))}(a,e)}catch(r){Ee("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Lp(a,r)}else if(e instanceof Um?a.Q_.Ke(e):e instanceof wS?a.Q_.He(e):a.Q_.We(e),!n.isEqual(Be.min()))try{const r=await ZS(a.localStore);n.compareTo(r)>=0&&await function(o,i){const l=o.Q_.rt(i);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=o.N_.get(u);d&&o.N_.set(u,d.withResumeToken(c.resumeToken,i))}}),l.targetMismatches.forEach((c,u)=>{const d=o.N_.get(c);if(!d)return;o.N_.set(c,d.withResumeToken(da.EMPTY_BYTE_STRING,d.snapshotVersion)),ok(o,c);const m=new Fr(d.target,c,u,d.sequenceNumber);Cb(o,m)}),o.remoteSyncer.applyRemoteEvent(l)}(a,n)}catch(r){Ee("RemoteStore","Failed to raise snapshot:",r),await Lp(a,r)}}async function Lp(a,e,n){if(!io(e))throw e;a.L_.add(1),await Kl(a),a.q_.set("Offline"),n||(n=()=>ZS(a.localStore)),a.asyncQueue.enqueueRetryable(async()=>{Ee("RemoteStore","Retrying IndexedDB access"),await n(),a.L_.delete(1),await ld(a)})}function lk(a,e){return e().catch(n=>Lp(a,n,e))}async function Ql(a){const e=ke(a),n=Xs(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;VL(e);)try{const s=await xL(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,OL(e,s)}catch(s){await Lp(e,s)}ck(e)&&uk(e)}function VL(a){return co(a)&&a.O_.length<10}function OL(a,e){a.O_.push(e);const n=Xs(a);n.r_()&&n.V_&&n.m_(e.mutations)}function ck(a){return co(a)&&!Xs(a).n_()&&a.O_.length>0}function uk(a){Xs(a).start()}async function jL(a){Xs(a).p_()}async function FL(a){const e=Xs(a);for(const n of a.O_)e.m_(n.mutations)}async function zL(a,e,n){const r=a.O_.shift(),s=db.from(r,e,n);await lk(a,()=>a.remoteSyncer.applySuccessfulWrite(s)),await Ql(a)}async function UL(a,e){e&&Xs(a).V_&&await async function(r,s){if(function(i){return xS(i)&&i!==ae.ABORTED}(s.code)){const o=r.O_.shift();Xs(r).s_(),await lk(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),await Ql(r)}}(a,e),ck(a)&&uk(a)}async function cN(a,e){const n=ke(a);n.asyncQueue.verifyOperationInProgress(),Ee("RemoteStore","RemoteStore received new credentials");const r=co(n);n.L_.add(3),await Kl(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await ld(n)}async function M0(a,e){const n=ke(a);e?(n.L_.delete(2),await ld(n)):e||(n.L_.add(2),await Kl(n),n.q_.set("Unknown"))}function Jl(a){return a.K_||(a.K_=function(n,r,s){const o=ke(n);return o.w_(),new kL(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(a.datastore,a.asyncQueue,{Eo:RL.bind(null,a),Ro:DL.bind(null,a),mo:LL.bind(null,a),d_:ML.bind(null,a)}),a.B_.push(async e=>{e?(a.K_.s_(),kb(a)?Sb(a):a.q_.set("Unknown")):(await a.K_.stop(),ik(a))})),a.K_}function Xs(a){return a.U_||(a.U_=function(n,r,s){const o=ke(n);return o.w_(),new IL(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(a.datastore,a.asyncQueue,{Eo:()=>Promise.resolve(),Ro:jL.bind(null,a),mo:UL.bind(null,a),f_:FL.bind(null,a),g_:zL.bind(null,a)}),a.B_.push(async e=>{e?(a.U_.s_(),await Ql(a)):(await a.U_.stop(),a.O_.length>0&&(Ee("RemoteStore",`Stopping write stream with ${a.O_.length} pending writes`),a.O_=[]))})),a.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{constructor(e,n,r,s,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=o,this.deferred=new Da,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,o){const i=Date.now()+r,l=new Ib(e,n,i,s,o);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new xe(ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Yl(a,e){if(fa("AsyncQueue",`${e}: ${a}`),io(a))return new xe(ae.UNAVAILABLE,`${e}: ${a}`);throw a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Ae.comparator(n.key,r.key):(n,r)=>Ae.comparator(n.key,r.key),this.keyedMap=Bc(),this.sortedSet=new qt(this.comparator)}static emptySet(e){return new ll(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ll)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,o=r.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ll;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uN{constructor(){this.W_=new qt(Ae.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):Le():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Rl{constructor(e,n,r,s,o,i,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=o,this.fromCache=i,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,o){const i=[];return n.forEach(l=>{i.push({type:0,doc:l})}),new Rl(e,n,ll.emptySet(n),i,r,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ad(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $L{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class BL{constructor(){this.queries=dN(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ke(n),o=s.queries;s.queries=dN(),o.forEach((i,l)=>{for(const c of l.j_)c.onError(r)})})(this,new xe(ae.ABORTED,"Firestore shutting down"))}}function dN(){return new ss(a=>sS(a),ad)}async function Ab(a,e){const n=ke(a);let r=3;const s=e.query;let o=n.queries.get(s);o?!o.H_()&&e.J_()&&(r=2):(o=new $L,r=e.J_()?0:1);try{switch(r){case 0:o.z_=await n.onListen(s,!0);break;case 1:o.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(i){const l=Yl(i,`Initialization of query '${Oi(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,o),o.j_.push(e),e.Z_(n.onlineState),o.z_&&e.X_(o.z_)&&Pb(n)}async function Tb(a,e){const n=ke(a),r=e.query;let s=3;const o=n.queries.get(r);if(o){const i=o.j_.indexOf(e);i>=0&&(o.j_.splice(i,1),o.j_.length===0?s=e.J_()?0:1:!o.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function qL(a,e){const n=ke(a);let r=!1;for(const s of e){const o=s.query,i=n.queries.get(o);if(i){for(const l of i.j_)l.X_(s)&&(r=!0);i.z_=s}}r&&Pb(n)}function WL(a,e,n){const r=ke(a),s=r.queries.get(e);if(s)for(const o of s.j_)o.onError(n);r.queries.delete(e)}function Pb(a){a.Y_.forEach(e=>{e.next()})}var V0,mN;(mN=V0||(V0={})).ea="default",mN.Cache="cache";class Rb{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Rl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Rl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==V0.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GL{constructor(e,n){this.aa=e,this.byteLength=n}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pN{constructor(e){this.serializer=e}Es(e){return wr(this.serializer,e)}ds(e){return e.metadata.exists?TS(this.serializer,e.document,!1):Gt.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return ha(e)}}class HL{constructor(e,n,r){this.ca=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=dk(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++n;const r=Nt.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ha(e){const n=new Map,r=new pN(this.serializer);for(const s of e)if(s.metadata.queries){const o=r.Es(s.metadata.name);for(const i of s.metadata.queries){const l=(n.get(i)||ct()).add(o);n.set(i,l)}}return n}async complete(){const e=await yL(this.localStore,new pN(this.serializer),this.documents,this.ca.id),n=this.ha(this.documents);for(const r of this.queries)await NL(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function dk(a){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:a.totalDocuments,totalBytes:a.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(e){this.key=e}}class pk{constructor(e){this.key=e}}class gk{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ct(),this.mutatedKeys=ct(),this.Aa=iS(e),this.Ra=new ll(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new uN,s=n?n.Ra:this.Ra;let o=n?n.mutatedKeys:this.mutatedKeys,i=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,m)=>{const h=s.get(d),C=nd(this.query,m)?m:null,S=!!h&&this.mutatedKeys.has(h.key),w=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let f=!1;h&&C?h.data.isEqual(C.data)?S!==w&&(r.track({type:3,doc:C}),f=!0):this.ga(h,C)||(r.track({type:2,doc:C}),f=!0,(c&&this.Aa(C,c)>0||u&&this.Aa(C,u)<0)&&(l=!0)):!h&&C?(r.track({type:0,doc:C}),f=!0):h&&!C&&(r.track({type:1,doc:h}),f=!0,(c||u)&&(l=!0)),f&&(C?(i=i.add(C),o=w?o.add(d):o.delete(d)):(i=i.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const d=this.query.limitType==="F"?i.last():i.first();i=i.delete(d.key),o=o.delete(d.key),r.track({type:1,doc:d})}return{Ra:i,fa:r,ns:l,mutatedKeys:o}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const i=e.fa.G_();i.sort((d,m)=>function(C,S){const w=f=>{switch(f){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le()}};return w(C)-w(S)}(d.type,m.type)||this.Aa(d.doc,m.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,u=c!==this.Ea;return this.Ea=c,i.length!==0||u?{snapshot:new Rl(this.query,e.Ra,o,i,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new uN,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ct(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new pk(r))}),this.da.forEach(r=>{e.has(r)||n.push(new mk(r))}),n}ba(e){this.Ta=e.Ts,this.da=ct();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Rl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class KL{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class QL{constructor(e){this.key=e,this.va=!1}}class JL{constructor(e,n,r,s,o,i){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=i,this.Ca={},this.Fa=new ss(l=>sS(l),ad),this.Ma=new Map,this.xa=new Set,this.Oa=new qt(Ae.comparator),this.Na=new Map,this.La=new bb,this.Ba={},this.ka=new Map,this.qa=ai.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function YL(a,e,n=!0){const r=Pg(a);let s;const o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.Da()):s=await fk(r,e,n,!0),s}async function ZL(a,e){const n=Pg(a);await fk(n,e,!0,!1)}async function fk(a,e,n,r){const s=await Al(a.localStore,Ya(e)),o=s.targetId,i=a.sharedClientState.addLocalQueryTarget(o,n);let l;return r&&(l=await Db(a,e,o,i==="current",s.resumeToken)),a.isPrimaryClient&&n&&Tg(a.remoteStore,s),l}async function Db(a,e,n,r,s){a.Ka=(m,h,C)=>async function(w,f,b,v){let I=f.view.ma(b);I.ns&&(I=await Pp(w.localStore,f.query,!1).then(({documents:y})=>f.view.ma(y,I)));const A=v&&v.targetChanges.get(f.targetId),N=v&&v.targetMismatches.get(f.targetId)!=null,x=f.view.applyChanges(I,w.isPrimaryClient,A,N);return O0(w,f.targetId,x.wa),x.snapshot}(a,m,h,C);const o=await Pp(a.localStore,e,!0),i=new gk(e,o.Ts),l=i.ma(o.documents),c=od.createSynthesizedTargetChangeForCurrentChange(n,r&&a.onlineState!=="Offline",s),u=i.applyChanges(l,a.isPrimaryClient,c);O0(a,n,u.wa);const d=new KL(e,n,i);return a.Fa.set(e,d),a.Ma.has(n)?a.Ma.get(n).push(e):a.Ma.set(n,[e]),u.snapshot}async function XL(a,e,n){const r=ke(a),s=r.Fa.get(e),o=r.Ma.get(s.targetId);if(o.length>1)return r.Ma.set(s.targetId,o.filter(i=>!ad(i,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Tl(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Pl(r.remoteStore,s.targetId),Dl(r,s.targetId)}).catch(oo)):(Dl(r,s.targetId),await Tl(r.localStore,s.targetId,!0))}async function e3(a,e){const n=ke(a),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Pl(n.remoteStore,r.targetId))}async function t3(a,e,n){const r=Ob(a);try{const s=await function(i,l){const c=ke(i),u=Kt.now(),d=l.reduce((C,S)=>C.add(S.key),ct());let m,h;return c.persistence.runTransaction("Locally write mutations","readwrite",C=>{let S=gn(),w=ct();return c.cs.getEntries(C,d).next(f=>{S=f,S.forEach((b,v)=>{v.isValidDocument()||(w=w.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(C,S)).next(f=>{m=f;const b=[];for(const v of l){const I=kD(v,m.get(v.key).overlayedDocument);I!=null&&b.push(new os(v.key,I,KC(I.value.mapValue),Zt.exists(!0)))}return c.mutationQueue.addMutationBatch(C,u,b,l)}).next(f=>{h=f;const b=f.applyToLocalDocumentSet(m,w);return c.documentOverlayCache.saveOverlays(C,f.batchId,b)})}).then(()=>({batchId:h.batchId,changes:cS(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,l,c){let u=i.Ba[i.currentUser.toKey()];u||(u=new qt(rt)),u=u.insert(l,c),i.Ba[i.currentUser.toKey()]=u}(r,s.batchId,n),await is(r,s.changes),await Ql(r.remoteStore)}catch(s){const o=Yl(s,"Failed to persist write");n.reject(o)}}async function hk(a,e){const n=ke(a);try{const r=await EL(n.localStore,e);e.targetChanges.forEach((s,o)=>{const i=n.Na.get(o);i&&(Fe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?i.va=!0:s.modifiedDocuments.size>0?Fe(i.va):s.removedDocuments.size>0&&(Fe(i.va),i.va=!1))}),await is(n,r,e)}catch(r){await oo(r)}}function gN(a,e,n){const r=ke(a);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((o,i)=>{const l=i.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(i,l){const c=ke(i);c.onlineState=l;let u=!1;c.queries.forEach((d,m)=>{for(const h of m.j_)h.Z_(l)&&(u=!0)}),u&&Pb(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function a3(a,e,n){const r=ke(a);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),o=s&&s.key;if(o){let i=new qt(Ae.comparator);i=i.insert(o,Gt.newNoDocument(o,Be.min()));const l=ct().add(o),c=new sd(Be.min(),new Map,new qt(rt),i,l);await hk(r,c),r.Oa=r.Oa.remove(o),r.Na.delete(e),Vb(r)}else await Tl(r.localStore,e,!1).then(()=>Dl(r,e,n)).catch(oo)}async function n3(a,e){const n=ke(a),r=e.batch.batchId;try{const s=await bL(n.localStore,e);Mb(n,r,null),Lb(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await is(n,s)}catch(s){await oo(s)}}async function r3(a,e,n){const r=ke(a);try{const s=await function(i,l){const c=ke(i);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(m=>(Fe(m!==null),d=m.keys(),c.mutationQueue.removeMutationBatch(u,m))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);Mb(r,e,n),Lb(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await is(r,s)}catch(s){await oo(s)}}async function s3(a,e){const n=ke(a);co(n.remoteStore)||Ee("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(i){const l=ke(i);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>l.mutationQueue.getHighestUnacknowledgedBatchId(c))}(n.localStore);if(r===-1)return void e.resolve();const s=n.ka.get(r)||[];s.push(e),n.ka.set(r,s)}catch(r){const s=Yl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function Lb(a,e){(a.ka.get(e)||[]).forEach(n=>{n.resolve()}),a.ka.delete(e)}function Mb(a,e,n){const r=ke(a);let s=r.Ba[r.currentUser.toKey()];if(s){const o=s.get(e);o&&(n?o.reject(n):o.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Dl(a,e,n=null){a.sharedClientState.removeLocalQueryTarget(e);for(const r of a.Ma.get(e))a.Fa.delete(r),n&&a.Ca.$a(r,n);a.Ma.delete(e),a.isPrimaryClient&&a.La.gr(e).forEach(r=>{a.La.containsKey(r)||vk(a,r)})}function vk(a,e){a.xa.delete(e.path.canonicalString());const n=a.Oa.get(e);n!==null&&(Pl(a.remoteStore,n),a.Oa=a.Oa.remove(e),a.Na.delete(n),Vb(a))}function O0(a,e,n){for(const r of n)r instanceof mk?(a.La.addReference(r.key,e),o3(a,r)):r instanceof pk?(Ee("SyncEngine","Document no longer in limbo: "+r.key),a.La.removeReference(r.key,e),a.La.containsKey(r.key)||vk(a,r.key)):Le()}function o3(a,e){const n=e.key,r=n.path.canonicalString();a.Oa.get(n)||a.xa.has(r)||(Ee("SyncEngine","New document in limbo: "+n),a.xa.add(r),Vb(a))}function Vb(a){for(;a.xa.size>0&&a.Oa.size<a.maxConcurrentLimboResolutions;){const e=a.xa.values().next().value;a.xa.delete(e);const n=new Ae(Nt.fromString(e)),r=a.qa.next();a.Na.set(r,new QL(n)),a.Oa=a.Oa.insert(n,r),Tg(a.remoteStore,new Fr(Ya(Wl(n.path)),r,"TargetPurposeLimboResolution",mn.oe))}}async function is(a,e,n){const r=ke(a),s=[],o=[],i=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{i.push(r.Ka(c,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const m=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(u){s.push(u);const m=Nb.Wi(c.targetId,u);o.push(m)}}))}),await Promise.all(i),r.Ca.d_(s),await async function(c,u){const d=ke(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>Z.forEach(u,h=>Z.forEach(h.$i,C=>d.persistence.referenceDelegate.addReference(m,h.targetId,C)).next(()=>Z.forEach(h.Ui,C=>d.persistence.referenceDelegate.removeReference(m,h.targetId,C)))))}catch(m){if(!io(m))throw m;Ee("LocalStore","Failed to update sequence numbers: "+m)}for(const m of u){const h=m.targetId;if(!m.fromCache){const C=d.os.get(h),S=C.snapshotVersion,w=C.withLastLimboFreeSnapshotVersion(S);d.os=d.os.insert(h,w)}}}(r.localStore,o))}async function i3(a,e){const n=ke(a);if(!n.currentUser.isEqual(e)){Ee("SyncEngine","User change. New user:",e.toKey());const r=await YS(n.localStore,e);n.currentUser=e,function(o,i){o.ka.forEach(l=>{l.forEach(c=>{c.reject(new xe(ae.CANCELLED,i))})}),o.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await is(n,r.hs)}}function l3(a,e){const n=ke(a),r=n.Na.get(e);if(r&&r.va)return ct().add(r.key);{let s=ct();const o=n.Ma.get(e);if(!o)return s;for(const i of o){const l=n.Fa.get(i);s=s.unionWith(l.view.Va)}return s}}async function c3(a,e){const n=ke(a),r=await Pp(n.localStore,e.query,!0),s=e.view.ba(r);return n.isPrimaryClient&&O0(n,e.targetId,s.wa),s}async function u3(a,e){const n=ke(a);return tk(n.localStore,e).then(r=>is(n,r))}async function d3(a,e,n,r){const s=ke(a),o=await function(l,c){const u=ke(l),d=ke(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",m=>d.Mn(m,c).next(h=>h?u.localDocuments.getDocuments(m,h):Z.resolve(null)))}(s.localStore,e);o!==null?(n==="pending"?await Ql(s.remoteStore):n==="acknowledged"||n==="rejected"?(Mb(s,e,r||null),Lb(s,e),function(l,c){ke(ke(l).mutationQueue).On(c)}(s.localStore,e)):Le(),await is(s,o)):Ee("SyncEngine","Cannot apply mutation batch with id: "+e)}async function m3(a,e){const n=ke(a);if(Pg(n),Ob(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await fN(n,r.toArray());n.Qa=!0,await M0(n.remoteStore,!0);for(const o of s)Tg(n.remoteStore,o)}else if(e===!1&&n.Qa!==!1){const r=[];let s=Promise.resolve();n.Ma.forEach((o,i)=>{n.sharedClientState.isLocalQueryTarget(i)?r.push(i):s=s.then(()=>(Dl(n,i),Tl(n.localStore,i,!0))),Pl(n.remoteStore,i)}),await s,await fN(n,r),function(i){const l=ke(i);l.Na.forEach((c,u)=>{Pl(l.remoteStore,u)}),l.La.pr(),l.Na=new Map,l.Oa=new qt(Ae.comparator)}(n),n.Qa=!1,await M0(n.remoteStore,!1)}}async function fN(a,e,n){const r=ke(a),s=[],o=[];for(const i of e){let l;const c=r.Ma.get(i);if(c&&c.length!==0){l=await Al(r.localStore,Ya(c[0]));for(const u of c){const d=r.Fa.get(u),m=await c3(r,d);m.snapshot&&o.push(m.snapshot)}}else{const u=await ek(r.localStore,i);l=await Al(r.localStore,u),await Db(r,bk(u),i,!1,l.resumeToken)}s.push(l)}return r.Ca.d_(o),s}function bk(a){return aS(a.path,a.collectionGroup,a.orderBy,a.filters,a.limit,"F",a.startAt,a.endAt)}function p3(a){return function(n){return ke(ke(n).persistence).Qi()}(ke(a).localStore)}async function g3(a,e,n,r){const s=ke(a);if(s.Qa)return void Ee("SyncEngine","Ignoring unexpected query state notification.");const o=s.Ma.get(e);if(o&&o.length>0)switch(n){case"current":case"not-current":{const i=await tk(s.localStore,oS(o[0])),l=sd.createSynthesizedRemoteEventForCurrentChange(e,n==="current",da.EMPTY_BYTE_STRING);await is(s,i,l);break}case"rejected":await Tl(s.localStore,e,!0),Dl(s,e,r);break;default:Le()}}async function f3(a,e,n){const r=Pg(a);if(r.Qa){for(const s of e){if(r.Ma.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){Ee("SyncEngine","Adding an already active target "+s);continue}const o=await ek(r.localStore,s),i=await Al(r.localStore,o);await Db(r,bk(o),i.targetId,!1,i.resumeToken),Tg(r.remoteStore,i)}for(const s of n)r.Ma.has(s)&&await Tl(r.localStore,s,!1).then(()=>{Pl(r.remoteStore,s),Dl(r,s)}).catch(oo)}}function Pg(a){const e=ke(a);return e.remoteStore.remoteSyncer.applyRemoteEvent=hk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=l3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=a3.bind(null,e),e.Ca.d_=qL.bind(null,e.eventManager),e.Ca.$a=WL.bind(null,e.eventManager),e}function Ob(a){const e=ke(a);return e.remoteStore.remoteSyncer.applySuccessfulWrite=n3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=r3.bind(null,e),e}function h3(a,e,n){const r=ke(a);(async function(o,i,l){try{const c=await i.getMetadata();if(await function(C,S){const w=ke(C),f=ha(S.createTime);return w.persistence.runTransaction("hasNewerBundle","readonly",b=>w.Gr.getBundleMetadata(b,S.id)).then(b=>!!b&&b.createTime.compareTo(f)>=0)}(o.localStore,c))return await i.close(),l._completeWith(function(C){return{taskState:"Success",documentsLoaded:C.totalDocuments,bytesLoaded:C.totalBytes,totalDocuments:C.totalDocuments,totalBytes:C.totalBytes}}(c)),Promise.resolve(new Set);l._updateProgress(dk(c));const u=new HL(c,o.localStore,i.serializer);let d=await i.Ua();for(;d;){const h=await u.la(d);h&&l._updateProgress(h),d=await i.Ua()}const m=await u.complete();return await is(o,m.Ia,void 0),await function(C,S){const w=ke(C);return w.persistence.runTransaction("Save bundle","readwrite",f=>w.Gr.saveBundleMetadata(f,S))}(o.localStore,c),l._completeWith(m.progress),Promise.resolve(m.Pa)}catch(c){return Fn("SyncEngine",`Loading bundle failed with ${c}`),l._failWith(c),Promise.resolve(new Set)}})(r,e,n).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class eo{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=id(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return JS(this.persistence,new QS,e.initialUser,this.serializer)}Ga(e){return new Eb(Ag.Zr,this.serializer)}Wa(e){return new nk}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}eo.provider={build:()=>new eo};class v3 extends eo{constructor(e){super(),this.cacheSizeBytes=e}ja(e,n){Fe(this.persistence.referenceDelegate instanceof Tp);const r=this.persistence.referenceDelegate.garbageCollector;return new qS(r,e.asyncQueue,n)}Ga(e){const n=this.cacheSizeBytes!==void 0?Ka.withCacheSize(this.cacheSizeBytes):Ka.DEFAULT;return new Eb(r=>Tp.Zr(r,n),this.serializer)}}class jb extends eo{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Ob(this.Ja.syncEngine),await Ql(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return JS(this.persistence,new QS,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new qS(r,e.asyncQueue,n)}Ha(e,n){const r=new F6(n,this.persistence);return new j6(e.asyncQueue,r)}Ga(e){const n=yb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Ka.withCacheSize(this.cacheSizeBytes):Ka.DEFAULT;return new xb(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,rk(),$m(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new nk}}class Ek extends jb{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof Hf&&(this.sharedClientState.syncEngine={no:d3.bind(null,n),ro:g3.bind(null,n),io:f3.bind(null,n),Qi:p3.bind(null,n),eo:u3.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await m3(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=rk();if(!Hf.D(n))throw new xe(ae.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=yb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Hf(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class to{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>gN(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=i3.bind(null,this.syncEngine),await M0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new BL}()}createDatastore(e){const n=id(e.databaseInfo.databaseId),r=function(o){return new SL(o)}(e.databaseInfo);return function(o,i,l,c){return new AL(o,i,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,o,i,l){return new PL(r,s,o,i,l)}(this.localStore,this.datastore,e.asyncQueue,n=>gN(this.syncEngine,n,0),function(){return lN.D()?new lN:new wL}())}createSyncEngine(e,n){return function(s,o,i,l,c,u,d){const m=new JL(s,o,i,l,c,u);return d&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const o=ke(s);Ee("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await Kl(o),o.k_.shutdown(),o.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}to.provider={build:()=>new to};function hN(a,e=10240){let n=0;return{async read(){if(n<a.byteLength){const r={value:a.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):fa("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b3{constructor(e,n){this.Xa=e,this.serializer=n,this.metadata=new Da,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const n=this.eu.decode(e),r=Number(n);isNaN(r)&&this.ru(`length string (${n}) is not valid number`);const s=await this.iu(r);return new GL(JSON.parse(s),e.length+r)}su(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const n=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E3{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new xe(ae.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,o){const i=ke(s),l={documents:o.map(m=>Mu(i.serializer,m))},c=await i.Lo("BatchGetDocuments",i.serializer.databaseId,Nt.emptyPath(),l,o.length),u=new Map;c.forEach(m=>{const h=VD(i.serializer,m);u.set(h.key.toString(),h)});const d=[];return o.forEach(m=>{const h=u.get(m.toString());Fe(!!h),d.push(h)}),d}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Hl(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=Ae.fromPath(r);this.mutations.push(new cb(s,this.precondition(s)))}),await async function(r,s){const o=ke(r),i={writes:s.map(l=>Vu(o.serializer,l))};await o.Mo("Commit",o.serializer.databaseId,Nt.emptyPath(),i)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Le();n=Be.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new xe(ae.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(Be.min())?Zt.exists(!1):Zt.updateTime(n):Zt.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(Be.min()))throw new xe(ae.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Zt.updateTime(n)}return Zt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x3{constructor(e,n,r,s,o){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=o,this._u=r.maxAttempts,this.t_=new _b(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new E3(this.datastore),n=this.cu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.lu(s)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const n=this.updateFunction(e);return!ed(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!xS(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y3{constructor(e,n,r,s,o){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Pa.UNAUTHENTICATED,this.clientId=PC.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async i=>{Ee("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(Ee("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Da;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Yl(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Qf(a,e){a.asyncQueue.verifyOperationInProgress(),Ee("FirestoreClient","Initializing OfflineComponentProvider");const n=a.configuration;await e.initialize(n);let r=n.initialUser;a.setCredentialChangeListener(async s=>{r.isEqual(s)||(await YS(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>a.terminate()),a._offlineComponents=e}async function vN(a,e){a.asyncQueue.verifyOperationInProgress();const n=await Fb(a);Ee("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,a.configuration),a.setCredentialChangeListener(r=>cN(e.remoteStore,r)),a.setAppCheckTokenChangeListener((r,s)=>cN(e.remoteStore,s)),a._onlineComponents=e}async function Fb(a){if(!a._offlineComponents)if(a._uninitializedComponentsProvider){Ee("FirestoreClient","Using user provided OfflineComponentProvider");try{await Qf(a,a._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===ae.FAILED_PRECONDITION||s.code===ae.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Fn("Error using user provided cache. Falling back to memory cache: "+n),await Qf(a,new eo)}}else Ee("FirestoreClient","Using default OfflineComponentProvider"),await Qf(a,new eo);return a._offlineComponents}async function Dg(a){return a._onlineComponents||(a._uninitializedComponentsProvider?(Ee("FirestoreClient","Using user provided OnlineComponentProvider"),await vN(a,a._uninitializedComponentsProvider._online)):(Ee("FirestoreClient","Using default OnlineComponentProvider"),await vN(a,new to))),a._onlineComponents}function xk(a){return Fb(a).then(e=>e.persistence)}function Zl(a){return Fb(a).then(e=>e.localStore)}function yk(a){return Dg(a).then(e=>e.remoteStore)}function zb(a){return Dg(a).then(e=>e.syncEngine)}function Nk(a){return Dg(a).then(e=>e.datastore)}async function Ll(a){const e=await Dg(a),n=e.eventManager;return n.onListen=YL.bind(null,e.syncEngine),n.onUnlisten=XL.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=ZL.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=e3.bind(null,e.syncEngine),n}function N3(a){return a.asyncQueue.enqueue(async()=>{const e=await xk(a),n=await yk(a);return e.setNetworkEnabled(!0),function(s){const o=ke(s);return o.L_.delete(0),ld(o)}(n)})}function w3(a){return a.asyncQueue.enqueue(async()=>{const e=await xk(a),n=await yk(a);return e.setNetworkEnabled(!1),async function(s){const o=ke(s);o.L_.add(0),await Kl(o),o.q_.set("Offline")}(n)})}function _3(a,e){const n=new Da;return a.asyncQueue.enqueueAndForget(async()=>async function(s,o,i){try{const l=await function(u,d){const m=ke(u);return m.persistence.runTransaction("read document","readonly",h=>m.localDocuments.getDocument(h,d))}(s,o);l.isFoundDocument()?i.resolve(l):l.isNoDocument()?i.resolve(null):i.reject(new xe(ae.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const c=Yl(l,`Failed to get document '${o} from cache`);i.reject(c)}}(await Zl(a),e,n)),n.promise}function wk(a,e,n={}){const r=new Da;return a.asyncQueue.enqueueAndForget(async()=>function(o,i,l,c,u){const d=new Rg({next:h=>{d.Za(),i.enqueueAndForget(()=>Tb(o,m));const C=h.docs.has(l);!C&&h.fromCache?u.reject(new xe(ae.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&h.fromCache&&c&&c.source==="server"?u.reject(new xe(ae.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(h)},error:h=>u.reject(h)}),m=new Rb(Wl(l.path),d,{includeMetadataChanges:!0,_a:!0});return Ab(o,m)}(await Ll(a),a.asyncQueue,e,n,r)),r.promise}function C3(a,e){const n=new Da;return a.asyncQueue.enqueueAndForget(async()=>async function(s,o,i){try{const l=await Pp(s,o,!0),c=new gk(o,l.Ts),u=c.ma(l.documents),d=c.applyChanges(u,!1);i.resolve(d.snapshot)}catch(l){const c=Yl(l,`Failed to execute query '${o} against cache`);i.reject(c)}}(await Zl(a),e,n)),n.promise}function _k(a,e,n={}){const r=new Da;return a.asyncQueue.enqueueAndForget(async()=>function(o,i,l,c,u){const d=new Rg({next:h=>{d.Za(),i.enqueueAndForget(()=>Tb(o,m)),h.fromCache&&c.source==="server"?u.reject(new xe(ae.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(h)},error:h=>u.reject(h)}),m=new Rb(l,d,{includeMetadataChanges:!0,_a:!0});return Ab(o,m)}(await Ll(a),a.asyncQueue,e,n,r)),r.promise}function S3(a,e,n){const r=new Da;return a.asyncQueue.enqueueAndForget(async()=>{try{const s=await Nk(a);r.resolve(async function(i,l,c){var u;const d=ke(i),{request:m,ut:h,parent:C}=RS(d.serializer,nS(l),c);d.connection.Fo||delete m.parent;const S=(await d.Lo("RunAggregationQuery",d.serializer.databaseId,C,m,1)).filter(f=>!!f.result);Fe(S.length===1);const w=(u=S[0].result)===null||u===void 0?void 0:u.aggregateFields;return Object.keys(w).reduce((f,b)=>(f[h[b]]=w[b],f),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}function k3(a,e){const n=new Rg(e);return a.asyncQueue.enqueueAndForget(async()=>function(s,o){ke(s).Y_.add(o),o.next()}(await Ll(a),n)),()=>{n.Za(),a.asyncQueue.enqueueAndForget(async()=>function(s,o){ke(s).Y_.delete(o)}(await Ll(a),n))}}function I3(a,e,n,r){const s=function(i,l){let c;return c=typeof i=="string"?NS().encode(i):i,function(d,m){return new b3(d,m)}(function(d,m){if(d instanceof Uint8Array)return hN(d,m);if(d instanceof ArrayBuffer)return hN(new Uint8Array(d),m);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),l)}(n,id(e));a.asyncQueue.enqueueAndForget(async()=>{h3(await zb(a),s,r)})}function A3(a,e){return a.asyncQueue.enqueue(async()=>function(r,s){const o=ke(r);return o.persistence.runTransaction("Get named query","readonly",i=>o.Gr.getNamedQuery(i,s))}(await Zl(a),e))}function T3(a,e){return a.asyncQueue.enqueue(async()=>async function(r,s){const o=ke(r),i=o.indexManager,l=[];return o.persistence.runTransaction("Configure indexes","readwrite",c=>i.getFieldIndexes(c).next(u=>function(m,h,C,S,w){m=[...m],h=[...h],m.sort(C),h.sort(C);const f=m.length,b=h.length;let v=0,I=0;for(;v<b&&I<f;){const A=C(m[I],h[v]);A<0?w(m[I++]):A>0?S(h[v++]):(v++,I++)}for(;v<b;)S(h[v++]);for(;I<f;)w(m[I++])}(u,s,L6,d=>{l.push(i.addFieldIndex(c,d))},d=>{l.push(i.deleteFieldIndex(c,d))})).next(()=>Z.waitFor(l)))}(await Zl(a),e))}function P3(a,e){return a.asyncQueue.enqueue(async()=>function(r,s){ke(r).ss.zi=s}(await Zl(a),e))}function R3(a){return a.asyncQueue.enqueue(async()=>function(n){const r=ke(n),s=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",o=>s.deleteAllFieldIndexes(o))}(await Zl(a)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ck(a){const e={};return a.timeoutSeconds!==void 0&&(e.timeoutSeconds=a.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bN=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ub(a,e,n){if(!n)throw new xe(ae.INVALID_ARGUMENT,`Function ${a}() cannot be called with an empty ${e}.`)}function D3(a,e,n,r){if(e===!0&&r===!0)throw new xe(ae.INVALID_ARGUMENT,`${a} and ${n} cannot be used together.`)}function EN(a){if(!Ae.isDocumentKey(a))throw new xe(ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${a} has ${a.length}.`)}function xN(a){if(Ae.isDocumentKey(a))throw new xe(ae.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${a} has ${a.length}.`)}function Lg(a){if(a===void 0)return"undefined";if(a===null)return"null";if(typeof a=="string")return a.length>20&&(a=`${a.substring(0,20)}...`),JSON.stringify(a);if(typeof a=="number"||typeof a=="boolean")return""+a;if(typeof a=="object"){if(a instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(a);return e?`a custom ${e} object`:"an object"}}return typeof a=="function"?"a function":Le()}function bt(a,e){if("_delegate"in a&&(a=a._delegate),!(a instanceof e)){if(e.name===a.constructor.name)throw new xe(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Lg(a);throw new xe(ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return a}function Sk(a,e){if(e<=0)throw new xe(ae.INVALID_ARGUMENT,`Function ${a}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new xe(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new xe(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}D3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ck((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new xe(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new xe(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new xe(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class cd{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yN({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new xe(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new xe(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yN(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new S6;switch(r.type){case"firstParty":return new T6(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new xe(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=bN.get(n);r&&(Ee("ComponentProvider","Removing Datastore"),bN.delete(n),r.terminate())}(this),Promise.resolve()}}function L3(a,e,n,r={}){var s;const o=(a=bt(a,cd))._getSettings(),i=`${e}:${n}`;if(o.host!=="firestore.googleapis.com"&&o.host!==i&&Fn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),a._setSettings(Object.assign(Object.assign({},o),{host:i,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=Pa.MOCK_USER;else{l=fC(r.mockUserToken,(s=a._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new xe(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Pa(u)}a._authCredentials=new k6(new AC(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new $a(this.firestore,e,this._query)}}class va{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _r(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new va(this.firestore,e,this._key)}}class _r extends $a{constructor(e,n,r){super(e,n,Wl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new va(this.firestore,null,new Ae(e))}withConverter(e){return new _r(this.firestore,e,this._path)}}function W(a,e,...n){if(a=gt(a),Ub("collection","path",e),a instanceof cd){const r=Nt.fromString(e,...n);return xN(r),new _r(a,null,r)}{if(!(a instanceof va||a instanceof _r))throw new xe(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=a._path.child(Nt.fromString(e,...n));return xN(r),new _r(a.firestore,null,r)}}function cB(a,e){if(a=bt(a,cd),Ub("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new xe(ae.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new $a(a,null,function(r){return new rs(Nt.emptyPath(),r)}(e))}function Ne(a,e,...n){if(a=gt(a),arguments.length===1&&(e=PC.newId()),Ub("doc","path",e),a instanceof cd){const r=Nt.fromString(e,...n);return EN(r),new va(a,null,new Ae(r))}{if(!(a instanceof va||a instanceof _r))throw new xe(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=a._path.child(Nt.fromString(e,...n));return EN(r),new va(a.firestore,a instanceof _r?a.converter:null,new Ae(r))}}function uB(a,e){return a=gt(a),e=gt(e),(a instanceof va||a instanceof _r)&&(e instanceof va||e instanceof _r)&&a.firestore===e.firestore&&a.path===e.path&&a.converter===e.converter}function kk(a,e){return a=gt(a),e=gt(e),a instanceof $a&&e instanceof $a&&a.firestore===e.firestore&&ad(a._query,e._query)&&a.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new _b(this,"async_queue_retry"),this.Vu=()=>{const r=$m();r&&Ee("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=$m();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=$m();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Da;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!io(e))throw e;Ee("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(i){let l=i.message||"";return i.stack&&(l=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),l}(r);throw fa("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Ib.createAndSchedule(this,e,n,r,o=>this.yu(o));return this.Tu.push(s),s}fu(){this.Eu&&Le()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function j0(a){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const o of r)if(o in s&&typeof s[o]=="function")return!0;return!1}(a,["next","error","complete"])}class M3{constructor(){this._progressObserver={},this._taskCompletionResolver=new Da,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dB=-1;class Ut extends cd{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new NN,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new NN(e),this._firestoreClient=void 0,await e}}}function mB(a,e,n){n||(n="(default)");const r=ns(a,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),o=r.getOptions(n);if(Ks(o,e))return s;throw new xe(ae.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new xe(ae.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new xe(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function V3(a,e){const n=typeof a=="object"?a:Eg(),r=typeof a=="string"?a:e||"(default)",s=ns(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const o=mC("firestore");o&&L3(s,...o)}return s}function la(a){if(a._terminated)throw new xe(ae.FAILED_PRECONDITION,"The client has already been terminated.");return a._firestoreClient||Ik(a),a._firestoreClient}function Ik(a){var e,n,r;const s=a._freezeSettings(),o=function(l,c,u,d){return new oD(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Ck(d.experimentalLongPollingOptions),d.useFetchStreams)}(a._databaseId,((e=a._app)===null||e===void 0?void 0:e.options.appId)||"",a._persistenceKey,s);a._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(a._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),a._firestoreClient=new y3(a._authCredentials,a._appCheckCredentials,a._queue,o,a._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(a._componentsProvider))}function pB(a,e){Fn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=a._freezeSettings();return Ak(a,to.provider,{build:r=>new jb(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function gB(a){Fn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=a._freezeSettings();Ak(a,to.provider,{build:n=>new Ek(n,e.cacheSizeBytes)})}function Ak(a,e,n){if((a=bt(a,Ut))._firestoreClient||a._terminated)throw new xe(ae.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(a._componentsProvider||a._getSettings().localCache)throw new xe(ae.FAILED_PRECONDITION,"SDK cache is already specified.");a._componentsProvider={_online:e,_offline:n},Ik(a)}function fB(a){if(a._initialized&&!a._terminated)throw new xe(ae.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Da;return a._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Nr.D())return Promise.resolve();const s=r+"main";await Nr.delete(s)}(yb(a._databaseId,a._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function hB(a){return function(n){const r=new Da;return n.asyncQueue.enqueueAndForget(async()=>s3(await zb(n),r)),r.promise}(la(a=bt(a,Ut)))}function vB(a){return N3(la(a=bt(a,Ut)))}function bB(a){return w3(la(a=bt(a,Ut)))}function EB(a){return m6(a.app,"firestore",a._databaseId.database),a._delete()}function xB(a,e){const n=la(a=bt(a,Ut)),r=new M3;return I3(n,a._databaseId,e,r),r}function yB(a,e){return A3(la(a=bt(a,Ut)),e).then(n=>n?new $a(a,null,n.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class O3{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ni(da.fromBase64String(e))}catch(n){throw new xe(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ni(da.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new xe(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Yt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function NB(){return new hi("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new xe(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new xe(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return rt(this._lat,e._lat)||rt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==s[o])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j3=/^__.*__$/;class F3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new os(e,this.data,this.fieldMask,n,this.fieldTransforms):new Gl(e,this.data,n,this.fieldTransforms)}}class Tk{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new os(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Pk(a){switch(a){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le()}}class Vg{constructor(e,n,r,s,o,i){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Vg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Mp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Pk(this.Cu)&&j3.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class z3{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||id(e)}Qu(e,n,r,s=!1){return new Vg({Cu:e,methodName:n,qu:r,path:Yt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function bi(a){const e=a._freezeSettings(),n=id(a._databaseId);return new z3(a._databaseId,!!e.ignoreUndefinedProperties,n)}function Og(a,e,n,r,s,o={}){const i=a.Qu(o.merge||o.mergeFields?2:0,e,n,s);Qb("Data must be an object, but it was:",i,r);const l=Lk(r,i);let c,u;if(o.merge)c=new pn(i.fieldMask),u=i.fieldTransforms;else if(o.mergeFields){const d=[];for(const m of o.mergeFields){const h=ju(e,m,n);if(!i.contains(h))throw new xe(ae.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);Vk(d,h)||d.push(h)}c=new pn(d),u=i.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,u=i.fieldTransforms;return new F3(new ja(l),c,u)}class ud extends vi{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ud}}function Rk(a,e,n){return new Vg({Cu:3,qu:e.settings.qu,methodName:a._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Bb extends vi{_toFieldTransform(e){return new rd(e.path,new Sl)}isEqual(e){return e instanceof Bb}}class qb extends vi{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=Rk(this,e,!0),r=this.Ku.map(o=>Ei(o,n)),s=new Zo(r);return new rd(e.path,s)}isEqual(e){return e instanceof qb&&Ks(this.Ku,e.Ku)}}class Wb extends vi{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=Rk(this,e,!0),r=this.Ku.map(o=>Ei(o,n)),s=new Xo(r);return new rd(e.path,s)}isEqual(e){return e instanceof Wb&&Ks(this.Ku,e.Ku)}}class Gb extends vi{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new kl(e.serializer,mS(e.serializer,this.$u));return new rd(e.path,n)}isEqual(e){return e instanceof Gb&&this.$u===e.$u}}function Hb(a,e,n,r){const s=a.Qu(1,e,n);Qb("Data must be an object, but it was:",s,r);const o=[],i=ja.empty();lo(r,(c,u)=>{const d=jg(e,c,n);u=gt(u);const m=s.Nu(d);if(u instanceof ud)o.push(d);else{const h=Ei(u,m);h!=null&&(o.push(d),i.set(d,h))}});const l=new pn(o);return new Tk(i,l,s.fieldTransforms)}function Kb(a,e,n,r,s,o){const i=a.Qu(1,e,n),l=[ju(e,r,n)],c=[s];if(o.length%2!=0)throw new xe(ae.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<o.length;h+=2)l.push(ju(e,o[h])),c.push(o[h+1]);const u=[],d=ja.empty();for(let h=l.length-1;h>=0;--h)if(!Vk(u,l[h])){const C=l[h];let S=c[h];S=gt(S);const w=i.Nu(C);if(S instanceof ud)u.push(C);else{const f=Ei(S,w);f!=null&&(u.push(C),d.set(C,f))}}const m=new pn(u);return new Tk(d,m,i.fieldTransforms)}function Dk(a,e,n,r=!1){return Ei(n,a.Qu(r?4:3,e))}function Ei(a,e){if(Mk(a=gt(a)))return Qb("Unsupported field value:",e,a),Lk(a,e);if(a instanceof vi)return function(r,s){if(!Pk(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(s);o&&s.fieldTransforms.push(o)}(a,e),null;if(a===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),a instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const o=[];let i=0;for(const l of r){let c=Ei(l,s.Lu(i));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),i++}return{arrayValue:{values:o}}}(a,e)}return function(r,s){if((r=gt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return mS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=Kt.fromDate(r);return{timestampValue:Il(s.serializer,o)}}if(r instanceof Kt){const o=new Kt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Il(s.serializer,o)}}if(r instanceof $b)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ni)return{bytesValue:CS(s.serializer,r._byteString)};if(r instanceof va){const o=s.databaseId,i=r.firestore._databaseId;if(!i.isEqual(o))throw s.Bu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:gb(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Mg)return function(i,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:i.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return lb(l.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Lg(r)}`)}(a,e)}function Lk(a,e){const n={};return qC(a)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(a,(r,s)=>{const o=Ei(s,e.Mu(r));o!=null&&(n[r]=o)}),{mapValue:{fields:n}}}function Mk(a){return!(typeof a!="object"||a===null||a instanceof Array||a instanceof Date||a instanceof Kt||a instanceof $b||a instanceof ni||a instanceof va||a instanceof vi||a instanceof Mg)}function Qb(a,e,n){if(!Mk(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Lg(n);throw r==="an object"?e.Bu(a+" a custom object"):e.Bu(a+" "+r)}}function ju(a,e,n){if((e=gt(e))instanceof hi)return e._internalPath;if(typeof e=="string")return jg(a,e);throw Mp("Field path arguments must be of type string or ",a,!1,void 0,n)}const U3=new RegExp("[~\\*/\\[\\]]");function jg(a,e,n){if(e.search(U3)>=0)throw Mp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,a,!1,void 0,n);try{return new hi(...e.split("."))._internalPath}catch{throw Mp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,a,!1,void 0,n)}}function Mp(a,e,n,r,s){const o=r&&!r.isEmpty(),i=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(o||i)&&(c+=" (found",o&&(c+=` in field ${r}`),i&&(c+=` in document ${s}`),c+=")"),new xe(ae.INVALID_ARGUMENT,l+a+c)}function Vk(a,e){return a.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,n,r,s,o){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new va(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new $3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Fg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class $3 extends Fu{data(){return super.data()}}function Fg(a,e){return typeof e=="string"?jg(a,e):e instanceof hi?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ok(a){if(a.limitType==="L"&&a.explicitOrderBy.length===0)throw new xe(ae.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Jb{}class dd extends Jb{}function fe(a,e,...n){let r=[];e instanceof Jb&&r.push(e),r=r.concat(n),function(o){const i=o.filter(c=>c instanceof Xl).length,l=o.filter(c=>c instanceof md).length;if(i>1||i>0&&l>0)throw new xe(ae.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)a=s._apply(a);return a}class md extends dd{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new md(e,n,r)}_apply(e){const n=this._parse(e);return Fk(e._query,n),new $a(e.firestore,e.converter,S0(e._query,n))}_parse(e){const n=bi(e.firestore);return function(o,i,l,c,u,d,m){let h;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new xe(ae.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){_N(m,d);const C=[];for(const S of m)C.push(wN(c,o,S));h={arrayValue:{values:C}}}else h=wN(c,o,m)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||_N(m,d),h=Dk(l,i,m,d==="in"||d==="not-in");return wt.create(u,d,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function pe(a,e,n){const r=e,s=Fg("where",a);return md._create(s,r,n)}class Xl extends Jb{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Xl(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Lt.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,o){let i=s;const l=o.getFlattenedFilters();for(const c of l)Fk(i,c),i=S0(i,c)}(e._query,n),new $a(e.firestore,e.converter,S0(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function wB(...a){return a.forEach(e=>zk("or",e)),Xl._create("or",a)}function _B(...a){return a.forEach(e=>zk("and",e)),Xl._create("and",a)}class Yb extends dd{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Yb(e,n)}_apply(e){const n=function(s,o,i){if(s.startAt!==null)throw new xe(ae.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new xe(ae.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Lu(o,i)}(e._query,this._field,this._direction);return new $a(e.firestore,e.converter,function(s,o){const i=s.explicitOrderBy.concat([o]);return new rs(s.path,s.collectionGroup,i,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function st(a,e="asc"){const n=e,r=Fg("orderBy",a);return Yb._create(r,n)}class zg extends dd{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new zg(e,n,r)}_apply(e){return new $a(e.firestore,e.converter,Cp(e._query,this._limit,this._limitType))}}function Ot(a){return Sk("limit",a),zg._create("limit",a,"F")}function CB(a){return Sk("limitToLast",a),zg._create("limitToLast",a,"L")}class Ug extends dd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Ug(e,n,r)}_apply(e){const n=jk(e,this.type,this._docOrFields,this._inclusive);return new $a(e.firestore,e.converter,function(s,o){return new rs(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,o,s.endAt)}(e._query,n))}}function SB(...a){return Ug._create("startAt",a,!0)}function kB(...a){return Ug._create("startAfter",a,!1)}class $g extends dd{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new $g(e,n,r)}_apply(e){const n=jk(e,this.type,this._docOrFields,this._inclusive);return new $a(e.firestore,e.converter,function(s,o){return new rs(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,o)}(e._query,n))}}function IB(...a){return $g._create("endBefore",a,!1)}function AB(...a){return $g._create("endAt",a,!0)}function jk(a,e,n,r){if(n[0]=gt(n[0]),n[0]instanceof Fu)return function(o,i,l,c,u){if(!c)throw new xe(ae.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const d=[];for(const m of il(o))if(m.field.isKeyField())d.push(Jo(i,c.key));else{const h=c.data.field(m.field);if(yg(h))throw new xe(ae.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+m.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const C=m.field.canonicalString();throw new xe(ae.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${C}' (used as the orderBy) does not exist.`)}d.push(h)}return new Zs(d,u)}(a._query,a.firestore._databaseId,e,n[0]._document,r);{const s=bi(a.firestore);return function(i,l,c,u,d,m){const h=i.explicitOrderBy;if(d.length>h.length)throw new xe(ae.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const C=[];for(let S=0;S<d.length;S++){const w=d[S];if(h[S].field.isKeyField()){if(typeof w!="string")throw new xe(ae.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof w}`);if(!ob(i)&&w.indexOf("/")!==-1)throw new xe(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${w}' contains a slash.`);const f=i.path.child(Nt.fromString(w));if(!Ae.isDocumentKey(f))throw new xe(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${f}' is not because it contains an odd number of segments.`);const b=new Ae(f);C.push(Jo(l,b))}else{const f=Dk(c,u,w);C.push(f)}}return new Zs(C,m)}(a._query,a.firestore._databaseId,s,e,n,r)}}function wN(a,e,n){if(typeof(n=gt(n))=="string"){if(n==="")throw new xe(ae.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ob(e)&&n.indexOf("/")!==-1)throw new xe(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Nt.fromString(n));if(!Ae.isDocumentKey(r))throw new xe(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Jo(a,new Ae(r))}if(n instanceof va)return Jo(a,n._key);throw new xe(ae.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Lg(n)}.`)}function _N(a,e){if(!Array.isArray(a)||a.length===0)throw new xe(ae.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Fk(a,e){const n=function(s,o){for(const i of s)for(const l of i.getFlattenedFilters())if(o.indexOf(l.op)>=0)return l.op;return null}(a.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new xe(ae.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new xe(ae.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function zk(a,e){if(!(e instanceof md||e instanceof Xl))throw new xe(ae.INVALID_ARGUMENT,`Function ${a}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class Uk{convertValue(e,n="none"){switch(Js(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Zr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Le()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return lo(e,(s,o)=>{r[s]=this.convertValue(o,n)}),r}convertVectorValue(e){var n,r,s;const o=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(i=>Qt(i.doubleValue));return new Mg(o)}convertGeoPoint(e){return new $b(Qt(e.latitude),Qt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Ng(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Pu(e));default:return null}}convertTimestamp(e){const n=Yr(e);return new Kt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Nt.fromString(e);Fe(VS(r));const s=new Qo(r.get(1),r.get(3)),o=new Ae(r.popFirst(5));return s.isEqual(n)||fa(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bg(a,e,n){let r;return r=a?n&&(n.merge||n.mergeFields)?a.toFirestore(e,n):a.toFirestore(e):e,r}class B3 extends Uk{constructor(e){super(),this.firestore=e}convertBytes(e){return new ni(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new va(this.firestore,null,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TB(a){return new Ou("sum",ju("sum",a))}function PB(a){return new Ou("avg",ju("average",a))}function q3(){return new Ou("count")}function RB(a,e){var n,r;return a instanceof Ou&&e instanceof Ou&&a.aggregateType===e.aggregateType&&((n=a._internalFieldPath)===null||n===void 0?void 0:n.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function DB(a,e){return kk(a.query,e.query)&&Ks(a.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ml extends Fu{constructor(e,n,r,s,o,i){super(e,n,r,s,i),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Bm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Fg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Bm extends Ml{data(e={}){return super.data(e)}}class Vl{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Vo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Bm(this._firestore,this._userDataWriter,r.key,r,new Vo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new xe(ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,o){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(l=>{const c=new Bm(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Vo(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:i++}})}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>o||l.type!==3).map(l=>{const c=new Bm(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Vo(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=i.indexOf(l.doc.key),i=i.delete(l.doc.key)),l.type!==1&&(i=i.add(l.doc),d=i.indexOf(l.doc.key)),{type:W3(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function W3(a){switch(a){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le()}}function LB(a,e){return a instanceof Ml&&e instanceof Ml?a._firestore===e._firestore&&a._key.isEqual(e._key)&&(a._document===null?e._document===null:a._document.isEqual(e._document))&&a._converter===e._converter:a instanceof Vl&&e instanceof Vl&&a._firestore===e._firestore&&kk(a.query,e.query)&&a.metadata.isEqual(e.metadata)&&a._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(a){a=bt(a,va);const e=bt(a.firestore,Ut);return wk(la(e),a._key).then(n=>Zb(e,a,n))}class uo extends Uk{constructor(e){super(),this.firestore=e}convertBytes(e){return new ni(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new va(this.firestore,null,n)}}function MB(a){a=bt(a,va);const e=bt(a.firestore,Ut),n=la(e),r=new uo(e);return _3(n,a._key).then(s=>new Ml(e,r,a._key,s,new Vo(s!==null&&s.hasLocalMutations,!0),a.converter))}function VB(a){a=bt(a,va);const e=bt(a.firestore,Ut);return wk(la(e),a._key,{source:"server"}).then(n=>Zb(e,a,n))}function le(a){a=bt(a,$a);const e=bt(a.firestore,Ut),n=la(e),r=new uo(e);return Ok(a._query),_k(n,a._query).then(s=>new Vl(e,r,a,s))}function OB(a){a=bt(a,$a);const e=bt(a.firestore,Ut),n=la(e),r=new uo(e);return C3(n,a._query).then(s=>new Vl(e,r,a,s))}function jB(a){a=bt(a,$a);const e=bt(a.firestore,Ut),n=la(e),r=new uo(e);return _k(n,a._query,{source:"server"}).then(s=>new Vl(e,r,a,s))}function Ar(a,e,n){a=bt(a,va);const r=bt(a.firestore,Ut),s=Bg(a.converter,e,n);return pd(r,[Og(bi(r),"setDoc",a._key,s,a.converter!==null,n).toMutation(a._key,Zt.none())])}function ze(a,e,n,...r){a=bt(a,va);const s=bt(a.firestore,Ut),o=bi(s);let i;return i=typeof(e=gt(e))=="string"||e instanceof hi?Kb(o,"updateDoc",a._key,e,n,r):Hb(o,"updateDoc",a._key,e),pd(s,[i.toMutation(a._key,Zt.exists(!0))])}function on(a){return pd(bt(a.firestore,Ut),[new Hl(a._key,Zt.none())])}function ot(a,e){const n=bt(a.firestore,Ut),r=Ne(a),s=Bg(a.converter,e);return pd(n,[Og(bi(a.firestore),"addDoc",r._key,s,a.converter!==null,{}).toMutation(r._key,Zt.exists(!1))]).then(()=>r)}function wa(a,...e){var n,r,s;a=gt(a);let o={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||j0(e[i])||(o=e[i],i++);const l={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(j0(e[i])){const m=e[i];e[i]=(n=m.next)===null||n===void 0?void 0:n.bind(m),e[i+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[i+2]=(s=m.complete)===null||s===void 0?void 0:s.bind(m)}let c,u,d;if(a instanceof va)u=bt(a.firestore,Ut),d=Wl(a._key.path),c={next:m=>{e[i]&&e[i](Zb(u,a,m))},error:e[i+1],complete:e[i+2]};else{const m=bt(a,$a);u=bt(m.firestore,Ut),d=m._query;const h=new uo(u);c={next:C=>{e[i]&&e[i](new Vl(u,h,m,C))},error:e[i+1],complete:e[i+2]},Ok(a._query)}return function(h,C,S,w){const f=new Rg(w),b=new Rb(C,f,S);return h.asyncQueue.enqueueAndForget(async()=>Ab(await Ll(h),b)),()=>{f.Za(),h.asyncQueue.enqueueAndForget(async()=>Tb(await Ll(h),b))}}(la(u),d,l,c)}function FB(a,e){return k3(la(a=bt(a,Ut)),j0(e)?e:{next:e})}function pd(a,e){return function(r,s){const o=new Da;return r.asyncQueue.enqueueAndForget(async()=>t3(await zb(r),s,o)),o.promise}(la(a),e)}function Zb(a,e,n){const r=n.docs.get(e._key),s=new uo(a);return new Ml(a,s,e._key,r,new Vo(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zB(a){return G3(a,{count:q3()})}function G3(a,e){const n=bt(a.firestore,Ut),r=la(n),s=BC(e,(o,i)=>new ES(i,o.aggregateType,o._internalFieldPath));return S3(r,a._query,s).then(o=>function(l,c,u){const d=new uo(l);return new O3(c,d,u)}(n,a,o))}class H3{constructor(e){this.kind="memory",this._onlineComponentProvider=to.provider,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=eo.provider}toJSON(){return{kind:this.kind}}}class K3{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=X3(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class Q3{constructor(){this.kind="memoryEager",this._offlineComponentProvider=eo.provider}toJSON(){return{kind:this.kind}}}class J3{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new v3(e)}}toJSON(){return{kind:this.kind}}}function UB(){return new Q3}function $B(a){return new J3(a==null?void 0:a.cacheSizeBytes)}function BB(a){return new H3(a)}function qB(a){return new K3(a)}class Y3{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=to.provider,this._offlineComponentProvider={build:n=>new jb(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class Z3{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=to.provider,this._offlineComponentProvider={build:n=>new Ek(n,e==null?void 0:e.cacheSizeBytes)}}}function X3(a){return new Y3(a==null?void 0:a.forceOwnership)}function WB(){return new Z3}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eM={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tM{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=bi(e)}set(e,n,r){this._verifyNotCommitted();const s=ks(e,this._firestore),o=Bg(s.converter,n,r),i=Og(this._dataReader,"WriteBatch.set",s._key,o,s.converter!==null,r);return this._mutations.push(i.toMutation(s._key,Zt.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const o=ks(e,this._firestore);let i;return i=typeof(n=gt(n))=="string"||n instanceof hi?Kb(this._dataReader,"WriteBatch.update",o._key,n,r,s):Hb(this._dataReader,"WriteBatch.update",o._key,n),this._mutations.push(i.toMutation(o._key,Zt.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=ks(e,this._firestore);return this._mutations=this._mutations.concat(new Hl(n._key,Zt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new xe(ae.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ks(a,e){if((a=gt(a)).firestore!==e)throw new xe(ae.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aM extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=bi(n)}get(n){const r=ks(n,this._firestore),s=new B3(this._firestore);return this._transaction.lookup([r._key]).then(o=>{if(!o||o.length!==1)return Le();const i=o[0];if(i.isFoundDocument())return new Fu(this._firestore,s,i.key,i,r.converter);if(i.isNoDocument())return new Fu(this._firestore,s,r._key,null,r.converter);throw Le()})}set(n,r,s){const o=ks(n,this._firestore),i=Bg(o.converter,r,s),l=Og(this._dataReader,"Transaction.set",o._key,i,o.converter!==null,s);return this._transaction.set(o._key,l),this}update(n,r,s,...o){const i=ks(n,this._firestore);let l;return l=typeof(r=gt(r))=="string"||r instanceof hi?Kb(this._dataReader,"Transaction.update",i._key,r,s,o):Hb(this._dataReader,"Transaction.update",i._key,r),this._transaction.update(i._key,l),this}delete(n){const r=ks(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=ks(e,this._firestore),r=new uo(this._firestore);return super.get(e).then(s=>new Ml(this._firestore,r,n._key,s._document,new Vo(!1,!1),n.converter))}}function HB(a,e,n){a=bt(a,Ut);const r=Object.assign(Object.assign({},eM),n);return function(o){if(o.maxAttempts<1)throw new xe(ae.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(o,i,l){const c=new Da;return o.asyncQueue.enqueueAndForget(async()=>{const u=await Nk(o);new x3(o.asyncQueue,u,l,i,c).au()}),c.promise}(la(a),s=>e(new aM(a,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KB(){return new ud("deleteField")}function sa(){return new Bb("serverTimestamp")}function QB(...a){return new qb("arrayUnion",a)}function JB(...a){return new Wb("arrayRemove",a)}function YB(a){return new Gb("increment",a)}function ZB(a){return new Mg(a)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $k(a){return la(a=bt(a,Ut)),new tM(a,e=>pd(a,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XB(a,e){const n=la(a=bt(a,Ut));if(!n._uninitializedComponentsProvider||n._uninitializedComponentsProvider._offline.kind==="memory")return Fn("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(o){const i=typeof o=="string"?function(u){try{return JSON.parse(u)}catch(d){throw new xe(ae.INVALID_ARGUMENT,"Failed to parse JSON: "+(d==null?void 0:d.message))}}(o):o,l=[];if(Array.isArray(i.indexes))for(const c of i.indexes){const u=CN(c,"collectionGroup"),d=[];if(Array.isArray(c.fields))for(const m of c.fields){const h=jg("setIndexConfiguration",CN(m,"fieldPath"));m.arrayConfig==="CONTAINS"?d.push(new $o(h,2)):m.order==="ASCENDING"?d.push(new $o(h,0)):m.order==="DESCENDING"&&d.push(new $o(h,1))}l.push(new Nl(Nl.UNKNOWN_ID,u,d,wl.empty()))}return l}(e);return T3(n,r)}function CN(a,e){if(typeof a[e]!="string")throw new xe(ae.INVALID_ARGUMENT,"Missing string value for: "+e);return a[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nM{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function eq(a){var e;a=bt(a,Ut);const n=SN.get(a);if(n)return n;if(((e=la(a)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const r=new nM(a);return SN.set(a,r),r}function tq(a){Bk(a,!0)}function aq(a){Bk(a,!1)}function nq(a){R3(la(a._firestore)).then(e=>Ee("deleting all persistent cache indexes succeeded")).catch(e=>Fn("deleting all persistent cache indexes failed",e))}function Bk(a,e){P3(la(a._firestore),e).then(n=>Ee(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(n=>Fn(`setting persistent cache index auto creation isEnabled=${e} failed`,n))}const SN=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rq(a){var e;const n=(e=la(bt(a.firestore,Ut))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return n===void 0?null:Sg(n,Ya(a._query))._t}function sq(a,e){var n;const r=BC(e,(o,i)=>new ES(i,o.aggregateType,o._internalFieldPath)),s=(n=la(bt(a.firestore,Ut))._onlineComponents)===null||n===void 0?void 0:n.datastore.serializer;return s===void 0?null:RS(s,nS(a._query),r,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oq{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return Xb.instance.onExistenceFilterMismatch(e)}}class Xb{constructor(){this.Uu=new Map}static get instance(){return gm||(gm=new Xb,function(n){if(Sp)throw new Error("a TestingHooksSpi instance is already set");Sp=n}(gm)),gm}et(e){this.Uu.forEach(n=>n(e))}onExistenceFilterMismatch(e){const n=Symbol(),r=this.Uu;return r.set(n,e),()=>r.delete(n)}}let gm=null;(function(e,n=!0){(function(s){ql=s})(fi),ar(new jn("firestore",(r,{instanceIdentifier:s,options:o})=>{const i=r.getProvider("app").getImmediate(),l=new Ut(new I6(r.getProvider("auth-internal")),new P6(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new xe(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qo(u.options.projectId,d)}(i,s),i);return o=Object.assign({useFetchStreams:n},o),l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),bn(fy,"4.7.3",e),bn(fy,"4.7.3","esm2017")})();function eE(a,e){var n={};for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&e.indexOf(r)<0&&(n[r]=a[r]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(a);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(a,r[s])&&(n[r[s]]=a[r[s]]);return n}function xi(a,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{u(r.next(d))}catch(m){i(m)}}function c(d){try{u(r.throw(d))}catch(m){i(m)}}function u(d){d.done?o(d.value):s(d.value).then(l,c)}u((r=r.apply(a,e||[])).next())})}function qk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const rM=qk,Wk=new gi("auth","Firebase",qk());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp=new Xv("@firebase/auth");function sM(a,...e){Vp.logLevel<=yt.WARN&&Vp.warn(`Auth (${fi}): ${a}`,...e)}function qm(a,...e){Vp.logLevel<=yt.ERROR&&Vp.error(`Auth (${fi}): ${a}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nr(a,...e){throw tE(a,...e)}function Cr(a,...e){return tE(a,...e)}function Gk(a,e,n){const r=Object.assign(Object.assign({},rM()),{[e]:n});return new gi("auth","Firebase",r).create(e,{appName:a.name})}function Sr(a){return Gk(a,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function tE(a,...e){if(typeof a!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=a.name),a._errorFactory.create(n,...r)}return Wk.create(a,...e)}function at(a,e,...n){if(!a)throw tE(e,...n)}function zr(a){const e="INTERNAL ASSERTION FAILED: "+a;throw qm(e),new Error(e)}function Xr(a,e){a||zr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Op(){var a;return typeof self<"u"&&((a=self.location)===null||a===void 0?void 0:a.href)||""}function Hk(){return kN()==="http:"||kN()==="https:"}function kN(){var a;return typeof self<"u"&&((a=self.location)===null||a===void 0?void 0:a.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oM(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Hk()||o4()||"connection"in navigator)?navigator.onLine:!0}function iM(){if(typeof navigator>"u")return null;const a=navigator;return a.languages&&a.languages[0]||a.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(e,n){this.shortDelay=e,this.longDelay=n,Xr(n>e,"Short delay should be less than long delay!"),this.isMobile=n4()||i4()}get(){return oM()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aE(a,e){Xr(a.emulator,"Emulator should always be set here");const{url:n}=a.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;zr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;zr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;zr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lM={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cM=new gd(3e4,6e4);function ls(a,e){return a.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:a.tenantId}):e}async function Tr(a,e,n,r,s={}){return Qk(a,s,async()=>{let o={},i={};r&&(e==="GET"?i=r:o={body:JSON.stringify(r)});const l=Xu(Object.assign({key:a.config.apiKey},i)).slice(1),c=await a._getAdditionalHeaders();c["Content-Type"]="application/json",a.languageCode&&(c["X-Firebase-Locale"]=a.languageCode);const u=Object.assign({method:e,headers:c},o);return s4()||(u.referrerPolicy="no-referrer"),Kk.fetch()(Jk(a,a.config.apiHost,n,l),u)})}async function Qk(a,e,n){a._canInitEmulator=!1;const r=Object.assign(Object.assign({},lM),e);try{const s=new dM(a),o=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const i=await o.json();if("needConfirmation"in i)throw fm(a,"account-exists-with-different-credential",i);if(o.ok&&!("errorMessage"in i))return i;{const l=o.ok?i.errorMessage:i.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw fm(a,"credential-already-in-use",i);if(c==="EMAIL_EXISTS")throw fm(a,"email-already-in-use",i);if(c==="USER_DISABLED")throw fm(a,"user-disabled",i);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Gk(a,d,u);nr(a,d)}}catch(s){if(s instanceof rr)throw s;nr(a,"network-request-failed",{message:String(s)})}}async function fd(a,e,n,r,s={}){const o=await Tr(a,e,n,r,s);return"mfaPendingCredential"in o&&nr(a,"multi-factor-auth-required",{_serverResponse:o}),o}function Jk(a,e,n,r){const s=`${e}${n}?${r}`;return a.config.emulator?aE(a.config,s):`${a.config.apiScheme}://${s}`}function uM(a){switch(a){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class dM{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Cr(this.auth,"network-request-failed")),cM.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function fm(a,e,n){const r={appName:a.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Cr(a,e,r);return s.customData._tokenResponse=n,s}function IN(a){return a!==void 0&&a.enterprise!==void 0}class mM{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return uM(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function pM(a,e){return Tr(a,"GET","/v2/recaptchaConfig",ls(a,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gM(a,e){return Tr(a,"POST","/v1/accounts:delete",e)}async function Yk(a,e){return Tr(a,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(a){if(a)try{const e=new Date(Number(a));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function fM(a,e=!1){const n=gt(a),r=await n.getIdToken(e),s=nE(r);at(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,i=o==null?void 0:o.sign_in_provider;return{claims:s,token:r,authTime:ou(Jf(s.auth_time)),issuedAtTime:ou(Jf(s.iat)),expirationTime:ou(Jf(s.exp)),signInProvider:i||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Jf(a){return Number(a)*1e3}function nE(a){const[e,n,r]=a.split(".");if(e===void 0||n===void 0||r===void 0)return qm("JWT malformed, contained fewer than 3 sections"),null;try{const s=uC(n);return s?JSON.parse(s):(qm("Failed to decode base64 JWT payload"),null)}catch(s){return qm("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function AN(a){const e=nE(a);return at(e,"internal-error"),at(typeof e.exp<"u","internal-error"),at(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ol(a,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof rr&&hM(r)&&a.auth.currentUser===a&&await a.auth.signOut(),r}}function hM({code:a}){return a==="auth/user-disabled"||a==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ou(this.lastLoginAt),this.creationTime=ou(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jp(a){var e;const n=a.auth,r=await a.getIdToken(),s=await Ol(a,Yk(n,{idToken:r}));at(s==null?void 0:s.users.length,n,"internal-error");const o=s.users[0];a._notifyReloadListener(o);const i=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?Zk(o.providerUserInfo):[],l=EM(a.providerData,i),c=a.isAnonymous,u=!(a.email&&o.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,m={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:l,metadata:new F0(o.createdAt,o.lastLoginAt),isAnonymous:d};Object.assign(a,m)}async function bM(a){const e=gt(a);await jp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function EM(a,e){return[...a.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Zk(a){return a.map(e=>{var{providerId:n}=e,r=eE(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xM(a,e){const n=await Qk(a,{},async()=>{const r=Xu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=a.config,i=Jk(a,s,"/v1/token",`key=${o}`),l=await a._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",Kk.fetch()(i,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function yM(a,e){return Tr(a,"POST","/v2/accounts:revokeToken",ls(a,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){at(e.idToken,"internal-error"),at(typeof e.idToken<"u","internal-error"),at(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):AN(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){at(e.length!==0,"internal-error");const n=AN(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(at(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:o}=await xM(e,n);this.updateTokensAndExpiration(r,s,Number(o))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:o}=n,i=new cl;return r&&(at(typeof r=="string","internal-error",{appName:e}),i.refreshToken=r),s&&(at(typeof s=="string","internal-error",{appName:e}),i.accessToken=s),o&&(at(typeof o=="number","internal-error",{appName:e}),i.expirationTime=o),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new cl,this.toJSON())}_performRefresh(){return zr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bs(a,e){at(typeof a=="string"||typeof a>"u","internal-error",{appName:e})}class Ur{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,o=eE(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new vM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new F0(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const n=await Ol(this,this.stsTokenManager.getToken(this.auth,e));return at(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return fM(this,e)}reload(){return bM(this)}_assign(e){this!==e&&(at(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ur(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){at(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await jp(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Yn(this.auth.app))return Promise.reject(Sr(this.auth));const e=await this.getIdToken();return await Ol(this,gM(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,o,i,l,c,u,d;const m=(r=n.displayName)!==null&&r!==void 0?r:void 0,h=(s=n.email)!==null&&s!==void 0?s:void 0,C=(o=n.phoneNumber)!==null&&o!==void 0?o:void 0,S=(i=n.photoURL)!==null&&i!==void 0?i:void 0,w=(l=n.tenantId)!==null&&l!==void 0?l:void 0,f=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,b=(u=n.createdAt)!==null&&u!==void 0?u:void 0,v=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:I,emailVerified:A,isAnonymous:N,providerData:x,stsTokenManager:y}=n;at(I&&y,e,"internal-error");const E=cl.fromJSON(this.name,y);at(typeof I=="string",e,"internal-error"),bs(m,e.name),bs(h,e.name),at(typeof A=="boolean",e,"internal-error"),at(typeof N=="boolean",e,"internal-error"),bs(C,e.name),bs(S,e.name),bs(w,e.name),bs(f,e.name),bs(b,e.name),bs(v,e.name);const _=new Ur({uid:I,auth:e,email:h,emailVerified:A,displayName:m,isAnonymous:N,photoURL:S,phoneNumber:C,tenantId:w,stsTokenManager:E,createdAt:b,lastLoginAt:v});return x&&Array.isArray(x)&&(_.providerData=x.map(P=>Object.assign({},P))),f&&(_._redirectEventId=f),_}static async _fromIdTokenResponse(e,n,r=!1){const s=new cl;s.updateFromServerResponse(n);const o=new Ur({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await jp(o),o}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];at(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?Zk(s.providerUserInfo):[],i=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),l=new cl;l.updateFromIdToken(r);const c=new Ur({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:i}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new F0(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TN=new Map;function $r(a){Xr(a instanceof Function,"Expected a class definition");let e=TN.get(a);return e?(Xr(e instanceof a,"Instance stored in cache mismatched with class"),e):(e=new a,TN.set(a,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Xk.type="NONE";const PN=Xk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wm(a,e,n){return`firebase:${a}:${e}:${n}`}class ul{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:o}=this.auth;this.fullUserKey=Wm(this.userKey,s.apiKey,o),this.fullPersistenceKey=Wm("persistence",s.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ur._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ul($r(PN),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let o=s[0]||$r(PN);const i=Wm(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(i);if(d){const m=Ur._fromJSON(e,d);u!==o&&(l=m),o=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new ul(o,e,r):(o=c[0],l&&await o._set(i,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==o)try{await u._remove(i)}catch{}})),new ul(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RN(a){const e=a.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(nI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(eI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(sI(e))return"Blackberry";if(oI(e))return"Webos";if(tI(e))return"Safari";if((e.includes("chrome/")||aI(e))&&!e.includes("edge/"))return"Chrome";if(rI(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=a.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function eI(a=_a()){return/firefox\//i.test(a)}function tI(a=_a()){const e=a.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function aI(a=_a()){return/crios\//i.test(a)}function nI(a=_a()){return/iemobile/i.test(a)}function rI(a=_a()){return/android/i.test(a)}function sI(a=_a()){return/blackberry/i.test(a)}function oI(a=_a()){return/webos/i.test(a)}function rE(a=_a()){return/iphone|ipad|ipod/i.test(a)||/macintosh/i.test(a)&&/mobile/i.test(a)}function NM(a=_a()){var e;return rE(a)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function wM(){return l4()&&document.documentMode===10}function iI(a=_a()){return rE(a)||rI(a)||oI(a)||sI(a)||/windows phone/i.test(a)||nI(a)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lI(a,e=[]){let n;switch(a){case"Browser":n=RN(_a());break;case"Worker":n=`${RN(_a())}-${a}`;break;default:n=a}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${fi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _M{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=o=>new Promise((i,l)=>{try{const c=e(o);i(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CM(a,e={}){return Tr(a,"GET","/v2/passwordPolicy",ls(a,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SM=6;class kM{constructor(e){var n,r,s,o;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=i.minPasswordLength)!==null&&n!==void 0?n:SM,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),i.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),i.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),i.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),i.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,o,i,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsUppercaseLetter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(i=c.containsNumericCharacter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IM{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new DN(this),this.idTokenSubscription=new DN(this),this.beforeStateQueue=new _M(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Wk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=$r(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await ul.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Yk(this,{idToken:e}),r=await Ur._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Yn(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===l)&&(c!=null&&c.user)&&(s=c.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(i){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return at(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await jp(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=iM()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Yn(this.app))return Promise.reject(Sr(this));const n=e?gt(e):null;return n&&at(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&at(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Yn(this.app)?Promise.reject(Sr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Yn(this.app)?Promise.reject(Sr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($r(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await CM(this),n=new kM(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new gi("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await yM(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&$r(e)||this._popupRedirectResolver;at(n,this,"argument-error"),this.redirectPersistenceManager=await ul.create(this,[$r(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n);let i=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(at(l,this,"internal-error"),l.then(()=>{i||o(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{i=!0,c()}}else{const c=e.addObserver(n);return()=>{i=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return at(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=lI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&sM(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function yi(a){return gt(a)}class DN{constructor(e){this.auth=e,this.observer=null,this.addObserver=g4(n=>this.observer=n)}get next(){return at(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function AM(a){qg=a}function cI(a){return qg.loadJS(a)}function TM(){return qg.recaptchaEnterpriseScript}function PM(){return qg.gapiScript}function RM(a){return`__${a}${Math.floor(Math.random()*1e6)}`}const DM="recaptcha-enterprise",LM="NO_RECAPTCHA";class MM{constructor(e){this.type=DM,this.auth=yi(e)}async verify(e="verify",n=!1){async function r(o){if(!n){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(i,l)=>{pM(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new mM(c);return o.tenantId==null?o._agentRecaptchaConfig=u:o._tenantRecaptchaConfigs[o.tenantId]=u,i(u.siteKey)}}).catch(c=>{l(c)})})}function s(o,i,l){const c=window.grecaptcha;IN(c)?c.enterprise.ready(()=>{c.enterprise.execute(o,{action:e}).then(u=>{i(u)}).catch(()=>{i(LM)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,i)=>{r(this.auth).then(l=>{if(!n&&IN(window.grecaptcha))s(l,o,i);else{if(typeof window>"u"){i(new Error("RecaptchaVerifier is only supported in browser"));return}let c=TM();c.length!==0&&(c+=l),cI(c).then(()=>{s(l,o,i)}).catch(u=>{i(u)})}}).catch(l=>{i(l)})})}}async function LN(a,e,n,r=!1){const s=new MM(a);let o;try{o=await s.verify(n)}catch{o=await s.verify(n,!0)}const i=Object.assign({},e);return r?Object.assign(i,{captchaResp:o}):Object.assign(i,{captchaResponse:o}),Object.assign(i,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(i,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),i}async function z0(a,e,n,r){var s;if(!((s=a._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await LN(a,e,n,n==="getOobCode");return r(a,o)}else return r(a,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await LN(a,e,n,n==="getOobCode");return r(a,i)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VM(a,e){const n=ns(a,"auth");if(n.isInitialized()){const s=n.getImmediate(),o=n.getOptions();if(Ks(o,e??{}))return s;nr(s,"already-initialized")}return n.initialize({options:e})}function OM(a,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map($r);e!=null&&e.errorMap&&a._updateErrorMap(e.errorMap),a._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function jM(a,e,n){const r=yi(a);at(r._canInitEmulator,r,"emulator-config-failed"),at(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),o=uI(e),{host:i,port:l}=FM(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${o}//${i}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:i,port:l,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||zM()}function uI(a){const e=a.indexOf(":");return e<0?"":a.substr(0,e+1)}function FM(a){const e=uI(a),n=/(\/\/)?([^?#/]+)/.exec(a.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const o=s[1];return{host:o,port:MN(r.substr(o.length+1))}}else{const[o,i]=r.split(":");return{host:o,port:MN(i)}}}function MN(a){if(!a)return null;const e=Number(a);return isNaN(e)?null:e}function zM(){function a(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",a):a())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sE{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return zr("not implemented")}_getIdTokenResponse(e){return zr("not implemented")}_linkToIdToken(e,n){return zr("not implemented")}_getReauthenticationResolver(e){return zr("not implemented")}}async function UM(a,e){return Tr(a,"POST","/v1/accounts:update",e)}async function $M(a,e){return Tr(a,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BM(a,e){return fd(a,"POST","/v1/accounts:signInWithPassword",ls(a,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qM(a,e){return fd(a,"POST","/v1/accounts:signInWithEmailLink",ls(a,e))}async function WM(a,e){return fd(a,"POST","/v1/accounts:signInWithEmailLink",ls(a,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu extends sE{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new zu(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new zu(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return z0(e,n,"signInWithPassword",BM);case"emailLink":return qM(e,{email:this._email,oobCode:this._password});default:nr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return z0(e,r,"signUpPassword",$M);case"emailLink":return WM(e,{idToken:n,email:this._email,oobCode:this._password});default:nr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dl(a,e){return fd(a,"POST","/v1/accounts:signInWithIdp",ls(a,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GM="http://localhost";class ri extends sE{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ri(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):nr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,o=eE(n,["providerId","signInMethod"]);if(!r||!s)return null;const i=new ri(r,s);return i.idToken=o.idToken||void 0,i.accessToken=o.accessToken||void 0,i.secret=o.secret,i.nonce=o.nonce,i.pendingToken=o.pendingToken||null,i}_getIdTokenResponse(e){const n=this.buildRequest();return dl(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,dl(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,dl(e,n)}buildRequest(){const e={requestUri:GM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Xu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HM(a){switch(a){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function KM(a){const e=zc(Uc(a)).link,n=e?zc(Uc(e)).deep_link_id:null,r=zc(Uc(a)).deep_link_id;return(r?zc(Uc(r)).link:null)||r||n||e||a}class oE{constructor(e){var n,r,s,o,i,l;const c=zc(Uc(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,m=HM((s=c.mode)!==null&&s!==void 0?s:null);at(u&&d&&m,"argument-error"),this.apiKey=u,this.operation=m,this.code=d,this.continueUrl=(o=c.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(i=c.languageCode)!==null&&i!==void 0?i:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=KM(e);try{return new oE(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(){this.providerId=ao.PROVIDER_ID}static credential(e,n){return zu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=oE.parseLink(n);return at(r,"argument-error"),zu._fromEmailAndCode(e,r.code,r.tenantId)}}ao.PROVIDER_ID="password";ao.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ao.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd extends dI{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends hd{constructor(){super("facebook.com")}static credential(e){return ri._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Is.credential(e.oauthAccessToken)}catch{return null}}}Is.FACEBOOK_SIGN_IN_METHOD="facebook.com";Is.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends hd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ri._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return As.credential(n,r)}catch{return null}}}As.GOOGLE_SIGN_IN_METHOD="google.com";As.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends hd{constructor(){super("github.com")}static credential(e){return ri._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ts.credential(e.oauthAccessToken)}catch{return null}}}Ts.GITHUB_SIGN_IN_METHOD="github.com";Ts.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps extends hd{constructor(){super("twitter.com")}static credential(e,n){return ri._fromParams({providerId:Ps.PROVIDER_ID,signInMethod:Ps.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ps.credentialFromTaggedObject(e)}static credentialFromError(e){return Ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ps.credential(n,r)}catch{return null}}}Ps.TWITTER_SIGN_IN_METHOD="twitter.com";Ps.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QM(a,e){return fd(a,"POST","/v1/accounts:signUp",ls(a,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const o=await Ur._fromIdTokenResponse(e,r,s),i=VN(r);return new si({user:o,providerId:i,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=VN(r);return new si({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function VN(a){return a.providerId?a.providerId:"phoneNumber"in a?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp extends rr{constructor(e,n,r,s){var o;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Fp.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Fp(e,n,r,s)}}function mI(a,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(a):n._getIdTokenResponse(a)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Fp._fromErrorAndOperation(a,o,e,r):o})}async function JM(a,e,n=!1){const r=await Ol(a,e._linkToIdToken(a.auth,await a.getIdToken()),n);return si._forOperation(a,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pI(a,e,n=!1){const{auth:r}=a;if(Yn(r.app))return Promise.reject(Sr(r));const s="reauthenticate";try{const o=await Ol(a,mI(r,s,e,a),n);at(o.idToken,r,"internal-error");const i=nE(o.idToken);at(i,r,"internal-error");const{sub:l}=i;return at(a.uid===l,r,"user-mismatch"),si._forOperation(a,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&nr(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gI(a,e,n=!1){if(Yn(a.app))return Promise.reject(Sr(a));const r="signIn",s=await mI(a,r,e),o=await si._fromIdTokenResponse(a,r,s);return n||await a._updateCurrentUser(o.user),o}async function YM(a,e){return gI(yi(a),e)}async function ON(a,e){return pI(gt(a),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fI(a){const e=yi(a);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function es(a,e,n){if(Yn(a.app))return Promise.reject(Sr(a));const r=yi(a),i=await z0(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",QM).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&fI(a),c}),l=await si._fromIdTokenResponse(r,"signIn",i);return await r._updateCurrentUser(l.user),l}function hI(a,e,n){return Yn(a.app)?Promise.reject(Sr(a)):YM(gt(a),ao.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&fI(a),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZM(a,e){return Tr(a,"POST","/v1/accounts:createAuthUri",ls(a,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XM(a,e){const n=Hk()?Op():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:s}=await ZM(gt(a),r);return s||[]}function e5(a,e){const n=gt(a);return Yn(n.auth.app)?Promise.reject(Sr(n.auth)):vI(n,e,null)}function t5(a,e){return vI(gt(a),null,e)}async function vI(a,e,n){const{auth:r}=a,o={idToken:await a.getIdToken(),returnSecureToken:!0};e&&(o.email=e),n&&(o.password=n);const i=await Ol(a,UM(r,o));await a._updateTokensIfNecessary(i,!0)}function a5(a,e,n,r){return gt(a).onIdTokenChanged(e,n,r)}function n5(a,e,n){return gt(a).beforeAuthStateChanged(e,n)}function iE(a,e,n,r){return gt(a).onAuthStateChanged(e,n,r)}function Tc(a){return gt(a).signOut()}async function r5(a){return gt(a).delete()}const zp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(zp,"1"),this.storage.removeItem(zp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s5=1e3,o5=10;class EI extends bI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=iI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((i,l,c)=>{this.notifyListeners(i,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const i=this.storage.getItem(r);!n&&this.localCache[r]===i||this.notifyListeners(r,i)},o=this.storage.getItem(r);wM()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,o5):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},s5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}EI.type="LOCAL";const i5=EI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xI extends bI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}xI.type="SESSION";const yI=xI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l5(a){return Promise.all(a.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Wg(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:o}=n.data,i=this.handlersMap[s];if(!(i!=null&&i.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(i).map(async u=>u(n.origin,o)),c=await l5(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Wg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lE(a="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return a+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,i;return new Promise((l,c)=>{const u=lE("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);i={messageChannel:s,onMessage(m){const h=m;if(h.data.eventId===u)switch(h.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),l(h.data.response);break;default:clearTimeout(d),clearTimeout(o),c(new Error("invalid_response"));break}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kr(){return window}function u5(a){kr().location.href=a}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NI(){return typeof kr().WorkerGlobalScope<"u"&&typeof kr().importScripts=="function"}async function d5(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function m5(){var a;return((a=navigator==null?void 0:navigator.serviceWorker)===null||a===void 0?void 0:a.controller)||null}function p5(){return NI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wI="firebaseLocalStorageDb",g5=1,Up="firebaseLocalStorage",_I="fbase_key";class vd{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Gg(a,e){return a.transaction([Up],e?"readwrite":"readonly").objectStore(Up)}function f5(){const a=indexedDB.deleteDatabase(wI);return new vd(a).toPromise()}function U0(){const a=indexedDB.open(wI,g5);return new Promise((e,n)=>{a.addEventListener("error",()=>{n(a.error)}),a.addEventListener("upgradeneeded",()=>{const r=a.result;try{r.createObjectStore(Up,{keyPath:_I})}catch(s){n(s)}}),a.addEventListener("success",async()=>{const r=a.result;r.objectStoreNames.contains(Up)?e(r):(r.close(),await f5(),e(await U0()))})})}async function jN(a,e,n){const r=Gg(a,!0).put({[_I]:e,value:n});return new vd(r).toPromise()}async function h5(a,e){const n=Gg(a,!1).get(e),r=await new vd(n).toPromise();return r===void 0?null:r.value}function FN(a,e){const n=Gg(a,!0).delete(e);return new vd(n).toPromise()}const v5=800,b5=3;class CI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await U0(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>b5)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return NI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Wg._getInstance(p5()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await d5(),!this.activeServiceWorker)return;this.sender=new c5(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||m5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await U0();return await jN(e,zp,"1"),await FN(e,zp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>jN(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>h5(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>FN(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=Gg(s,!1).getAll();return new vd(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),v5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}CI.type="LOCAL";const E5=CI;new gd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x5(a,e){return e?$r(e):(at(a._popupRedirectResolver,a,"argument-error"),a._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cE extends sE{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return dl(e,this._buildIdpRequest())}_linkToIdToken(e,n){return dl(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return dl(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function y5(a){return gI(a.auth,new cE(a),a.bypassAuthState)}function N5(a){const{auth:e,user:n}=a;return at(n,e,"internal-error"),pI(n,new cE(a),a.bypassAuthState)}async function w5(a){const{auth:e,user:n}=a;return at(n,e,"internal-error"),JM(n,new cE(a),a.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(e,n,r,s,o=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:o,error:i,type:l}=e;if(i){this.reject(i);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return y5;case"linkViaPopup":case"linkViaRedirect":return w5;case"reauthViaPopup":case"reauthViaRedirect":return N5;default:nr(this.auth,"internal-error")}}resolve(e){Xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _5=new gd(2e3,1e4);class Zi extends SI{constructor(e,n,r,s,o){super(e,n,s,o),this.provider=r,this.authWindow=null,this.pollId=null,Zi.currentPopupAction&&Zi.currentPopupAction.cancel(),Zi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return at(e,this.auth,"internal-error"),e}async onExecution(){Xr(this.filter.length===1,"Popup operations only handle one event");const e=lE();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Cr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Cr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Zi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Cr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,_5.get())};e()}}Zi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C5="pendingRedirect",Gm=new Map;class S5 extends SI{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Gm.get(this.auth._key());if(!e){try{const r=await k5(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Gm.set(this.auth._key(),e)}return this.bypassAuthState||Gm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function k5(a,e){const n=T5(e),r=A5(a);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function I5(a,e){Gm.set(a._key(),e)}function A5(a){return $r(a._redirectPersistence)}function T5(a){return Wm(C5,a.config.apiKey,a.name)}async function P5(a,e,n=!1){if(Yn(a.app))return Promise.reject(Sr(a));const r=yi(a),s=x5(r,e),i=await new S5(r,s,n).execute();return i&&!n&&(delete i.user._redirectEventId,await r._persistUserIfCurrent(i.user),await r._setRedirectUser(null,e)),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R5=10*60*1e3;class D5{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!L5(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!kI(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Cr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=R5&&this.cachedEventUids.clear(),this.cachedEventUids.has(zN(e))}saveEventToCache(e){this.cachedEventUids.add(zN(e)),this.lastProcessedEventTime=Date.now()}}function zN(a){return[a.type,a.eventId,a.sessionId,a.tenantId].filter(e=>e).join("-")}function kI({type:a,error:e}){return a==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function L5(a){switch(a.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return kI(a);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M5(a,e={}){return Tr(a,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V5=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,O5=/^https?/;async function j5(a){if(a.config.emulator)return;const{authorizedDomains:e}=await M5(a);for(const n of e)try{if(F5(n))return}catch{}nr(a,"unauthorized-domain")}function F5(a){const e=Op(),{protocol:n,hostname:r}=new URL(e);if(a.startsWith("chrome-extension://")){const i=new URL(a);return i.hostname===""&&r===""?n==="chrome-extension:"&&a.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&i.hostname===r}if(!O5.test(n))return!1;if(V5.test(a))return r===a;const s=a.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z5=new gd(3e4,6e4);function UN(){const a=kr().___jsl;if(a!=null&&a.H){for(const e of Object.keys(a.H))if(a.H[e].r=a.H[e].r||[],a.H[e].L=a.H[e].L||[],a.H[e].r=[...a.H[e].L],a.CP)for(let n=0;n<a.CP.length;n++)a.CP[n]=null}}function U5(a){return new Promise((e,n)=>{var r,s,o;function i(){UN(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{UN(),n(Cr(a,"network-request-failed"))},timeout:z5.get()})}if(!((s=(r=kr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((o=kr().gapi)===null||o===void 0)&&o.load)i();else{const l=RM("iframefcb");return kr()[l]=()=>{gapi.load?i():n(Cr(a,"network-request-failed"))},cI(`${PM()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw Hm=null,e})}let Hm=null;function $5(a){return Hm=Hm||U5(a),Hm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B5=new gd(5e3,15e3),q5="__/auth/iframe",W5="emulator/auth/iframe",G5={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},H5=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function K5(a){const e=a.config;at(e.authDomain,a,"auth-domain-config-required");const n=e.emulator?aE(e,W5):`https://${a.config.authDomain}/${q5}`,r={apiKey:e.apiKey,appName:a.name,v:fi},s=H5.get(a.config.apiHost);s&&(r.eid=s);const o=a._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${Xu(r).slice(1)}`}async function Q5(a){const e=await $5(a),n=kr().gapi;return at(n,a,"internal-error"),e.open({where:document.body,url:K5(a),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:G5,dontclear:!0},r=>new Promise(async(s,o)=>{await r.restyle({setHideOnLeave:!1});const i=Cr(a,"network-request-failed"),l=kr().setTimeout(()=>{o(i)},B5.get());function c(){kr().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{o(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J5={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Y5=500,Z5=600,X5="_blank",eV="http://localhost";class $N{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function tV(a,e,n,r=Y5,s=Z5){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},J5),{width:r.toString(),height:s.toString(),top:o,left:i}),u=_a().toLowerCase();n&&(l=aI(u)?X5:n),eI(u)&&(e=e||eV,c.scrollbars="yes");const d=Object.entries(c).reduce((h,[C,S])=>`${h}${C}=${S},`,"");if(NM(u)&&l!=="_self")return aV(e||"",l),new $N(null);const m=window.open(e||"",l,d);at(m,a,"popup-blocked");try{m.focus()}catch{}return new $N(m)}function aV(a,e){const n=document.createElement("a");n.href=a,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nV="__/auth/handler",rV="emulator/auth/handler",sV=encodeURIComponent("fac");async function BN(a,e,n,r,s,o){at(a.config.authDomain,a,"auth-domain-config-required"),at(a.config.apiKey,a,"invalid-api-key");const i={apiKey:a.config.apiKey,appName:a.name,authType:n,redirectUrl:r,v:fi,eventId:s};if(e instanceof dI){e.setDefaultLanguage(a.languageCode),i.providerId=e.providerId||"",p4(e.getCustomParameters())||(i.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries(o||{}))i[d]=m}if(e instanceof hd){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(i.scopes=d.join(","))}a.tenantId&&(i.tid=a.tenantId);const l=i;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await a._getAppCheckToken(),u=c?`#${sV}=${encodeURIComponent(c)}`:"";return`${oV(a)}?${Xu(l).slice(1)}${u}`}function oV({config:a}){return a.emulator?aE(a,rV):`https://${a.authDomain}/${nV}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yf="webStorageSupport";class iV{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=yI,this._completeRedirectFn=P5,this._overrideRedirectResult=I5}async _openPopup(e,n,r,s){var o;Xr((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await BN(e,n,r,Op(),s);return tV(e,i,lE())}async _openRedirect(e,n,r,s){await this._originValidation(e);const o=await BN(e,n,r,Op(),s);return u5(o),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:o}=this.eventManagers[n];return s?Promise.resolve(s):(Xr(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Q5(e),r=new D5(e);return n.register("authEvent",s=>(at(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Yf,{type:Yf},s=>{var o;const i=(o=s==null?void 0:s[0])===null||o===void 0?void 0:o[Yf];i!==void 0&&n(!!i),nr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=j5(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return iI()||tI()||rE()}}const lV=iV;var qN="@firebase/auth",WN="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){at(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uV(a){switch(a){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function dV(a){ar(new jn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:i,authDomain:l}=r.options;at(i&&!i.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:i,authDomain:l,clientPlatform:a,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lI(a)},u=new IM(r,s,o,c);return OM(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ar(new jn("auth-internal",e=>{const n=yi(e.getProvider("auth").getImmediate());return(r=>new cV(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),bn(qN,WN,uV(a)),bn(qN,WN,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mV=5*60,pV=gC("authIdTokenMaxAge")||mV;let GN=null;const gV=a=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>pV)return;const s=n==null?void 0:n.token;GN!==s&&(GN=s,await fetch(a,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function iu(a=Eg()){const e=ns(a,"auth");if(e.isInitialized())return e.getImmediate();const n=VM(a,{popupRedirectResolver:lV,persistence:[E5,i5,yI]}),r=gC("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const i=gV(o.toString());n5(n,i,()=>i(n.currentUser)),a5(n,l=>i(l))}}const s=dC("auth");return s&&jM(n,`http://${s}`),n}function fV(){var a,e;return(e=(a=document.getElementsByTagName("head"))===null||a===void 0?void 0:a[0])!==null&&e!==void 0?e:document}AM({loadJS(a){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",a),r.onload=e,r.onerror=s=>{const o=Cr("internal-error");o.customData=s,n(o)},r.type="text/javascript",r.charset="UTF-8",fV().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});dV("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II="firebasestorage.googleapis.com",AI="storageBucket",hV=2*60*1e3,vV=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa extends rr{constructor(e,n,r=0){super(Zf(e),`Firebase Storage: ${n} (${Zf(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,pa.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Zf(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ma;(function(a){a.UNKNOWN="unknown",a.OBJECT_NOT_FOUND="object-not-found",a.BUCKET_NOT_FOUND="bucket-not-found",a.PROJECT_NOT_FOUND="project-not-found",a.QUOTA_EXCEEDED="quota-exceeded",a.UNAUTHENTICATED="unauthenticated",a.UNAUTHORIZED="unauthorized",a.UNAUTHORIZED_APP="unauthorized-app",a.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",a.INVALID_CHECKSUM="invalid-checksum",a.CANCELED="canceled",a.INVALID_EVENT_NAME="invalid-event-name",a.INVALID_URL="invalid-url",a.INVALID_DEFAULT_BUCKET="invalid-default-bucket",a.NO_DEFAULT_BUCKET="no-default-bucket",a.CANNOT_SLICE_BLOB="cannot-slice-blob",a.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",a.NO_DOWNLOAD_URL="no-download-url",a.INVALID_ARGUMENT="invalid-argument",a.INVALID_ARGUMENT_COUNT="invalid-argument-count",a.APP_DELETED="app-deleted",a.INVALID_ROOT_OPERATION="invalid-root-operation",a.INVALID_FORMAT="invalid-format",a.INTERNAL_ERROR="internal-error",a.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ma||(ma={}));function Zf(a){return"storage/"+a}function uE(){const a="An unknown error occurred, please check the error payload for server response.";return new pa(ma.UNKNOWN,a)}function bV(a){return new pa(ma.OBJECT_NOT_FOUND,"Object '"+a+"' does not exist.")}function EV(a){return new pa(ma.QUOTA_EXCEEDED,"Quota for bucket '"+a+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function xV(){const a="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new pa(ma.UNAUTHENTICATED,a)}function yV(){return new pa(ma.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function NV(a){return new pa(ma.UNAUTHORIZED,"User does not have permission to access '"+a+"'.")}function wV(){return new pa(ma.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function _V(){return new pa(ma.CANCELED,"User canceled the upload/download.")}function CV(a){return new pa(ma.INVALID_URL,"Invalid URL '"+a+"'.")}function SV(a){return new pa(ma.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+a+"'.")}function kV(){return new pa(ma.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+AI+"' property when initializing the app?")}function IV(){return new pa(ma.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function AV(){return new pa(ma.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function TV(a){return new pa(ma.UNSUPPORTED_ENVIRONMENT,`${a} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function $0(a){return new pa(ma.INVALID_ARGUMENT,a)}function TI(){return new pa(ma.APP_DELETED,"The Firebase app was deleted.")}function PV(a){return new pa(ma.INVALID_ROOT_OPERATION,"The operation '"+a+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function lu(a,e){return new pa(ma.INVALID_FORMAT,"String does not match format '"+a+"': "+e)}function Pc(a){throw new pa(ma.INTERNAL_ERROR,"Internal error: "+a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=_n.makeFromUrl(e,n)}catch{return new _n(e,"")}if(r.path==="")return r;throw SV(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function o(A){A.path.charAt(A.path.length-1)==="/"&&(A.path_=A.path_.slice(0,-1))}const i="(/(.*))?$",l=new RegExp("^gs://"+s+i,"i"),c={bucket:1,path:3};function u(A){A.path_=decodeURIComponent(A.path)}const d="v[A-Za-z0-9_]+",m=n.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",C=new RegExp(`^https?://${m}/${d}/b/${s}/o${h}`,"i"),S={bucket:1,path:3},w=n===II?"(?:storage.googleapis.com|storage.cloud.google.com)":n,f="([^?#]*)",b=new RegExp(`^https?://${w}/${s}/${f}`,"i"),I=[{regex:l,indices:c,postModify:o},{regex:C,indices:S,postModify:u},{regex:b,indices:{bucket:1,path:2},postModify:u}];for(let A=0;A<I.length;A++){const N=I[A],x=N.regex.exec(e);if(x){const y=x[N.indices.bucket];let E=x[N.indices.path];E||(E=""),r=new _n(y,E),N.postModify(r);break}}if(r==null)throw CV(e);return r}}class RV{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DV(a,e,n){let r=1,s=null,o=null,i=!1,l=0;function c(){return l===2}let u=!1;function d(...f){u||(u=!0,e.apply(null,f))}function m(f){s=setTimeout(()=>{s=null,a(C,c())},f)}function h(){o&&clearTimeout(o)}function C(f,...b){if(u){h();return}if(f){h(),d.call(null,f,...b);return}if(c()||i){h(),d.call(null,f,...b);return}r<64&&(r*=2);let I;l===1?(l=2,I=0):I=(r+Math.random())*1e3,m(I)}let S=!1;function w(f){S||(S=!0,h(),!u&&(s!==null?(f||(l=2),clearTimeout(s),m(0)):f||(l=1)))}return m(0),o=setTimeout(()=>{i=!0,w(!0)},n),w}function LV(a){a(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MV(a){return a!==void 0}function VV(a){return typeof a=="object"&&!Array.isArray(a)}function dE(a){return typeof a=="string"||a instanceof String}function HN(a){return mE()&&a instanceof Blob}function mE(){return typeof Blob<"u"}function KN(a,e,n,r){if(r<e)throw $0(`Invalid value for '${a}'. Expected ${e} or greater.`);if(r>n)throw $0(`Invalid value for '${a}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pE(a,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${a}`}function PI(a){const e=encodeURIComponent;let n="?";for(const r in a)if(a.hasOwnProperty(r)){const s=e(r)+"="+e(a[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Bo;(function(a){a[a.NO_ERROR=0]="NO_ERROR",a[a.NETWORK_ERROR=1]="NETWORK_ERROR",a[a.ABORT=2]="ABORT"})(Bo||(Bo={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OV(a,e){const n=a>=500&&a<600,s=[408,429].indexOf(a)!==-1,o=e.indexOf(a)!==-1;return n||s||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{constructor(e,n,r,s,o,i,l,c,u,d,m,h=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=o,this.additionalRetryCodes_=i,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=m,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((C,S)=>{this.resolve_=C,this.reject_=S,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new hm(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const i=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&o.addUploadProgressListener(i),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(i),this.pendingConnection_=null;const l=o.getErrorCode()===Bo.NO_ERROR,c=o.getStatus();if(!l||OV(c,this.additionalRetryCodes_)&&this.retry){const d=o.getErrorCode()===Bo.ABORT;r(!1,new hm(!1,null,d));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new hm(u,o))})},n=(r,s)=>{const o=this.resolve_,i=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());MV(c)?o(c):o()}catch(c){i(c)}else if(l!==null){const c=uE();c.serverResponse=l.getErrorText(),this.errorCallback_?i(this.errorCallback_(l,c)):i(c)}else if(s.canceled){const c=this.appDelete_?TI():_V();i(c)}else{const c=wV();i(c)}};this.canceled_?n(!1,new hm(!1,null,!0)):this.backoffId_=DV(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&LV(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class hm{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function FV(a,e){e!==null&&e.length>0&&(a.Authorization="Firebase "+e)}function zV(a,e){a["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function UV(a,e){e&&(a["X-Firebase-GMPID"]=e)}function $V(a,e){e!==null&&(a["X-Firebase-AppCheck"]=e)}function BV(a,e,n,r,s,o,i=!0){const l=PI(a.urlParams),c=a.url+l,u=Object.assign({},a.headers);return UV(u,e),FV(u,n),zV(u,o),$V(u,r),new jV(c,a.method,u,a.body,a.successCodes,a.additionalRetryCodes,a.handler,a.errorHandler,a.timeout,a.progressCallback,s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qV(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function WV(...a){const e=qV();if(e!==void 0){const n=new e;for(let r=0;r<a.length;r++)n.append(a[r]);return n.getBlob()}else{if(mE())return new Blob(a);throw new pa(ma.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function GV(a,e,n){return a.webkitSlice?a.webkitSlice(e,n):a.mozSlice?a.mozSlice(e,n):a.slice?a.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HV(a){if(typeof atob>"u")throw TV("base-64");return atob(a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Er={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Xf{constructor(e,n){this.data=e,this.contentType=n||null}}function KV(a,e){switch(a){case Er.RAW:return new Xf(RI(e));case Er.BASE64:case Er.BASE64URL:return new Xf(DI(a,e));case Er.DATA_URL:return new Xf(JV(e),YV(e))}throw uE()}function RI(a){const e=[];for(let n=0;n<a.length;n++){let r=a.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<a.length-1&&(a.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const o=r,i=a.charCodeAt(++n);r=65536|(o&1023)<<10|i&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function QV(a){let e;try{e=decodeURIComponent(a)}catch{throw lu(Er.DATA_URL,"Malformed data URL.")}return RI(e)}function DI(a,e){switch(a){case Er.BASE64:{const s=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(s||o)throw lu(a,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Er.BASE64URL:{const s=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(s||o)throw lu(a,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=HV(e)}catch(s){throw s.message.includes("polyfill")?s:lu(a,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class LI{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw lu(Er.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=ZV(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function JV(a){const e=new LI(a);return e.base64?DI(Er.BASE64,e.rest):QV(e.rest)}function YV(a){return new LI(a).contentType}function ZV(a,e){return a.length>=e.length?a.substring(a.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e,n){let r=0,s="";HN(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(HN(this.data_)){const r=this.data_,s=GV(r,e,n);return s===null?null:new Rs(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Rs(r,!0)}}static getBlob(...e){if(mE()){const n=e.map(r=>r instanceof Rs?r.data_:r);return new Rs(WV.apply(null,n))}else{const n=e.map(i=>dE(i)?KV(Er.RAW,i).data:i.data_);let r=0;n.forEach(i=>{r+=i.byteLength});const s=new Uint8Array(r);let o=0;return n.forEach(i=>{for(let l=0;l<i.length;l++)s[o++]=i[l]}),new Rs(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MI(a){let e;try{e=JSON.parse(a)}catch{return null}return VV(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XV(a){if(a.length===0)return null;const e=a.lastIndexOf("/");return e===-1?"":a.slice(0,e)}function eO(a,e){const n=e.split("/").filter(r=>r.length>0).join("/");return a.length===0?n:a+"/"+n}function VI(a){const e=a.lastIndexOf("/",a.length-2);return e===-1?a:a.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tO(a,e){return e}class an{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||tO}}let vm=null;function aO(a){return!dE(a)||a.length<2?a:VI(a)}function OI(){if(vm)return vm;const a=[];a.push(new an("bucket")),a.push(new an("generation")),a.push(new an("metageneration")),a.push(new an("name","fullPath",!0));function e(o,i){return aO(i)}const n=new an("name");n.xform=e,a.push(n);function r(o,i){return i!==void 0?Number(i):i}const s=new an("size");return s.xform=r,a.push(s),a.push(new an("timeCreated")),a.push(new an("updated")),a.push(new an("md5Hash",null,!0)),a.push(new an("cacheControl",null,!0)),a.push(new an("contentDisposition",null,!0)),a.push(new an("contentEncoding",null,!0)),a.push(new an("contentLanguage",null,!0)),a.push(new an("contentType",null,!0)),a.push(new an("metadata","customMetadata",!0)),vm=a,vm}function nO(a,e){function n(){const r=a.bucket,s=a.fullPath,o=new _n(r,s);return e._makeStorageReference(o)}Object.defineProperty(a,"ref",{get:n})}function rO(a,e,n){const r={};r.type="file";const s=n.length;for(let o=0;o<s;o++){const i=n[o];r[i.local]=i.xform(r,e[i.server])}return nO(r,a),r}function jI(a,e,n){const r=MI(e);return r===null?null:rO(a,r,n)}function sO(a,e,n,r){const s=MI(e);if(s===null||!dE(s.downloadTokens))return null;const o=s.downloadTokens;if(o.length===0)return null;const i=encodeURIComponent;return o.split(",").map(u=>{const d=a.bucket,m=a.fullPath,h="/b/"+i(d)+"/o/"+i(m),C=pE(h,n,r),S=PI({alt:"media",token:u});return C+S})[0]}function oO(a,e){const n={},r=e.length;for(let s=0;s<r;s++){const o=e[s];o.writable&&(n[o.server]=a[o.local])}return JSON.stringify(n)}class FI{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zI(a){if(!a)throw uE()}function iO(a,e){function n(r,s){const o=jI(a,s,e);return zI(o!==null),o}return n}function lO(a,e){function n(r,s){const o=jI(a,s,e);return zI(o!==null),sO(o,s,a.host,a._protocol)}return n}function UI(a){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=yV():s=xV():n.getStatus()===402?s=EV(a.bucket):n.getStatus()===403?s=NV(a.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function cO(a){const e=UI(a);function n(r,s){let o=e(r,s);return r.getStatus()===404&&(o=bV(a.path)),o.serverResponse=s.serverResponse,o}return n}function uO(a,e,n){const r=e.fullServerUrl(),s=pE(r,a.host,a._protocol),o="GET",i=a.maxOperationRetryTime,l=new FI(s,o,lO(a,n),i);return l.errorHandler=cO(e),l}function dO(a,e){return a&&a.contentType||e&&e.type()||"application/octet-stream"}function mO(a,e,n){const r=Object.assign({},n);return r.fullPath=a.path,r.size=e.size(),r.contentType||(r.contentType=dO(null,e)),r}function pO(a,e,n,r,s){const o=e.bucketOnlyServerUrl(),i={"X-Goog-Upload-Protocol":"multipart"};function l(){let I="";for(let A=0;A<2;A++)I=I+Math.random().toString().slice(2);return I}const c=l();i["Content-Type"]="multipart/related; boundary="+c;const u=mO(e,r,s),d=oO(u,n),m="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,h=`\r
--`+c+"--",C=Rs.getBlob(m,r,h);if(C===null)throw IV();const S={name:u.fullPath},w=pE(o,a.host,a._protocol),f="POST",b=a.maxUploadRetryTime,v=new FI(w,f,iO(a,n),b);return v.urlParams=S,v.headers=i,v.body=C.uploadData(),v.errorHandler=UI(e),v}class gO{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Bo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Bo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Bo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw Pc("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Pc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Pc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Pc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Pc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class fO extends gO{initXhr(){this.xhr_.responseType="text"}}function $I(){return new fO}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e,n){this._service=e,n instanceof _n?this._location=n:this._location=_n.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new oi(e,n)}get root(){const e=new _n(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return VI(this._location.path)}get storage(){return this._service}get parent(){const e=XV(this._location.path);if(e===null)return null;const n=new _n(this._location.bucket,e);return new oi(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw PV(e)}}function hO(a,e,n){a._throwIfRoot("uploadBytes");const r=pO(a.storage,a._location,OI(),new Rs(e,!0),n);return a.storage.makeRequestWithTokens(r,$I).then(s=>({metadata:s,ref:a}))}function vO(a){a._throwIfRoot("getDownloadURL");const e=uO(a.storage,a._location,OI());return a.storage.makeRequestWithTokens(e,$I).then(n=>{if(n===null)throw AV();return n})}function bO(a,e){const n=eO(a._location.path,e),r=new _n(a._location.bucket,n);return new oi(a.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EO(a){return/^[A-Za-z]+:\/\//.test(a)}function xO(a,e){return new oi(a,e)}function BI(a,e){if(a instanceof gE){const n=a;if(n._bucket==null)throw kV();const r=new oi(n,n._bucket);return e!=null?BI(r,e):r}else return e!==void 0?bO(a,e):a}function yO(a,e){if(e&&EO(e)){if(a instanceof gE)return xO(a,e);throw $0("To use ref(service, url), the first argument must be a Storage instance.")}else return BI(a,e)}function QN(a,e){const n=e==null?void 0:e[AI];return n==null?null:_n.makeFromBucketSpec(n,a)}function NO(a,e,n,r={}){a.host=`${e}:${n}`,a._protocol="http";const{mockUserToken:s}=r;s&&(a._overrideAuthToken=typeof s=="string"?s:fC(s,a.app.options.projectId))}class gE{constructor(e,n,r,s,o){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=o,this._bucket=null,this._host=II,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=hV,this._maxUploadRetryTime=vV,this._requests=new Set,s!=null?this._bucket=_n.makeFromBucketSpec(s,this._host):this._bucket=QN(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=_n.makeFromBucketSpec(this._url,e):this._bucket=QN(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){KN("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){KN("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new oi(this,e)}_makeRequest(e,n,r,s,o=!0){if(this._deleted)return new RV(TI());{const i=BV(e,this._appId,r,s,n,this._firebaseVersion,o);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const JN="@firebase/storage",YN="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qI="storage";function Uu(a,e,n){return a=gt(a),hO(a,e,n)}function jl(a){return a=gt(a),vO(a)}function Fl(a,e){return a=gt(a),yO(a,e)}function wO(a=Eg(),e){a=gt(a);const r=ns(a,qI).getImmediate({identifier:e}),s=mC("storage");return s&&_O(r,...s),r}function _O(a,e,n,r={}){NO(a,e,n,r)}function CO(a,{instanceIdentifier:e}){const n=a.getProvider("app").getImmediate(),r=a.getProvider("auth-internal"),s=a.getProvider("app-check-internal");return new gE(n,r,s,e,fi)}function SO(){ar(new jn(qI,CO,"PUBLIC").setMultipleInstances(!0)),bn(JN,YN,""),bn(JN,YN,"esm2017")}SO();const WI="@firebase/installations",fE="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI=1e4,HI=`w:${fE}`,KI="FIS_v2",kO="https://firebaseinstallations.googleapis.com/v1",IO=60*60*1e3,AO="installations",TO="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PO={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ii=new gi(AO,TO,PO);function QI(a){return a instanceof rr&&a.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JI({projectId:a}){return`${kO}/projects/${a}/installations`}function YI(a){return{token:a.token,requestStatus:2,expiresIn:DO(a.expiresIn),creationTime:Date.now()}}async function ZI(a,e){const r=(await e.json()).error;return ii.create("request-failed",{requestName:a,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function XI({apiKey:a}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":a})}function RO(a,{refreshToken:e}){const n=XI(a);return n.append("Authorization",LO(e)),n}async function eA(a){const e=await a();return e.status>=500&&e.status<600?a():e}function DO(a){return Number(a.replace("s","000"))}function LO(a){return`${KI} ${a}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MO({appConfig:a,heartbeatServiceProvider:e},{fid:n}){const r=JI(a),s=XI(a),o=e.getImmediate({optional:!0});if(o){const u=await o.getHeartbeatsHeader();u&&s.append("x-firebase-client",u)}const i={fid:n,authVersion:KI,appId:a.appId,sdkVersion:HI},l={method:"POST",headers:s,body:JSON.stringify(i)},c=await eA(()=>fetch(r,l));if(c.ok){const u=await c.json();return{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:YI(u.authToken)}}else throw await ZI("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(a){return new Promise(e=>{setTimeout(e,a)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VO(a){return btoa(String.fromCharCode(...a)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OO=/^[cdef][\w-]{21}$/,B0="";function jO(){try{const a=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(a),a[0]=112+a[0]%16;const n=FO(a);return OO.test(n)?n:B0}catch{return B0}}function FO(a){return VO(a).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hg(a){return`${a.appName}!${a.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aA=new Map;function nA(a,e){const n=Hg(a);rA(n,e),zO(n,e)}function rA(a,e){const n=aA.get(a);if(n)for(const r of n)r(e)}function zO(a,e){const n=UO();n&&n.postMessage({key:a,fid:e}),$O()}let Oo=null;function UO(){return!Oo&&"BroadcastChannel"in self&&(Oo=new BroadcastChannel("[Firebase] FID Change"),Oo.onmessage=a=>{rA(a.data.key,a.data.fid)}),Oo}function $O(){aA.size===0&&Oo&&(Oo.close(),Oo=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BO="firebase-installations-database",qO=1,li="firebase-installations-store";let eh=null;function hE(){return eh||(eh=bg(BO,qO,{upgrade:(a,e)=>{switch(e){case 0:a.createObjectStore(li)}}})),eh}async function $p(a,e){const n=Hg(a),s=(await hE()).transaction(li,"readwrite"),o=s.objectStore(li),i=await o.get(n);return await o.put(e,n),await s.done,(!i||i.fid!==e.fid)&&nA(a,e.fid),e}async function sA(a){const e=Hg(a),r=(await hE()).transaction(li,"readwrite");await r.objectStore(li).delete(e),await r.done}async function Kg(a,e){const n=Hg(a),s=(await hE()).transaction(li,"readwrite"),o=s.objectStore(li),i=await o.get(n),l=e(i);return l===void 0?await o.delete(n):await o.put(l,n),await s.done,l&&(!i||i.fid!==l.fid)&&nA(a,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vE(a){let e;const n=await Kg(a.appConfig,r=>{const s=WO(r),o=GO(a,s);return e=o.registrationPromise,o.installationEntry});return n.fid===B0?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function WO(a){const e=a||{fid:jO(),registrationStatus:0};return oA(e)}function GO(a,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(ii.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=HO(a,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:KO(a)}:{installationEntry:e}}async function HO(a,e){try{const n=await MO(a,e);return $p(a.appConfig,n)}catch(n){throw QI(n)&&n.customData.serverCode===409?await sA(a.appConfig):await $p(a.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function KO(a){let e=await ZN(a.appConfig);for(;e.registrationStatus===1;)await tA(100),e=await ZN(a.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await vE(a);return r||n}return e}function ZN(a){return Kg(a,e=>{if(!e)throw ii.create("installation-not-found");return oA(e)})}function oA(a){return QO(a)?{fid:a.fid,registrationStatus:0}:a}function QO(a){return a.registrationStatus===1&&a.registrationTime+GI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JO({appConfig:a,heartbeatServiceProvider:e},n){const r=YO(a,n),s=RO(a,n),o=e.getImmediate({optional:!0});if(o){const u=await o.getHeartbeatsHeader();u&&s.append("x-firebase-client",u)}const i={installation:{sdkVersion:HI,appId:a.appId}},l={method:"POST",headers:s,body:JSON.stringify(i)},c=await eA(()=>fetch(r,l));if(c.ok){const u=await c.json();return YI(u)}else throw await ZI("Generate Auth Token",c)}function YO(a,{fid:e}){return`${JI(a)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bE(a,e=!1){let n;const r=await Kg(a.appConfig,o=>{if(!iA(o))throw ii.create("not-registered");const i=o.authToken;if(!e&&ej(i))return o;if(i.requestStatus===1)return n=ZO(a,e),o;{if(!navigator.onLine)throw ii.create("app-offline");const l=aj(o);return n=XO(a,l),l}});return n?await n:r.authToken}async function ZO(a,e){let n=await XN(a.appConfig);for(;n.authToken.requestStatus===1;)await tA(100),n=await XN(a.appConfig);const r=n.authToken;return r.requestStatus===0?bE(a,e):r}function XN(a){return Kg(a,e=>{if(!iA(e))throw ii.create("not-registered");const n=e.authToken;return nj(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function XO(a,e){try{const n=await JO(a,e),r=Object.assign(Object.assign({},e),{authToken:n});return await $p(a.appConfig,r),n}catch(n){if(QI(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await sA(a.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await $p(a.appConfig,r)}throw n}}function iA(a){return a!==void 0&&a.registrationStatus===2}function ej(a){return a.requestStatus===2&&!tj(a)}function tj(a){const e=Date.now();return e<a.creationTime||a.creationTime+a.expiresIn<e+IO}function aj(a){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},a),{authToken:e})}function nj(a){return a.requestStatus===1&&a.requestTime+GI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rj(a){const e=a,{installationEntry:n,registrationPromise:r}=await vE(e);return r?r.catch(console.error):bE(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sj(a,e=!1){const n=a;return await oj(n),(await bE(n,e)).token}async function oj(a){const{registrationPromise:e}=await vE(a);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ij(a){if(!a||!a.options)throw th("App Configuration");if(!a.name)throw th("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!a.options[n])throw th(n);return{appName:a.name,projectId:a.options.projectId,apiKey:a.options.apiKey,appId:a.options.appId}}function th(a){return ii.create("missing-app-config-values",{valueName:a})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lA="installations",lj="installations-internal",cj=a=>{const e=a.getProvider("app").getImmediate(),n=ij(e),r=ns(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},uj=a=>{const e=a.getProvider("app").getImmediate(),n=ns(e,lA).getImmediate();return{getId:()=>rj(n),getToken:s=>sj(n,s)}};function dj(){ar(new jn(lA,cj,"PUBLIC")),ar(new jn(lj,uj,"PRIVATE"))}dj();bn(WI,fE);bn(WI,fE,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mj="/firebase-messaging-sw.js",pj="/firebase-cloud-messaging-push-scope",cA="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",gj="https://fcmregistrations.googleapis.com/v1",uA="google.c.a.c_id",fj="google.c.a.c_l",hj="google.c.a.ts",vj="google.c.a.e";var ew;(function(a){a[a.DATA_MESSAGE=1]="DATA_MESSAGE",a[a.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(ew||(ew={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var $u;(function(a){a.PUSH_RECEIVED="push-received",a.NOTIFICATION_CLICKED="notification-clicked"})($u||($u={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mr(a){const e=new Uint8Array(a);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function bj(a){const e="=".repeat((4-a.length%4)%4),n=(a+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),s=new Uint8Array(r.length);for(let o=0;o<r.length;++o)s[o]=r.charCodeAt(o);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah="fcm_token_details_db",Ej=5,tw="fcm_token_object_Store";async function xj(a){if("databases"in indexedDB&&!(await indexedDB.databases()).map(o=>o.name).includes(ah))return null;let e=null;return(await bg(ah,Ej,{upgrade:async(r,s,o,i)=>{var l;if(s<2||!r.objectStoreNames.contains(tw))return;const c=i.objectStore(tw),u=await c.index("fcmSenderId").get(a);if(await c.clear(),!!u){if(s===2){const d=u;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:(l=d.createTime)!==null&&l!==void 0?l:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Mr(d.vapidKey)}}}else if(s===3){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Mr(d.auth),p256dh:Mr(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Mr(d.vapidKey)}}}else if(s===4){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Mr(d.auth),p256dh:Mr(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Mr(d.vapidKey)}}}}}})).close(),await Uf(ah),await Uf("fcm_vapid_details_db"),await Uf("undefined"),yj(e)?e:null}function yj(a){if(!a||!a.subscriptionOptions)return!1;const{subscriptionOptions:e}=a;return typeof a.createTime=="number"&&a.createTime>0&&typeof a.token=="string"&&a.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nj="firebase-messaging-database",wj=1,Bu="firebase-messaging-store";let nh=null;function dA(){return nh||(nh=bg(Nj,wj,{upgrade:(a,e)=>{switch(e){case 0:a.createObjectStore(Bu)}}})),nh}async function _j(a){const e=mA(a),r=await(await dA()).transaction(Bu).objectStore(Bu).get(e);if(r)return r;{const s=await xj(a.appConfig.senderId);if(s)return await EE(a,s),s}}async function EE(a,e){const n=mA(a),s=(await dA()).transaction(Bu,"readwrite");return await s.objectStore(Bu).put(e,n),await s.done,e}function mA({appConfig:a}){return a.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cj={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Za=new gi("messaging","Messaging",Cj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sj(a,e){const n=await yE(a),r=pA(e),s={method:"POST",headers:n,body:JSON.stringify(r)};let o;try{o=await(await fetch(xE(a.appConfig),s)).json()}catch(i){throw Za.create("token-subscribe-failed",{errorInfo:i==null?void 0:i.toString()})}if(o.error){const i=o.error.message;throw Za.create("token-subscribe-failed",{errorInfo:i})}if(!o.token)throw Za.create("token-subscribe-no-token");return o.token}async function kj(a,e){const n=await yE(a),r=pA(e.subscriptionOptions),s={method:"PATCH",headers:n,body:JSON.stringify(r)};let o;try{o=await(await fetch(`${xE(a.appConfig)}/${e.token}`,s)).json()}catch(i){throw Za.create("token-update-failed",{errorInfo:i==null?void 0:i.toString()})}if(o.error){const i=o.error.message;throw Za.create("token-update-failed",{errorInfo:i})}if(!o.token)throw Za.create("token-update-no-token");return o.token}async function Ij(a,e){const r={method:"DELETE",headers:await yE(a)};try{const o=await(await fetch(`${xE(a.appConfig)}/${e}`,r)).json();if(o.error){const i=o.error.message;throw Za.create("token-unsubscribe-failed",{errorInfo:i})}}catch(s){throw Za.create("token-unsubscribe-failed",{errorInfo:s==null?void 0:s.toString()})}}function xE({projectId:a}){return`${gj}/projects/${a}/registrations`}async function yE({appConfig:a,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":a.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function pA({p256dh:a,auth:e,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:e,p256dh:a}};return r!==cA&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aj=7*24*60*60*1e3;async function Tj(a){const e=await Rj(a.swRegistration,a.vapidKey),n={vapidKey:a.vapidKey,swScope:a.swRegistration.scope,endpoint:e.endpoint,auth:Mr(e.getKey("auth")),p256dh:Mr(e.getKey("p256dh"))},r=await _j(a.firebaseDependencies);if(r){if(Dj(r.subscriptionOptions,n))return Date.now()>=r.createTime+Aj?Pj(a,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await Ij(a.firebaseDependencies,r.token)}catch(s){console.warn(s)}return aw(a.firebaseDependencies,n)}else return aw(a.firebaseDependencies,n)}async function Pj(a,e){try{const n=await kj(a.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await EE(a.firebaseDependencies,r),n}catch(n){throw n}}async function aw(a,e){const r={token:await Sj(a,e),createTime:Date.now(),subscriptionOptions:e};return await EE(a,r),r.token}async function Rj(a,e){const n=await a.pushManager.getSubscription();return n||a.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:bj(e)})}function Dj(a,e){const n=e.vapidKey===a.vapidKey,r=e.endpoint===a.endpoint,s=e.auth===a.auth,o=e.p256dh===a.p256dh;return n&&r&&s&&o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nw(a){const e={from:a.from,collapseKey:a.collapse_key,messageId:a.fcmMessageId};return Lj(e,a),Mj(e,a),Vj(e,a),e}function Lj(a,e){if(!e.notification)return;a.notification={};const n=e.notification.title;n&&(a.notification.title=n);const r=e.notification.body;r&&(a.notification.body=r);const s=e.notification.image;s&&(a.notification.image=s);const o=e.notification.icon;o&&(a.notification.icon=o)}function Mj(a,e){e.data&&(a.data=e.data)}function Vj(a,e){var n,r,s,o,i;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;a.fcmOptions={};const l=(s=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&s!==void 0?s:(o=e.notification)===null||o===void 0?void 0:o.click_action;l&&(a.fcmOptions.link=l);const c=(i=e.fcmOptions)===null||i===void 0?void 0:i.analytics_label;c&&(a.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oj(a){return typeof a=="object"&&!!a&&uA in a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jj("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function jj(a,e){const n=[];for(let r=0;r<a.length;r++)n.push(a.charAt(r)),r<e.length&&n.push(e.charAt(r));return n.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fj(a){if(!a||!a.options)throw rh("App Configuration Object");if(!a.name)throw rh("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=a;for(const r of e)if(!n[r])throw rh(r);return{appName:a.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function rh(a){return Za.create("missing-app-config-values",{valueName:a})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=Fj(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uj(a){try{a.swRegistration=await navigator.serviceWorker.register(mj,{scope:pj}),a.swRegistration.update().catch(()=>{})}catch(e){throw Za.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $j(a,e){if(!e&&!a.swRegistration&&await Uj(a),!(!e&&a.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Za.create("invalid-sw-registration");a.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bj(a,e){e?a.vapidKey=e:a.vapidKey||(a.vapidKey=cA)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gA(a,e){if(!navigator)throw Za.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw Za.create("permission-blocked");return await Bj(a,e==null?void 0:e.vapidKey),await $j(a,e==null?void 0:e.serviceWorkerRegistration),Tj(a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qj(a,e,n){const r=Wj(e);(await a.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[uA],message_name:n[fj],message_time:n[hj],message_device_time:Math.floor(Date.now()/1e3)})}function Wj(a){switch(a){case $u.NOTIFICATION_CLICKED:return"notification_open";case $u.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gj(a,e){const n=e.data;if(!n.isFirebaseMessaging)return;a.onMessageHandler&&n.messageType===$u.PUSH_RECEIVED&&(typeof a.onMessageHandler=="function"?a.onMessageHandler(nw(n)):a.onMessageHandler.next(nw(n)));const r=n.data;Oj(r)&&r[vj]==="1"&&await qj(a,n.messageType,r)}const rw="@firebase/messaging",sw="0.12.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hj=a=>{const e=new zj(a.getProvider("app").getImmediate(),a.getProvider("installations-internal").getImmediate(),a.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>Gj(e,n)),e},Kj=a=>{const e=a.getProvider("messaging").getImmediate();return{getToken:r=>gA(e,r)}};function Qj(){ar(new jn("messaging",Hj,"PUBLIC")),ar(new jn("messaging-internal",Kj,"PRIVATE")),bn(rw,sw),bn(rw,sw,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jj(){try{await vC()}catch{return!1}return typeof window<"u"&&Zv()&&c4()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(a,e){if(!navigator)throw Za.create("only-available-in-window");return a.onMessageHandler=e,()=>{a.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fA(a=Eg()){return Jj().then(e=>{if(!e)throw Za.create("unsupported-browser")},e=>{throw Za.create("indexed-db-unsupported")}),ns(gt(a),"messaging").getImmediate()}async function hA(a,e){return a=gt(a),gA(a,e)}function vA(a,e){return a=gt(a),Yj(a,e)}Qj();const Zj={apiKey:"AIzaSyAnm8V217rAFWXI5LxxmUEwGI_-Nzbe6RM",authDomain:"huamachuco-c0d9f.firebaseapp.com",projectId:"huamachuco-c0d9f",storageBucket:"huamachuco-c0d9f.firebasestorage.app",messagingSenderId:"159537945910",appId:"1:159537945910:web:f70c13700159f848d1e797",measurementId:"G-CHMV3GKSRM"},Qg=xC(Zj),F=V3(Qg),Pt=iu(Qg),ci=wO(Qg);let Xi=null;if(typeof window<"u"&&"serviceWorker"in navigator)try{Xi=fA(Qg)}catch(a){console.warn("Firebase Messaging no disponible:",a.message)}const Xj="modulepreload",eF=function(a){return"/"+a},ow={},q0=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=eF(o),o in ow)return;ow[o]=!0;const i=o.endsWith(".css"),l=i?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const m=s[d];if(m.href===o&&(!i||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${l}`))return;const u=document.createElement("link");if(u.rel=i?"stylesheet":Xj,i||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),i)return new Promise((d,m)=>{u.addEventListener("load",d),u.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})};var iw="popstate";function tF(a={}){function e(r,s){let{pathname:o,search:i,hash:l}=r.location;return W0("",{pathname:o,search:i,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:qu(s)}return nF(e,n,null,a)}function Xt(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}function zn(a,e){if(!a){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function aF(){return Math.random().toString(36).substring(2,10)}function lw(a,e){return{usr:a.state,key:a.key,idx:e}}function W0(a,e,n=null,r){return{pathname:typeof a=="string"?a:a.pathname,search:"",hash:"",...typeof e=="string"?ec(e):e,state:n,key:e&&e.key||r||aF()}}function qu({pathname:a="/",search:e="",hash:n=""}){return e&&e!=="?"&&(a+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(a+=n.charAt(0)==="#"?n:"#"+n),a}function ec(a){let e={};if(a){let n=a.indexOf("#");n>=0&&(e.hash=a.substring(n),a=a.substring(0,n));let r=a.indexOf("?");r>=0&&(e.search=a.substring(r),a=a.substring(0,r)),a&&(e.pathname=a)}return e}function nF(a,e,n,r={}){let{window:s=document.defaultView,v5Compat:o=!1}=r,i=s.history,l="POP",c=null,u=d();u==null&&(u=0,i.replaceState({...i.state,idx:u},""));function d(){return(i.state||{idx:null}).idx}function m(){l="POP";let f=d(),b=f==null?null:f-u;u=f,c&&c({action:l,location:w.location,delta:b})}function h(f,b){l="PUSH";let v=W0(w.location,f,b);n&&n(v,f),u=d()+1;let I=lw(v,u),A=w.createHref(v);try{i.pushState(I,"",A)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;s.location.assign(A)}o&&c&&c({action:l,location:w.location,delta:1})}function C(f,b){l="REPLACE";let v=W0(w.location,f,b);n&&n(v,f),u=d();let I=lw(v,u),A=w.createHref(v);i.replaceState(I,"",A),o&&c&&c({action:l,location:w.location,delta:0})}function S(f){return rF(f)}let w={get action(){return l},get location(){return a(s,i)},listen(f){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(iw,m),c=f,()=>{s.removeEventListener(iw,m),c=null}},createHref(f){return e(s,f)},createURL:S,encodeLocation(f){let b=S(f);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:h,replace:C,go(f){return i.go(f)}};return w}function rF(a,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Xt(n,"No window.location.(origin|href) available to create URL");let r=typeof a=="string"?a:qu(a);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function bA(a,e,n="/"){return sF(a,e,n,!1)}function sF(a,e,n,r){let s=typeof e=="string"?ec(e):e,o=ts(s.pathname||"/",n);if(o==null)return null;let i=EA(a);oF(i);let l=null;for(let c=0;l==null&&c<i.length;++c){let u=vF(o);l=fF(i[c],u,r)}return l}function EA(a,e=[],n=[],r=""){let s=(o,i,l)=>{let c={relativePath:l===void 0?o.path||"":l,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};c.relativePath.startsWith("/")&&(Xt(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length));let u=Wr([r,c.relativePath]),d=n.concat(c);o.children&&o.children.length>0&&(Xt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),EA(o.children,e,d,u)),!(o.path==null&&!o.index)&&e.push({path:u,score:pF(u,o.index),routesMeta:d})};return a.forEach((o,i)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))s(o,i);else for(let c of xA(o.path))s(o,i,c)}),e}function xA(a){let e=a.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return s?[o,""]:[o];let i=xA(r.join("/")),l=[];return l.push(...i.map(c=>c===""?o:[o,c].join("/"))),s&&l.push(...i),l.map(c=>a.startsWith("/")&&c===""?"/":c)}function oF(a){a.sort((e,n)=>e.score!==n.score?n.score-e.score:gF(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var iF=/^:[\w-]+$/,lF=3,cF=2,uF=1,dF=10,mF=-2,cw=a=>a==="*";function pF(a,e){let n=a.split("/"),r=n.length;return n.some(cw)&&(r+=mF),e&&(r+=cF),n.filter(s=>!cw(s)).reduce((s,o)=>s+(iF.test(o)?lF:o===""?uF:dF),r)}function gF(a,e){return a.length===e.length&&a.slice(0,-1).every((r,s)=>r===e[s])?a[a.length-1]-e[e.length-1]:0}function fF(a,e,n=!1){let{routesMeta:r}=a,s={},o="/",i=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=o==="/"?e:e.slice(o.length)||"/",m=Bp({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!m&&u&&n&&!r[r.length-1].route.index&&(m=Bp({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!m)return null;Object.assign(s,m.params),i.push({params:s,pathname:Wr([o,m.pathname]),pathnameBase:yF(Wr([o,m.pathnameBase])),route:h}),m.pathnameBase!=="/"&&(o=Wr([o,m.pathnameBase]))}return i}function Bp(a,e){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[n,r]=hF(a.path,a.caseSensitive,a.end),s=e.match(n);if(!s)return null;let o=s[0],i=o.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,{paramName:d,isOptional:m},h)=>{if(d==="*"){let S=l[h]||"";i=o.slice(0,o.length-S.length).replace(/(.)\/+$/,"$1")}const C=l[h];return m&&!C?u[d]=void 0:u[d]=(C||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:i,pattern:a}}function hF(a,e=!1,n=!0){zn(a==="*"||!a.endsWith("*")||a.endsWith("/*"),`Route path "${a}" will be treated as if it were "${a.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${a.replace(/\*$/,"/*")}".`);let r=[],s="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return a.endsWith("*")?(r.push({paramName:"*"}),s+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":a!==""&&a!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function vF(a){try{return a.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return zn(!1,`The URL path "${a}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),a}}function ts(a,e){if(e==="/")return a;if(!a.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=a.charAt(n);return r&&r!=="/"?null:a.slice(n)||"/"}function bF(a,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof a=="string"?ec(a):a;return{pathname:n?n.startsWith("/")?n:EF(n,e):e,search:NF(r),hash:wF(s)}}function EF(a,e){let n=e.replace(/\/+$/,"").split("/");return a.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function sh(a,e,n,r){return`Cannot include a '${a}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function xF(a){return a.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function NE(a){let e=xF(a);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function wE(a,e,n,r=!1){let s;typeof a=="string"?s=ec(a):(s={...a},Xt(!s.pathname||!s.pathname.includes("?"),sh("?","pathname","search",s)),Xt(!s.pathname||!s.pathname.includes("#"),sh("#","pathname","hash",s)),Xt(!s.search||!s.search.includes("#"),sh("#","search","hash",s)));let o=a===""||s.pathname==="",i=o?"/":s.pathname,l;if(i==null)l=n;else{let m=e.length-1;if(!r&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),m-=1;s.pathname=h.join("/")}l=m>=0?e[m]:"/"}let c=bF(s,l),u=i&&i!=="/"&&i.endsWith("/"),d=(o||i===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var Wr=a=>a.join("/").replace(/\/\/+/g,"/"),yF=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),NF=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,wF=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a;function _F(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}var yA=["POST","PUT","PATCH","DELETE"];new Set(yA);var CF=["GET",...yA];new Set(CF);var tc=p.createContext(null);tc.displayName="DataRouter";var Jg=p.createContext(null);Jg.displayName="DataRouterState";p.createContext(!1);var NA=p.createContext({isTransitioning:!1});NA.displayName="ViewTransition";var SF=p.createContext(new Map);SF.displayName="Fetchers";var kF=p.createContext(null);kF.displayName="Await";var sr=p.createContext(null);sr.displayName="Navigation";var bd=p.createContext(null);bd.displayName="Location";var or=p.createContext({outlet:null,matches:[],isDataRoute:!1});or.displayName="Route";var _E=p.createContext(null);_E.displayName="RouteError";function IF(a,{relative:e}={}){Xt(ac(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=p.useContext(sr),{hash:s,pathname:o,search:i}=Ed(a,{relative:e}),l=o;return n!=="/"&&(l=o==="/"?n:Wr([n,o])),r.createHref({pathname:l,search:i,hash:s})}function ac(){return p.useContext(bd)!=null}function En(){return Xt(ac(),"useLocation() may be used only in the context of a <Router> component."),p.useContext(bd).location}var wA="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function _A(a){p.useContext(sr).static||p.useLayoutEffect(a)}function Ct(){let{isDataRoute:a}=p.useContext(or);return a?UF():AF()}function AF(){Xt(ac(),"useNavigate() may be used only in the context of a <Router> component.");let a=p.useContext(tc),{basename:e,navigator:n}=p.useContext(sr),{matches:r}=p.useContext(or),{pathname:s}=En(),o=JSON.stringify(NE(r)),i=p.useRef(!1);return _A(()=>{i.current=!0}),p.useCallback((c,u={})=>{if(zn(i.current,wA),!i.current)return;if(typeof c=="number"){n.go(c);return}let d=wE(c,JSON.parse(o),s,u.relative==="path");a==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Wr([e,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[e,n,o,s,a])}p.createContext(null);function Ni(){let{matches:a}=p.useContext(or),e=a[a.length-1];return e?e.params:{}}function Ed(a,{relative:e}={}){let{matches:n}=p.useContext(or),{pathname:r}=En(),s=JSON.stringify(NE(n));return p.useMemo(()=>wE(a,JSON.parse(s),r,e==="path"),[a,s,r,e])}function TF(a,e){return CA(a,e)}function CA(a,e,n,r){var b;Xt(ac(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=p.useContext(sr),{matches:o}=p.useContext(or),i=o[o.length-1],l=i?i.params:{},c=i?i.pathname:"/",u=i?i.pathnameBase:"/",d=i&&i.route;{let v=d&&d.path||"";SA(c,!d||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let m=En(),h;if(e){let v=typeof e=="string"?ec(e):e;Xt(u==="/"||((b=v.pathname)==null?void 0:b.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${v.pathname}" was given in the \`location\` prop.`),h=v}else h=m;let C=h.pathname||"/",S=C;if(u!=="/"){let v=u.replace(/^\//,"").split("/");S="/"+C.replace(/^\//,"").split("/").slice(v.length).join("/")}let w=bA(a,{pathname:S});zn(d||w!=null,`No routes matched location "${h.pathname}${h.search}${h.hash}" `),zn(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${h.pathname}${h.search}${h.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let f=MF(w&&w.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:Wr([u,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?u:Wr([u,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,n,r);return e&&f?p.createElement(bd.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...h},navigationType:"POP"}},f):f}function PF(){let a=zF(),e=_F(a)?`${a.status} ${a.statusText}`:a instanceof Error?a.message:JSON.stringify(a),n=a instanceof Error?a.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},i=null;return console.error("Error handled by React Router default ErrorBoundary:",a),i=p.createElement(p.Fragment,null,p.createElement("p",null,"💿 Hey developer 👋"),p.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",p.createElement("code",{style:o},"ErrorBoundary")," or"," ",p.createElement("code",{style:o},"errorElement")," prop on your route.")),p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},e),n?p.createElement("pre",{style:s},n):null,i)}var RF=p.createElement(PF,null),DF=class extends p.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,e){return e.location!==a.location||e.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:e.error,location:e.location,revalidation:a.revalidation||e.revalidation}}componentDidCatch(a,e){console.error("React Router caught the following error during render",a,e)}render(){return this.state.error!==void 0?p.createElement(or.Provider,{value:this.props.routeContext},p.createElement(_E.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function LF({routeContext:a,match:e,children:n}){let r=p.useContext(tc);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),p.createElement(or.Provider,{value:a},n)}function MF(a,e=[],n=null,r=null){if(a==null){if(!n)return null;if(n.errors)a=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)a=n.matches;else return null}let s=a,o=n==null?void 0:n.errors;if(o!=null){let c=s.findIndex(u=>u.route.id&&(o==null?void 0:o[u.route.id])!==void 0);Xt(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,c+1))}let i=!1,l=-1;if(n)for(let c=0;c<s.length;c++){let u=s[c];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(l=c),u.route.id){let{loaderData:d,errors:m}=n,h=u.route.loader&&!d.hasOwnProperty(u.route.id)&&(!m||m[u.route.id]===void 0);if(u.route.lazy||h){i=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((c,u,d)=>{let m,h=!1,C=null,S=null;n&&(m=o&&u.route.id?o[u.route.id]:void 0,C=u.route.errorElement||RF,i&&(l<0&&d===0?(SA("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,S=null):l===d&&(h=!0,S=u.route.hydrateFallbackElement||null)));let w=e.concat(s.slice(0,d+1)),f=()=>{let b;return m?b=C:h?b=S:u.route.Component?b=p.createElement(u.route.Component,null):u.route.element?b=u.route.element:b=c,p.createElement(LF,{match:u,routeContext:{outlet:c,matches:w,isDataRoute:n!=null},children:b})};return n&&(u.route.ErrorBoundary||u.route.errorElement||d===0)?p.createElement(DF,{location:n.location,revalidation:n.revalidation,component:C,error:m,children:f(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):f()},null)}function CE(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function VF(a){let e=p.useContext(tc);return Xt(e,CE(a)),e}function OF(a){let e=p.useContext(Jg);return Xt(e,CE(a)),e}function jF(a){let e=p.useContext(or);return Xt(e,CE(a)),e}function SE(a){let e=jF(a),n=e.matches[e.matches.length-1];return Xt(n.route.id,`${a} can only be used on routes that contain a unique "id"`),n.route.id}function FF(){return SE("useRouteId")}function zF(){var r;let a=p.useContext(_E),e=OF("useRouteError"),n=SE("useRouteError");return a!==void 0?a:(r=e.errors)==null?void 0:r[n]}function UF(){let{router:a}=VF("useNavigate"),e=SE("useNavigate"),n=p.useRef(!1);return _A(()=>{n.current=!0}),p.useCallback(async(s,o={})=>{zn(n.current,wA),n.current&&(typeof s=="number"?a.navigate(s):await a.navigate(s,{fromRouteId:e,...o}))},[a,e])}var uw={};function SA(a,e,n){!e&&!uw[a]&&(uw[a]=!0,zn(!1,n))}p.memo($F);function $F({routes:a,future:e,state:n}){return CA(a,void 0,n,e)}function kA({to:a,replace:e,state:n,relative:r}){Xt(ac(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=p.useContext(sr);zn(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=p.useContext(or),{pathname:i}=En(),l=Ct(),c=wE(a,NE(o),i,r==="path"),u=JSON.stringify(c);return p.useEffect(()=>{l(JSON.parse(u),{replace:e,state:n,relative:r})},[l,u,r,e,n]),null}function De(a){Xt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function BF({basename:a="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:o=!1}){Xt(!ac(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=a.replace(/^\/*/,"/"),l=p.useMemo(()=>({basename:i,navigator:s,static:o,future:{}}),[i,s,o]);typeof n=="string"&&(n=ec(n));let{pathname:c="/",search:u="",hash:d="",state:m=null,key:h="default"}=n,C=p.useMemo(()=>{let S=ts(c,i);return S==null?null:{location:{pathname:S,search:u,hash:d,state:m,key:h},navigationType:r}},[i,c,u,d,m,h,r]);return zn(C!=null,`<Router basename="${i}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),C==null?null:p.createElement(sr.Provider,{value:l},p.createElement(bd.Provider,{children:e,value:C}))}function IA({children:a,location:e}){return TF(G0(a),e)}function G0(a,e=[]){let n=[];return p.Children.forEach(a,(r,s)=>{if(!p.isValidElement(r))return;let o=[...e,s];if(r.type===p.Fragment){n.push.apply(n,G0(r.props.children,o));return}Xt(r.type===De,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Xt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let i={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=G0(r.props.children,o)),n.push(i)}),n}var Km="get",Qm="application/x-www-form-urlencoded";function Yg(a){return a!=null&&typeof a.tagName=="string"}function qF(a){return Yg(a)&&a.tagName.toLowerCase()==="button"}function WF(a){return Yg(a)&&a.tagName.toLowerCase()==="form"}function GF(a){return Yg(a)&&a.tagName.toLowerCase()==="input"}function HF(a){return!!(a.metaKey||a.altKey||a.ctrlKey||a.shiftKey)}function KF(a,e){return a.button===0&&(!e||e==="_self")&&!HF(a)}function H0(a=""){return new URLSearchParams(typeof a=="string"||Array.isArray(a)||a instanceof URLSearchParams?a:Object.keys(a).reduce((e,n)=>{let r=a[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function QF(a,e){let n=H0(a);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(o=>{n.append(s,o)})}),n}var bm=null;function JF(){if(bm===null)try{new FormData(document.createElement("form"),0),bm=!1}catch{bm=!0}return bm}var YF=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function oh(a){return a!=null&&!YF.has(a)?(zn(!1,`"${a}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Qm}"`),null):a}function ZF(a,e){let n,r,s,o,i;if(WF(a)){let l=a.getAttribute("action");r=l?ts(l,e):null,n=a.getAttribute("method")||Km,s=oh(a.getAttribute("enctype"))||Qm,o=new FormData(a)}else if(qF(a)||GF(a)&&(a.type==="submit"||a.type==="image")){let l=a.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=a.getAttribute("formaction")||l.getAttribute("action");if(r=c?ts(c,e):null,n=a.getAttribute("formmethod")||l.getAttribute("method")||Km,s=oh(a.getAttribute("formenctype"))||oh(l.getAttribute("enctype"))||Qm,o=new FormData(l,a),!JF()){let{name:u,type:d,value:m}=a;if(d==="image"){let h=u?`${u}.`:"";o.append(`${h}x`,"0"),o.append(`${h}y`,"0")}else u&&o.append(u,m)}}else{if(Yg(a))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Km,r=null,s=Qm,i=a}return o&&s==="text/plain"&&(i=o,o=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:o,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function kE(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}function XF(a,e,n){let r=typeof a=="string"?new URL(a,typeof window>"u"?"server://singlefetch/":window.location.origin):a;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&ts(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function ez(a,e){if(a.id in e)return e[a.id];try{let n=await q0(()=>import(a.module),[]);return e[a.id]=n,n}catch(n){return console.error(`Error loading route module \`${a.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function tz(a){return a!=null&&typeof a.page=="string"}function az(a){return a==null?!1:a.href==null?a.rel==="preload"&&typeof a.imageSrcSet=="string"&&typeof a.imageSizes=="string":typeof a.rel=="string"&&typeof a.href=="string"}async function nz(a,e,n){let r=await Promise.all(a.map(async s=>{let o=e.routes[s.route.id];if(o){let i=await ez(o,n);return i.links?i.links():[]}return[]}));return iz(r.flat(1).filter(az).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function dw(a,e,n,r,s,o){let i=(c,u)=>n[u]?c.route.id!==n[u].route.id:!0,l=(c,u)=>{var d;return n[u].pathname!==c.pathname||((d=n[u].route.path)==null?void 0:d.endsWith("*"))&&n[u].params["*"]!==c.params["*"]};return o==="assets"?e.filter((c,u)=>i(c,u)||l(c,u)):o==="data"?e.filter((c,u)=>{var m;let d=r.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(i(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let h=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((m=n[0])==null?void 0:m.params)||{},nextUrl:new URL(a,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof h=="boolean")return h}return!0}):[]}function rz(a,e,{includeHydrateFallback:n}={}){return sz(a.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let o=[s.module];return s.clientActionModule&&(o=o.concat(s.clientActionModule)),s.clientLoaderModule&&(o=o.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(o=o.concat(s.hydrateFallbackModule)),s.imports&&(o=o.concat(s.imports)),o}).flat(1))}function sz(a){return[...new Set(a)]}function oz(a){let e={},n=Object.keys(a).sort();for(let r of n)e[r]=a[r];return e}function iz(a,e){let n=new Set,r=new Set(e);return a.reduce((s,o)=>{if(e&&!tz(o)&&o.as==="script"&&o.href&&r.has(o.href))return s;let l=JSON.stringify(oz(o));return n.has(l)||(n.add(l),s.push({key:l,link:o})),s},[])}function AA(){let a=p.useContext(tc);return kE(a,"You must render this element inside a <DataRouterContext.Provider> element"),a}function lz(){let a=p.useContext(Jg);return kE(a,"You must render this element inside a <DataRouterStateContext.Provider> element"),a}var IE=p.createContext(void 0);IE.displayName="FrameworkContext";function TA(){let a=p.useContext(IE);return kE(a,"You must render this element inside a <HydratedRouter> element"),a}function cz(a,e){let n=p.useContext(IE),[r,s]=p.useState(!1),[o,i]=p.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:m}=e,h=p.useRef(null);p.useEffect(()=>{if(a==="render"&&i(!0),a==="viewport"){let w=b=>{b.forEach(v=>{i(v.isIntersecting)})},f=new IntersectionObserver(w,{threshold:.5});return h.current&&f.observe(h.current),()=>{f.disconnect()}}},[a]),p.useEffect(()=>{if(r){let w=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(w)}}},[r]);let C=()=>{s(!0)},S=()=>{s(!1),i(!1)};return n?a!=="intent"?[o,h,{}]:[o,h,{onFocus:Rc(l,C),onBlur:Rc(c,S),onMouseEnter:Rc(u,C),onMouseLeave:Rc(d,S),onTouchStart:Rc(m,C)}]:[!1,h,{}]}function Rc(a,e){return n=>{a&&a(n),n.defaultPrevented||e(n)}}function uz({page:a,...e}){let{router:n}=AA(),r=p.useMemo(()=>bA(n.routes,a,n.basename),[n.routes,a,n.basename]);return r?p.createElement(mz,{page:a,matches:r,...e}):null}function dz(a){let{manifest:e,routeModules:n}=TA(),[r,s]=p.useState([]);return p.useEffect(()=>{let o=!1;return nz(a,e,n).then(i=>{o||s(i)}),()=>{o=!0}},[a,e,n]),r}function mz({page:a,matches:e,...n}){let r=En(),{manifest:s,routeModules:o}=TA(),{basename:i}=AA(),{loaderData:l,matches:c}=lz(),u=p.useMemo(()=>dw(a,e,c,s,r,"data"),[a,e,c,s,r]),d=p.useMemo(()=>dw(a,e,c,s,r,"assets"),[a,e,c,s,r]),m=p.useMemo(()=>{if(a===r.pathname+r.search+r.hash)return[];let S=new Set,w=!1;if(e.forEach(b=>{var I;let v=s.routes[b.route.id];!v||!v.hasLoader||(!u.some(A=>A.route.id===b.route.id)&&b.route.id in l&&((I=o[b.route.id])!=null&&I.shouldRevalidate)||v.hasClientLoader?w=!0:S.add(b.route.id))}),S.size===0)return[];let f=XF(a,i,"data");return w&&S.size>0&&f.searchParams.set("_routes",e.filter(b=>S.has(b.route.id)).map(b=>b.route.id).join(",")),[f.pathname+f.search]},[i,l,r,s,u,e,a,o]),h=p.useMemo(()=>rz(d,s),[d,s]),C=dz(d);return p.createElement(p.Fragment,null,m.map(S=>p.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...n})),h.map(S=>p.createElement("link",{key:S,rel:"modulepreload",href:S,...n})),C.map(({key:S,link:w})=>p.createElement("link",{key:S,...w})))}function pz(...a){return e=>{a.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var PA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{PA&&(window.__reactRouterVersion="7.7.0")}catch{}function gz({basename:a,children:e,window:n}){let r=p.useRef();r.current==null&&(r.current=tF({window:n,v5Compat:!0}));let s=r.current,[o,i]=p.useState({action:s.action,location:s.location}),l=p.useCallback(c=>{p.startTransition(()=>i(c))},[i]);return p.useLayoutEffect(()=>s.listen(l),[s,l]),p.createElement(BF,{basename:a,children:e,location:o.location,navigationType:o.action,navigator:s})}var RA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,cu=p.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:o,replace:i,state:l,target:c,to:u,preventScrollReset:d,viewTransition:m,...h},C){let{basename:S}=p.useContext(sr),w=typeof u=="string"&&RA.test(u),f,b=!1;if(typeof u=="string"&&w&&(f=u,PA))try{let _=new URL(window.location.href),P=u.startsWith("//")?new URL(_.protocol+u):new URL(u),k=ts(P.pathname,S);P.origin===_.origin&&k!=null?u=k+P.search+P.hash:b=!0}catch{zn(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let v=IF(u,{relative:s}),[I,A,N]=cz(r,h),x=bz(u,{replace:i,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:m});function y(_){e&&e(_),_.defaultPrevented||x(_)}let E=p.createElement("a",{...h,...N,href:f||v,onClick:b||o?e:y,ref:pz(C,A),target:c,"data-discover":!w&&n==="render"?"true":void 0});return I&&!w?p.createElement(p.Fragment,null,E,p.createElement(uz,{page:v})):E});cu.displayName="Link";var fz=p.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:o,to:i,viewTransition:l,children:c,...u},d){let m=Ed(i,{relative:u.relative}),h=En(),C=p.useContext(Jg),{navigator:S,basename:w}=p.useContext(sr),f=C!=null&&_z(m)&&l===!0,b=S.encodeLocation?S.encodeLocation(m).pathname:m.pathname,v=h.pathname,I=C&&C.navigation&&C.navigation.location?C.navigation.location.pathname:null;n||(v=v.toLowerCase(),I=I?I.toLowerCase():null,b=b.toLowerCase()),I&&w&&(I=ts(I,w)||I);const A=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let N=v===b||!s&&v.startsWith(b)&&v.charAt(A)==="/",x=I!=null&&(I===b||!s&&I.startsWith(b)&&I.charAt(b.length)==="/"),y={isActive:N,isPending:x,isTransitioning:f},E=N?e:void 0,_;typeof r=="function"?_=r(y):_=[r,N?"active":null,x?"pending":null,f?"transitioning":null].filter(Boolean).join(" ");let P=typeof o=="function"?o(y):o;return p.createElement(cu,{...u,"aria-current":E,className:_,ref:d,style:P,to:i,viewTransition:l},typeof c=="function"?c(y):c)});fz.displayName="NavLink";var hz=p.forwardRef(({discover:a="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:o,method:i=Km,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:m,...h},C)=>{let S=Nz(),w=wz(l,{relative:u}),f=i.toLowerCase()==="get"?"get":"post",b=typeof l=="string"&&RA.test(l),v=I=>{if(c&&c(I),I.defaultPrevented)return;I.preventDefault();let A=I.nativeEvent.submitter,N=(A==null?void 0:A.getAttribute("formmethod"))||i;S(A||I.currentTarget,{fetcherKey:e,method:N,navigate:n,replace:s,state:o,relative:u,preventScrollReset:d,viewTransition:m})};return p.createElement("form",{ref:C,method:f,action:w,onSubmit:r?c:v,...h,"data-discover":!b&&a==="render"?"true":void 0})});hz.displayName="Form";function vz(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function DA(a){let e=p.useContext(tc);return Xt(e,vz(a)),e}function bz(a,{target:e,replace:n,state:r,preventScrollReset:s,relative:o,viewTransition:i}={}){let l=Ct(),c=En(),u=Ed(a,{relative:o});return p.useCallback(d=>{if(KF(d,e)){d.preventDefault();let m=n!==void 0?n:qu(c)===qu(u);l(a,{replace:m,state:r,preventScrollReset:s,relative:o,viewTransition:i})}},[c,l,u,n,r,e,a,s,o,i])}function Ez(a){zn(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=p.useRef(H0(a)),n=p.useRef(!1),r=En(),s=p.useMemo(()=>QF(r.search,n.current?null:e.current),[r.search]),o=Ct(),i=p.useCallback((l,c)=>{const u=H0(typeof l=="function"?l(new URLSearchParams(s)):l);n.current=!0,o("?"+u,c)},[o,s]);return[s,i]}var xz=0,yz=()=>`__${String(++xz)}__`;function Nz(){let{router:a}=DA("useSubmit"),{basename:e}=p.useContext(sr),n=FF();return p.useCallback(async(r,s={})=>{let{action:o,method:i,encType:l,formData:c,body:u}=ZF(r,e);if(s.navigate===!1){let d=s.fetcherKey||yz();await a.fetch(d,n,s.action||o,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||i,formEncType:s.encType||l,flushSync:s.flushSync})}else await a.navigate(s.action||o,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||i,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[a,e,n])}function wz(a,{relative:e}={}){let{basename:n}=p.useContext(sr),r=p.useContext(or);Xt(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),o={...Ed(a||".",{relative:e})},i=En();if(a==null){o.search=i.search;let l=new URLSearchParams(o.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(m=>m).forEach(m=>l.append("index",m));let d=l.toString();o.search=d?`?${d}`:""}}return(!a||a===".")&&s.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:Wr([n,o.pathname])),qu(o)}function _z(a,e={}){let n=p.useContext(NA);Xt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=DA("useViewTransitionState"),s=Ed(a,{relative:e.relative});if(!n.isTransitioning)return!1;let o=ts(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=ts(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Bp(s.pathname,i)!=null||Bp(s.pathname,o)!=null}const mw=[{to:"",label:"🏠 Panel Principal",icon:"🏠",section:"main"},{to:"servicios/seguros",label:"🛡️ Seguros",icon:"🛡️",section:"servicios"},{to:"servicios/revision-tecnica",label:"🔧 Revisión Técnica",icon:"🔧",section:"servicios"},{to:"servicios/vulcanizaciones",label:"🏁 Vulcanizaciones",icon:"🏁",section:"servicios"},{to:"servicios/reciclaje",label:"♻️ Reciclaje",icon:"♻️",section:"servicios"},{to:"recordatorios",label:"🔔 Mis Recordatorios",icon:"🔔",section:"servicios"},{to:"solicitudes-registro",label:"📋 Solicitudes de Registro",icon:"📋",section:"admin"},{to:"empresas",label:"🏢 Empresas Registradas",icon:"🏢",section:"admin"},{to:"solicitudes-cliente",label:"� Solicitudes de Clientes",icon:"�",section:"admin"},{to:"validacion-clientes",label:"✅ Validación de Clientes",icon:"✅",section:"admin"},{to:"solicitudes-comunidad",label:"🤝 Solicitudes de Comunidad",icon:"🤝",section:"admin"},{to:"marcas",label:"🏷️ Gestión de Marcas",icon:"🏷️",section:"admin"},{to:"tipos-empresa",label:"🏢 Tipos de Empresa",icon:"🏢",section:"admin"},{to:"categorias",label:"� Gestión de Categorías",icon:"�",section:"admin"},{to:"moderacion-reseñas",label:"⭐ Moderación Reseñas",icon:"⭐",section:"admin"},{to:"gestion-tickets",label:"🎫 Gestión de Tickets",icon:"🎫",section:"admin"},{to:"notificaciones",label:"📱 Notificaciones Push",icon:"📱",section:"admin"},{to:"estadisticas",label:"� Panel de Estadísticas",icon:"�",section:"admin"},{to:"recursos-educativos",label:"� Recursos Educativos",icon:"�",section:"admin"},{to:"configuracion-sistema",label:"⚙️ Configuración Sistema",icon:"⚙️",section:"admin"},{to:"crear-empresa-publica",label:"➕ Crear Empresa Pública",icon:"➕",section:"empresas"},{to:"panel-validacion",label:"🔍 Panel de Validación",icon:"🔍",section:"empresas"},{to:"gestion-agentes",label:"👥 Gestión de Agentes",icon:"👥",section:"empresas"}],pw=[{to:"/empresa",label:"Panel",icon:"📊"},{to:"/empresa/mi-empresa",label:"Mi Empresa",icon:"🏢"},{to:"/empresa/solicitar-campana",label:"Solicitar Campaña",icon:"📢"},{to:"/empresa/solicitar-producto",label:"Solicitar Producto",icon:"📦"}],Cz=[{to:"/dashboard/agente",label:"Mi Dashboard",icon:"🗂"},{to:"/agente/nueva-empresa",label:"Registrar Empresa Validada",icon:"✅"}];function Sz({rol:a}){const e=En(),n=Ct(),[r,s]=p.useState(!1);let o;a==="admin"?o=mw:a==="proveedor"?o=pw:a==="agente"?o=Cz:o=pw;const i=e.pathname.startsWith("/admin"),l=m=>{const h={};return m.forEach(C=>{const S=C.section||"default";h[S]||(h[S]=[]),h[S].push(C)}),h},c={main:"PANEL PRINCIPAL",servicios:"SERVICIOS",admin:"ADMINISTRACIÓN",empresas:"GESTIÓN DE EMPRESAS"},u=()=>{s(!r)},d=m=>{n(a==="admin"&&i?m===""?"/admin":`/admin/${m}`:m)};return t.createElement("aside",{className:`bg-blue-900 text-white min-h-screen flex-shrink-0 overflow-y-auto transition-all duration-300 ${r?"w-16":"w-64"}`},t.createElement("div",{className:`p-4 border-b border-blue-800 flex items-center justify-between ${r?"px-2":""}`},!r&&t.createElement("div",{className:"text-xl font-bold tracking-wider"},"🚗 AV10 de Julio",t.createElement("div",{className:"text-xs font-normal text-blue-200 mt-1"},"Panel de Administración")),t.createElement("button",{onClick:u,className:"text-white hover:bg-blue-800 p-2 rounded-lg transition-colors",title:r?"Expandir menú":"Contraer menú"},r?"☰":"◀")),t.createElement("nav",{className:"mt-4"},a==="admin"?Object.entries(l(mw)).map(([m,h])=>t.createElement("div",{key:m,className:"mb-4"},m!=="main"&&!r&&t.createElement("div",{className:"px-4 py-2 text-xs font-semibold text-blue-200 uppercase tracking-wider border-t border-blue-800 mt-4 pt-4"},c[m]),t.createElement("div",{className:"flex flex-col gap-1 mt-4"},h.map(C=>{const S=e.pathname===(i?`/admin/${C.to}`:C.to);return t.createElement("button",{key:C.to,onClick:()=>d(C.to),className:`w-full px-4 py-2 mx-2 hover:bg-blue-800 rounded-lg transition-all flex items-center gap-3 ${S?"bg-blue-800 font-semibold border-l-4 border-blue-300":"hover:border-l-4 hover:border-blue-400"} ${r?"justify-center px-2":""}`,title:r?C.label:""},t.createElement("span",{className:"text-lg"},C.icon),!r&&t.createElement("span",{className:"text-left"},C.label.replace(C.icon,"").trim()))})))):t.createElement("div",{className:"flex flex-col gap-1 mt-4"},o.map(m=>{const h=e.pathname===m.to;return t.createElement("button",{key:m.to,onClick:()=>n(m.to),className:`w-full px-4 py-2 mx-2 hover:bg-blue-800 rounded-lg transition-all flex items-center gap-3 ${h?"bg-blue-800 font-semibold border-l-4 border-blue-300":"hover:border-l-4 hover:border-blue-400"} ${r?"justify-center px-2":""}`,title:r?m.label:""},t.createElement("span",{className:"text-lg"},m.icon),!r&&t.createElement("span",{className:"text-left"},m.label))}))))}const LA=p.createContext();function ht(){return p.useContext(LA)}function kz({children:a}){const[e,n]=p.useState(null),[r,s]=p.useState(null),[o,i]=p.useState(!0),[l,c]=p.useState(null);return p.useEffect(()=>iE(Pt,async d=>{try{if(d){console.log("Usuario logueado:",d.email,"UID:",d.uid);let m=await en(Ne(F,"usuarios",d.uid));if(m.exists()){const h=m.data();console.log("✅ Usuario encontrado en usuarios por UID:",h),s(h.rol)}else{console.log("❌ Usuario no encontrado en usuarios por UID, buscando por email...");const h=fe(W(F,"usuarios"),pe("email","==",d.email),Ot(1)),C=await le(h);if(C.empty)console.log("❌ Usuario no encontrado en usuarios por email ni UID"),s(null);else{const S=C.docs[0],w=S.data();console.log("✅ Usuario encontrado en usuarios por email:",w),console.log("⚠️ UID en Firestore:",S.id,"vs UID de Auth:",d.uid),s(w.rol)}}n(d)}else console.log("Usuario no logueado"),n(null),s(null)}catch(m){console.error("Error en AuthProvider:",m),c(m.message)}finally{i(!1)}}),[]),t.createElement(LA.Provider,{value:{user:e,rol:r,loading:o,error:l}},a)}function Iz(){const{user:a,rol:e}=ht();return Ct(),t.createElement("header",{className:"flex items-center justify-between bg-blue-50 border-b px-8 h-16"},t.createElement("div",{className:"font-bold text-blue-900 text-lg"},"Panel ",e==="admin"?"Administrador":"Proveedor"),t.createElement("div",{className:"flex items-center gap-4"},t.createElement("span",{className:"text-blue-800"},a==null?void 0:a.email)))}function Az(){var S,w;const{user:a,rol:e,logout:n}=ht(),r=Ct(),s=En(),[o,i]=p.useState(!1),[l,c]=p.useState([]);p.useEffect(()=>{i(!1)},[s.pathname]);const u=()=>{i(!o)},d=async()=>{try{await n(),r("/login")}catch(f){console.error("Error al cerrar sesión:",f)}},m=()=>{const f=[{path:"/",label:"Inicio",icon:"home"},{path:"/productos",label:"Productos",icon:"shopping-bag"},{path:"/contacto",label:"Contacto",icon:"phone"}];if(!a)return[...f,{path:"/login",label:"Iniciar Sesión",icon:"log-in"},{path:"/registro-cliente",label:"Registro Cliente",icon:"user-plus"},{path:"/registro-proveedor",label:"Registro Proveedor",icon:"building"}];const b={admin:[{path:"/admin",label:"Panel Admin",icon:"settings"},{path:"/admin/empresas",label:"Empresas",icon:"building"},{path:"/admin/solicitudes-cliente",label:"Solicitudes Cliente",icon:"users"},{path:"/admin/agentes-campo",label:"Agentes",icon:"map-pin"}],cliente:[{path:"/dashboard/cliente",label:"Mi Dashboard",icon:"home"},{path:"/vehiculos/gestionar",label:"Mis Vehículos",icon:"truck"},{path:"/status-cliente",label:"Mi Estado",icon:"check-circle"}],proveedor:[{path:"/dashboard/proveedor",label:"Mi Dashboard",icon:"home"},{path:"/proveedores/mi-empresa",label:"Mi Empresa",icon:"building"},{path:"/clientes-area",label:"Clientes del Área",icon:"users"},{path:"/proveedores/solicitar-campana",label:"Nueva Campaña",icon:"megaphone"}],agente:[{path:"/dashboard/agente",label:"Panel Agente",icon:"map-pin"},{path:"/dashboard/agente",label:"Empresas Asignadas",icon:"building"}]};return[...f,...b[e]||[]]},h=()=>({"/":"AV10 de Julio","/admin":"Panel Administrativo","/dashboard/cliente":"Dashboard Cliente","/dashboard/proveedor":"Dashboard Proveedor","/dashboard/agente":"Panel Agente","/vehiculos/gestionar":"Mis Vehículos","/productos":"Productos","/contacto":"Contacto"})[s.pathname]||"AV10 de Julio",C=(f,b="w-5 h-5")=>{const v={home:t.createElement("svg",{className:b,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})),users:t.createElement("svg",{className:b,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})),building:t.createElement("svg",{className:b,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})),truck:t.createElement("svg",{className:b,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})),"map-pin":t.createElement("svg",{className:b,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})),settings:t.createElement("svg",{className:b,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})),"shopping-bag":t.createElement("svg",{className:b,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l-1 12H6L5 9z"})),phone:t.createElement("svg",{className:b,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})),"log-in":t.createElement("svg",{className:b,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})),"user-plus":t.createElement("svg",{className:b,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})),"check-circle":t.createElement("svg",{className:b,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})),megaphone:t.createElement("svg",{className:b,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"})),"log-out":t.createElement("svg",{className:b,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})),bell:t.createElement("svg",{className:b,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-5 5v-5zM9.586 17H3l6.586-6.586a2 2 0 010-2.828l6.414-6.414a2 2 0 012.828 0l2.586 2.586a2 2 0 010 2.828L15 13.414V17z"}))};return v[f]||v.home};return t.createElement(t.Fragment,null,t.createElement("header",{className:"header-mobile bg-white border-b border-gray-200 fixed top-0 left-0 right-0 z-50"},t.createElement("div",{className:"flex items-center justify-between h-full"},t.createElement("button",{onClick:u,className:`hamburger ${o?"open":""}`,"aria-label":"Abrir menú"},t.createElement("span",null),t.createElement("span",null),t.createElement("span",null)),t.createElement("div",{className:"flex items-center space-x-3"},t.createElement("img",{src:"/logo192.png",alt:"AV10 de Julio",className:"h-8 w-8"}),t.createElement("h1",{className:"text-lg font-semibold text-gray-900 truncate"},h())),t.createElement("div",{className:"flex items-center space-x-2"},a&&t.createElement(t.Fragment,null,t.createElement("button",{className:"p-2 text-gray-600 hover:text-gray-900 relative"},C("bell","w-5 h-5"),l.length>0&&t.createElement("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center"},l.length>9?"9+":l.length)),t.createElement("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center text-sm font-medium"},(S=a.email)==null?void 0:S.charAt(0).toUpperCase()))))),t.createElement("div",{className:`sidebar-overlay ${o?"visible":""}`,onClick:()=>i(!1)}),t.createElement("nav",{className:`sidebar-mobile ${o?"open":""}`},t.createElement("div",{className:"p-4"},t.createElement("div",{className:"flex items-center justify-between mb-6"},t.createElement("div",{className:"flex items-center space-x-3"},t.createElement("img",{src:"/logo192.png",alt:"AV10 de Julio",className:"h-8 w-8"}),t.createElement("span",{className:"text-lg font-bold text-gray-900"},"AV10 de Julio")),t.createElement("button",{onClick:()=>i(!1),className:"p-1 text-gray-500 hover:text-gray-700"},t.createElement("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})))),a&&t.createElement("div",{className:"bg-gray-50 rounded-lg p-4 mb-6"},t.createElement("div",{className:"flex items-center space-x-3"},t.createElement("div",{className:"w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center text-sm font-medium"},(w=a.email)==null?void 0:w.charAt(0).toUpperCase()),t.createElement("div",{className:"flex-1 min-w-0"},t.createElement("p",{className:"text-sm font-medium text-gray-900 truncate"},a.email),t.createElement("p",{className:"text-xs text-gray-500 capitalize"},e)))),t.createElement("div",{className:"space-y-2"},m().map((f,b)=>t.createElement("button",{key:b,onClick:()=>{r(f.path),i(!1)},className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors ${s.pathname===f.path?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100"}`},C(f.icon),t.createElement("span",{className:"font-medium"},f.label)))),a&&t.createElement("div",{className:"mt-6 pt-6 border-t border-gray-200"},t.createElement("button",{onClick:d,className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left text-red-600 hover:bg-red-50 transition-colors"},C("log-out"),t.createElement("span",{className:"font-medium"},"Cerrar Sesión"))))),t.createElement("div",{className:"h-16 md:hidden"}))}function er({children:a}){const{rol:e}=ht();return t.createElement(t.Fragment,null,t.createElement("div",{className:"md:hidden"},t.createElement(Az,null)),t.createElement("div",{className:"flex min-h-screen"},t.createElement("div",{className:"hidden md:block"},t.createElement(Sz,{rol:e})),t.createElement("div",{className:"flex-1 flex flex-col bg-blue-50"},t.createElement("div",{className:"hidden md:block"},t.createElement(Iz,null)),t.createElement("main",{className:"flex-1 p-4 md:p-8 pt-4 md:pt-8"},a))))}class Tz{constructor(){this.messaging=null,this.isSupported=!1,this.init()}async init(){if(this.isSupported="serviceWorker"in navigator&&"PushManager"in window,!this.isSupported){console.warn("Push notifications no soportadas en este navegador");return}try{await this.registerServiceWorker(),typeof window<"u"&&(this.messaging=fA(),this.setupMessageHandling())}catch(e){console.error("Error inicializando notificaciones:",e)}}async registerServiceWorker(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register("/firebase-messaging-sw.js");return console.log("Firebase Service Worker registrado:",e),e}catch(e){throw console.error("Error registrando Firebase Service Worker:",e),e}}async requestPermission(){if(!this.isSupported)throw new Error("Notificaciones no soportadas");const e=await Notification.requestPermission();return e==="granted"?(console.log("Permiso de notificaciones concedido"),!0):e==="denied"?(console.log("Permiso de notificaciones denegado"),!1):(console.log("Permiso de notificaciones no decidido"),!1)}async getRegistrationToken(){if(!this.messaging)throw new Error("Firebase Messaging no inicializado");try{const e=await hA(this.messaging,{vapidKey:"BEl62iUYgUivxIhf6Ydtwqr2oXIFOOcNVKqF8sD_ECGRt1Ue6kf0lKrKQK2BdHWnU_0XEU1LoXOQ"});return e?(console.log("Token de registro obtenido:",e),e):(console.log("No se pudo obtener el token de registro"),null)}catch(e){throw console.error("Error obteniendo token:",e),e}}setupMessageHandling(){this.messaging&&vA(this.messaging,e=>{console.log("Mensaje recibido en primer plano:",e),this.showForegroundNotification(e)})}showForegroundNotification(e){const{title:n,body:r,icon:s}=e.notification||{};this.showInAppNotification({title:n||"AV10 de Julio",body:r||"Nueva notificación",icon:s||"/logo192.png",data:e.data})}showInAppNotification(e){const n=document.createElement("div");n.className="fixed top-4 right-4 bg-blue-600 text-white p-4 rounded-lg shadow-lg z-50 max-w-sm",n.innerHTML=`
      <div class="flex items-start">
        <img src="${e.icon}" alt="Icon" class="w-8 h-8 mr-3 rounded">
        <div class="flex-1">
          <h4 class="font-semibold">${e.title}</h4>
          <p class="text-sm opacity-90">${e.body}</p>
        </div>
        <button class="ml-2 text-white hover:text-gray-200" onclick="this.parentElement.parentElement.remove()">
          ×
        </button>
      </div>
    `,document.body.appendChild(n),setTimeout(()=>{n.parentElement&&n.remove()},5e3)}async sendRecordatorioMantenimiento(e,n){const r={title:"🔧 Recordatorio de Mantenimiento",body:`Es hora de realizar el mantenimiento de tu ${n.marca} ${n.modelo}`,icon:"/logo192.png",data:{type:"recordatorio_mantenimiento",userId:e,vehiculoId:n.id,url:`/vehiculos/${n.id}/servicios`}};return this.sendNotification(r)}async sendEstadoSolicitud(e,n,r){const s={title:"📋 Actualización de Solicitud",body:`Tu solicitud de ${n} ha sido ${r}`,icon:"/logo192.png",data:{type:"estado_solicitud",userId:e,solicitudTipo:n,estado:r,url:"/dashboard"}};return this.sendNotification(s)}async sendNuevaEmpresaAsignada(e,n){const r={title:"🏢 Nueva Empresa Asignada",body:`Se te ha asignado ${n.nombre} para validación`,icon:"/logo192.png",data:{type:"nueva_empresa_asignada",agenteId:e,empresaId:n.id,url:"/dashboard/agente"}};return this.sendNotification(r)}async sendNotification(e){this.isSupported&&Notification.permission==="granted"&&new Notification(e.title,{body:e.body,icon:e.icon,data:e.data})}async subscribeUser(e,n){try{if(!await this.requestPermission())throw new Error("Permisos de notificación no concedidos");const s=await this.getRegistrationToken();if(!s)throw new Error("No se pudo obtener token de registro");return await this.saveTokenToFirestore(e,s,n),{success:!0,token:s}}catch(r){return console.error("Error suscribiendo usuario:",r),{success:!1,error:r.message}}}async saveTokenToFirestore(e,n,r){const{doc:s,setDoc:o,getFirestore:i}=await q0(()=>import("./index.esm-83fc9f3b.js"),[]),l=i(),c={token:n,userId:e,userType:r,createdAt:new Date,active:!0,platform:this.getPlatform()};await o(s(l,"push_tokens",`${e}_${n.slice(-10)}`),c)}getPlatform(){const e=navigator.userAgent;return/android/i.test(e)?"android":/iPad|iPhone|iPod/.test(e)?"ios":"web"}async unsubscribeUser(e){try{const{collection:n,query:r,where:s,getDocs:o,updateDoc:i,getFirestore:l}=await q0(()=>import("./index.esm-83fc9f3b.js"),[]),c=l(),u=n(c,"push_tokens"),d=r(u,s("userId","==",e),s("active","==",!0)),h=(await o(d)).docs.map(C=>i(C.ref,{active:!1,unsubscribedAt:new Date}));return await Promise.all(h),{success:!0}}catch(n){return console.error("Error desuscribiendo usuario:",n),{success:!1,error:n.message}}}}const ya=new Tz,ce={CATALOGADA:"catalogada",INGRESADA:"ingresada",PENDIENTE_VALIDACION:"pendiente_validacion",EN_VISITA:"en_visita",VALIDADA:"validada",RECHAZADA:"rechazada",ACTIVA:"activa",SUSPENDIDA:"suspendida",INACTIVA:"inactiva"},ml={CATALOGADA:{descripcion:"Empresa del catastro inicial (200+ empresas)",visible_en_home:!1,puede_gestionar:!1,proximo_paso:"Asignar a agente para validación",transiciones:["pendiente_validacion"]},INGRESADA:{descripcion:"Empresa ingresada manualmente por administrador",visible_en_home:!1,puede_gestionar:!1,proximo_paso:"Admin puede activar directamente o asignar a agente",transiciones:["activa","pendiente_validacion","rechazada"]},PENDIENTE_VALIDACION:{descripcion:"Asignada a agente para validación en terreno",visible_en_home:!1,puede_gestionar:!1,proximo_paso:"Agente programa visita",transiciones:["en_visita","rechazada"]},EN_VISITA:{descripcion:"Agente programó visita de validación",visible_en_home:!1,puede_gestionar:!1,proximo_paso:"Agente valida en terreno",transiciones:["validada","rechazada"]},VALIDADA:{descripcion:"Agente validó empresa en terreno",visible_en_home:!0,puede_gestionar:!1,proximo_paso:"Admin activa completamente",transiciones:["activa","rechazada"]},ACTIVA:{descripcion:"Empresa visible y operativa en el sistema",visible_en_home:!0,puede_gestionar:!0,proximo_paso:"Operación normal",transiciones:["suspendida","inactiva"]},SUSPENDIDA:{descripcion:"Temporalmente desactivada por admin",visible_en_home:!1,puede_gestionar:!1,proximo_paso:"Reactivar o desactivar permanentemente",transiciones:["activa","inactiva"]},INACTIVA:{descripcion:"Permanentemente desactivada",visible_en_home:!1,puede_gestionar:!1,proximo_paso:"Estado final",transiciones:[]},RECHAZADA:{descripcion:"No cumple requisitos de validación",visible_en_home:!1,puede_gestionar:!1,proximo_paso:"Estado final",transiciones:[]}},AE={PENDIENTE:{descripcion:"Solicitud nueva de proveedor",proximo_paso:"Revisión administrativa",transiciones:["en_revision","rechazada"]},EN_REVISION:{descripcion:"Bajo revisión administrativa",proximo_paso:"Aprobar para validación por agente",transiciones:["aprobada","rechazada"]},APROBADA:{descripcion:"Aprobada para validación por agente",proximo_paso:"Asignar a agente",transiciones:[]},RECHAZADA:{descripcion:"Rechazada administrativamente",proximo_paso:"Estado final",transiciones:[]}},TE=(a,e,n=!1)=>{var o;const s=(n?AE:ml)[a];return((o=s==null?void 0:s.transiciones)==null?void 0:o.includes(e))||!1},Pz=(a,e=!1)=>{var r;return((r=(e?AE:ml)[a])==null?void 0:r.transiciones)||[]},Rz=(a,e=!1)=>{var r;return((r=(e?AE:ml)[a])==null?void 0:r.descripcion)||"Estado desconocido"},Dz=async a=>{if(!a||typeof a!="string")return null;if(a.startsWith("https://"))return a;if(a.startsWith("gs://"))try{const e=a.replace("gs://",""),n=Fl(ci,e);return await jl(n)}catch(e){return console.error("Error convirtiendo URL de Firebase Storage:",e),null}return null},ui=a=>{const[e,n]=p.useState(null),[r,s]=p.useState(!1),[o,i]=p.useState(null);return p.useEffect(()=>{(async()=>{if(!a){n(null),s(!1),i(null);return}if(a.startsWith("https://")){n(a),s(!1),i(null);return}if(a.startsWith("gs://")){s(!0),i(null);try{const c=await Dz(a);n(c),i(null)}catch(c){console.error("Error convirtiendo URL de imagen:",c),i("Error al cargar la imagen"),n(null)}finally{s(!1)}}else n(null),s(!1),i("Formato de URL no válido")})()},[a]),{imageUrl:e,loading:r,error:o}};function Lz(){var G,we,Te;const{user:a,rol:e}=ht(),[n,r]=p.useState({nombre:"",email:"",telefono:"",direccion:"",web:"",categoria:"",descripcion:"",tipoEmpresa:"",estado:"",representante:{nombre:"",apellidos:"",email:"",telefono:"",cargo:"",cedula:""}}),{empresaId:s}=Ni(),o=Ct(),[i,l]=p.useState(null),[c,u]=p.useState(!0),[d,m]=p.useState(""),[h,C]=p.useState(!1),[S,w]=p.useState(!1),[f,b]=p.useState(""),[v,I]=p.useState(""),[A,N]=p.useState(""),[x,y]=p.useState({}),[E,_]=p.useState(""),{imageUrl:P,loading:k,error:D}=ui((i==null?void 0:i.logo_url)||(i==null?void 0:i.logo));p.useEffect(()=>{if(i){let B={};i.horarios?typeof i.horarios=="object"&&!Array.isArray(i.horarios)?B=i.horarios:B={Lunes:{abierto:!1,inicio:"09:00",fin:"18:00"},Martes:{abierto:!1,inicio:"09:00",fin:"18:00"},Miércoles:{abierto:!1,inicio:"09:00",fin:"18:00"},Jueves:{abierto:!1,inicio:"09:00",fin:"18:00"},Viernes:{abierto:!1,inicio:"09:00",fin:"18:00"},Sábado:{abierto:!1,inicio:"09:00",fin:"14:00"},Domingo:{abierto:!1,inicio:"09:00",fin:"14:00"}}:B={Lunes:{abierto:!1,inicio:"09:00",fin:"18:00"},Martes:{abierto:!1,inicio:"09:00",fin:"18:00"},Miércoles:{abierto:!1,inicio:"09:00",fin:"18:00"},Jueves:{abierto:!1,inicio:"09:00",fin:"18:00"},Viernes:{abierto:!1,inicio:"09:00",fin:"18:00"},Sábado:{abierto:!1,inicio:"09:00",fin:"14:00"},Domingo:{abierto:!1,inicio:"09:00",fin:"14:00"}},y(B),_(i.notas_admin||"")}},[i]);const M=()=>{f.trim()&&(l(B=>({...B,servicios:[...B.servicios||[],f.trim()]})),b(""))},$=B=>{l(ve=>({...ve,servicios:ve.servicios.filter((je,_e)=>_e!==B)}))},q=()=>{v.trim()&&(l(B=>({...B,marcas:[...B.marcas||[],v.trim()]})),I(""))},V=B=>{l(ve=>({...ve,marcas:ve.marcas.filter((je,_e)=>_e!==B)}))},z=()=>{A.trim()&&(l(B=>({...B,galeria:[...B.galeria||[],A.trim()]})),N(""))},j=B=>{l(ve=>({...ve,galeria:ve.galeria.filter((je,_e)=>_e!==B)}))},U=B=>{l(ve=>({...ve,logo:B.target.value}))},Q=(B,ve,je)=>{y(_e=>({..._e,[B]:{..._e[B],[ve]:je}}))},te=B=>_(B.target.value),se=async()=>{var B;w(!0);try{const ve=((B=i.marcas)==null?void 0:B.map(je=>typeof je=="string"?je:je.nombre||je.id||je))||[];await ze(Ne(F,"empresas",s),{servicios:i.servicios||[],marcas:ve}),l(je=>({...je,servicios:i.servicios||[],marcas:ve}))}catch(ve){console.error("Error al guardar servicios/marcas:",ve),m("Error al guardar servicios/marcas")}w(!1)},X=async()=>{w(!0);try{await ze(Ne(F,"empresas",s),{logo:i.logo||"",galeria:i.galeria||[]})}catch{m("Error al guardar logo/galería")}w(!1)},ye=async()=>{w(!0);try{await ze(Ne(F,"empresas",s),{horarios:x}),l(B=>({...B,horarios:x}))}catch{m("Error al guardar horarios")}w(!1)},Y=async()=>{w(!0);try{await ze(Ne(F,"empresas",s),{notas_admin:E}),l(B=>({...B,notas_admin:E}))}catch{m("Error al guardar nota")}w(!1)},Se=[{id:"general",label:"Información General",icon:"📋"},{id:"representante",label:"Representante",icon:"👤"},{id:"servicios",label:"Servicios y Marcas",icon:"🛠️"},{id:"logo",label:"Logo y Galería",icon:"🖼️"},{id:"horarios",label:"Horarios",icon:"🕒"},{id:"notas",label:"Notas Administrativas",icon:"📝"},{id:"validacion",label:"Validación",icon:"✅"}],[de,oe]=p.useState("general");p.useEffect(()=>{(async()=>{try{const ve=Ne(F,"empresas",s),je=await en(ve);je.exists()?l({id:je.id,...je.data()}):m("Empresa no encontrada")}catch{m("Error al cargar la empresa")}finally{u(!1)}})()},[s]),p.useEffect(()=>{i&&r({nombre:i.nombre||"",email:i.email||"",telefono:i.telefono||"",direccion:i.direccion||"",web:i.web||"",categoria:i.categoria||"",descripcion:i.descripcion||"",tipoEmpresa:i.tipoEmpresa||"",estado:i.estado||"",representante:i.representante||{nombre:"",apellidos:"",email:"",telefono:"",cargo:"",cedula:""}})},[i]);const ge=B=>{const{name:ve,value:je}=B.target;if(ve.startsWith("representante.")){const _e=ve.split(".")[1];r(H=>({...H,representante:{...H.representante,[_e]:je}}))}else r(_e=>({..._e,[ve]:je}))},me=async()=>{w(!0);try{await ze(Ne(F,"empresas",s),{...n,representante:{...n.representante}}),l(B=>({...B,...n}))}catch{m("Error al guardar los cambios")}finally{w(!1)}},he=async()=>{C(!0);try{if(!TE(i==null?void 0:i.estado,ce.VALIDADA)){ya.showInAppNotification({title:"⚠️ Transición No Permitida",body:`No se puede cambiar de "${i==null?void 0:i.estado}" a "${ce.VALIDADA}"`,icon:"/logo192.png"});return}await ze(Ne(F,"empresas",s),{estado:ce.VALIDADA,fecha_validacion:sa(),visitaAgente:!0,validada:!0,fecha_ultima_validacion:sa()}),l(B=>({...B,estado:ce.VALIDADA,visitaAgente:!0,validada:!0})),ya.showInAppNotification({title:"✅ Empresa Validada",body:`${i==null?void 0:i.nombre} ha sido validada exitosamente`,icon:"/logo192.png"})}catch(B){console.error("Error al validar empresa:",B),ya.showInAppNotification({title:"❌ Error en Validación",body:"No se pudo validar la empresa. Intenta nuevamente.",icon:"/logo192.png"})}finally{C(!1)}};return e!=="agente"?t.createElement(er,null,t.createElement("div",{className:"text-center p-8"},t.createElement("h2",{className:"text-2xl font-bold text-red-600 mb-4"},"Acceso Denegado"),t.createElement("p",{className:"text-gray-600"},"Solo agentes de campo pueden acceder a esta sección."))):t.createElement(er,null,t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"📋 Detalle de Empresa"),t.createElement("p",{className:"text-gray-600 mt-1"},(i==null?void 0:i.nombre)||"Cargando...")),t.createElement("div",{className:"flex items-center gap-3"},S&&t.createElement("div",{className:"flex items-center gap-2 text-green-600"},t.createElement("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600"}),t.createElement("span",{className:"text-sm"},"Guardando...")),t.createElement("button",{onClick:()=>o("/agente/empresas-asignadas"),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors"},"← Volver")))),c?t.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6"},t.createElement("div",{className:"flex items-center justify-center h-32"},t.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}))):d?t.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6"},t.createElement("div",{className:"text-center text-red-600"},t.createElement("p",null,d))):t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-white rounded-lg shadow-sm"},t.createElement("div",{className:"border-b border-gray-200"},t.createElement("nav",{className:"-mb-px flex space-x-8 px-6"},Se.map(B=>t.createElement("button",{key:B.id,onClick:()=>oe(B.id),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${de===B.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`},t.createElement("span",{className:"mr-2"},B.icon),B.label)))),t.createElement("div",{className:"p-6"},de==="general"&&t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombre de la Empresa"),t.createElement("input",{type:"text",name:"nombre",value:(i==null?void 0:i.nombre)||"",onChange:ge,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email"),t.createElement("input",{type:"email",name:"email",value:(i==null?void 0:i.email)||"",onChange:ge,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono"),t.createElement("input",{type:"tel",name:"telefono",value:(i==null?void 0:i.telefono)||"",onChange:ge,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Dirección"),t.createElement("input",{type:"text",name:"direccion",value:(i==null?void 0:i.direccion)||"",onChange:ge,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Sitio Web"),t.createElement("input",{type:"url",name:"web",value:(i==null?void 0:i.web)||"",onChange:ge,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Categoría"),t.createElement("input",{type:"text",name:"categoria",value:(i==null?void 0:i.categoria)||"",onChange:ge,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Descripción"),t.createElement("textarea",{name:"descripcion",value:(i==null?void 0:i.descripcion)||"",onChange:ge,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",{className:"flex justify-end"},t.createElement("button",{onClick:me,disabled:S,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-400"},S?"Guardando...":"Guardar Cambios"))),de==="representante"&&t.createElement("div",{className:"p-6"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Representante"),t.createElement("form",{onSubmit:B=>{B.preventDefault(),me()},className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("label",{className:"block mb-2 font-medium"},"Nombre:"),t.createElement("input",{type:"text",name:"representante.nombre",value:n.representante.nombre,onChange:ge,className:"w-full border rounded px-2 py-1"}),t.createElement("label",{className:"block mb-2 font-medium"},"Apellidos:"),t.createElement("input",{type:"text",name:"representante.apellidos",value:n.representante.apellidos,onChange:ge,className:"w-full border rounded px-2 py-1"}),t.createElement("label",{className:"block mb-2 font-medium"},"Email:"),t.createElement("input",{type:"email",name:"representante.email",value:n.representante.email,onChange:ge,className:"w-full border rounded px-2 py-1"})),t.createElement("div",null,t.createElement("label",{className:"block mb-2 font-medium"},"Teléfono:"),t.createElement("input",{type:"text",name:"representante.telefono",value:n.representante.telefono,onChange:ge,className:"w-full border rounded px-2 py-1"}),t.createElement("label",{className:"block mb-2 font-medium"},"Cargo:"),t.createElement("input",{type:"text",name:"representante.cargo",value:n.representante.cargo,onChange:ge,className:"w-full border rounded px-2 py-1"}),t.createElement("label",{className:"block mb-2 font-medium"},"Cédula:"),t.createElement("input",{type:"text",name:"representante.cedula",value:n.representante.cedula,onChange:ge,className:"w-full border rounded px-2 py-1"}))),t.createElement("div",{className:"mt-4"},t.createElement("button",{type:"button",onClick:me,disabled:S,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 mr-2"},S?"Guardando...":"Guardar cambios"))),de==="servicios"&&t.createElement("div",{className:"space-y-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Servicios"),t.createElement("div",{className:"flex gap-2 mb-4"},t.createElement("input",{type:"text",value:f,onChange:B=>b(B.target.value),placeholder:"Agregar servicio...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.createElement("button",{onClick:M,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"},"Agregar")),t.createElement("div",{className:"flex flex-wrap gap-2"},(G=i==null?void 0:i.servicios)==null?void 0:G.map((B,ve)=>t.createElement("span",{key:ve,className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm flex items-center gap-2"},B,t.createElement("button",{onClick:()=>$(ve),className:"text-blue-600 hover:text-blue-800"},"×"))))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Marcas"),t.createElement("div",{className:"flex gap-2 mb-4"},t.createElement("input",{type:"text",value:v,onChange:B=>I(B.target.value),placeholder:"Agregar marca...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.createElement("button",{onClick:q,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"},"Agregar")),t.createElement("div",{className:"flex flex-wrap gap-2"},(we=i==null?void 0:i.marcas)==null?void 0:we.map((B,ve)=>t.createElement("span",{key:ve,className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm flex items-center gap-2"},typeof B=="string"?B:B.nombre||B.id||"Marca sin nombre",t.createElement("button",{onClick:()=>V(ve),className:"text-green-600 hover:text-green-800"},"×"))))),t.createElement("div",{className:"flex justify-end"},t.createElement("button",{onClick:se,disabled:S,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-400"},S?"Guardando...":"Guardar Servicios y Marcas"))),de==="logo"&&t.createElement("div",{className:"p-6"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Logo y Galería"),t.createElement("div",{className:"mb-4"},t.createElement("label",{className:"block font-medium mb-2"},"Logo (URL):"),t.createElement("input",{type:"text",value:(i==null?void 0:i.logo)||"",onChange:U,placeholder:"URL del logo",className:"border rounded px-2 py-1 w-full mb-2"}),i!=null&&i.logo_url||i!=null&&i.logo?t.createElement("div",{className:"relative"},k?t.createElement("div",{className:"h-20 mb-2 flex items-center justify-center bg-gray-100 rounded"},t.createElement("span",{className:"text-gray-500"},"Cargando logo...")):P?t.createElement("img",{src:P,alt:"Logo",className:"h-20 mb-2 object-contain",onError:B=>{B.target.style.display="none",B.target.nextSibling.style.display="block"}}):t.createElement("div",{className:"h-20 mb-2 flex items-center justify-center bg-gray-100 rounded"},t.createElement("span",{className:"text-gray-500"},"Error al cargar logo")),D&&t.createElement("span",{className:"text-red-500 text-sm"},"Error: ",D)):t.createElement("span",{className:"text-gray-500"},"Sin logo")),t.createElement("div",{className:"mb-4"},t.createElement("label",{className:"block font-medium mb-2"},"Galería (URLs):"),t.createElement("div",{className:"flex gap-2 flex-wrap mb-2"},(Te=i.galeria)==null?void 0:Te.map((B,ve)=>{const{imageUrl:je,loading:_e}=ui(B);return t.createElement("span",{key:ve,className:"relative"},_e?t.createElement("div",{className:"h-16 w-16 bg-gray-100 rounded border flex items-center justify-center"},t.createElement("span",{className:"text-xs text-gray-500"},"...")):je?t.createElement("img",{src:je,alt:`img-${ve}`,className:"h-16 rounded border"}):t.createElement("div",{className:"h-16 w-16 bg-gray-100 rounded border flex items-center justify-center"},t.createElement("span",{className:"text-xs text-red-500"},"Error")),t.createElement("button",{type:"button",onClick:()=>j(ve),className:"absolute top-0 right-0 bg-red-500 text-white rounded-full px-1 text-xs"},"✕"))})),t.createElement("div",{className:"flex gap-2"},t.createElement("input",{type:"text",value:A,onChange:B=>N(B.target.value),placeholder:"Agregar URL de imagen",className:"border rounded px-2 py-1"}),t.createElement("button",{type:"button",onClick:z,className:"bg-indigo-600 text-white px-3 py-1 rounded"},"Agregar"))),t.createElement("button",{type:"button",onClick:X,disabled:S,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"},S?"Guardando...":"Guardar cambios")),de==="horarios"&&t.createElement("div",{className:"p-6"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Horarios"),Object.keys(x).length?t.createElement("form",{onSubmit:B=>{B.preventDefault(),ye()}},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},Object.entries(x).map(([B,ve],je)=>t.createElement("div",{key:je,className:"border rounded p-3 mb-2"},t.createElement("div",{className:"font-medium mb-2"},B),t.createElement("label",{className:"flex items-center gap-2 mb-2"},t.createElement("input",{type:"checkbox",checked:ve.abierto,onChange:_e=>Q(B,"abierto",_e.target.checked)})," Abierto"),ve.abierto&&t.createElement("div",{className:"flex gap-2"},t.createElement("input",{type:"time",value:ve.inicio,onChange:_e=>Q(B,"inicio",_e.target.value),className:"border rounded px-2 py-1"}),t.createElement("span",null,"-"),t.createElement("input",{type:"time",value:ve.fin,onChange:_e=>Q(B,"fin",_e.target.value),className:"border rounded px-2 py-1"}))))),t.createElement("button",{type:"submit",disabled:S,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},S?"Guardando...":"Guardar cambios")):t.createElement("span",{className:"text-gray-500"},"Sin horarios definidos")),de==="notas"&&t.createElement("div",{className:"p-6"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Notas Administrativas"),t.createElement("textarea",{value:E,onChange:te,className:"w-full border rounded px-2 py-1 mb-2",rows:3,placeholder:"Agregar nota administrativa"}),t.createElement("button",{type:"button",onClick:Y,disabled:S,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"},S?"Guardando...":"Guardar nota")),de==="validacion"&&t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},t.createElement("h3",{className:"text-lg font-semibold text-yellow-800 mb-2"},"Validación de Empresa"),t.createElement("p",{className:"text-yellow-700 mb-4"},"Esta sección permite validar la información de la empresa y cambiar su estado."),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Estado Actual"),t.createElement("span",{className:`inline-flex px-3 py-1 rounded-full text-sm font-medium ${(i==null?void 0:i.estado)===ce.ACTIVA?"bg-green-100 text-green-800":(i==null?void 0:i.estado)===ce.PENDIENTE_VALIDACION?"bg-yellow-100 text-yellow-800":(i==null?void 0:i.estado)===ce.VALIDADA?"bg-blue-100 text-blue-800":(i==null?void 0:i.estado)===ce.CATALOGADA?"bg-gray-100 text-gray-800":(i==null?void 0:i.estado)===ce.EN_VISITA?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}`},(i==null?void 0:i.estado)===ce.ACTIVA?"Activa":(i==null?void 0:i.estado)===ce.PENDIENTE_VALIDACION?"Pendiente de Validación":(i==null?void 0:i.estado)===ce.VALIDADA?"Validada":(i==null?void 0:i.estado)===ce.CATALOGADA?"Catalogada":(i==null?void 0:i.estado)===ce.EN_VISITA?"En Visita":(i==null?void 0:i.estado)===ce.SUSPENDIDA?"Suspendida":(i==null?void 0:i.estado)===ce.INACTIVA?"Inactiva":(i==null?void 0:i.estado)===ce.RECHAZADA?"Rechazada":"Inactiva")),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Cambiar Estado"),t.createElement("select",{value:(i==null?void 0:i.estado)||ce.PENDIENTE_VALIDACION,onChange:B=>l(ve=>({...ve,estado:B.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:ce.CATALOGADA},"Catalogada"),t.createElement("option",{value:ce.PENDIENTE_VALIDACION},"Pendiente de Validación"),t.createElement("option",{value:ce.EN_VISITA},"En Visita"),t.createElement("option",{value:ce.VALIDADA},"Validada"),t.createElement("option",{value:ce.ACTIVA},"Activa"),t.createElement("option",{value:ce.SUSPENDIDA},"Suspendida"),t.createElement("option",{value:ce.INACTIVA},"Inactiva"),t.createElement("option",{value:ce.RECHAZADA},"Rechazada")))),t.createElement("div",{className:"mt-4 space-y-3"},t.createElement("div",{className:"flex items-center space-x-4"},t.createElement("button",{onClick:he,disabled:h,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:bg-green-400 disabled:cursor-not-allowed"},h?"Validando...":"Validar Empresa"),t.createElement("button",{onClick:async()=>{try{C(!0),await ze(Ne(F,"empresas",s),{estado:ce.VALIDADA,validada:!0,fecha_validacion:sa(),agente_validador:a.email,fecha_ultima_validacion:sa()}),ya.showInAppNotification({title:"✅ Empresa Validada",body:`La empresa ${i.nombre} ha sido marcada como validada`,icon:"/logo192.png"});const B=await en(Ne(F,"empresas",s));B.exists()&&l({id:B.id,...B.data()})}catch(B){console.error("Error validando empresa:",B),ya.showInAppNotification({title:"❌ Error al Validar",body:"No se pudo validar la empresa. Intenta nuevamente.",icon:"/logo192.png"})}finally{C(!1)}},disabled:h||(i==null?void 0:i.estado)==="validada",className:`px-4 py-2 rounded-lg transition-colors font-medium ${(i==null?void 0:i.estado)==="validada"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`},"Marcar como Validada")),t.createElement("div",{className:"text-sm text-gray-600"},t.createElement("p",null,t.createElement("strong",null,"Pendiente:")," Empresa en proceso de validación"),t.createElement("p",null,t.createElement("strong",null,"Validada:")," Empresa verificada por agente"),t.createElement("p",null,t.createElement("strong",null,"Activa:")," Empresa disponible para usuarios"),t.createElement("p",null,t.createElement("strong",null,"Inactiva:")," Empresa temporalmente deshabilitada"))))))))))}function Mz(a,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},a),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"}))}const Vz=p.forwardRef(Mz),Oz=Vz;function jz(a,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},a),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"}))}const Fz=p.forwardRef(jz),Wu=Fz;function zz(a,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},a),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}))}const Uz=p.forwardRef(zz),$z=Uz;function Bz(a,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},a),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const qz=p.forwardRef(Bz),PE=qz;function Wz(a,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},a),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"}))}const Gz=p.forwardRef(Wz),Hz=Gz;function Kz(a,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},a),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"}))}const Qz=p.forwardRef(Kz),MA=Qz;function Jz(a,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},a),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"}))}const Yz=p.forwardRef(Jz),Zz=Yz;function Xz(a,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},a),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"}))}const e7=p.forwardRef(Xz),t7=e7;function a7(a,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},a),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"}))}const n7=p.forwardRef(a7),r7=n7;function s7(a,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},a),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"}))}const o7=p.forwardRef(s7),i7=o7;function l7(a,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},a),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}const c7=p.forwardRef(l7),VA=c7,u7=()=>{const{rol:a}=ht(),[e,n]=p.useState([]),[r,s]=p.useState(0),[o,i]=p.useState(!1),[l,c]=p.useState(!0);p.useEffect(()=>{a==="admin"&&u()},[a]);const u=async()=>{try{const h=fe(W(F,"tickets"),pe("visto","==",!1),st("fechaCreacion","desc"),Ot(5)),S=(await le(h)).docs.map(A=>({id:A.id,...A.data(),type:"unread"})),w=fe(W(F,"tickets"),pe("prioridad","==","urgente"),pe("estado","!=","cerrado"),st("fechaCreacion","desc"),Ot(3)),b=(await le(w)).docs.map(A=>({id:A.id,...A.data(),type:"urgent"})),I=[...S,...b].filter((A,N,x)=>N===x.findIndex(y=>y.id===A.id));n(I.slice(0,5)),s(S.length)}catch(h){console.error("Error fetching notifications:",h)}finally{c(!1)}},d=h=>{if(!h)return"Sin fecha";const C=h.toDate?h.toDate():new Date(h),w=Math.abs(new Date-C),f=Math.ceil(w/(1e3*60*60*24));return f===1?"Hoy":f===2?"Ayer":f<=7?`Hace ${f} días`:C.toLocaleDateString("es-ES")},m=h=>{switch(h){case"complaint":return t.createElement(PE,{className:"h-4 w-4 text-red-500"});case"support":return t.createElement(Wu,{className:"h-4 w-4 text-blue-500"});default:return t.createElement(Wu,{className:"h-4 w-4 text-gray-500"})}};return a!=="admin"||l?null:t.createElement("div",{className:"relative"},t.createElement("button",{onClick:()=>i(!o),className:"relative p-2 text-gray-400 hover:text-gray-600 transition-colors"},t.createElement(Oz,{className:"h-6 w-6"}),r>0&&t.createElement("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},r>9?"9+":r)),o&&t.createElement("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-50"},t.createElement("div",{className:"py-1"},t.createElement("div",{className:"px-4 py-2 border-b border-gray-200"},t.createElement("h3",{className:"text-sm font-medium text-gray-900"},"Notificaciones de Tickets")),e.length===0?t.createElement("div",{className:"px-4 py-3 text-sm text-gray-500 text-center"},"No hay notificaciones nuevas"):t.createElement(t.Fragment,null,e.map(h=>t.createElement("a",{key:h.id,href:`/admin/gestion-tickets?ticket=${h.id}`,className:"block px-4 py-3 hover:bg-gray-50 transition-colors",onClick:()=>i(!1)},t.createElement("div",{className:"flex items-start"},t.createElement("div",{className:"flex-shrink-0 mr-3 mt-1"},m(h.tipo)),t.createElement("div",{className:"flex-1 min-w-0"},t.createElement("p",{className:"text-sm font-medium text-gray-900 truncate"},h.asunto),t.createElement("p",{className:"text-sm text-gray-500 truncate"},"De: ",h.nombre),t.createElement("div",{className:"flex items-center justify-between mt-1"},t.createElement("span",{className:"text-xs text-gray-400"},d(h.fechaCreacion)),t.createElement("div",{className:"flex items-center gap-1"},h.type==="unread"&&t.createElement("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full"},"Nuevo"),h.prioridad==="urgente"&&t.createElement("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full"},"Urgente"))))))),t.createElement("div",{className:"border-t border-gray-200"},t.createElement("a",{href:"/admin/gestion-tickets",className:"block px-4 py-2 text-sm text-blue-600 hover:text-blue-800 text-center",onClick:()=>i(!1)},"Ver todos los tickets"))))),o&&t.createElement("div",{className:"fixed inset-0 z-40",onClick:()=>i(!1)}))};class Ws{static async createInAppNotification(e,n,r,s,o={}){try{const i={userId:e,tipo:n,titulo:r,mensaje:s,metadatos:o,leida:!1,fechaCreacion:new Date,fechaVencimiento:o.fechaVencimiento||null};return(await ot(W(F,"notificaciones"),i)).id}catch(i){throw console.error("Error creating notification:",i),i}}static async getUserNotifications(e,n=10){try{const r=fe(W(F,"notificaciones"),pe("userId","==",e),st("fechaCreacion","desc"),Ot(n));return(await le(r)).docs.map(o=>({id:o.id,...o.data()}))}catch(r){return console.error("Error getting notifications:",r),[]}}static async markAsRead(e){try{await ze(Ne(F,"notificaciones",e),{leida:!0,fechaLectura:new Date})}catch(n){console.error("Error marking notification as read:",n)}}static async getUnreadCount(e){try{const n=fe(W(F,"notificaciones"),pe("userId","==",e),pe("leida","==",!1));return(await le(n)).size}catch(n){return console.error("Error getting unread count:",n),0}}static async notifyClientValidationStatus(e,n,r=""){const s={activo:{titulo:"¡Perfil Validado! 🎉",mensaje:"Tu perfil ha sido validado exitosamente. Ya puedes acceder a todos nuestros servicios y gestionar tus vehículos.",tipo:"validacion"},rechazado:{titulo:"Perfil Rechazado ❌",mensaje:`Tu perfil ha sido rechazado. ${r?`Motivo: ${r}`:"Por favor, revisa los datos ingresados y vuelve a intentar."}`,tipo:"validacion"},suspendido:{titulo:"Perfil Suspendido ⚠️",mensaje:`Tu perfil ha sido suspendido temporalmente. ${r?`Motivo: ${r}`:"Contacta con soporte para más información."}`,tipo:"validacion"}};s[n]&&await this.createInAppNotification(e,s[n].tipo,s[n].titulo,s[n].mensaje,{estado:n,observaciones:r,origen:"validacion_cliente"}),await this.sendEmailNotification(e,n,r)}static async notifyVehicleReminder(e,n,r,s){const o={permiso_circulacion:{titulo:"🚗 Renovar Permiso de Circulación",mensaje:`Tu ${n.marca} ${n.modelo} necesita renovar el permiso de circulación.`},revision_tecnica:{titulo:"🔧 Revisión Técnica Pendiente",mensaje:`Tu ${n.marca} ${n.modelo} debe hacer la revisión técnica.`},soap:{titulo:"📋 SOAP Vencido",mensaje:`Tu ${n.marca} ${n.modelo} tiene el SOAP vencido.`},seguro:{titulo:"🛡️ Renovar Seguro",mensaje:`Tu ${n.marca} ${n.modelo} necesita renovar el seguro.`}};o[r]&&await this.createInAppNotification(e,"recordatorio",o[r].titulo,o[r].mensaje,{vehiculoId:n.id,tipoRecordatorio:r,fechaVencimiento:s,patente:n.patente})}static async sendEmailNotification(e,n,r){try{console.log(`Email notification sent to user ${e}:`,{estado:n,observaciones:r}),await ot(W(F,"email_logs"),{userId:e,tipo:"validacion_cliente",estado:n,observaciones:r,fechaEnvio:new Date,proveedor:"sistema_interno"})}catch(s){console.error("Error sending email notification:",s)}}static async notifyPromotion(e,n,r,s=null){await this.createInAppNotification(e,"promocion",n,r,{tipoVehiculo:s,origen:"marketing",fechaVencimiento:new Date(Date.now()+7*24*60*60*1e3)})}static async notifySystemUpdate(e,n,r){await this.createInAppNotification(e,"sistema",n,r,{origen:"sistema"})}static async createMassiveReminders(e,n={}){try{const r=W(F,"vehiculos"),s=await le(r);let o=0;for(const i of s.docs){const l={id:i.id,...i.data()};n.marca&&l.marca!==n.marca||n.año&&l.año!==n.año||(await this.notifyVehicleReminder(l.userId,l,e,n.fechaVencimiento),o++)}return o}catch(r){throw console.error("Error creating massive reminders:",r),r}}}function d7(){const{user:a}=ht(),[e,n]=p.useState([]),[r,s]=p.useState(0),[o,i]=p.useState(!1),[l,c]=p.useState(!1);p.useEffect(()=>{if(a){u(),d();const w=setInterval(()=>{d()},3e4);return()=>clearInterval(w)}},[a]);const u=async()=>{try{c(!0);const w=await Ws.getUserNotifications(a.uid,20);n(w)}catch(w){console.error("Error loading notifications:",w)}finally{c(!1)}},d=async()=>{try{const w=await Ws.getUnreadCount(a.uid);s(w)}catch(w){console.error("Error loading unread count:",w)}},m=async w=>{try{await Ws.markAsRead(w),await u(),await d()}catch(f){console.error("Error marking as read:",f)}},h=w=>{var f,b;switch(w.leida||m(w.id),w.tipo){case"validacion":((f=w.metadatos)==null?void 0:f.estado)==="activo"&&(window.location.href="/dashboard/cliente");break;case"recordatorio":(b=w.metadatos)!=null&&b.vehiculoId&&(window.location.href="/dashboard/cliente/vehiculos");break}},C=w=>({validacion:"✅",recordatorio:"⏰",promocion:"🎁",sistema:"🔧"})[w]||"📢",S=w=>{if(!w)return"";const f=w.toDate?w.toDate():new Date(w),v=new Date-f,I=Math.floor(v/6e4),A=Math.floor(v/36e5),N=Math.floor(v/864e5);return I<1?"Ahora":I<60?`${I}m`:A<24?`${A}h`:N<7?`${N}d`:f.toLocaleDateString("es-CL")};return t.createElement("div",{className:"relative"},t.createElement("button",{onClick:()=>i(!o),className:"relative p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors"},t.createElement("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})),r>0&&t.createElement("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium"},r>99?"99+":r)),o&&t.createElement("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border z-50 max-h-96 overflow-hidden"},t.createElement("div",{className:"p-3 border-b bg-gray-50"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("h3",{className:"font-semibold text-gray-800"},"Notificaciones"),t.createElement("button",{onClick:()=>i(!1),className:"text-gray-500 hover:text-gray-700"},t.createElement("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})))),r>0&&t.createElement("p",{className:"text-sm text-gray-600 mt-1"},r," notificación",r!==1?"es":""," sin leer")),t.createElement("div",{className:"max-h-64 overflow-y-auto"},l?t.createElement("div",{className:"p-4 text-center"},t.createElement("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"})):e.length===0?t.createElement("div",{className:"p-4 text-center text-gray-500"},t.createElement("svg",{className:"w-12 h-12 mx-auto mb-2 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})),t.createElement("p",{className:"text-sm"},"No hay notificaciones")):e.map(w=>t.createElement("div",{key:w.id,onClick:()=>h(w),className:`p-3 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition-colors ${w.leida?"":"bg-blue-50 border-l-4 border-l-blue-500"}`},t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("span",{className:"text-lg flex-shrink-0 mt-0.5"},C(w.tipo)),t.createElement("div",{className:"flex-1 min-w-0"},t.createElement("p",{className:`text-sm font-medium text-gray-900 ${w.leida?"":"font-semibold"}`},w.titulo),t.createElement("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2"},w.mensaje),t.createElement("p",{className:"text-xs text-gray-400 mt-2"},S(w.fechaCreacion))),!w.leida&&t.createElement("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-2"}))))),e.length>0&&t.createElement("div",{className:"p-3 border-t bg-gray-50"},t.createElement("button",{onClick:()=>{i(!1)},className:"w-full text-sm text-blue-600 hover:text-blue-800 font-medium"},"Ver todas las notificaciones"))),o&&t.createElement("div",{className:"fixed inset-0 z-40",onClick:()=>i(!1)}))}function za(){const a=Ct(),e=En(),{user:n,rol:r,loading:s}=ht(),[o,i]=p.useState(!1),[l,c]=p.useState(!1),[u,d]=p.useState(!1),m=async()=>{await Pt.signOut(),a("/login")},h=()=>{d(!1),i(!1),c(!1)},C=f=>e.pathname===f?"underline font-bold":"hover:underline",S=e.pathname==="/proveedores"||e.pathname.startsWith("/proveedores/"),w=()=>{h(),a(r==="admin"?"/admin":r==="proveedor"?"/dashboard/proveedor":"/proveedores")};return t.createElement("nav",{className:"w-full bg-blue-800 text-white flex items-center px-6 py-3 shadow justify-between z-20"},t.createElement("div",{className:"flex items-center gap-4"},t.createElement("button",{className:C("/"),onClick:()=>{a("/"),h()}},"Inicio"),n&&r==="agente"&&t.createElement("div",{className:"relative"},t.createElement("button",{className:"hover:underline flex items-center gap-1",onClick:()=>c(!l)},"📊 Mi Dashboard",t.createElement("span",{className:"text-xs"},"▼")),l&&t.createElement("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg py-2 min-w-48 z-50"},t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm font-semibold border-b border-gray-200",onClick:()=>{a("/dashboard/agente"),c(!1)}},"🗂 Mi Dashboard"),t.createElement("div",{className:"border-b border-gray-200 pb-2 mb-2"},t.createElement("div",{className:"px-4 py-1 text-xs text-gray-500 font-semibold"},"EMPRESAS"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/dashboard/agente"),c(!1)}},"🗂 Mi Dashboard"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/agente/nueva-empresa"),c(!1)}},"✅ Registrar Empresa Validada")))),n&&r!=="admin"&&r!=="agente"&&t.createElement("button",{className:C(r==="proveedor"?"/dashboard/proveedor":r==="mecanico"?"/dashboard/mecanico":"/dashboard/cliente"),onClick:()=>{h(),a(r==="proveedor"?"/dashboard/proveedor":r==="mecanico"?"/dashboard/mecanico":"/dashboard/cliente")}},"📊 Mi Dashboard"),n&&r==="admin"&&t.createElement("div",{className:"relative"},t.createElement("button",{className:"hover:underline flex items-center gap-1",onClick:()=>i(!o)},"📊 Mi Dashboard",t.createElement("span",{className:"text-xs"},"▼")),o&&t.createElement("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg py-2 min-w-48 z-50"},t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm font-semibold border-b border-gray-200",onClick:()=>{a("/admin"),i(!1)}},"🏠 Panel Principal"),t.createElement("div",{className:"border-b border-gray-200 pb-2 mb-2"},t.createElement("div",{className:"px-4 py-1 text-xs text-gray-500 font-semibold"},"SERVICIOS"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/servicios/seguros"),i(!1)}},"🛡️ Seguros"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/servicios/revision-tecnica"),i(!1)}},"🔧 Revisión Técnica"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/servicios/vulcanizaciones"),i(!1)}},"🏁 Vulcanizaciones"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/servicios/reciclaje"),i(!1)}},"♻️ Reciclaje"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/mis-recordatorios"),i(!1)}},"🔔 Mis Recordatorios")),t.createElement("div",{className:"border-b border-gray-200 pb-2 mb-2"},t.createElement("div",{className:"px-4 py-1 text-xs text-gray-500 font-semibold"},"ADMINISTRACIÓN"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/admin/marcas"),i(!1)}},"🏷️ Gestión de Marcas"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/admin/tipos-empresa"),i(!1)}},"🏢 Tipos de Empresa"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/admin/categorias"),i(!1)}},"📂 Gestión de Categorías"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/admin/proveedores"),i(!1)}},"🏪 Gestión de Proveedores"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/admin/solicitudes-cliente"),i(!1)}},"👥 Solicitudes de Clientes"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/admin/solicitudes-registro"),i(!1)}},"🏪 Solicitudes de Proveedores"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/admin/validacion-clientes"),i(!1)}},"✅ Validación de Clientes"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/admin/estadisticas"),i(!1)}},"📊 Panel de Estadísticas")),t.createElement("div",null,t.createElement("div",{className:"px-4 py-1 text-xs text-gray-500 font-semibold"},"CATASTRO"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/admin/catastro-masivo"),i(!1)}},"📊 Catastro Masivo"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/admin/panel-validacion"),i(!1)}},"🔍 Panel de Validación"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/admin/agentes-campo"),i(!1)}},"👥 Agentes de Campo")))),n&&!r||n&&r==="cliente"?t.createElement("button",{className:C("/status-cliente"),onClick:()=>{a("/status-cliente"),h()}},"👤 Mi Estado"):null,!s&&n&&(r==="admin"||r==="cliente")?null:t.createElement(t.Fragment,null,t.createElement("button",{className:C("/proveedores"),onClick:w},"Proveedores"),t.createElement("button",{className:C("/proveedores-locales"),onClick:()=>{a("/proveedores-locales"),h()}},"🏪 PyME")),t.createElement("button",{className:C("/area-cliente"),onClick:()=>{a("/area-cliente"),h()}},"👤 Área Cliente"),t.createElement("button",{className:C("/recursos"),onClick:()=>{a("/recursos"),h()}},"Recursos"),t.createElement("button",{className:C("/faq"),onClick:()=>{a("/faq"),h()}},"FAQ"),t.createElement("button",{className:C("/contacto"),onClick:()=>{a("/contacto"),h()}},"Contacto"),!s&&n&&r==="admin"?null:t.createElement("div",{className:"relative"},t.createElement("button",{className:"hover:underline flex items-center gap-1",onClick:()=>d(!u)},"🚗 Servicios",t.createElement("span",{className:"text-xs"},"▼")),u&&t.createElement("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg py-2 min-w-48 z-50"},t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/servicios/seguros"),d(!1)}},"🛡️ Seguros"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/servicios/revision-tecnica"),d(!1)}},"🔧 Revisión Técnica"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/servicios/vulcanizaciones"),d(!1)}},"🏁 Vulcanizaciones"),t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/servicios/reciclaje"),d(!1)}},"♻️ Reciclaje"),n&&t.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{a("/mis-recordatorios"),d(!1)}},"🔔 Mis Recordatorios"))),n&&r==="admin"&&S&&t.createElement(t.Fragment,null,t.createElement("button",{className:"hover:underline",onClick:()=>a("/admin/ingresar-empresa")},"Ingresar empresa"),t.createElement("button",{className:"hover:underline",onClick:()=>a("/admin/ingresar-campana")},"Ingresar campaña"),t.createElement("button",{className:"hover:underline",onClick:()=>a("/admin/ingresar-producto")},"Ingresar producto"))),t.createElement("div",{className:"flex items-center gap-4"},n&&t.createElement(d7,null),r==="admin"&&t.createElement(u7,null),r==="admin"&&t.createElement("button",{className:"flex items-center gap-1 text-sm hover:underline",onClick:()=>a("/admin/validacion-clientes")},"✅ Validar Clientes"),n&&t.createElement("button",{className:"hover:underline text-sm",onClick:()=>a("/mis-consultas")},"Mis Consultas"),n&&t.createElement("div",{className:"flex items-center gap-3"},t.createElement(m7,{user:n,rol:r,onLogout:m,navigate:a}))))}function m7({user:a,rol:e,onLogout:n,navigate:r}){var u,d;const[s,o]=p.useState(!1),i=()=>{switch(e){case"admin":return"/admin";case"proveedor":return"/dashboard/proveedor";case"agente":return"/agente";case"mecanico":return"/dashboard/mecanico";case"cliente":return"/dashboard/cliente";default:return"/dashboard/cliente"}},l=()=>{switch(e){case"admin":return"Administrador";case"empresa":return"Empresa";case"agente":return"Agente de Campo";case"mecanico":return"Mecánico";case"cliente":return"Cliente";default:return"Usuario"}},c=()=>{switch(e){case"admin":return"👑";case"empresa":return"🏪";case"agente":return"👨‍💼";case"mecanico":return"🔧";case"cliente":return"🚗";default:return"👤"}};return t.createElement("div",{className:"relative"},t.createElement("button",{onClick:()=>o(!s),className:"flex items-center gap-2 bg-blue-700 hover:bg-blue-600 px-3 py-2 rounded-lg transition-colors"},t.createElement("span",{className:"text-lg"},c()),t.createElement("div",{className:"text-left hidden md:block"},t.createElement("div",{className:"text-xs text-blue-200"},"Hola,"),t.createElement("div",{className:"text-sm font-medium truncate max-w-32",title:a.email},a.displayName||((u=a.email)==null?void 0:u.split("@")[0])||"Usuario")),t.createElement("span",{className:"text-xs"},"▼")),s&&t.createElement("div",{className:"absolute top-full right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg py-2 min-w-64 z-50"},t.createElement("div",{className:"px-4 py-3 border-b border-gray-200"},t.createElement("div",{className:"flex items-center gap-3"},t.createElement("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center text-lg"},c()),t.createElement("div",null,t.createElement("div",{className:"font-medium text-gray-900"},a.displayName||((d=a.email)==null?void 0:d.split("@")[0])||"Usuario"),t.createElement("div",{className:"text-sm text-gray-500"},l()),t.createElement("div",{className:"text-xs text-gray-400"},a.email)))),t.createElement("div",{className:"py-2"},t.createElement("button",{onClick:()=>{r(i()),o(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},t.createElement("span",null,"📊"),t.createElement("span",null,"Mi Dashboard")),t.createElement("button",{onClick:()=>{r("/"),o(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},t.createElement("span",null,"🏠"),t.createElement("span",null,"Ir al Inicio")),t.createElement("button",{onClick:()=>{r("/mis-consultas"),o(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},t.createElement("span",null,"💬"),t.createElement("span",null,"Mis Consultas")),e==="proveedor"&&t.createElement(t.Fragment,null,t.createElement("button",{onClick:()=>{r("/dashboard/proveedor/perfil"),o(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},t.createElement("span",null,"👤"),t.createElement("span",null,"Mi Perfil")),t.createElement("button",{onClick:()=>{r("/dashboard/proveedor/productos"),o(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},t.createElement("span",null,"📦"),t.createElement("span",null,"Mis Productos"))),e==="cliente"&&t.createElement(t.Fragment,null,t.createElement("button",{onClick:()=>{r("/dashboard/cliente/perfil"),o(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},t.createElement("span",null,"👤"),t.createElement("span",null,"Mi Perfil")),t.createElement("button",{onClick:()=>{r("/dashboard/cliente/vehiculos"),o(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},t.createElement("span",null,"🚗"),t.createElement("span",null,"Mis Vehículos"))),e==="agente"&&t.createElement("button",{onClick:()=>{r("/agente/empresas"),o(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},t.createElement("span",null,"🏢"),t.createElement("span",null,"Registrar Empresa"))),t.createElement("div",{className:"border-t border-gray-200 pt-2"},t.createElement("button",{onClick:()=>{n(),o(!1)},className:"w-full text-left px-4 py-2 text-red-600 hover:bg-red-50 flex items-center gap-3"},t.createElement("span",null,"🚪"),t.createElement("span",null,"Cerrar Sesión")))))}const p7=()=>{const a=Ct();return t.createElement("div",{className:"relative bg-gradient-to-br from-blue-900 via-blue-800 to-blue-600 text-white overflow-hidden"},t.createElement(za,null),t.createElement("div",{className:"absolute inset-0 opacity-20",style:{pointerEvents:"none"}},t.createElement("svg",{width:"60",height:"60",viewBox:"0 0 60 60",xmlns:"http://www.w3.org/2000/svg",className:"w-full h-full"},t.createElement("g",{fill:"none",fillRule:"evenodd"},t.createElement("g",{fill:"#ffffff",fillOpacity:"0.05"},t.createElement("circle",{cx:"7",cy:"7",r:"7"}))))),t.createElement("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 lg:py-24"},t.createElement("div",{className:"grid lg:grid-cols-2 gap-12 items-center"},t.createElement("div",{className:"space-y-8"},t.createElement("div",{className:"space-y-4"},t.createElement("h1",{className:"text-4xl lg:text-6xl font-bold leading-tight"},t.createElement("span",{className:"bg-gradient-to-r from-yellow-400 to-orange-400 bg-clip-text text-transparent"},"200+")," ","Proveedores",t.createElement("br",null),t.createElement("span",{className:"text-3xl lg:text-5xl"},"del sector automotriz")),t.createElement("p",{className:"text-xl lg:text-2xl text-blue-100 max-w-lg"},"Descubre repuestos, servicios y las mejores ofertas en la",t.createElement("strong",{className:"text-yellow-400"}," Av. 10 de Julio"))),t.createElement("div",{className:"grid grid-cols-3 gap-4"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-2xl lg:text-3xl font-bold text-yellow-400"},"200+"),t.createElement("div",{className:"text-sm text-blue-200"},"Proveedores")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-2xl lg:text-3xl font-bold text-yellow-400"},"1000+"),t.createElement("div",{className:"text-sm text-blue-200"},"Productos")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-2xl lg:text-3xl font-bold text-yellow-400"},"50+"),t.createElement("div",{className:"text-sm text-blue-200"},"Campañas"))),t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"flex flex-col sm:flex-row gap-4"},t.createElement("button",{onClick:()=>a("/proveedores"),className:"bg-yellow-400 hover:bg-yellow-500 text-blue-900 px-8 py-3 rounded-lg font-semibold text-lg transition-all transform hover:scale-105 shadow-lg"},"Ver Proveedores"),t.createElement("button",{onClick:()=>a("/proveedores-locales"),className:"border-2 border-white text-white hover:bg-white hover:text-blue-900 px-8 py-3 rounded-lg font-semibold text-lg transition-all"},"🏪 PyMEs Locales")),t.createElement("div",{className:"flex flex-col sm:flex-row gap-3"},t.createElement("button",{onClick:()=>a("/login?tipo=cliente"),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium text-sm transition-all shadow-md flex items-center justify-center gap-2"},"🔑 ",t.createElement("span",null,"Acceso Clientes")),t.createElement("button",{onClick:()=>a("/login?tipo=empresa"),className:"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-medium text-sm transition-all shadow-md flex items-center justify-center gap-2"},"🏢 ",t.createElement("span",null,"Acceso Empresas")),t.createElement("button",{onClick:()=>a("/registro-cliente"),className:"bg-white/20 hover:bg-white/30 text-white border border-white/30 px-6 py-2 rounded-lg font-medium text-sm transition-all flex items-center justify-center gap-2"},"➕ ",t.createElement("span",null,"Registrarse"))))),t.createElement("div",{className:"relative"},t.createElement("div",{className:"relative z-10 bg-white/10 backdrop-blur-sm rounded-2xl p-8 border border-white/20"},t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"flex items-center space-x-3"},t.createElement("div",{className:"w-12 h-12 bg-yellow-400 rounded-lg flex items-center justify-center"},t.createElement("span",{className:"text-blue-900 text-2xl"},"🚗")),t.createElement("div",null,t.createElement("h3",{className:"font-semibold"},"Repuestos Originales y Alternativos"),t.createElement("p",{className:"text-blue-200 text-sm"},"Calidad garantizada"))),t.createElement("div",{className:"flex items-center space-x-3"},t.createElement("div",{className:"w-12 h-12 bg-green-400 rounded-lg flex items-center justify-center"},t.createElement("span",{className:"text-white text-2xl"},"🛠️")),t.createElement("div",null,t.createElement("h3",{className:"font-semibold"},"Servicios Especializados"),t.createElement("p",{className:"text-blue-200 text-sm"},"Técnicos expertos"))),t.createElement("div",{className:"flex items-center space-x-3"},t.createElement("div",{className:"w-12 h-12 bg-orange-400 rounded-lg flex items-center justify-center"},t.createElement("span",{className:"text-white text-2xl"},"💰")),t.createElement("div",null,t.createElement("h3",{className:"font-semibold"},"Mejores Precios"),t.createElement("p",{className:"text-blue-200 text-sm"},"Ofertas exclusivas"))))),t.createElement("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-yellow-400/20 rounded-full blur-xl"}),t.createElement("div",{className:"absolute -bottom-8 -left-8 w-32 h-32 bg-orange-400/20 rounded-full blur-xl"})))),t.createElement("div",{className:"bg-white text-gray-800"},t.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16"},t.createElement("div",{className:"text-center mb-12"},t.createElement("h2",{className:"text-3xl lg:text-4xl font-bold text-gray-900 mb-4"},"Únete a Nuestra ",t.createElement("span",{className:"text-blue-600"},"Comunidad")),t.createElement("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto"},"Tanto si eres dueño de vehículo como emprendedor automotriz, tenemos beneficios especiales para ti en la Av. 10 de Julio")),t.createElement("div",{className:"grid lg:grid-cols-2 gap-12"},t.createElement("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-100 rounded-2xl p-8 border border-blue-200"},t.createElement("div",{className:"text-center mb-6"},t.createElement("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4"},t.createElement("span",{className:"text-white text-3xl"},"👤")),t.createElement("h3",{className:"text-2xl font-bold text-blue-900"},"Para Clientes"),t.createElement("p",{className:"text-blue-700"},"Registra tu vehículo y obtén beneficios únicos")),t.createElement("div",{className:"space-y-4 mb-8"},t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},t.createElement("span",{className:"text-white text-xs"},"✓")),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900"},"Recordatorios Inteligentes"),t.createElement("p",{className:"text-gray-600 text-sm"},"Permiso de circulación, revisión técnica, seguros y mantenciones"))),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},t.createElement("span",{className:"text-white text-xs"},"✓")),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900"},"Ofertas Personalizadas"),t.createElement("p",{className:"text-gray-600 text-sm"},"Promociones según tu marca y modelo de vehículo"))),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},t.createElement("span",{className:"text-white text-xs"},"✓")),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900"},"Historial de Gastos"),t.createElement("p",{className:"text-gray-600 text-sm"},"Controla y planifica los gastos de tu vehículo"))),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},t.createElement("span",{className:"text-white text-xs"},"✓")),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900"},"Red de Proveedores Locales"),t.createElement("p",{className:"text-gray-600 text-sm"},"Acceso directo a talleres y repuestos cerca de ti")))),t.createElement("div",{className:"space-y-3"},t.createElement("button",{onClick:()=>a("/registro-cliente"),className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-6 rounded-lg font-semibold transition-all transform hover:scale-105"},"🚗 Registrar Mi Vehículo"),t.createElement("button",{onClick:()=>a("/login?tipo=cliente"),className:"w-full bg-white border-2 border-blue-600 text-blue-600 py-3 px-6 rounded-lg font-semibold transition-all hover:bg-blue-50"},"🔑 Ya Tengo Cuenta - Ingresar"))),t.createElement("div",{className:"bg-gradient-to-br from-orange-50 to-red-100 rounded-2xl p-8 border border-orange-200"},t.createElement("div",{className:"text-center mb-6"},t.createElement("div",{className:"w-16 h-16 bg-orange-600 rounded-full flex items-center justify-center mx-auto mb-4"},t.createElement("span",{className:"text-white text-3xl"},"�")),t.createElement("h3",{className:"text-2xl font-bold text-orange-900"},"Para Proveedores y Empresas"),t.createElement("p",{className:"text-orange-700"},"Únete a los 200+ proveedores de nuestra comunidad")),t.createElement("div",{className:"space-y-4 mb-8"},t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},t.createElement("span",{className:"text-white text-xs"},"✓")),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900"},"Acceso a Miles de Clientes"),t.createElement("p",{className:"text-gray-600 text-sm"},"Conecta con propietarios de vehículos que buscan servicios confiables"))),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},t.createElement("span",{className:"text-white text-xs"},"✓")),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900"},"Presencia Digital Profesional"),t.createElement("p",{className:"text-gray-600 text-sm"},"Tu empresa visible en la mayor plataforma automotriz de la zona"))),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},t.createElement("span",{className:"text-white text-xs"},"✓")),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900"},"Herramientas de Promoción"),t.createElement("p",{className:"text-gray-600 text-sm"},"Gestiona campañas y ofertas para aumentar tus ventas"))),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},t.createElement("span",{className:"text-white text-xs"},"✓")),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900"},"Validación y Credibilidad"),t.createElement("p",{className:"text-gray-600 text-sm"},"Forma parte de proveedores verificados y de confianza"))),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},t.createElement("span",{className:"text-white text-xs"},"✓")),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900"},"Red de Colaboración"),t.createElement("p",{className:"text-gray-600 text-sm"},"Conecta con otros proveedores y amplía tu red de negocios")))),t.createElement("div",{className:"space-y-3"},t.createElement("button",{onClick:()=>a("/registro-proveedor"),className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-3 px-6 rounded-lg font-semibold transition-all transform hover:scale-105"},"🏢 Registrar Mi Empresa"),t.createElement("button",{onClick:()=>a("/login?tipo=empresa"),className:"w-full bg-white border-2 border-orange-600 text-orange-600 py-3 px-6 rounded-lg font-semibold transition-all hover:bg-orange-50"},"🔑 Ya Tengo Cuenta - Ingresar"),t.createElement("button",{onClick:()=>a("/solicitud-comunidad"),className:"w-full bg-green-600 hover:bg-green-700 text-white py-3 px-6 rounded-lg font-semibold transition-all transform hover:scale-105"},"🤝 Unirse a la Comunidad"),t.createElement("button",{onClick:()=>a("/proveedores"),className:"w-full border-2 border-orange-600 text-orange-600 hover:bg-orange-600 hover:text-white py-3 px-6 rounded-lg font-semibold transition-all"},"� Ver Todos los Proveedores")))),t.createElement("div",{className:"mt-16 bg-gray-50 rounded-2xl p-8"},t.createElement("div",{className:"text-center mb-8"},t.createElement("h3",{className:"text-2xl font-bold text-gray-900 mb-2"},"Nuestra Red de Proveedores en Números"),t.createElement("p",{className:"text-gray-600"},"Únete a la mayor comunidad automotriz de la Av. 10 de Julio")),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-blue-600 mb-2"},"2,500+"),t.createElement("div",{className:"text-gray-600 text-sm"},"Vehículos Registrados")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-orange-600 mb-2"},"200+"),t.createElement("div",{className:"text-gray-600 text-sm"},"Proveedores Verificados")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-green-600 mb-2"},"8,500+"),t.createElement("div",{className:"text-gray-600 text-sm"},"Conexiones Realizadas")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-purple-600 mb-2"},"98%"),t.createElement("div",{className:"text-gray-600 text-sm"},"Satisfacción Cliente")))))))},g7=({onResultsChange:a,placeholder:e="Buscar empresas, productos, campañas...",showFilters:n=!0})=>{const[r,s]=p.useState(""),[o,i]=p.useState(!1),[l,c]=p.useState({tipo:"todos",tipoEmpresa:"todos",categoria:"",marca:"",region:"",verificado:"todos"}),[u,d]=p.useState([]),[m,h]=p.useState([]),[C,S]=p.useState([]),[w,f]=p.useState([]),[b,v]=p.useState([]),[I,A]=p.useState([]);p.useEffect(()=>{const V=wa(W(F,"empresas"),z=>{const j=z.docs.map(U=>({id:U.id,...U.data(),tipo:"empresa",origen:"legacy"}));d(j)});return()=>V()},[]),p.useEffect(()=>{const V=wa(W(F,"productos"),z=>{const j=z.docs.map(U=>({id:U.id,...U.data(),tipo:"producto"}));h(j)});return()=>V()},[]),p.useEffect(()=>{const V=wa(W(F,"campañas"),z=>{const j=z.docs.map(U=>({id:U.id,...U.data(),tipo:"campaña"}));S(j)});return()=>V()},[]),p.useEffect(()=>{const V=fe(W(F,"solicitudes_empresa"),pe("estado","==","aprobada")),z=wa(V,j=>{const U=j.docs.map(Q=>({id:Q.id,...Q.data(),tipo:"empresa",origen:"nuevo"}));f(U)});return()=>{z()}},[]),p.useEffect(()=>{const V=new Set,z=new Set;u.forEach(j=>{j.categorias&&j.categorias.forEach(U=>V.add(U)),j.marcas&&j.marcas.forEach(U=>z.add(U))}),m.forEach(j=>{j.categoria&&V.add(j.categoria),j.marca&&z.add(j.marca)}),w.forEach(j=>{j.sectorAutomotriz&&V.add(j.sectorAutomotriz),j.marcasQueManeja&&j.marcasQueManeja.forEach(U=>z.add(U))}),v(Array.from(V).sort()),A(Array.from(z).sort())},[u,m,w]),p.useEffect(()=>{const V=N();a&&a(V)},[r,l,u,m,C,w]);const N=()=>{let V=[];const z=u.filter(Q=>Q.estado==="Activa").map(Q=>x(Q,"legacy")),j=w.map(Q=>x(Q,"nuevo")),U=[...z,...j];return(l.tipo==="todos"||l.tipo==="empresas")&&V.push(...U),(l.tipo==="todos"||l.tipo==="productos")&&V.push(...m.map(y)),(l.tipo==="todos"||l.tipo==="campañas")&&V.push(...C.map(E)),V=P(V),V},x=(V,z)=>({id:`empresa-${z}-${V.id}`,tipo:"empresa",titulo:V.nombre||V.nombreEmpresa,subtitulo:V.descripcion||V.giroComercial,descripcion:`${V.direccion||""}, ${V.comuna||""}`.trim().replace(/^,/,""),imagen:V.imagen||V.logo,tipoEmpresa:V.tipoEmpresa||_(V),verificado:V.verificado||z==="nuevo",premium:V.esPremium||!1,categorias:V.categorias||[V.sectorAutomotriz].filter(Boolean),marcas:V.marcas||V.marcasQueManeja||[],region:V.region,comuna:V.comuna,telefono:V.telefono,email:V.email,sitioWeb:V.sitioWeb,origen:z,fechaRegistro:V.fechaRegistro||V.fechaSolicitud,rating:V.rating||0,url:`/empresa/${V.id}`,searchText:`${V.nombre||V.nombreEmpresa} ${V.descripcion||V.giroComercial} ${V.direccion||""} ${(V.categorias||[]).join(" ")} ${(V.marcas||[]).join(" ")}`}),y=V=>({id:`producto-${V.id}`,tipo:"producto",titulo:V.nombre,subtitulo:V.marca,descripcion:V.descripcion,imagen:V.imagen,precio:V.precio,categoria:V.categoria,marca:V.marca,empresa:V.empresa,disponible:V.disponible,url:`/producto/${V.id}`,searchText:`${V.nombre} ${V.marca} ${V.descripcion} ${V.categoria} ${V.empresa}`}),E=V=>({id:`campaña-${V.id}`,tipo:"campaña",titulo:V.titulo,subtitulo:V.empresa,descripcion:V.descripcion,imagen:V.imagen,descuento:V.descuento,fechaInicio:V.fechaInicio,fechaFin:V.fechaFin,empresa:V.empresa,activa:new Date>=new Date(V.fechaInicio)&&new Date<=new Date(V.fechaFin),url:`/campaña/${V.id}`,searchText:`${V.titulo} ${V.descripcion} ${V.empresa}`}),_=V=>V.esPyme?"pyme":V.esEmprendimiento?"emprendimiento":V.esTaller?"taller":V.esDistribuidor?"distribuidor":"proveedor",P=V=>{let z=[...V];if(r.trim()){const j=r.toLowerCase().trim().split(" ");z=z.filter(U=>j.every(Q=>U.searchText.toLowerCase().includes(Q)))}return l.tipoEmpresa!=="todos"&&(z=z.filter(j=>j.tipo!=="empresa"||j.tipoEmpresa===l.tipoEmpresa)),l.categoria&&(z=z.filter(j=>j.tipo==="empresa"?j.categorias&&j.categorias.includes(l.categoria):j.tipo==="producto"?j.categoria===l.categoria:!0)),l.marca&&(z=z.filter(j=>j.tipo==="empresa"?j.marcas&&j.marcas.includes(l.marca):j.tipo==="producto"?j.marca===l.marca:!0)),l.region&&(z=z.filter(j=>j.tipo!=="empresa"||j.region===l.region)),l.verificado!=="todos"&&(z=z.filter(j=>j.tipo!=="empresa"?!0:l.verificado==="verificado"?j.verificado:l.verificado==="premium"?j.premium:!0)),z},k=V=>{s(V.target.value)},D=(V,z)=>{c(j=>({...j,[V]:z}))},M=()=>{s(""),c({tipo:"todos",tipoEmpresa:"todos",categoria:"",marca:"",region:"",verificado:"todos"}),i(!1)},$=[r,l.tipo!=="todos"?l.tipo:null,l.tipoEmpresa!=="todos"?l.tipoEmpresa:null,l.categoria,l.marca,l.region,l.verificado!=="todos"?l.verificado:null].filter(Boolean).length,q=[{label:"Frenos",tipo:"categoria"},{label:"Toyota",tipo:"marca"},{label:"Aceite",tipo:"categoria"},{label:"Baterías",tipo:"categoria"},{label:"Talleres",tipo:"tipoEmpresa",valor:"taller"},{label:"PyMEs",tipo:"tipoEmpresa",valor:"pyme"}];return t.createElement("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6 mb-8"},t.createElement("div",{className:"relative"},t.createElement("div",{className:"relative"},t.createElement(i7,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),t.createElement("input",{type:"text",value:r,onChange:k,placeholder:e,className:"w-full pl-12 pr-24 py-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg"}),t.createElement("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center space-x-2"},$>0&&t.createElement("button",{onClick:M,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Limpiar filtros"},t.createElement(VA,{className:"h-5 w-5"})),n&&t.createElement("button",{onClick:()=>i(!o),className:`relative p-2 rounded-lg transition-colors ${o||$>0?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600"}`,title:"Filtros avanzados"},t.createElement(Hz,{className:"h-5 w-5"}),$>0&&t.createElement("span",{className:"absolute -top-1 -right-1 bg-blue-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},$)))),t.createElement("div",{className:"mt-4 flex flex-wrap gap-2 items-center"},t.createElement("span",{className:"text-sm text-gray-500"},"Búsquedas populares:"),q.map((V,z)=>t.createElement("button",{key:z,onClick:()=>{V.tipo==="categoria"||V.tipo==="marca"?s(V.label):V.tipo==="tipoEmpresa"&&D("tipoEmpresa",V.valor)},className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm rounded-full transition-colors"},V.label)))),o&&t.createElement("div",{className:"mt-6 pt-6 border-t border-gray-200"},t.createElement("div",{className:"grid md:grid-cols-3 lg:grid-cols-4 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tipo de contenido"),t.createElement("select",{value:l.tipo,onChange:V=>D("tipo",V.target.value),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},t.createElement("option",{value:"todos"},"Todo"),t.createElement("option",{value:"empresas"},"Empresas"),t.createElement("option",{value:"productos"},"Productos"),t.createElement("option",{value:"campañas"},"Campañas"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tipo de empresa"),t.createElement("select",{value:l.tipoEmpresa,onChange:V=>D("tipoEmpresa",V.target.value),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},t.createElement("option",{value:"todos"},"Todas"),t.createElement("option",{value:"proveedor"},"Proveedores"),t.createElement("option",{value:"pyme"},"PyMEs"),t.createElement("option",{value:"emprendimiento"},"Emprendimientos"),t.createElement("option",{value:"taller"},"Talleres"),t.createElement("option",{value:"distribuidor"},"Distribuidores"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Categoría"),t.createElement("select",{value:l.categoria,onChange:V=>D("categoria",V.target.value),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},t.createElement("option",{value:""},"Todas las categorías"),b.map(V=>t.createElement("option",{key:V,value:V},V)))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Marca"),t.createElement("select",{value:l.marca,onChange:V=>D("marca",V.target.value),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},t.createElement("option",{value:""},"Todas las marcas"),I.map(V=>t.createElement("option",{key:V,value:V},V)))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Verificación"),t.createElement("select",{value:l.verificado,onChange:V=>D("verificado",V.target.value),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},t.createElement("option",{value:"todos"},"Todas"),t.createElement("option",{value:"verificado"},"Solo verificadas"),t.createElement("option",{value:"premium"},"Solo premium"))))))};function f7(){const[a,e]=p.useState([]),[n,r]=p.useState(0);if(p.useEffect(()=>{const o=new Date,i=fe(W(F,"campanas"),pe("fechaInicio","<=",o),pe("fechaFin",">=",o));return wa(i,c=>{e(c.docs.map(u=>({id:u.id,...u.data()})))})},[]),p.useEffect(()=>{if(a.length<=1)return;const o=setInterval(()=>r(i=>(i+1)%a.length),1e4);return()=>clearInterval(o)},[a]),a.length===0)return null;const s=a[n];return t.createElement("div",{className:"bg-yellow-100 border border-yellow-300 p-3 mb-6 rounded flex items-center justify-between shadow"},t.createElement("a",{href:s.link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-4 w-full"},t.createElement("img",{src:s.imagenURL,alt:s.titulo,className:"h-16 w-32 object-contain rounded"}),t.createElement("div",null,t.createElement("h3",{className:"font-bold"},s.titulo),t.createElement("p",{className:"text-sm"},s.descripcion))))}const OA=async()=>{try{console.log("🔍 Iniciando test de conexión a empresas...");const a=fe(W(F,"empresas"),Ot(10)),e=await le(a);if(console.log("📊 Total empresas encontradas:",e.size),e.size>0){console.log("🏢 Lista de empresas:"),e.docs.forEach((r,s)=>{const o=r.data();console.log(`${s+1}. ID: ${r.id}`),console.log(`   Nombre: ${o.nombre||"Sin nombre"}`),console.log(`   Estado: "${o.estado}" (tipo: ${typeof o.estado})`),console.log(`   Tipo: ${o.tipoEmpresa||"Sin tipo"}`),console.log(`   Ciudad: ${o.ciudad||"Sin ciudad"}`),console.log("   ---")});const n={};e.docs.forEach(r=>{const s=r.data().estado;n[s]=(n[s]||0)+1}),console.log("📈 Análisis de estados:"),Object.entries(n).forEach(([r,s])=>{console.log(`   "${r}": ${s} empresas`)})}else console.log("❌ No se encontraron empresas en la colección");return{total:e.size,empresas:e.docs.map(n=>({id:n.id,...n.data()}))}}catch(a){return console.error("❌ Error en test de empresas:",a),{error:a.message}}};typeof window<"u"&&(window.testEmpresasConnection=OA);function h7({logo:a,nombre:e,className:n="max-h-24 max-w-24 object-contain"}){const{imageUrl:r,loading:s,error:o}=ui(a);return a?s?t.createElement("div",{className:"w-16 h-16 bg-white/20 rounded-lg flex items-center justify-center"},t.createElement("div",{className:"w-6 h-6 border-2 border-white/50 border-t-white rounded-full animate-spin"})):o||!r?t.createElement("div",{className:"w-16 h-16 bg-white/20 rounded-lg flex items-center justify-center"},t.createElement("span",{className:"text-lg font-bold text-white"},"!")):t.createElement("img",{className:n,src:r,alt:e,onError:i=>{i.target.style.display="none",i.target.nextSibling.style.display="flex"}}):t.createElement("div",{className:"w-16 h-16 bg-white/20 rounded-lg flex items-center justify-center"},t.createElement("span",{className:"text-2xl font-bold text-white"},e?e.charAt(0).toUpperCase():"?"))}const gw=()=>{const a=Ct(),[e,n]=p.useState([]),[r,s]=p.useState([]),[o,i]=p.useState(!0),[l,c]=p.useState("");return p.useEffect(()=>{const d=(async()=>{try{i(!0),console.log("🔍 Configurando listener real-time para empresas activas...");const m=await OA();console.log("🧪 Resultado del test:",m);const h=fe(W(F,"empresas"),pe("estado","in",[ce.ACTIVA,ce.VALIDADA]),st("fecha_creacion","desc"),Ot(20));return wa(h,S=>{console.log("📊 Empresas activas actualizadas en tiempo real:",S.size);const w=S.docs.map(f=>({id:f.id,...f.data()}));w.sort((f,b)=>{var A,N,x,y;const v=((N=(A=f.fecha_creacion)==null?void 0:A.toDate)==null?void 0:N.call(A))||f.fecha_creacion||new Date(0);return(((y=(x=b.fecha_creacion)==null?void 0:x.toDate)==null?void 0:y.call(x))||b.fecha_creacion||new Date(0))-v}),console.log("✅ Empresas activas cargadas:",w.length),n(w),i(!1)},S=>{console.error("❌ Error en listener real-time:",S),i(!1)})}catch(m){console.error("❌ Error configurando listener:",m),i(!1)}})();return()=>{d&&typeof d=="function"&&d()}},[]),p.useEffect(()=>{let u=[...e];l&&(u=u.filter(d=>(d.tipoEmpresa||"").toLowerCase()===l.toLowerCase())),console.log("🔍 Empresas después del filtro:",u.length),console.log("📋 Filtro actual:",l||"Sin filtro"),s(u)},[e,l]),t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(p7,null),t.createElement("div",{className:"bg-white shadow-sm border-b border-gray-200"},t.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},t.createElement(g7,null))),t.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"},t.createElement("div",{className:"text-center mb-12"},t.createElement("h2",{className:"text-3xl font-bold text-gray-900 mb-4"},"Servicios Automotrices"),t.createElement("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto"},"Encuentra todo lo que necesitas para tu vehículo en un solo lugar")),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8"},t.createElement("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow"},t.createElement("div",{className:"flex items-center justify-center w-12 h-12 bg-blue-100 rounded-lg mb-4"},t.createElement("span",{className:"text-2xl"},"🛡️")),t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-2"},"Seguros"),t.createElement("p",{className:"text-gray-600 mb-4"},"Protege tu vehículo con los mejores seguros"),t.createElement("a",{href:"/servicios/seguros",className:"text-blue-600 hover:text-blue-800 font-medium"},"Ver más →")),t.createElement("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow"},t.createElement("div",{className:"flex items-center justify-center w-12 h-12 bg-green-100 rounded-lg mb-4"},t.createElement("span",{className:"text-2xl"},"🔧")),t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-2"},"Revisión Técnica"),t.createElement("p",{className:"text-gray-600 mb-4"},"Agenda tu revisión técnica fácil y rápido"),t.createElement("a",{href:"/servicios/revision-tecnica",className:"text-blue-600 hover:text-blue-800 font-medium"},"Ver más →")),t.createElement("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow"},t.createElement("div",{className:"flex items-center justify-center w-12 h-12 bg-orange-100 rounded-lg mb-4"},t.createElement("span",{className:"text-2xl"},"🏁")),t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-2"},"Vulcanizaciones"),t.createElement("p",{className:"text-gray-600 mb-4"},"Servicio de neumáticos y reparaciones"),t.createElement("a",{href:"/servicios/vulcanizaciones",className:"text-blue-600 hover:text-blue-800 font-medium"},"Ver más →")),t.createElement("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow"},t.createElement("div",{className:"flex items-center justify-center w-12 h-12 bg-green-100 rounded-lg mb-4"},t.createElement("span",{className:"text-2xl"},"♻️")),t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-2"},"Reciclaje"),t.createElement("p",{className:"text-gray-600 mb-4"},"Programa de reciclaje automotriz"),t.createElement("a",{href:"/servicios/reciclaje",className:"text-blue-600 hover:text-blue-800 font-medium"},"Ver más →")))),t.createElement("div",{className:"bg-gray-100 py-8"},t.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},t.createElement(f7,null))),t.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"},t.createElement("div",{className:"text-center mb-12"},t.createElement("h2",{className:"text-3xl font-bold text-gray-900 mb-4"},"Empresas Verificadas"),t.createElement("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto"},"Descubre las empresas automotrices activas y verificadas en nuestra plataforma. Haz clic en cualquier empresa para ver su perfil completo en una nueva pestaña."),t.createElement("div",{className:"mt-4 text-sm text-gray-500"},"Total empresas: ",e.length," | Filtradas: ",r.length)),t.createElement("div",{className:"flex justify-center mb-8"},t.createElement("div",{className:"max-w-xs"},t.createElement("select",{value:l,onChange:u=>c(u.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},t.createElement("option",{value:""},"Todos los tipos"),t.createElement("option",{value:"proveedor"},"🔧 Proveedores"),t.createElement("option",{value:"pyme"},"⭐ PyMEs"),t.createElement("option",{value:"empresa"},"🏢 Empresas"),t.createElement("option",{value:"emprendimiento"},"🚀 Emprendimientos"),t.createElement("option",{value:"local"},"📍 Locales"),t.createElement("option",{value:"premium"},"💎 Premium")))),o?t.createElement("div",{className:"flex justify-center items-center py-12"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})):r.length>0?t.createElement(t.Fragment,null,t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},r.map(u=>t.createElement("div",{key:u.id,className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>window.open(`/empresa/${u.id}`,"_blank")},t.createElement("div",{className:"h-32 bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center"},t.createElement(h7,{logo:u.logo_url||u.logo,nombre:u.nombre,className:"max-h-24 max-w-24 object-contain"})),t.createElement("div",{className:"p-4"},t.createElement("div",{className:"flex items-center justify-between mb-2"},t.createElement("h3",{className:"font-semibold text-gray-900 truncate"},u.nombre||"Sin nombre"),t.createElement("div",{className:"flex items-center gap-2"},t.createElement("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium "+((u.tipoEmpresa||"").toLowerCase()==="proveedor"?"bg-blue-100 text-blue-800":(u.tipoEmpresa||"").toLowerCase()==="pyme"?"bg-yellow-100 text-yellow-800":(u.tipoEmpresa||"").toLowerCase()==="empresa"?"bg-green-100 text-green-800":(u.tipoEmpresa||"").toLowerCase()==="emprendimiento"?"bg-purple-100 text-purple-800":(u.tipoEmpresa||"").toLowerCase()==="local"?"bg-pink-100 text-pink-800":(u.tipoEmpresa||"").toLowerCase()==="premium"?"bg-gray-800 text-white":"bg-gray-100 text-gray-800")},u.tipoEmpresa?`🏷️ ${u.tipoEmpresa.charAt(0).toUpperCase()+u.tipoEmpresa.slice(1)}`:"🏷️ Sin tipo"),t.createElement("span",{className:"text-xs text-gray-500",title:"Abrir en nueva pestaña"},"↗️"))),t.createElement("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2"},u.descripcion||"Empresa de servicios automotrices"),u.ciudad&&t.createElement("div",{className:"flex items-center text-sm text-gray-500 mb-2"},t.createElement("span",{className:"mr-1"},"📍"),t.createElement("span",null,u.ciudad,", ",u.region)),u.servicios&&u.servicios.length>0&&t.createElement("div",{className:"flex flex-wrap gap-1 mb-2"},t.createElement("span",{className:"text-xs text-gray-500 font-medium mb-1 block w-full"},"Servicios:"),u.servicios.slice(0,2).map((d,m)=>t.createElement("span",{key:m,className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded"},d)),u.servicios.length>2&&t.createElement("span",{className:"inline-block bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded"},"+",u.servicios.length-2," más")),u.marcas&&u.marcas.length>0&&t.createElement("div",{className:"flex flex-wrap gap-1"},t.createElement("span",{className:"text-xs text-gray-500 font-medium mb-1 block w-full"},"Marcas:"),u.marcas.slice(0,2).map((d,m)=>t.createElement("span",{key:m,className:"inline-block bg-green-100 text-green-800 text-xs px-2 py-1 rounded"},d)),u.marcas.length>2&&t.createElement("span",{className:"inline-block bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded"},"+",u.marcas.length-2," más")))))),t.createElement("div",{className:"text-center"},t.createElement("button",{onClick:()=>a("/proveedores"),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors"},"Ver Todas las Empresas",t.createElement("span",{className:"ml-2"},"→")))):e.length>0?t.createElement("div",{className:"text-center py-12"},t.createElement("div",{className:"text-gray-500 mb-4"},t.createElement("span",{className:"text-4xl"},"🔍")),t.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No hay empresas del tipo seleccionado"),t.createElement("p",{className:"text-gray-600 mb-6"},'Intenta cambiar el filtro o selecciona "Todos los tipos"'),t.createElement("button",{onClick:()=>c(""),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-600 bg-blue-100 hover:bg-blue-200 transition-colors"},"Mostrar Todas las Empresas")):t.createElement("div",{className:"text-center py-12"},t.createElement("div",{className:"text-gray-500 mb-4"},t.createElement("span",{className:"text-4xl"},"🏢")),t.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No hay empresas activas disponibles"),t.createElement("p",{className:"text-gray-600 mb-6"},"Estamos verificando nuevas empresas constantemente"),t.createElement("button",{onClick:()=>a("/registro-proveedor"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-600 bg-blue-100 hover:bg-blue-200 transition-colors"},"Registrar mi Empresa"))),t.createElement("div",{className:"bg-blue-600 py-16"},t.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center"},t.createElement("h2",{className:"text-3xl font-bold text-white mb-4"},"¿Eres una empresa automotriz?"),t.createElement("p",{className:"text-xl text-blue-100 mb-8 max-w-2xl mx-auto"},"Únete a nuestra comunidad y conecta con miles de clientes"),t.createElement("div",{className:"space-x-4"},t.createElement("a",{href:"/solicitud-comunidad",className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-blue-600 bg-white hover:bg-gray-50"},"Unirse a la Comunidad"),t.createElement("a",{href:"/registro-proveedor",className:"inline-flex items-center px-6 py-3 border border-white text-base font-medium rounded-md text-white hover:bg-blue-700"},"Registrar Empresa")))),t.createElement("footer",{className:"bg-gray-800 text-white py-8"},t.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8"},t.createElement("div",null,t.createElement("h3",{className:"text-lg font-semibold mb-4"},"AV10 de Julio"),t.createElement("p",{className:"text-gray-300"},"La plataforma automotriz más completa de Chile")),t.createElement("div",null,t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Enlaces"),t.createElement("ul",{className:"space-y-2 text-gray-300"},t.createElement("li",null,t.createElement("a",{href:"/contacto",className:"hover:text-white"},"Contacto")),t.createElement("li",null,t.createElement("a",{href:"/recursos-educativos",className:"hover:text-white"},"Recursos")),t.createElement("li",null,t.createElement("a",{href:"/faq",className:"hover:text-white"},"FAQ")))),t.createElement("div",null,t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Para Empresas"),t.createElement("ul",{className:"space-y-2 text-gray-300"},t.createElement("li",null,t.createElement("a",{href:"/proveedores-locales",className:"hover:text-white"},"Proveedores")),t.createElement("li",null,t.createElement("a",{href:"/registro-proveedor",className:"hover:text-white"},"Registro")),t.createElement("li",null,t.createElement("a",{href:"/login",className:"hover:text-white"},"Acceso"))))),t.createElement("div",{className:"border-t border-gray-700 mt-8 pt-8 text-center text-gray-300"},t.createElement("p",null,"© 2025 AV10 de Julio. Todos los derechos reservados.")))))};function v7(){const{id:a}=Ni(),e=Ct(),[n,r]=p.useState(null),[s,o]=p.useState(!0);if(p.useEffect(()=>{async function l(){o(!0);try{const c=Ne(F,"solicitudes_empresa",a),u=await en(c);u.exists()?r({id:u.id,...u.data()}):r(null)}catch{r(null)}finally{o(!1)}}l()},[a]),s)return t.createElement("div",{className:"p-8 text-center text-gray-500"},"Cargando solicitud...");if(!n)return t.createElement("div",{className:"p-8 text-center text-red-600"},"Solicitud no encontrada");const i=l=>({pendiente:"yellow",en_revision:"blue",activada:"green",credenciales_asignadas:"purple",rechazada:"red"})[l]||"gray";return t.createElement("div",{className:"p-8 max-w-4xl mx-auto"},t.createElement("div",{className:"flex justify-between items-center mb-6"},t.createElement("h2",{className:"text-2xl font-bold text-blue-900"},"Visualización de Solicitud"),t.createElement("button",{className:"text-gray-400 hover:text-gray-600 text-2xl",onClick:()=>e(-1)},"✕")),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},t.createElement("div",null,t.createElement("h3",{className:"text-lg font-semibold text-gray-800 mb-2"},"Empresa"),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"Nombre:")," ",n.nombre_empresa),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"Email:")," ",n.email_empresa),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"Teléfono:")," ",n.telefono_empresa),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"Dirección:")," ",n.direccion_empresa),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"Comuna:")," ",n.comuna),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"Región:")," ",n.region),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"RUT:")," ",n.rut_empresa),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"Web:")," ",n.web_actual),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"Categoría:")," ",n.categoria),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"Estado:")," ",t.createElement("span",{className:`font-bold text-${i(n.estado)}-700`},n.estado)),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"ID:")," ",n.id)),t.createElement("div",null,t.createElement("h3",{className:"text-lg font-semibold text-gray-800 mb-2"},"Representante Legal"),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"Nombres:")," ",n.nombres_representante||n.representante_nombre),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"Apellidos:")," ",n.apellidos_representante||n.representante_apellidos),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"Cargo:")," ",n.cargo_representante),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"Email:")," ",n.email_representante),t.createElement("div",{className:"mb-1"},t.createElement("span",{className:"font-medium"},"Teléfono:")," ",n.telefono_representante))),t.createElement("div",{className:"mb-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-800 mb-2"},"Descripción"),t.createElement("div",{className:"bg-gray-50 rounded p-3 text-gray-700"},n.descripcion||n.descripcion_empresa||t.createElement("span",{className:"text-red-700"},"[Sin descripción]"))),t.createElement("details",{className:"mb-4"},t.createElement("summary",{className:"cursor-pointer text-blue-700 font-medium mb-2"},"Ver información completa (debug)"),t.createElement("div",{className:"mt-2 border-t pt-2 text-xs"},t.createElement("pre",null,JSON.stringify(n,null,2)))))}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function b7(a,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{u(r.next(d))}catch(m){i(m)}}function c(d){try{u(r.throw(d))}catch(m){i(m)}}function u(d){d.done?o(d.value):s(d.value).then(l,c)}u((r=r.apply(a,e||[])).next())})}function E7(a,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,s,o,i;return i={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(u){return function(d){return c([u,d])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(o=u[0]&2?s.return:u[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,u[1])).done)return o;switch(s=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){n.label=u[1];break}if(u[0]===6&&n.label<o[1]){n.label=o[1],o=u;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(u);break}o[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(a,n)}catch(d){u=[6,d],s=0}finally{r=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var el=function(){return el=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},el.apply(this,arguments)},jA=function(a){return{loading:a==null,value:a}},x7=function(){return function(a,e){switch(e.type){case"error":return el(el({},a),{error:e.error,loading:!1,value:void 0});case"reset":return jA(e.defaultValue);case"value":return el(el({},a),{error:void 0,loading:!1,value:e.value});default:return a}}},y7=function(a){var e=a?a():void 0,n=p.useReducer(x7(),jA(e)),r=n[0],s=n[1],o=p.useCallback(function(){var c=a?a():void 0;s({type:"reset",defaultValue:c})},[a]),i=p.useCallback(function(c){s({type:"error",error:c})},[]),l=p.useCallback(function(c){s({type:"value",value:c})},[]);return p.useMemo(function(){return{error:r.error,loading:r.loading,reset:o,setError:i,setValue:l,value:r.value}},[r.error,r.loading,o,i,l,r.value])},N7=function(a,e){var n=y7(function(){return a.currentUser}),r=n.error,s=n.loading,o=n.setError,i=n.setValue,l=n.value;return p.useEffect(function(){var c=iE(a,function(u){return b7(void 0,void 0,void 0,function(){var d;return E7(this,function(m){switch(m.label){case 0:if(!(e!=null&&e.onUserChanged))return[3,4];m.label=1;case 1:return m.trys.push([1,3,,4]),[4,e.onUserChanged(u)];case 2:return m.sent(),[3,4];case 3:return d=m.sent(),o(d),[3,4];case 4:return i(u),[2]}})})},o);return function(){c()}},[a]),[l,s,r]};function w7(){const[a,e]=p.useState(""),[n,r]=p.useState(""),[s,o]=p.useState(""),[i,l]=p.useState(""),c=Ct(),u=En(),[d,m]=N7(Pt),C=new URLSearchParams(u.search).get("tipo"),S=async v=>{try{const I=fe(W(F,"agentes"),pe("email","==",v),pe("requiere_registro","==",!0));return!(await le(I)).empty}catch(I){return console.error("Error verificando agente:",I),!1}},w=async v=>{try{const I=fe(W(F,"agentes"),pe("email","==",v),pe("requiere_registro","==",!1));return!(await le(I)).empty}catch(I){return console.error("Error verificando agente registrado:",I),!1}};async function f(v){v.preventDefault(),o("");try{const I=await hI(Pt,a,n),A=await en(Ne(F,"usuarios",I.user.uid));if(A.exists()){const N=A.data(),x=N.rol,y=N.estado;if(y==="pendiente_registro"){await Tc(Pt),o(x==="agente"?t.createElement("div",{className:"text-left"},t.createElement("p",{className:"font-semibold text-red-600 mb-2"},"❌ Registro pendiente"),t.createElement("p",{className:"text-sm mb-3"},"Tu cuenta de agente fue creada pero aún no has completado el registro inicial."),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Debes usar el proceso de registro antes de poder hacer login."),t.createElement("button",{onClick:()=>c("/registro-agente"),className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Completar Registro de Agente")):"Tu cuenta está pendiente de activación. Contacta al administrador.");return}if(y==="inactivo"||N.activo===!1){await Tc(Pt),o("Tu cuenta está desactivada. Contacta al administrador.");return}c(x==="admin"?"/admin":x==="proveedor"||C==="proveedor"||i==="proveedor"?"/dashboard/proveedor":x==="agente"?"/agente":x==="mecanico"?"/dashboard/mecanico":"/dashboard/cliente")}else await S(a)?(await Tc(Pt),o(t.createElement("div",{className:"text-left"},t.createElement("p",{className:"font-semibold text-red-600 mb-2"},"❌ Registro incompleto"),t.createElement("p",{className:"text-sm mb-3"},"Tienes credenciales de agente pero no has completado el registro inicial."),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Debes completar tu registro antes de poder hacer login."),t.createElement("button",{onClick:()=>c("/registro-agente"),className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Completar Registro de Agente")))):(await Tc(Pt),o("Usuario no encontrado en el sistema. Contacta al administrador."))}catch(I){if(console.error("Error en login:",I),I.code==="auth/user-not-found"||I.code==="auth/invalid-email"||I.code==="auth/wrong-password"||I.code==="auth/invalid-credential"){const A=await S(a),N=await w(a);o(A?t.createElement("div",{className:"text-left"},t.createElement("p",{className:"font-semibold text-blue-600 mb-2"},"🔑 ¿Eres un agente nuevo?"),t.createElement("p",{className:"text-sm mb-3"},"Tienes credenciales de agente pero no has completado el registro inicial."),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Usa las credenciales que te proporcionó el administrador."),t.createElement("button",{onClick:()=>c("/registro-agente"),className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Completar Registro de Agente")):N?t.createElement("div",{className:"text-left"},t.createElement("p",{className:"font-semibold text-orange-600 mb-2"},"🔐 Agente registrado"),t.createElement("p",{className:"text-sm mb-3"},"Eres un agente del sistema pero la contraseña es incorrecta."),t.createElement("p",{className:"text-sm text-gray-600"},"Verifica tu contraseña o contacta al administrador.")):"Credenciales incorrectas. Verifica tu email y contraseña.")}else o("Error de conexión. Intenta nuevamente.")}}async function b(){await Tc(Pt),o(""),e(""),r("")}return m?t.createElement("div",{className:"flex items-center justify-center min-h-screen"},"Cargando..."):d?t.createElement("div",{className:"flex flex-col items-center justify-center min-h-screen"},t.createElement("div",{className:"bg-white p-6 rounded shadow w-80 text-center"},t.createElement("h2",{className:"text-xl font-bold mb-4"},"Ya has iniciado sesión"),t.createElement("p",{className:"mb-4"},"Usuario actual: ",t.createElement("b",null,d.email)),t.createElement("button",{onClick:b,className:"w-full bg-red-600 text-white py-2 rounded mb-2"},"Cerrar sesión"),t.createElement("button",{type:"button",onClick:()=>c("/"),className:"w-full text-blue-700 underline"},"Ir al inicio"))):t.createElement("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50"},t.createElement("div",{className:"w-full max-w-md"},!C&&t.createElement("div",{className:"bg-white p-6 rounded-lg shadow-lg mb-6"},t.createElement("h3",{className:"text-lg font-semibold text-center mb-4"},"¿Qué tipo de usuario eres?"),t.createElement("div",{className:"grid grid-cols-2 gap-4"},t.createElement("button",{onClick:()=>l("cliente"),className:`p-4 rounded-lg border-2 transition-colors ${i==="cliente"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-blue-300"}`},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl mb-2"},"🚗"),t.createElement("div",{className:"font-medium"},"Cliente"),t.createElement("div",{className:"text-sm text-gray-600"},"Tengo un vehículo"))),t.createElement("button",{onClick:()=>l("proveedor"),className:`p-4 rounded-lg border-2 transition-colors ${i==="proveedor"?"border-green-500 bg-green-50 text-green-700":"border-gray-200 hover:border-green-300"}`},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl mb-2"},"🏪"),t.createElement("div",{className:"font-medium"},"Proveedor"),t.createElement("div",{className:"text-sm text-gray-600"},"Tengo un negocio"))))),t.createElement("form",{onSubmit:f,className:"bg-white p-6 rounded-lg shadow-lg"},t.createElement("div",{className:"text-center mb-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"Iniciar sesión",(C||i)&&t.createElement("span",{className:"block text-sm font-normal text-gray-600 mt-1"},"como ",C||i))),s&&t.createElement("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4"},s),t.createElement("div",{className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Correo electrónico"),t.createElement("input",{type:"email",required:!0,placeholder:"tu@email.com",value:a,onChange:v=>e(v.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña"),t.createElement("input",{type:"password",required:!0,placeholder:"••••••••",value:n,onChange:v=>r(v.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}))),t.createElement("button",{type:"submit",className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors mt-6"},"Iniciar sesión"),t.createElement("div",{className:"mt-6 text-center space-y-3"},t.createElement("div",{className:"text-sm text-gray-600"},"¿No tienes cuenta?"),t.createElement("div",{className:"flex space-x-4"},t.createElement("button",{type:"button",onClick:()=>c("/registro-cliente"),className:"flex-1 bg-blue-100 text-blue-700 py-2 px-4 rounded-lg hover:bg-blue-200 transition-colors text-sm"},"🚗 Registro Cliente"),t.createElement("button",{type:"button",onClick:()=>c("/registro-proveedor"),className:"flex-1 bg-green-100 text-green-700 py-2 px-4 rounded-lg hover:bg-green-200 transition-colors text-sm"},"🏪 Registro Proveedor")),t.createElement("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg"},t.createElement("div",{className:"text-sm text-yellow-700 mb-2"},t.createElement("strong",null,"¿Eres un agente de la empresa?")),t.createElement("div",{className:"flex space-x-2"},t.createElement("button",{type:"button",onClick:()=>c("/registro-agente"),className:"flex-1 bg-yellow-600 text-white py-2 px-4 rounded-lg hover:bg-yellow-700 transition-colors text-sm"},"👤 Registro de Agente"),t.createElement("button",{type:"button",onClick:()=>c("/ayuda-agentes"),className:"bg-yellow-100 text-yellow-700 py-2 px-4 rounded-lg hover:bg-yellow-200 transition-colors text-sm"},"🆘 Ayuda")),t.createElement("div",{className:"text-xs text-yellow-600 mt-1"},"Usa las credenciales proporcionadas por el administrador")),t.createElement("button",{type:"button",onClick:()=>c("/"),className:"text-gray-500 hover:text-gray-700 underline text-sm"},"Volver al inicio")))))}var FA={exports:{}},Zg={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _7=p,C7=Symbol.for("react.element"),S7=Symbol.for("react.fragment"),k7=Object.prototype.hasOwnProperty,I7=_7.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,A7={key:!0,ref:!0,__self:!0,__source:!0};function zA(a,e,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)k7.call(e,r)&&!A7.hasOwnProperty(r)&&(s[r]=e[r]);if(a&&a.defaultProps)for(r in e=a.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:C7,type:a,key:o,ref:i,props:s,_owner:I7.current}}Zg.Fragment=S7;Zg.jsx=zA;Zg.jsxs=zA;FA.exports=Zg;var rn=FA.exports;function Gu(a){"@babel/helpers - typeof";return Gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gu(a)}function T7(a,e){if(Gu(a)!="object"||!a)return a;var n=a[Symbol.toPrimitive];if(n!==void 0){var r=n.call(a,e||"default");if(Gu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function P7(a){var e=T7(a,"string");return Gu(e)=="symbol"?e:e+""}function ue(a,e,n){return(e=P7(e))in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}function UA(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var ih,fw;function R7(){if(fw)return ih;fw=1;var a=function(n,r,s,o,i,l,c,u){if(!n){var d;if(r===void 0)d=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var m=[s,o,i,l,c,u],h=0;d=new Error(r.replace(/%s/g,function(){return m[h++]})),d.name="Invariant Violation"}throw d.framesToPop=1,d}};return ih=a,ih}var D7=R7(),Ca=UA(D7),dt=p.createContext(null);function L7(){Ca(!!p.useContext,"useGoogleMap is React hook and requires React version 16.8+");var a=p.useContext(dt);return Ca(!!a,"useGoogleMap needs a GoogleMap available up in the tree"),a}function M7(a,e,n){return Object.keys(a).reduce(function(s,o){return e(s,a[o],o)},n)}function V7(a,e){Object.keys(a).forEach(n=>e(a[n],n))}function O7(a,e,n,r){var s={},o=(i,l)=>{var c=n[l];c!==e[l]&&(s[l]=c,i(r,c))};return V7(a,o),s}function j7(a,e,n){var r=M7(n,function(o,i,l){return typeof a[l]=="function"&&o.push(google.maps.event.addListener(e,i,a[l])),o},[]);return r}function F7(a){google.maps.event.removeListener(a)}function Et(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];a.forEach(F7)}function vt(a){var{updaterMap:e,eventMap:n,prevProps:r,nextProps:s,instance:o}=a,i=j7(s,o,n);return O7(e,r,s,o),i}var hw={onDblClick:"dblclick",onDragEnd:"dragend",onDragStart:"dragstart",onMapTypeIdChanged:"maptypeid_changed",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseDown:"mousedown",onMouseUp:"mouseup",onRightClick:"rightclick",onTilesLoaded:"tilesloaded",onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onDrag:"drag",onHeadingChanged:"heading_changed",onIdle:"idle",onProjectionChanged:"projection_changed",onResize:"resize",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed"},vw={extraMapTypes(a,e){e.forEach(function(r,s){a.mapTypes.set(String(s),r)})},center(a,e){a.setCenter(e)},clickableIcons(a,e){a.setClickableIcons(e)},heading(a,e){a.setHeading(e)},mapTypeId(a,e){a.setMapTypeId(e)},options(a,e){a.setOptions(e)},streetView(a,e){a.setStreetView(e)},tilt(a,e){a.setTilt(e)},zoom(a,e){a.setZoom(e)}};function z7(a){var{children:e,options:n,id:r,mapContainerStyle:s,mapContainerClassName:o,center:i,onClick:l,onDblClick:c,onDrag:u,onDragEnd:d,onDragStart:m,onMouseMove:h,onMouseOut:C,onMouseOver:S,onMouseDown:w,onMouseUp:f,onRightClick:b,onCenterChanged:v,onLoad:I,onUnmount:A}=a,[N,x]=p.useState(null),y=p.useRef(null),[E,_]=p.useState(null),[P,k]=p.useState(null),[D,M]=p.useState(null),[$,q]=p.useState(null),[V,z]=p.useState(null),[j,U]=p.useState(null),[Q,te]=p.useState(null),[se,X]=p.useState(null),[ye,Y]=p.useState(null),[Se,de]=p.useState(null),[oe,ge]=p.useState(null),[me,he]=p.useState(null);return p.useEffect(()=>{n&&N!==null&&N.setOptions(n)},[N,n]),p.useEffect(()=>{N!==null&&typeof i<"u"&&N.setCenter(i)},[N,i]),p.useEffect(()=>{N&&c&&(P!==null&&google.maps.event.removeListener(P),k(google.maps.event.addListener(N,"dblclick",c)))},[c]),p.useEffect(()=>{N&&d&&(D!==null&&google.maps.event.removeListener(D),M(google.maps.event.addListener(N,"dragend",d)))},[d]),p.useEffect(()=>{N&&m&&($!==null&&google.maps.event.removeListener($),q(google.maps.event.addListener(N,"dragstart",m)))},[m]),p.useEffect(()=>{N&&w&&(V!==null&&google.maps.event.removeListener(V),z(google.maps.event.addListener(N,"mousedown",w)))},[w]),p.useEffect(()=>{N&&h&&(j!==null&&google.maps.event.removeListener(j),U(google.maps.event.addListener(N,"mousemove",h)))},[h]),p.useEffect(()=>{N&&C&&(Q!==null&&google.maps.event.removeListener(Q),te(google.maps.event.addListener(N,"mouseout",C)))},[C]),p.useEffect(()=>{N&&S&&(se!==null&&google.maps.event.removeListener(se),X(google.maps.event.addListener(N,"mouseover",S)))},[S]),p.useEffect(()=>{N&&f&&(ye!==null&&google.maps.event.removeListener(ye),Y(google.maps.event.addListener(N,"mouseup",f)))},[f]),p.useEffect(()=>{N&&b&&(Se!==null&&google.maps.event.removeListener(Se),de(google.maps.event.addListener(N,"rightclick",b)))},[b]),p.useEffect(()=>{N&&l&&(oe!==null&&google.maps.event.removeListener(oe),ge(google.maps.event.addListener(N,"click",l)))},[l]),p.useEffect(()=>{N&&u&&(me!==null&&google.maps.event.removeListener(me),he(google.maps.event.addListener(N,"drag",u)))},[u]),p.useEffect(()=>{N&&v&&(E!==null&&google.maps.event.removeListener(E),_(google.maps.event.addListener(N,"center_changed",v)))},[l]),p.useEffect(()=>{var G=y.current===null?null:new google.maps.Map(y.current,n);return x(G),G!==null&&I&&I(G),()=>{G!==null&&A&&A(G)}},[]),rn.jsx("div",{id:r,ref:y,style:s,className:o,children:rn.jsx(dt.Provider,{value:N,children:N!==null?e:null})})}p.memo(z7);class U7 extends p.PureComponent{constructor(){super(...arguments),ue(this,"state",{map:null}),ue(this,"registeredEvents",[]),ue(this,"mapRef",null),ue(this,"getInstance",()=>this.mapRef===null?null:new google.maps.Map(this.mapRef,this.props.options)),ue(this,"panTo",e=>{var n=this.getInstance();n&&n.panTo(e)}),ue(this,"setMapCallback",()=>{this.state.map!==null&&this.props.onLoad&&this.props.onLoad(this.state.map)}),ue(this,"getRef",e=>{this.mapRef=e})}componentDidMount(){var e=this.getInstance();this.registeredEvents=vt({updaterMap:vw,eventMap:hw,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{map:e}},this.setMapCallback)}componentDidUpdate(e){this.state.map!==null&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:vw,eventMap:hw,prevProps:e,nextProps:this.props,instance:this.state.map}))}componentWillUnmount(){this.state.map!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.map),Et(this.registeredEvents))}render(){return rn.jsx("div",{id:this.props.id,ref:this.getRef,style:this.props.mapContainerStyle,className:this.props.mapContainerClassName,children:rn.jsx(dt.Provider,{value:this.state.map,children:this.state.map!==null?this.props.children:null})})}}function bw(a,e,n,r,s,o,i){try{var l=a[o](i),c=l.value}catch(u){return void n(u)}l.done?e(c):Promise.resolve(c).then(r,s)}function $A(a){return function(){var e=this,n=arguments;return new Promise(function(r,s){var o=a.apply(e,n);function i(c){bw(o,r,s,i,l,"next",c)}function l(c){bw(o,r,s,i,l,"throw",c)}i(void 0)})}}function BA(a){var{googleMapsApiKey:e,googleMapsClientId:n,version:r="weekly",language:s,region:o,libraries:i,channel:l,mapIds:c,authReferrerPolicy:u,apiUrl:d="https://maps.googleapis.com"}=a,m=[];return Ca(e&&n||!(e&&n),"You need to specify either googleMapsApiKey or googleMapsClientId for @react-google-maps/api load script to work. You cannot use both at the same time."),e?m.push("key=".concat(e)):n&&m.push("client=".concat(n)),r&&m.push("v=".concat(r)),s&&m.push("language=".concat(s)),o&&m.push("region=".concat(o)),i&&i.length&&m.push("libraries=".concat(i.sort().join(","))),l&&m.push("channel=".concat(l)),c&&c.length&&m.push("map_ids=".concat(c.join(","))),u&&m.push("auth_referrer_policy=".concat(u)),m.push("loading=async"),m.push("callback=initMap"),"".concat(d,"/maps/api/js?").concat(m.join("&"))}var jo=typeof document<"u";function qA(a){var{url:e,id:n,nonce:r}=a;return jo?new Promise(function(o,i){var l=document.getElementById(n),c=window;if(l){var u=l.getAttribute("data-state");if(l.src===e&&u!=="error"){if(u==="ready")return o(n);var d=c.initMap,m=l.onerror;c.initMap=function(){d&&d(),o(n)},l.onerror=function(C){m&&m(C),i(C)};return}else l.remove()}var h=document.createElement("script");h.type="text/javascript",h.src=e,h.id=n,h.async=!0,h.nonce=r||"",h.onerror=function(S){h.setAttribute("data-state","error"),i(S)},c.initMap=function(){h.setAttribute("data-state","ready"),o(n)},document.head.appendChild(h)}).catch(s=>{throw console.error("injectScript error: ",s),s}):Promise.reject(new Error("document is undefined"))}function Ew(a){var e=a.href;return e&&(e.indexOf("https://fonts.googleapis.com/css?family=Roboto")===0||e.indexOf("https://fonts.googleapis.com/css?family=Google+Sans+Text")===0)?!0:a.tagName.toLowerCase()==="style"&&a.styleSheet&&a.styleSheet.cssText&&a.styleSheet.cssText.replace(`\r
`,"").indexOf(".gm-style")===0?(a.styleSheet.cssText="",!0):a.tagName.toLowerCase()==="style"&&a.innerHTML&&a.innerHTML.replace(`\r
`,"").indexOf(".gm-style")===0?(a.innerHTML="",!0):a.tagName.toLowerCase()==="style"&&!a.styleSheet&&!a.innerHTML}function WA(){var a=document.getElementsByTagName("head")[0];if(a){var e=a.insertBefore.bind(a);a.insertBefore=function(s,o){return Ew(s)||Reflect.apply(e,a,[s,o]),s};var n=a.appendChild.bind(a);a.appendChild=function(s){return Ew(s)||Reflect.apply(n,a,[s]),s}}}var Dc=!1;function GA(){return rn.jsx("div",{children:"Loading..."})}var K0={id:"script-loader",version:"weekly"};class $7 extends p.PureComponent{constructor(){super(...arguments),ue(this,"check",null),ue(this,"state",{loaded:!1}),ue(this,"cleanupCallback",()=>{delete window.google.maps,this.injectScript()}),ue(this,"isCleaningUp",$A(function*(){function e(n){if(!Dc)n();else if(jo)var r=window.setInterval(function(){Dc||(window.clearInterval(r),n())},1)}return new Promise(e)})),ue(this,"cleanup",()=>{Dc=!0;var e=document.getElementById(this.props.id);e&&e.parentNode&&e.parentNode.removeChild(e),Array.prototype.slice.call(document.getElementsByTagName("script")).filter(function(r){return typeof r.src=="string"&&r.src.includes("maps.googleapis")}).forEach(function(r){r.parentNode&&r.parentNode.removeChild(r)}),Array.prototype.slice.call(document.getElementsByTagName("link")).filter(function(r){return r.href==="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Google+Sans"}).forEach(function(r){r.parentNode&&r.parentNode.removeChild(r)}),Array.prototype.slice.call(document.getElementsByTagName("style")).filter(function(r){return r.innerText!==void 0&&r.innerText.length>0&&r.innerText.includes(".gm-")}).forEach(function(r){r.parentNode&&r.parentNode.removeChild(r)})}),ue(this,"injectScript",()=>{this.props.preventGoogleFontsLoading&&WA(),Ca(!!this.props.id,'LoadScript requires "id" prop to be a string: %s',this.props.id);var e={id:this.props.id,nonce:this.props.nonce,url:BA(this.props)};qA(e).then(()=>{this.props.onLoad&&this.props.onLoad(),this.setState(function(){return{loaded:!0}})}).catch(n=>{this.props.onError&&this.props.onError(n),console.error(`
          There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(this.props.googleMapsApiKey||"-",") or Client ID (").concat(this.props.googleMapsClientId||"-",`) to <LoadScript />
          Otherwise it is a Network issue.
        `))})}),ue(this,"getRef",e=>{this.check=e})}componentDidMount(){if(jo){if(window.google&&window.google.maps&&!Dc){console.error("google api is already presented");return}this.isCleaningUp().then(this.injectScript).catch(function(n){console.error("Error at injecting script after cleaning up: ",n)})}}componentDidUpdate(e){this.props.libraries!==e.libraries&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),jo&&e.language!==this.props.language&&(this.cleanup(),this.setState(function(){return{loaded:!1}},this.cleanupCallback))}componentWillUnmount(){if(jo){this.cleanup();var e=()=>{this.check||(delete window.google,Dc=!1)};window.setTimeout(e,1),this.props.onUnmount&&this.props.onUnmount()}}render(){return rn.jsxs(rn.Fragment,{children:[rn.jsx("div",{ref:this.getRef}),this.state.loaded?this.props.children:this.props.loadingElement||rn.jsx(GA,{})]})}}ue($7,"defaultProps",K0);function B7(a,e){if(a==null)return{};var n={};for(var r in a)if({}.hasOwnProperty.call(a,r)){if(e.includes(r))continue;n[r]=a[r]}return n}function RE(a,e){if(a==null)return{};var n,r,s=B7(a,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);for(r=0;r<o.length;r++)n=o[r],e.includes(n)||{}.propertyIsEnumerable.call(a,n)&&(s[n]=a[n])}return s}var xw;function HA(a){var{id:e=K0.id,version:n=K0.version,nonce:r,googleMapsApiKey:s,googleMapsClientId:o,language:i,region:l,libraries:c,preventGoogleFontsLoading:u,channel:d,mapIds:m,authReferrerPolicy:h,apiUrl:C="https://maps.googleapis.com"}=a,S=p.useRef(!1),[w,f]=p.useState(!1),[b,v]=p.useState(void 0);p.useEffect(function(){return S.current=!0,()=>{S.current=!1}},[]),p.useEffect(function(){jo&&u&&WA()},[u]),p.useEffect(function(){w&&Ca(!!window.google,"useLoadScript was marked as loaded, but window.google is not present. Something went wrong.")},[w]);var I=BA({version:n,googleMapsApiKey:s,googleMapsClientId:o,language:i,region:l,libraries:c,channel:d,mapIds:m,authReferrerPolicy:h,apiUrl:C});p.useEffect(function(){if(!jo)return;function x(){S.current&&(f(!0),xw=I)}if(window.google&&window.google.maps&&xw===I){x();return}qA({id:e,url:I,nonce:r}).then(x).catch(function(E){S.current&&v(E),console.warn(`
        There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(s||"-",") or Client ID (").concat(o||"-",`)
        Otherwise it is a Network issue.
      `)),console.error(E)})},[e,I,r]);var A=p.useRef(void 0);return p.useEffect(function(){A.current&&c!==A.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),A.current=c},[c]),{isLoaded:w,loadError:b,url:I}}var q7=["loadingElement","onLoad","onError","onUnmount","children"],W7=rn.jsx(GA,{});function G7(a){var{loadingElement:e,onLoad:n,onError:r,onUnmount:s,children:o}=a,i=RE(a,q7),{isLoaded:l,loadError:c}=HA(i);return p.useEffect(function(){l&&typeof n=="function"&&n()},[l,n]),p.useEffect(function(){c&&typeof r=="function"&&r(c)},[c,r]),p.useEffect(function(){return()=>{s&&s()}},[s]),l?o:e||W7}p.memo(G7);var yw;(function(a){a[a.INITIALIZED=0]="INITIALIZED",a[a.LOADING=1]="LOADING",a[a.SUCCESS=2]="SUCCESS",a[a.FAILURE=3]="FAILURE"})(yw||(yw={}));function Nw(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function qp(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Nw(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):Nw(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}var ww={},_w={options(a,e){a.setOptions(e)}};function H7(a){var{options:e,onLoad:n,onUnmount:r}=a,s=p.useContext(dt),[o,i]=p.useState(null);return p.useEffect(()=>{o!==null&&o.setMap(s)},[s]),p.useEffect(()=>{e&&o!==null&&o.setOptions(e)},[o,e]),p.useEffect(()=>{var l=new google.maps.TrafficLayer(qp(qp({},e),{},{map:s}));return i(l),n&&n(l),()=>{o!==null&&(r&&r(o),o.setMap(null))}},[]),null}p.memo(H7);class K7 extends p.PureComponent{constructor(){super(...arguments),ue(this,"state",{trafficLayer:null}),ue(this,"setTrafficLayerCallback",()=>{this.state.trafficLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.trafficLayer)}),ue(this,"registeredEvents",[])}componentDidMount(){var e=new google.maps.TrafficLayer(qp(qp({},this.props.options),{},{map:this.context}));this.registeredEvents=vt({updaterMap:_w,eventMap:ww,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{trafficLayer:e}},this.setTrafficLayerCallback)}componentDidUpdate(e){this.state.trafficLayer!==null&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:_w,eventMap:ww,prevProps:e,nextProps:this.props,instance:this.state.trafficLayer}))}componentWillUnmount(){this.state.trafficLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.trafficLayer),Et(this.registeredEvents),this.state.trafficLayer.setMap(null))}render(){return null}}ue(K7,"contextType",dt);function Q7(a){var{onLoad:e,onUnmount:n}=a,r=p.useContext(dt),[s,o]=p.useState(null);return p.useEffect(()=>{s!==null&&s.setMap(r)},[r]),p.useEffect(()=>{var i=new google.maps.BicyclingLayer;return o(i),i.setMap(r),e&&e(i),()=>{i!==null&&(n&&n(i),i.setMap(null))}},[]),null}p.memo(Q7);class J7 extends p.PureComponent{constructor(){super(...arguments),ue(this,"state",{bicyclingLayer:null}),ue(this,"setBicyclingLayerCallback",()=>{this.state.bicyclingLayer!==null&&(this.state.bicyclingLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.bicyclingLayer))})}componentDidMount(){var e=new google.maps.BicyclingLayer;this.setState(()=>({bicyclingLayer:e}),this.setBicyclingLayerCallback)}componentWillUnmount(){this.state.bicyclingLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.bicyclingLayer),this.state.bicyclingLayer.setMap(null))}render(){return null}}ue(J7,"contextType",dt);function Y7(a){var{onLoad:e,onUnmount:n}=a,r=p.useContext(dt),[s,o]=p.useState(null);return p.useEffect(()=>{s!==null&&s.setMap(r)},[r]),p.useEffect(()=>{var i=new google.maps.TransitLayer;return o(i),i.setMap(r),e&&e(i),()=>{s!==null&&(n&&n(s),s.setMap(null))}},[]),null}p.memo(Y7);class Z7 extends p.PureComponent{constructor(){super(...arguments),ue(this,"state",{transitLayer:null}),ue(this,"setTransitLayerCallback",()=>{this.state.transitLayer!==null&&(this.state.transitLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.transitLayer))})}componentDidMount(){var e=new google.maps.TransitLayer;this.setState(function(){return{transitLayer:e}},this.setTransitLayerCallback)}componentWillUnmount(){this.state.transitLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.transitLayer),this.state.transitLayer.setMap(null))}render(){return null}}ue(Z7,"contextType",dt);function Cw(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function Wp(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Cw(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):Cw(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}var Sw={onCircleComplete:"circlecomplete",onMarkerComplete:"markercomplete",onOverlayComplete:"overlaycomplete",onPolygonComplete:"polygoncomplete",onPolylineComplete:"polylinecomplete",onRectangleComplete:"rectanglecomplete"},kw={drawingMode(a,e){a.setDrawingMode(e)},options(a,e){a.setOptions(e)}};function X7(a){var{options:e,drawingMode:n,onCircleComplete:r,onMarkerComplete:s,onOverlayComplete:o,onPolygonComplete:i,onPolylineComplete:l,onRectangleComplete:c,onLoad:u,onUnmount:d}=a,m=p.useContext(dt),[h,C]=p.useState(null),[S,w]=p.useState(null),[f,b]=p.useState(null),[v,I]=p.useState(null),[A,N]=p.useState(null),[x,y]=p.useState(null),[E,_]=p.useState(null);return p.useEffect(()=>{h!==null&&h.setMap(m)},[m]),p.useEffect(()=>{e&&h!==null&&h.setOptions(e)},[h,e]),p.useEffect(()=>{h!==null&&h.setDrawingMode(n??null)},[h,n]),p.useEffect(()=>{h&&r&&(S!==null&&google.maps.event.removeListener(S),w(google.maps.event.addListener(h,"circlecomplete",r)))},[h,r]),p.useEffect(()=>{h&&s&&(f!==null&&google.maps.event.removeListener(f),b(google.maps.event.addListener(h,"markercomplete",s)))},[h,s]),p.useEffect(()=>{h&&o&&(v!==null&&google.maps.event.removeListener(v),I(google.maps.event.addListener(h,"overlaycomplete",o)))},[h,o]),p.useEffect(()=>{h&&i&&(A!==null&&google.maps.event.removeListener(A),N(google.maps.event.addListener(h,"polygoncomplete",i)))},[h,i]),p.useEffect(()=>{h&&l&&(x!==null&&google.maps.event.removeListener(x),y(google.maps.event.addListener(h,"polylinecomplete",l)))},[h,l]),p.useEffect(()=>{h&&c&&(E!==null&&google.maps.event.removeListener(E),_(google.maps.event.addListener(h,"rectanglecomplete",c)))},[h,c]),p.useEffect(()=>{Ca(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing);var P=new google.maps.drawing.DrawingManager(Wp(Wp({},e),{},{map:m}));return n&&P.setDrawingMode(n),r&&w(google.maps.event.addListener(P,"circlecomplete",r)),s&&b(google.maps.event.addListener(P,"markercomplete",s)),o&&I(google.maps.event.addListener(P,"overlaycomplete",o)),i&&N(google.maps.event.addListener(P,"polygoncomplete",i)),l&&y(google.maps.event.addListener(P,"polylinecomplete",l)),c&&_(google.maps.event.addListener(P,"rectanglecomplete",c)),C(P),u&&u(P),()=>{h!==null&&(S&&google.maps.event.removeListener(S),f&&google.maps.event.removeListener(f),v&&google.maps.event.removeListener(v),A&&google.maps.event.removeListener(A),x&&google.maps.event.removeListener(x),E&&google.maps.event.removeListener(E),d&&d(h),h.setMap(null))}},[]),null}p.memo(X7);class eU extends p.PureComponent{constructor(e){super(e),ue(this,"registeredEvents",[]),ue(this,"state",{drawingManager:null}),ue(this,"setDrawingManagerCallback",()=>{this.state.drawingManager!==null&&this.props.onLoad&&this.props.onLoad(this.state.drawingManager)}),Ca(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing)}componentDidMount(){var e=new google.maps.drawing.DrawingManager(Wp(Wp({},this.props.options),{},{map:this.context}));this.registeredEvents=vt({updaterMap:kw,eventMap:Sw,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{drawingManager:e}},this.setDrawingManagerCallback)}componentDidUpdate(e){this.state.drawingManager!==null&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:kw,eventMap:Sw,prevProps:e,nextProps:this.props,instance:this.state.drawingManager}))}componentWillUnmount(){this.state.drawingManager!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.drawingManager),Et(this.registeredEvents),this.state.drawingManager.setMap(null))}render(){return null}}ue(eU,"contextType",dt);function Iw(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function pl(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Iw(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):Iw(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}var Aw={onAnimationChanged:"animation_changed",onClick:"click",onClickableChanged:"clickable_changed",onCursorChanged:"cursor_changed",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDraggableChanged:"draggable_changed",onDragStart:"dragstart",onFlatChanged:"flat_changed",onIconChanged:"icon_changed",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPositionChanged:"position_changed",onRightClick:"rightclick",onShapeChanged:"shape_changed",onTitleChanged:"title_changed",onVisibleChanged:"visible_changed",onZindexChanged:"zindex_changed"},Tw={animation(a,e){a.setAnimation(e)},clickable(a,e){a.setClickable(e)},cursor(a,e){a.setCursor(e)},draggable(a,e){a.setDraggable(e)},icon(a,e){a.setIcon(e)},label(a,e){a.setLabel(e)},map(a,e){a.setMap(e)},opacity(a,e){a.setOpacity(e)},options(a,e){a.setOptions(e)},position(a,e){a.setPosition(e)},shape(a,e){a.setShape(e)},title(a,e){a.setTitle(e)},visible(a,e){a.setVisible(e)},zIndex(a,e){a.setZIndex(e)}},Gp={};function tU(a){var{position:e,options:n,clusterer:r,noClustererRedraw:s,children:o,draggable:i,visible:l,animation:c,clickable:u,cursor:d,icon:m,label:h,opacity:C,shape:S,title:w,zIndex:f,onClick:b,onDblClick:v,onDrag:I,onDragEnd:A,onDragStart:N,onMouseOut:x,onMouseOver:y,onMouseUp:E,onMouseDown:_,onRightClick:P,onClickableChanged:k,onCursorChanged:D,onAnimationChanged:M,onDraggableChanged:$,onFlatChanged:q,onIconChanged:V,onPositionChanged:z,onShapeChanged:j,onTitleChanged:U,onVisibleChanged:Q,onZindexChanged:te,onLoad:se,onUnmount:X}=a,ye=p.useContext(dt),[Y,Se]=p.useState(null),[de,oe]=p.useState(null),[ge,me]=p.useState(null),[he,G]=p.useState(null),[we,Te]=p.useState(null),[B,ve]=p.useState(null),[je,_e]=p.useState(null),[H,Pe]=p.useState(null),[Ye,it]=p.useState(null),[mt,be]=p.useState(null),[Re,qe]=p.useState(null),[Me,Xe]=p.useState(null),[ft,ca]=p.useState(null),[ea,Tt]=p.useState(null),[He,$t]=p.useState(null),[ne,K]=p.useState(null),[Ge,Ke]=p.useState(null),[Ze,et]=p.useState(null),[Ue,Je]=p.useState(null),[We,Rt]=p.useState(null),[lt,Dt]=p.useState(null),[ut,ka]=p.useState(null);p.useEffect(()=>{Y!==null&&Y.setMap(ye)},[ye]),p.useEffect(()=>{typeof n<"u"&&Y!==null&&Y.setOptions(n)},[Y,n]),p.useEffect(()=>{typeof i<"u"&&Y!==null&&Y.setDraggable(i)},[Y,i]),p.useEffect(()=>{e&&Y!==null&&Y.setPosition(e)},[Y,e]),p.useEffect(()=>{typeof l<"u"&&Y!==null&&Y.setVisible(l)},[Y,l]),p.useEffect(()=>{Y==null||Y.setAnimation(c)},[Y,c]),p.useEffect(()=>{Y&&u!==void 0&&Y.setClickable(u)},[Y,u]),p.useEffect(()=>{Y&&d!==void 0&&Y.setCursor(d)},[Y,d]),p.useEffect(()=>{Y&&m!==void 0&&Y.setIcon(m)},[Y,m]),p.useEffect(()=>{Y&&h!==void 0&&Y.setLabel(h)},[Y,h]),p.useEffect(()=>{Y&&C!==void 0&&Y.setOpacity(C)},[Y,C]),p.useEffect(()=>{Y&&S!==void 0&&Y.setShape(S)},[Y,S]),p.useEffect(()=>{Y&&w!==void 0&&Y.setTitle(w)},[Y,w]),p.useEffect(()=>{Y&&f!==void 0&&Y.setZIndex(f)},[Y,f]),p.useEffect(()=>{Y&&v&&(de!==null&&google.maps.event.removeListener(de),oe(google.maps.event.addListener(Y,"dblclick",v)))},[v]),p.useEffect(()=>{Y&&A&&(ge!==null&&google.maps.event.removeListener(ge),me(google.maps.event.addListener(Y,"dragend",A)))},[A]),p.useEffect(()=>{Y&&N&&(he!==null&&google.maps.event.removeListener(he),G(google.maps.event.addListener(Y,"dragstart",N)))},[N]),p.useEffect(()=>{Y&&_&&(we!==null&&google.maps.event.removeListener(we),Te(google.maps.event.addListener(Y,"mousedown",_)))},[_]),p.useEffect(()=>{Y&&x&&(B!==null&&google.maps.event.removeListener(B),ve(google.maps.event.addListener(Y,"mouseout",x)))},[x]),p.useEffect(()=>{Y&&y&&(je!==null&&google.maps.event.removeListener(je),_e(google.maps.event.addListener(Y,"mouseover",y)))},[y]),p.useEffect(()=>{Y&&E&&(H!==null&&google.maps.event.removeListener(H),Pe(google.maps.event.addListener(Y,"mouseup",E)))},[E]),p.useEffect(()=>{Y&&P&&(Ye!==null&&google.maps.event.removeListener(Ye),it(google.maps.event.addListener(Y,"rightclick",P)))},[P]),p.useEffect(()=>{Y&&b&&(mt!==null&&google.maps.event.removeListener(mt),be(google.maps.event.addListener(Y,"click",b)))},[b]),p.useEffect(()=>{Y&&I&&(Re!==null&&google.maps.event.removeListener(Re),qe(google.maps.event.addListener(Y,"drag",I)))},[I]),p.useEffect(()=>{Y&&k&&(Me!==null&&google.maps.event.removeListener(Me),Xe(google.maps.event.addListener(Y,"clickable_changed",k)))},[k]),p.useEffect(()=>{Y&&D&&(ft!==null&&google.maps.event.removeListener(ft),ca(google.maps.event.addListener(Y,"cursor_changed",D)))},[D]),p.useEffect(()=>{Y&&M&&(ea!==null&&google.maps.event.removeListener(ea),Tt(google.maps.event.addListener(Y,"animation_changed",M)))},[M]),p.useEffect(()=>{Y&&$&&(He!==null&&google.maps.event.removeListener(He),$t(google.maps.event.addListener(Y,"draggable_changed",$)))},[$]),p.useEffect(()=>{Y&&q&&(ne!==null&&google.maps.event.removeListener(ne),K(google.maps.event.addListener(Y,"flat_changed",q)))},[q]),p.useEffect(()=>{Y&&V&&(Ge!==null&&google.maps.event.removeListener(Ge),Ke(google.maps.event.addListener(Y,"icon_changed",V)))},[V]),p.useEffect(()=>{Y&&z&&(Ze!==null&&google.maps.event.removeListener(Ze),et(google.maps.event.addListener(Y,"position_changed",z)))},[z]),p.useEffect(()=>{Y&&j&&(Ue!==null&&google.maps.event.removeListener(Ue),Je(google.maps.event.addListener(Y,"shape_changed",j)))},[j]),p.useEffect(()=>{Y&&U&&(We!==null&&google.maps.event.removeListener(We),Rt(google.maps.event.addListener(Y,"title_changed",U)))},[U]),p.useEffect(()=>{Y&&Q&&(lt!==null&&google.maps.event.removeListener(lt),Dt(google.maps.event.addListener(Y,"visible_changed",Q)))},[Q]),p.useEffect(()=>{Y&&te&&(ut!==null&&google.maps.event.removeListener(ut),ka(google.maps.event.addListener(Y,"zindex_changed",te)))},[te]),p.useEffect(()=>{var ir=pl(pl(pl({},n||Gp),r?Gp:{map:ye}),{},{position:e}),$e=new google.maps.Marker(ir);return r?r.addMarker($e,!!s):$e.setMap(ye),e&&$e.setPosition(e),typeof l<"u"&&$e.setVisible(l),typeof i<"u"&&$e.setDraggable(i),typeof u<"u"&&$e.setClickable(u),typeof d=="string"&&$e.setCursor(d),m&&$e.setIcon(m),typeof h<"u"&&$e.setLabel(h),typeof C<"u"&&$e.setOpacity(C),S&&$e.setShape(S),typeof w=="string"&&$e.setTitle(w),typeof f=="number"&&$e.setZIndex(f),v&&oe(google.maps.event.addListener($e,"dblclick",v)),A&&me(google.maps.event.addListener($e,"dragend",A)),N&&G(google.maps.event.addListener($e,"dragstart",N)),_&&Te(google.maps.event.addListener($e,"mousedown",_)),x&&ve(google.maps.event.addListener($e,"mouseout",x)),y&&_e(google.maps.event.addListener($e,"mouseover",y)),E&&Pe(google.maps.event.addListener($e,"mouseup",E)),P&&it(google.maps.event.addListener($e,"rightclick",P)),b&&be(google.maps.event.addListener($e,"click",b)),I&&qe(google.maps.event.addListener($e,"drag",I)),k&&Xe(google.maps.event.addListener($e,"clickable_changed",k)),D&&ca(google.maps.event.addListener($e,"cursor_changed",D)),M&&Tt(google.maps.event.addListener($e,"animation_changed",M)),$&&$t(google.maps.event.addListener($e,"draggable_changed",$)),q&&K(google.maps.event.addListener($e,"flat_changed",q)),V&&Ke(google.maps.event.addListener($e,"icon_changed",V)),z&&et(google.maps.event.addListener($e,"position_changed",z)),j&&Je(google.maps.event.addListener($e,"shape_changed",j)),U&&Rt(google.maps.event.addListener($e,"title_changed",U)),Q&&Dt(google.maps.event.addListener($e,"visible_changed",Q)),te&&ka(google.maps.event.addListener($e,"zindex_changed",te)),Se($e),se&&se($e),()=>{de!==null&&google.maps.event.removeListener(de),ge!==null&&google.maps.event.removeListener(ge),he!==null&&google.maps.event.removeListener(he),we!==null&&google.maps.event.removeListener(we),B!==null&&google.maps.event.removeListener(B),je!==null&&google.maps.event.removeListener(je),H!==null&&google.maps.event.removeListener(H),Ye!==null&&google.maps.event.removeListener(Ye),mt!==null&&google.maps.event.removeListener(mt),Me!==null&&google.maps.event.removeListener(Me),ft!==null&&google.maps.event.removeListener(ft),ea!==null&&google.maps.event.removeListener(ea),He!==null&&google.maps.event.removeListener(He),ne!==null&&google.maps.event.removeListener(ne),Ge!==null&&google.maps.event.removeListener(Ge),Ze!==null&&google.maps.event.removeListener(Ze),We!==null&&google.maps.event.removeListener(We),lt!==null&&google.maps.event.removeListener(lt),ut!==null&&google.maps.event.removeListener(ut),X&&X($e),r?r.removeMarker($e,!!s):$e&&$e.setMap(null)}},[]);var tt=p.useMemo(()=>o?p.Children.map(o,ir=>{if(!p.isValidElement(ir))return ir;var $e=ir;return p.cloneElement($e,{anchor:Y})}):null,[o,Y]);return rn.jsx(rn.Fragment,{children:tt})||null}p.memo(tU);class KA extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[])}componentDidMount(){var e=this;return $A(function*(){var n=pl(pl(pl({},e.props.options||Gp),e.props.clusterer?Gp:{map:e.context}),{},{position:e.props.position});e.marker=new google.maps.Marker(n),e.props.clusterer?e.props.clusterer.addMarker(e.marker,!!e.props.noClustererRedraw):e.marker.setMap(e.context),e.registeredEvents=vt({updaterMap:Tw,eventMap:Aw,prevProps:{},nextProps:e.props,instance:e.marker}),e.props.onLoad&&e.props.onLoad(e.marker)})()}componentDidUpdate(e){this.marker&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:Tw,eventMap:Aw,prevProps:e,nextProps:this.props,instance:this.marker}))}componentWillUnmount(){this.marker&&(this.props.onUnmount&&this.props.onUnmount(this.marker),Et(this.registeredEvents),this.props.clusterer?this.props.clusterer.removeMarker(this.marker,!!this.props.noClustererRedraw):this.marker&&this.marker.setMap(null))}render(){var e=this.props.children?p.Children.map(this.props.children,n=>{if(!p.isValidElement(n))return n;var r=n;return p.cloneElement(r,{anchor:this.marker})}):null;return e||null}}ue(KA,"contextType",dt);var aU=function(){function a(e,n){e.getClusterer().extend(a,google.maps.OverlayView),this.cluster=e,this.clusterClassName=this.cluster.getClusterer().getClusterClass(),this.className=this.clusterClassName,this.styles=n,this.center=void 0,this.div=null,this.sums=null,this.visible=!1,this.boundsChangedListener=null,this.url="",this.height=0,this.width=0,this.anchorText=[0,0],this.anchorIcon=[0,0],this.textColor="black",this.textSize=11,this.textDecoration="none",this.fontWeight="bold",this.fontStyle="normal",this.fontFamily="Arial,sans-serif",this.backgroundPosition="0 0",this.cMouseDownInCluster=null,this.cDraggingMapByCluster=null,this.timeOut=null,this.setMap(e.getMap()),this.onBoundsChanged=this.onBoundsChanged.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onAdd=this.onAdd.bind(this),this.onRemove=this.onRemove.bind(this),this.draw=this.draw.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.useStyle=this.useStyle.bind(this),this.setCenter=this.setCenter.bind(this),this.getPosFromLatLng=this.getPosFromLatLng.bind(this)}return a.prototype.onBoundsChanged=function(){this.cDraggingMapByCluster=this.cMouseDownInCluster},a.prototype.onMouseDown=function(){this.cMouseDownInCluster=!0,this.cDraggingMapByCluster=!1},a.prototype.onClick=function(e){if(this.cMouseDownInCluster=!1,!this.cDraggingMapByCluster){var n=this.cluster.getClusterer();if(google.maps.event.trigger(n,"click",this.cluster),google.maps.event.trigger(n,"clusterclick",this.cluster),n.getZoomOnClick()){var r=n.getMaxZoom(),s=this.cluster.getBounds(),o=n.getMap();o!==null&&"fitBounds"in o&&o.fitBounds(s),this.timeOut=window.setTimeout(function(){var i=n.getMap();if(i!==null){"fitBounds"in i&&i.fitBounds(s);var l=i.getZoom()||0;r!==null&&l>r&&i.setZoom(r+1)}},100)}e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}},a.prototype.onMouseOver=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseover",this.cluster)},a.prototype.onMouseOut=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseout",this.cluster)},a.prototype.onAdd=function(){var e;this.div=document.createElement("div"),this.div.className=this.className,this.visible&&this.show(),(e=this.getPanes())===null||e===void 0||e.overlayMouseTarget.appendChild(this.div);var n=this.getMap();n!==null&&(this.boundsChangedListener=google.maps.event.addListener(n,"bounds_changed",this.onBoundsChanged),this.div.addEventListener("mousedown",this.onMouseDown),this.div.addEventListener("click",this.onClick),this.div.addEventListener("mouseover",this.onMouseOver),this.div.addEventListener("mouseout",this.onMouseOut))},a.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.hide(),this.boundsChangedListener!==null&&google.maps.event.removeListener(this.boundsChangedListener),this.div.removeEventListener("mousedown",this.onMouseDown),this.div.removeEventListener("click",this.onClick),this.div.removeEventListener("mouseover",this.onMouseOver),this.div.removeEventListener("mouseout",this.onMouseOut),this.div.parentNode.removeChild(this.div),this.timeOut!==null&&(window.clearTimeout(this.timeOut),this.timeOut=null),this.div=null)},a.prototype.draw=function(){if(this.visible&&this.div!==null&&this.center){var e=this.getPosFromLatLng(this.center);this.div.style.top=e!==null?"".concat(e.y,"px"):"0",this.div.style.left=e!==null?"".concat(e.x,"px"):"0"}},a.prototype.hide=function(){this.div&&(this.div.style.display="none"),this.visible=!1},a.prototype.show=function(){var e,n,r,s,o,i;if(this.div&&this.center){var l=this.sums===null||typeof this.sums.title>"u"||this.sums.title===""?this.cluster.getClusterer().getTitle():this.sums.title,c=this.backgroundPosition.split(" "),u=parseInt(((e=c[0])===null||e===void 0?void 0:e.replace(/^\s+|\s+$/g,""))||"0",10),d=parseInt(((n=c[1])===null||n===void 0?void 0:n.replace(/^\s+|\s+$/g,""))||"0",10),m=this.getPosFromLatLng(this.center);this.div.className=this.className,this.div.setAttribute("style","cursor: pointer; position: absolute; top: ".concat(m!==null?"".concat(m.y,"px"):"0","; left: ").concat(m!==null?"".concat(m.x,"px"):"0","; width: ").concat(this.width,"px; height: ").concat(this.height,"px; "));var h=document.createElement("img");h.alt=l,h.src=this.url,h.width=this.width,h.height=this.height,h.setAttribute("style","position: absolute; top: ".concat(d,"px; left: ").concat(u,"px")),this.cluster.getClusterer().enableRetinaIcons||(h.style.clip="rect(-".concat(d,"px, -").concat(u+this.width,"px, -").concat(d+this.height,", -").concat(u,")"));var C=document.createElement("div");C.setAttribute("style","position: absolute; top: ".concat(this.anchorText[0],"px; left: ").concat(this.anchorText[1],"px; color: ").concat(this.textColor,"; font-size: ").concat(this.textSize,"px; font-family: ").concat(this.fontFamily,"; font-weight: ").concat(this.fontWeight,"; fontStyle: ").concat(this.fontStyle,"; text-decoration: ").concat(this.textDecoration,"; text-align: center; width: ").concat(this.width,"px; line-height: ").concat(this.height,"px")),!((r=this.sums)===null||r===void 0)&&r.text&&(C.innerText="".concat((s=this.sums)===null||s===void 0?void 0:s.text)),!((o=this.sums)===null||o===void 0)&&o.html&&(C.innerHTML="".concat((i=this.sums)===null||i===void 0?void 0:i.html)),this.div.innerHTML="",this.div.appendChild(h),this.div.appendChild(C),this.div.title=l,this.div.style.display=""}this.visible=!0},a.prototype.useStyle=function(e){this.sums=e;var n=this.cluster.getClusterer().getStyles(),r=n[Math.min(n.length-1,Math.max(0,e.index-1))];r&&(this.url=r.url,this.height=r.height,this.width=r.width,r.className&&(this.className="".concat(this.clusterClassName," ").concat(r.className)),this.anchorText=r.anchorText||[0,0],this.anchorIcon=r.anchorIcon||[this.height/2,this.width/2],this.textColor=r.textColor||"black",this.textSize=r.textSize||11,this.textDecoration=r.textDecoration||"none",this.fontWeight=r.fontWeight||"bold",this.fontStyle=r.fontStyle||"normal",this.fontFamily=r.fontFamily||"Arial,sans-serif",this.backgroundPosition=r.backgroundPosition||"0 0")},a.prototype.setCenter=function(e){this.center=e},a.prototype.getPosFromLatLng=function(e){var n=this.getProjection().fromLatLngToDivPixel(e);return n!==null&&(n.x-=this.anchorIcon[1],n.y-=this.anchorIcon[0]),n},a}(),nU=function(){function a(e){this.markerClusterer=e,this.map=this.markerClusterer.getMap(),this.gridSize=this.markerClusterer.getGridSize(),this.minClusterSize=this.markerClusterer.getMinimumClusterSize(),this.averageCenter=this.markerClusterer.getAverageCenter(),this.markers=[],this.center=void 0,this.bounds=null,this.clusterIcon=new aU(this,this.markerClusterer.getStyles()),this.getSize=this.getSize.bind(this),this.getMarkers=this.getMarkers.bind(this),this.getCenter=this.getCenter.bind(this),this.getMap=this.getMap.bind(this),this.getClusterer=this.getClusterer.bind(this),this.getBounds=this.getBounds.bind(this),this.remove=this.remove.bind(this),this.addMarker=this.addMarker.bind(this),this.isMarkerInClusterBounds=this.isMarkerInClusterBounds.bind(this),this.calculateBounds=this.calculateBounds.bind(this),this.updateIcon=this.updateIcon.bind(this),this.isMarkerAlreadyAdded=this.isMarkerAlreadyAdded.bind(this)}return a.prototype.getSize=function(){return this.markers.length},a.prototype.getMarkers=function(){return this.markers},a.prototype.getCenter=function(){return this.center},a.prototype.getMap=function(){return this.map},a.prototype.getClusterer=function(){return this.markerClusterer},a.prototype.getBounds=function(){for(var e=new google.maps.LatLngBounds(this.center,this.center),n=this.getMarkers(),r=0,s=n;r<s.length;r++){var o=s[r],i=o.getPosition();i&&e.extend(i)}return e},a.prototype.remove=function(){this.clusterIcon.setMap(null),this.markers=[],delete this.markers},a.prototype.addMarker=function(e){var n;if(this.isMarkerAlreadyAdded(e))return!1;if(this.center){if(this.averageCenter){var r=e.getPosition();if(r){var s=this.markers.length+1;this.center=new google.maps.LatLng((this.center.lat()*(s-1)+r.lat())/s,(this.center.lng()*(s-1)+r.lng())/s),this.calculateBounds()}}}else{var r=e.getPosition();r&&(this.center=r,this.calculateBounds())}e.isAdded=!0,this.markers.push(e);var o=this.markers.length,i=this.markerClusterer.getMaxZoom(),l=(n=this.map)===null||n===void 0?void 0:n.getZoom();if(i!==null&&typeof l<"u"&&l>i)e.getMap()!==this.map&&e.setMap(this.map);else if(o<this.minClusterSize)e.getMap()!==this.map&&e.setMap(this.map);else if(o===this.minClusterSize)for(var c=0,u=this.markers;c<u.length;c++){var d=u[c];d.setMap(null)}else e.setMap(null);return!0},a.prototype.isMarkerInClusterBounds=function(e){if(this.bounds!==null){var n=e.getPosition();if(n)return this.bounds.contains(n)}return!1},a.prototype.calculateBounds=function(){this.bounds=this.markerClusterer.getExtendedBounds(new google.maps.LatLngBounds(this.center,this.center))},a.prototype.updateIcon=function(){var e,n=this.markers.length,r=this.markerClusterer.getMaxZoom(),s=(e=this.map)===null||e===void 0?void 0:e.getZoom();if(r!==null&&typeof s<"u"&&s>r){this.clusterIcon.hide();return}if(n<this.minClusterSize){this.clusterIcon.hide();return}this.center&&this.clusterIcon.setCenter(this.center),this.clusterIcon.useStyle(this.markerClusterer.getCalculator()(this.markers,this.markerClusterer.getStyles().length)),this.clusterIcon.show()},a.prototype.isMarkerAlreadyAdded=function(e){if(this.markers.includes)return this.markers.includes(e);for(var n=0;n<this.markers.length;n++)if(e===this.markers[n])return!0;return!1},a}();function rU(a,e){var n=a.length,r=n.toString().length,s=Math.min(r,e);return{text:n.toString(),index:s,title:""}}var sU=2e3,oU=500,iU="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",lU="png",cU=[53,56,66,78,90],uU="cluster",QA=function(){function a(e,n,r){n===void 0&&(n=[]),r===void 0&&(r={}),this.getMinimumClusterSize=this.getMinimumClusterSize.bind(this),this.setMinimumClusterSize=this.setMinimumClusterSize.bind(this),this.getEnableRetinaIcons=this.getEnableRetinaIcons.bind(this),this.setEnableRetinaIcons=this.setEnableRetinaIcons.bind(this),this.addToClosestCluster=this.addToClosestCluster.bind(this),this.getImageExtension=this.getImageExtension.bind(this),this.setImageExtension=this.setImageExtension.bind(this),this.getExtendedBounds=this.getExtendedBounds.bind(this),this.getAverageCenter=this.getAverageCenter.bind(this),this.setAverageCenter=this.setAverageCenter.bind(this),this.getTotalClusters=this.getTotalClusters.bind(this),this.fitMapToMarkers=this.fitMapToMarkers.bind(this),this.getIgnoreHidden=this.getIgnoreHidden.bind(this),this.setIgnoreHidden=this.setIgnoreHidden.bind(this),this.getClusterClass=this.getClusterClass.bind(this),this.setClusterClass=this.setClusterClass.bind(this),this.getTotalMarkers=this.getTotalMarkers.bind(this),this.getZoomOnClick=this.getZoomOnClick.bind(this),this.setZoomOnClick=this.setZoomOnClick.bind(this),this.getBatchSizeIE=this.getBatchSizeIE.bind(this),this.setBatchSizeIE=this.setBatchSizeIE.bind(this),this.createClusters=this.createClusters.bind(this),this.onZoomChanged=this.onZoomChanged.bind(this),this.getImageSizes=this.getImageSizes.bind(this),this.setImageSizes=this.setImageSizes.bind(this),this.getCalculator=this.getCalculator.bind(this),this.setCalculator=this.setCalculator.bind(this),this.removeMarkers=this.removeMarkers.bind(this),this.resetViewport=this.resetViewport.bind(this),this.getImagePath=this.getImagePath.bind(this),this.setImagePath=this.setImagePath.bind(this),this.pushMarkerTo=this.pushMarkerTo.bind(this),this.removeMarker=this.removeMarker.bind(this),this.clearMarkers=this.clearMarkers.bind(this),this.setupStyles=this.setupStyles.bind(this),this.getGridSize=this.getGridSize.bind(this),this.setGridSize=this.setGridSize.bind(this),this.getClusters=this.getClusters.bind(this),this.getMaxZoom=this.getMaxZoom.bind(this),this.setMaxZoom=this.setMaxZoom.bind(this),this.getMarkers=this.getMarkers.bind(this),this.addMarkers=this.addMarkers.bind(this),this.getStyles=this.getStyles.bind(this),this.setStyles=this.setStyles.bind(this),this.addMarker=this.addMarker.bind(this),this.onRemove=this.onRemove.bind(this),this.getTitle=this.getTitle.bind(this),this.setTitle=this.setTitle.bind(this),this.repaint=this.repaint.bind(this),this.onIdle=this.onIdle.bind(this),this.redraw=this.redraw.bind(this),this.onAdd=this.onAdd.bind(this),this.draw=this.draw.bind(this),this.extend=this.extend.bind(this),this.extend(a,google.maps.OverlayView),this.markers=[],this.clusters=[],this.listeners=[],this.activeMap=null,this.ready=!1,this.gridSize=r.gridSize||60,this.minClusterSize=r.minimumClusterSize||2,this.maxZoom=r.maxZoom||null,this.styles=r.styles||[],this.title=r.title||"",this.zoomOnClick=!0,r.zoomOnClick!==void 0&&(this.zoomOnClick=r.zoomOnClick),this.averageCenter=!1,r.averageCenter!==void 0&&(this.averageCenter=r.averageCenter),this.ignoreHidden=!1,r.ignoreHidden!==void 0&&(this.ignoreHidden=r.ignoreHidden),this.enableRetinaIcons=!1,r.enableRetinaIcons!==void 0&&(this.enableRetinaIcons=r.enableRetinaIcons),this.imagePath=r.imagePath||iU,this.imageExtension=r.imageExtension||lU,this.imageSizes=r.imageSizes||cU,this.calculator=r.calculator||rU,this.batchSize=r.batchSize||sU,this.batchSizeIE=r.batchSizeIE||oU,this.clusterClass=r.clusterClass||uU,navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize=this.batchSizeIE),this.timerRefStatic=null,this.setupStyles(),this.addMarkers(n,!0),this.setMap(e)}return a.prototype.onZoomChanged=function(){var e,n;this.resetViewport(!1),(((e=this.getMap())===null||e===void 0?void 0:e.getZoom())===(this.get("minZoom")||0)||((n=this.getMap())===null||n===void 0?void 0:n.getZoom())===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")},a.prototype.onIdle=function(){this.redraw()},a.prototype.onAdd=function(){var e=this.getMap();this.activeMap=e,this.ready=!0,this.repaint(),e!==null&&(this.listeners=[google.maps.event.addListener(e,"zoom_changed",this.onZoomChanged),google.maps.event.addListener(e,"idle",this.onIdle)])},a.prototype.onRemove=function(){for(var e=0,n=this.markers;e<n.length;e++){var r=n[e];r.getMap()!==this.activeMap&&r.setMap(this.activeMap)}for(var s=0,o=this.clusters;s<o.length;s++){var i=o[s];i.remove()}this.clusters=[];for(var l=0,c=this.listeners;l<c.length;l++){var u=c[l];google.maps.event.removeListener(u)}this.listeners=[],this.activeMap=null,this.ready=!1},a.prototype.draw=function(){},a.prototype.getMap=function(){return null},a.prototype.getPanes=function(){return null},a.prototype.getProjection=function(){return{fromContainerPixelToLatLng:function(){return null},fromDivPixelToLatLng:function(){return null},fromLatLngToContainerPixel:function(){return null},fromLatLngToDivPixel:function(){return null},getVisibleRegion:function(){return null},getWorldWidth:function(){return 0}}},a.prototype.setMap=function(){},a.prototype.addListener=function(){return{remove:function(){}}},a.prototype.bindTo=function(){},a.prototype.get=function(){},a.prototype.notify=function(){},a.prototype.set=function(){},a.prototype.setValues=function(){},a.prototype.unbind=function(){},a.prototype.unbindAll=function(){},a.prototype.setupStyles=function(){if(!(this.styles.length>0))for(var e=0;e<this.imageSizes.length;e++)this.styles.push({url:"".concat(this.imagePath+(e+1),".").concat(this.imageExtension),height:this.imageSizes[e]||0,width:this.imageSizes[e]||0})},a.prototype.fitMapToMarkers=function(){for(var e=this.getMarkers(),n=new google.maps.LatLngBounds,r=0,s=e;r<s.length;r++){var o=s[r],i=o.getPosition();i&&n.extend(i)}var l=this.getMap();l!==null&&"fitBounds"in l&&l.fitBounds(n)},a.prototype.getGridSize=function(){return this.gridSize},a.prototype.setGridSize=function(e){this.gridSize=e},a.prototype.getMinimumClusterSize=function(){return this.minClusterSize},a.prototype.setMinimumClusterSize=function(e){this.minClusterSize=e},a.prototype.getMaxZoom=function(){return this.maxZoom},a.prototype.setMaxZoom=function(e){this.maxZoom=e},a.prototype.getStyles=function(){return this.styles},a.prototype.setStyles=function(e){this.styles=e},a.prototype.getTitle=function(){return this.title},a.prototype.setTitle=function(e){this.title=e},a.prototype.getZoomOnClick=function(){return this.zoomOnClick},a.prototype.setZoomOnClick=function(e){this.zoomOnClick=e},a.prototype.getAverageCenter=function(){return this.averageCenter},a.prototype.setAverageCenter=function(e){this.averageCenter=e},a.prototype.getIgnoreHidden=function(){return this.ignoreHidden},a.prototype.setIgnoreHidden=function(e){this.ignoreHidden=e},a.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons},a.prototype.setEnableRetinaIcons=function(e){this.enableRetinaIcons=e},a.prototype.getImageExtension=function(){return this.imageExtension},a.prototype.setImageExtension=function(e){this.imageExtension=e},a.prototype.getImagePath=function(){return this.imagePath},a.prototype.setImagePath=function(e){this.imagePath=e},a.prototype.getImageSizes=function(){return this.imageSizes},a.prototype.setImageSizes=function(e){this.imageSizes=e},a.prototype.getCalculator=function(){return this.calculator},a.prototype.setCalculator=function(e){this.calculator=e},a.prototype.getBatchSizeIE=function(){return this.batchSizeIE},a.prototype.setBatchSizeIE=function(e){this.batchSizeIE=e},a.prototype.getClusterClass=function(){return this.clusterClass},a.prototype.setClusterClass=function(e){this.clusterClass=e},a.prototype.getMarkers=function(){return this.markers},a.prototype.getTotalMarkers=function(){return this.markers.length},a.prototype.getClusters=function(){return this.clusters},a.prototype.getTotalClusters=function(){return this.clusters.length},a.prototype.addMarker=function(e,n){this.pushMarkerTo(e),n||this.redraw()},a.prototype.addMarkers=function(e,n){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var s=e[r];s&&this.pushMarkerTo(s)}n||this.redraw()},a.prototype.pushMarkerTo=function(e){var n=this;e.getDraggable()&&google.maps.event.addListener(e,"dragend",function(){n.ready&&(e.isAdded=!1,n.repaint())}),e.isAdded=!1,this.markers.push(e)},a.prototype.removeMarker_=function(e){var n=-1;if(this.markers.indexOf)n=this.markers.indexOf(e);else for(var r=0;r<this.markers.length;r++)if(e===this.markers[r]){n=r;break}return n===-1?!1:(e.setMap(null),this.markers.splice(n,1),!0)},a.prototype.removeMarker=function(e,n){var r=this.removeMarker_(e);return!n&&r&&this.repaint(),r},a.prototype.removeMarkers=function(e,n){for(var r=!1,s=0,o=e;s<o.length;s++){var i=o[s];r=r||this.removeMarker_(i)}return!n&&r&&this.repaint(),r},a.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers=[]},a.prototype.repaint=function(){var e=this.clusters.slice();this.clusters=[],this.resetViewport(!1),this.redraw(),setTimeout(function(){for(var r=0,s=e;r<s.length;r++){var o=s[r];o.remove()}},0)},a.prototype.getExtendedBounds=function(e){var n=this.getProjection(),r=n.fromLatLngToDivPixel(new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()));r!==null&&(r.x+=this.gridSize,r.y-=this.gridSize);var s=n.fromLatLngToDivPixel(new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()));if(s!==null&&(s.x-=this.gridSize,s.y+=this.gridSize),r!==null){var o=n.fromDivPixelToLatLng(r);o!==null&&e.extend(o)}if(s!==null){var i=n.fromDivPixelToLatLng(s);i!==null&&e.extend(i)}return e},a.prototype.redraw=function(){this.createClusters(0)},a.prototype.resetViewport=function(e){for(var n=0,r=this.clusters;n<r.length;n++){var s=r[n];s.remove()}this.clusters=[];for(var o=0,i=this.markers;o<i.length;o++){var l=i[o];l.isAdded=!1,e&&l.setMap(null)}},a.prototype.distanceBetweenPoints=function(e,n){var r=6371,s=(n.lat()-e.lat())*Math.PI/180,o=(n.lng()-e.lng())*Math.PI/180,i=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(n.lat()*Math.PI/180)*Math.sin(o/2)*Math.sin(o/2);return r*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))},a.prototype.isMarkerInBounds=function(e,n){var r=e.getPosition();return r?n.contains(r):!1},a.prototype.addToClosestCluster=function(e){for(var n,r=4e4,s=null,o=0,i=this.clusters;o<i.length;o++){var l=i[o];n=l;var c=n.getCenter(),u=e.getPosition();if(c&&u){var d=this.distanceBetweenPoints(c,u);d<r&&(r=d,s=n)}}s&&s.isMarkerInClusterBounds(e)?s.addMarker(e):(n=new nU(this),n.addMarker(e),this.clusters.push(n))},a.prototype.createClusters=function(e){var n=this;if(this.ready){e===0&&(google.maps.event.trigger(this,"clusteringbegin",this),this.timerRefStatic!==null&&(window.clearTimeout(this.timerRefStatic),delete this.timerRefStatic));for(var r=this.getMap(),s=r!==null&&("getBounds"in r)?r.getBounds():null,o=(r==null?void 0:r.getZoom())||0,i=o>3?new google.maps.LatLngBounds(s==null?void 0:s.getSouthWest(),s==null?void 0:s.getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625)),l=this.getExtendedBounds(i),c=Math.min(e+this.batchSize,this.markers.length),u=e;u<c;u++){var d=this.markers[u];d&&!d.isAdded&&this.isMarkerInBounds(d,l)&&(!this.ignoreHidden||this.ignoreHidden&&d.getVisible())&&this.addToClosestCluster(d)}if(c<this.markers.length)this.timerRefStatic=window.setTimeout(function(){n.createClusters(c)},0);else{this.timerRefStatic=null,google.maps.event.trigger(this,"clusteringend",this);for(var m=0,h=this.clusters;m<h.length;m++){var C=h[m];C.updateIcon()}}}},a.prototype.extend=function(e,n){return(function(s){for(var o in s.prototype){var i=o;this.prototype[i]=s.prototype[i]}return this}).apply(e,[n])},a}();function Pw(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function dU(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Pw(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):Pw(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}var Pn={onClick:"click",onClusteringBegin:"clusteringbegin",onClusteringEnd:"clusteringend",onMouseOut:"mouseout",onMouseOver:"mouseover"},At={averageCenter(a,e){a.setAverageCenter(e)},batchSizeIE(a,e){a.setBatchSizeIE(e)},calculator(a,e){a.setCalculator(e)},clusterClass(a,e){a.setClusterClass(e)},enableRetinaIcons(a,e){a.setEnableRetinaIcons(e)},gridSize(a,e){a.setGridSize(e)},ignoreHidden(a,e){a.setIgnoreHidden(e)},imageExtension(a,e){a.setImageExtension(e)},imagePath(a,e){a.setImagePath(e)},imageSizes(a,e){a.setImageSizes(e)},maxZoom(a,e){a.setMaxZoom(e)},minimumClusterSize(a,e){a.setMinimumClusterSize(e)},styles(a,e){a.setStyles(e)},title(a,e){a.setTitle(e)},zoomOnClick(a,e){a.setZoomOnClick(e)}},mU={};function pU(a){var{children:e,options:n,averageCenter:r,batchSizeIE:s,calculator:o,clusterClass:i,enableRetinaIcons:l,gridSize:c,ignoreHidden:u,imageExtension:d,imagePath:m,imageSizes:h,maxZoom:C,minimumClusterSize:S,styles:w,title:f,zoomOnClick:b,onClick:v,onClusteringBegin:I,onClusteringEnd:A,onMouseOver:N,onMouseOut:x,onLoad:y,onUnmount:E}=a,[_,P]=p.useState(null),k=p.useContext(dt),[D,M]=p.useState(null),[$,q]=p.useState(null),[V,z]=p.useState(null),[j,U]=p.useState(null),[Q,te]=p.useState(null);return p.useEffect(()=>{_&&x&&(j!==null&&google.maps.event.removeListener(j),U(google.maps.event.addListener(_,Pn.onMouseOut,x)))},[x]),p.useEffect(()=>{_&&N&&(Q!==null&&google.maps.event.removeListener(Q),te(google.maps.event.addListener(_,Pn.onMouseOver,N)))},[N]),p.useEffect(()=>{_&&v&&(D!==null&&google.maps.event.removeListener(D),M(google.maps.event.addListener(_,Pn.onClick,v)))},[v]),p.useEffect(()=>{_&&I&&($!==null&&google.maps.event.removeListener($),q(google.maps.event.addListener(_,Pn.onClusteringBegin,I)))},[I]),p.useEffect(()=>{_&&A&&(V!==null&&google.maps.event.removeListener(V),q(google.maps.event.addListener(_,Pn.onClusteringEnd,A)))},[A]),p.useEffect(()=>{typeof r<"u"&&_!==null&&At.averageCenter(_,r)},[_,r]),p.useEffect(()=>{typeof s<"u"&&_!==null&&At.batchSizeIE(_,s)},[_,s]),p.useEffect(()=>{typeof o<"u"&&_!==null&&At.calculator(_,o)},[_,o]),p.useEffect(()=>{typeof i<"u"&&_!==null&&At.clusterClass(_,i)},[_,i]),p.useEffect(()=>{typeof l<"u"&&_!==null&&At.enableRetinaIcons(_,l)},[_,l]),p.useEffect(()=>{typeof c<"u"&&_!==null&&At.gridSize(_,c)},[_,c]),p.useEffect(()=>{typeof u<"u"&&_!==null&&At.ignoreHidden(_,u)},[_,u]),p.useEffect(()=>{typeof d<"u"&&_!==null&&At.imageExtension(_,d)},[_,d]),p.useEffect(()=>{typeof m<"u"&&_!==null&&At.imagePath(_,m)},[_,m]),p.useEffect(()=>{typeof h<"u"&&_!==null&&At.imageSizes(_,h)},[_,h]),p.useEffect(()=>{typeof C<"u"&&_!==null&&At.maxZoom(_,C)},[_,C]),p.useEffect(()=>{typeof S<"u"&&_!==null&&At.minimumClusterSize(_,S)},[_,S]),p.useEffect(()=>{typeof w<"u"&&_!==null&&At.styles(_,w)},[_,w]),p.useEffect(()=>{typeof f<"u"&&_!==null&&At.title(_,f)},[_,f]),p.useEffect(()=>{typeof b<"u"&&_!==null&&At.zoomOnClick(_,b)},[_,b]),p.useEffect(()=>{if(k){var se=dU({},n||mU),X=new QA(k,[],se);return r&&At.averageCenter(X,r),s&&At.batchSizeIE(X,s),o&&At.calculator(X,o),i&&At.clusterClass(X,i),l&&At.enableRetinaIcons(X,l),c&&At.gridSize(X,c),u&&At.ignoreHidden(X,u),d&&At.imageExtension(X,d),m&&At.imagePath(X,m),h&&At.imageSizes(X,h),C&&At.maxZoom(X,C),S&&At.minimumClusterSize(X,S),w&&At.styles(X,w),f&&At.title(X,f),b&&At.zoomOnClick(X,b),x&&U(google.maps.event.addListener(X,Pn.onMouseOut,x)),N&&te(google.maps.event.addListener(X,Pn.onMouseOver,N)),v&&M(google.maps.event.addListener(X,Pn.onClick,v)),I&&q(google.maps.event.addListener(X,Pn.onClusteringBegin,I)),A&&z(google.maps.event.addListener(X,Pn.onClusteringEnd,A)),P(X),y&&y(X),()=>{j!==null&&google.maps.event.removeListener(j),Q!==null&&google.maps.event.removeListener(Q),D!==null&&google.maps.event.removeListener(D),$!==null&&google.maps.event.removeListener($),V!==null&&google.maps.event.removeListener(V),E&&E(X)}}},[]),_!==null&&e(_)||null}p.memo(pU);class gU extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[]),ue(this,"state",{markerClusterer:null}),ue(this,"setClustererCallback",()=>{this.state.markerClusterer!==null&&this.props.onLoad&&this.props.onLoad(this.state.markerClusterer)})}componentDidMount(){if(this.context){var e=new QA(this.context,[],this.props.options);this.registeredEvents=vt({updaterMap:At,eventMap:Pn,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({markerClusterer:e}),this.setClustererCallback)}}componentDidUpdate(e){this.state.markerClusterer&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:At,eventMap:Pn,prevProps:e,nextProps:this.props,instance:this.state.markerClusterer}))}componentWillUnmount(){this.state.markerClusterer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.markerClusterer),Et(this.registeredEvents),this.state.markerClusterer.setMap(null))}render(){return this.state.markerClusterer!==null?this.props.children(this.state.markerClusterer):null}}ue(gU,"contextType",dt);function Rw(a){a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation()}var JA=function(){function a(e){e===void 0&&(e={}),this.getCloseClickHandler=this.getCloseClickHandler.bind(this),this.closeClickHandler=this.closeClickHandler.bind(this),this.createInfoBoxDiv=this.createInfoBoxDiv.bind(this),this.addClickHandler=this.addClickHandler.bind(this),this.getCloseBoxImg=this.getCloseBoxImg.bind(this),this.getBoxWidths=this.getBoxWidths.bind(this),this.setBoxStyle=this.setBoxStyle.bind(this),this.setPosition=this.setPosition.bind(this),this.getPosition=this.getPosition.bind(this),this.setOptions=this.setOptions.bind(this),this.setContent=this.setContent.bind(this),this.setVisible=this.setVisible.bind(this),this.getContent=this.getContent.bind(this),this.getVisible=this.getVisible.bind(this),this.setZIndex=this.setZIndex.bind(this),this.getZIndex=this.getZIndex.bind(this),this.onRemove=this.onRemove.bind(this),this.panBox=this.panBox.bind(this),this.extend=this.extend.bind(this),this.close=this.close.bind(this),this.draw=this.draw.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.open=this.open.bind(this),this.extend(a,google.maps.OverlayView),this.content=e.content||"",this.disableAutoPan=e.disableAutoPan||!1,this.maxWidth=e.maxWidth||0,this.pixelOffset=e.pixelOffset||new google.maps.Size(0,0),this.position=e.position||new google.maps.LatLng(0,0),this.zIndex=e.zIndex||null,this.boxClass=e.boxClass||"infoBox",this.boxStyle=e.boxStyle||{},this.closeBoxMargin=e.closeBoxMargin||"2px",this.closeBoxURL=e.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",e.closeBoxURL===""&&(this.closeBoxURL=""),this.infoBoxClearance=e.infoBoxClearance||new google.maps.Size(1,1),typeof e.visible>"u"&&(typeof e.isHidden>"u"?e.visible=!0:e.visible=!e.isHidden),this.isHidden=!e.visible,this.alignBottom=e.alignBottom||!1,this.pane=e.pane||"floatPane",this.enableEventPropagation=e.enableEventPropagation||!1,this.div=null,this.closeListener=null,this.moveListener=null,this.mapListener=null,this.contextListener=null,this.eventListeners=null,this.fixedWidthSet=null}return a.prototype.createInfoBoxDiv=function(){var e=this,n=function(d){d.returnValue=!1,d.preventDefault&&d.preventDefault(),e.enableEventPropagation||Rw(d)};if(!this.div){this.div=document.createElement("div"),this.setBoxStyle(),typeof this.content=="string"?this.div.innerHTML=this.getCloseBoxImg()+this.content:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(this.content));var r=this.getPanes();if(r!==null&&r[this.pane].appendChild(this.div),this.addClickHandler(),this.div.style.width)this.fixedWidthSet=!0;else if(this.maxWidth!==0&&this.div.offsetWidth>this.maxWidth)this.div.style.width=this.maxWidth+"px",this.fixedWidthSet=!0;else{var s=this.getBoxWidths();this.div.style.width=this.div.offsetWidth-s.left-s.right+"px",this.fixedWidthSet=!1}if(this.panBox(this.disableAutoPan),!this.enableEventPropagation){this.eventListeners=[];for(var o=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],i=0,l=o;i<l.length;i++){var c=l[i];this.eventListeners.push(google.maps.event.addListener(this.div,c,Rw))}this.eventListeners.push(google.maps.event.addListener(this.div,"mouseover",function(){e.div&&(e.div.style.cursor="default")}))}this.contextListener=google.maps.event.addListener(this.div,"contextmenu",n),google.maps.event.trigger(this,"domready")}},a.prototype.getCloseBoxImg=function(){var e="";return this.closeBoxURL!==""&&(e='<img alt=""',e+=' aria-hidden="true"',e+=" src='"+this.closeBoxURL+"'",e+=" align=right",e+=" style='",e+=" position: relative;",e+=" cursor: pointer;",e+=" margin: "+this.closeBoxMargin+";",e+="'>"),e},a.prototype.addClickHandler=function(){this.closeListener=this.div&&this.div.firstChild&&this.closeBoxURL!==""?google.maps.event.addListener(this.div.firstChild,"click",this.getCloseClickHandler()):null},a.prototype.closeClickHandler=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(this,"closeclick"),this.close()},a.prototype.getCloseClickHandler=function(){return this.closeClickHandler},a.prototype.panBox=function(e){if(this.div&&!e){var n=this.getMap();if(n instanceof google.maps.Map){var r=0,s=0,o=n.getBounds();o&&!o.contains(this.position)&&n.setCenter(this.position);var i=n.getDiv(),l=i.offsetWidth,c=i.offsetHeight,u=this.pixelOffset.width,d=this.pixelOffset.height,m=this.div.offsetWidth,h=this.div.offsetHeight,C=this.infoBoxClearance.width,S=this.infoBoxClearance.height,w=this.getProjection(),f=w.fromLatLngToContainerPixel(this.position);f!==null&&(f.x<-u+C?r=f.x+u-C:f.x+m+u+C>l&&(r=f.x+m+u+C-l),this.alignBottom?f.y<-d+S+h?s=f.y+d-S-h:f.y+d+S>c&&(s=f.y+d+S-c):f.y<-d+S?s=f.y+d-S:f.y+h+d+S>c&&(s=f.y+h+d+S-c)),r===0&&s===0||n.panBy(r,s)}}},a.prototype.setBoxStyle=function(){if(this.div){this.div.className=this.boxClass,this.div.style.cssText="";var e=this.boxStyle;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(this.div.style[n]=e[n]);if(this.div.style.webkitTransform="translateZ(0)",typeof this.div.style.opacity<"u"&&this.div.style.opacity!==""){var r=parseFloat(this.div.style.opacity||"");this.div.style.msFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+r*100+')"',this.div.style.filter="alpha(opacity="+r*100+")"}this.div.style.position="absolute",this.div.style.visibility="hidden",this.zIndex!==null&&(this.div.style.zIndex=this.zIndex+""),this.div.style.overflow||(this.div.style.overflow="auto")}},a.prototype.getBoxWidths=function(){var e={top:0,bottom:0,left:0,right:0};if(!this.div)return e;if(document.defaultView){var n=this.div.ownerDocument,r=n&&n.defaultView?n.defaultView.getComputedStyle(this.div,""):null;r&&(e.top=parseInt(r.borderTopWidth||"",10)||0,e.bottom=parseInt(r.borderBottomWidth||"",10)||0,e.left=parseInt(r.borderLeftWidth||"",10)||0,e.right=parseInt(r.borderRightWidth||"",10)||0)}else if(document.documentElement.currentStyle){var s=this.div.currentStyle;s&&(e.top=parseInt(s.borderTopWidth||"",10)||0,e.bottom=parseInt(s.borderBottomWidth||"",10)||0,e.left=parseInt(s.borderLeftWidth||"",10)||0,e.right=parseInt(s.borderRightWidth||"",10)||0)}return e},a.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.div.parentNode.removeChild(this.div),this.div=null)},a.prototype.draw=function(){if(this.createInfoBoxDiv(),this.div){var e=this.getProjection(),n=e.fromLatLngToDivPixel(this.position);n!==null&&(this.div.style.left=n.x+this.pixelOffset.width+"px",this.alignBottom?this.div.style.bottom=-(n.y+this.pixelOffset.height)+"px":this.div.style.top=n.y+this.pixelOffset.height+"px"),this.isHidden?this.div.style.visibility="hidden":this.div.style.visibility="visible"}},a.prototype.setOptions=function(e){e===void 0&&(e={}),typeof e.boxClass<"u"&&(this.boxClass=e.boxClass,this.setBoxStyle()),typeof e.boxStyle<"u"&&(this.boxStyle=e.boxStyle,this.setBoxStyle()),typeof e.content<"u"&&this.setContent(e.content),typeof e.disableAutoPan<"u"&&(this.disableAutoPan=e.disableAutoPan),typeof e.maxWidth<"u"&&(this.maxWidth=e.maxWidth),typeof e.pixelOffset<"u"&&(this.pixelOffset=e.pixelOffset),typeof e.alignBottom<"u"&&(this.alignBottom=e.alignBottom),typeof e.position<"u"&&this.setPosition(e.position),typeof e.zIndex<"u"&&this.setZIndex(e.zIndex),typeof e.closeBoxMargin<"u"&&(this.closeBoxMargin=e.closeBoxMargin),typeof e.closeBoxURL<"u"&&(this.closeBoxURL=e.closeBoxURL),typeof e.infoBoxClearance<"u"&&(this.infoBoxClearance=e.infoBoxClearance),typeof e.isHidden<"u"&&(this.isHidden=e.isHidden),typeof e.visible<"u"&&(this.isHidden=!e.visible),typeof e.enableEventPropagation<"u"&&(this.enableEventPropagation=e.enableEventPropagation),this.div&&this.draw()},a.prototype.setContent=function(e){this.content=e,this.div&&(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.fixedWidthSet||(this.div.style.width=""),typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e)),this.fixedWidthSet||(this.div.style.width=this.div.offsetWidth+"px",typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e))),this.addClickHandler()),google.maps.event.trigger(this,"content_changed")},a.prototype.setPosition=function(e){this.position=e,this.div&&this.draw(),google.maps.event.trigger(this,"position_changed")},a.prototype.setVisible=function(e){this.isHidden=!e,this.div&&(this.div.style.visibility=this.isHidden?"hidden":"visible")},a.prototype.setZIndex=function(e){this.zIndex=e,this.div&&(this.div.style.zIndex=e+""),google.maps.event.trigger(this,"zindex_changed")},a.prototype.getContent=function(){return this.content},a.prototype.getPosition=function(){return this.position},a.prototype.getZIndex=function(){return this.zIndex},a.prototype.getVisible=function(){var e=this.getMap();return typeof e>"u"||e===null?!1:!this.isHidden},a.prototype.show=function(){this.isHidden=!1,this.div&&(this.div.style.visibility="visible")},a.prototype.hide=function(){this.isHidden=!0,this.div&&(this.div.style.visibility="hidden")},a.prototype.open=function(e,n){var r=this;n&&(this.position=n.getPosition(),this.moveListener=google.maps.event.addListener(n,"position_changed",function(){var s=n.getPosition();r.setPosition(s)}),this.mapListener=google.maps.event.addListener(n,"map_changed",function(){r.setMap(n.map)})),this.setMap(e),this.div&&this.panBox()},a.prototype.close=function(){if(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.eventListeners){for(var e=0,n=this.eventListeners;e<n.length;e++){var r=n[e];google.maps.event.removeListener(r)}this.eventListeners=null}this.moveListener&&(google.maps.event.removeListener(this.moveListener),this.moveListener=null),this.mapListener&&(google.maps.event.removeListener(this.mapListener),this.mapListener=null),this.contextListener&&(google.maps.event.removeListener(this.contextListener),this.contextListener=null),this.setMap(null)},a.prototype.extend=function(e,n){return(function(s){for(var o in s.prototype)Object.prototype.hasOwnProperty.call(this,o)||(this.prototype[o]=s.prototype[o]);return this}).apply(e,[n])},a}(),fU=["position"],hU=["position"];function Dw(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function Hp(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Dw(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):Dw(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}var Lw={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},Mw={options(a,e){a.setOptions(e)},position(a,e){e instanceof google.maps.LatLng?a.setPosition(e):a.setPosition(new google.maps.LatLng(e.lat,e.lng))},visible(a,e){a.setVisible(e)},zIndex(a,e){a.setZIndex(e)}},vU={};function bU(a){var{children:e,anchor:n,options:r,position:s,zIndex:o,onCloseClick:i,onDomReady:l,onContentChanged:c,onPositionChanged:u,onZindexChanged:d,onLoad:m,onUnmount:h}=a,C=p.useContext(dt),[S,w]=p.useState(null),[f,b]=p.useState(null),[v,I]=p.useState(null),[A,N]=p.useState(null),[x,y]=p.useState(null),[E,_]=p.useState(null),P=p.useRef(null);return p.useEffect(()=>{C&&S!==null&&(S.close(),n?S.open(C,n):S.getPosition()&&S.open(C))},[C,S,n]),p.useEffect(()=>{r&&S!==null&&S.setOptions(r)},[S,r]),p.useEffect(()=>{if(s&&S!==null){var k=s instanceof google.maps.LatLng?s:new google.maps.LatLng(s.lat,s.lng);S.setPosition(k)}},[s]),p.useEffect(()=>{typeof o=="number"&&S!==null&&S.setZIndex(o)},[o]),p.useEffect(()=>{S&&i&&(f!==null&&google.maps.event.removeListener(f),b(google.maps.event.addListener(S,"closeclick",i)))},[i]),p.useEffect(()=>{S&&l&&(v!==null&&google.maps.event.removeListener(v),I(google.maps.event.addListener(S,"domready",l)))},[l]),p.useEffect(()=>{S&&c&&(A!==null&&google.maps.event.removeListener(A),N(google.maps.event.addListener(S,"content_changed",c)))},[c]),p.useEffect(()=>{S&&u&&(x!==null&&google.maps.event.removeListener(x),y(google.maps.event.addListener(S,"position_changed",u)))},[u]),p.useEffect(()=>{S&&d&&(E!==null&&google.maps.event.removeListener(E),_(google.maps.event.addListener(S,"zindex_changed",d)))},[d]),p.useEffect(()=>{if(C){var k=r||vU,{position:D}=k,M=RE(k,fU),$;D&&!(D instanceof google.maps.LatLng)&&($=new google.maps.LatLng(D.lat,D.lng));var q=new JA(Hp(Hp({},M),$?{position:$}:{}));P.current=document.createElement("div"),w(q),i&&b(google.maps.event.addListener(q,"closeclick",i)),l&&I(google.maps.event.addListener(q,"domready",l)),c&&N(google.maps.event.addListener(q,"content_changed",c)),u&&y(google.maps.event.addListener(q,"position_changed",u)),d&&_(google.maps.event.addListener(q,"zindex_changed",d)),q.setContent(P.current),n?q.open(C,n):q.getPosition()?q.open(C):Ca(!1,"You must provide either an anchor or a position prop for <InfoBox>."),m&&m(q)}return()=>{S!==null&&(f&&google.maps.event.removeListener(f),A&&google.maps.event.removeListener(A),v&&google.maps.event.removeListener(v),x&&google.maps.event.removeListener(x),E&&google.maps.event.removeListener(E),h&&h(S),S.close())}},[]),P.current?pi.createPortal(p.Children.only(e),P.current):null}p.memo(bU);class EU extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[]),ue(this,"containerElement",null),ue(this,"state",{infoBox:null}),ue(this,"open",(e,n)=>{n?this.context!==null&&e.open(this.context,n):e.getPosition()?this.context!==null&&e.open(this.context):Ca(!1,"You must provide either an anchor or a position prop for <InfoBox>.")}),ue(this,"setInfoBoxCallback",()=>{this.state.infoBox!==null&&this.containerElement!==null&&(this.state.infoBox.setContent(this.containerElement),this.open(this.state.infoBox,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoBox))})}componentDidMount(){var e=this.props.options||{},{position:n}=e,r=RE(e,hU),s;n&&!(n instanceof google.maps.LatLng)&&(s=new google.maps.LatLng(n.lat,n.lng));var o=new JA(Hp(Hp({},r),s?{position:s}:{}));this.containerElement=document.createElement("div"),this.registeredEvents=vt({updaterMap:Mw,eventMap:Lw,prevProps:{},nextProps:this.props,instance:o}),this.setState({infoBox:o},this.setInfoBoxCallback)}componentDidUpdate(e){var{infoBox:n}=this.state;n!==null&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:Mw,eventMap:Lw,prevProps:e,nextProps:this.props,instance:n}))}componentWillUnmount(){var{onUnmount:e}=this.props,{infoBox:n}=this.state;n!==null&&(e&&e(n),Et(this.registeredEvents),n.close())}render(){return this.containerElement?pi.createPortal(p.Children.only(this.props.children),this.containerElement):null}}ue(EU,"contextType",dt);var lh,Vw;function xU(){return Vw||(Vw=1,lh=function a(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,s,o;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(s=r;s--!==0;)if(!a(e[s],n[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(o=Object.keys(e),r=o.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[s]))return!1;for(s=r;s--!==0;){var i=o[s];if(!a(e[i],n[i]))return!1}return!0}return e!==e&&n!==n}),lh}var yU=xU(),Ow=UA(yU),jw=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],ch=1,Lc=8;class DE{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var[n,r]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");var s=r>>4;if(s!==ch)throw new Error("Got v".concat(s," data when expected v").concat(ch,"."));var o=jw[r&15];if(!o)throw new Error("Unrecognized array type.");var[i]=new Uint16Array(e,2,1),[l]=new Uint32Array(e,4,1);return new DE(l,i,o,e)}constructor(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,s=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;var o=jw.indexOf(this.ArrayType),i=e*2*this.ArrayType.BYTES_PER_ELEMENT,l=e*this.IndexArrayType.BYTES_PER_ELEMENT,c=(8-l%8)%8;if(o<0)throw new Error("Unexpected typed array class: ".concat(r,"."));s&&s instanceof ArrayBuffer?(this.data=s,this.ids=new this.IndexArrayType(this.data,Lc,e),this.coords=new this.ArrayType(this.data,Lc+l+c,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(Lc+i+l+c),this.ids=new this.IndexArrayType(this.data,Lc,e),this.coords=new this.ArrayType(this.data,Lc+l+c,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(ch<<4)+o]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){var r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=n,r}finish(){var e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return Q0(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:o,coords:i,nodeSize:l}=this,c=[0,o.length-1,0],u=[];c.length;){var d=c.pop()||0,m=c.pop()||0,h=c.pop()||0;if(m-h<=l){for(var C=h;C<=m;C++){var S=i[2*C],w=i[2*C+1];S>=e&&S<=r&&w>=n&&w<=s&&u.push(o[C])}continue}var f=h+m>>1,b=i[2*f],v=i[2*f+1];b>=e&&b<=r&&v>=n&&v<=s&&u.push(o[f]),(d===0?e<=b:n<=v)&&(c.push(h),c.push(f-1),c.push(1-d)),(d===0?r>=b:s>=v)&&(c.push(f+1),c.push(m),c.push(1-d))}return u}within(e,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:s,coords:o,nodeSize:i}=this,l=[0,s.length-1,0],c=[],u=r*r;l.length;){var d=l.pop()||0,m=l.pop()||0,h=l.pop()||0;if(m-h<=i){for(var C=h;C<=m;C++)Fw(o[2*C],o[2*C+1],e,n)<=u&&c.push(s[C]);continue}var S=h+m>>1,w=o[2*S],f=o[2*S+1];Fw(w,f,e,n)<=u&&c.push(s[S]),(d===0?e-r<=w:n-r<=f)&&(l.push(h),l.push(S-1),l.push(1-d)),(d===0?e+r>=w:n+r>=f)&&(l.push(S+1),l.push(m),l.push(1-d))}return c}}function Q0(a,e,n,r,s,o){if(!(s-r<=n)){var i=r+s>>1;YA(a,e,i,r,s,o),Q0(a,e,n,r,i-1,1-o),Q0(a,e,n,i+1,s,1-o)}}function YA(a,e,n,r,s,o){for(;s>r;){if(s-r>600){var i=s-r+1,l=n-r+1,c=Math.log(i),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(i-u)/i)*(l-i/2<0?-1:1),m=Math.max(r,Math.floor(n-l*u/i+d)),h=Math.min(s,Math.floor(n+(i-l)*u/i+d));YA(a,e,n,m,h,o)}var C=e[2*n+o],S=r,w=s;for(Mc(a,e,r,n),e[2*s+o]>C&&Mc(a,e,r,s);S<w;){for(Mc(a,e,S,w),S++,w--;e[2*S+o]<C;)S++;for(;e[2*w+o]>C;)w--}e[2*r+o]===C?Mc(a,e,r,w):(w++,Mc(a,e,w,s)),w<=n&&(r=w+1),n<=w&&(s=w-1)}}function Mc(a,e,n,r){uh(a,n,r),uh(e,2*n,2*r),uh(e,2*n+1,2*r+1)}function uh(a,e,n){var r=a[e];a[e]=a[n],a[n]=r}function Fw(a,e,n,r){var s=a-n,o=e-r;return s*s+o*o}var NU={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:a=>a},zw=Math.fround||(a=>e=>(a[0]=+e,a[0]))(new Float32Array(1)),wo=2,Ns=3,dh=4,Es=5,ZA=6;class wU{constructor(e){this.options=Object.assign(Object.create(NU),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){var{log:n,minZoom:r,maxZoom:s}=this.options;n&&console.time("total time");var o="prepare ".concat(e.length," points");n&&console.time(o),this.points=e;for(var i=[],l=0;l<e.length;l++){var c=e[l];if(c.geometry){var[u,d]=c.geometry.coordinates,m=zw(Em(u)),h=zw(xm(d));i.push(m,h,1/0,l,-1,1),this.options.reduce&&i.push(0)}}var C=this.trees[s+1]=this._createTree(i);n&&console.timeEnd(o);for(var S=s;S>=r;S--){var w=+Date.now();C=this.trees[S]=this._createTree(this._cluster(C,S)),n&&console.log("z%d: %d clusters in %dms",S,C.numItems,+Date.now()-w)}return n&&console.timeEnd("total time"),this}getClusters(e,n){var r=((e[0]+180)%360+360)%360-180,s=Math.max(-90,Math.min(90,e[1])),o=e[2]===180?180:((e[2]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,o=180;else if(r>o){var l=this.getClusters([r,s,180,i],n),c=this.getClusters([-180,s,o,i],n);return l.concat(c)}var u=this.trees[this._limitZoom(n)],d=u.range(Em(r),xm(i),Em(o),xm(s)),m=u.data,h=[];for(var C of d){var S=this.stride*C;h.push(m[S+Es]>1?Uw(m,S,this.clusterProps):this.points[m[S+Ns]])}return h}getChildren(e){var n=this._getOriginId(e),r=this._getOriginZoom(e),s="No cluster with the specified id.",o=this.trees[r];if(!o)throw new Error(s);var i=o.data;if(n*this.stride>=i.length)throw new Error(s);var l=this.options.radius/(this.options.extent*Math.pow(2,r-1)),c=i[n*this.stride],u=i[n*this.stride+1],d=o.within(c,u,l),m=[];for(var h of d){var C=h*this.stride;i[C+dh]===e&&m.push(i[C+Es]>1?Uw(i,C,this.clusterProps):this.points[i[C+Ns]])}if(m.length===0)throw new Error(s);return m}getLeaves(e,n,r){n=n||10,r=r||0;var s=[];return this._appendLeaves(s,e,n,r,0),s}getTile(e,n,r){var s=this.trees[this._limitZoom(e)],o=Math.pow(2,e),{extent:i,radius:l}=this.options,c=l/i,u=(r-c)/o,d=(r+1+c)/o,m={features:[]};return this._addTileFeatures(s.range((n-c)/o,u,(n+1+c)/o,d),s.data,n,r,o,m),n===0&&this._addTileFeatures(s.range(1-c/o,u,1,d),s.data,o,r,o,m),n===o-1&&this._addTileFeatures(s.range(0,u,c/o,d),s.data,-1,r,o,m),m.features.length?m:null}getClusterExpansionZoom(e){for(var n=this._getOriginZoom(e)-1;n<=this.options.maxZoom;){var r=this.getChildren(e);if(n++,r.length!==1)break;e=r[0].properties.cluster_id}return n}_appendLeaves(e,n,r,s,o){var i=this.getChildren(n);for(var l of i){var c=l.properties;if(c&&c.cluster?o+c.point_count<=s?o+=c.point_count:o=this._appendLeaves(e,c.cluster_id,r,s,o):o<s?o++:e.push(l),e.length===r)break}return o}_createTree(e){for(var n=new DE(e.length/this.stride|0,this.options.nodeSize,Float32Array),r=0;r<e.length;r+=this.stride)n.add(e[r],e[r+1]);return n.finish(),n.data=e,n}_addTileFeatures(e,n,r,s,o,i){for(var l of e){var c=l*this.stride,u=n[c+Es]>1,d=void 0,m=void 0,h=void 0;if(u)d=XA(n,c,this.clusterProps),m=n[c],h=n[c+1];else{var C=this.points[n[c+Ns]];d=C.properties;var[S,w]=C.geometry.coordinates;m=Em(S),h=xm(w)}var f={type:1,geometry:[[Math.round(this.options.extent*(m*o-r)),Math.round(this.options.extent*(h*o-s))]],tags:d},b=void 0;u||this.options.generateId?b=n[c+Ns]:b=this.points[n[c+Ns]].id,b!==void 0&&(f.id=b),i.features.push(f)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,n){for(var{radius:r,extent:s,reduce:o,minPoints:i}=this.options,l=r/(s*Math.pow(2,n)),c=e.data,u=[],d=this.stride,m=0;m<c.length;m+=d)if(!(c[m+wo]<=n)){c[m+wo]=n;var h=c[m],C=c[m+1],S=e.within(c[m],c[m+1],l),w=c[m+Es],f=w;for(var b of S){var v=b*d;c[v+wo]>n&&(f+=c[v+Es])}if(f>w&&f>=i){var I=h*w,A=C*w,N=void 0,x=-1,y=((m/d|0)<<5)+(n+1)+this.points.length;for(var E of S){var _=E*d;if(!(c[_+wo]<=n)){c[_+wo]=n;var P=c[_+Es];I+=c[_]*P,A+=c[_+1]*P,c[_+dh]=y,o&&(N||(N=this._map(c,m,!0),x=this.clusterProps.length,this.clusterProps.push(N)),o(N,this._map(c,_)))}}c[m+dh]=y,u.push(I/f,A/f,1/0,y,-1,f),o&&u.push(x)}else{for(var k=0;k<d;k++)u.push(c[m+k]);if(f>1)for(var D of S){var M=D*d;if(!(c[M+wo]<=n)){c[M+wo]=n;for(var $=0;$<d;$++)u.push(c[M+$])}}}}return u}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,n,r){if(e[n+Es]>1){var s=this.clusterProps[e[n+ZA]];return r?Object.assign({},s):s}var o=this.points[e[n+Ns]].properties,i=this.options.map(o);return r&&i===o?Object.assign({},i):i}}function Uw(a,e,n){return{type:"Feature",id:a[e+Ns],properties:XA(a,e,n),geometry:{type:"Point",coordinates:[_U(a[e]),CU(a[e+1])]}}}function XA(a,e,n){var r=a[e+Es],s=r>=1e4?"".concat(Math.round(r/1e3),"k"):r>=1e3?"".concat(Math.round(r/100)/10,"k"):r,o=a[e+ZA],i=o===-1?{}:Object.assign({},n[o]);return Object.assign(i,{cluster:!0,cluster_id:a[e+Ns],point_count:r,point_count_abbreviated:s})}function Em(a){return a/360+.5}function xm(a){var e=Math.sin(a*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function _U(a){return(a-.5)*360}function CU(a){var e=(180-a*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function SU(a,e){var n={};for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&e.indexOf(r)<0&&(n[r]=a[r]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(a);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(a,r[s])&&(n[r[s]]=a[r[s]]);return n}class Nn{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,n){this.isAdvancedMarker(e)?e.map=n:e.setMap(n)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class J0{constructor(e){var{markers:n,position:r}=e;this.markers=n,r&&(r instanceof google.maps.LatLng?this._position=r:this._position=new google.maps.LatLng(r))}get bounds(){if(!(this.markers.length===0&&!this._position)){var e=new google.maps.LatLngBounds(this._position,this._position);for(var n of this.markers)e.extend(Nn.getPosition(n));return e}}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>Nn.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(Nn.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class kU{constructor(e){var{maxZoom:n=16}=e;this.maxZoom=n}noop(e){var{markers:n}=e;return IU(n)}}var IU=a=>{var e=a.map(n=>new J0({position:Nn.getPosition(n),markers:[n]}));return e};class AU extends kU{constructor(e){var{maxZoom:n,radius:r=60}=e,s=SU(e,["maxZoom","radius"]);super({maxZoom:n}),this.state={zoom:-1},this.superCluster=new wU(Object.assign({maxZoom:this.maxZoom,radius:r},s))}calculate(e){var n=!1,r={zoom:e.map.getZoom()};if(!Ow(e.markers,this.markers)){n=!0,this.markers=[...e.markers];var s=this.markers.map(o=>{var i=Nn.getPosition(o),l=[i.lng(),i.lat()];return{type:"Feature",geometry:{type:"Point",coordinates:l},properties:{marker:o}}});this.superCluster.load(s)}return n||(this.state.zoom<=this.maxZoom||r.zoom<=this.maxZoom)&&(n=!Ow(this.state,r)),this.state=r,n&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:n}}cluster(e){var{map:n}=e;return this.superCluster.getClusters([-180,-90,180,90],Math.round(n.getZoom())).map(r=>this.transformCluster(r))}transformCluster(e){var{geometry:{coordinates:[n,r]},properties:s}=e;if(s.cluster)return new J0({markers:this.superCluster.getLeaves(s.cluster_id,1/0).map(i=>i.properties.marker),position:{lat:r,lng:n}});var o=s.marker;return new J0({markers:[o],position:Nn.getPosition(o)})}}class TU{constructor(e,n){this.markers={sum:e.length};var r=n.map(o=>o.count),s=r.reduce((o,i)=>o+i,0);this.clusters={count:n.length,markers:{mean:s/n.length,sum:s,min:Math.min(...r),max:Math.max(...r)}}}}class PU{render(e,n,r){var{count:s,position:o}=e,i=s>Math.max(10,n.clusters.markers.mean)?"#ff0000":"#0000ff",l='<svg fill="'.concat(i,`" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">`).concat(s,`</text>
</svg>`),c="Cluster of ".concat(s," markers"),u=Number(google.maps.Marker.MAX_ZINDEX)+s;if(Nn.isAdvancedMarkerAvailable(r)){var d=new DOMParser,m=d.parseFromString(l,"image/svg+xml").documentElement;m.setAttribute("transform","translate(0 25)");var h={map:r,position:o,zIndex:u,title:c,content:m};return new google.maps.marker.AdvancedMarkerElement(h)}var C={position:o,zIndex:u,title:c,icon:{url:"data:image/svg+xml;base64,".concat(btoa(l)),anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(C)}}function RU(a,e){for(var n in e.prototype)a.prototype[n]=e.prototype[n]}class LE{constructor(){RU(LE,google.maps.OverlayView)}}var uu;(function(a){a.CLUSTERING_BEGIN="clusteringbegin",a.CLUSTERING_END="clusteringend",a.CLUSTER_CLICK="click"})(uu||(uu={}));var DU=(a,e,n)=>{n.fitBounds(e.bounds)};class LU extends LE{constructor(e){var{map:n,markers:r=[],algorithmOptions:s={},algorithm:o=new AU(s),renderer:i=new PU,onClusterClick:l=DU}=e;super(),this.markers=[...r],this.clusters=[],this.algorithm=o,this.renderer=i,this.onClusterClick=l,n&&this.setMap(n)}addMarker(e,n){this.markers.includes(e)||(this.markers.push(e),n||this.render())}addMarkers(e,n){e.forEach(r=>{this.addMarker(r,!0)}),n||this.render()}removeMarker(e,n){var r=this.markers.indexOf(e);return r===-1?!1:(Nn.setMap(e,null),this.markers.splice(r,1),n||this.render(),!0)}removeMarkers(e,n){var r=!1;return e.forEach(s=>{r=this.removeMarker(s,!0)||r}),r&&!n&&this.render(),r}clearMarkers(e){this.markers.length=0,e||this.render()}render(){var e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,uu.CLUSTERING_BEGIN,this);var{clusters:n,changed:r}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(r||r==null){var s=new Set;for(var o of n)o.markers.length==1&&s.add(o.markers[0]);var i=[];for(var l of this.clusters)l.marker!=null&&(l.markers.length==1?s.has(l.marker)||Nn.setMap(l.marker,null):i.push(l.marker));this.clusters=n,this.renderClusters(),requestAnimationFrame(()=>i.forEach(c=>Nn.setMap(c,null)))}google.maps.event.trigger(this,uu.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>Nn.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){var e=new TU(this.markers,this.clusters),n=this.getMap();this.clusters.forEach(r=>{r.markers.length===1?r.marker=r.markers[0]:(r.marker=this.renderer.render(r,e,n),r.markers.forEach(s=>Nn.setMap(s,null)),this.onClusterClick&&r.marker.addListener("click",s=>{google.maps.event.trigger(this,uu.CLUSTER_CLICK,r),this.onClusterClick(s,r,n)})),Nn.setMap(r.marker,n)})}}function $w(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function Bw(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?$w(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):$w(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}function MU(a){var e=L7(),[n,r]=p.useState(null);return p.useEffect(()=>{if(e&&n===null){var s=new LU(Bw(Bw({},a),{},{map:e}));r(s)}},[e]),n}function VU(a){var{children:e,options:n}=a,r=MU(n);return r!==null?e(r):null}p.memo(VU);var qw={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},Ww={options(a,e){a.setOptions(e)},position(a,e){a.setPosition(e)},zIndex(a,e){a.setZIndex(e)}};function OU(a){var{children:e,anchor:n,options:r,position:s,zIndex:o,onCloseClick:i,onDomReady:l,onContentChanged:c,onPositionChanged:u,onZindexChanged:d,onLoad:m,onUnmount:h}=a,C=p.useContext(dt),[S,w]=p.useState(null),[f,b]=p.useState(null),[v,I]=p.useState(null),[A,N]=p.useState(null),[x,y]=p.useState(null),[E,_]=p.useState(null),P=p.useRef(null);return p.useEffect(()=>{S!==null&&(S.close(),n?S.open(C,n):S.getPosition()&&S.open(C))},[C,S,n]),p.useEffect(()=>{r&&S!==null&&S.setOptions(r)},[S,r]),p.useEffect(()=>{s&&S!==null&&S.setPosition(s)},[s]),p.useEffect(()=>{typeof o=="number"&&S!==null&&S.setZIndex(o)},[o]),p.useEffect(()=>{S&&i&&(f!==null&&google.maps.event.removeListener(f),b(google.maps.event.addListener(S,"closeclick",i)))},[i]),p.useEffect(()=>{S&&l&&(v!==null&&google.maps.event.removeListener(v),I(google.maps.event.addListener(S,"domready",l)))},[l]),p.useEffect(()=>{S&&c&&(A!==null&&google.maps.event.removeListener(A),N(google.maps.event.addListener(S,"content_changed",c)))},[c]),p.useEffect(()=>{S&&u&&(x!==null&&google.maps.event.removeListener(x),y(google.maps.event.addListener(S,"position_changed",u)))},[u]),p.useEffect(()=>{S&&d&&(E!==null&&google.maps.event.removeListener(E),_(google.maps.event.addListener(S,"zindex_changed",d)))},[d]),p.useEffect(()=>{var k=new google.maps.InfoWindow(r);return w(k),P.current=document.createElement("div"),i&&b(google.maps.event.addListener(k,"closeclick",i)),l&&I(google.maps.event.addListener(k,"domready",l)),c&&N(google.maps.event.addListener(k,"content_changed",c)),u&&y(google.maps.event.addListener(k,"position_changed",u)),d&&_(google.maps.event.addListener(k,"zindex_changed",d)),k.setContent(P.current),s&&k.setPosition(s),o&&k.setZIndex(o),n?k.open(C,n):k.getPosition()?k.open(C):Ca(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>."),m&&m(k),()=>{f&&google.maps.event.removeListener(f),A&&google.maps.event.removeListener(A),v&&google.maps.event.removeListener(v),x&&google.maps.event.removeListener(x),E&&google.maps.event.removeListener(E),h&&h(k),k.close()}},[]),P.current?pi.createPortal(p.Children.only(e),P.current):null}p.memo(OU);class jU extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[]),ue(this,"containerElement",null),ue(this,"state",{infoWindow:null}),ue(this,"open",(e,n)=>{n?e.open(this.context,n):e.getPosition()?e.open(this.context):Ca(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>.")}),ue(this,"setInfoWindowCallback",()=>{this.state.infoWindow!==null&&this.containerElement!==null&&(this.state.infoWindow.setContent(this.containerElement),this.open(this.state.infoWindow,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoWindow))})}componentDidMount(){var e=new google.maps.InfoWindow(this.props.options);this.containerElement=document.createElement("div"),this.registeredEvents=vt({updaterMap:Ww,eventMap:qw,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({infoWindow:e}),this.setInfoWindowCallback)}componentDidUpdate(e){this.state.infoWindow!==null&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:Ww,eventMap:qw,prevProps:e,nextProps:this.props,instance:this.state.infoWindow}))}componentWillUnmount(){this.state.infoWindow!==null&&(Et(this.registeredEvents),this.props.onUnmount&&this.props.onUnmount(this.state.infoWindow),this.state.infoWindow.close())}render(){return this.containerElement?pi.createPortal(p.Children.only(this.props.children),this.containerElement):null}}ue(jU,"contextType",dt);function Gw(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function Kp(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Gw(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):Gw(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}var Hw={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Kw={draggable(a,e){a.setDraggable(e)},editable(a,e){a.setEditable(e)},map(a,e){a.setMap(e)},options(a,e){a.setOptions(e)},path(a,e){a.setPath(e)},visible(a,e){a.setVisible(e)}},FU={};function zU(a){var{options:e,draggable:n,editable:r,visible:s,path:o,onDblClick:i,onDragEnd:l,onDragStart:c,onMouseDown:u,onMouseMove:d,onMouseOut:m,onMouseOver:h,onMouseUp:C,onRightClick:S,onClick:w,onDrag:f,onLoad:b,onUnmount:v}=a,I=p.useContext(dt),[A,N]=p.useState(null),[x,y]=p.useState(null),[E,_]=p.useState(null),[P,k]=p.useState(null),[D,M]=p.useState(null),[$,q]=p.useState(null),[V,z]=p.useState(null),[j,U]=p.useState(null),[Q,te]=p.useState(null),[se,X]=p.useState(null),[ye,Y]=p.useState(null),[Se,de]=p.useState(null);return p.useEffect(()=>{A!==null&&A.setMap(I)},[I]),p.useEffect(()=>{typeof e<"u"&&A!==null&&A.setOptions(e)},[A,e]),p.useEffect(()=>{typeof n<"u"&&A!==null&&A.setDraggable(n)},[A,n]),p.useEffect(()=>{typeof r<"u"&&A!==null&&A.setEditable(r)},[A,r]),p.useEffect(()=>{typeof s<"u"&&A!==null&&A.setVisible(s)},[A,s]),p.useEffect(()=>{typeof o<"u"&&A!==null&&A.setPath(o)},[A,o]),p.useEffect(()=>{A&&i&&(x!==null&&google.maps.event.removeListener(x),y(google.maps.event.addListener(A,"dblclick",i)))},[i]),p.useEffect(()=>{A&&l&&(E!==null&&google.maps.event.removeListener(E),_(google.maps.event.addListener(A,"dragend",l)))},[l]),p.useEffect(()=>{A&&c&&(P!==null&&google.maps.event.removeListener(P),k(google.maps.event.addListener(A,"dragstart",c)))},[c]),p.useEffect(()=>{A&&u&&(D!==null&&google.maps.event.removeListener(D),M(google.maps.event.addListener(A,"mousedown",u)))},[u]),p.useEffect(()=>{A&&d&&($!==null&&google.maps.event.removeListener($),q(google.maps.event.addListener(A,"mousemove",d)))},[d]),p.useEffect(()=>{A&&m&&(V!==null&&google.maps.event.removeListener(V),z(google.maps.event.addListener(A,"mouseout",m)))},[m]),p.useEffect(()=>{A&&h&&(j!==null&&google.maps.event.removeListener(j),U(google.maps.event.addListener(A,"mouseover",h)))},[h]),p.useEffect(()=>{A&&C&&(Q!==null&&google.maps.event.removeListener(Q),te(google.maps.event.addListener(A,"mouseup",C)))},[C]),p.useEffect(()=>{A&&S&&(se!==null&&google.maps.event.removeListener(se),X(google.maps.event.addListener(A,"rightclick",S)))},[S]),p.useEffect(()=>{A&&w&&(ye!==null&&google.maps.event.removeListener(ye),Y(google.maps.event.addListener(A,"click",w)))},[w]),p.useEffect(()=>{A&&f&&(Se!==null&&google.maps.event.removeListener(Se),de(google.maps.event.addListener(A,"drag",f)))},[f]),p.useEffect(()=>{var oe=new google.maps.Polyline(Kp(Kp({},e||FU),{},{map:I}));return o&&oe.setPath(o),typeof s<"u"&&oe.setVisible(s),typeof r<"u"&&oe.setEditable(r),typeof n<"u"&&oe.setDraggable(n),i&&y(google.maps.event.addListener(oe,"dblclick",i)),l&&_(google.maps.event.addListener(oe,"dragend",l)),c&&k(google.maps.event.addListener(oe,"dragstart",c)),u&&M(google.maps.event.addListener(oe,"mousedown",u)),d&&q(google.maps.event.addListener(oe,"mousemove",d)),m&&z(google.maps.event.addListener(oe,"mouseout",m)),h&&U(google.maps.event.addListener(oe,"mouseover",h)),C&&te(google.maps.event.addListener(oe,"mouseup",C)),S&&X(google.maps.event.addListener(oe,"rightclick",S)),w&&Y(google.maps.event.addListener(oe,"click",w)),f&&de(google.maps.event.addListener(oe,"drag",f)),N(oe),b&&b(oe),()=>{x!==null&&google.maps.event.removeListener(x),E!==null&&google.maps.event.removeListener(E),P!==null&&google.maps.event.removeListener(P),D!==null&&google.maps.event.removeListener(D),$!==null&&google.maps.event.removeListener($),V!==null&&google.maps.event.removeListener(V),j!==null&&google.maps.event.removeListener(j),Q!==null&&google.maps.event.removeListener(Q),se!==null&&google.maps.event.removeListener(se),ye!==null&&google.maps.event.removeListener(ye),v&&v(oe),oe.setMap(null)}},[]),null}p.memo(zU);class UU extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[]),ue(this,"state",{polyline:null}),ue(this,"setPolylineCallback",()=>{this.state.polyline!==null&&this.props.onLoad&&this.props.onLoad(this.state.polyline)})}componentDidMount(){var e=new google.maps.Polyline(Kp(Kp({},this.props.options),{},{map:this.context}));this.registeredEvents=vt({updaterMap:Kw,eventMap:Hw,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{polyline:e}},this.setPolylineCallback)}componentDidUpdate(e){this.state.polyline!==null&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:Kw,eventMap:Hw,prevProps:e,nextProps:this.props,instance:this.state.polyline}))}componentWillUnmount(){this.state.polyline!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.polyline),Et(this.registeredEvents),this.state.polyline.setMap(null))}render(){return null}}ue(UU,"contextType",dt);function Qw(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function Jw(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Qw(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):Qw(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}var Yw={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Zw={draggable(a,e){a.setDraggable(e)},editable(a,e){a.setEditable(e)},map(a,e){a.setMap(e)},options(a,e){a.setOptions(e)},path(a,e){a.setPath(e)},paths(a,e){a.setPaths(e)},visible(a,e){a.setVisible(e)}};function $U(a){var{options:e,draggable:n,editable:r,visible:s,path:o,paths:i,onDblClick:l,onDragEnd:c,onDragStart:u,onMouseDown:d,onMouseMove:m,onMouseOut:h,onMouseOver:C,onMouseUp:S,onRightClick:w,onClick:f,onDrag:b,onLoad:v,onUnmount:I,onEdit:A}=a,N=p.useContext(dt),[x,y]=p.useState(null),[E,_]=p.useState(null),[P,k]=p.useState(null),[D,M]=p.useState(null),[$,q]=p.useState(null),[V,z]=p.useState(null),[j,U]=p.useState(null),[Q,te]=p.useState(null),[se,X]=p.useState(null),[ye,Y]=p.useState(null),[Se,de]=p.useState(null),[oe,ge]=p.useState(null);return p.useEffect(()=>{x!==null&&x.setMap(N)},[N]),p.useEffect(()=>{typeof e<"u"&&x!==null&&x.setOptions(e)},[x,e]),p.useEffect(()=>{typeof n<"u"&&x!==null&&x.setDraggable(n)},[x,n]),p.useEffect(()=>{typeof r<"u"&&x!==null&&x.setEditable(r)},[x,r]),p.useEffect(()=>{typeof s<"u"&&x!==null&&x.setVisible(s)},[x,s]),p.useEffect(()=>{typeof o<"u"&&x!==null&&x.setPath(o)},[x,o]),p.useEffect(()=>{typeof i<"u"&&x!==null&&x.setPaths(i)},[x,i]),p.useEffect(()=>{x&&typeof l=="function"&&(E!==null&&google.maps.event.removeListener(E),_(google.maps.event.addListener(x,"dblclick",l)))},[l]),p.useEffect(()=>{x&&(google.maps.event.addListener(x.getPath(),"insert_at",()=>{A==null||A(x)}),google.maps.event.addListener(x.getPath(),"set_at",()=>{A==null||A(x)}),google.maps.event.addListener(x.getPath(),"remove_at",()=>{A==null||A(x)}))},[x,A]),p.useEffect(()=>{x&&typeof c=="function"&&(P!==null&&google.maps.event.removeListener(P),k(google.maps.event.addListener(x,"dragend",c)))},[c]),p.useEffect(()=>{x&&typeof u=="function"&&(D!==null&&google.maps.event.removeListener(D),M(google.maps.event.addListener(x,"dragstart",u)))},[u]),p.useEffect(()=>{x&&typeof d=="function"&&($!==null&&google.maps.event.removeListener($),q(google.maps.event.addListener(x,"mousedown",d)))},[d]),p.useEffect(()=>{x&&typeof m=="function"&&(V!==null&&google.maps.event.removeListener(V),z(google.maps.event.addListener(x,"mousemove",m)))},[m]),p.useEffect(()=>{x&&typeof h=="function"&&(j!==null&&google.maps.event.removeListener(j),U(google.maps.event.addListener(x,"mouseout",h)))},[h]),p.useEffect(()=>{x&&typeof C=="function"&&(Q!==null&&google.maps.event.removeListener(Q),te(google.maps.event.addListener(x,"mouseover",C)))},[C]),p.useEffect(()=>{x&&typeof S=="function"&&(se!==null&&google.maps.event.removeListener(se),X(google.maps.event.addListener(x,"mouseup",S)))},[S]),p.useEffect(()=>{x&&typeof w=="function"&&(ye!==null&&google.maps.event.removeListener(ye),Y(google.maps.event.addListener(x,"rightclick",w)))},[w]),p.useEffect(()=>{x&&typeof f=="function"&&(Se!==null&&google.maps.event.removeListener(Se),de(google.maps.event.addListener(x,"click",f)))},[f]),p.useEffect(()=>{x&&typeof b=="function"&&(oe!==null&&google.maps.event.removeListener(oe),ge(google.maps.event.addListener(x,"drag",b)))},[b]),p.useEffect(()=>{var me=new google.maps.Polygon(Jw(Jw({},e),{},{map:N}));return o&&me.setPath(o),i&&me.setPaths(i),typeof s<"u"&&me.setVisible(s),typeof r<"u"&&me.setEditable(r),typeof n<"u"&&me.setDraggable(n),l&&_(google.maps.event.addListener(me,"dblclick",l)),c&&k(google.maps.event.addListener(me,"dragend",c)),u&&M(google.maps.event.addListener(me,"dragstart",u)),d&&q(google.maps.event.addListener(me,"mousedown",d)),m&&z(google.maps.event.addListener(me,"mousemove",m)),h&&U(google.maps.event.addListener(me,"mouseout",h)),C&&te(google.maps.event.addListener(me,"mouseover",C)),S&&X(google.maps.event.addListener(me,"mouseup",S)),w&&Y(google.maps.event.addListener(me,"rightclick",w)),f&&de(google.maps.event.addListener(me,"click",f)),b&&ge(google.maps.event.addListener(me,"drag",b)),y(me),v&&v(me),()=>{E!==null&&google.maps.event.removeListener(E),P!==null&&google.maps.event.removeListener(P),D!==null&&google.maps.event.removeListener(D),$!==null&&google.maps.event.removeListener($),V!==null&&google.maps.event.removeListener(V),j!==null&&google.maps.event.removeListener(j),Q!==null&&google.maps.event.removeListener(Q),se!==null&&google.maps.event.removeListener(se),ye!==null&&google.maps.event.removeListener(ye),Se!==null&&google.maps.event.removeListener(Se),I&&I(me),me.setMap(null)}},[]),null}p.memo($U);class BU extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[])}componentDidMount(){var e=this.props.options||{};this.polygon=new google.maps.Polygon(e),this.polygon.setMap(this.context),this.registeredEvents=vt({updaterMap:Zw,eventMap:Yw,prevProps:{},nextProps:this.props,instance:this.polygon}),this.props.onLoad&&this.props.onLoad(this.polygon)}componentDidUpdate(e){this.polygon&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:Zw,eventMap:Yw,prevProps:e,nextProps:this.props,instance:this.polygon}))}componentWillUnmount(){this.polygon&&(this.props.onUnmount&&this.props.onUnmount(this.polygon),Et(this.registeredEvents),this.polygon&&this.polygon.setMap(null))}render(){return null}}ue(BU,"contextType",dt);function Xw(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function Qp(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Xw(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):Xw(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}var e_={onBoundsChanged:"bounds_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},t_={bounds(a,e){a.setBounds(e)},draggable(a,e){a.setDraggable(e)},editable(a,e){a.setEditable(e)},map(a,e){a.setMap(e)},options(a,e){a.setOptions(e)},visible(a,e){a.setVisible(e)}};function qU(a){var{options:e,bounds:n,draggable:r,editable:s,visible:o,onDblClick:i,onDragEnd:l,onDragStart:c,onMouseDown:u,onMouseMove:d,onMouseOut:m,onMouseOver:h,onMouseUp:C,onRightClick:S,onClick:w,onDrag:f,onBoundsChanged:b,onLoad:v,onUnmount:I}=a,A=p.useContext(dt),[N,x]=p.useState(null),[y,E]=p.useState(null),[_,P]=p.useState(null),[k,D]=p.useState(null),[M,$]=p.useState(null),[q,V]=p.useState(null),[z,j]=p.useState(null),[U,Q]=p.useState(null),[te,se]=p.useState(null),[X,ye]=p.useState(null),[Y,Se]=p.useState(null),[de,oe]=p.useState(null),[ge,me]=p.useState(null);return p.useEffect(()=>{N!==null&&N.setMap(A)},[A]),p.useEffect(()=>{typeof e<"u"&&N!==null&&N.setOptions(e)},[N,e]),p.useEffect(()=>{typeof r<"u"&&N!==null&&N.setDraggable(r)},[N,r]),p.useEffect(()=>{typeof s<"u"&&N!==null&&N.setEditable(s)},[N,s]),p.useEffect(()=>{typeof o<"u"&&N!==null&&N.setVisible(o)},[N,o]),p.useEffect(()=>{typeof n<"u"&&N!==null&&N.setBounds(n)},[N,n]),p.useEffect(()=>{N&&i&&(y!==null&&google.maps.event.removeListener(y),E(google.maps.event.addListener(N,"dblclick",i)))},[i]),p.useEffect(()=>{N&&l&&(_!==null&&google.maps.event.removeListener(_),P(google.maps.event.addListener(N,"dragend",l)))},[l]),p.useEffect(()=>{N&&c&&(k!==null&&google.maps.event.removeListener(k),D(google.maps.event.addListener(N,"dragstart",c)))},[c]),p.useEffect(()=>{N&&u&&(M!==null&&google.maps.event.removeListener(M),$(google.maps.event.addListener(N,"mousedown",u)))},[u]),p.useEffect(()=>{N&&d&&(q!==null&&google.maps.event.removeListener(q),V(google.maps.event.addListener(N,"mousemove",d)))},[d]),p.useEffect(()=>{N&&m&&(z!==null&&google.maps.event.removeListener(z),j(google.maps.event.addListener(N,"mouseout",m)))},[m]),p.useEffect(()=>{N&&h&&(U!==null&&google.maps.event.removeListener(U),Q(google.maps.event.addListener(N,"mouseover",h)))},[h]),p.useEffect(()=>{N&&C&&(te!==null&&google.maps.event.removeListener(te),se(google.maps.event.addListener(N,"mouseup",C)))},[C]),p.useEffect(()=>{N&&S&&(X!==null&&google.maps.event.removeListener(X),ye(google.maps.event.addListener(N,"rightclick",S)))},[S]),p.useEffect(()=>{N&&w&&(Y!==null&&google.maps.event.removeListener(Y),Se(google.maps.event.addListener(N,"click",w)))},[w]),p.useEffect(()=>{N&&f&&(de!==null&&google.maps.event.removeListener(de),oe(google.maps.event.addListener(N,"drag",f)))},[f]),p.useEffect(()=>{N&&b&&(ge!==null&&google.maps.event.removeListener(ge),me(google.maps.event.addListener(N,"bounds_changed",b)))},[b]),p.useEffect(()=>{var he=new google.maps.Rectangle(Qp(Qp({},e),{},{map:A}));return typeof o<"u"&&he.setVisible(o),typeof s<"u"&&he.setEditable(s),typeof r<"u"&&he.setDraggable(r),typeof n<"u"&&he.setBounds(n),i&&E(google.maps.event.addListener(he,"dblclick",i)),l&&P(google.maps.event.addListener(he,"dragend",l)),c&&D(google.maps.event.addListener(he,"dragstart",c)),u&&$(google.maps.event.addListener(he,"mousedown",u)),d&&V(google.maps.event.addListener(he,"mousemove",d)),m&&j(google.maps.event.addListener(he,"mouseout",m)),h&&Q(google.maps.event.addListener(he,"mouseover",h)),C&&se(google.maps.event.addListener(he,"mouseup",C)),S&&ye(google.maps.event.addListener(he,"rightclick",S)),w&&Se(google.maps.event.addListener(he,"click",w)),f&&oe(google.maps.event.addListener(he,"drag",f)),b&&me(google.maps.event.addListener(he,"bounds_changed",b)),x(he),v&&v(he),()=>{y!==null&&google.maps.event.removeListener(y),_!==null&&google.maps.event.removeListener(_),k!==null&&google.maps.event.removeListener(k),M!==null&&google.maps.event.removeListener(M),q!==null&&google.maps.event.removeListener(q),z!==null&&google.maps.event.removeListener(z),U!==null&&google.maps.event.removeListener(U),te!==null&&google.maps.event.removeListener(te),X!==null&&google.maps.event.removeListener(X),Y!==null&&google.maps.event.removeListener(Y),de!==null&&google.maps.event.removeListener(de),ge!==null&&google.maps.event.removeListener(ge),I&&I(he),he.setMap(null)}},[]),null}p.memo(qU);class WU extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[]),ue(this,"state",{rectangle:null}),ue(this,"setRectangleCallback",()=>{this.state.rectangle!==null&&this.props.onLoad&&this.props.onLoad(this.state.rectangle)})}componentDidMount(){var e=new google.maps.Rectangle(Qp(Qp({},this.props.options),{},{map:this.context}));this.registeredEvents=vt({updaterMap:t_,eventMap:e_,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{rectangle:e}},this.setRectangleCallback)}componentDidUpdate(e){this.state.rectangle!==null&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:t_,eventMap:e_,prevProps:e,nextProps:this.props,instance:this.state.rectangle}))}componentWillUnmount(){this.state.rectangle!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.rectangle),Et(this.registeredEvents),this.state.rectangle.setMap(null))}render(){return null}}ue(WU,"contextType",dt);function a_(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function Jp(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?a_(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):a_(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}var n_={onCenterChanged:"center_changed",onRadiusChanged:"radius_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},r_={center(a,e){a.setCenter(e)},draggable(a,e){a.setDraggable(e)},editable(a,e){a.setEditable(e)},map(a,e){a.setMap(e)},options(a,e){a.setOptions(e)},radius(a,e){a.setRadius(e)},visible(a,e){a.setVisible(e)}},GU={};function HU(a){var{options:e,center:n,radius:r,draggable:s,editable:o,visible:i,onDblClick:l,onDragEnd:c,onDragStart:u,onMouseDown:d,onMouseMove:m,onMouseOut:h,onMouseOver:C,onMouseUp:S,onRightClick:w,onClick:f,onDrag:b,onCenterChanged:v,onRadiusChanged:I,onLoad:A,onUnmount:N}=a,x=p.useContext(dt),[y,E]=p.useState(null),[_,P]=p.useState(null),[k,D]=p.useState(null),[M,$]=p.useState(null),[q,V]=p.useState(null),[z,j]=p.useState(null),[U,Q]=p.useState(null),[te,se]=p.useState(null),[X,ye]=p.useState(null),[Y,Se]=p.useState(null),[de,oe]=p.useState(null),[ge,me]=p.useState(null),[he,G]=p.useState(null),[we,Te]=p.useState(null);return p.useEffect(()=>{y!==null&&y.setMap(x)},[x]),p.useEffect(()=>{typeof e<"u"&&y!==null&&y.setOptions(e)},[y,e]),p.useEffect(()=>{typeof s<"u"&&y!==null&&y.setDraggable(s)},[y,s]),p.useEffect(()=>{typeof o<"u"&&y!==null&&y.setEditable(o)},[y,o]),p.useEffect(()=>{typeof i<"u"&&y!==null&&y.setVisible(i)},[y,i]),p.useEffect(()=>{typeof r=="number"&&y!==null&&y.setRadius(r)},[y,r]),p.useEffect(()=>{typeof n<"u"&&y!==null&&y.setCenter(n)},[y,n]),p.useEffect(()=>{y&&l&&(_!==null&&google.maps.event.removeListener(_),P(google.maps.event.addListener(y,"dblclick",l)))},[l]),p.useEffect(()=>{y&&c&&(k!==null&&google.maps.event.removeListener(k),D(google.maps.event.addListener(y,"dragend",c)))},[c]),p.useEffect(()=>{y&&u&&(M!==null&&google.maps.event.removeListener(M),$(google.maps.event.addListener(y,"dragstart",u)))},[u]),p.useEffect(()=>{y&&d&&(q!==null&&google.maps.event.removeListener(q),V(google.maps.event.addListener(y,"mousedown",d)))},[d]),p.useEffect(()=>{y&&m&&(z!==null&&google.maps.event.removeListener(z),j(google.maps.event.addListener(y,"mousemove",m)))},[m]),p.useEffect(()=>{y&&h&&(U!==null&&google.maps.event.removeListener(U),Q(google.maps.event.addListener(y,"mouseout",h)))},[h]),p.useEffect(()=>{y&&C&&(te!==null&&google.maps.event.removeListener(te),se(google.maps.event.addListener(y,"mouseover",C)))},[C]),p.useEffect(()=>{y&&S&&(X!==null&&google.maps.event.removeListener(X),ye(google.maps.event.addListener(y,"mouseup",S)))},[S]),p.useEffect(()=>{y&&w&&(Y!==null&&google.maps.event.removeListener(Y),Se(google.maps.event.addListener(y,"rightclick",w)))},[w]),p.useEffect(()=>{y&&f&&(de!==null&&google.maps.event.removeListener(de),oe(google.maps.event.addListener(y,"click",f)))},[f]),p.useEffect(()=>{y&&b&&(ge!==null&&google.maps.event.removeListener(ge),me(google.maps.event.addListener(y,"drag",b)))},[b]),p.useEffect(()=>{y&&v&&(he!==null&&google.maps.event.removeListener(he),G(google.maps.event.addListener(y,"center_changed",v)))},[f]),p.useEffect(()=>{y&&I&&(we!==null&&google.maps.event.removeListener(we),Te(google.maps.event.addListener(y,"radius_changed",I)))},[I]),p.useEffect(()=>{var B=new google.maps.Circle(Jp(Jp({},e||GU),{},{map:x}));return typeof r=="number"&&B.setRadius(r),typeof n<"u"&&B.setCenter(n),typeof r=="number"&&B.setRadius(r),typeof i<"u"&&B.setVisible(i),typeof o<"u"&&B.setEditable(o),typeof s<"u"&&B.setDraggable(s),l&&P(google.maps.event.addListener(B,"dblclick",l)),c&&D(google.maps.event.addListener(B,"dragend",c)),u&&$(google.maps.event.addListener(B,"dragstart",u)),d&&V(google.maps.event.addListener(B,"mousedown",d)),m&&j(google.maps.event.addListener(B,"mousemove",m)),h&&Q(google.maps.event.addListener(B,"mouseout",h)),C&&se(google.maps.event.addListener(B,"mouseover",C)),S&&ye(google.maps.event.addListener(B,"mouseup",S)),w&&Se(google.maps.event.addListener(B,"rightclick",w)),f&&oe(google.maps.event.addListener(B,"click",f)),b&&me(google.maps.event.addListener(B,"drag",b)),v&&G(google.maps.event.addListener(B,"center_changed",v)),I&&Te(google.maps.event.addListener(B,"radius_changed",I)),E(B),A&&A(B),()=>{_!==null&&google.maps.event.removeListener(_),k!==null&&google.maps.event.removeListener(k),M!==null&&google.maps.event.removeListener(M),q!==null&&google.maps.event.removeListener(q),z!==null&&google.maps.event.removeListener(z),U!==null&&google.maps.event.removeListener(U),te!==null&&google.maps.event.removeListener(te),X!==null&&google.maps.event.removeListener(X),Y!==null&&google.maps.event.removeListener(Y),de!==null&&google.maps.event.removeListener(de),he!==null&&google.maps.event.removeListener(he),we!==null&&google.maps.event.removeListener(we),N&&N(B),B.setMap(null)}},[]),null}p.memo(HU);class KU extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[]),ue(this,"state",{circle:null}),ue(this,"setCircleCallback",()=>{this.state.circle!==null&&this.props.onLoad&&this.props.onLoad(this.state.circle)})}componentDidMount(){var e=new google.maps.Circle(Jp(Jp({},this.props.options),{},{map:this.context}));this.registeredEvents=vt({updaterMap:r_,eventMap:n_,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{circle:e}},this.setCircleCallback)}componentDidUpdate(e){this.state.circle!==null&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:r_,eventMap:n_,prevProps:e,nextProps:this.props,instance:this.state.circle}))}componentWillUnmount(){if(this.state.circle!==null){var e;this.props.onUnmount&&this.props.onUnmount(this.state.circle),Et(this.registeredEvents),(e=this.state.circle)===null||e===void 0||e.setMap(null)}}render(){return null}}ue(KU,"contextType",dt);function s_(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function Yp(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?s_(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):s_(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}var o_={onClick:"click",onDblClick:"dblclick",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick",onAddFeature:"addfeature",onRemoveFeature:"removefeature",onRemoveProperty:"removeproperty",onSetGeometry:"setgeometry",onSetProperty:"setproperty"},i_={add(a,e){a.add(e)},addgeojson(a,e,n){a.addGeoJson(e,n)},contains(a,e){a.contains(e)},foreach(a,e){a.forEach(e)},loadgeojson(a,e,n,r){a.loadGeoJson(e,n,r)},overridestyle(a,e,n){a.overrideStyle(e,n)},remove(a,e){a.remove(e)},revertstyle(a,e){a.revertStyle(e)},controlposition(a,e){a.setControlPosition(e)},controls(a,e){a.setControls(e)},drawingmode(a,e){a.setDrawingMode(e)},map(a,e){a.setMap(e)},style(a,e){a.setStyle(e)},togeojson(a,e){a.toGeoJson(e)}};function QU(a){var{options:e,onClick:n,onDblClick:r,onMouseDown:s,onMouseMove:o,onMouseOut:i,onMouseOver:l,onMouseUp:c,onRightClick:u,onAddFeature:d,onRemoveFeature:m,onRemoveProperty:h,onSetGeometry:C,onSetProperty:S,onLoad:w,onUnmount:f}=a,b=p.useContext(dt),[v,I]=p.useState(null),[A,N]=p.useState(null),[x,y]=p.useState(null),[E,_]=p.useState(null),[P,k]=p.useState(null),[D,M]=p.useState(null),[$,q]=p.useState(null),[V,z]=p.useState(null),[j,U]=p.useState(null),[Q,te]=p.useState(null),[se,X]=p.useState(null),[ye,Y]=p.useState(null),[Se,de]=p.useState(null),[oe,ge]=p.useState(null);return p.useEffect(()=>{v!==null&&v.setMap(b)},[b]),p.useEffect(()=>{v&&r&&(A!==null&&google.maps.event.removeListener(A),N(google.maps.event.addListener(v,"dblclick",r)))},[r]),p.useEffect(()=>{v&&s&&(x!==null&&google.maps.event.removeListener(x),y(google.maps.event.addListener(v,"mousedown",s)))},[s]),p.useEffect(()=>{v&&o&&(E!==null&&google.maps.event.removeListener(E),_(google.maps.event.addListener(v,"mousemove",o)))},[o]),p.useEffect(()=>{v&&i&&(P!==null&&google.maps.event.removeListener(P),k(google.maps.event.addListener(v,"mouseout",i)))},[i]),p.useEffect(()=>{v&&l&&(D!==null&&google.maps.event.removeListener(D),M(google.maps.event.addListener(v,"mouseover",l)))},[l]),p.useEffect(()=>{v&&c&&($!==null&&google.maps.event.removeListener($),q(google.maps.event.addListener(v,"mouseup",c)))},[c]),p.useEffect(()=>{v&&u&&(V!==null&&google.maps.event.removeListener(V),z(google.maps.event.addListener(v,"rightclick",u)))},[u]),p.useEffect(()=>{v&&n&&(j!==null&&google.maps.event.removeListener(j),U(google.maps.event.addListener(v,"click",n)))},[n]),p.useEffect(()=>{v&&d&&(Q!==null&&google.maps.event.removeListener(Q),te(google.maps.event.addListener(v,"addfeature",d)))},[d]),p.useEffect(()=>{v&&m&&(se!==null&&google.maps.event.removeListener(se),X(google.maps.event.addListener(v,"removefeature",m)))},[m]),p.useEffect(()=>{v&&h&&(ye!==null&&google.maps.event.removeListener(ye),Y(google.maps.event.addListener(v,"removeproperty",h)))},[h]),p.useEffect(()=>{v&&C&&(Se!==null&&google.maps.event.removeListener(Se),de(google.maps.event.addListener(v,"setgeometry",C)))},[C]),p.useEffect(()=>{v&&S&&(oe!==null&&google.maps.event.removeListener(oe),ge(google.maps.event.addListener(v,"setproperty",S)))},[S]),p.useEffect(()=>{if(b!==null){var me=new google.maps.Data(Yp(Yp({},e),{},{map:b}));r&&N(google.maps.event.addListener(me,"dblclick",r)),s&&y(google.maps.event.addListener(me,"mousedown",s)),o&&_(google.maps.event.addListener(me,"mousemove",o)),i&&k(google.maps.event.addListener(me,"mouseout",i)),l&&M(google.maps.event.addListener(me,"mouseover",l)),c&&q(google.maps.event.addListener(me,"mouseup",c)),u&&z(google.maps.event.addListener(me,"rightclick",u)),n&&U(google.maps.event.addListener(me,"click",n)),d&&te(google.maps.event.addListener(me,"addfeature",d)),m&&X(google.maps.event.addListener(me,"removefeature",m)),h&&Y(google.maps.event.addListener(me,"removeproperty",h)),C&&de(google.maps.event.addListener(me,"setgeometry",C)),S&&ge(google.maps.event.addListener(me,"setproperty",S)),I(me),w&&w(me)}return()=>{v&&(A!==null&&google.maps.event.removeListener(A),x!==null&&google.maps.event.removeListener(x),E!==null&&google.maps.event.removeListener(E),P!==null&&google.maps.event.removeListener(P),D!==null&&google.maps.event.removeListener(D),$!==null&&google.maps.event.removeListener($),V!==null&&google.maps.event.removeListener(V),j!==null&&google.maps.event.removeListener(j),Q!==null&&google.maps.event.removeListener(Q),se!==null&&google.maps.event.removeListener(se),ye!==null&&google.maps.event.removeListener(ye),Se!==null&&google.maps.event.removeListener(Se),oe!==null&&google.maps.event.removeListener(oe),f&&f(v),v.setMap(null))}},[]),null}p.memo(QU);class JU extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[]),ue(this,"state",{data:null}),ue(this,"setDataCallback",()=>{this.state.data!==null&&this.props.onLoad&&this.props.onLoad(this.state.data)})}componentDidMount(){if(this.context!==null){var e=new google.maps.Data(Yp(Yp({},this.props.options),{},{map:this.context}));this.registeredEvents=vt({updaterMap:i_,eventMap:o_,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({data:e}),this.setDataCallback)}}componentDidUpdate(e){this.state.data!==null&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:i_,eventMap:o_,prevProps:e,nextProps:this.props,instance:this.state.data}))}componentWillUnmount(){this.state.data!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.data),Et(this.registeredEvents),this.state.data&&this.state.data.setMap(null))}render(){return null}}ue(JU,"contextType",dt);function l_(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function c_(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?l_(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):l_(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}var u_={onClick:"click",onDefaultViewportChanged:"defaultviewport_changed",onStatusChanged:"status_changed"},d_={options(a,e){a.setOptions(e)},url(a,e){a.setUrl(e)},zIndex(a,e){a.setZIndex(e)}};class YU extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[]),ue(this,"state",{kmlLayer:null}),ue(this,"setKmlLayerCallback",()=>{this.state.kmlLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.kmlLayer)})}componentDidMount(){var e=new google.maps.KmlLayer(c_(c_({},this.props.options),{},{map:this.context}));this.registeredEvents=vt({updaterMap:d_,eventMap:u_,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{kmlLayer:e}},this.setKmlLayerCallback)}componentDidUpdate(e){this.state.kmlLayer!==null&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:d_,eventMap:u_,prevProps:e,nextProps:this.props,instance:this.state.kmlLayer}))}componentWillUnmount(){this.state.kmlLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.kmlLayer),Et(this.registeredEvents),this.state.kmlLayer.setMap(null))}render(){return null}}ue(YU,"contextType",dt);function eT(a,e){return typeof e=="function"?e(a.offsetWidth,a.offsetHeight):{x:0,y:0}}function ZU(a,e){return new e(a.lat,a.lng)}function XU(a,e){return new e(new google.maps.LatLng(a.ne.lat,a.ne.lng),new google.maps.LatLng(a.sw.lat,a.sw.lng))}function e8(a,e,n){return a instanceof e?a:n(a,e)}function t8(a,e,n){return a instanceof e?a:n(a,e)}function a8(a,e,n){var r=a&&a.fromLatLngToDivPixel(n.getNorthEast()),s=a&&a.fromLatLngToDivPixel(n.getSouthWest());return r&&s?{left:"".concat(s.x+e.x,"px"),top:"".concat(r.y+e.y,"px"),width:"".concat(r.x-s.x-e.x,"px"),height:"".concat(s.y-r.y-e.y,"px")}:{left:"-9999px",top:"-9999px"}}function n8(a,e,n){var r=a&&a.fromLatLngToDivPixel(n);if(r){var{x:s,y:o}=r;return{left:"".concat(s+e.x,"px"),top:"".concat(o+e.y,"px")}}return{left:"-9999px",top:"-9999px"}}function tT(a,e,n,r){return n!==void 0?a8(a,e,t8(n,google.maps.LatLngBounds,XU)):n8(a,e,e8(r,google.maps.LatLng,ZU))}function r8(a,e){return a.left===e.left&&a.top===e.top&&a.width===e.height&&a.height===e.height}function m_(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function s8(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?m_(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):m_(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}function o8(a,e,n,r,s){class o extends google.maps.OverlayView{constructor(l,c,u,d){super(),this.container=l,this.pane=c,this.position=u,this.bounds=d}onAdd(){var l,c=(l=this.getPanes())===null||l===void 0?void 0:l[this.pane];c==null||c.appendChild(this.container)}draw(){var l=this.getProjection(),c=s8({},this.container?eT(this.container,s):{x:0,y:0}),u=tT(l,c,this.bounds,this.position);for(var[d,m]of Object.entries(u))this.container.style[d]=m}onRemove(){this.container.parentNode!==null&&this.container.parentNode.removeChild(this.container)}}return new o(a,e,n,r)}function p_(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function i8(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?p_(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):p_(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}function g_(a){if(!a)return"";var e=a instanceof google.maps.LatLng?a:new google.maps.LatLng(a.lat,a.lng);return e+""}function f_(a){if(!a)return"";var e=a instanceof google.maps.LatLngBounds?a:new google.maps.LatLngBounds(new google.maps.LatLng(a.south,a.east),new google.maps.LatLng(a.north,a.west));return e+""}function l8(a){var{position:e,bounds:n,mapPaneName:r,zIndex:s,onLoad:o,onUnmount:i,getPixelPositionOffset:l,children:c}=a,u=p.useContext(dt),d=p.useMemo(()=>{var h=document.createElement("div");return h.style.position="absolute",h},[]),m=p.useMemo(()=>o8(d,r,e,n,l),[d,r,e,n]);return p.useEffect(()=>(o==null||o(m),m==null||m.setMap(u),()=>{i==null||i(m),m==null||m.setMap(null)}),[u,m]),p.useEffect(()=>{d.style.zIndex="".concat(s)},[s,d]),pi.createPortal(c,d)}p.memo(l8);class nc extends p.PureComponent{constructor(e){super(e),ue(this,"state",{paneEl:null,containerStyle:{position:"absolute"}}),ue(this,"updatePane",()=>{var r=this.props.mapPaneName,s=this.overlayView.getPanes();Ca(!!r,"OverlayView requires props.mapPaneName but got %s",r),s?this.setState({paneEl:s[r]}):this.setState({paneEl:null})}),ue(this,"onAdd",()=>{var r,s;this.updatePane(),(r=(s=this.props).onLoad)===null||r===void 0||r.call(s,this.overlayView)}),ue(this,"onPositionElement",()=>{var r=this.overlayView.getProjection(),s=i8({x:0,y:0},this.containerRef.current?eT(this.containerRef.current,this.props.getPixelPositionOffset):{}),o=tT(r,s,this.props.bounds,this.props.position);if(!r8(o,{left:this.state.containerStyle.left,top:this.state.containerStyle.top,width:this.state.containerStyle.width,height:this.state.containerStyle.height})){var i,l,c,u;this.setState({containerStyle:{top:(i=o.top)!==null&&i!==void 0?i:0,left:(l=o.left)!==null&&l!==void 0?l:0,width:(c=o.width)!==null&&c!==void 0?c:0,height:(u=o.height)!==null&&u!==void 0?u:0,position:"absolute"}})}}),ue(this,"draw",()=>{this.onPositionElement()}),ue(this,"onRemove",()=>{var r,s;this.setState(()=>({paneEl:null})),(r=(s=this.props).onUnmount)===null||r===void 0||r.call(s,this.overlayView)}),this.containerRef=p.createRef();var n=new google.maps.OverlayView;n.onAdd=this.onAdd,n.draw=this.draw,n.onRemove=this.onRemove,this.overlayView=n}componentDidMount(){this.overlayView.setMap(this.context)}componentDidUpdate(e){var n=g_(e.position),r=g_(this.props.position),s=f_(e.bounds),o=f_(this.props.bounds);(n!==r||s!==o)&&this.overlayView.draw(),e.mapPaneName!==this.props.mapPaneName&&this.updatePane()}componentWillUnmount(){this.overlayView.setMap(null)}render(){var e=this.state.paneEl;return e?pi.createPortal(rn.jsx("div",{ref:this.containerRef,style:this.state.containerStyle,children:p.Children.only(this.props.children)}),e):null}}ue(nc,"FLOAT_PANE","floatPane");ue(nc,"MAP_PANE","mapPane");ue(nc,"MARKER_LAYER","markerLayer");ue(nc,"OVERLAY_LAYER","overlayLayer");ue(nc,"OVERLAY_MOUSE_TARGET","overlayMouseTarget");ue(nc,"contextType",dt);function c8(){}function h_(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function v_(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?h_(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):h_(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}var b_={onDblClick:"dblclick",onClick:"click"},E_={opacity(a,e){a.setOpacity(e)}};function u8(a){var{url:e,bounds:n,options:r,visible:s}=a,o=p.useContext(dt),i=new google.maps.LatLngBounds(new google.maps.LatLng(n.south,n.west),new google.maps.LatLng(n.north,n.east)),l=p.useMemo(()=>new google.maps.GroundOverlay(e,i,r),[]);return p.useEffect(()=>{l!==null&&l.setMap(o)},[o]),p.useEffect(()=>{typeof e<"u"&&l!==null&&(l.set("url",e),l.setMap(o))},[l,e]),p.useEffect(()=>{typeof s<"u"&&l!==null&&l.setOpacity(s?1:0)},[l,s]),p.useEffect(()=>{var c=new google.maps.LatLngBounds(new google.maps.LatLng(n.south,n.west),new google.maps.LatLng(n.north,n.east));typeof n<"u"&&l!==null&&(l.set("bounds",c),l.setMap(o))},[l,n]),null}p.memo(u8);class aT extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[]),ue(this,"state",{groundOverlay:null}),ue(this,"setGroundOverlayCallback",()=>{this.state.groundOverlay!==null&&this.props.onLoad&&this.props.onLoad(this.state.groundOverlay)})}componentDidMount(){Ca(!!this.props.url||!!this.props.bounds,"For GroundOverlay, url and bounds are passed in to constructor and are immutable after instantiated. This is the behavior of Google Maps JavaScript API v3 ( See https://developers.google.com/maps/documentation/javascript/reference#GroundOverlay) Hence, use the corresponding two props provided by `react-google-maps-api`, url and bounds. In some cases, you'll need the GroundOverlay component to reflect the changes of url and bounds. You can leverage the React's key property to remount the component. Typically, just `key={url}` would serve your need. See https://github.com/tomchentw/react-google-maps/issues/655");var e=new google.maps.GroundOverlay(this.props.url,this.props.bounds,v_(v_({},this.props.options),{},{map:this.context}));this.registeredEvents=vt({updaterMap:E_,eventMap:b_,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{groundOverlay:e}},this.setGroundOverlayCallback)}componentDidUpdate(e){this.state.groundOverlay!==null&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:E_,eventMap:b_,prevProps:e,nextProps:this.props,instance:this.state.groundOverlay}))}componentWillUnmount(){this.state.groundOverlay&&(this.props.onUnmount&&this.props.onUnmount(this.state.groundOverlay),this.state.groundOverlay.setMap(null))}render(){return null}}ue(aT,"defaultProps",{onLoad:c8});ue(aT,"contextType",dt);function x_(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function Zp(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?x_(Object(n),!0).forEach(function(r){ue(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):x_(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}var y_={},N_={data(a,e){a.setData(e)},map(a,e){a.setMap(e)},options(a,e){a.setOptions(e)}};function d8(a){var{data:e,onLoad:n,onUnmount:r,options:s}=a,o=p.useContext(dt),[i,l]=p.useState(null);return p.useEffect(()=>{google.maps.visualization||Ca(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} in useJsApiScript? %s',google.maps.visualization)},[]),p.useEffect(()=>{Ca(!!e,"data property is required in HeatmapLayer %s",e)},[e]),p.useEffect(()=>{i!==null&&i.setMap(o)},[o]),p.useEffect(()=>{s&&i!==null&&i.setOptions(s)},[i,s]),p.useEffect(()=>{var c=new google.maps.visualization.HeatmapLayer(Zp(Zp({},s),{},{data:e,map:o}));return l(c),n&&n(c),()=>{i!==null&&(r&&r(i),i.setMap(null))}},[]),null}p.memo(d8);class m8 extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[]),ue(this,"state",{heatmapLayer:null}),ue(this,"setHeatmapLayerCallback",()=>{this.state.heatmapLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.heatmapLayer)})}componentDidMount(){Ca(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} to <LoadScript />? %s',google.maps.visualization),Ca(!!this.props.data,"data property is required in HeatmapLayer %s",this.props.data);var e=new google.maps.visualization.HeatmapLayer(Zp(Zp({},this.props.options),{},{data:this.props.data,map:this.context}));this.registeredEvents=vt({updaterMap:N_,eventMap:y_,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{heatmapLayer:e}},this.setHeatmapLayerCallback)}componentDidUpdate(e){Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:N_,eventMap:y_,prevProps:e,nextProps:this.props,instance:this.state.heatmapLayer})}componentWillUnmount(){this.state.heatmapLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.heatmapLayer),Et(this.registeredEvents),this.state.heatmapLayer.setMap(null))}render(){return null}}ue(m8,"contextType",dt);var w_={onCloseClick:"closeclick",onPanoChanged:"pano_changed",onPositionChanged:"position_changed",onPovChanged:"pov_changed",onResize:"resize",onStatusChanged:"status_changed",onVisibleChanged:"visible_changed",onZoomChanged:"zoom_changed"},__={register(a,e,n){a.registerPanoProvider(e,n)},links(a,e){a.setLinks(e)},motionTracking(a,e){a.setMotionTracking(e)},options(a,e){a.setOptions(e)},pano(a,e){a.setPano(e)},position(a,e){a.setPosition(e)},pov(a,e){a.setPov(e)},visible(a,e){a.setVisible(e)},zoom(a,e){a.setZoom(e)}};class p8 extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[]),ue(this,"state",{streetViewPanorama:null}),ue(this,"setStreetViewPanoramaCallback",()=>{this.state.streetViewPanorama!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewPanorama)})}componentDidMount(){var e,n,r=(e=(n=this.context)===null||n===void 0?void 0:n.getStreetView())!==null&&e!==void 0?e:null;this.registeredEvents=vt({updaterMap:__,eventMap:w_,prevProps:{},nextProps:this.props,instance:r}),this.setState(()=>({streetViewPanorama:r}),this.setStreetViewPanoramaCallback)}componentDidUpdate(e){this.state.streetViewPanorama!==null&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:__,eventMap:w_,prevProps:e,nextProps:this.props,instance:this.state.streetViewPanorama}))}componentWillUnmount(){this.state.streetViewPanorama!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.streetViewPanorama),Et(this.registeredEvents),this.state.streetViewPanorama.setVisible(!1))}render(){return null}}ue(p8,"contextType",dt);class g8 extends p.PureComponent{constructor(){super(...arguments),ue(this,"state",{streetViewService:null}),ue(this,"setStreetViewServiceCallback",()=>{this.state.streetViewService!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewService)})}componentDidMount(){var e=new google.maps.StreetViewService;this.setState(function(){return{streetViewService:e}},this.setStreetViewServiceCallback)}componentWillUnmount(){this.state.streetViewService!==null&&this.props.onUnmount&&this.props.onUnmount(this.state.streetViewService)}render(){return null}}ue(g8,"contextType",dt);var C_={onDirectionsChanged:"directions_changed"},S_={directions(a,e){a.setDirections(e)},map(a,e){a.setMap(e)},options(a,e){a.setOptions(e)},panel(a,e){a.setPanel(e)},routeIndex(a,e){a.setRouteIndex(e)}};class f8 extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[]),ue(this,"state",{directionsRenderer:null}),ue(this,"setDirectionsRendererCallback",()=>{this.state.directionsRenderer!==null&&(this.state.directionsRenderer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.directionsRenderer))})}componentDidMount(){var e=new google.maps.DirectionsRenderer(this.props.options);this.registeredEvents=vt({updaterMap:S_,eventMap:C_,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{directionsRenderer:e}},this.setDirectionsRendererCallback)}componentDidUpdate(e){this.state.directionsRenderer!==null&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:S_,eventMap:C_,prevProps:e,nextProps:this.props,instance:this.state.directionsRenderer}))}componentWillUnmount(){this.state.directionsRenderer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.directionsRenderer),Et(this.registeredEvents),this.state.directionsRenderer&&this.state.directionsRenderer.setMap(null))}render(){return null}}ue(f8,"contextType",dt);var k_={onPlacesChanged:"places_changed"},I_={bounds(a,e){a.setBounds(e)}};class h8 extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[]),ue(this,"containerElement",p.createRef()),ue(this,"state",{searchBox:null}),ue(this,"setSearchBoxCallback",()=>{this.state.searchBox!==null&&this.props.onLoad&&this.props.onLoad(this.state.searchBox)})}componentDidMount(){if(Ca(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places),this.containerElement!==null&&this.containerElement.current!==null){var e=this.containerElement.current.querySelector("input");if(e!==null){var n=new google.maps.places.SearchBox(e,this.props.options);this.registeredEvents=vt({updaterMap:I_,eventMap:k_,prevProps:{},nextProps:this.props,instance:n}),this.setState(function(){return{searchBox:n}},this.setSearchBoxCallback)}}}componentDidUpdate(e){this.state.searchBox!==null&&(Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:I_,eventMap:k_,prevProps:e,nextProps:this.props,instance:this.state.searchBox}))}componentWillUnmount(){this.state.searchBox!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.searchBox),Et(this.registeredEvents))}render(){return rn.jsx("div",{ref:this.containerElement,children:p.Children.only(this.props.children)})}}ue(h8,"contextType",dt);var A_={onPlaceChanged:"place_changed"},T_={bounds(a,e){a.setBounds(e)},restrictions(a,e){a.setComponentRestrictions(e)},fields(a,e){a.setFields(e)},options(a,e){a.setOptions(e)},types(a,e){a.setTypes(e)}};class nT extends p.PureComponent{constructor(){super(...arguments),ue(this,"registeredEvents",[]),ue(this,"containerElement",p.createRef()),ue(this,"state",{autocomplete:null}),ue(this,"setAutocompleteCallback",()=>{this.state.autocomplete!==null&&this.props.onLoad&&this.props.onLoad(this.state.autocomplete)})}componentDidMount(){var e;Ca(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places);var n=(e=this.containerElement.current)===null||e===void 0?void 0:e.querySelector("input");if(n){var r=new google.maps.places.Autocomplete(n,this.props.options);this.registeredEvents=vt({updaterMap:T_,eventMap:A_,prevProps:{},nextProps:this.props,instance:r}),this.setState(()=>({autocomplete:r}),this.setAutocompleteCallback)}}componentDidUpdate(e){Et(this.registeredEvents),this.registeredEvents=vt({updaterMap:T_,eventMap:A_,prevProps:e,nextProps:this.props,instance:this.state.autocomplete})}componentWillUnmount(){this.state.autocomplete!==null&&Et(this.registeredEvents)}render(){return rn.jsx("div",{ref:this.containerElement,className:this.props.className,children:p.Children.only(this.props.children)})}}ue(nT,"defaultProps",{className:""});ue(nT,"contextType",dt);function P_({lat:a,lng:e,onLocationChange:n}){const{isLoaded:r}=HA({googleMapsApiKey:"TU_GOOGLE_MAPS_API_KEY"}),s={lat:a||-33.45694,lng:e||-70.64827},o=p.useCallback(i=>{n&&n({lat:i.latLng.lat(),lng:i.latLng.lng()})},[n]);return r?t.createElement(U7,{mapContainerStyle:{width:"100%",height:"200px"},center:s,zoom:16,onClick:o},a&&e&&t.createElement(KA,{position:{lat:a,lng:e}})):t.createElement("div",null,"Cargando mapa...")}function Xg({onClose:a,onSuccess:e}){const[n,r]=p.useState({nombre:"",direccion:"",telefono:"",email:"",sitio_web:"",horario_atencion:"",categorias:[],marcas:[],logo_url:"",descripcion:"",lat:"",lng:""}),[s,o]=p.useState({lunes:{activo:!0,inicio:"09:00",fin:"18:00"},martes:{activo:!0,inicio:"09:00",fin:"18:00"},miercoles:{activo:!0,inicio:"09:00",fin:"18:00"},jueves:{activo:!0,inicio:"09:00",fin:"18:00"},viernes:{activo:!0,inicio:"09:00",fin:"18:00"},sabado:{activo:!0,inicio:"09:00",fin:"14:00"},domingo:{activo:!1,inicio:"10:00",fin:"14:00"}}),[i,l]=p.useState([]),[c,u]=p.useState([]),[d,m]=p.useState(!1),[h,C]=p.useState(null),[S,w]=p.useState(""),[f,b]=p.useState(!1),[v,I]=p.useState(!1),[A,N]=p.useState("");p.useEffect(()=>{y(),E()},[]);const x=()=>Object.entries(s).filter(([z,j])=>j.activo).map(([z,j])=>`${z==="lunes"?"Lun":z==="martes"?"Mar":z==="miercoles"?"Mié":z==="jueves"?"Jue":z==="viernes"?"Vie":z==="sabado"?"Sáb":"Dom"} ${j.inicio}-${j.fin}`).join(", ");p.useEffect(()=>{r(V=>({...V,horario_atencion:x()}))},[s]);const y=async()=>{try{const z=(await le(W(F,"categorias"))).docs.map(j=>({id:j.id,...j.data()}));l(z)}catch(V){console.error("Error cargando categorías:",V)}},E=async()=>{try{const z=(await le(W(F,"marcas"))).docs.map(U=>({id:U.id,...U.data()}));u(z);const j=z.find(U=>U.nombre.toLowerCase().includes("multimarca")||U.nombre.toLowerCase().includes("multi-marca"));j&&r(U=>({...U,marcas:[j.nombre]}))}catch(V){console.error("Error cargando marcas:",V)}},_=V=>{const{name:z,value:j}=V.target;r(U=>({...U,[z]:j}))},P=V=>{r(z=>({...z,marcas:z.marcas.includes(V)?z.marcas.filter(j=>j!==V):[...z.marcas,V]}))},k=V=>{r(z=>({...z,categorias:z.categorias.includes(V)?z.categorias.filter(j=>j!==V):[...z.categorias,V]}))},D=(V,z,j)=>{o(U=>({...U,[V]:{...U[V],[z]:j}}))},M=async V=>{const z=V.target.files[0];if(z){C(z),b(!1),N("");const j=new FileReader;j.onload=U=>{w(U.target.result)},j.readAsDataURL(z);try{await $(z)}catch(U){console.error("Error en subida automática:",U)}}},$=async V=>{if(!V)return null;I(!0),N("");try{const z=Date.now(),j=`auto-${Math.random().toString(36).substr(2,9)}-${z}`,U=V.name.split(".").pop(),Q=`${j}.${U}`,te=Fl(ci,`logos/empresas/${Q}`);console.log("📁 Subiendo logo:",V.name),console.log("📍 Ruta en Storage:",te.fullPath);const se=await Uu(te,V);console.log("✅ Logo subido exitosamente:",se.metadata.fullPath);const X=await jl(se.ref);return console.log("🔗 URL de descarga obtenida:",X),b(!0),I(!1),{gsUrl:`gs://${te.bucket}/${te.fullPath}`,downloadURL:X}}catch(z){throw console.error("❌ Error subiendo logo:",z),N(`Error al subir logo: ${z.message}`),I(!1),z}},q=async V=>{V.preventDefault(),m(!0);try{if(!n.nombre||!n.direccion||n.categorias.length===0||!n.sitio_web){alert("Por favor complete todos los campos obligatorios (nombre, dirección, servicios, sitio web)"),m(!1);return}if(h&&!f){alert("Por favor espera a que el logo se suba completamente antes de guardar la empresa"),m(!1);return}let z=null;h?z=await $(h):n.logo_url&&(z={gsUrl:n.logo_url,downloadURL:n.logo_url});const j=n.categorias,U=n.marcas;console.log("🏷️ Categorías seleccionadas:",n.categorias),console.log("🚗 Marcas seleccionadas:",n.marcas);const Q={...n,estado:"ingresada",tipo_empresa:"publica",es_comunidad:!1,fecha_creacion:new Date,fecha_actualizacion:new Date,creado_por:"admin",web:n.sitio_web,categoria:j.join(", "),categorias:j,servicios:j,logo:z?z.gsUrl:"",logo_url:z?z.downloadURL:n.logo_url,horario_atencion:x(),horarios:s,marcas:U};console.log("📝 Datos de empresa a guardar:",Q),console.log("🕐 Horarios estructurados:",s),console.log("📝 Texto de horarios:",x()),console.log("🕐 Horario de atención guardado:",Q.horario_atencion);const te=await ot(W(F,"empresas"),Q);console.log("✅ Empresa creada exitosamente con ID:",te.id),alert("¡Empresa pública creada exitosamente!"),e==null||e(),a==null||a()}catch(z){console.error("❌ Error creando empresa:",z),alert(`Error creando empresa: ${z.message}`)}finally{m(!1)}};return t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto"},t.createElement("div",{className:"flex justify-between items-center mb-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-800"},"Crear Empresa Pública"),t.createElement("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold"},"×")),t.createElement("form",{onSubmit:q,className:"space-y-6"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.createElement("div",{className:"space-y-4"},t.createElement("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2"},"Información Básica"),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Nombre de la Empresa *"),t.createElement("input",{type:"text",name:"nombre",value:n.nombre,onChange:_,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Dirección *"),t.createElement("input",{type:"text",name:"direccion",value:n.direccion,onChange:_,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Teléfono"),t.createElement("input",{type:"tel",name:"telefono",value:n.telefono,onChange:_,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Email"),t.createElement("input",{type:"email",name:"email",value:n.email,onChange:_,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}))),t.createElement("div",{className:"space-y-4"},t.createElement("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2"},"Información de Negocio"),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Sitio Web *"),t.createElement("input",{type:"url",name:"sitio_web",value:n.sitio_web,onChange:_,placeholder:"https://ejemplo.com",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Logo de la Empresa"),t.createElement("div",{className:"mb-3"},t.createElement("input",{type:"file",accept:"image/*",onChange:M,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),t.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Formatos: JPG, PNG, GIF. Máximo 5MB")),S&&t.createElement("div",{className:"mb-3"},t.createElement("div",{className:"flex items-center gap-3"},t.createElement("img",{src:S,alt:"Preview del logo",className:"h-20 w-20 object-contain border border-gray-300 rounded"}),t.createElement("div",{className:"flex-1"},v&&t.createElement("div",{className:"flex items-center gap-2 text-blue-600"},t.createElement("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),t.createElement("span",{className:"text-sm font-medium"},"Subiendo logo...")),f&&t.createElement("div",{className:"flex items-center gap-2 text-green-600"},t.createElement("span",{className:"text-lg"},"✅"),t.createElement("span",{className:"text-sm font-medium"},"Logo subido exitosamente")),A&&t.createElement("div",{className:"flex items-center gap-2 text-red-600"},t.createElement("span",{className:"text-lg"},"❌"),t.createElement("span",{className:"text-sm font-medium"},A))))),t.createElement("div",{className:"mb-3"},t.createElement("label",{className:"block text-sm font-medium text-gray-600 mb-1"},"O URL del Logo (opcional)"),t.createElement("input",{type:"url",name:"logo_url",value:n.logo_url,onChange:_,placeholder:"https://ejemplo.com/logo.png",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),t.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Si no subes un archivo, puedes proporcionar una URL"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Horarios de Atención *"),t.createElement("div",{className:"space-y-3 p-4 border border-gray-200 rounded-lg bg-gray-50"},Object.entries(s).map(([V,z])=>t.createElement("div",{key:V,className:"flex items-center space-x-3"},t.createElement("label",{className:"flex items-center space-x-2 min-w-[80px]"},t.createElement("input",{type:"checkbox",checked:z.activo,onChange:j=>D(V,"activo",j.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),t.createElement("span",{className:"text-sm font-medium capitalize"},V==="lunes"?"Lunes":V==="martes"?"Martes":V==="miercoles"?"Miércoles":V==="jueves"?"Jueves":V==="viernes"?"Viernes":V==="sabado"?"Sábado":"Domingo")),z.activo&&t.createElement(t.Fragment,null,t.createElement("input",{type:"time",value:z.inicio,onChange:j=>D(V,"inicio",j.target.value),className:"border border-gray-300 rounded px-2 py-1 text-sm"}),t.createElement("span",{className:"text-gray-500"},"a"),t.createElement("input",{type:"time",value:z.fin,onChange:j=>D(V,"fin",j.target.value),className:"border border-gray-300 rounded px-2 py-1 text-sm"})),!z.activo&&t.createElement("span",{className:"text-gray-400 text-sm"},"Cerrado"))),t.createElement("div",{className:"mt-3 pt-3 border-t border-gray-200"},t.createElement("div",{className:"flex justify-between items-center"},t.createElement("p",{className:"text-sm text-gray-600"},t.createElement("strong",null,"Resumen:")," ",x()),t.createElement("button",{type:"button",onClick:()=>o({lunes:{activo:!0,inicio:"09:00",fin:"18:00"},martes:{activo:!0,inicio:"09:00",fin:"18:00"},miercoles:{activo:!0,inicio:"09:00",fin:"18:00"},jueves:{activo:!0,inicio:"09:00",fin:"18:00"},viernes:{activo:!0,inicio:"09:00",fin:"18:00"},sabado:{activo:!0,inicio:"09:00",fin:"14:00"},domingo:{activo:!1,inicio:"10:00",fin:"14:00"}}),className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded hover:bg-blue-200 transition-colors"},"🔄 Restaurar por defecto"))))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Servicios *"),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 p-4 border border-gray-300 rounded-md bg-gray-50"},i.map(V=>t.createElement("label",{key:V.id,className:"flex items-center space-x-2 cursor-pointer"},t.createElement("input",{type:"checkbox",checked:n.categorias.includes(V.nombre),onChange:()=>k(V.nombre),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),t.createElement("span",{className:"text-sm text-gray-700"},V.nombre)))),n.categorias.length===0&&t.createElement("p",{className:"text-sm text-red-600 mt-1"},"Debes seleccionar al menos un servicio"),n.categorias.length>0&&t.createElement("div",{className:"mt-2"},t.createElement("p",{className:"text-sm text-gray-600 mb-2"},"Servicios seleccionados:"),t.createElement("div",{className:"flex flex-wrap gap-2"},n.categorias.map(V=>t.createElement("span",{key:V,className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs"},V))))))),t.createElement("div",null,t.createElement("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2 mb-4"},"Marcas que Atiende *"),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3"},c.map(V=>t.createElement("label",{key:V.id,className:"flex items-center space-x-2 cursor-pointer"},t.createElement("input",{type:"checkbox",checked:n.marcas.includes(V.nombre),onChange:()=>P(V.nombre),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),t.createElement("span",{className:"text-sm text-gray-700"},V.nombre)))),n.marcas.length===0&&t.createElement("p",{className:"text-sm text-red-600 mt-1"},"Debes seleccionar al menos una marca"),n.marcas.length>0&&t.createElement("div",{className:"mt-2"},t.createElement("p",{className:"text-sm text-gray-600 mb-2"},"Marcas seleccionadas:"),t.createElement("div",{className:"flex flex-wrap gap-2"},n.marcas.map(V=>t.createElement("span",{key:V,className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs"},V))))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Descripción"),t.createElement("textarea",{name:"descripcion",value:n.descripcion,onChange:_,rows:"3",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Descripción breve de la empresa y sus servicios..."})),t.createElement("div",{className:"grid grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Latitud (Opcional)"),t.createElement("input",{type:"number",name:"lat",value:n.lat,onChange:_,step:"any",placeholder:"-33.4489",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Longitud (Opcional)"),t.createElement("input",{type:"number",name:"lng",value:n.lng,onChange:_,step:"any",placeholder:"-70.6693",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}))),t.createElement("div",{className:"flex justify-end space-x-4 pt-6 border-t"},t.createElement("button",{type:"button",onClick:a,className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500"},"Cancelar"),t.createElement("button",{type:"submit",disabled:d||h&&!f,className:"px-6 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 disabled:opacity-50 font-medium text-lg shadow-lg"},d?"⏳ Creando...":"💾 Guardar Empresa")),h&&!f&&t.createElement("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg"},t.createElement("div",{className:"flex items-center gap-2 text-yellow-800"},t.createElement("span",{className:"text-lg"},"⚠️"),t.createElement("span",{className:"text-sm"},t.createElement("strong",null,"Importante:")," Debes esperar a que el logo se suba completamente antes de guardar la empresa."))))))}function v8(){const[a,e]=p.useState([]),[n,r]=p.useState(null),[s,o]=p.useState({}),[i,l]=p.useState(!0),[c,u]=p.useState({busqueda:"",estado:"",categoria:""}),[d,m]=p.useState("grid"),[h,C]=p.useState(!1);p.useEffect(()=>{const x=fe(W(F,"empresas"),st("nombre"));return wa(x,E=>{e(E.docs.map(_=>({id:_.id,..._.data()}))),l(!1)})},[]);const S=x=>{r(x.id),o(x)},w=x=>{o({...s,[x.target.name]:x.target.value})},f=({lat:x,lng:y})=>{o({...s,lat:x,lng:y})},b=async()=>{try{const{id:x,...y}=s;await ze(Ne(F,"empresas",n),{...y,fecha_actualizacion:new Date}),r(null),alert("Empresa actualizada exitosamente")}catch(x){console.error("Error actualizando empresa:",x),alert("Error al actualizar la empresa")}},v=async x=>{if(window.confirm("¿Seguro que deseas eliminar esta empresa?"))try{await on(Ne(F,"empresas",x)),alert("Empresa eliminada exitosamente")}catch(y){console.error("Error eliminando empresa:",y),alert("Error al eliminar la empresa")}},I=async x=>{try{const y=x.estado===ce.ACTIVA?ce.INACTIVA:ce.ACTIVA;if(!TE(x.estado,y)){alert(`No se puede cambiar de "${x.estado}" a "${y}"`);return}await ze(Ne(F,"empresas",x.id),{estado:y,fecha_actualizacion:new Date}),alert(`Empresa ${y.toLowerCase()} exitosamente`)}catch(y){console.error("Error cambiando estado:",y),alert("Error al cambiar el estado")}},A=a.filter(x=>{var P,k;const y=!c.busqueda||x.nombre.toLowerCase().includes(c.busqueda.toLowerCase())||((P=x.direccion)==null?void 0:P.toLowerCase().includes(c.busqueda.toLowerCase()))||((k=x.categoria)==null?void 0:k.toLowerCase().includes(c.busqueda.toLowerCase())),E=!c.estado||x.estado===c.estado,_=!c.categoria||x.categoria===c.categoria;return y&&E&&_}),N=[...new Set(a.map(x=>x.categoria).filter(Boolean))];return i?t.createElement("div",{className:"flex items-center justify-center p-8"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),t.createElement("p",{className:"text-gray-600"},"Cargando empresas..."))):t.createElement("section",{className:"p-6"},t.createElement("div",{className:"mb-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Gestión de Empresas"),t.createElement("p",{className:"text-gray-600"},"Administra y supervisa todas las empresas registradas en el sistema")),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},t.createElement("div",{className:"text-2xl font-bold text-blue-800"},a.length),t.createElement("div",{className:"text-blue-600 text-sm"},"Total Empresas")),t.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},t.createElement("div",{className:"text-2xl font-bold text-green-800"},a.filter(x=>x.estado===ce.ACTIVA).length),t.createElement("div",{className:"text-green-600 text-sm"},"Empresas Activas")),t.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4"},t.createElement("div",{className:"text-2xl font-bold text-red-800"},a.filter(x=>x.estado===ce.INACTIVA).length),t.createElement("div",{className:"text-red-600 text-sm"},"Empresas Inactivas")),t.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4"},t.createElement("div",{className:"text-2xl font-bold text-purple-800"},N.length),t.createElement("div",{className:"text-purple-600 text-sm"},"Categorías"))),t.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},t.createElement("div",{className:"flex flex-wrap items-center justify-between gap-4"},t.createElement("div",{className:"flex flex-wrap gap-4 flex-1"},t.createElement("div",{className:"flex-1 min-w-64"},t.createElement("input",{type:"text",placeholder:"Buscar por nombre, dirección o categoría...",value:c.busqueda,onChange:x=>u({...c,busqueda:x.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("select",{value:c.estado,onChange:x=>u({...c,estado:x.target.value}),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:""},"Todos los estados"),t.createElement("option",{value:ce.CATALOGADA},"Catalogada"),t.createElement("option",{value:ce.PENDIENTE_VALIDACION},"Pendiente de Validación"),t.createElement("option",{value:ce.EN_VISITA},"En Visita"),t.createElement("option",{value:ce.VALIDADA},"Validada"),t.createElement("option",{value:ce.ACTIVA},"Activa"),t.createElement("option",{value:ce.SUSPENDIDA},"Suspendida"),t.createElement("option",{value:ce.INACTIVA},"Inactiva"),t.createElement("option",{value:ce.RECHAZADA},"Rechazada")),t.createElement("select",{value:c.categoria,onChange:x=>u({...c,categoria:x.target.value}),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:""},"Todas las categorías"),N.map(x=>t.createElement("option",{key:x,value:x},x)))),t.createElement("div",{className:"flex items-center gap-2"},t.createElement("button",{onClick:()=>m("grid"),className:`p-2 rounded-lg ${d==="grid"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`},"📱 Grid"),t.createElement("button",{onClick:()=>m("table"),className:`p-2 rounded-lg ${d==="table"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`},"📋 Tabla")))),t.createElement("div",{className:"mb-6"},t.createElement("button",{onClick:()=>C(!0),className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors"},"➕ Crear Empresa Pública")),t.createElement("div",{className:"mb-4"},t.createElement("p",{className:"text-gray-600"},"Mostrando ",A.length," de ",a.length," empresas")),d==="grid"&&t.createElement("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6"},A.map(x=>t.createElement("div",{key:x.id,className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},n===x.id?t.createElement("div",{className:"p-6"},t.createElement("h3",{className:"font-semibold text-lg mb-4"},"Editando: ",x.nombre),t.createElement("div",{className:"space-y-3"},t.createElement("input",{className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",name:"nombre",placeholder:"Nombre de la empresa",value:s.nombre||"",onChange:w}),t.createElement("input",{className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",name:"direccion",placeholder:"Dirección",value:s.direccion||"",onChange:w}),t.createElement("input",{className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",name:"categoria",placeholder:"Categoría",value:s.categoria||"",onChange:w}),t.createElement("input",{className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",name:"telefono",placeholder:"Teléfono",value:s.telefono||"",onChange:w}),t.createElement("input",{className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",name:"email",placeholder:"Email",value:s.email||"",onChange:w}),t.createElement("input",{className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",name:"web",placeholder:"Sitio web",value:s.web||"",onChange:w}),t.createElement("select",{className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",name:"estado",value:s.estado||"",onChange:w},t.createElement("option",{value:""},"Seleccionar estado"),t.createElement("option",{value:"Activa"},"Activa"),t.createElement("option",{value:"Inactiva"},"Inactiva"))),s.lat&&s.lng&&t.createElement("div",{className:"mt-4"},t.createElement(P_,{lat:s.lat,lng:s.lng,onLocationChange:f})),t.createElement("div",{className:"mt-6 flex gap-3"},t.createElement("button",{className:"flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors",onClick:b},"💾 Guardar"),t.createElement("button",{className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors",onClick:()=>r(null)},"❌ Cancelar"))):t.createElement(t.Fragment,null,t.createElement("div",{className:"p-6"},t.createElement("div",{className:"flex items-start justify-between mb-3"},t.createElement("h3",{className:"font-bold text-lg text-gray-900"},x.nombre),t.createElement("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${x.estado===ce.ACTIVA?"bg-green-100 text-green-800":x.estado===ce.VALIDADA?"bg-blue-100 text-blue-800":x.estado===ce.PENDIENTE_VALIDACION?"bg-yellow-100 text-yellow-800":x.estado===ce.CATALOGADA?"bg-gray-100 text-gray-800":x.estado===ce.EN_VISITA?"bg-orange-100 text-orange-800":x.estado===ce.SUSPENDIDA?"bg-red-100 text-red-800":x.estado===ce.INACTIVA?"bg-gray-100 text-gray-800":x.estado===ce.RECHAZADA?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`},x.estado||"Sin estado")),t.createElement("div",{className:"space-y-2 text-sm text-gray-600"},t.createElement("p",{className:"flex items-center gap-2"},t.createElement("span",null,"📍")," ",x.direccion||"Sin dirección"),t.createElement("p",{className:"flex items-center gap-2"},t.createElement("span",null,"🏷️")," ",x.categoria||"Sin categoría"),t.createElement("p",{className:"flex items-center gap-2"},t.createElement("span",null,"📞")," ",x.telefono||"Sin teléfono"),x.email&&t.createElement("p",{className:"flex items-center gap-2"},t.createElement("span",null,"📧")," ",x.email),x.web&&t.createElement("p",{className:"flex items-center gap-2"},t.createElement("span",null,"🌐"),t.createElement("a",{href:x.web,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},x.web))),x.lat&&x.lng&&t.createElement("div",{className:"mt-4"},t.createElement(P_,{lat:x.lat,lng:x.lng}))),t.createElement("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex gap-2"},t.createElement("button",{className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-sm transition-colors",onClick:()=>S(x)},"✏️ Editar"),t.createElement("button",{className:`flex-1 px-3 py-2 rounded-lg text-sm transition-colors ${x.estado===ce.ACTIVA?"bg-red-100 hover:bg-red-200 text-red-700":"bg-green-100 hover:bg-green-200 text-green-700"}`,onClick:()=>I(x)},x.estado===ce.ACTIVA?"⏸️ Desactivar":"▶️ Activar"),t.createElement("button",{className:"bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-lg text-sm transition-colors",onClick:()=>v(x.id)},"🗑️")))))),d==="table"&&t.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},t.createElement("div",{className:"overflow-x-auto"},t.createElement("table",{className:"w-full"},t.createElement("thead",{className:"bg-gray-50"},t.createElement("tr",null,t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Empresa"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Categoría"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Contacto"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),t.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},A.map(x=>t.createElement("tr",{key:x.id,className:"hover:bg-gray-50"},t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("div",null,t.createElement("div",{className:"text-sm font-medium text-gray-900"},x.nombre),t.createElement("div",{className:"text-sm text-gray-500"},x.direccion))),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},x.categoria||"Sin categoría"),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("div",{className:"text-sm text-gray-900"},x.telefono),t.createElement("div",{className:"text-sm text-gray-500"},x.email)),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${x.estado==="activa"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},x.estado||"Sin estado")),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2"},t.createElement("button",{className:"text-blue-600 hover:text-blue-900",onClick:()=>S(x)},"Editar"),t.createElement("button",{className:x.estado==="activa"?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900",onClick:()=>I(x)},x.estado==="activa"?"Desactivar":"Activar"),t.createElement("button",{className:"text-red-600 hover:text-red-900",onClick:()=>v(x.id)},"Eliminar")))))))),A.length===0&&t.createElement("div",{className:"text-center py-12"},t.createElement("div",{className:"text-gray-400"},t.createElement("div",{className:"text-4xl mb-4"},"🏪"),t.createElement("div",{className:"text-lg font-medium mb-2"},"No se encontraron empresas"),t.createElement("div",{className:"text-sm"},c.busqueda||c.estado||c.categoria?"No hay empresas que coincidan con los filtros aplicados":"Aún no hay empresas registradas en el sistema"),(c.busqueda||c.estado||c.categoria)&&t.createElement("button",{onClick:()=>u({busqueda:"",estado:"",categoria:""}),className:"mt-3 text-blue-600 hover:text-blue-800 text-sm"},"Limpiar filtros"))),h&&t.createElement(Xg,{onClose:()=>C(!1),onSuccess:()=>{C(!1)}}))}function b8(){const a=Ct(),[e,n]=p.useState([]),[r,s]=p.useState([]),[o,i]=p.useState(!0),[l,c]=p.useState(""),[u,d]=p.useState([]),[m,h]=p.useState(!1);p.useEffect(()=>{C()},[]);const C=async()=>{try{i(!0);const v=W(F,"empresas"),I=fe(v,st("fechaCreacion","desc"),Ot(5)),A=await le(I);n(A.docs.map(E=>({id:E.id,...E.data()})));const N=W(F,"clientes"),x=fe(N,st("fechaRegistro","desc"),Ot(5)),y=await le(x);s(y.docs.map(E=>({id:E.id,...E.data()})))}catch(v){console.error("Error loading recent data:",v)}finally{i(!1)}},S=async()=>{if(!l.trim()){d([]);return}try{h(!0);const v=[],I=W(F,"empresas"),A=fe(I,pe("nombre",">=",l),pe("nombre","<=",l+""),Ot(10));(await le(A)).docs.forEach(_=>{v.push({id:_.id,..._.data(),tipo:"empresa",displayName:_.data().nombre||"Sin nombre"})});const x=W(F,"clientes"),y=fe(x,pe("nombre",">=",l),pe("nombre","<=",l+""),Ot(10));(await le(y)).docs.forEach(_=>{v.push({id:_.id,..._.data(),tipo:"cliente",displayName:_.data().nombre||"Sin nombre"})}),d(v)}catch(v){console.error("Error searching:",v)}finally{h(!1)}},w=v=>{v.tipo==="empresa"?a(`/admin/editar-empresa/${v.id}`):v.tipo==="cliente"&&a(`/admin/editar-cliente/${v.id}`)},f=v=>{switch(v){case"activa":case"activo":return"bg-green-100 text-green-800";case"pendiente":case"en_revision":return"bg-yellow-100 text-yellow-800";case"inactiva":case"inactivo":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},b=v=>{switch(v){case"activa":case"activo":return"Activo";case"pendiente":case"en_revision":return"Pendiente";case"inactiva":case"inactivo":return"Inactivo";default:return v||"Desconocido"}};return o?t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement("div",{className:"animate-pulse"},t.createElement("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),t.createElement("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-2"}),t.createElement("div",{className:"h-4 bg-gray-200 rounded w-2/3"}))):t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement("h2",{className:"text-xl font-bold text-gray-900 mb-4"},"🔍 Acceso Rápido a Perfiles"),t.createElement("div",{className:"flex gap-3 mb-4"},t.createElement("input",{type:"text",placeholder:"Buscar por nombre de empresa o cliente...",value:l,onChange:v=>c(v.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",onKeyPress:v=>v.key==="Enter"&&S()}),t.createElement("button",{onClick:S,disabled:m,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"},m?"Buscando...":"Buscar")),u.length>0&&t.createElement("div",{className:"border rounded-lg overflow-hidden"},t.createElement("div",{className:"bg-gray-50 px-4 py-2 border-b"},t.createElement("h3",{className:"font-medium text-gray-900"},"Resultados de búsqueda")),t.createElement("div",{className:"divide-y divide-gray-200"},u.map(v=>t.createElement("div",{key:`${v.tipo}-${v.id}`,className:"flex items-center justify-between p-4 hover:bg-gray-50"},t.createElement("div",{className:"flex items-center gap-3"},t.createElement("span",{className:"text-2xl"},v.tipo==="empresa"?"🏢":"👤"),t.createElement("div",null,t.createElement("p",{className:"font-medium text-gray-900"},v.displayName),t.createElement("p",{className:"text-sm text-gray-600"},v.tipo==="empresa"?"Empresa":"Cliente"," • ",v.email||"Sin email"))),t.createElement("div",{className:"flex items-center gap-3"},t.createElement("span",{className:`px-2 py-1 text-xs rounded-full ${f(v.estado)}`},b(v.estado)),t.createElement("button",{onClick:()=>w(v),className:"px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700"},"Acceder"))))))),t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement("div",{className:"flex items-center justify-between mb-4"},t.createElement("h2",{className:"text-xl font-bold text-gray-900"},"🏢 Empresas Recientes"),t.createElement("button",{onClick:()=>a("/admin/empresas"),className:"text-blue-600 hover:text-blue-700 text-sm font-medium"},"Ver todas →")),t.createElement("div",{className:"space-y-3"},e.map(v=>t.createElement("div",{key:v.id,className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50"},t.createElement("div",{className:"flex items-center gap-3"},t.createElement("span",{className:"text-2xl"},"🏢"),t.createElement("div",null,t.createElement("p",{className:"font-medium text-gray-900"},v.nombre||"Sin nombre"),t.createElement("p",{className:"text-sm text-gray-600"},v.email||"Sin email"))),t.createElement("div",{className:"flex items-center gap-3"},t.createElement("span",{className:`px-2 py-1 text-xs rounded-full ${f(v.estado)}`},b(v.estado)),t.createElement("button",{onClick:()=>a(`/admin/editar-empresa/${v.id}`),className:"px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700"},"Validar")))))),t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement("div",{className:"flex items-center justify-between mb-4"},t.createElement("h2",{className:"text-xl font-bold text-gray-900"},"👤 Clientes Recientes"),t.createElement("button",{onClick:()=>a("/admin/clientes"),className:"text-blue-600 hover:text-blue-700 text-sm font-medium"},"Ver todos →")),t.createElement("div",{className:"space-y-3"},r.map(v=>t.createElement("div",{key:v.id,className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50"},t.createElement("div",{className:"flex items-center gap-3"},t.createElement("span",{className:"text-2xl"},"👤"),t.createElement("div",null,t.createElement("p",{className:"font-medium text-gray-900"},v.nombre||"Sin nombre"),t.createElement("p",{className:"text-sm text-gray-600"},v.email||"Sin email"))),t.createElement("div",{className:"flex items-center gap-3"},t.createElement("span",{className:`px-2 py-1 text-xs rounded-full ${f(v.estado)}`},b(v.estado)),t.createElement("button",{onClick:()=>a(`/admin/editar-cliente/${v.id}`),className:"px-4 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700"},"Revisar")))))),t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement("h2",{className:"text-xl font-bold text-gray-900 mb-4"},"⚡ Acciones Rápidas"),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4"},t.createElement("button",{onClick:()=>a("/admin/crear-empresa"),className:"p-4 bg-blue-50 hover:bg-blue-100 rounded-lg text-center transition-colors"},t.createElement("div",{className:"text-2xl mb-2"},"➕"),t.createElement("div",{className:"font-medium text-gray-900"},"Nueva Empresa"),t.createElement("div",{className:"text-sm text-gray-600"},"Crear perfil")),t.createElement("button",{onClick:()=>a("/admin/crear-cliente"),className:"p-4 bg-green-50 hover:bg-green-100 rounded-lg text-center transition-colors"},t.createElement("div",{className:"text-2xl mb-2"},"👤"),t.createElement("div",{className:"font-medium text-gray-900"},"Nuevo Cliente"),t.createElement("div",{className:"text-sm text-gray-600"},"Registrar")),t.createElement("button",{onClick:()=>a("/admin/validaciones"),className:"p-4 bg-yellow-50 hover:bg-yellow-100 rounded-lg text-center transition-colors"},t.createElement("div",{className:"text-2xl mb-2"},"✅"),t.createElement("div",{className:"font-medium text-gray-900"},"Validaciones"),t.createElement("div",{className:"text-sm text-gray-600"},"Pendientes")),t.createElement("button",{onClick:()=>a("/admin/estadisticas"),className:"p-4 bg-purple-50 hover:bg-purple-100 rounded-lg text-center transition-colors"},t.createElement("div",{className:"text-2xl mb-2"},"📊"),t.createElement("div",{className:"font-medium text-gray-900"},"Estadísticas"),t.createElement("div",{className:"text-sm text-gray-600"},"Dashboard")))))}function E8(){const[a,e]=p.useState([]),[n,r]=p.useState(!0),[s,o]=p.useState("todos");p.useEffect(()=>{console.log("🔍 AdminSolicitudesProducto montado, cargando solicitudes..."),i()},[s]);const i=async()=>{try{console.log("🔄 Cargando solicitudes de productos con filtro:",s),r(!0);let m;s==="todos"?(m=W(F,"solicitudes_producto"),console.log("🔍 Consultando todas las solicitudes de productos")):(m=fe(W(F,"solicitudes_producto"),pe("estado","==",s)),console.log("🔍 Consultando solicitudes de productos con estado:",s));const h=await le(m);console.log("📦 Solicitudes de productos encontradas:",h.size);const C=h.docs.map(S=>({id:S.id,...S.data()}));console.log("📦 Datos de solicitudes:",C),C.sort((S,w)=>S.fechaSolicitud&&w.fechaSolicitud?new Date(w.fechaSolicitud.toDate())-new Date(S.fechaSolicitud.toDate()):0),e(C)}catch(m){console.error("Error cargando solicitudes de productos:",m)}finally{r(!1)}},l=async(m,h)=>{try{const C=Ne(F,"solicitudes_producto",m);await ze(C,{estado:h,fecha_revision:new Date,revisado_por:"admin"}),i(),alert(`Solicitud ${h==="aprobado"?"aprobada":"rechazada"} exitosamente`)}catch(C){console.error("Error cambiando estado:",C),alert("Error al cambiar el estado de la solicitud")}},c=async m=>{if(window.confirm("¿Estás seguro de que quieres eliminar esta solicitud?"))try{await on(Ne(F,"solicitudes_producto",m)),i(),alert("Solicitud eliminada exitosamente")}catch(h){console.error("Error eliminando solicitud:",h),alert("Error al eliminar la solicitud")}},u=m=>{switch(m){case"pendiente":return"bg-yellow-100 text-yellow-800";case"en_revision":return"bg-blue-100 text-blue-800";case"aprobado":return"bg-green-100 text-green-800";case"rechazado":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},d=m=>{switch(m){case"pendiente":return"Pendiente";case"en_revision":return"En Revisión";case"aprobado":return"Aprobado";case"rechazado":return"Rechazado";default:return m||"Sin estado"}};return n?t.createElement("div",{className:"flex items-center justify-center py-8"},t.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),t.createElement("span",{className:"ml-3 text-gray-600"},"Cargando solicitudes...")):t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-white rounded-lg shadow p-4"},t.createElement("div",{className:"flex items-center space-x-4"},t.createElement("label",{className:"text-sm font-medium text-gray-700"},"Filtrar por estado:"),t.createElement("select",{value:s,onChange:m=>o(m.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"todos"},"Todos los estados"),t.createElement("option",{value:"pendiente"},"Pendientes"),t.createElement("option",{value:"en_revision"},"En Revisión"),t.createElement("option",{value:"aprobado"},"Aprobados"),t.createElement("option",{value:"rechazado"},"Rechazados")),t.createElement("button",{onClick:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"},"🔄 Actualizar"))),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4"},t.createElement("div",{className:"bg-white rounded-lg shadow p-4"},t.createElement("div",{className:"text-2xl font-bold text-yellow-600"},a.filter(m=>m.estado==="pendiente").length),t.createElement("div",{className:"text-sm text-gray-600"},"Pendientes")),t.createElement("div",{className:"bg-white rounded-lg shadow p-4"},t.createElement("div",{className:"text-2xl font-bold text-blue-600"},a.filter(m=>m.estado==="en_revision").length),t.createElement("div",{className:"text-sm text-gray-600"},"En Revisión")),t.createElement("div",{className:"bg-white rounded-lg shadow p-4"},t.createElement("div",{className:"text-2xl font-bold text-green-600"},a.filter(m=>m.estado==="aprobado").length),t.createElement("div",{className:"text-sm text-gray-600"},"Aprobados")),t.createElement("div",{className:"bg-white rounded-lg shadow p-4"},t.createElement("div",{className:"text-2xl font-bold text-red-600"},a.filter(m=>m.estado==="rechazado").length),t.createElement("div",{className:"text-sm text-gray-600"},"Rechazados"))),t.createElement("div",{className:"bg-white rounded-lg shadow"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Solicitudes de Productos (",a.length,")")),a.length===0?t.createElement("div",{className:"p-6 text-center text-gray-500"},t.createElement("p",null,"No hay solicitudes de productos para mostrar.")):t.createElement("div",{className:"overflow-x-auto"},t.createElement("table",{className:"min-w-full divide-y divide-gray-200"},t.createElement("thead",{className:"bg-gray-50"},t.createElement("tr",null,t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Producto"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Proveedor"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Fecha"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),t.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},a.map(m=>t.createElement("tr",{key:m.id,className:"hover:bg-gray-50"},t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("div",null,t.createElement("div",{className:"text-sm font-medium text-gray-900"},m.nombre||m.nombre_producto||"Sin nombre"),t.createElement("div",{className:"text-sm text-gray-500"},m.categoria||"Sin categoría"),m.marca&&t.createElement("div",{className:"text-sm text-gray-500"},"Marca: ",m.marca),m.precio&&t.createElement("div",{className:"text-sm text-gray-500"},"$",m.precio.toLocaleString()),m.stock&&t.createElement("div",{className:"text-sm text-gray-500"},"Stock: ",m.stock))),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("div",{className:"text-sm text-gray-900"},m.nombre_empresa||m.nombre_proveedor||"Sin nombre"),t.createElement("div",{className:"text-sm text-gray-500"},m.email_proveedor||m.email_empresa||"Sin email")),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${u(m.estado)}`},d(m.estado))),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},m.fechaSolicitud?new Date(m.fechaSolicitud.toDate()).toLocaleDateString("es-ES"):"Sin fecha"),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},t.createElement("div",{className:"flex space-x-2"},m.estado==="pendiente"&&t.createElement(t.Fragment,null,t.createElement("button",{onClick:()=>l(m.id,"aprobado"),className:"text-green-600 hover:text-green-900 bg-green-100 hover:bg-green-200 px-2 py-1 rounded text-xs"},"✅ Aprobar"),t.createElement("button",{onClick:()=>l(m.id,"rechazado"),className:"text-red-600 hover:text-red-900 bg-red-100 hover:bg-red-200 px-2 py-1 rounded text-xs"},"❌ Rechazar")),m.estado==="en_revision"&&t.createElement(t.Fragment,null,t.createElement("button",{onClick:()=>l(m.id,"aprobado"),className:"text-green-600 hover:text-green-900 bg-green-100 hover:bg-green-200 px-2 py-1 rounded text-xs"},"✅ Aprobar"),t.createElement("button",{onClick:()=>l(m.id,"rechazado"),className:"text-red-600 hover:text-red-900 bg-red-100 hover:bg-red-200 px-2 py-1 rounded text-xs"},"❌ Rechazar")),t.createElement("button",{onClick:()=>c(m.id),className:"text-gray-600 hover:text-gray-900 bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded text-xs"},"🗑️ Eliminar"))))))))))}function x8(){const[a,e]=p.useState([]),[n,r]=p.useState(!0),[s,o]=p.useState("todos");p.useEffect(()=>{console.log("🔍 AdminSolicitudesCampana montado, cargando solicitudes..."),i()},[s]);const i=async()=>{try{console.log("🔄 Cargando solicitudes de campañas con filtro:",s),r(!0);let m;s==="todos"?(m=W(F,"solicitudes_campana"),console.log("🔍 Consultando todas las solicitudes de campañas")):(m=fe(W(F,"solicitudes_campana"),pe("estado","==",s)),console.log("🔍 Consultando solicitudes de campañas con estado:",s));const h=await le(m);console.log("📢 Solicitudes de campañas encontradas:",h.size);const C=h.docs.map(S=>({id:S.id,...S.data()}));console.log("📢 Datos de solicitudes de campañas:",C),C.sort((S,w)=>S.fechaSolicitud&&w.fechaSolicitud?new Date(w.fechaSolicitud.toDate())-new Date(S.fechaSolicitud.toDate()):0),e(C)}catch(m){console.error("Error cargando solicitudes de campañas:",m)}finally{r(!1)}},l=async(m,h)=>{try{const C=Ne(F,"solicitudes_campana",m);await ze(C,{estado:h,fecha_revision:new Date,revisado_por:"admin"}),i(),alert(`Solicitud de campaña ${h==="aprobado"?"aprobada":"rechazada"} exitosamente`)}catch(C){console.error("Error cambiando estado:",C),alert("Error al cambiar el estado de la solicitud")}},c=async m=>{if(window.confirm("¿Estás seguro de que quieres eliminar esta solicitud de campaña?"))try{await on(Ne(F,"solicitudes_campana",m)),i(),alert("Solicitud de campaña eliminada exitosamente")}catch(h){console.error("Error eliminando solicitud:",h),alert("Error al eliminar la solicitud")}},u=m=>{switch(m){case"pendiente":return"bg-yellow-100 text-yellow-800";case"en_revision":return"bg-blue-100 text-blue-800";case"aprobado":return"bg-green-100 text-green-800";case"rechazado":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},d=m=>{switch(m){case"pendiente":return"Pendiente";case"en_revision":return"En Revisión";case"aprobado":return"Aprobado";case"rechazado":return"Rechazado";default:return m||"Sin estado"}};return n?t.createElement("div",{className:"flex items-center justify-center py-8"},t.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),t.createElement("span",{className:"ml-3 text-gray-600"},"Cargando solicitudes de campañas...")):t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-white rounded-lg shadow p-4"},t.createElement("div",{className:"flex items-center space-x-4"},t.createElement("label",{className:"text-sm font-medium text-gray-700"},"Filtrar por estado:"),t.createElement("select",{value:s,onChange:m=>o(m.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"todos"},"Todos los estados"),t.createElement("option",{value:"pendiente"},"Pendientes"),t.createElement("option",{value:"en_revision"},"En Revisión"),t.createElement("option",{value:"aprobado"},"Aprobados"),t.createElement("option",{value:"rechazado"},"Rechazados")),t.createElement("button",{onClick:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"},"🔄 Actualizar"))),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4"},t.createElement("div",{className:"bg-white rounded-lg shadow p-4"},t.createElement("div",{className:"text-2xl font-bold text-yellow-600"},a.filter(m=>m.estado==="pendiente").length),t.createElement("div",{className:"text-sm text-gray-600"},"Pendientes")),t.createElement("div",{className:"bg-white rounded-lg shadow p-4"},t.createElement("div",{className:"text-2xl font-bold text-blue-600"},a.filter(m=>m.estado==="en_revision").length),t.createElement("div",{className:"text-sm text-gray-600"},"En Revisión")),t.createElement("div",{className:"bg-white rounded-lg shadow p-4"},t.createElement("div",{className:"text-2xl font-bold text-green-600"},a.filter(m=>m.estado==="aprobado").length),t.createElement("div",{className:"text-sm text-gray-600"},"Aprobadas")),t.createElement("div",{className:"bg-white rounded-lg shadow p-4"},t.createElement("div",{className:"text-2xl font-bold text-red-600"},a.filter(m=>m.estado==="rechazado").length),t.createElement("div",{className:"text-sm text-gray-600"},"Rechazadas"))),t.createElement("div",{className:"bg-white rounded-lg shadow"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Solicitudes de Campañas (",a.length,")")),a.length===0?t.createElement("div",{className:"p-6 text-center text-gray-500"},t.createElement("p",null,"No hay solicitudes de campañas para mostrar.")):t.createElement("div",{className:"overflow-x-auto"},t.createElement("table",{className:"min-w-full divide-y divide-gray-200"},t.createElement("thead",{className:"bg-gray-50"},t.createElement("tr",null,t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Campaña"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Proveedor"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Fecha"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),t.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},a.map(m=>t.createElement("tr",{key:m.id,className:"hover:bg-gray-50"},t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("div",null,t.createElement("div",{className:"text-sm font-medium text-gray-900"},m.nombre||m.nombre_campana||m.titulo||"Sin nombre"),t.createElement("div",{className:"text-sm text-gray-500"},m.descripcion||"Sin descripción"),m.tipo&&t.createElement("div",{className:"text-sm text-gray-500"},"Tipo: ",m.tipo),m.presupuesto&&t.createElement("div",{className:"text-sm text-gray-500"},"Presupuesto: $",m.presupuesto.toLocaleString()),m.fechaInicio&&t.createElement("div",{className:"text-sm text-gray-500"},"Inicio: ",new Date(m.fechaInicio.toDate()).toLocaleDateString("es-ES")),m.fechaFin&&t.createElement("div",{className:"text-sm text-gray-500"},"Fin: ",new Date(m.fechaFin.toDate()).toLocaleDateString("es-ES")))),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("div",{className:"text-sm text-gray-900"},m.nombre_empresa||m.nombre_proveedor||m.empresaNombre||"Sin nombre"),t.createElement("div",{className:"text-sm text-gray-500"},m.email_proveedor||m.email_empresa||m.email||"Sin email"),m.empresaId&&t.createElement("div",{className:"text-xs text-gray-400"},"ID: ",m.empresaId)),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${u(m.estado)}`},d(m.estado))),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},m.fechaSolicitud?new Date(m.fechaSolicitud.toDate()).toLocaleDateString("es-ES"):"Sin fecha"),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},t.createElement("div",{className:"flex space-x-2"},m.estado==="pendiente"&&t.createElement(t.Fragment,null,t.createElement("button",{onClick:()=>l(m.id,"aprobado"),className:"text-green-600 hover:text-green-900 bg-green-100 hover:bg-green-200 px-2 py-1 rounded text-xs"},"✅ Aprobar"),t.createElement("button",{onClick:()=>l(m.id,"rechazado"),className:"text-red-600 hover:text-red-900 bg-red-100 hover:bg-red-200 px-2 py-1 rounded text-xs"},"❌ Rechazar")),m.estado==="en_revision"&&t.createElement(t.Fragment,null,t.createElement("button",{onClick:()=>l(m.id,"aprobado"),className:"text-green-600 hover:text-green-900 bg-green-100 hover:bg-green-200 px-2 py-1 rounded text-xs"},"✅ Aprobar"),t.createElement("button",{onClick:()=>l(m.id,"rechazado"),className:"text-red-600 hover:text-red-900 bg-red-100 hover:bg-red-200 px-2 py-1 rounded text-xs"},"❌ Rechazar")),t.createElement("button",{onClick:()=>c(m.id),className:"text-gray-600 hover:text-gray-900 bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded text-xs"},"🗑️ Eliminar"))))))))))}function y8({user:a}){const[e,n]=p.useState("overview"),[r,s]=p.useState(!1),[o,i]=p.useState({totalEmpresas:0,empresasActivas:0,solicitudesPendientes:0,clientesPendientes:0,totalCampañas:0}),[l,c]=p.useState(!0);p.useEffect(()=>{(async()=>{try{console.log("📊 Cargando estadísticas del dashboard...");const m=await le(W(F,"empresas")),h=m.docs.filter(_=>{const P=_.data().estado;return P==="activa"||P==="Activa"});console.log("🏢 Empresas encontradas:",m.size,"Activas:",h.length);const C=fe(W(F,"solicitudes_empresa"),pe("estado","in",["pendiente","en_revision"])),S=await le(C);console.log("📋 Solicitudes empresa pendientes:",S.size);const w=fe(W(F,"solicitudes_proveedor"),pe("estado_general","in",["enviada","en_revision"])),f=await le(w);console.log("📋 Solicitudes proveedor pendientes:",f.size);const b=fe(W(F,"solicitudes_campana"),pe("estado","in",["pendiente","en_revision"])),v=await le(b);console.log("📢 Solicitudes campaña pendientes:",v.size);const I=fe(W(F,"solicitudes_producto"),pe("estado","in",["pendiente","en_revision"])),A=await le(I);console.log("📦 Solicitudes producto pendientes:",A.size);const N=await le(W(F,"clientes"));console.log("👥 Clientes totales:",N.size);const x=await le(W(F,"campañas"));console.log("📢 Campañas totales:",x.size);const y=S.size+f.size+v.size+A.size,E={totalEmpresas:m.size,empresasActivas:h.length,solicitudesPendientes:y,clientesPendientes:N.size,totalCampañas:x.size};console.log("✅ Estadísticas recargadas:",E),i(E)}catch(m){console.error("❌ Error cargando estadísticas:",m)}finally{c(!1)}})()},[]);const u=async()=>{try{c(!0),console.log("🔄 Recargando estadísticas...");const d=await le(W(F,"empresas")),m=d.docs.filter(E=>{const _=E.data().estado;return _==="activa"||_==="Activa"}),h=fe(W(F,"solicitudes_empresa"),pe("estado","in",["pendiente","en_revision"])),C=await le(h),S=fe(W(F,"solicitudes_proveedor"),pe("estado_general","in",["enviada","en_revision"])),w=await le(S),f=fe(W(F,"solicitudes_campana"),pe("estado","in",["pendiente","en_revision"])),b=await le(f),v=fe(W(F,"solicitudes_producto"),pe("estado","in",["pendiente","en_revision"])),I=await le(v),A=await le(W(F,"clientes")),N=await le(W(F,"campañas")),x=C.size+w.size+b.size+I.size,y={totalEmpresas:d.size,empresasActivas:m.length,solicitudesPendientes:x,clientesPendientes:A.size,totalCampañas:N.size};console.log("✅ Estadísticas recargadas:",y),i(y)}catch(d){console.error("❌ Error recargando estadísticas:",d)}finally{c(!1)}};return t.createElement("div",{className:"p-6 max-w-7xl mx-auto"},t.createElement("div",{className:"mb-8 flex items-center justify-between"},t.createElement("div",null,t.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Panel de Administración"),t.createElement("p",{className:"text-gray-600"},"Bienvenido, ",a==null?void 0:a.email,". Gestiona todo el sistema desde aquí.")),t.createElement("button",{onClick:u,disabled:l,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-300 text-white px-4 py-2 rounded-lg transition-colors flex items-center gap-2"},l?t.createElement(t.Fragment,null,t.createElement("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Cargando..."):t.createElement(t.Fragment,null,"🔄 Actualizar Estadísticas"))),t.createElement("div",{className:"flex space-x-1 mb-6 bg-gray-100 p-1 rounded-lg"},t.createElement("button",{className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${e==="overview"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,onClick:()=>n("overview")},"📊 Resumen"),t.createElement("button",{className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${e==="empresas"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,onClick:()=>n("empresas")},"🏢 Empresas"),t.createElement("button",{className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${e==="campañas"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,onClick:()=>n("campañas")},"📢 Solicitudes Campañas"),t.createElement("button",{className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${e==="productos"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,onClick:()=>n("productos")},"📦 Productos")),e==="overview"&&t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4"},t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},t.createElement("div",{className:"text-2xl font-bold text-blue-800"},l?"...":o.totalEmpresas),t.createElement("div",{className:"text-blue-600 text-sm"},"Total Empresas")),t.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},t.createElement("div",{className:"text-2xl font-bold text-green-800"},l?"...":o.empresasActivas),t.createElement("div",{className:"text-green-600 text-sm"},"Empresas Activas")),t.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},t.createElement("div",{className:"text-2xl font-bold text-yellow-800"},l?"...":o.solicitudesPendientes),t.createElement("div",{className:"text-yellow-600 text-sm"},"Solicitudes Proveedores")),t.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4"},t.createElement("div",{className:"text-2xl font-bold text-purple-800"},l?"...":o.clientesPendientes),t.createElement("div",{className:"text-purple-600 text-sm"},"Clientes Pendientes")),t.createElement("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4"},t.createElement("div",{className:"text-2xl font-bold text-indigo-800"},l?"...":o.totalCampañas),t.createElement("div",{className:"text-indigo-600 text-sm"},"Campañas Activas"))),t.createElement(b8,null),t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement("h2",{className:"text-xl font-bold text-gray-900 mb-4"},"🚀 Acciones Rápidas"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4"},t.createElement(cu,{to:"/admin/empresas",className:"bg-blue-600 hover:bg-blue-700 text-white p-4 rounded-lg text-center transition-colors"},t.createElement("div",{className:"text-2xl mb-2"},"🏢"),t.createElement("div",{className:"font-medium"},"Gestionar Empresas"),t.createElement("div",{className:"text-sm opacity-90"},"Ver y editar perfiles")),t.createElement(cu,{to:"/admin/solicitudes-empresas",className:"bg-yellow-600 hover:bg-yellow-700 text-white p-4 rounded-lg text-center transition-colors"},t.createElement("div",{className:"text-2xl mb-2"},"📋"),t.createElement("div",{className:"font-medium"},"Solicitudes Empresas"),t.createElement("div",{className:"text-sm opacity-90"},"Revisar pendientes")),t.createElement("button",{onClick:()=>n("campañas"),className:"bg-green-600 hover:bg-green-700 text-white p-4 rounded-lg text-center transition-colors"},t.createElement("div",{className:"text-2xl mb-2"},"📢"),t.createElement("div",{className:"font-medium"},"Solicitudes Campañas"),t.createElement("div",{className:"text-sm opacity-90"},"Aprobar campañas")),t.createElement("button",{onClick:()=>n("productos"),className:"bg-orange-600 hover:bg-orange-700 text-white p-4 rounded-lg text-center transition-colors"},t.createElement("div",{className:"text-2xl mb-2"},"📦"),t.createElement("div",{className:"font-medium"},"Solicitudes Productos"),t.createElement("div",{className:"text-sm opacity-90"},"Aprobar productos")),t.createElement(cu,{to:"/admin/estadisticas",className:"bg-purple-600 hover:bg-purple-700 text-white p-4 rounded-lg text-center transition-colors"},t.createElement("div",{className:"text-2xl mb-2"},"📊"),t.createElement("div",{className:"font-medium"},"Estadísticas"),t.createElement("div",{className:"text-sm opacity-90"},"Ver métricas"))))),e==="empresas"&&t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Gestión de Empresas"),t.createElement("button",{onClick:()=>s(!r),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors"},r?"Ocultar Formulario":"Crear Nueva Empresa")),r&&t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement(Xg,null)),t.createElement(v8,null)),e==="campañas"&&t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Gestión de Solicitudes de Campañas"),t.createElement("div",{className:"text-sm text-gray-600"},"Revisa y aprueba las campañas que los proveedores solicitan publicar")),console.log("🔍 Renderizando pestaña de campañas"),t.createElement(x8,null)),e==="productos"&&t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Gestión de Solicitudes de Productos"),t.createElement("div",{className:"text-sm text-gray-600"},"Revisa y aprueba los productos que los proveedores solicitan publicar")),console.log("🔍 Renderizando pestaña de productos"),t.createElement(E8,null)))}const N8=()=>{const[a,e]=p.useState([]),[n,r]=p.useState(!0),[s,o]=p.useState(null),[i,l]=p.useState(""),[c,u]=p.useState(null),[d,m]=p.useState(""),[h,C]=p.useState(!1),[S,w]=p.useState(!1),f=["Toyota","Volkswagen","Ford","Chevrolet","Nissan","Honda","Hyundai","Kia","BMW","Mercedes-Benz","Audi","Volkswagen Comerciales","Renault","Peugeot","Citroën","Fiat","Jeep","Dodge","Ram","Chrysler","Subaru","Mazda","Mitsubishi","Suzuki","Isuzu","Daihatsu","Lexus","Infiniti","Acura","Cadillac","Buick","GMC","Lincoln","Volvo","Saab","Jaguar","Land Rover","Mini","Porsche","Ferrari","Lamborghini","Maserati","Alfa Romeo","Lancia","Skoda","Seat","Opel","Vauxhall","Holden"],b=async()=>{try{r(!0),o(null);const E=W(F,"marcas"),P=(await le(E)).docs.map(k=>({id:k.id,...k.data()}));P.sort((k,D)=>k.nombre.localeCompare(D.nombre)),e(P)}catch(E){console.error("Error al obtener marcas:",E),o("Error al cargar las marcas")}finally{r(!1)}};p.useEffect(()=>{b()},[]);const v=async E=>{if(E.preventDefault(),!i.trim())return;if(a.find(P=>P.nombre.toLowerCase()===i.trim().toLowerCase())){alert("Esta marca ya existe");return}try{w(!0);const P=W(F,"marcas"),D={id:(await ot(P,{nombre:i.trim(),fechaCreacion:new Date})).id,nombre:i.trim(),fechaCreacion:new Date};e(M=>[...M,D].sort(($,q)=>$.nombre.localeCompare(q.nombre))),l(""),C(!1)}catch(P){console.error("Error al agregar marca:",P),alert("Error al agregar la marca")}finally{w(!1)}},I=async(E,_)=>{if(window.confirm(`¿Estás seguro de que deseas eliminar la marca "${_}"?`))try{await on(Ne(F,"marcas",E)),e(P=>P.filter(k=>k.id!==E))}catch(P){console.error("Error al eliminar marca:",P),alert("Error al eliminar la marca")}},A=async E=>{if(!d.trim())return;if(a.find(P=>P.nombre.toLowerCase()===d.trim().toLowerCase()&&P.id!==E)){alert("Ya existe una marca con este nombre");return}try{await ze(Ne(F,"marcas",E),{nombre:d.trim()}),e(P=>P.map(k=>k.id===E?{...k,nombre:d.trim()}:k).sort((k,D)=>k.nombre.localeCompare(D.nombre))),u(null),m("")}catch(P){console.error("Error al actualizar marca:",P),alert("Error al actualizar la marca")}},N=E=>{u(E.id),m(E.nombre)},x=()=>{u(null),m("")},y=async()=>{if(window.confirm("¿Deseas agregar todas las marcas predefinidas que no existen aún?"))try{w(!0);const E=W(F,"marcas"),_=a.map(D=>D.nombre.toLowerCase()),P=f.filter(D=>!_.includes(D.toLowerCase())),k=P.map(D=>ot(E,{nombre:D,fechaCreacion:new Date}));await Promise.all(k),await b(),alert(`Se agregaron ${P.length} marcas nuevas`)}catch(E){console.error("Error al agregar marcas predefinidas:",E),alert("Error al agregar las marcas predefinidas")}finally{w(!1)}};return n?t.createElement("div",{className:"flex justify-center items-center h-64"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})):t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement("div",{className:"bg-white rounded-lg shadow-md p-6"},t.createElement("div",{className:"flex justify-between items-center mb-6"},t.createElement("h1",{className:"text-2xl font-bold text-gray-800"},"Gestión de Marcas"),t.createElement("div",{className:"flex gap-2"},t.createElement("button",{onClick:()=>C(!h),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"},h?"Cancelar":"Nueva Marca"),a.length===0&&t.createElement("button",{onClick:y,disabled:S,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50"},S?"Agregando...":"Agregar Marcas Básicas"))),s&&t.createElement("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},s),h&&t.createElement("div",{className:"bg-gray-50 p-4 rounded-lg mb-6"},t.createElement("form",{onSubmit:v,className:"flex gap-2"},t.createElement("input",{type:"text",value:i,onChange:E=>l(E.target.value),placeholder:"Nombre de la marca",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",list:"marcas-sugeridas",required:!0}),t.createElement("datalist",{id:"marcas-sugeridas"},f.filter(E=>!a.some(_=>_.nombre.toLowerCase()===E.toLowerCase())).map(E=>t.createElement("option",{key:E,value:E}))),t.createElement("button",{type:"submit",disabled:S,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50"},S?"Agregando...":"Agregar"))),t.createElement("div",{className:"mb-4"},t.createElement("p",{className:"text-gray-600"},"Total de marcas: ",t.createElement("span",{className:"font-semibold"},a.length)),a.length>0&&t.createElement("button",{onClick:y,disabled:S,className:"mt-2 bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors disabled:opacity-50"},S?"Agregando...":"Agregar Marcas Faltantes")),t.createElement("div",{className:"grid gap-2"},a.length===0?t.createElement("div",{className:"text-center py-8 text-gray-500"},t.createElement("p",null,"No hay marcas registradas"),t.createElement("p",{className:"text-sm"},'Usa el botón "Agregar Marcas Básicas" para comenzar')):a.map(E=>t.createElement("div",{key:E.id,className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50"},c===E.id?t.createElement("div",{className:"flex-1 flex gap-2"},t.createElement("input",{type:"text",value:d,onChange:_=>m(_.target.value),className:"flex-1 px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyPress:_=>{_.key==="Enter"?A(E.id):_.key==="Escape"&&x()},autoFocus:!0}),t.createElement("button",{onClick:()=>A(E.id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700"},"Guardar"),t.createElement("button",{onClick:x,className:"bg-gray-600 text-white px-3 py-1 rounded text-sm hover:bg-gray-700"},"Cancelar")):t.createElement(t.Fragment,null,t.createElement("span",{className:"text-gray-800 font-medium"},E.nombre),t.createElement("div",{className:"flex gap-2"},t.createElement("button",{onClick:()=>N(E),className:"bg-yellow-600 text-white px-3 py-1 rounded text-sm hover:bg-yellow-700 transition-colors"},"Editar"),t.createElement("button",{onClick:()=>I(E.id,E.nombre),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors"},"Eliminar"))))))))};function mh(a){if(!a)return"bg-gray-200 text-gray-700";switch(a.toLowerCase()){case"activa":case"activo":return"bg-green-100 text-green-700";case"validada":return"bg-blue-100 text-blue-700";case"pendiente_validacion":case"pendiente de validación":return"bg-yellow-100 text-yellow-700";case"en_visita":case"en visita":return"bg-purple-100 text-purple-700";case"catalogada":return"bg-indigo-100 text-indigo-700";case"ingresada":return"bg-teal-100 text-teal-700";case"inactiva":case"inactivo":return"bg-red-200 text-red-800";case"suspendida":case"suspendido":return"bg-orange-200 text-orange-800";case"rechazada":return"bg-red-300 text-red-900";default:return"bg-gray-100 text-gray-700"}}const w8=[{label:"Todos",value:"todos"},{label:"Catastro Inicial",value:"catastro_inicial"},{label:"Catalogada",value:ce.CATALOGADA},{label:"Ingresada",value:"ingresada"},{label:"Pendiente de Validación",value:ce.PENDIENTE_VALIDACION},{label:"En Visita",value:ce.EN_VISITA},{label:"Validada",value:ce.VALIDADA},{label:"Activa",value:ce.ACTIVA},{label:"Suspendida",value:ce.SUSPENDIDA},{label:"Inactiva",value:ce.INACTIVA},{label:"Rechazada",value:ce.RECHAZADA}];function ph({logo:a,nombre:e,className:n="h-12 w-12 rounded object-cover"}){const{imageUrl:r,loading:s,error:o}=ui(a);return a?s?t.createElement("div",{className:`${n} bg-gray-200 flex items-center justify-center`},t.createElement("div",{className:"w-4 h-4 border-2 border-gray-400 border-t-blue-600 rounded-full animate-spin"})):o||!r?t.createElement("div",{className:`${n} bg-gray-200 flex items-center justify-center`},t.createElement("span",{className:"text-xs text-red-500"},"Error")):t.createElement("img",{className:n,src:r,alt:`Logo de ${e}`,onError:i=>{i.target.style.display="none",i.target.nextSibling.style.display="flex"}}):t.createElement("div",{className:`${n} bg-gray-200 flex items-center justify-center`},t.createElement("span",{className:"text-xs text-gray-500"},"Sin logo"))}function _8(){var b;const[a,e]=p.useState([]),[n,r]=p.useState({estado:"todos",busqueda:"",categoria:"",tieneWeb:"",tieneLogoAssignado:""}),[s,o]=p.useState(!0),[i,l]=p.useState("table"),[c,u]=p.useState(null),d=Ct();p.useEffect(()=>{console.log("🔍 Iniciando carga de empresas..."),console.log("🔥 Firebase config:",F),o(!0);try{const v=fe(W(F,"empresas"));return console.log("📡 Configurando listener..."),wa(v,A=>{console.log("✅ Snapshot recibido"),console.log("📊 Número de documentos:",A.docs.length),console.log("📄 Metadata:",A.metadata),A.empty&&console.log("⚠️ La colección está vacía");const N=A.docs.map(x=>{const y=x.data();return console.log("� Procesando empresa:",x.id,y),{id:x.id,...y,nombre:y.nombre||"Sin nombre",estado:y.estado||"inactiva",categoria:y.categoria||"Sin categoría"}});console.log("✨ Empresas procesadas:",N),e(N),o(!1)},A=>{console.error("❌ Error en snapshot listener:",A),console.error("📝 Detalles del error:",A.code,A.message),o(!1),A.code==="permission-denied"?console.error("🚫 Sin permisos para leer la colección empresas"):A.code==="unavailable"&&console.error("🌐 Firebase no disponible - problema de conexión")})}catch(v){console.error("💥 Error configurando listener:",v),o(!1)}},[]);const m=async v=>{try{let I;v.estado===ce.ACTIVA?I=ce.INACTIVA:v.estado===ce.INACTIVA||v.estado===ce.VALIDADA?I=ce.ACTIVA:v.estado===ce.CATALOGADA?I=ce.PENDIENTE_VALIDACION:v.estado===ce.INGRESADA?I=window.confirm(`Empresa: ${v.nombre}

Estado actual: Ingresada

¿Qué quieres hacer?
• OK = Activar directamente (ir a estado "Activa")
• Cancelar = Asignar a validación (ir a estado "Pendiente de Validación")`)?ce.ACTIVA:ce.PENDIENTE_VALIDACION:I=ce.ACTIVA,await ze(Ne(F,"empresas",v.id),{estado:I,fecha_actualizacion:new Date});const A=I===ce.ACTIVA?`Empresa ${v.nombre} activada exitosamente`:`Empresa ${v.nombre} asignada a validación exitosamente`;alert(A)}catch(I){console.error("Error cambiando estado:",I),alert("Error al cambiar el estado")}},h=async v=>{if(window.confirm(`¿Estás seguro de suspender a ${v.nombre}?`))try{await ze(Ne(F,"empresas",v.id),{estado:ce.SUSPENDIDA,fecha_suspension:new Date,fecha_actualizacion:new Date}),alert("Empresa suspendida exitosamente")}catch(I){console.error("Error suspendiendo empresa:",I),alert("Error al suspender la empresa")}},C=async v=>{if(window.confirm(`¿Estás seguro de eliminar a ${v.nombre}? Esta acción no se puede deshacer.`))try{await on(Ne(F,"empresas",v.id)),alert("Empresa eliminada exitosamente")}catch(I){console.error("Error eliminando empresa:",I),alert("Error al eliminar la empresa")}},S=a.filter(v=>{var E,_,P,k;let I=n.estado==="todos";n.estado==="catastro_inicial"?I=v.estado===ce.CATALOGADA||v.estado===ce.INGRESADA:n.estado!=="todos"&&(I=v.estado===n.estado);const A=!n.busqueda||((E=v.nombre)==null?void 0:E.toLowerCase().includes(n.busqueda.toLowerCase()))||((_=v.email)==null?void 0:_.toLowerCase().includes(n.busqueda.toLowerCase()))||((P=v.direccion)==null?void 0:P.toLowerCase().includes(n.busqueda.toLowerCase()))||((k=v.categoria)==null?void 0:k.toLowerCase().includes(n.busqueda.toLowerCase())),N=!n.categoria||v.categoria===n.categoria,x=n.tieneWeb===""||n.tieneWeb==="si"&&v.web||n.tieneWeb==="no"&&!v.web,y=n.tieneLogoAssignado===""||n.tieneLogoAssignado==="si"&&v.logoAsignado||n.tieneLogoAssignado==="no"&&!v.logoAsignado;return I&&A&&N&&x&&y}),w=[...new Set(a.map(v=>v.categoria).filter(Boolean))],f={total:a.length,catastroInicial:a.filter(v=>v.estado===ce.CATALOGADA||v.estado==="ingresada").length,catalogadas:a.filter(v=>v.estado===ce.CATALOGADA).length,ingresadas:a.filter(v=>v.estado===ce.INGRESADA).length,pendientes:a.filter(v=>v.estado===ce.PENDIENTE_VALIDACION).length,enVisita:a.filter(v=>v.estado===ce.EN_VISITA).length,validadas:a.filter(v=>v.estado===ce.VALIDADA).length,activas:a.filter(v=>v.estado===ce.ACTIVA).length,suspendidas:a.filter(v=>v.estado===ce.SUSPENDIDA).length,inactivas:a.filter(v=>v.estado===ce.INACTIVA).length,rechazadas:a.filter(v=>v.estado===ce.RECHAZADA).length,sinWeb:a.filter(v=>!v.web).length,sinLogo:a.filter(v=>!v.logoAsignado).length};return s?t.createElement("div",{className:"flex items-center justify-center p-8"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),t.createElement("p",{className:"text-gray-600"},"Cargando empresas..."),t.createElement("p",{className:"text-gray-400 text-sm mt-2"},"Conectando con Firebase..."))):!s&&a.length===0?t.createElement("section",{className:"p-6"},t.createElement("div",{className:"mb-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Gestión de Empresas Registradas"),t.createElement("p",{className:"text-gray-600"},"Administra empresas y proveedores que ya están registrados en el sistema")),t.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-8 text-center"},t.createElement("span",{className:"text-6xl mb-4 block"},"🏢"),t.createElement("h3",{className:"text-lg font-medium text-yellow-900 mb-2"},"No hay empresas registradas"),t.createElement("p",{className:"text-yellow-700 mb-4"},"Parece que aún no se han registrado empresas en el sistema, o hay un problema de conexión con Firebase."),t.createElement("div",{className:"bg-yellow-100 border border-yellow-300 rounded-lg p-4 mb-6 text-left"},t.createElement("h4",{className:"font-medium text-yellow-900 mb-2"},"💡 Posibles causas:"),t.createElement("ul",{className:"text-yellow-800 text-sm space-y-1"},t.createElement("li",null,'• La colección "empresas" está vacía en Firebase'),t.createElement("li",null,"• Problemas de permisos de lectura en Firebase"),t.createElement("li",null,"• Problemas de conexión a internet"),t.createElement("li",null,"• Las empresas están en una colección diferente"))),t.createElement("div",{className:"space-x-4"},t.createElement("button",{onClick:()=>d("/admin/solicitudes-registro"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"},"📋 Ver Solicitudes"),t.createElement("button",{onClick:()=>d("/admin/proveedores"),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors"},"🏪 Vista Unificada"),t.createElement("button",{onClick:crearDatosEjemplo,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors"},"🏗️ Crear Empresas"),t.createElement("button",{onClick:crearSolicitudesDeEjemplo,className:"bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors"},"📋 Crear Solicitudes"),t.createElement("button",{onClick:()=>window.location.reload(),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors"},"🔄 Recargar Página")),t.createElement("div",{className:"mt-6 text-xs text-yellow-600"},"💡 Tip: Revisa la consola del navegador (F12) para más detalles del error"))):t.createElement("section",{className:"p-6"},t.createElement("div",{className:"mb-6 flex items-center justify-between"},t.createElement("div",null,t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Gestión de Empresas Registradas"),t.createElement("p",{className:"text-gray-600"},"Administra empresas y proveedores que ya están registrados en el sistema")),t.createElement("div",{className:"flex items-center gap-2"},t.createElement("button",{onClick:()=>d("/admin/crear-empresa-publica"),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors font-medium"},"➕ Crear Empresa Pública"))),t.createElement("div",{className:"mb-6 bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"flex-shrink-0"},t.createElement("span",{className:"text-2xl"},"📋")),t.createElement("div",{className:"ml-3"},t.createElement("h3",{className:"text-sm font-medium text-blue-900"},"¿Buscas solicitudes de agentes y nuevas empresas?"),t.createElement("p",{className:"text-sm text-blue-700"},"Gestiona solicitudes pendientes, incluyendo las enviadas por agentes de campo"))),t.createElement("div",{className:"flex space-x-3"},t.createElement("button",{onClick:()=>d("/admin/solicitudes-registro"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm"},"📋 Ver Solicitudes"),t.createElement("button",{onClick:()=>d("/admin/proveedores"),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors text-sm"},"🏪 Vista Unificada")))),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-9 gap-4 mb-6"},t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-blue-800"},f.total),t.createElement("div",{className:"text-blue-600 text-sm"},"Total")),t.createElement("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-gray-800"},f.catastroInicial),t.createElement("div",{className:"text-gray-600 text-sm"},"Catastro Inicial")),t.createElement("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-indigo-800"},f.catalogadas),t.createElement("div",{className:"text-indigo-600 text-sm"},"Catalogadas")),t.createElement("div",{className:"bg-teal-50 border border-teal-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-teal-800"},f.ingresadas),t.createElement("div",{className:"text-teal-600 text-sm"},"Ingresadas")),t.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-yellow-800"},f.pendientes),t.createElement("div",{className:"text-yellow-600 text-sm"},"Pendientes")),t.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-purple-800"},f.enVisita),t.createElement("div",{className:"text-purple-600 text-sm"},"En Visita")),t.createElement("div",{className:"bg-blue-100 border border-blue-300 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-blue-900"},f.validadas),t.createElement("div",{className:"text-blue-700 text-sm"},"Validadas")),t.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-green-800"},f.activas),t.createElement("div",{className:"text-green-600 text-sm"},"Activas")),t.createElement("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-orange-800"},f.suspendidas),t.createElement("div",{className:"text-orange-600 text-sm"},"Suspendidas"))),t.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Estado"),t.createElement("select",{value:n.estado,onChange:v=>r({...n,estado:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},w8.map(v=>t.createElement("option",{key:v.value,value:v.value},v.label)))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Categoría"),t.createElement("select",{value:n.categoria,onChange:v=>r({...n,categoria:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:""},"Todas"),w.map(v=>t.createElement("option",{key:v,value:v},v)))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tiene Web"),t.createElement("select",{value:n.tieneWeb,onChange:v=>r({...n,tieneWeb:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:""},"Todos"),t.createElement("option",{value:"si"},"Con Web"),t.createElement("option",{value:"no"},"Sin Web"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tiene Logo"),t.createElement("select",{value:n.tieneLogoAssignado,onChange:v=>r({...n,tieneLogoAssignado:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:""},"Todos"),t.createElement("option",{value:"si"},"Con Logo"),t.createElement("option",{value:"no"},"Sin Logo"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Buscar"),t.createElement("input",{type:"text",placeholder:"Nombre, email, dirección...",value:n.busqueda,onChange:v=>r({...n,busqueda:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",{className:"flex items-end"},t.createElement("button",{onClick:()=>r({estado:"todos",busqueda:"",categoria:"",tieneWeb:"",tieneLogoAssignado:""}),className:"w-full px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors"},"Limpiar")))),t.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("div",{className:"flex items-center justify-between mb-3"},t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Empresas (",S.length,")"),t.createElement("div",{className:"flex items-center gap-2"},t.createElement("button",{onClick:()=>l("table"),className:`p-2 rounded ${i==="table"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`},"📋 Tabla"),t.createElement("button",{onClick:()=>l("grid"),className:`p-2 rounded ${i==="grid"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`},"📱 Tarjetas"))),t.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3"},t.createElement("div",{className:"flex items-center gap-2"},t.createElement("span",{className:"text-green-600"},"💡"),t.createElement("p",{className:"text-sm text-green-800"},t.createElement("strong",null,"Acceso rápido al perfil del proveedor:"),' Usa el botón verde "👤 Ver Perfil Proveedor" para ver exactamente lo que ven los clientes y detectar problemas caso por caso.')))),i==="table"?t.createElement("div",{className:"overflow-x-auto"},t.createElement("table",{className:"min-w-full"},t.createElement("thead",{className:"bg-gray-50"},t.createElement("tr",null,t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Logo"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Empresa"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Contacto"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Sitio Web"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Estado"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Acciones"))),t.createElement("tbody",{className:"divide-y divide-gray-200"},S.map(v=>t.createElement("tr",{key:v.id,className:"hover:bg-gray-50"},t.createElement("td",{className:"px-6 py-4"},t.createElement(ph,{logo:v.logo_url||v.logo,nombre:v.nombre,className:"w-12 h-12 object-contain rounded border"})),t.createElement("td",{className:"px-6 py-4"},t.createElement("div",null,t.createElement("div",{className:"font-medium text-gray-900"},v.nombre),t.createElement("div",{className:"text-sm text-gray-500"},v.categoria),t.createElement("div",{className:"text-sm text-gray-500"},v.direccion))),t.createElement("td",{className:"px-6 py-4"},t.createElement("div",{className:"text-sm"},t.createElement("div",null,v.email),t.createElement("div",{className:"text-gray-500"},v.telefono))),t.createElement("td",{className:"px-6 py-4"},v.web?t.createElement("a",{href:v.web.startsWith("http")?v.web:`https://${v.web}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm underline"},"🌐 Sitio Web"):t.createElement("span",{className:"text-gray-400 text-sm"},"Sin sitio web")),t.createElement("td",{className:"px-6 py-4"},t.createElement("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${mh(v.estado)}`},v.estado||"Sin estado")),t.createElement("td",{className:"px-6 py-4"},t.createElement("div",{className:"flex items-center space-x-2"},t.createElement("button",{onClick:()=>window.open(`/perfil-proveedor/${v.id}`,"_blank"),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors",title:"Ver dashboard interno del proveedor (como lo ve el proveedor)"},"👤 Ver Dashboard Proveedor"),t.createElement("button",{onClick:()=>u(v),className:"text-purple-600 hover:text-purple-800 text-sm underline"},"👁️ Vista Previa"),t.createElement("button",{onClick:()=>d(`/admin/editar-empresa/${v.id}`),className:"text-blue-600 hover:text-blue-800 text-sm underline"},"Editar"),t.createElement("button",{onClick:()=>m(v),className:`text-sm underline ${v.estado===ce.ACTIVA?"text-red-600 hover:text-red-800":"text-green-600 hover:text-green-800"}`},v.estado===ce.ACTIVA?"Desactivar":"Activar"),v.estado!==ce.SUSPENDIDA&&t.createElement("button",{onClick:()=>h(v),className:"text-orange-600 hover:text-orange-800 text-sm underline"},"Suspender"),t.createElement("button",{onClick:()=>C(v),className:"text-red-600 hover:text-red-800 text-sm underline"},"Eliminar")))))))):t.createElement("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},S.map(v=>t.createElement("div",{key:v.id,className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"flex items-center gap-4 mb-3"},t.createElement(ph,{logo:v.logo_url||v.logo,nombre:v.nombre,className:"w-16 h-16 object-contain rounded border"}),t.createElement("div",{className:"flex-1"},t.createElement("h3",{className:"font-medium text-gray-900"},v.nombre),t.createElement("p",{className:"text-sm text-gray-500"},v.categoria),t.createElement("span",{className:`inline-block px-2 py-1 text-xs font-semibold rounded-full mt-1 ${mh(v.estado)}`},v.estado||"Sin estado"))),t.createElement("div",{className:"space-y-1 text-sm text-gray-600 mb-4"},t.createElement("p",null,"📧 ",v.email),t.createElement("p",null,"📞 ",v.telefono),t.createElement("p",null,"📍 ",v.direccion)),t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",{className:"flex gap-2"},t.createElement("button",{onClick:()=>window.open(`/perfil-empresa/${v.id}`,"_blank"),className:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700 transition-colors",title:"Ver dashboard interno del proveedor (como lo ve el proveedor)"},"👤 Ver Dashboard Proveedor"),t.createElement("button",{onClick:()=>u(v),className:"px-3 py-1 bg-purple-600 text-white text-sm rounded hover:bg-purple-700"},"👁️ Vista Previa"),v.web?t.createElement("a",{href:v.web.startsWith("http")?v.web:`https://${v.web}`,target:"_blank",rel:"noopener noreferrer",className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700"},"🌐 Web"):t.createElement("a",{href:`/empresa/${v.id}`,target:"_blank",rel:"noopener noreferrer",className:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700"},"👤 Perfil")),t.createElement("button",{onClick:()=>d(`/admin/editar-empresa/${v.id}`),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700"},"Editar"))))),S.length===0&&t.createElement("div",{className:"text-center py-8"},t.createElement("p",{className:"text-gray-500"},"No hay empresas que coincidan con los filtros"))),c&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},t.createElement("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto"},t.createElement("div",{className:"p-6"},t.createElement("div",{className:"flex justify-between items-start mb-4"},t.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Vista Previa: ",c.nombre),t.createElement("button",{onClick:()=>u(null),className:"text-gray-400 hover:text-gray-600"},"✕")),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"flex items-center gap-4"},t.createElement(ph,{logo:c.logo_url||c.logo,nombre:c.nombre,className:"w-24 h-24 object-contain rounded border"}),t.createElement("div",null,t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},c.nombre),t.createElement("span",{className:`inline-block px-3 py-1 text-sm font-semibold rounded-full ${mh(c.estado)}`},c.estado||"Sin estado"))),t.createElement("div",{className:"space-y-2"},t.createElement("div",null,t.createElement("strong",null,"Categoría:")," ",c.categoria||"No especificada"),t.createElement("div",null,t.createElement("strong",null,"Dirección:")," ",c.direccion||"No especificada"),t.createElement("div",null,t.createElement("strong",null,"Teléfono:")," ",c.telefono||"No especificado"),t.createElement("div",null,t.createElement("strong",null,"Email:")," ",c.email||"No especificado"),c.web&&t.createElement("div",null,t.createElement("strong",null,"Sitio Web:"),t.createElement("a",{href:c.web.startsWith("http")?c.web:`https://${c.web}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 ml-2 underline"},c.web)))),t.createElement("div",{className:"space-y-4"},c.descripcion&&t.createElement("div",null,t.createElement("strong",null,"Descripción:"),t.createElement("p",{className:"mt-1 text-gray-700"},c.descripcion)),c.horarios&&t.createElement("div",null,t.createElement("strong",null,"Horarios:"),t.createElement("p",{className:"mt-1 text-gray-700"},typeof c.horarios=="string"?c.horarios:((b=c.horarios)==null?void 0:b.general)||"No especificados")),c.marcas&&c.marcas.length>0&&t.createElement("div",null,t.createElement("strong",null,"Marcas:"),t.createElement("div",{className:"mt-1 flex flex-wrap gap-1"},c.marcas.map((v,I)=>t.createElement("span",{key:I,className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs"},v)))))),t.createElement("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t"},t.createElement("button",{onClick:()=>u(null),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50"},"Cerrar"),t.createElement("a",{href:`/empresa/${c.id}`,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium"},"👤 Ver Perfil Público"),t.createElement("a",{href:`/perfil-proveedor/${c.id}`,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"},"🏢 Ver Dashboard Interno"),c.web&&t.createElement("a",{href:c.web.startsWith("http")?c.web:`https://${c.web}`,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},"🌐 Página Web"),t.createElement("button",{onClick:()=>{u(null),d(`/admin/editar-empresa/${c.id}`)},className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700"},"✏️ Editar Empresa"))))))}function C8(){var u;const a=Ct(),n=(u=En().state)==null?void 0:u.solicitud,[r,s]=p.useState(n||{}),[o,i]=p.useState({});if(!n)return t.createElement("div",{className:"p-8"},"No hay datos de solicitud para editar.");const l=()=>Object.entries(r).map(([d,m])=>t.createElement("div",{key:d,className:"mb-4 flex items-center gap-4"},t.createElement("label",{className:"font-medium w-48"},d,":"),t.createElement("input",{className:"border rounded px-2 py-1 flex-1",type:"text",value:m??"",onChange:h=>s({...r,[d]:h.target.value})}),t.createElement("label",{className:"flex items-center gap-1"},t.createElement("input",{type:"checkbox",checked:!!o[d],onChange:h=>i({...o,[d]:h.target.checked})}),t.createElement("span",{className:"text-xs"},"Validado")))),c=()=>{alert("Datos guardados (simulado)"),a(-1)};return t.createElement("div",{className:"p-8 max-w-2xl mx-auto bg-white rounded shadow"},t.createElement("h2",{className:"text-2xl font-bold mb-6"},"Editar Solicitud"),l(),t.createElement("div",{className:"mt-8 flex gap-4"},t.createElement("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:c},"Guardar"),t.createElement("button",{className:"px-4 py-2 bg-gray-300 text-gray-800 rounded",onClick:()=>a(-1)},"Cancelar")))}const gh=[{value:"",label:"Todos los estados",color:"gray"},{value:"pendiente",label:"Pendiente",color:"yellow"},{value:"en_revision",label:"En Revisión",color:"blue"},{value:"activada",label:"Activada (Visible en Home)",color:"green"},{value:"credenciales_asignadas",label:"Credenciales Asignadas",color:"purple"},{value:"rechazada",label:"Rechazada",color:"red"}];function S8(){var de,oe,ge,me,he,G,we,Te,B,ve,je,_e,H,Pe,Ye,it,mt,be,Re,qe,Me,Xe,ft,ca,ea,Tt,He,$t;const{user:a}=ht(),[e,n]=p.useState([]),[r,s]=p.useState(!0),[o,i]=p.useState({estado:"",busqueda:"",fechaDesde:"",fechaHasta:""}),[l,c]=p.useState(null),[u,d]=p.useState(!1),[m,h]=p.useState(!1),[C,S]=p.useState(!1),[w,f]=p.useState(!1),[b,v]=p.useState(!1),[I,A]=p.useState({email:"",password:"",confirmPassword:""}),[N,x]=p.useState(!1),[y,E]=p.useState(null),[_,P]=p.useState(!1),[k,D]=p.useState({descripcion_completa:"",anos_funcionamiento:"",redes_sociales:{facebook:"",instagram:"",linkedin:"",twitter:""},logo_url:"",servicios:[],marcas_trabajadas:[],tiene_web:!1,web_validada:!1,crear_perfil_publico:!1,horarios:{lunes:{activo:!0,inicio:"09:00",fin:"18:00"},martes:{activo:!0,inicio:"09:00",fin:"18:00"},miercoles:{activo:!0,inicio:"09:00",fin:"18:00"},jueves:{activo:!0,inicio:"09:00",fin:"18:00"},viernes:{activo:!0,inicio:"09:00",fin:"18:00"},sabado:{activo:!1,inicio:"09:00",fin:"13:00"},domingo:{activo:!1,inicio:"10:00",fin:"14:00"}},ubicacion:{lat:null,lng:null,verificada:!1},imagenes_local:[]});p.useEffect(()=>{$(),M()},[]);const M=async()=>{try{const ne=fe(W(F,"agentes"),pe("email","==",a==null?void 0:a.email)),K=await le(ne);f(!K.empty)}catch(ne){console.error("Error verificando rol:",ne)}};p.useEffect(()=>{$()},[]);const $=async()=>{try{s(!0),console.log("🔍 DEBUG: Iniciando carga de solicitudes...");const ne=fe(W(F,"solicitudes_empresa")),K=await le(ne);console.log("🔍 DEBUG: TOTAL documentos en solicitudes_empresa (sin filtros):",K.docs.length),K.docs.forEach((Ke,Ze)=>{const et=Ke.data();console.log(`🔍 DEBUG DOC ${Ze+1}:`,{id:Ke.id,nombre_empresa:et.nombre_empresa||et.nombre,estado:et.estado,fecha_solicitud:et.fecha_solicitud||et.fecha_registro,hasDateField:!!(et.fecha_solicitud||et.fecha_registro),dateType:typeof(et.fecha_solicitud||et.fecha_registro),dateValue:et.fecha_solicitud||et.fecha_registro,origen:et.origen||"no especificado",allFields:Object.keys(et)})}),console.log("🔍 DEBUG: Intentando query con orderBy...");let Ge;try{Ge=fe(W(F,"solicitudes_empresa"),st("fecha_registro","desc"));const Ke=await le(Ge);console.log("🔍 DEBUG: Query con orderBy (fecha_registro) exitoso, docs:",Ke.docs.length);const Ze=Ke.docs.map(et=>{var Je,We,Rt,lt,Dt;const Ue=et.data();return console.log("🔍 DEBUG: Documento en resultado final:",{id:et.id,estado:Ue.estado,fecha:Ue.fecha_registro||Ue.fecha_solicitud,nombre:Ue.nombre||Ue.nombre_empresa}),{id:et.id,...Ue,nombre_empresa:Ue.nombre||Ue.nombre_empresa,email_empresa:Ue.email||Ue.email_empresa,telefono_empresa:Ue.telefono||Ue.telefono_empresa,direccion_empresa:Ue.direccion||Ue.direccion_empresa,rut_empresa:Ue.rut||Ue.rut_empresa,web_actual:Ue.web||Ue.web_actual,fecha_solicitud:Ue.fecha_registro||Ue.fecha_solicitud,nombres_representante:((Je=Ue.representante)==null?void 0:Je.nombre)||Ue.nombres_representante,apellidos_representante:((We=Ue.representante)==null?void 0:We.apellidos)||Ue.apellidos_representante,email_representante:((Rt=Ue.representante)==null?void 0:Rt.email)||Ue.email_representante,telefono_representante:((lt=Ue.representante)==null?void 0:lt.telefono)||Ue.telefono_representante,cargo_representante:((Dt=Ue.representante)==null?void 0:Dt.cargo)||Ue.cargo_representante}});console.log("🔍 DEBUG: Total solicitudes cargadas:",Ze.length),n(Ze)}catch(Ke){console.error("❌ ERROR con orderBy fecha_registro, intentando fecha_solicitud:",Ke);try{Ge=fe(W(F,"solicitudes_empresa"),st("fecha_solicitud","desc"));const Ze=await le(Ge);console.log("🔍 DEBUG: Query con orderBy (fecha_solicitud) exitoso, docs:",Ze.docs.length);const et=Ze.docs.map(Ue=>{var We,Rt,lt,Dt,ut;const Je=Ue.data();return{id:Ue.id,...Je,nombre_empresa:Je.nombre||Je.nombre_empresa,email_empresa:Je.email||Je.email_empresa,telefono_empresa:Je.telefono||Je.telefono_empresa,direccion_empresa:Je.direccion||Je.direccion_empresa,rut_empresa:Je.rut||Je.rut_empresa,web_actual:Je.web||Je.web_actual,fecha_solicitud:Je.fecha_registro||Je.fecha_solicitud,nombres_representante:((We=Je.representante)==null?void 0:We.nombre)||Je.nombres_representante,apellidos_representante:((Rt=Je.representante)==null?void 0:Rt.apellidos)||Je.apellidos_representante,email_representante:((lt=Je.representante)==null?void 0:lt.email)||Je.email_representante,telefono_representante:((Dt=Je.representante)==null?void 0:Dt.telefono)||Je.telefono_representante,cargo_representante:((ut=Je.representante)==null?void 0:ut.cargo)||Je.cargo_representante}});n(et)}catch(Ze){console.error("❌ ERROR con orderBy fecha_solicitud también:",Ze),console.log("🔄 Intentando sin orderBy...");const Ue=(await le(ne)).docs.map(Je=>{var Rt,lt,Dt,ut,ka;const We=Je.data();return{id:Je.id,...We,nombre_empresa:We.nombre||We.nombre_empresa,email_empresa:We.email||We.email_empresa,telefono_empresa:We.telefono||We.telefono_empresa,direccion_empresa:We.direccion||We.direccion_empresa,rut_empresa:We.rut||We.rut_empresa,web_actual:We.web||We.web_actual,fecha_solicitud:We.fecha_registro||We.fecha_solicitud,nombres_representante:((Rt=We.representante)==null?void 0:Rt.nombre)||We.nombres_representante,apellidos_representante:((lt=We.representante)==null?void 0:lt.apellidos)||We.apellidos_representante,email_representante:((Dt=We.representante)==null?void 0:Dt.email)||We.email_representante,telefono_representante:((ut=We.representante)==null?void 0:ut.telefono)||We.telefono_representante,cargo_representante:((ka=We.representante)==null?void 0:ka.cargo)||We.cargo_representante}});console.log("🔍 DEBUG: Solicitudes cargadas sin orderBy:",Ue.length),n(Ue)}}}catch(ne){console.error("❌ Error cargando solicitudes:",ne),console.error("❌ Error completo:",ne.message,ne.code)}finally{s(!1)}},q=e.filter(ne=>{var Ke,Ze,et;const K=!o.estado||ne.estado===o.estado,Ge=!o.busqueda||((Ke=ne.nombre_empresa)==null?void 0:Ke.toLowerCase().includes(o.busqueda.toLowerCase()))||((Ze=ne.email_empresa)==null?void 0:Ze.toLowerCase().includes(o.busqueda.toLowerCase()))||((et=ne.nombres_representante||ne.representante_nombre)==null?void 0:et.toLowerCase().includes(o.busqueda.toLowerCase()));return K&&Ge}),V=async(ne,K,Ge="")=>{try{S(!0),await ze(Ne(F,"solicitudes_empresa",ne),{estado:K,fecha_ultima_actualizacion:new Date,comentario_admin:Ge,admin_responsable:a==null?void 0:a.email}),K==="activada"&&await j(ne),await $(),d(!1),c(null)}catch(Ke){console.error("Error actualizando solicitud:",Ke),alert("Error al actualizar la solicitud")}finally{S(!1)}},z=async ne=>{var Ge,Ke;const K=e.find(Ze=>Ze.id===ne);if(K)try{const Ze={nombre:K.nombre_empresa,email:K.email_empresa,telefono:K.telefono_empresa,direccion:K.direccion_empresa,comuna:K.comuna,region:K.region,rut:K.rut_empresa,web:K.web_actual||"",rubro:K.rubro||((Ge=K.datos_solicitud)==null?void 0:Ge.rubro)||K.categoria||"",tipoEmpresa:K.tipoEmpresa||((Ke=K.datos_solicitud)==null?void 0:Ke.tipoEmpresa)||"",descripcion_completa:k.descripcion_completa,anos_funcionamiento:k.anos_funcionamiento,redes_sociales:k.redes_sociales,logo_url:k.logo_url,servicios_completos:k.servicios,marcas_trabajadas:k.marcas_trabajadas,horarios_detallados:k.horarios,ubicacion:k.ubicacion,imagenes_local:k.imagenes_local,web_validada:k.web_validada,validacion_web:y,requiere_perfil_publico:k.crear_perfil_publico,representante:{nombre:K.nombres_representante||K.representante_nombre||"",apellidos:K.apellidos_representante||K.representante_apellidos||"",cargo:K.cargo_representante||"",email:K.email_representante||"",telefono:K.telefono_representante||""},estado:"activa",etapa_proceso:"activada_con_perfil_completo",categoria:K.categoria||"Sin categoría",fecha_registro:new Date,fecha_activacion:new Date,admin_activador:a==null?void 0:a.email,solicitud_origen_id:ne,descripcion:descripcion_completa,descripcion_completa,logoAsignado:!!k.logo_url,webValidada:k.web_validada,perfilCompleto:!0,tiene_credenciales_asignadas:!1,usuario_empresa:null,revision_completada:!0,fecha_revision:new Date,admin_revisor:a==null?void 0:a.email,rol:"proveedor"};await ot(W(F,"empresas"),Ze),console.log("Empresa creada con perfil completo desde revisión")}catch(Ze){throw console.error("Error creando empresa con perfil completo:",Ze),Ze}},j=async ne=>{var Ge,Ke,Ze,et,Ue,Je,We,Rt,lt,Dt,ut,ka;const K=e.find(tt=>tt.id===ne);if(K)try{const tt={nombre:K.nombre_empresa,email:K.email_empresa,telefono:K.telefono_empresa,direccion:K.direccion_empresa,comuna:K.comuna,region:K.region,rut:K.rut_empresa,web:K.web_actual||"",tipoEmpresa:K.tipoEmpresa||((Ge=K.datos_solicitud)==null?void 0:Ge.tipoEmpresa)||K.tipo_empresa||K.tipo_empresa||"",rubro:K.rubro||((Ke=K.datos_solicitud)==null?void 0:Ke.rubro)||K.categoria||"",descripcion:K.descripcion||K.descripcionCompleta||((Ze=K.datos_solicitud)==null?void 0:Ze.descripcion)||"",descripcionCompleta:K.descripcionCompleta||K.descripcion||K.descripcionCompleta||((et=K.datos_solicitud)==null?void 0:et.descripcionCompleta)||((Ue=K.datos_solicitud)==null?void 0:Ue.descripcion)||"",servicios:K.servicios||K.categorias_servicios||((Je=K.datos_solicitud)==null?void 0:Je.servicios)||[],marcas:K.marcas&&K.marcas.length>0&&K.marcas||K.marcas_vehiculos&&K.marcas_vehiculos.length>0&&K.marcas_vehiculos||K.datos_solicitud&&Array.isArray(K.datos_solicitud.marcas)&&K.datos_solicitud.marcas.length>0&&K.datos_solicitud.marcas||K.perfil_publico&&Array.isArray(K.perfil_publico.marcas)&&K.perfil_publico.marcas.length>0&&K.perfil_publico.marcas||[],logo:K.logo||K.logo_file_data||((We=K.datos_solicitud)==null?void 0:We.logo_file_data)||((Rt=K.perfil_publico)==null?void 0:Rt.logo)||"",galeria:K.galeria||K.galeria_files_data||((lt=K.datos_solicitud)==null?void 0:lt.galeria_files_data)||((Dt=K.perfil_publico)==null?void 0:Dt.galeria)||[],representante:{nombre:K.nombres_representante||K.representante_nombre||"",apellidos:K.apellidos_representante||K.representante_apellidos||"",cargo:K.cargo_representante||"",email:K.email_representante||"",telefono:K.telefono_representante||""},estado:"activa",etapa_proceso:"activada_sin_credenciales",categoria:K.categoria||"Sin categoría",fecha_registro:new Date,fecha_activacion:new Date,admin_activador:a==null?void 0:a.email,solicitud_origen_id:ne,logoAsignado:!!(K.logo||K.logo_file_data||(ut=K.datos_solicitud)!=null&&ut.logo_file_data||(ka=K.perfil_publico)!=null&&ka.logo),webValidada:!!K.web_actual,perfilCompleto:!1,tiene_credenciales_asignadas:!1,usuario_empresa:null,horarios:{lunes:{activo:!0,inicio:"09:00",fin:"18:00"},martes:{activo:!0,inicio:"09:00",fin:"18:00"},miercoles:{activo:!0,inicio:"09:00",fin:"18:00"},jueves:{activo:!0,inicio:"09:00",fin:"18:00"},viernes:{activo:!0,inicio:"09:00",fin:"18:00"},sabado:{activo:!1,inicio:"09:00",fin:"13:00"},domingo:{activo:!1,inicio:"10:00",fin:"14:00"}}};await ot(W(F,"empresas"),tt),console.log("Empresa activada y visible en home (primera etapa completada)")}catch(tt){throw console.error("Error creando empresa:",tt),tt}},U=async ne=>{if(!I.email||!I.password){alert("Todos los campos son obligatorios");return}if(I.password!==I.confirmPassword){alert("Las contraseñas no coinciden");return}try{S(!0);let K=null;try{K=await es(Pt,I.email,I.password)}catch(Ue){if(Ue.code==="auth/email-already-in-use")console.warn("El usuario ya existe en Firebase Auth, se asignarán credenciales igualmente.");else throw Ue}let Ge=null;if(K&&K.user){Ge=K.user.uid;const Ue={uid:Ge,email:I.email,rol:"proveedor",nombre_empresa:I.nombre_empresa||"",fecha_creacion:new Date,activo:!0};await Ar(Ne(F,"usuarios",Ge),Ue)}await ze(Ne(F,"solicitudes_empresa",ne),{estado:"credenciales_asignadas",fecha_credenciales_asignadas:new Date,admin_credenciales:a==null?void 0:a.email,usuario_asignado:{email:I.email,fecha_asignacion:new Date}});const Ke=W(F,"empresas"),Ze=fe(Ke,pe("solicitud_origen_id","==",ne)),et=await le(Ze);if(!et.empty){const Ue=et.docs[0];await ze(Ue.ref,{etapa_proceso:"credenciales_asignadas",tiene_credenciales_asignadas:!0,usuario_empresa:{email:I.email,fecha_asignacion:new Date,admin_asignador:a==null?void 0:a.email},fecha_credenciales_asignadas:new Date,uid_auth:Ge||null})}alert(`Credenciales asignadas exitosamente.

Email: ${I.email}
Contraseña: ${I.password}

La empresa ya puede acceder a su panel de gestión.`),await $(),v(!1),A({email:"",password:"",confirmPassword:""}),c(null)}catch(K){console.error("Error asignando credenciales:",K),alert("Error al asignar credenciales: "+K.message)}finally{S(!1)}},Q=()=>{const ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#$%";let K="";for(let Ge=0;Ge<12;Ge++)K+=ne.charAt(Math.floor(Math.random()*ne.length));A(Ge=>({...Ge,password:K,confirmPassword:K}))},te=async ne=>{if(!ne)return E({existe:!1,error:"No se proporcionó URL"}),D(K=>({...K,web_validada:!1,crear_perfil_publico:!0})),null;P(!0);try{let K=ne.trim();if(!K.startsWith("http://")&&!K.startsWith("https://")&&(K=`https://${K}`),!/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/i.test(K)){const et={existe:!1,error:"Formato de URL inválido"};return E(et),D(Ue=>({...Ue,web_validada:!1,crear_perfil_publico:!0})),et}await new Promise(et=>setTimeout(et,2e3));const Ke=K.includes(".cl")||K.includes(".com")||K.includes(".net")||K.includes(".org"),Ze={existe:Ke,respondiendo:Ke&&Math.random()>.2,url_normalizada:K,fecha_validacion:new Date,tiempo_respuesta:Math.round(Math.random()*2e3)+500,codigo_respuesta:Ke?Math.random()>.1?200:404:null};return E(Ze),D(et=>({...et,web_validada:Ze.existe&&Ze.respondiendo,crear_perfil_publico:!Ze.existe||!Ze.respondiendo,tiene_web:Ze.existe&&Ze.respondiendo})),Ze}catch(K){const Ge={existe:!1,error:"Error validando sitio web: "+K.message};return E(Ge),D(Ke=>({...Ke,web_validada:!1,crear_perfil_publico:!0})),Ge}finally{P(!1)}},se=async()=>{try{S(!0),await ze(Ne(F,"solicitudes_empresa",l.id),{descripcion_completa:k.descripcion_completa,anos_funcionamiento:k.anos_funcionamiento,redes_sociales:k.redes_sociales,logo_url:k.logo_url,servicios_completos:k.servicios,marcas_trabajadas:k.marcas_trabajadas,horarios_detallados:k.horarios,web_validada:k.web_validada,validacion_web:y,requiere_perfil_publico:k.crear_perfil_publico,revision_completada:!0,fecha_revision:new Date,admin_revisor:a==null?void 0:a.email,fecha_ultima_actualizacion:new Date}),alert("Datos de revisión guardados exitosamente"),await $(),x(!1)}catch(ne){console.error("Error guardando datos de revisión:",ne),alert("Error al guardar los datos de revisión")}finally{S(!1)}},X=async()=>{try{S(!0),await se(),await V(l.id,"activada","Activada con perfil completo desde revisión"),await z(l.id),x(!1),d(!1),window.confirm("¿Deseas asignar credenciales de acceso para que la empresa pueda gestionar su información?")&&(A({email:l.email_empresa||"",password:"",confirmPassword:""}),v(!0))}catch(ne){console.error("Error activando con perfil completo:",ne),alert("Error al activar la empresa")}finally{S(!1)}},ye=ne=>{const K=gh.find(Ge=>Ge.value===ne);return(K==null?void 0:K.color)||"gray"},Y=async()=>{try{console.log("🧪 DEBUG: Creando solicitud de prueba...");const ne={nombre_empresa:"Empresa Debug Test",email_empresa:"debug@test.com",telefono_empresa:"123456789",direccion_empresa:"Calle Debug 123",web_actual:"https://debug.com",comuna:"Santiago",region:"Metropolitana",categoria:"Tecnología",descripcion_empresa:"Empresa de prueba para debug",anos_funcionamiento:"5",logo_url:"",redes_sociales:{facebook:"",instagram:"",linkedin:"",twitter:""},representante:{nombres_representante:"Juan",apellidos_representante:"Pérez",email_representante:"juan@debug.com",telefono_representante:"987654321",cargo_representante:"Gerente"},fecha_solicitud:new Date,fecha_registro:new Date,fecha_actualizacion:new Date,estado:"pendiente",origen:"debug_admin"};console.log("🧪 DEBUG: Datos de solicitud de prueba:",ne);const K=normalizeSolicitudData(ne);console.log("🧪 DEBUG: Datos normalizados:",K),console.log("🧪 DEBUG: fecha_solicitud:",K.fecha_solicitud);const Ge=await ot(W(F,"solicitudes_empresa"),K);console.log("✅ DEBUG: Solicitud de prueba creada con ID:",Ge.id),alert("Solicitud de prueba creada exitosamente!"),await $()}catch(ne){console.error("❌ ERROR creando solicitud de prueba:",ne),alert("Error creando solicitud de prueba: "+ne.message)}},Se={total:e.length,pendientes:e.filter(ne=>ne.estado==="pendiente").length,en_revision:e.filter(ne=>ne.estado==="en_revision").length,activadas:e.filter(ne=>ne.estado==="activada").length,credenciales_asignadas:e.filter(ne=>ne.estado==="credenciales_asignadas").length,rechazadas:e.filter(ne=>ne.estado==="rechazada").length};return r?t.createElement("div",{className:"flex items-center justify-center p-8"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),t.createElement("p",{className:"text-gray-600"},"Cargando solicitudes..."))):t.createElement("div",{className:"p-6"},t.createElement("div",{className:"mb-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Solicitudes de Registro"),t.createElement("p",{className:"text-gray-600 mb-3"},"Gestiona las solicitudes de registro de nuevas empresas y proveedores en un flujo de dos etapas:"),t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},t.createElement("div",null,t.createElement("h4",{className:"font-medium text-blue-900 mb-2"},"🎯 Primera Etapa: Activación"),t.createElement("p",{className:"text-blue-700"},"Revisar y activar la solicitud para que la empresa sea visible en el home y los usuarios puedan encontrarla.")),t.createElement("div",null,t.createElement("h4",{className:"font-medium text-purple-900 mb-2"},"🔑 Segunda Etapa: Credenciales"),t.createElement("p",{className:"text-purple-700"},"Asignar email y contraseña para que la empresa pueda acceder a su panel y gestionar su información."))))),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6"},t.createElement("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-gray-800"},Se.total),t.createElement("div",{className:"text-gray-600 text-sm"},"Total")),t.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-yellow-800"},Se.pendientes),t.createElement("div",{className:"text-yellow-600 text-sm"},"Pendientes")),t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-blue-800"},Se.en_revision),t.createElement("div",{className:"text-blue-600 text-sm"},"En Revisión")),t.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-green-800"},Se.activadas),t.createElement("div",{className:"text-green-600 text-sm"},"Activadas")),t.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-purple-800"},Se.credenciales_asignadas),t.createElement("div",{className:"text-purple-600 text-sm"},"Con Credenciales")),t.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-red-800"},Se.rechazadas),t.createElement("div",{className:"text-red-600 text-sm"},"Rechazadas"))),t.createElement("div",{className:"mb-6"},t.createElement("button",{onClick:Y,className:"bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg text-sm font-medium"},"🧪 Crear Solicitud de Prueba (Debug)")),t.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Estado"),t.createElement("select",{value:o.estado,onChange:ne=>i(K=>({...K,estado:ne.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},gh.map(ne=>t.createElement("option",{key:ne.value,value:ne.value},ne.label)))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Buscar"),t.createElement("input",{type:"text",value:o.busqueda,onChange:ne=>i(K=>({...K,busqueda:ne.target.value})),placeholder:"Nombre empresa, email, representante...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",{className:"flex items-end"},t.createElement("button",{onClick:()=>i({estado:"",busqueda:"",fechaDesde:"",fechaHasta:""}),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors"},"Limpiar Filtros")))),w&&t.createElement("div",{className:"mb-6"},t.createElement("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"},"➕ Crear Nueva Solicitud (Agente de Campo)")),t.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},t.createElement("div",{className:"overflow-x-auto"},t.createElement("table",{className:"min-w-full"},t.createElement("thead",{className:"bg-gray-50"},t.createElement("tr",null,t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Empresa"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Representante"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Fecha"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Días"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Origen"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),t.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},q.map(ne=>{var K,Ge,Ke,Ze,et;return t.createElement("tr",{key:ne.id,className:"hover:bg-gray-50"},t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("div",null,t.createElement("div",{className:"text-sm font-medium text-gray-900"},ne.nombre_empresa),t.createElement("div",{className:"text-sm text-gray-500"},ne.email_empresa),ne.web_actual&&t.createElement("div",{className:"text-sm text-blue-600"},"🌐 ",ne.web_actual))),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("div",{className:"text-sm text-gray-900"},ne.nombres_representante||ne.representante_nombre||"No especificado"," ",ne.apellidos_representante||ne.representante_apellidos||""),t.createElement("div",{className:"text-sm text-gray-500"},ne.cargo_representante),t.createElement("div",{className:"text-sm text-gray-500"},"📞 ",ne.telefono_representante)),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full
                      ${ye(ne.estado)==="yellow"?"bg-yellow-100 text-yellow-800":""}
                      ${ye(ne.estado)==="blue"?"bg-blue-100 text-blue-800":""}
                      ${ye(ne.estado)==="green"?"bg-green-100 text-green-800":""}
                      ${ye(ne.estado)==="red"?"bg-red-100 text-red-800":""}
                      ${ye(ne.estado)==="gray"?"bg-gray-100 text-gray-800":""}
                    `},((K=gh.find(Ue=>Ue.value===ne.estado))==null?void 0:K.label)||ne.estado)),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},((Ze=(Ke=(Ge=ne.fecha_solicitud)==null?void 0:Ge.toDate)==null?void 0:Ke.call(Ge))==null?void 0:Ze.toLocaleDateString())||"N/A"),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},(()=>{var Rt,lt,Dt,ut;const Ue=((lt=(Rt=ne.fecha_solicitud)==null?void 0:Rt.toDate)==null?void 0:lt.call(Rt))||((ut=(Dt=ne.fecha_registro)==null?void 0:Dt.toDate)==null?void 0:ut.call(Dt));return Ue?Math.floor((new Date-Ue)/(1e3*60*60*24))+" días":"N/A"})()),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ne.origen||((et=ne.datos_solicitud)==null?void 0:et.origen)||"N/A"),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm space-x-2"},t.createElement("button",{onClick:()=>{c(ne),d(!0)},className:"text-blue-600 hover:text-blue-800 underline"},"Ver Detalles")))})))),q.length===0&&t.createElement("div",{className:"text-center py-8"},t.createElement("p",{className:"text-gray-500"},"No hay solicitudes que coincidan con los filtros"))),u&&l&&t.createElement("div",{className:"fixed inset-0 z-50 flex"},t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-40 transition-opacity",onClick:()=>d(!1)}),t.createElement("div",{className:"relative ml-auto w-full max-w-2xl h-full bg-white shadow-2xl flex flex-col animate-slideInRight"},t.createElement("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 p-6 flex justify-between items-center"},t.createElement("h3",{className:"text-xl font-bold text-blue-900 truncate pr-4"},"Detalles de Solicitud",t.createElement("span",{className:"block text-base font-normal text-gray-700"},l.nombre_empresa)),t.createElement("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600 text-2xl","aria-label":"Cerrar"},"✕")),t.createElement("div",{className:"flex-1 overflow-y-auto p-6 space-y-6"},t.createElement("details",{open:!0,className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},t.createElement("summary",{className:"font-semibold text-blue-900 cursor-pointer mb-2"},"🏢 Información de la Empresa"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm"},t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Nombre:")," ",t.createElement("span",{className:"text-gray-900"},l.nombre_empresa||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"RUT:")," ",t.createElement("span",{className:"text-gray-900"},l.rut_empresa||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Dirección:")," ",t.createElement("span",{className:"text-gray-900"},l.direccion_empresa||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Comuna:")," ",t.createElement("span",{className:"text-gray-900"},l.comuna||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Región:")," ",t.createElement("span",{className:"text-gray-900"},l.region||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Teléfono:")," ",t.createElement("span",{className:"text-gray-900"},l.telefono_empresa||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Email:")," ",t.createElement("span",{className:"text-gray-900"},l.email_empresa||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Sitio Web:")," ",t.createElement("span",{className:"text-gray-900"},l.web_actual?t.createElement("a",{href:l.web_actual,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},l.web_actual):"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Rubro:")," ",t.createElement("span",{className:"text-gray-900"},l.rubro||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Tipo de empresa:")," ",t.createElement("span",{className:"text-gray-900"},l.tipoEmpresa||"No especificado")))),t.createElement("details",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},t.createElement("summary",{className:"font-semibold text-green-900 cursor-pointer mb-2"},"👤 Representante Legal"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm"},t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Nombres:")," ",t.createElement("span",{className:"text-gray-900"},l.nombres_representante||((de=l.representante)==null?void 0:de.nombre)||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Apellidos:")," ",t.createElement("span",{className:"text-gray-900"},l.apellidos_representante||((oe=l.representante)==null?void 0:oe.apellidos)||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"RUT:")," ",t.createElement("span",{className:"text-gray-900"},l.rut_representante||((ge=l.representante)==null?void 0:ge.rut_representante)||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Cargo:")," ",t.createElement("span",{className:"text-gray-900"},l.cargo_representante||((me=l.representante)==null?void 0:me.cargo)||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Fecha de nacimiento:")," ",t.createElement("span",{className:"text-gray-900"},l.fecha_nacimiento_representante||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Email:")," ",t.createElement("span",{className:"text-gray-900"},l.email_representante||((he=l.representante)==null?void 0:he.email)||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Teléfono:")," ",t.createElement("span",{className:"text-gray-900"},l.telefono_representante||((G=l.representante)==null?void 0:G.telefono)||"No especificado")))),t.createElement("details",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4"},t.createElement("summary",{className:"font-semibold text-purple-900 cursor-pointer mb-2"},"💼 Información del Negocio"),t.createElement("div",{className:"space-y-3 text-sm"},t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Descripción:")," ",t.createElement("span",{className:"text-gray-900"},l.descripcionCompleta||((we=l.datos_solicitud)==null?void 0:we.descripcion)||"No especificado")),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Años de funcionamiento:")," ",t.createElement("span",{className:"text-gray-900"},l.anos_funcionamiento||((Te=l.datos_solicitud)==null?void 0:Te.anos_funcionamiento)||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Número de empleados:")," ",t.createElement("span",{className:"text-gray-900"},l.numero_empleados||((B=l.datos_solicitud)==null?void 0:B.numero_empleados)||"No especificado"))))),t.createElement("details",{className:"bg-pink-50 border border-pink-200 rounded-lg p-4"},t.createElement("summary",{className:"font-semibold text-pink-900 cursor-pointer mb-2"},"📸 Archivos Multimedia"),t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("h5",{className:"font-medium text-gray-700 mb-2"},"Logo de la empresa:"),l.logo||(ve=l.datos_solicitud)!=null&&ve.logo_file_data?t.createElement("div",{className:"bg-white p-2 rounded border"},t.createElement("img",{src:l.logo||((_e=(je=l.datos_solicitud)==null?void 0:je.logo_file_data)==null?void 0:_e.base64),alt:"Logo empresa",className:"h-16 w-16 object-cover rounded border"}),((H=l.datos_solicitud)==null?void 0:H.logo_file_data)&&t.createElement("p",{className:"text-xs text-gray-600 mt-1"},l.datos_solicitud.logo_file_data.name,"(",(l.datos_solicitud.logo_file_data.size/1024/1024).toFixed(2)," MB)")):t.createElement("p",{className:"text-gray-600 text-sm"},"No hay logo subido")),t.createElement("div",null,t.createElement("h5",{className:"font-medium text-gray-700 mb-2"},"Galería de imágenes:"),l.galeria&&l.galeria.length>0||(Pe=l.datos_solicitud)!=null&&Pe.galeria_files_data&&l.datos_solicitud.galeria_files_data.length>0?t.createElement("div",{className:"grid grid-cols-3 gap-2"},(l.galeria||((it=(Ye=l.datos_solicitud)==null?void 0:Ye.galeria_files_data)==null?void 0:it.map(ne=>ne.base64))||[]).map((ne,K)=>t.createElement("img",{key:K,src:ne,alt:`Galería ${K+1}`,className:"h-16 w-16 object-cover rounded border"}))):t.createElement("p",{className:"text-gray-600 text-sm"},"No hay imágenes en la galería")))),t.createElement("details",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4"},t.createElement("summary",{className:"font-semibold text-gray-900 cursor-pointer mb-2"},"📋 Términos y Control"),t.createElement("div",{className:"space-y-2 text-sm"},t.createElement("div",{className:"flex items-center"},t.createElement("span",{className:`w-4 h-4 mr-2 rounded ${((mt=l.datos_solicitud)==null?void 0:mt.acepta_terminos)??l.acepta_terminos?"bg-green-500":"bg-red-500"}`}),t.createElement("span",null,"Acepta términos y condiciones: ",((be=l.datos_solicitud)==null?void 0:be.acepta_terminos)??l.acepta_terminos?"Sí":"No")),t.createElement("div",{className:"flex items-center"},t.createElement("span",{className:`w-4 h-4 mr-2 rounded ${((Re=l.datos_solicitud)==null?void 0:Re.acepta_notificaciones)??l.acepta_notificaciones?"bg-green-500":"bg-red-500"}`}),t.createElement("span",null,"Acepta notificaciones: ",((qe=l.datos_solicitud)==null?void 0:qe.acepta_notificaciones)??l.acepta_notificaciones?"Sí":"No")),t.createElement("div",{className:"flex items-center"},t.createElement("span",{className:`w-4 h-4 mr-2 rounded ${((Me=l.datos_solicitud)==null?void 0:Me.acepta_visita_agente)??l.acepta_visita_campo?"bg-green-500":"bg-red-500"}`}),t.createElement("span",null,"Acepta visita de agente: ",((Xe=l.datos_solicitud)==null?void 0:Xe.acepta_visita_agente)??l.acepta_visita_campo?"Sí":"No")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Estado actual:")," ",t.createElement("span",{className:"text-gray-900"},l.estado||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Etapa del proceso:")," ",t.createElement("span",{className:"text-gray-900"},l.etapa_proceso||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Fecha de registro:")," ",t.createElement("span",{className:"text-gray-900"},((ea=(ca=(ft=l.fecha_registro)==null?void 0:ft.toDate)==null?void 0:ca.call(ft))==null?void 0:ea.toLocaleDateString())||(($t=(He=(Tt=l.fecha_solicitud)==null?void 0:Tt.toDate)==null?void 0:He.call(Tt))==null?void 0:$t.toLocaleDateString())||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Admin activador:")," ",t.createElement("span",{className:"text-gray-900"},l.admin_activador||"Pendiente")),l.comentario_admin&&t.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mt-2"},t.createElement("span",{className:"font-semibold text-red-900"},"💬 Comentarios del Administrador:"),t.createElement("p",{className:"text-sm text-red-800 bg-white p-2 rounded border mt-1"},l.comentario_admin))))),t.createElement("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 p-4 flex justify-end space-x-3"},t.createElement("button",{onClick:()=>d(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400"},"Cerrar"),l.estado==="en_revision"&&t.createElement("button",{onClick:X,disabled:C,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50"},"🎯 Activar empresa"),l.estado==="pendiente"&&t.createElement("button",{onClick:async()=>{S(!0);try{await V(l.id,"en_revision","Solicitud pasada a revisión por el administrador."),await $(),d(!1)}catch(ne){alert("Error al pasar a revisión: "+ne.message)}finally{S(!1)}},disabled:C,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"},"🔍 Pasar a revisión"),l.estado==="activada"&&t.createElement("button",{onClick:()=>v(!0),disabled:C,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:opacity-50"},"🔑 Asignar Credenciales")))),b&&l&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},t.createElement("div",{className:"flex justify-between items-center mb-4"},t.createElement("h3",{className:"text-lg font-semibold"},"Asignar Credenciales: ",l.nombre_empresa),t.createElement("button",{onClick:()=>{v(!1),A({email:"",password:"",confirmPassword:""})},className:"text-gray-400 hover:text-gray-600"},"✕")),t.createElement("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg"},t.createElement("p",{className:"text-blue-800 text-sm"},t.createElement("strong",null,"Segunda etapa del proceso:"),t.createElement("br",null),"Asigna un email y contraseña para que la empresa pueda acceder a su panel de administración y gestionar su información, campañas, horarios, etc.")),t.createElement("div",{className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email de acceso"),t.createElement("input",{type:"email",value:I.email,onChange:ne=>A(K=>({...K,email:ne.target.value})),placeholder:"email@empresa.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"}),t.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Recomendado: usar el email del representante legal")),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña"),t.createElement("div",{className:"flex space-x-2"},t.createElement("input",{type:"text",value:I.password,onChange:ne=>A(K=>({...K,password:ne.target.value})),placeholder:"Contraseña",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"}),t.createElement("button",{type:"button",onClick:Q,className:"px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-sm"},"🎲 Generar"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirmar contraseña"),t.createElement("input",{type:"text",value:I.confirmPassword,onChange:ne=>A(K=>({...K,confirmPassword:ne.target.value})),placeholder:"Confirmar contraseña",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})),I.password&&I.password!==I.confirmPassword&&t.createElement("p",{className:"text-red-600 text-sm"},"Las contraseñas no coinciden")),t.createElement("div",{className:"flex justify-end space-x-3 mt-6"},t.createElement("button",{onClick:()=>{v(!1),A({email:"",password:"",confirmPassword:""})},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",disabled:C},"Cancelar"),t.createElement("button",{onClick:()=>U(l.id),disabled:C||!I.email||!I.password||I.password!==I.confirmPassword,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:opacity-50"},C?"Asignando...":"🔑 Asignar Credenciales")))),m&&t.createElement(k8,{onClose:()=>h(!1),onSuccess:()=>{h(!1),$()},esAgente:w,agenteEmail:a==null?void 0:a.email}),N&&l&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},t.createElement("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto"},t.createElement("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6"},t.createElement("div",{className:"flex justify-between items-center"},t.createElement("h3",{className:"text-xl font-semibold"},"🔍 Revisión Avanzada: ",l.nombre_empresa),t.createElement("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600 text-xl"},"✕"))),t.createElement("div",{className:"p-6 space-y-6"},t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},t.createElement("h4",{className:"font-medium text-blue-900 mb-3"},"🌐 Validación de Página Web"),l.web_actual?t.createElement("div",{className:"space-y-3"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("span",{className:"text-sm font-medium"},"URL: ",l.web_actual),t.createElement("button",{onClick:()=>te(l.web_actual),disabled:_,className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 disabled:opacity-50"},_?"🔄 Validando...":"🔍 Validar")),y&&t.createElement("div",{className:`p-3 rounded border ${y.existe&&y.respondiendo?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`},t.createElement("p",{className:`text-sm font-medium ${y.existe&&y.respondiendo?"text-green-800":"text-red-800"}`},y.existe&&y.respondiendo?"✅ Sitio web válido y funcionando":"❌ Sitio web no disponible"),y.error&&t.createElement("p",{className:"text-red-600 text-xs mt-1"},y.error),y.tiempo_respuesta&&t.createElement("p",{className:"text-gray-600 text-xs mt-1"},"Tiempo de respuesta: ",y.tiempo_respuesta,"ms"))):t.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-3"},t.createElement("p",{className:"text-yellow-800 text-sm font-medium"},"⚠️ Esta empresa no tiene página web registrada. Se creará un perfil público detallado."))),t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},t.createElement("div",{className:"space-y-4"},t.createElement("h4",{className:"font-medium text-gray-900"},"📋 Información Comercial"),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Descripción Completa"),t.createElement("textarea",{value:k.descripcion_completa,onChange:ne=>D(K=>({...K,descripcion_completa:ne.target.value})),rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Descripción detallada de la empresa y sus servicios..."})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Años de Funcionamiento"),t.createElement("select",{value:k.anos_funcionamiento,onChange:ne=>D(K=>({...K,anos_funcionamiento:ne.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:""},"Seleccionar..."),t.createElement("option",{value:"menos_1"},"Menos de 1 año"),t.createElement("option",{value:"1_2"},"1-2 años"),t.createElement("option",{value:"3_5"},"3-5 años"),t.createElement("option",{value:"6_10"},"6-10 años"),t.createElement("option",{value:"11_20"},"11-20 años"),t.createElement("option",{value:"mas_20"},"Más de 20 años"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"URL del Logo"),t.createElement("input",{type:"url",value:k.logo_url,onChange:ne=>D(K=>({...K,logo_url:ne.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://ejemplo.com/logo.png"}))),t.createElement("div",{className:"space-y-4"},t.createElement("h4",{className:"font-medium text-gray-900"},"📱 Redes Sociales"),t.createElement("div",{className:"space-y-3"},t.createElement("input",{type:"url",value:k.redes_sociales.facebook,onChange:ne=>D(K=>({...K,redes_sociales:{...K.redes_sociales,facebook:ne.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Facebook - https://facebook.com/empresa"}),t.createElement("input",{type:"url",value:k.redes_sociales.instagram,onChange:ne=>D(K=>({...K,redes_sociales:{...K.redes_sociales,instagram:ne.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Instagram - https://instagram.com/empresa"}),t.createElement("input",{type:"url",value:k.redes_sociales.linkedin,onChange:ne=>D(K=>({...K,redes_sociales:{...K.redes_sociales,linkedin:ne.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"LinkedIn - https://linkedin.com/company/empresa"}),t.createElement("input",{type:"url",value:k.redes_sociales.twitter,onChange:ne=>D(K=>({...K,redes_sociales:{...K.redes_sociales,twitter:ne.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Twitter - https://twitter.com/empresa"})),t.createElement("div",{className:"border-t pt-4"},t.createElement("h5",{className:"font-medium text-gray-900 mb-3"},"⚙️ Configuración del Perfil"),t.createElement("div",{className:"space-y-2"},t.createElement("label",{className:"flex items-center"},t.createElement("input",{type:"checkbox",checked:k.crear_perfil_publico,onChange:ne=>D(K=>({...K,crear_perfil_publico:ne.target.checked})),className:"mr-2"}),t.createElement("span",{className:"text-sm"},"Crear perfil público detallado")),t.createElement("label",{className:"flex items-center"},t.createElement("input",{type:"checkbox",checked:k.web_validada,onChange:ne=>D(K=>({...K,web_validada:ne.target.checked})),className:"mr-2"}),t.createElement("span",{className:"text-sm"},"Página web validada y funcionando")))))),t.createElement("div",{className:"border-t pt-6"},t.createElement("h4",{className:"font-medium text-gray-900 mb-4"},"🕒 Horarios de Atención"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-7 gap-4"},Object.entries(k.horarios).map(([ne,K])=>t.createElement("div",{key:ne,className:"border border-gray-200 rounded p-3"},t.createElement("label",{className:"flex items-center mb-2"},t.createElement("input",{type:"checkbox",checked:K.activo,onChange:Ge=>D(Ke=>({...Ke,horarios:{...Ke.horarios,[ne]:{...Ke.horarios[ne],activo:Ge.target.checked}}})),className:"mr-2"}),t.createElement("span",{className:"text-sm font-medium capitalize"},ne)),K.activo&&t.createElement("div",{className:"space-y-2"},t.createElement("input",{type:"time",value:K.inicio,onChange:Ge=>D(Ke=>({...Ke,horarios:{...Ke.horarios,[ne]:{...Ke.horarios[ne],inicio:Ge.target.value}}})),className:"w-full text-xs border border-gray-300 rounded px-2 py-1"}),t.createElement("input",{type:"time",value:K.fin,onChange:Ge=>D(Ke=>({...Ke,horarios:{...Ke.horarios,[ne]:{...Ke.horarios[ne],fin:Ge.target.value}}})),className:"w-full text-xs border border-gray-300 rounded px-2 py-1"}))))))),t.createElement("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 p-6 flex justify-end space-x-3"},t.createElement("button",{onClick:()=>x(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400"},"Cancelar"),t.createElement("button",{onClick:se,disabled:C,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"},"💾 Guardar Revisión"),t.createElement("button",{onClick:X,disabled:C,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50"},"🎯 Activar con Perfil Completo")))))}function k8({onClose:a,onSuccess:e,esAgente:n,agenteEmail:r}){const[s,o]=p.useState({nombre_empresa:"",rut_empresa:"",direccion_empresa:"",comuna:"",region:"",telefono_empresa:"",email_empresa:"",web_actual:"",categoria:"",representante_nombre:"",representante_apellidos:"",cargo_representante:"",email_representante:"",telefono_representante:"",descripcion:"",necesita_pagina_web:!1,activacion_directa:!1}),[i,l]=p.useState(!1),c=m=>{const{name:h,value:C,type:S,checked:w}=m.target;o(f=>({...f,[h]:S==="checkbox"?w:C}))},u=async m=>{if(m.preventDefault(),!s.nombre_empresa||!s.email_empresa||!s.representante_nombre){alert("Por favor, completa al menos los campos obligatorios");return}try{l(!0);const h={...s,estado:n&&s.activacion_directa?"activada":"pendiente",fecha_solicitud:new Date,fecha_ultima_actualizacion:new Date,creado_por:r,es_agente_campo:n,origen:n?"agente_campo":"web"},C=await ot(W(F,"solicitudes_empresa"),h);n&&s.activacion_directa&&await d(C.id,h),alert(n&&s.activacion_directa?"Solicitud creada y empresa activada (visible en home). Pendiente asignar credenciales.":"Solicitud creada exitosamente"),e()}catch(h){console.error("Error creando solicitud:",h),alert("Error al crear la solicitud")}finally{l(!1)}},d=async(m,h)=>{try{const C={nombre:h.nombre_empresa,email:h.email_empresa,telefono:h.telefono_empresa,direccion:h.direccion_empresa,comuna:h.comuna,region:h.region,rut:h.rut_empresa,web:h.web_actual||"",representante:{nombre:h.nombres_representante||h.representante_nombre||"",apellidos:h.apellidos_representante||h.representante_apellidos||"",cargo:h.cargo_representante||"",email:h.email_representante||"",telefono:h.telefono_representante||""},estado:"activa",etapa_proceso:"activada_sin_credenciales",categoria:h.categoria||"Sin categoría",fecha_registro:new Date,fecha_activacion:new Date,admin_activador:r,solicitud_origen_id:m,logoAsignado:!1,webValidada:!!h.web_actual,perfilCompleto:!1,tiene_credenciales_asignadas:!1,usuario_empresa:null,horarios:{lunes:{activo:!0,inicio:"09:00",fin:"18:00"},martes:{activo:!0,inicio:"09:00",fin:"18:00"},miercoles:{activo:!0,inicio:"09:00",fin:"18:00"},jueves:{activo:!0,inicio:"09:00",fin:"18:00"},viernes:{activo:!0,inicio:"09:00",fin:"18:00"},sabado:{activo:!1,inicio:"09:00",fin:"13:00"},domingo:{activo:!1,inicio:"10:00",fin:"14:00"}}};await ot(W(F,"empresas"),C),console.log("Empresa activada directamente por agente (primera etapa completada)")}catch(C){throw console.error("Error creando empresa desde activación directa:",C),C}};return t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},t.createElement("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-96 overflow-y-auto"},t.createElement("div",{className:"p-6"},t.createElement("div",{className:"flex justify-between items-center mb-6"},t.createElement("h3",{className:"text-xl font-semibold"},n?"Nueva Solicitud - Agente de Campo":"Nueva Solicitud de Empresa"),t.createElement("button",{onClick:a,className:"text-gray-400 hover:text-gray-600"},"✕")),t.createElement("form",{onSubmit:u,className:"space-y-6"},t.createElement("div",null,t.createElement("h4",{className:"text-lg font-medium text-gray-900 mb-4"},"Información de la Empresa"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombre de la empresa *"),t.createElement("input",{type:"text",name:"nombre_empresa",value:s.nombre_empresa,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"RUT de la empresa"),t.createElement("input",{type:"text",name:"rut_empresa",value:s.rut_empresa,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"12.345.678-9"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email de la empresa *"),t.createElement("input",{type:"email",name:"email_empresa",value:s.email_empresa,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono"),t.createElement("input",{type:"tel",name:"telefono_empresa",value:s.telefono_empresa,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Dirección"),t.createElement("input",{type:"text",name:"direccion_empresa",value:s.direccion_empresa,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Comuna"),t.createElement("input",{type:"text",name:"comuna",value:s.comuna,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Sitio web actual"),t.createElement("input",{type:"url",name:"web_actual",value:s.web_actual,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://ejemplo.com"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Categoría"),t.createElement("select",{name:"categoria",value:s.categoria,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:""},"Seleccionar categoría"),t.createElement("option",{value:"Repuestos"},"Repuestos"),t.createElement("option",{value:"Servicios"},"Servicios"),t.createElement("option",{value:"Talleres"},"Talleres"),t.createElement("option",{value:"Seguros"},"Seguros"),t.createElement("option",{value:"Venta de Vehículos"},"Venta de Vehículos"),t.createElement("option",{value:"Otros"},"Otros"))))),t.createElement("div",null,t.createElement("h4",{className:"text-lg font-medium text-gray-900 mb-4"},"Representante Legal"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombres *"),t.createElement("input",{type:"text",name:"representante_nombre",value:s.representante_nombre,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Apellidos"),t.createElement("input",{type:"text",name:"representante_apellidos",value:s.representante_apellidos,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Cargo"),t.createElement("input",{type:"text",name:"cargo_representante",value:s.cargo_representante,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Gerente General, Propietario"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email del representante"),t.createElement("input",{type:"email",name:"email_representante",value:s.email_representante,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Descripción de la empresa"),t.createElement("textarea",{name:"descripcion",value:s.descripcion,onChange:c,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe brevemente la actividad de la empresa..."})),n&&t.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4"},t.createElement("h4",{className:"text-lg font-medium text-purple-900 mb-3"},"Opciones de Agente de Campo"),t.createElement("div",{className:"space-y-2"},t.createElement("div",{className:"flex items-center"},t.createElement("input",{type:"checkbox",id:"activacion_directa",name:"activacion_directa",checked:s.activacion_directa,onChange:c,className:"rounded"}),t.createElement("label",{htmlFor:"activacion_directa",className:"ml-2 text-sm text-purple-800"},t.createElement("strong",null,"Activar empresa inmediatamente")," (para empresas validadas en terreno)")),t.createElement("p",{className:"text-xs text-purple-700"},"⚠️ Solo marca esta opción si has verificado personalmente la empresa y sus datos"))),t.createElement("div",{className:"flex justify-end space-x-3 pt-4 border-t"},t.createElement("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",disabled:i},"Cancelar"),t.createElement("button",{type:"submit",disabled:i,className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"},i?"Creando...":s.activacion_directa?"Crear y Activar":"Crear Solicitud"))))))}const I8=()=>{const{rol:a}=ht(),[e,n]=p.useState([]),[r,s]=p.useState("todos"),[o,i]=p.useState(!1),[l,c]=p.useState({}),u={proveedor:{nombre:"Proveedor",color:"blue",descripcion:"Empresa proveedora estándar",icon:"🏪"},local:{nombre:"Local",color:"green",descripcion:"Negocio local de la zona",icon:"🏪"},pyme:{nombre:"PyME",color:"yellow",descripcion:"Pequeña y Mediana Empresa",icon:"🏢"},emprendimiento:{nombre:"Emprendimiento",color:"purple",descripcion:"Nuevo emprendimiento",icon:"🚀"},premium:{nombre:"Premium",color:"orange",descripcion:"Proveedor premium verificado",icon:"⭐"}};p.useEffect(()=>{const S=wa(fe(W(F,"empresas"),pe("estado","==","activa")),w=>{const f=w.docs.map(b=>({id:b.id,...b.data()}));n(f),d(f)});return()=>S()},[]);const d=S=>{const w={};Object.keys(u).forEach(f=>{w[f]=S.filter(b=>(b.tipoEmpresa||"").toLowerCase()===f||f==="local"&&b.esLocal||f==="pyme"&&b.esPyme||f==="emprendimiento"&&b.esEmprendimiento||f==="premium"&&b.esPremium).length}),w.total=S.length,w.sinTipo=S.filter(f=>!f.tipoEmpresa).length,c(w)},m=async(S,w)=>{try{i(!0);const f={tipoEmpresa:w,fechaActualizacion:new Date};switch(f.esLocal=!1,f.esPyme=!1,f.esEmprendimiento=!1,f.esPremium=!1,w){case"local":f.esLocal=!0;break;case"pyme":f.esPyme=!0;break;case"emprendimiento":f.esEmprendimiento=!0;break;case"premium":f.esPremium=!0;break}await ze(Ne(F,"empresas",S),f)}catch(f){console.error("Error actualizando tipo de empresa:",f),alert("Error al actualizar el tipo de empresa")}finally{i(!1)}},h=e.filter(S=>r==="todos"?!0:r==="sinTipo"?!S.tipoEmpresa:(S.tipoEmpresa||"").toLowerCase()===r||r==="local"&&S.esLocal||r==="pyme"&&S.esPyme||r==="emprendimiento"&&S.esEmprendimiento||r==="premium"&&S.esPremium),C=S=>({proveedor:"bg-blue-100 text-blue-800",local:"bg-green-100 text-green-800",pyme:"bg-yellow-100 text-yellow-800",emprendimiento:"bg-purple-100 text-purple-800",premium:"bg-orange-100 text-orange-800"})[S]||"bg-gray-100 text-gray-800";return a!=="admin"?t.createElement("div",{className:"text-center p-8"},t.createElement("p",{className:"text-red-600"},"Solo administradores pueden gestionar tipos de empresa")):t.createElement("div",{className:"max-w-7xl mx-auto p-6"},t.createElement("div",{className:"bg-white rounded-lg shadow-lg"},t.createElement("div",{className:"p-6 border-b"},t.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"🏢 Gestión de Tipos de Empresa"),t.createElement("p",{className:"text-gray-600 mt-2"},"Administra y categoriza las empresas según su tipo")),t.createElement("div",{className:"p-6 border-b"},t.createElement("h2",{className:"text-lg font-semibold mb-4"},"📊 Estadísticas"),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4"},t.createElement("div",{className:"bg-gray-50 p-4 rounded-lg text-center"},t.createElement("div",{className:"text-2xl font-bold text-gray-700"},l.total),t.createElement("div",{className:"text-sm text-gray-600"},"Total")),Object.entries(u).map(([S,w])=>t.createElement("div",{key:S,className:"bg-gray-50 p-4 rounded-lg text-center"},t.createElement("div",{className:"text-xl mb-1"},w.icon),t.createElement("div",{className:"text-2xl font-bold text-gray-700"},l[S]||0),t.createElement("div",{className:"text-sm text-gray-600"},w.nombre))),t.createElement("div",{className:"bg-red-50 p-4 rounded-lg text-center"},t.createElement("div",{className:"text-2xl font-bold text-red-600"},l.sinTipo||0),t.createElement("div",{className:"text-sm text-red-600"},"Sin Tipo")))),t.createElement("div",{className:"p-6 border-b"},t.createElement("h2",{className:"text-lg font-semibold mb-4"},"🔍 Filtros"),t.createElement("div",{className:"flex flex-wrap gap-2"},t.createElement("button",{onClick:()=>s("todos"),className:`px-4 py-2 rounded text-sm font-medium ${r==="todos"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Todas (",l.total,")"),Object.entries(u).map(([S,w])=>t.createElement("button",{key:S,onClick:()=>s(S),className:`px-4 py-2 rounded text-sm font-medium ${r===S?`bg-${w.color}-600 text-white`:`bg-${w.color}-100 text-${w.color}-700 hover:bg-${w.color}-200`}`},w.icon," ",w.nombre," (",l[S]||0,")")),t.createElement("button",{onClick:()=>s("sinTipo"),className:`px-4 py-2 rounded text-sm font-medium ${r==="sinTipo"?"bg-red-600 text-white":"bg-red-100 text-red-700 hover:bg-red-200"}`},"Sin Tipo (",l.sinTipo||0,")"))),t.createElement("div",{className:"p-6"},t.createElement("h2",{className:"text-lg font-semibold mb-4"},"📋 Empresas Filtradas (",h.length,")"),t.createElement("div",{className:"space-y-4"},h.map(S=>{var w,f;return t.createElement("div",{key:S.id,className:"border border-gray-200 rounded-lg p-4"},t.createElement("div",{className:"flex justify-between items-start"},t.createElement("div",{className:"flex-1"},t.createElement("div",{className:"flex items-center space-x-3 mb-2"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},S.nombre),S.tipoEmpresa&&t.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${C(S.tipoEmpresa)}`},(w=u[S.tipoEmpresa])==null?void 0:w.icon," ",(f=u[S.tipoEmpresa])==null?void 0:f.nombre),!S.tipoEmpresa&&t.createElement("span",{className:"px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800"},"Sin Tipo")),t.createElement("div",{className:"text-sm text-gray-600 space-y-1"},t.createElement("div",null,"📍 ",S.direccion,", ",S.ciudad),S.telefono&&t.createElement("div",null,"📞 ",S.telefono),S.email&&t.createElement("div",null,"📧 ",S.email))),t.createElement("div",{className:"ml-4"},t.createElement("select",{value:S.tipoEmpresa||"",onChange:b=>m(S.id,b.target.value),disabled:o,className:"text-sm border border-gray-300 rounded px-3 py-1 focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:""},"Seleccionar tipo"),Object.entries(u).map(([b,v])=>t.createElement("option",{key:b,value:b},v.icon," ",v.nombre))))))}),h.length===0&&t.createElement("div",{className:"text-center py-8"},t.createElement("p",{className:"text-gray-500"},"No hay empresas que coincidan con el filtro seleccionado"))))))};var rT={exports:{}};(function(a,e){(function(n,r){a.exports=r()})(Y_,function(){var n=1e3,r=6e4,s=36e5,o="millisecond",i="second",l="minute",c="hour",u="day",d="week",m="month",h="quarter",C="year",S="date",w="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,b=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function($){var q=["th","st","nd","rd"],V=$%100;return"["+$+(q[(V-20)%10]||q[V]||q[0])+"]"}},I=function($,q,V){var z=String($);return!z||z.length>=q?$:""+Array(q+1-z.length).join(V)+$},A={s:I,z:function($){var q=-$.utcOffset(),V=Math.abs(q),z=Math.floor(V/60),j=V%60;return(q<=0?"+":"-")+I(z,2,"0")+":"+I(j,2,"0")},m:function $(q,V){if(q.date()<V.date())return-$(V,q);var z=12*(V.year()-q.year())+(V.month()-q.month()),j=q.clone().add(z,m),U=V-j<0,Q=q.clone().add(z+(U?-1:1),m);return+(-(z+(V-j)/(U?j-Q:Q-j))||0)},a:function($){return $<0?Math.ceil($)||0:Math.floor($)},p:function($){return{M:m,y:C,w:d,d:u,D:S,h:c,m:l,s:i,ms:o,Q:h}[$]||String($||"").toLowerCase().replace(/s$/,"")},u:function($){return $===void 0}},N="en",x={};x[N]=v;var y="$isDayjsObject",E=function($){return $ instanceof D||!(!$||!$[y])},_=function $(q,V,z){var j;if(!q)return N;if(typeof q=="string"){var U=q.toLowerCase();x[U]&&(j=U),V&&(x[U]=V,j=U);var Q=q.split("-");if(!j&&Q.length>1)return $(Q[0])}else{var te=q.name;x[te]=q,j=te}return!z&&j&&(N=j),j||!z&&N},P=function($,q){if(E($))return $.clone();var V=typeof q=="object"?q:{};return V.date=$,V.args=arguments,new D(V)},k=A;k.l=_,k.i=E,k.w=function($,q){return P($,{locale:q.$L,utc:q.$u,x:q.$x,$offset:q.$offset})};var D=function(){function $(V){this.$L=_(V.locale,null,!0),this.parse(V),this.$x=this.$x||V.x||{},this[y]=!0}var q=$.prototype;return q.parse=function(V){this.$d=function(z){var j=z.date,U=z.utc;if(j===null)return new Date(NaN);if(k.u(j))return new Date;if(j instanceof Date)return new Date(j);if(typeof j=="string"&&!/Z$/i.test(j)){var Q=j.match(f);if(Q){var te=Q[2]-1||0,se=(Q[7]||"0").substring(0,3);return U?new Date(Date.UTC(Q[1],te,Q[3]||1,Q[4]||0,Q[5]||0,Q[6]||0,se)):new Date(Q[1],te,Q[3]||1,Q[4]||0,Q[5]||0,Q[6]||0,se)}}return new Date(j)}(V),this.init()},q.init=function(){var V=this.$d;this.$y=V.getFullYear(),this.$M=V.getMonth(),this.$D=V.getDate(),this.$W=V.getDay(),this.$H=V.getHours(),this.$m=V.getMinutes(),this.$s=V.getSeconds(),this.$ms=V.getMilliseconds()},q.$utils=function(){return k},q.isValid=function(){return this.$d.toString()!==w},q.isSame=function(V,z){var j=P(V);return this.startOf(z)<=j&&j<=this.endOf(z)},q.isAfter=function(V,z){return P(V)<this.startOf(z)},q.isBefore=function(V,z){return this.endOf(z)<P(V)},q.$g=function(V,z,j){return k.u(V)?this[z]:this.set(j,V)},q.unix=function(){return Math.floor(this.valueOf()/1e3)},q.valueOf=function(){return this.$d.getTime()},q.startOf=function(V,z){var j=this,U=!!k.u(z)||z,Q=k.p(V),te=function(ge,me){var he=k.w(j.$u?Date.UTC(j.$y,me,ge):new Date(j.$y,me,ge),j);return U?he:he.endOf(u)},se=function(ge,me){return k.w(j.toDate()[ge].apply(j.toDate("s"),(U?[0,0,0,0]:[23,59,59,999]).slice(me)),j)},X=this.$W,ye=this.$M,Y=this.$D,Se="set"+(this.$u?"UTC":"");switch(Q){case C:return U?te(1,0):te(31,11);case m:return U?te(1,ye):te(0,ye+1);case d:var de=this.$locale().weekStart||0,oe=(X<de?X+7:X)-de;return te(U?Y-oe:Y+(6-oe),ye);case u:case S:return se(Se+"Hours",0);case c:return se(Se+"Minutes",1);case l:return se(Se+"Seconds",2);case i:return se(Se+"Milliseconds",3);default:return this.clone()}},q.endOf=function(V){return this.startOf(V,!1)},q.$set=function(V,z){var j,U=k.p(V),Q="set"+(this.$u?"UTC":""),te=(j={},j[u]=Q+"Date",j[S]=Q+"Date",j[m]=Q+"Month",j[C]=Q+"FullYear",j[c]=Q+"Hours",j[l]=Q+"Minutes",j[i]=Q+"Seconds",j[o]=Q+"Milliseconds",j)[U],se=U===u?this.$D+(z-this.$W):z;if(U===m||U===C){var X=this.clone().set(S,1);X.$d[te](se),X.init(),this.$d=X.set(S,Math.min(this.$D,X.daysInMonth())).$d}else te&&this.$d[te](se);return this.init(),this},q.set=function(V,z){return this.clone().$set(V,z)},q.get=function(V){return this[k.p(V)]()},q.add=function(V,z){var j,U=this;V=Number(V);var Q=k.p(z),te=function(ye){var Y=P(U);return k.w(Y.date(Y.date()+Math.round(ye*V)),U)};if(Q===m)return this.set(m,this.$M+V);if(Q===C)return this.set(C,this.$y+V);if(Q===u)return te(1);if(Q===d)return te(7);var se=(j={},j[l]=r,j[c]=s,j[i]=n,j)[Q]||1,X=this.$d.getTime()+V*se;return k.w(X,this)},q.subtract=function(V,z){return this.add(-1*V,z)},q.format=function(V){var z=this,j=this.$locale();if(!this.isValid())return j.invalidDate||w;var U=V||"YYYY-MM-DDTHH:mm:ssZ",Q=k.z(this),te=this.$H,se=this.$m,X=this.$M,ye=j.weekdays,Y=j.months,Se=j.meridiem,de=function(me,he,G,we){return me&&(me[he]||me(z,U))||G[he].slice(0,we)},oe=function(me){return k.s(te%12||12,me,"0")},ge=Se||function(me,he,G){var we=me<12?"AM":"PM";return G?we.toLowerCase():we};return U.replace(b,function(me,he){return he||function(G){switch(G){case"YY":return String(z.$y).slice(-2);case"YYYY":return k.s(z.$y,4,"0");case"M":return X+1;case"MM":return k.s(X+1,2,"0");case"MMM":return de(j.monthsShort,X,Y,3);case"MMMM":return de(Y,X);case"D":return z.$D;case"DD":return k.s(z.$D,2,"0");case"d":return String(z.$W);case"dd":return de(j.weekdaysMin,z.$W,ye,2);case"ddd":return de(j.weekdaysShort,z.$W,ye,3);case"dddd":return ye[z.$W];case"H":return String(te);case"HH":return k.s(te,2,"0");case"h":return oe(1);case"hh":return oe(2);case"a":return ge(te,se,!0);case"A":return ge(te,se,!1);case"m":return String(se);case"mm":return k.s(se,2,"0");case"s":return String(z.$s);case"ss":return k.s(z.$s,2,"0");case"SSS":return k.s(z.$ms,3,"0");case"Z":return Q}return null}(me)||Q.replace(":","")})},q.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},q.diff=function(V,z,j){var U,Q=this,te=k.p(z),se=P(V),X=(se.utcOffset()-this.utcOffset())*r,ye=this-se,Y=function(){return k.m(Q,se)};switch(te){case C:U=Y()/12;break;case m:U=Y();break;case h:U=Y()/3;break;case d:U=(ye-X)/6048e5;break;case u:U=(ye-X)/864e5;break;case c:U=ye/s;break;case l:U=ye/r;break;case i:U=ye/n;break;default:U=ye}return j?U:k.a(U)},q.daysInMonth=function(){return this.endOf(m).$D},q.$locale=function(){return x[this.$L]},q.locale=function(V,z){if(!V)return this.$L;var j=this.clone(),U=_(V,z,!0);return U&&(j.$L=U),j},q.clone=function(){return k.w(this.$d,this)},q.toDate=function(){return new Date(this.valueOf())},q.toJSON=function(){return this.isValid()?this.toISOString():null},q.toISOString=function(){return this.$d.toISOString()},q.toString=function(){return this.$d.toUTCString()},$}(),M=D.prototype;return P.prototype=M,[["$ms",o],["$s",i],["$m",l],["$H",c],["$W",u],["$M",m],["$y",C],["$D",S]].forEach(function($){M[$[1]]=function(q){return this.$g(q,$[0],$[1])}}),P.extend=function($,q){return $.$i||($(q,D,P),$.$i=!0),P},P.locale=_,P.isDayjs=E,P.unix=function($){return P(1e3*$)},P.en=x[N],P.Ls=x,P.p={},P})})(rT);var A8=rT.exports;const Li=nv(A8);function R_(a){return a?a.startsWith("http")?a:`/images/${a}`:""}const T8=[{label:"Todas",value:"todas",color:"bg-gray-100 text-gray-700 border-gray-300"},{label:"En revisión",value:"en revisión",color:"bg-orange-200 text-orange-800 border-orange-300"},{label:"Activa",value:"activa",color:"bg-green-200 text-green-800 border-green-400"},{label:"Finalizada",value:"finalizada",color:"bg-blue-200 text-blue-800 border-blue-400"},{label:"Terminada",value:"terminada",color:"bg-gray-300 text-gray-900 border-gray-400"},{label:"Pausada",value:"pausada",color:"bg-yellow-200 text-yellow-800 border-yellow-400"}];function P8(a){if(!a)return"bg-gray-200 text-gray-700";switch((a||"").toLowerCase()){case"en revisión":case"en revision":return"bg-orange-200 text-orange-800";case"activa":return"bg-green-200 text-green-800";case"finalizada":return"bg-blue-200 text-blue-800";case"terminada":return"bg-gray-300 text-gray-900";case"pausada":return"bg-yellow-200 text-yellow-800";case"cancelada":return"bg-red-200 text-red-800";default:return"bg-gray-200 text-gray-700"}}function R8(){const[a,e]=p.useState([]),[n,r]=p.useState("todas"),s=Ct();p.useEffect(()=>{const l=wa(W(F,"campanas"),async c=>{const u=Li(),d=[],m=c.docs.map(h=>{const C=h.data(),S=C.fechaInicio?Li(C.fechaInicio.toDate?C.fechaInicio.toDate():C.fechaInicio):null,w=C.fechaFin?Li(C.fechaFin.toDate?C.fechaFin.toDate():C.fechaFin):null;let f="-";S&&w&&(f=w.diff(S,"day")+1);let b=C.estado;return w&&u.isAfter(w,"day")&&b!=="Terminada"&&(b="Terminada",d.push(ze(Ne(F,"campanas",h.id),{estado:b}))),{id:h.id,...C,fechaInicio:S,fechaFin:w,dias:f,estado:b}});d.length>0&&await Promise.allSettled(d),e(m)});return()=>l()},[]);function o(l){return l?Li(l).format("YYYY-MM-DD"):"-"}const i=a.filter(l=>n==="todas"?!0:(l.estado||"").toLowerCase()===n).sort((l,c)=>(l.estado||"").toLowerCase()==="activa"&&(c.estado||"").toLowerCase()!=="activa"?-1:(c.estado||"").toLowerCase()==="activa"&&(l.estado||"").toLowerCase()!=="activa"?1:l.fechaInicio&&c.fechaInicio?Li(c.fechaInicio).unix()-Li(l.fechaInicio).unix():0);return t.createElement("div",{className:"p-4"},t.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2"},t.createElement("h2",{className:"text-xl font-bold"},"Listado de Campañas"),t.createElement("button",{className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm",onClick:()=>s("/admin/campañas/nueva")},"Nueva Campaña")),t.createElement("div",{className:"flex gap-2 mb-4"},T8.map(l=>t.createElement("button",{key:l.value,onClick:()=>r(l.value),className:`
              px-3 py-1 rounded-full text-sm font-semibold border transition
              ${n===l.value?`${l.color} border-2`:`${l.color.replace("bg-","bg-opacity-50 bg-")} border`}
            `,style:n===l.value?{boxShadow:"0 0 0 2px #2563eb33"}:{}},l.label))),t.createElement("div",{className:"overflow-x-auto"},t.createElement("table",{className:"min-w-full border"},t.createElement("thead",null,t.createElement("tr",null,t.createElement("th",{className:"border px-2 py-1"},"#"),t.createElement("th",{className:"border px-2 py-1"},"Título"),t.createElement("th",{className:"border px-2 py-1"},"Imagen"),t.createElement("th",{className:"border px-2 py-1"},"Logo"),t.createElement("th",{className:"border px-2 py-1"},"Nombre"),t.createElement("th",{className:"border px-2 py-1"},"Estado"),t.createElement("th",{className:"border px-2 py-1"},"Email proveedor"),t.createElement("th",{className:"border px-2 py-1"},"Fecha Ini"),t.createElement("th",{className:"border px-2 py-1"},"Fecha Fin"),t.createElement("th",{className:"border px-2 py-1"},"Días"),t.createElement("th",{className:"border px-2 py-1"},"Acciones"))),t.createElement("tbody",null,i.map((l,c)=>t.createElement("tr",{key:l.id},t.createElement("td",{className:"border px-2 py-1 text-center"},c+1),t.createElement("td",{className:"border px-2 py-1"},l.titulo??"-"),t.createElement("td",{className:"border px-2 py-1 text-center"},l.imagenURL?t.createElement("img",{src:R_(l.imagenURL),alt:"Imagen",className:"w-20 h-10 object-contain mx-auto border rounded bg-white"}):t.createElement("span",{className:"text-gray-400"},"-")),t.createElement("td",{className:"border px-2 py-1 text-center"},l.logoURL?t.createElement("img",{src:R_(l.logoURL),alt:"Logo",className:"w-10 h-10 object-contain mx-auto border rounded bg-white"}):t.createElement("span",{className:"text-gray-400"},"-")),t.createElement("td",{className:"border px-2 py-1"},l.nombre??"-"),t.createElement("td",{className:"border px-2 py-1"},t.createElement("span",{className:"px-2 py-1 rounded-full text-xs font-semibold "+P8(l.estado)},l.estado||"-")),t.createElement("td",{className:"border px-2 py-1"},l.email??"-"),t.createElement("td",{className:"border px-2 py-1"},o(l.fechaInicio)),t.createElement("td",{className:"border px-2 py-1"},o(l.fechaFin)),t.createElement("td",{className:"border px-2 py-1 text-center"},l.dias),t.createElement("td",{className:"border px-2 py-1"},t.createElement("button",{className:"bg-yellow-400 hover:bg-yellow-500 text-xs px-2 py-1 rounded",onClick:()=>s(`/admin/campañas/${l.id}/editar-campaña`)},"Editar")))),i.length===0&&t.createElement("tr",null,t.createElement("td",{colSpan:11,className:"text-center text-gray-500 py-4"},"No hay resultados."))))))}function D8(a){return a?a.startsWith("http")?a:`/images/${a}`:""}function L8(a){if(!a)return"bg-gray-200 text-gray-700";switch(a.toLowerCase()){case"activo":return"bg-green-200 text-green-800";case"inactivo":return"bg-red-200 text-red-800";case"pendiente":return"bg-yellow-200 text-yellow-800";case"agotado":return"bg-orange-200 text-orange-800";default:return"bg-gray-200 text-gray-700"}}function M8(){const[a,e]=p.useState([]),n=Ct();return p.useEffect(()=>{const r=wa(W(F,"productos"),s=>{e(s.docs.map(o=>({id:o.id,...o.data()})))});return()=>r()},[]),t.createElement("div",{className:"p-4"},t.createElement("div",{className:"flex justify-between items-center mb-4"},t.createElement("h2",{className:"text-xl font-bold"},"Listado de Productos"),t.createElement("button",{className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded shadow",onClick:()=>n("/admin/nuevo-producto")},"Ingresar producto")),t.createElement("table",{className:"min-w-full border"},t.createElement("thead",null,t.createElement("tr",null,t.createElement("th",{className:"border px-2 py-1"},"Imagen"),t.createElement("th",{className:"border px-2 py-1"},"Título"),t.createElement("th",{className:"border px-2 py-1"},"Categoría"),t.createElement("th",{className:"border px-2 py-1"},"Precio"),t.createElement("th",{className:"border px-2 py-1"},"Estado"),t.createElement("th",{className:"border px-2 py-1"},"Acciones"))),t.createElement("tbody",null,a.map(r=>t.createElement("tr",{key:r.id},t.createElement("td",{className:"border px-2 py-1 text-center"},r.imagenURL?t.createElement("img",{src:D8(r.imagenURL),alt:"Imagen",className:"w-16 h-12 object-contain mx-auto border rounded bg-white"}):t.createElement("span",{className:"text-gray-400"},"-")),t.createElement("td",{className:"border px-2 py-1"},r.titulo??"-"),t.createElement("td",{className:"border px-2 py-1"},Array.isArray(r.categorias)?r.categorias.join(", "):r.categoria??"-"),t.createElement("td",{className:"border px-2 py-1"},r.precio!==void 0?`$${r.precio}`:"-"),t.createElement("td",{className:"border px-2 py-1"},t.createElement("span",{className:"px-2 py-1 rounded-full text-xs font-semibold "+L8(r.estado)},r.estado||"-")),t.createElement("td",{className:"border px-2 py-1"},t.createElement("button",{className:"bg-yellow-400 hover:bg-yellow-500 text-xs px-2 py-1 rounded",onClick:()=>n(`/admin/editar-producto/${r.id}`)},"Editar")))))))}class sT{static async createClientUser(e){try{const{nombres:n,apellidos:r,email:s,password_hash:o,telefono:i,direccion:l,comuna:c,region:u,rut:d,fecha_nacimiento:m,genero:h}=e,C=atob(o),w=(await es(Pt,s,C)).user,f={uid:w.uid,email:w.email,nombres:n,apellidos:r,telefono:i,direccion:l,comuna:c,region:u,rut:d,fecha_nacimiento:m?new Date(m):null,genero:h||"",userId:w.uid,fecha_registro:new Date,fechaRegistro:new Date,estado:"pendiente_validacion",tipo_usuario:"cliente",fecha_activacion:new Date,notificaciones_email:!0,notificaciones_push:!0,acepta_promociones:!0,vehiculos:[],total_solicitudes:0,total_servicios_completados:0,calificacion_promedio:null,creado_desde_solicitud:!0,solicitud_original_id:e.id||null,ip_registro:e.ip_registro||null,user_agent:e.user_agent||null},b=await ot(W(F,"perfiles_clientes"),f),v={uid:w.uid,email:w.email,rol:"cliente",nombre:`${n} ${r}`,fechaCreacion:new Date,activo:!0,perfilClienteId:b.id};return await Ar(Ne(F,"usuarios",w.uid),v),{success:!0,user:w,profileId:b.id,uid:w.uid,email:w.email}}catch(n){console.error("Error creating client user:",n);let r="Error al crear el usuario";return n.code==="auth/email-already-in-use"?r="El email ya está registrado en el sistema":n.code==="auth/weak-password"?r="La contraseña es muy débil":n.code==="auth/invalid-email"&&(r="El email no es válido"),{success:!1,error:r,code:n.code}}}static async createProviderUser(e){try{const{nombres_representante:n,apellidos_representante:r,email_empresa:s,password_hash:o,nombre_empresa:i,rut_empresa:l,telefono_empresa:c,direccion_empresa:u,comuna:d,region:m,categorias_servicios:h,marcas_vehiculos:C,descripcion_negocio:S,horario_atencion:w}=e,f=atob(o),v=(await es(Pt,s,f)).user,I={uid:v.uid,email:v.email,nombre:i,rut:l,telefono:c,direccion:u,comuna:d,region:m,descripcion:S,horario_atencion:w,representante:{nombres:n,apellidos:r,email:e.email_representante||s,telefono:e.telefono_representante||c,cargo:e.cargo_representante||"Propietario"},categorias:h||[],marcas_atendidas:C||[],fecha_registro:new Date,estado_validacion:"activo",tipo_usuario:"proveedor",fecha_activacion:new Date,verificado:!0,acepta_notificaciones:e.acepta_notificaciones!==!1,visible_en_busqueda:!0,acepta_servicios_emergencia:!1,total_servicios_completados:0,calificacion_promedio:null,total_clientes_atendidos:0,creado_desde_solicitud:!0,solicitud_original_id:e.id||null,ip_registro:e.ip_registro||null,user_agent:e.user_agent||null},A=await ot(W(F,"empresas"),I),N={uid:v.uid,email:v.email,rol:"proveedor",nombre:i,empresaId:A.id,fechaCreacion:new Date,activo:!0};return await Ar(Ne(F,"usuarios",v.uid),N),{success:!0,user:v,profileId:A.id,uid:v.uid,email:v.email}}catch(n){console.error("Error creating provider user:",n);let r="Error al crear el usuario proveedor";return n.code==="auth/email-already-in-use"?r="El email ya está registrado en el sistema":n.code==="auth/weak-password"?r="La contraseña es muy débil":n.code==="auth/invalid-email"&&(r="El email no es válido"),{success:!1,error:r,code:n.code}}}static async checkEmailExists(e){try{return(await XM(Pt,e)).length>0}catch(n){return console.error("Error checking email:",n),!1}}}function V8(){var w;const{user:a}=ht(),[e,n]=p.useState([]),[r,s]=p.useState(!0),[o,i]=p.useState("all"),[l,c]=p.useState(null),[u,d]=p.useState(!1);p.useEffect(()=>{m()},[]);const m=async()=>{try{const f=fe(W(F,"solicitudes_cliente"),st("fecha_solicitud","desc")),v=(await le(f)).docs.map(I=>({id:I.id,...I.data()}));n(v)}catch(f){console.error("Error loading requests:",f)}finally{s(!1)}},h=async(f,b,v,I="")=>{d(!0);try{const A=e.find(P=>P.id===f),N={...A.etapas};N[b]={...N[b],estado:v,fecha_fin:v==="completada"?new Date:null,comentarios:I,responsable:a.email};const x=["validacion_datos","confirmacion_final"],y=x.filter(P=>{var k;return((k=N[P])==null?void 0:k.estado)==="completada"}).length,E=Math.round(y/x.length*100);let _="en_revision";if(v==="rechazada"?_="rechazada":b==="confirmacion_final"&&v==="completada"&&(_="aprobada"),b==="confirmacion_final"&&v==="completada"){const P=await sT.createClientUser({...A,id:f});if(P.success)await ze(Ne(F,"solicitudes_cliente",f),{etapas:N,progreso_porcentaje:100,estado_general:"aprobada",etapa_actual:"confirmacion_final",usuario_creado:!0,uid_usuario:P.uid,fecha_activacion:new Date,perfil_id:P.profileId}),await Ws.createInAppNotification(P.uid,"validacion","¡Cuenta activada! Bienvenido a AV10 de Julio","Tu cuenta de cliente ha sido creada exitosamente. Ya puedes iniciar sesión y gestionar tus vehículos.",{solicitudId:f,uid:P.uid,email:P.email,origen:"cuenta_activada"}),alert(`Usuario creado exitosamente para ${A.nombres} ${A.apellidos}`);else{alert(`Error al crear usuario: ${P.error}`);return}}else await ze(Ne(F,"solicitudes_cliente",f),{etapas:N,progreso_porcentaje:E,estado_general:_,etapa_actual:b});await Ws.createInAppNotification(A.uid||A.email,"validacion","Actualización en tu solicitud",`La etapa "${b}" ha sido ${v==="completada"?"completada":"actualizada"}`,{solicitudId:f,etapa:b,estado:v,origen:"admin_solicitudes_cliente"}),await m()}catch(A){console.error("Error updating stage:",A),alert("Error al actualizar la etapa: "+A.message)}finally{d(!1)}},C=e.filter(f=>o==="all"?!0:f.estado_general===o),S=f=>{switch(f){case"enviada":return"bg-blue-100 text-blue-800";case"en_revision":return"bg-yellow-100 text-yellow-800";case"aprobada":return"bg-green-100 text-green-800";case"rechazada":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return r?t.createElement("div",{className:"flex justify-center items-center h-64"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})):t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"flex justify-between items-center"},t.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Solicitudes de Cliente"),t.createElement("div",{className:"flex space-x-2"},t.createElement("select",{value:o,onChange:f=>i(f.target.value),className:"border border-gray-300 rounded-lg px-3 py-2"},t.createElement("option",{value:"all"},"Todas las solicitudes"),t.createElement("option",{value:"enviada"},"Enviadas"),t.createElement("option",{value:"en_revision"},"En revisión"),t.createElement("option",{value:"aprobada"},"Aprobadas"),t.createElement("option",{value:"rechazada"},"Rechazadas")))),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4"},[{label:"Total",value:e.length,color:"bg-blue-500"},{label:"Pendientes",value:e.filter(f=>f.estado_general==="enviada").length,color:"bg-yellow-500"},{label:"En Revisión",value:e.filter(f=>f.estado_general==="en_revision").length,color:"bg-orange-500"},{label:"Aprobadas",value:e.filter(f=>f.estado_general==="aprobada").length,color:"bg-green-500"}].map(f=>t.createElement("div",{key:f.label,className:"bg-white rounded-lg shadow p-6"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:`w-4 h-4 rounded-full ${f.color} mr-3`}),t.createElement("div",null,t.createElement("p",{className:"text-sm font-medium text-gray-600"},f.label),t.createElement("p",{className:"text-2xl font-bold text-gray-900"},f.value)))))),t.createElement("div",{className:"bg-white shadow rounded-lg overflow-hidden"},t.createElement("div",{className:"overflow-x-auto"},t.createElement("table",{className:"min-w-full divide-y divide-gray-200"},t.createElement("thead",{className:"bg-gray-50"},t.createElement("tr",null,t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Cliente"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Etapa Actual"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Progreso"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Fecha"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),t.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},C.map(f=>{var b,v;return t.createElement("tr",{key:f.id,className:"hover:bg-gray-50"},t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("div",null,t.createElement("div",{className:"text-sm font-medium text-gray-900"},f.nombres," ",f.apellidos),t.createElement("div",{className:"text-sm text-gray-500"},f.email))),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${S(f.estado_general)}`},f.estado_general)),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},(b=f.etapa_actual)==null?void 0:b.replace("_"," ")),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"w-full bg-gray-200 rounded-full h-2 mr-2"},t.createElement("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${f.progreso_porcentaje||0}%`}})),t.createElement("span",{className:"text-sm text-gray-600"},f.progreso_porcentaje||0,"%"))),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},(v=f.fecha_solicitud)!=null&&v.toDate?f.fecha_solicitud.toDate().toLocaleDateString():"N/A"),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},t.createElement("button",{onClick:()=>c(f),className:"text-blue-600 hover:text-blue-900 mr-3"},"Ver Detalles")))}))))),l&&t.createElement("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},t.createElement("div",{className:"relative top-20 mx-auto p-5 border w-11/12 max-w-4xl shadow-lg rounded-md bg-white"},t.createElement("div",{className:"flex justify-between items-center mb-4"},t.createElement("h3",{className:"text-lg font-bold text-gray-900"},"Detalle de Solicitud - ",l.nombres," ",l.apellidos),t.createElement("button",{onClick:()=>c(null),className:"text-gray-400 hover:text-gray-600"},"✕")),t.createElement("div",{className:"grid md:grid-cols-2 gap-6"},t.createElement("div",{className:"space-y-4"},t.createElement("h4",{className:"font-semibold text-gray-900"},"Información Personal"),t.createElement("div",{className:"space-y-2 text-sm"},t.createElement("p",null,t.createElement("span",{className:"font-medium"},"RUT:")," ",l.rut),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Email:")," ",l.email),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Teléfono:")," ",l.telefono),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Dirección:")," ",l.direccion),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Comuna:")," ",l.comuna),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Región:")," ",l.region),l.profesion&&t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Profesión:")," ",l.profesion),l.empresa&&t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Empresa:")," ",l.empresa)),((w=l.servicios_interes)==null?void 0:w.length)>0&&t.createElement("div",null,t.createElement("h5",{className:"font-medium text-gray-900 mb-2"},"Servicios de Interés"),t.createElement("div",{className:"flex flex-wrap gap-1"},l.servicios_interes.map(f=>t.createElement("span",{key:f,className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs"},f)))),l.motivo_registro&&t.createElement("div",null,t.createElement("h5",{className:"font-medium text-gray-900 mb-2"},"Motivo de Registro"),t.createElement("p",{className:"text-sm text-gray-600"},l.motivo_registro))),t.createElement("div",{className:"space-y-4"},t.createElement("h4",{className:"font-semibold text-gray-900"},"Gestión de Etapas"),["validacion_datos","confirmacion_final"].map(f=>{var I;const b=((I=l.etapas)==null?void 0:I[f])||{estado:"pendiente"},v={validacion_datos:"Validación de Datos",confirmacion_final:"Confirmación Final"};return t.createElement("div",{key:f,className:"border rounded-lg p-3"},t.createElement("div",{className:"flex justify-between items-center mb-2"},t.createElement("h5",{className:"font-medium text-gray-900"},v[f]),t.createElement("span",{className:`px-2 py-1 rounded text-xs ${b.estado==="completada"?"bg-green-100 text-green-800":b.estado==="en_proceso"?"bg-blue-100 text-blue-800":b.estado==="rechazada"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`},b.estado)),f==="validacion_datos"&&t.createElement("div",{className:"text-sm text-gray-600 mb-2"},"Revisar datos personales, documentos de identidad y dirección"),f==="confirmacion_final"&&t.createElement("div",{className:"text-sm text-gray-600 mb-2"},"Aprobar solicitud y crear cuenta de usuario en el sistema"),b.estado==="pendiente"&&t.createElement("div",{className:"flex space-x-2"},t.createElement("button",{onClick:()=>h(l.id,f,"completada"),disabled:u,className:"bg-green-600 text-white px-3 py-1 rounded text-xs hover:bg-green-700 disabled:opacity-50"},"Completar"),t.createElement("button",{onClick:()=>h(l.id,f,"rechazada","Rechazada por admin"),disabled:u,className:"bg-red-600 text-white px-3 py-1 rounded text-xs hover:bg-red-700 disabled:opacity-50"},"Rechazar")),b.comentarios&&t.createElement("p",{className:"text-xs text-gray-600 mt-2"},b.comentarios))}))))))}function O8(){const[a,e]=p.useState([]),[n,r]=p.useState(!0),[s,o]=p.useState(""),[i,l]=p.useState(null),[c,u]=p.useState(!1);p.useEffect(()=>{const f=fe(W(F,"solicitudes_comunidad"),st("fecha_solicitud","desc"));return wa(f,v=>{const I=v.docs.map(A=>({id:A.id,...A.data()}));e(I),r(!1)})},[]);const d=async(f,b,v=null)=>{try{const I={estado_general:b,fecha_actualizacion:new Date};switch(b){case"en_revision":I.progreso_porcentaje=50;break;case"documentos_aprobados":I.progreso_porcentaje=75,v&&(I[`etapas.${v}`]="completada");break;case"aprobada":I.progreso_porcentaje=100,I.etapas={documentos:"completada",validacion_comercial:"completada",visita_campo:"completada",decision_final:"completada"};break;case"rechazada":I.progreso_porcentaje=0;break;default:break}await ze(Ne(F,"solicitudes_comunidad",f),I),b==="aprobada"&&await m(f),alert("Estado actualizado exitosamente")}catch(I){console.error("Error actualizando estado:",I),alert("Error al actualizar el estado")}},m=async f=>{try{const b=a.find(I=>I.id===f);if(!b)return;const v={nombre:b.nombre_empresa,rut:b.rut_empresa,direccion:b.direccion,telefono:b.telefono,email:b.email,sitio_web:b.sitio_web,categoria:b.categoria,marcas:b.marcas,descripcion:b.descripcion_servicios,horario_atencion:b.horario_atencion,logo_url:b.logo_url,representante_legal:{nombre:b.nombre_representante,rut:b.rut_representante,cargo:b.cargo_representante,telefono:b.telefono_representante,email:b.email_representante},estado:"activa",tipo_empresa:"comunidad",es_comunidad:!0,fecha_ingreso_comunidad:new Date,fecha_creacion:new Date,fecha_actualizacion:new Date,solicitud_origen_id:f,años_experiencia:b.años_experiencia,numero_empleados:b.numero_empleados,documentacion:{constitucion:b.documento_constitucion,vigencia:b.certificado_vigencia,autorizacion_sectorial:b.autorizacion_sectorial}};await ot(W(F,"empresas"),v),console.log("Empresa creada exitosamente en la comunidad")}catch(b){throw console.error("Error creando empresa en comunidad:",b),b}},h=async(f,b)=>{try{await ze(Ne(F,"solicitudes_comunidad",f),{observaciones_admin:b,fecha_actualizacion:new Date}),alert("Observación agregada exitosamente"),u(!1)}catch(v){console.error("Error agregando observación:",v),alert("Error al agregar la observación")}},C=a.filter(f=>s?f.estado_general===s:!0),S=f=>{switch(f){case"pendiente_revision":return"bg-yellow-100 text-yellow-800";case"en_revision":return"bg-blue-100 text-blue-800";case"documentos_aprobados":return"bg-purple-100 text-purple-800";case"aprobada":return"bg-green-100 text-green-800";case"rechazada":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},w=f=>{switch(f){case"pendiente_revision":return"Pendiente Revisión";case"en_revision":return"En Revisión";case"documentos_aprobados":return"Documentos Aprobados";case"aprobada":return"Aprobada";case"rechazada":return"Rechazada";default:return f}};return n?t.createElement("div",{className:"flex items-center justify-center p-8"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),t.createElement("p",{className:"text-gray-600"},"Cargando solicitudes..."))):t.createElement("div",{className:"p-6"},t.createElement("div",{className:"mb-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-800 mb-2"},"Solicitudes para Unirse a la Comunidad"),t.createElement("p",{className:"text-gray-600"},"Gestiona las solicitudes de empresas que quieren formar parte de la comunidad AV10 de Julio.")),t.createElement("div",{className:"mb-6 flex flex-wrap gap-4"},t.createElement("select",{value:s,onChange:f=>o(f.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},t.createElement("option",{value:""},"Todos los estados"),t.createElement("option",{value:"pendiente_revision"},"Pendiente Revisión"),t.createElement("option",{value:"en_revision"},"En Revisión"),t.createElement("option",{value:"documentos_aprobados"},"Documentos Aprobados"),t.createElement("option",{value:"aprobada"},"Aprobadas"),t.createElement("option",{value:"rechazada"},"Rechazadas")),t.createElement("div",{className:"text-sm text-gray-600"},"Total: ",C.length," solicitudes")),t.createElement("div",{className:"grid gap-6"},C.map(f=>{var b,v,I;return t.createElement("div",{key:f.id,className:"bg-white border border-gray-200 rounded-lg shadow-sm p-6"},t.createElement("div",{className:"flex justify-between items-start mb-4"},t.createElement("div",null,t.createElement("h3",{className:"text-xl font-semibold text-gray-800 mb-1"},f.nombre_empresa),t.createElement("p",{className:"text-gray-600"},"RUT: ",f.rut_empresa),t.createElement("p",{className:"text-gray-600"},"Fecha: ",((I=(v=(b=f.fecha_solicitud)==null?void 0:b.toDate)==null?void 0:v.call(b))==null?void 0:I.toLocaleDateString())||"N/A")),t.createElement("div",{className:"flex flex-col items-end gap-2"},t.createElement("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${S(f.estado_general)}`},w(f.estado_general)),t.createElement("div",{className:"text-sm text-gray-600"},f.progreso_porcentaje,"% completado"))),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4"},t.createElement("div",null,t.createElement("p",{className:"text-sm font-medium text-gray-700"},"Categoría"),t.createElement("p",{className:"text-gray-600"},f.categoria)),t.createElement("div",null,t.createElement("p",{className:"text-sm font-medium text-gray-700"},"Dirección"),t.createElement("p",{className:"text-gray-600"},f.direccion)),t.createElement("div",null,t.createElement("p",{className:"text-sm font-medium text-gray-700"},"Representante"),t.createElement("p",{className:"text-gray-600"},f.nombre_representante)),t.createElement("div",null,t.createElement("p",{className:"text-sm font-medium text-gray-700"},"Email"),t.createElement("p",{className:"text-gray-600"},f.email)),t.createElement("div",null,t.createElement("p",{className:"text-sm font-medium text-gray-700"},"Teléfono"),t.createElement("p",{className:"text-gray-600"},f.telefono)),t.createElement("div",null,t.createElement("p",{className:"text-sm font-medium text-gray-700"},"Experiencia"),t.createElement("p",{className:"text-gray-600"},f.años_experiencia," años"))),t.createElement("div",{className:"mb-4"},t.createElement("p",{className:"text-sm font-medium text-gray-700 mb-2"},"Progreso de Validación"),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2"},Object.entries(f.etapas||{}).map(([A,N])=>t.createElement("div",{key:A,className:"text-center"},t.createElement("div",{className:`h-2 rounded-full mb-1 ${N==="completada"?"bg-green-500":N==="en_proceso"?"bg-yellow-500":"bg-gray-300"}`}),t.createElement("p",{className:"text-xs text-gray-600 capitalize"},A.replace("_"," ")))))),f.observaciones_admin&&t.createElement("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded"},t.createElement("p",{className:"text-sm font-medium text-yellow-800 mb-1"},"Observaciones:"),t.createElement("p",{className:"text-sm text-yellow-700"},f.observaciones_admin)),t.createElement("div",{className:"flex flex-wrap gap-2"},t.createElement("button",{onClick:()=>{l(f),u(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm"},"Ver Detalles"),f.estado_general==="pendiente_revision"&&t.createElement("button",{onClick:()=>d(f.id,"en_revision"),className:"px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 text-sm"},"Iniciar Revisión"),f.estado_general==="en_revision"&&t.createElement(t.Fragment,null,t.createElement("button",{onClick:()=>d(f.id,"documentos_aprobados","documentos"),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-sm"},"Aprobar Documentos"),t.createElement("button",{onClick:()=>d(f.id,"rechazada"),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm"},"Rechazar")),f.estado_general==="documentos_aprobados"&&t.createElement("button",{onClick:()=>d(f.id,"aprobada"),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm"},"Aprobar e Integrar a Comunidad")))})),C.length===0&&t.createElement("div",{className:"text-center py-8"},t.createElement("p",{className:"text-gray-600"},"No hay solicitudes que coincidan con los filtros seleccionados.")),c&&i&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto"},t.createElement("div",{className:"flex justify-between items-center mb-6"},t.createElement("h3",{className:"text-2xl font-bold text-gray-800"},"Detalles de ",i.nombre_empresa),t.createElement("button",{onClick:()=>u(!1),className:"text-gray-500 hover:text-gray-700 text-2xl font-bold"},"×")),t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-800 mb-2"},"Información de la Empresa"),t.createElement("div",{className:"space-y-2 text-sm"},t.createElement("p",null,t.createElement("strong",null,"Nombre:")," ",i.nombre_empresa),t.createElement("p",null,t.createElement("strong",null,"RUT:")," ",i.rut_empresa),t.createElement("p",null,t.createElement("strong",null,"Dirección:")," ",i.direccion),t.createElement("p",null,t.createElement("strong",null,"Teléfono:")," ",i.telefono),t.createElement("p",null,t.createElement("strong",null,"Email:")," ",i.email),t.createElement("p",null,t.createElement("strong",null,"Sitio Web:")," ",i.sitio_web))),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-800 mb-2"},"Representante Legal"),t.createElement("div",{className:"space-y-2 text-sm"},t.createElement("p",null,t.createElement("strong",null,"Nombre:")," ",i.nombre_representante),t.createElement("p",null,t.createElement("strong",null,"RUT:")," ",i.rut_representante),t.createElement("p",null,t.createElement("strong",null,"Cargo:")," ",i.cargo_representante),t.createElement("p",null,t.createElement("strong",null,"Teléfono:")," ",i.telefono_representante),t.createElement("p",null,t.createElement("strong",null,"Email:")," ",i.email_representante)))),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-800 mb-2"},"Descripción de Servicios"),t.createElement("p",{className:"text-sm text-gray-600"},i.descripcion_servicios)),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-800 mb-2"},"Motivación"),t.createElement("p",{className:"text-sm text-gray-600"},i.motivacion)),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-800 mb-2"},"Beneficios Esperados"),t.createElement("p",{className:"text-sm text-gray-600"},i.beneficios_esperados)),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-800 mb-2"},"Documentación"),t.createElement("div",{className:"space-y-2 text-sm"},i.logo_url&&t.createElement("p",null,t.createElement("strong",null,"Logo:")," ",t.createElement("a",{href:i.logo_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},"Ver logo")),i.documento_constitucion&&t.createElement("p",null,t.createElement("strong",null,"Constitución:")," ",t.createElement("a",{href:i.documento_constitucion,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},"Ver documento")),i.certificado_vigencia&&t.createElement("p",null,t.createElement("strong",null,"Vigencia:")," ",t.createElement("a",{href:i.certificado_vigencia,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},"Ver certificado")),i.autorizacion_sectorial&&t.createElement("p",null,t.createElement("strong",null,"Autorización:")," ",t.createElement("a",{href:i.autorizacion_sectorial,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},"Ver autorización")))),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-800 mb-2"},"Agregar Observación"),t.createElement("textarea",{placeholder:"Escriba una observación para la empresa...",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"3",onChange:f=>{document.getElementById("observacion-temp").value=f.target.value}}),t.createElement("button",{onClick:()=>{const f=document.getElementById("observacion-temp").value;f.trim()&&h(i.id,f)},className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"},"Agregar Observación"),t.createElement("input",{type:"hidden",id:"observacion-temp"}))),t.createElement("div",{className:"flex justify-end mt-6 pt-6 border-t"},t.createElement("button",{onClick:()=>u(!1),className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"},"Cerrar")))))}const j8="BEl62iUYgUivxIhf6Ydtwqr2oXIFOOcNVKqF8sD_ECGRt1Ue6kf0lKrKQK2BdHWnU_0XEU1LoXOQ",F8=a=>{const[e,n]=p.useState(Notification.permission),[r,s]=p.useState(null),[o,i]=p.useState(!1);p.useEffect(()=>{i("Notification"in window&&"serviceWorker"in navigator)},[]);const l=async()=>{if(!o)return console.log("Notificaciones no soportadas en este navegador"),!1;try{const h=await Notification.requestPermission();return n(h),h==="granted"?(await c(),!0):!1}catch(h){return console.error("Error al solicitar permisos de notificación:",h),!1}},c=async()=>{if(!Xi||e!=="granted")return null;try{const h=await hA(Xi,{vapidKey:j8});return h?(s(h),a&&await u(h,a.uid),h):(console.log("No se pudo obtener el token de notificación"),null)}catch(h){return console.error("Error al obtener token de notificación:",h),null}},u=async(h,C)=>{try{const S=Ne(F,"usuarios",C);await ze(S,{notificationToken:h,notificationsEnabled:!0,lastTokenUpdate:new Date})}catch(S){console.error("Error al guardar token en base de datos:",S)}};p.useEffect(()=>{if(!Xi)return;const h=vA(Xi,C=>{console.log("Mensaje recibido en primer plano:",C),C.notification&&d(C.notification)});return()=>h()},[]);const d=h=>{console.log("Notificación en app:",h),document.visibilityState==="visible"&&`${h.title}${h.body}`};return{permission:e,token:r,isSupported:o,requestPermission:l,getNotificationToken:c,sendTestNotification:async()=>{if(!r){console.log("No hay token disponible");return}try{console.log("Enviando notificación de prueba con token:",r),alert("Token de notificación copiado al console. Úsalo en Firebase Console para enviar una prueba.")}catch(h){console.error("Error al enviar notificación de prueba:",h)}}}},z8=({user:a})=>{const[e,n]=p.useState([]),[r,s]=p.useState(!1),[o,i]=p.useState({titulo:"",cuerpo:"",tipo:"general",url:""}),{token:l,requestPermission:c,sendTestNotification:u}=F8(a);p.useEffect(()=>{d()},[]);const d=async()=>{try{const C=W(F,"usuarios"),S=fe(C,pe("notificationsEnabled","==",!0),st("lastTokenUpdate","desc"),Ot(100)),f=(await le(S)).docs.map(b=>({id:b.id,...b.data()}));n(f)}catch(C){console.error("Error al cargar usuarios:",C)}},m=async C=>{C.preventDefault(),s(!0);try{const S={...o,fechaEnvio:new Date,enviadoPor:a.uid,estado:"enviada",destinatarios:e.length};await ot(W(F,"notificaciones"),S),console.log("Notificación guardada:",S),console.log("Tokens destinatarios:",e.map(w=>w.notificationToken)),alert(`Notificación enviada a ${e.length} usuarios`),i({titulo:"",cuerpo:"",tipo:"general",url:""})}catch(S){console.error("Error al enviar notificación:",S),alert("Error al enviar notificación")}finally{s(!1)}},h=async()=>{await c()?(alert("Notificaciones configuradas correctamente"),d()):alert("Permisos de notificación denegados")};return t.createElement("div",{className:"max-w-4xl mx-auto p-6"},t.createElement("div",{className:"bg-white rounded-lg shadow-md p-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-800 mb-6"},"Gestión de Notificaciones Push"),t.createElement("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg"},t.createElement("h3",{className:"font-semibold text-blue-800 mb-2"},"Estado de configuración"),t.createElement("div",{className:"space-y-2"},t.createElement("p",{className:"text-sm"},t.createElement("span",{className:"font-medium"},"Token personal:"),l?t.createElement("span",{className:"text-green-600 ml-2"},"✓ Configurado"):t.createElement("span",{className:"text-red-600 ml-2"},"✗ No configurado")),t.createElement("p",{className:"text-sm"},t.createElement("span",{className:"font-medium"},"Usuarios con notificaciones:"),t.createElement("span",{className:"ml-2 font-bold"},e.length))),!l&&t.createElement("button",{onClick:h,className:"mt-3 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"Configurar Notificaciones")),t.createElement("form",{onSubmit:m,className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Título de la notificación"),t.createElement("input",{type:"text",value:o.titulo,onChange:C=>i({...o,titulo:C.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Nueva campaña disponible",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Mensaje"),t.createElement("textarea",{value:o.cuerpo,onChange:C=>i({...o,cuerpo:C.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",placeholder:"Contenido de la notificación...",required:!0})),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Tipo de notificación"),t.createElement("select",{value:o.tipo,onChange:C=>i({...o,tipo:C.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"general"},"General"),t.createElement("option",{value:"admin"},"Solo Administradores"),t.createElement("option",{value:"proveedor"},"Solo Proveedores"),t.createElement("option",{value:"cliente"},"Solo Clientes"),t.createElement("option",{value:"agente"},"Solo Agentes"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"URL de destino (opcional)"),t.createElement("input",{type:"url",value:o.url,onChange:C=>i({...o,url:C.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://..."}))),t.createElement("div",{className:"flex space-x-4"},t.createElement("button",{type:"submit",disabled:r||e.length===0,className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 disabled:bg-gray-400"},r?"Enviando...":`Enviar a ${e.length} usuarios`),l&&t.createElement("button",{type:"button",onClick:u,className:"bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700"},"Enviar Prueba Personal"))),e.length>0&&t.createElement("div",{className:"mt-8"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Usuarios con notificaciones activas"),t.createElement("div",{className:"bg-gray-50 rounded-lg p-4 max-h-60 overflow-y-auto"},e.map(C=>{var S,w,f;return t.createElement("div",{key:C.id,className:"flex justify-between items-center py-2 border-b border-gray-200 last:border-b-0"},t.createElement("div",null,t.createElement("span",{className:"font-medium"},C.email),t.createElement("span",{className:"ml-2 text-sm text-gray-500"},"(",C.rol,")")),t.createElement("span",{className:"text-xs text-gray-400"},(f=(w=(S=C.lastTokenUpdate)==null?void 0:S.toDate)==null?void 0:w.call(S))==null?void 0:f.toLocaleDateString()))})))))};function U8(){const[a,e]=p.useState([]),[n,r]=p.useState(""),[s,o]=p.useState(null),[i,l]=p.useState(""),[c,u]=p.useState(!1),d=["4x4","Repuestos","Ventas","Servicio","Seguros","Emergencia","Auto","Camioneta","Camión","Accesorio","Neumáticos","Lubricantes","Mecánica","Electricidad","Pintura","Chapa","Grúas","Lavado","Alarmas","Audio","GNC","Aire Acondicionado","Suspensión","Frenos","Motor","Transmisión","Escape","Cristales","Tapicería","Tunning"];p.useEffect(()=>{const w=wa(W(F,"categorias"),f=>{e(f.docs.map(b=>({id:b.id,...b.data()})))});return()=>w()},[]);const m=async w=>{if(w.trim()){u(!0);try{await ot(W(F,"categorias"),{nombre:w.trim(),fechaCreacion:new Date,activa:!0}),r(""),console.log("✅ Categoría agregada:",w)}catch(f){console.error("❌ Error agregando categoría:",f),alert("Error al agregar la categoría")}finally{u(!1)}}},h=async(w,f)=>{if(f.trim()){u(!0);try{await ze(Ne(F,"categorias",w),{nombre:f.trim(),fechaModificacion:new Date}),o(null),l(""),console.log("✅ Categoría editada:",f)}catch(b){console.error("❌ Error editando categoría:",b),alert("Error al editar la categoría")}finally{u(!1)}}},C=async(w,f)=>{if(confirm(`¿Estás seguro de eliminar la categoría "${f}"?`)){u(!0);try{await on(Ne(F,"categorias",w)),console.log("✅ Categoría eliminada:",f)}catch(b){console.error("❌ Error eliminando categoría:",b),alert("Error al eliminar la categoría")}finally{u(!1)}}},S=async()=>{if(!confirm("¿Deseas agregar todas las categorías sugeridas que no existen aún?"))return;u(!0);const w=a.map(b=>b.nombre.toLowerCase()),f=d.filter(b=>!w.includes(b.toLowerCase()));try{for(const b of f)await ot(W(F,"categorias"),{nombre:b,fechaCreacion:new Date,activa:!0});console.log(`✅ ${f.length} categorías agregadas`),alert(`Se agregaron ${f.length} categorías nuevas`)}catch(b){console.error("❌ Error agregando categorías sugeridas:",b),alert("Error al agregar las categorías sugeridas")}finally{u(!1)}};return t.createElement("div",{className:"p-6 bg-white rounded-lg shadow-lg"},t.createElement("div",{className:"mb-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Gestión de Categorías"),t.createElement("p",{className:"text-gray-600"},"Administra las categorías de servicios disponibles en la plataforma")),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},t.createElement("div",{className:"bg-blue-50 p-4 rounded-lg"},t.createElement("div",{className:"text-2xl font-bold text-blue-600"},a.length),t.createElement("div",{className:"text-sm text-blue-600"},"Total Categorías")),t.createElement("div",{className:"bg-green-50 p-4 rounded-lg"},t.createElement("div",{className:"text-2xl font-bold text-green-600"},a.filter(w=>w.activa!==!1).length),t.createElement("div",{className:"text-sm text-green-600"},"Activas")),t.createElement("div",{className:"bg-yellow-50 p-4 rounded-lg"},t.createElement("div",{className:"text-2xl font-bold text-yellow-600"},d.filter(w=>!a.some(f=>f.nombre.toLowerCase()===w.toLowerCase())).length),t.createElement("div",{className:"text-sm text-yellow-600"},"Sugeridas Pendientes"))),t.createElement("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg"},t.createElement("h3",{className:"text-lg font-semibold mb-3"},"Agregar Nueva Categoría"),t.createElement("div",{className:"flex gap-2"},t.createElement("input",{type:"text",value:n,onChange:w=>r(w.target.value),placeholder:"Nombre de la categoría",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyPress:w=>w.key==="Enter"&&m(n),disabled:c}),t.createElement("button",{onClick:()=>m(n),disabled:c||!n.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors"},c?"Agregando...":"Agregar"))),t.createElement("div",{className:"mb-6 p-4 bg-yellow-50 rounded-lg"},t.createElement("div",{className:"flex items-center justify-between mb-3"},t.createElement("h3",{className:"text-lg font-semibold"},"Categorías Sugeridas"),t.createElement("button",{onClick:S,disabled:c,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:bg-gray-400 transition-colors text-sm"},c?"Agregando...":"Agregar Todas las Sugeridas")),t.createElement("div",{className:"flex flex-wrap gap-2"},d.map(w=>{const f=a.some(b=>b.nombre.toLowerCase()===w.toLowerCase());return t.createElement("span",{key:w,className:`px-3 py-1 rounded-full text-sm ${f?"bg-green-100 text-green-800 line-through":"bg-yellow-100 text-yellow-800 cursor-pointer hover:bg-yellow-200"}`,onClick:f?void 0:()=>m(w),title:f?"Ya existe":"Clic para agregar"},w," ",f?"✓":"+")}))),t.createElement("div",{className:"overflow-x-auto"},t.createElement("table",{className:"min-w-full bg-white border border-gray-200 rounded-lg"},t.createElement("thead",{className:"bg-gray-50"},t.createElement("tr",null,t.createElement("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b"},"Nombre"),t.createElement("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b"},"Estado"),t.createElement("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b"},"Fecha Creación"),t.createElement("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider border-b"},"Acciones"))),t.createElement("tbody",{className:"divide-y divide-gray-200"},a.length===0?t.createElement("tr",null,t.createElement("td",{colSpan:"4",className:"px-4 py-8 text-center text-gray-500"},t.createElement("div",{className:"text-4xl mb-2"},"📂"),t.createElement("div",null,"No hay categorías registradas"),t.createElement("div",{className:"text-sm mt-2"},"Agrega algunas categorías para comenzar"))):a.map(w=>t.createElement("tr",{key:w.id,className:"hover:bg-gray-50"},t.createElement("td",{className:"px-4 py-3 border-b"},s===w.id?t.createElement("input",{type:"text",value:i,onChange:f=>l(f.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",onKeyPress:f=>{f.key==="Enter"&&h(w.id,i),f.key==="Escape"&&(o(null),l(""))},autoFocus:!0}):t.createElement("span",{className:"font-medium text-gray-900"},w.nombre)),t.createElement("td",{className:"px-4 py-3 border-b"},t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${w.activa!==!1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},w.activa!==!1?"activa":"Inactiva")),t.createElement("td",{className:"px-4 py-3 text-sm text-gray-500 border-b"},w.fechaCreacion?new Date(w.fechaCreacion.toDate()).toLocaleDateString():"No disponible"),t.createElement("td",{className:"px-4 py-3 text-right border-b"},t.createElement("div",{className:"flex justify-end gap-2"},s===w.id?t.createElement(t.Fragment,null,t.createElement("button",{onClick:()=>h(w.id,i),disabled:c,className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-400 text-sm"},"Guardar"),t.createElement("button",{onClick:()=>{o(null),l("")},className:"px-3 py-1 bg-gray-600 text-white rounded hover:bg-gray-700 text-sm"},"Cancelar")):t.createElement(t.Fragment,null,t.createElement("button",{onClick:()=>{o(w.id),l(w.nombre)},className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm"},"Editar"),t.createElement("button",{onClick:()=>C(w.id,w.nombre),disabled:c,className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 disabled:bg-gray-400 text-sm"},"Eliminar"))))))))),c&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white p-6 rounded-lg flex items-center gap-3"},t.createElement("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),t.createElement("span",null,"Procesando..."))))}function $8(){const{rol:a}=ht(),[e,n]=p.useState([]),[r,s]=p.useState(!0),[o,i]=p.useState("pendiente_validacion"),[l,c]=p.useState(null),[u,d]=p.useState(!1),[m,h]=p.useState(""),[C,S]=p.useState({total:0,pendientes:0,activos:0,rechazados:0,suspendidos:0});p.useEffect(()=>{a==="admin"&&(w(),f())},[a,o]);const w=async()=>{try{s(!0);let N;o==="todas"?N=fe(W(F,"perfiles_clientes"),st("fechaRegistro","desc")):N=fe(W(F,"perfiles_clientes"),pe("estado","==",o),st("fechaRegistro","desc"));const y=(await le(N)).docs.map(E=>({id:E.id,...E.data()}));n(y)}catch(N){console.error("Error loading solicitudes:",N)}finally{s(!1)}},f=async()=>{try{const N=fe(W(F,"perfiles_clientes")),y=(await le(N)).docs.map(_=>({id:_.id,..._.data()})),E={total:y.length,pendientes:y.filter(_=>_.estado==="pendiente_validacion").length,activos:y.filter(_=>_.estado==="activo").length,rechazados:y.filter(_=>_.estado==="rechazado").length,suspendidos:y.filter(_=>_.estado==="suspendido").length};S(E)}catch(N){console.error("Error loading statistics:",N)}},b=async(N,x,y="")=>{try{const E=e.find(P=>P.id===N);await ze(Ne(F,"perfiles_clientes",N),{estado:x,validadoPor:"admin",fechaValidacion:new Date,observaciones:y}),await Ws.notifyClientValidationStatus(E.userId,x,y),await w(),await f(),d(!1),h(""),c(null),alert({activo:"Cliente validado exitosamente. Se ha enviado una notificación.",rechazado:"Cliente rechazado. Se ha enviado una notificación con el motivo.",suspendido:"Cliente suspendido. Se ha enviado una notificación."}[x]||"Estado actualizado")}catch(E){console.error("Error validating client:",E),alert("Error al validar cliente")}},v=(N,x)=>{c(N),x==="rechazado"?d(!0):b(N.id,x)},I=N=>{const x={pendiente_validacion:"bg-yellow-100 text-yellow-800",activo:"bg-green-100 text-green-800",rechazado:"bg-red-100 text-red-800",suspendido:"bg-gray-100 text-gray-800"},y={pendiente_validacion:"Pendiente",activo:"Activo",rechazado:"Rechazado",suspendido:"Suspendido"};return t.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${x[N]}`},y[N])},A=N=>{const x=new Date(N.seconds*1e3),E=new Date-x;return Math.floor(E/(1e3*60*60*24))};return a!=="admin"?t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement("div",{className:"text-center"},t.createElement("h1",{className:"text-2xl font-bold text-red-600"},"Acceso Denegado"),t.createElement("p",{className:"text-gray-600"},"No tienes permisos para acceder a esta página."))):r?t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement("div",{className:"animate-pulse"},t.createElement("div",{className:"h-8 bg-gray-300 rounded mb-6"}),t.createElement("div",{className:"space-y-4"},[1,2,3,4,5].map(N=>t.createElement("div",{key:N,className:"h-20 bg-gray-300 rounded"}))))):t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement("div",{className:"bg-white rounded-lg shadow-lg p-6"},t.createElement("div",{className:"flex justify-between items-center mb-6"},t.createElement("div",null,t.createElement("h1",{className:"text-3xl font-bold text-gray-800"},"Validación de Clientes"),t.createElement("p",{className:"text-gray-600"},"Gestiona las solicitudes de ingreso a la comunidad"))),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8"},t.createElement("div",{className:"bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("p",{className:"text-blue-600 text-sm font-medium"},"Total Clientes"),t.createElement("p",{className:"text-2xl font-bold text-blue-800"},C.total)),t.createElement("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})))),t.createElement("div",{className:"bg-yellow-50 p-4 rounded-lg border-l-4 border-yellow-500"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("p",{className:"text-yellow-600 text-sm font-medium"},"Pendientes"),t.createElement("p",{className:"text-2xl font-bold text-yellow-800"},C.pendientes)),t.createElement("svg",{className:"w-8 h-8 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})))),t.createElement("div",{className:"bg-green-50 p-4 rounded-lg border-l-4 border-green-500"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("p",{className:"text-green-600 text-sm font-medium"},"Activos"),t.createElement("p",{className:"text-2xl font-bold text-green-800"},C.activos)),t.createElement("svg",{className:"w-8 h-8 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})))),t.createElement("div",{className:"bg-red-50 p-4 rounded-lg border-l-4 border-red-500"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("p",{className:"text-red-600 text-sm font-medium"},"Rechazados"),t.createElement("p",{className:"text-2xl font-bold text-red-800"},C.rechazados)),t.createElement("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})))),t.createElement("div",{className:"bg-gray-50 p-4 rounded-lg border-l-4 border-gray-500"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("p",{className:"text-gray-600 text-sm font-medium"},"Suspendidos"),t.createElement("p",{className:"text-2xl font-bold text-gray-800"},C.suspendidos)),t.createElement("svg",{className:"w-8 h-8 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636M5.636 18.364l12.728-12.728"}))))),t.createElement("div",{className:"flex gap-2 mb-6"},t.createElement("select",{className:"border rounded px-3 py-2",value:o,onChange:N=>i(N.target.value)},t.createElement("option",{value:"pendiente_validacion"},"Pendientes"),t.createElement("option",{value:"activo"},"Activos"),t.createElement("option",{value:"rechazado"},"Rechazados"),t.createElement("option",{value:"suspendido"},"Suspendidos"),t.createElement("option",{value:"todas"},"Todas"))),t.createElement("div",{className:"space-y-4"},e.length===0?t.createElement("div",{className:"text-center py-8"},t.createElement("p",{className:"text-gray-500"},"No hay solicitudes con el filtro seleccionado.")):e.map(N=>t.createElement("div",{key:N.id,className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"flex justify-between items-start mb-3"},t.createElement("div",{className:"flex-1"},t.createElement("div",{className:"flex items-center gap-3 mb-2"},t.createElement("h3",{className:"font-semibold text-lg"},N.nombres," ",N.apellidos),I(N.estado),N.creado_desde_solicitud&&t.createElement("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full"},"📝 Desde solicitud"),N.estado==="pendiente_validacion"&&t.createElement("span",{className:"text-xs text-orange-600"},A(N.fechaRegistro)," días esperando")),t.createElement("div",{className:"grid md:grid-cols-3 gap-4 text-sm"},t.createElement("div",null,t.createElement("span",{className:"text-gray-600"},"RUT:"),t.createElement("p",{className:"font-medium"},N.rut)),t.createElement("div",null,t.createElement("span",{className:"text-gray-600"},"Email:"),t.createElement("p",{className:"font-medium"},N.email)),t.createElement("div",null,t.createElement("span",{className:"text-gray-600"},"Teléfono:"),t.createElement("p",{className:"font-medium"},N.telefono)),t.createElement("div",null,t.createElement("span",{className:"text-gray-600"},"Ubicación:"),t.createElement("p",{className:"font-medium"},N.comuna,", ",N.region)),t.createElement("div",null,t.createElement("span",{className:"text-gray-600"},"Tipo:"),t.createElement("p",{className:"font-medium"},N.tipoCliente)),t.createElement("div",null,t.createElement("span",{className:"text-gray-600"},"Fecha registro:"),t.createElement("p",{className:"font-medium"},new Date(N.fechaRegistro.seconds*1e3).toLocaleDateString()))),N.motivoRegistro&&t.createElement("div",{className:"mt-3 bg-gray-50 p-3 rounded"},t.createElement("span",{className:"text-sm font-medium text-gray-700"},"Motivo de registro:"),t.createElement("p",{className:"text-sm text-gray-600 mt-1"},N.motivoRegistro)),N.creado_desde_solicitud&&N.solicitud_original_id&&t.createElement("div",{className:"mt-3 bg-blue-50 p-3 rounded"},t.createElement("span",{className:"text-sm font-medium text-blue-700"},"Cliente creado desde solicitud:"),t.createElement("a",{href:`/admin/solicitudes-cliente?highlight=${N.solicitud_original_id}`,className:"text-sm text-blue-600 hover:text-blue-800 underline ml-2",target:"_blank"},"Ver solicitud original →")),N.observaciones&&t.createElement("div",{className:"mt-3 bg-red-50 p-3 rounded"},t.createElement("span",{className:"text-sm font-medium text-red-700"},"Observaciones:"),t.createElement("p",{className:"text-sm text-red-600 mt-1"},N.observaciones)))),N.estado==="pendiente_validacion"&&t.createElement("div",{className:"flex gap-2 pt-3 border-t"},t.createElement("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",onClick:()=>v(N,"activo")},"✅ Aprobar"),t.createElement("button",{className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",onClick:()=>v(N,"rechazado")},"❌ Rechazar"),t.createElement("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"📧 Contactar"),t.createElement("button",{className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700"},"📋 Ver Historial")),N.estado==="activo"&&t.createElement("div",{className:"flex gap-2 pt-3 border-t"},t.createElement("button",{className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700",onClick:()=>v(N,"suspendido")},"⏸️ Suspender"),t.createElement("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"👁️ Ver Actividad")),N.estado==="suspendido"&&t.createElement("div",{className:"flex gap-2 pt-3 border-t"},t.createElement("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",onClick:()=>v(N,"activo")},"▶️ Reactivar")))))),u&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-md"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Motivo del Rechazo"),t.createElement("div",{className:"mb-4"},t.createElement("label",{className:"block text-sm font-medium mb-2"},"Explica el motivo del rechazo:"),t.createElement("textarea",{rows:"4",className:"w-full border rounded px-3 py-2",placeholder:"Especifica las razones por las cuales no se puede aprobar esta solicitud...",value:m,onChange:N=>h(N.target.value),required:!0})),t.createElement("div",{className:"flex gap-2"},t.createElement("button",{className:"flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded hover:bg-gray-50",onClick:()=>{d(!1),h(""),c(null)}},"Cancelar"),t.createElement("button",{className:"flex-1 bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700",onClick:()=>{m.trim()?b(l.id,"rechazado",m):alert("Debes especificar el motivo del rechazo")}},"Confirmar Rechazo")))))}function B8(){const{rol:a}=ht(),[e,n]=p.useState(!0),[r,s]=p.useState({clientes:{total:0,pendientes:0,activos:0,rechazados:0,suspendidos:0},vehiculos:{total:0,porMarca:{},porAño:{},promedioAño:0},notificaciones:{total:0,porTipo:{},noLeidas:0},actividad:{registrosHoy:0,registrosUltimaSemana:0,registrosUltimoMes:0}});p.useEffect(()=>{a==="admin"&&o()},[a]);const o=async()=>{try{n(!0),console.log("🔄 Cargando estadísticas del admin...");let m=[];try{m=(await le(W(F,"clientes"))).docs.map(_=>({id:_.id,..._.data()})),console.log("👥 Clientes encontrados:",m.length)}catch{console.log('⚠️ No se encontró colección "clientes", probando "perfiles_clientes"');try{m=(await le(W(F,"perfiles_clientes"))).docs.map(P=>({id:P.id,...P.data()})),console.log("👥 Perfiles de clientes encontrados:",m.length)}catch{console.log('⚠️ No se encontró colección "perfiles_clientes"')}}let h=[];try{h=(await le(W(F,"empresas"))).docs.map(_=>({id:_.id,..._.data()})),console.log("🏢 Empresas encontradas:",h.length)}catch{console.log('⚠️ No se encontró colección "empresas"')}let C=[];try{C=(await le(W(F,"vehiculos"))).docs.map(_=>({id:_.id,..._.data()})),console.log("🚗 Vehículos encontrados:",C.length)}catch{console.log('⚠️ No se encontró colección "vehiculos"')}let S=[];try{S=(await le(W(F,"notificaciones"))).docs.map(_=>({id:_.id,..._.data()})),console.log("🔔 Notificaciones encontradas:",S.length)}catch{console.log('⚠️ No se encontró colección "notificaciones"')}const w=new Date,f=new Date(w);f.setDate(f.getDate()-1);const b=new Date(w);b.setDate(b.getDate()-7);const v=new Date(w);v.setDate(v.getDate()-30);const I=i(m),A=l(C),N=c(S),x=u([...m,...h],w,f,b,v),y={clientes:I,vehiculos:A,notificaciones:N,actividad:x,empresas:{total:h.length,activas:h.filter(E=>E.estado==="activa"||E.estado==="Activa").length,pendientes:h.filter(E=>E.estado==="pendiente"||E.estado==="en_revision").length}};console.log("✅ Estadísticas procesadas:",y),s(y)}catch(m){console.error("❌ Error cargando estadísticas:",m)}finally{n(!1)}},i=m=>({total:m.length,pendientes:m.filter(h=>h.estado==="pendiente_validacion").length,activos:m.filter(h=>h.estado==="activo").length,rechazados:m.filter(h=>h.estado==="rechazado").length,suspendidos:m.filter(h=>h.estado==="suspendido").length}),l=m=>{const h={},C={};let S=0;return m.forEach(w=>{if(w.marca&&(h[w.marca]=(h[w.marca]||0)+1),w.año){const f=w.año.toString();C[f]=(C[f]||0)+1,S+=parseInt(w.año)}}),{total:m.length,porMarca:h,porAño:C,promedioAño:m.length>0?Math.round(S/m.length):0}},c=m=>{const h={};let C=0;return m.forEach(S=>{S.tipo&&(h[S.tipo]=(h[S.tipo]||0)+1),S.leida||C++}),{total:m.length,porTipo:h,noLeidas:C}},u=(m,h,C,S,w)=>({registrosHoy:m.filter(f=>f.fechaRegistro?(f.fechaRegistro.toDate?f.fechaRegistro.toDate():new Date(f.fechaRegistro)).toDateString()===h.toDateString():!1).length,registrosUltimaSemana:m.filter(f=>f.fechaRegistro?(f.fechaRegistro.toDate?f.fechaRegistro.toDate():new Date(f.fechaRegistro))>=S:!1).length,registrosUltimoMes:m.filter(f=>f.fechaRegistro?(f.fechaRegistro.toDate?f.fechaRegistro.toDate():new Date(f.fechaRegistro))>=w:!1).length}),d=(m,h=5)=>Object.entries(m).sort(([,C],[,S])=>S-C).slice(0,h);return a!=="admin"?t.createElement("div",{className:"text-center p-8"},t.createElement("h2",{className:"text-xl font-bold text-red-600"},"Acceso Denegado"),t.createElement("p",{className:"text-gray-600"},"Solo administradores pueden ver estas estadísticas.")):e?t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement("div",{className:"animate-pulse"},t.createElement("div",{className:"h-8 bg-gray-300 rounded mb-6"}),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},[1,2,3,4].map(m=>t.createElement("div",{key:m,className:"h-32 bg-gray-300 rounded"}))))):t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement("div",{className:"bg-white rounded-lg shadow-lg p-6"},t.createElement("div",{className:"flex justify-between items-center mb-8"},t.createElement("div",null,t.createElement("h1",{className:"text-3xl font-bold text-gray-800"},"Dashboard Administrativo"),t.createElement("p",{className:"text-gray-600"},"Métricas y estadísticas del sistema")),t.createElement("button",{onClick:o,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex items-center gap-2"},t.createElement("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})),"Actualizar")),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},t.createElement("div",{className:"bg-blue-50 p-6 rounded-lg border-l-4 border-blue-500"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("p",{className:"text-blue-600 text-sm font-medium"},"Total Clientes"),t.createElement("p",{className:"text-3xl font-bold text-blue-800"},r.clientes.total),t.createElement("p",{className:"text-xs text-blue-600 mt-1"},r.clientes.pendientes," pendientes")),t.createElement("svg",{className:"w-12 h-12 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})))),t.createElement("div",{className:"bg-green-50 p-6 rounded-lg border-l-4 border-green-500"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("p",{className:"text-green-600 text-sm font-medium"},"Total Vehículos"),t.createElement("p",{className:"text-3xl font-bold text-green-800"},r.vehiculos.total),t.createElement("p",{className:"text-xs text-green-600 mt-1"},"Año promedio: ",r.vehiculos.promedioAño)),t.createElement("svg",{className:"w-12 h-12 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14l-1.2 4.8a2 2 0 01-1.9 1.2H8.1a2 2 0 01-1.9-1.2L5 8zm5-3V3a1 1 0 011-1h2a1 1 0 011 1v2m-4 0h4"})))),t.createElement("div",{className:"bg-yellow-50 p-6 rounded-lg border-l-4 border-yellow-500"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("p",{className:"text-yellow-600 text-sm font-medium"},"Notificaciones"),t.createElement("p",{className:"text-3xl font-bold text-yellow-800"},r.notificaciones.total),t.createElement("p",{className:"text-xs text-yellow-600 mt-1"},r.notificaciones.noLeidas," sin leer")),t.createElement("svg",{className:"w-12 h-12 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})))),t.createElement("div",{className:"bg-purple-50 p-6 rounded-lg border-l-4 border-purple-500"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("p",{className:"text-purple-600 text-sm font-medium"},"Registros Hoy"),t.createElement("p",{className:"text-3xl font-bold text-purple-800"},r.actividad.registrosHoy),t.createElement("p",{className:"text-xs text-purple-600 mt-1"},r.actividad.registrosUltimaSemana," esta semana")),t.createElement("svg",{className:"w-12 h-12 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"}))))),t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8"},t.createElement("div",{className:"bg-gray-50 p-6 rounded-lg"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Top Marcas de Vehículos"),t.createElement("div",{className:"space-y-3"},d(r.vehiculos.porMarca).map(([m,h])=>t.createElement("div",{key:m,className:"flex justify-between items-center"},t.createElement("span",{className:"font-medium"},m),t.createElement("div",{className:"flex items-center gap-2"},t.createElement("div",{className:"bg-blue-200 h-2 rounded",style:{width:`${h/Math.max(...Object.values(r.vehiculos.porMarca))*100}px`}}),t.createElement("span",{className:"text-sm text-gray-600"},h)))))),t.createElement("div",{className:"bg-gray-50 p-6 rounded-lg"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Estados de Clientes"),t.createElement("div",{className:"space-y-3"},t.createElement("div",{className:"flex justify-between items-center"},t.createElement("span",{className:"text-green-600"},"✅ Activos"),t.createElement("span",{className:"font-semibold"},r.clientes.activos)),t.createElement("div",{className:"flex justify-between items-center"},t.createElement("span",{className:"text-yellow-600"},"⏳ Pendientes"),t.createElement("span",{className:"font-semibold"},r.clientes.pendientes)),t.createElement("div",{className:"flex justify-between items-center"},t.createElement("span",{className:"text-red-600"},"❌ Rechazados"),t.createElement("span",{className:"font-semibold"},r.clientes.rechazados)),t.createElement("div",{className:"flex justify-between items-center"},t.createElement("span",{className:"text-gray-600"},"⚠️ Suspendidos"),t.createElement("span",{className:"font-semibold"},r.clientes.suspendidos)))),t.createElement("div",{className:"bg-gray-50 p-6 rounded-lg"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Tipos de Notificaciones"),t.createElement("div",{className:"space-y-3"},d(r.notificaciones.porTipo).map(([m,h])=>t.createElement("div",{key:m,className:"flex justify-between items-center"},t.createElement("span",{className:"font-medium capitalize"},m.replace("_"," ")),t.createElement("span",{className:"text-sm text-gray-600"},h))))),t.createElement("div",{className:"bg-gray-50 p-6 rounded-lg"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Actividad Reciente"),t.createElement("div",{className:"space-y-3"},t.createElement("div",{className:"flex justify-between items-center"},t.createElement("span",null,"📅 Registros hoy"),t.createElement("span",{className:"font-semibold"},r.actividad.registrosHoy)),t.createElement("div",{className:"flex justify-between items-center"},t.createElement("span",null,"📅 Esta semana"),t.createElement("span",{className:"font-semibold"},r.actividad.registrosUltimaSemana)),t.createElement("div",{className:"flex justify-between items-center"},t.createElement("span",null,"📅 Este mes"),t.createElement("span",{className:"font-semibold"},r.actividad.registrosUltimoMes))))),t.createElement("div",{className:"mt-8 flex flex-wrap gap-4"},t.createElement("button",{onClick:()=>window.location.href="/admin/validacion-clientes",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"Validar Clientes"),t.createElement("button",{onClick:()=>window.location.href="/admin/marcas",className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"},"Gestionar Marcas"),t.createElement("button",{onClick:()=>window.location.href="/admin/tipos-empresa",className:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700"},"Tipos de Empresa"))))}var oT={exports:{}},q8="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",W8=q8,G8=W8;function iT(){}function lT(){}lT.resetWarningCache=iT;var H8=function(){function a(r,s,o,i,l,c){if(c!==G8){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}a.isRequired=a;function e(){return a}var n={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:e,element:a,elementType:a,instanceOf:e,node:a,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:lT,resetWarningCache:iT};return n.PropTypes=n,n};oT.exports=H8();var K8=oT.exports;const zt=nv(K8),Q8=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function zl(a,e,n){const r=J8(a),{webkitRelativePath:s}=a,o=typeof e=="string"?e:typeof s=="string"&&s.length>0?s:`./${a.name}`;return typeof r.path!="string"&&D_(r,"path",o),n!==void 0&&Object.defineProperty(r,"handle",{value:n,writable:!1,configurable:!1,enumerable:!0}),D_(r,"relativePath",o),r}function J8(a){const{name:e}=a;if(e&&e.lastIndexOf(".")!==-1&&!a.type){const r=e.split(".").pop().toLowerCase(),s=Q8.get(r);s&&Object.defineProperty(a,"type",{value:s,writable:!1,configurable:!1,enumerable:!0})}return a}function D_(a,e,n){Object.defineProperty(a,e,{value:n,writable:!1,configurable:!1,enumerable:!0})}const Y8=[".DS_Store","Thumbs.db"];function Z8(a){return xi(this,void 0,void 0,function*(){return Xp(a)&&X8(a.dataTransfer)?n9(a.dataTransfer,a.type):e9(a)?t9(a):Array.isArray(a)&&a.every(e=>"getFile"in e&&typeof e.getFile=="function")?a9(a):[]})}function X8(a){return Xp(a)}function e9(a){return Xp(a)&&Xp(a.target)}function Xp(a){return typeof a=="object"&&a!==null}function t9(a){return Y0(a.target.files).map(e=>zl(e))}function a9(a){return xi(this,void 0,void 0,function*(){return(yield Promise.all(a.map(n=>n.getFile()))).map(n=>zl(n))})}function n9(a,e){return xi(this,void 0,void 0,function*(){if(a.items){const n=Y0(a.items).filter(s=>s.kind==="file");if(e!=="drop")return n;const r=yield Promise.all(n.map(r9));return L_(cT(r))}return L_(Y0(a.files).map(n=>zl(n)))})}function L_(a){return a.filter(e=>Y8.indexOf(e.name)===-1)}function Y0(a){if(a===null)return[];const e=[];for(let n=0;n<a.length;n++){const r=a[n];e.push(r)}return e}function r9(a){if(typeof a.webkitGetAsEntry!="function")return M_(a);const e=a.webkitGetAsEntry();return e&&e.isDirectory?uT(e):M_(a,e)}function cT(a){return a.reduce((e,n)=>[...e,...Array.isArray(n)?cT(n):[n]],[])}function M_(a,e){return xi(this,void 0,void 0,function*(){var n;if(globalThis.isSecureContext&&typeof a.getAsFileSystemHandle=="function"){const o=yield a.getAsFileSystemHandle();if(o===null)throw new Error(`${a} is not a File`);if(o!==void 0){const i=yield o.getFile();return i.handle=o,zl(i)}}const r=a.getAsFile();if(!r)throw new Error(`${a} is not a File`);return zl(r,(n=e==null?void 0:e.fullPath)!==null&&n!==void 0?n:void 0)})}function s9(a){return xi(this,void 0,void 0,function*(){return a.isDirectory?uT(a):o9(a)})}function uT(a){const e=a.createReader();return new Promise((n,r)=>{const s=[];function o(){e.readEntries(i=>xi(this,void 0,void 0,function*(){if(i.length){const l=Promise.all(i.map(s9));s.push(l),o()}else try{const l=yield Promise.all(s);n(l)}catch(l){r(l)}}),i=>{r(i)})}o()})}function o9(a){return xi(this,void 0,void 0,function*(){return new Promise((e,n)=>{a.file(r=>{const s=zl(r,a.fullPath);e(s)},r=>{n(r)})})})}var fh=function(a,e){if(a&&e){var n=Array.isArray(e)?e:e.split(",");if(n.length===0)return!0;var r=a.name||"",s=(a.type||"").toLowerCase(),o=s.replace(/\/.*$/,"");return n.some(function(i){var l=i.trim().toLowerCase();return l.charAt(0)==="."?r.toLowerCase().endsWith(l):l.endsWith("/*")?o===l.replace(/\/.*$/,""):s===l})}return!0};function V_(a){return c9(a)||l9(a)||mT(a)||i9()}function i9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l9(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function c9(a){if(Array.isArray(a))return Z0(a)}function O_(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function j_(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?O_(Object(n),!0).forEach(function(r){dT(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):O_(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}function dT(a,e,n){return e in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}function Hu(a,e){return m9(a)||d9(a,e)||mT(a,e)||u9()}function u9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mT(a,e){if(a){if(typeof a=="string")return Z0(a,e);var n=Object.prototype.toString.call(a).slice(8,-1);if(n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set")return Array.from(a);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z0(a,e)}}function Z0(a,e){(e==null||e>a.length)&&(e=a.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=a[n];return r}function d9(a,e){var n=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(n!=null){var r=[],s=!0,o=!1,i,l;try{for(n=n.call(a);!(s=(i=n.next()).done)&&(r.push(i.value),!(e&&r.length===e));s=!0);}catch(c){o=!0,l=c}finally{try{!s&&n.return!=null&&n.return()}finally{if(o)throw l}}return r}}function m9(a){if(Array.isArray(a))return a}var p9=typeof fh=="function"?fh:fh.default,g9="file-invalid-type",f9="file-too-large",h9="file-too-small",v9="too-many-files",b9=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=e.split(","),r=n.length>1?"one of ".concat(n.join(", ")):n[0];return{code:g9,message:"File type must be ".concat(r)}},F_=function(e){return{code:f9,message:"File is larger than ".concat(e," ").concat(e===1?"byte":"bytes")}},z_=function(e){return{code:h9,message:"File is smaller than ".concat(e," ").concat(e===1?"byte":"bytes")}},E9={code:v9,message:"Too many files"};function pT(a,e){var n=a.type==="application/x-moz-file"||p9(a,e);return[n,n?null:b9(e)]}function gT(a,e,n){if(Ro(a.size))if(Ro(e)&&Ro(n)){if(a.size>n)return[!1,F_(n)];if(a.size<e)return[!1,z_(e)]}else{if(Ro(e)&&a.size<e)return[!1,z_(e)];if(Ro(n)&&a.size>n)return[!1,F_(n)]}return[!0,null]}function Ro(a){return a!=null}function x9(a){var e=a.files,n=a.accept,r=a.minSize,s=a.maxSize,o=a.multiple,i=a.maxFiles,l=a.validator;return!o&&e.length>1||o&&i>=1&&e.length>i?!1:e.every(function(c){var u=pT(c,n),d=Hu(u,1),m=d[0],h=gT(c,r,s),C=Hu(h,1),S=C[0],w=l?l(c):null;return m&&S&&!w})}function eg(a){return typeof a.isPropagationStopped=="function"?a.isPropagationStopped():typeof a.cancelBubble<"u"?a.cancelBubble:!1}function ym(a){return a.dataTransfer?Array.prototype.some.call(a.dataTransfer.types,function(e){return e==="Files"||e==="application/x-moz-file"}):!!a.target&&!!a.target.files}function U_(a){a.preventDefault()}function y9(a){return a.indexOf("MSIE")!==-1||a.indexOf("Trident/")!==-1}function N9(a){return a.indexOf("Edge/")!==-1}function w9(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return y9(a)||N9(a)}function gr(){for(var a=arguments.length,e=new Array(a),n=0;n<a;n++)e[n]=arguments[n];return function(r){for(var s=arguments.length,o=new Array(s>1?s-1:0),i=1;i<s;i++)o[i-1]=arguments[i];return e.some(function(l){return!eg(r)&&l&&l.apply(void 0,[r].concat(o)),eg(r)})}}function _9(){return"showOpenFilePicker"in window}function C9(a){if(Ro(a)){var e=Object.entries(a).filter(function(n){var r=Hu(n,2),s=r[0],o=r[1],i=!0;return fT(s)||(console.warn('Skipped "'.concat(s,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),i=!1),(!Array.isArray(o)||!o.every(hT))&&(console.warn('Skipped "'.concat(s,'" because an invalid file extension was provided.')),i=!1),i}).reduce(function(n,r){var s=Hu(r,2),o=s[0],i=s[1];return j_(j_({},n),{},dT({},o,i))},{});return[{description:"Files",accept:e}]}return a}function S9(a){if(Ro(a))return Object.entries(a).reduce(function(e,n){var r=Hu(n,2),s=r[0],o=r[1];return[].concat(V_(e),[s],V_(o))},[]).filter(function(e){return fT(e)||hT(e)}).join(",")}function k9(a){return a instanceof DOMException&&(a.name==="AbortError"||a.code===a.ABORT_ERR)}function I9(a){return a instanceof DOMException&&(a.name==="SecurityError"||a.code===a.SECURITY_ERR)}function fT(a){return a==="audio/*"||a==="video/*"||a==="image/*"||a==="text/*"||a==="application/*"||/\w+\/[-+.\w]+/g.test(a)}function hT(a){return/^.*\.[\w]+$/.test(a)}var A9=["children"],T9=["open"],P9=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],R9=["refKey","onChange","onClick"];function D9(a){return V9(a)||M9(a)||vT(a)||L9()}function L9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M9(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function V9(a){if(Array.isArray(a))return X0(a)}function hh(a,e){return F9(a)||j9(a,e)||vT(a,e)||O9()}function O9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vT(a,e){if(a){if(typeof a=="string")return X0(a,e);var n=Object.prototype.toString.call(a).slice(8,-1);if(n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set")return Array.from(a);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X0(a,e)}}function X0(a,e){(e==null||e>a.length)&&(e=a.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=a[n];return r}function j9(a,e){var n=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(n!=null){var r=[],s=!0,o=!1,i,l;try{for(n=n.call(a);!(s=(i=n.next()).done)&&(r.push(i.value),!(e&&r.length===e));s=!0);}catch(c){o=!0,l=c}finally{try{!s&&n.return!=null&&n.return()}finally{if(o)throw l}}return r}}function F9(a){if(Array.isArray(a))return a}function $_(a,e){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),n.push.apply(n,r)}return n}function na(a){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?$_(Object(n),!0).forEach(function(r){ev(a,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):$_(Object(n)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(n,r))})}return a}function ev(a,e,n){return e in a?Object.defineProperty(a,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[e]=n,a}function tg(a,e){if(a==null)return{};var n=z9(a,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(a,r)&&(n[r]=a[r])}return n}function z9(a,e){if(a==null)return{};var n={},r=Object.keys(a),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=a[s]);return n}var ME=p.forwardRef(function(a,e){var n=a.children,r=tg(a,A9),s=ET(r),o=s.open,i=tg(s,T9);return p.useImperativeHandle(e,function(){return{open:o}},[o]),t.createElement(p.Fragment,null,n(na(na({},i),{},{open:o})))});ME.displayName="Dropzone";var bT={disabled:!1,getFilesFromEvent:Z8,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};ME.defaultProps=bT;ME.propTypes={children:zt.func,accept:zt.objectOf(zt.arrayOf(zt.string)),multiple:zt.bool,preventDropOnDocument:zt.bool,noClick:zt.bool,noKeyboard:zt.bool,noDrag:zt.bool,noDragEventsBubbling:zt.bool,minSize:zt.number,maxSize:zt.number,maxFiles:zt.number,disabled:zt.bool,getFilesFromEvent:zt.func,onFileDialogCancel:zt.func,onFileDialogOpen:zt.func,useFsAccessApi:zt.bool,autoFocus:zt.bool,onDragEnter:zt.func,onDragLeave:zt.func,onDragOver:zt.func,onDrop:zt.func,onDropAccepted:zt.func,onDropRejected:zt.func,onError:zt.func,validator:zt.func};var tv={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function ET(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=na(na({},bT),a),n=e.accept,r=e.disabled,s=e.getFilesFromEvent,o=e.maxSize,i=e.minSize,l=e.multiple,c=e.maxFiles,u=e.onDragEnter,d=e.onDragLeave,m=e.onDragOver,h=e.onDrop,C=e.onDropAccepted,S=e.onDropRejected,w=e.onFileDialogCancel,f=e.onFileDialogOpen,b=e.useFsAccessApi,v=e.autoFocus,I=e.preventDropOnDocument,A=e.noClick,N=e.noKeyboard,x=e.noDrag,y=e.noDragEventsBubbling,E=e.onError,_=e.validator,P=p.useMemo(function(){return S9(n)},[n]),k=p.useMemo(function(){return C9(n)},[n]),D=p.useMemo(function(){return typeof f=="function"?f:B_},[f]),M=p.useMemo(function(){return typeof w=="function"?w:B_},[w]),$=p.useRef(null),q=p.useRef(null),V=p.useReducer(U9,tv),z=hh(V,2),j=z[0],U=z[1],Q=j.isFocused,te=j.isFileDialogActive,se=p.useRef(typeof window<"u"&&window.isSecureContext&&b&&_9()),X=function(){!se.current&&te&&setTimeout(function(){if(q.current){var Re=q.current.files;Re.length||(U({type:"closeDialog"}),M())}},300)};p.useEffect(function(){return window.addEventListener("focus",X,!1),function(){window.removeEventListener("focus",X,!1)}},[q,te,M,se]);var ye=p.useRef([]),Y=function(Re){$.current&&$.current.contains(Re.target)||(Re.preventDefault(),ye.current=[])};p.useEffect(function(){return I&&(document.addEventListener("dragover",U_,!1),document.addEventListener("drop",Y,!1)),function(){I&&(document.removeEventListener("dragover",U_),document.removeEventListener("drop",Y))}},[$,I]),p.useEffect(function(){return!r&&v&&$.current&&$.current.focus(),function(){}},[$,v,r]);var Se=p.useCallback(function(be){E?E(be):console.error(be)},[E]),de=p.useCallback(function(be){be.preventDefault(),be.persist(),Pe(be),ye.current=[].concat(D9(ye.current),[be.target]),ym(be)&&Promise.resolve(s(be)).then(function(Re){if(!(eg(be)&&!y)){var qe=Re.length,Me=qe>0&&x9({files:Re,accept:P,minSize:i,maxSize:o,multiple:l,maxFiles:c,validator:_}),Xe=qe>0&&!Me;U({isDragAccept:Me,isDragReject:Xe,isDragActive:!0,type:"setDraggedFiles"}),u&&u(be)}}).catch(function(Re){return Se(Re)})},[s,u,Se,y,P,i,o,l,c,_]),oe=p.useCallback(function(be){be.preventDefault(),be.persist(),Pe(be);var Re=ym(be);if(Re&&be.dataTransfer)try{be.dataTransfer.dropEffect="copy"}catch{}return Re&&m&&m(be),!1},[m,y]),ge=p.useCallback(function(be){be.preventDefault(),be.persist(),Pe(be);var Re=ye.current.filter(function(Me){return $.current&&$.current.contains(Me)}),qe=Re.indexOf(be.target);qe!==-1&&Re.splice(qe,1),ye.current=Re,!(Re.length>0)&&(U({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),ym(be)&&d&&d(be))},[$,d,y]),me=p.useCallback(function(be,Re){var qe=[],Me=[];be.forEach(function(Xe){var ft=pT(Xe,P),ca=hh(ft,2),ea=ca[0],Tt=ca[1],He=gT(Xe,i,o),$t=hh(He,2),ne=$t[0],K=$t[1],Ge=_?_(Xe):null;if(ea&&ne&&!Ge)qe.push(Xe);else{var Ke=[Tt,K];Ge&&(Ke=Ke.concat(Ge)),Me.push({file:Xe,errors:Ke.filter(function(Ze){return Ze})})}}),(!l&&qe.length>1||l&&c>=1&&qe.length>c)&&(qe.forEach(function(Xe){Me.push({file:Xe,errors:[E9]})}),qe.splice(0)),U({acceptedFiles:qe,fileRejections:Me,isDragReject:Me.length>0,type:"setFiles"}),h&&h(qe,Me,Re),Me.length>0&&S&&S(Me,Re),qe.length>0&&C&&C(qe,Re)},[U,l,P,i,o,c,h,C,S,_]),he=p.useCallback(function(be){be.preventDefault(),be.persist(),Pe(be),ye.current=[],ym(be)&&Promise.resolve(s(be)).then(function(Re){eg(be)&&!y||me(Re,be)}).catch(function(Re){return Se(Re)}),U({type:"reset"})},[s,me,Se,y]),G=p.useCallback(function(){if(se.current){U({type:"openDialog"}),D();var be={multiple:l,types:k};window.showOpenFilePicker(be).then(function(Re){return s(Re)}).then(function(Re){me(Re,null),U({type:"closeDialog"})}).catch(function(Re){k9(Re)?(M(Re),U({type:"closeDialog"})):I9(Re)?(se.current=!1,q.current?(q.current.value=null,q.current.click()):Se(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):Se(Re)});return}q.current&&(U({type:"openDialog"}),D(),q.current.value=null,q.current.click())},[U,D,M,b,me,Se,k,l]),we=p.useCallback(function(be){!$.current||!$.current.isEqualNode(be.target)||(be.key===" "||be.key==="Enter"||be.keyCode===32||be.keyCode===13)&&(be.preventDefault(),G())},[$,G]),Te=p.useCallback(function(){U({type:"focus"})},[]),B=p.useCallback(function(){U({type:"blur"})},[]),ve=p.useCallback(function(){A||(w9()?setTimeout(G,0):G())},[A,G]),je=function(Re){return r?null:Re},_e=function(Re){return N?null:je(Re)},H=function(Re){return x?null:je(Re)},Pe=function(Re){y&&Re.stopPropagation()},Ye=p.useMemo(function(){return function(){var be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Re=be.refKey,qe=Re===void 0?"ref":Re,Me=be.role,Xe=be.onKeyDown,ft=be.onFocus,ca=be.onBlur,ea=be.onClick,Tt=be.onDragEnter,He=be.onDragOver,$t=be.onDragLeave,ne=be.onDrop,K=tg(be,P9);return na(na(ev({onKeyDown:_e(gr(Xe,we)),onFocus:_e(gr(ft,Te)),onBlur:_e(gr(ca,B)),onClick:je(gr(ea,ve)),onDragEnter:H(gr(Tt,de)),onDragOver:H(gr(He,oe)),onDragLeave:H(gr($t,ge)),onDrop:H(gr(ne,he)),role:typeof Me=="string"&&Me!==""?Me:"presentation"},qe,$),!r&&!N?{tabIndex:0}:{}),K)}},[$,we,Te,B,ve,de,oe,ge,he,N,x,r]),it=p.useCallback(function(be){be.stopPropagation()},[]),mt=p.useMemo(function(){return function(){var be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Re=be.refKey,qe=Re===void 0?"ref":Re,Me=be.onChange,Xe=be.onClick,ft=tg(be,R9),ca=ev({accept:P,multiple:l,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:je(gr(Me,he)),onClick:je(gr(Xe,it)),tabIndex:-1},qe,q);return na(na({},ca),ft)}},[q,n,l,he,r]);return na(na({},j),{},{isFocused:Q&&!r,getRootProps:Ye,getInputProps:mt,rootRef:$,inputRef:q,open:je(G)})}function U9(a,e){switch(e.type){case"focus":return na(na({},a),{},{isFocused:!0});case"blur":return na(na({},a),{},{isFocused:!1});case"openDialog":return na(na({},tv),{},{isFileDialogActive:!0});case"closeDialog":return na(na({},a),{},{isFileDialogActive:!1});case"setDraggedFiles":return na(na({},a),{},{isDragActive:e.isDragActive,isDragAccept:e.isDragAccept,isDragReject:e.isDragReject});case"setFiles":return na(na({},a),{},{acceptedFiles:e.acceptedFiles,fileRejections:e.fileRejections,isDragReject:e.isDragReject});case"reset":return na({},tv);default:return a}}function B_(){}var xT={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(a,e){((n,r)=>{a.exports=r()})(Y_,function n(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},s,o=!r.document&&!!r.postMessage,i=r.IS_PAPA_WORKER||!1,l={},c=0,u={};function d(E){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(_){var P=N(_);P.chunkSize=parseInt(P.chunkSize),_.step||_.chunk||(P.chunkSize=null),this._handle=new w(P),(this._handle.streamer=this)._config=P}).call(this,E),this.parseChunk=function(_,P){var k=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<k){let M=this._config.newline;M||(D=this._config.quoteChar||'"',M=this._handle.guessLineEndings(_,D)),_=[..._.split(M).slice(k)].join(M)}this.isFirstChunk&&y(this._config.beforeFirstChunk)&&(D=this._config.beforeFirstChunk(_))!==void 0&&(_=D),this.isFirstChunk=!1,this._halted=!1;var k=this._partialLine+_,D=(this._partialLine="",this._handle.parse(k,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(_=D.meta.cursor,k=(this._finished||(this._partialLine=k.substring(_-this._baseIndex),this._baseIndex=_),D&&D.data&&(this._rowCount+=D.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),i)r.postMessage({results:D,workerId:u.WORKER_ID,finished:k});else if(y(this._config.chunk)&&!P){if(this._config.chunk(D,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=D=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(D.data),this._completeResults.errors=this._completeResults.errors.concat(D.errors),this._completeResults.meta=D.meta),this._completed||!k||!y(this._config.complete)||D&&D.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),k||D&&D.meta.paused||this._nextChunk(),D}this._halted=!0},this._sendError=function(_){y(this._config.error)?this._config.error(_):i&&this._config.error&&r.postMessage({workerId:u.WORKER_ID,error:_,finished:!1})}}function m(E){var _;(E=E||{}).chunkSize||(E.chunkSize=u.RemoteChunkSize),d.call(this,E),this._nextChunk=o?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(P){this._input=P,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(_=new XMLHttpRequest,this._config.withCredentials&&(_.withCredentials=this._config.withCredentials),o||(_.onload=x(this._chunkLoaded,this),_.onerror=x(this._chunkError,this)),_.open(this._config.downloadRequestBody?"POST":"GET",this._input,!o),this._config.downloadRequestHeaders){var P,k=this._config.downloadRequestHeaders;for(P in k)_.setRequestHeader(P,k[P])}var D;this._config.chunkSize&&(D=this._start+this._config.chunkSize-1,_.setRequestHeader("Range","bytes="+this._start+"-"+D));try{_.send(this._config.downloadRequestBody)}catch(M){this._chunkError(M.message)}o&&_.status===0&&this._chunkError()}},this._chunkLoaded=function(){_.readyState===4&&(_.status<200||400<=_.status?this._chunkError():(this._start+=this._config.chunkSize||_.responseText.length,this._finished=!this._config.chunkSize||this._start>=(P=>(P=P.getResponseHeader("Content-Range"))!==null?parseInt(P.substring(P.lastIndexOf("/")+1)):-1)(_),this.parseChunk(_.responseText)))},this._chunkError=function(P){P=_.statusText||P,this._sendError(new Error(P))}}function h(E){(E=E||{}).chunkSize||(E.chunkSize=u.LocalChunkSize),d.call(this,E);var _,P,k=typeof FileReader<"u";this.stream=function(D){this._input=D,P=D.slice||D.webkitSlice||D.mozSlice,k?((_=new FileReader).onload=x(this._chunkLoaded,this),_.onerror=x(this._chunkError,this)):_=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var D=this._input,M=(this._config.chunkSize&&(M=Math.min(this._start+this._config.chunkSize,this._input.size),D=P.call(D,this._start,M)),_.readAsText(D,this._config.encoding));k||this._chunkLoaded({target:{result:M}})},this._chunkLoaded=function(D){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(D.target.result)},this._chunkError=function(){this._sendError(_.error)}}function C(E){var _;d.call(this,E=E||{}),this.stream=function(P){return _=P,this._nextChunk()},this._nextChunk=function(){var P,k;if(!this._finished)return P=this._config.chunkSize,_=P?(k=_.substring(0,P),_.substring(P)):(k=_,""),this._finished=!_,this.parseChunk(k)}}function S(E){d.call(this,E=E||{});var _=[],P=!0,k=!1;this.pause=function(){d.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){d.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(D){this._input=D,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){k&&_.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),_.length?this.parseChunk(_.shift()):P=!0},this._streamData=x(function(D){try{_.push(typeof D=="string"?D:D.toString(this._config.encoding)),P&&(P=!1,this._checkIsFinished(),this.parseChunk(_.shift()))}catch(M){this._streamError(M)}},this),this._streamError=x(function(D){this._streamCleanUp(),this._sendError(D)},this),this._streamEnd=x(function(){this._streamCleanUp(),k=!0,this._streamData("")},this),this._streamCleanUp=x(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function w(E){var _,P,k,D,M=Math.pow(2,53),$=-M,q=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,V=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,z=this,j=0,U=0,Q=!1,te=!1,se=[],X={data:[],errors:[],meta:{}};function ye(oe){return E.skipEmptyLines==="greedy"?oe.join("").trim()==="":oe.length===1&&oe[0].length===0}function Y(){if(X&&k&&(de("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),k=!1),E.skipEmptyLines&&(X.data=X.data.filter(function(he){return!ye(he)})),Se()){let he=function(G,we){y(E.transformHeader)&&(G=E.transformHeader(G,we)),se.push(G)};if(X)if(Array.isArray(X.data[0])){for(var oe=0;Se()&&oe<X.data.length;oe++)X.data[oe].forEach(he);X.data.splice(0,1)}else X.data.forEach(he)}function ge(he,G){for(var we=E.header?{}:[],Te=0;Te<he.length;Te++){var B=Te,ve=he[Te],ve=((je,_e)=>(H=>(E.dynamicTypingFunction&&E.dynamicTyping[H]===void 0&&(E.dynamicTyping[H]=E.dynamicTypingFunction(H)),(E.dynamicTyping[H]||E.dynamicTyping)===!0))(je)?_e==="true"||_e==="TRUE"||_e!=="false"&&_e!=="FALSE"&&((H=>{if(q.test(H)&&(H=parseFloat(H),$<H&&H<M))return 1})(_e)?parseFloat(_e):V.test(_e)?new Date(_e):_e===""?null:_e):_e)(B=E.header?Te>=se.length?"__parsed_extra":se[Te]:B,ve=E.transform?E.transform(ve,B):ve);B==="__parsed_extra"?(we[B]=we[B]||[],we[B].push(ve)):we[B]=ve}return E.header&&(Te>se.length?de("FieldMismatch","TooManyFields","Too many fields: expected "+se.length+" fields but parsed "+Te,U+G):Te<se.length&&de("FieldMismatch","TooFewFields","Too few fields: expected "+se.length+" fields but parsed "+Te,U+G)),we}var me;X&&(E.header||E.dynamicTyping||E.transform)&&(me=1,!X.data.length||Array.isArray(X.data[0])?(X.data=X.data.map(ge),me=X.data.length):X.data=ge(X.data,0),E.header&&X.meta&&(X.meta.fields=se),U+=me)}function Se(){return E.header&&se.length===0}function de(oe,ge,me,he){oe={type:oe,code:ge,message:me},he!==void 0&&(oe.row=he),X.errors.push(oe)}y(E.step)&&(D=E.step,E.step=function(oe){X=oe,Se()?Y():(Y(),X.data.length!==0&&(j+=oe.data.length,E.preview&&j>E.preview?P.abort():(X.data=X.data[0],D(X,z))))}),this.parse=function(oe,ge,me){var he=E.quoteChar||'"',he=(E.newline||(E.newline=this.guessLineEndings(oe,he)),k=!1,E.delimiter?y(E.delimiter)&&(E.delimiter=E.delimiter(oe),X.meta.delimiter=E.delimiter):((he=((G,we,Te,B,ve)=>{var je,_e,H,Pe;ve=ve||[",","	","|",";",u.RECORD_SEP,u.UNIT_SEP];for(var Ye=0;Ye<ve.length;Ye++){for(var it,mt=ve[Ye],be=0,Re=0,qe=0,Me=(H=void 0,new b({comments:B,delimiter:mt,newline:we,preview:10}).parse(G)),Xe=0;Xe<Me.data.length;Xe++)Te&&ye(Me.data[Xe])?qe++:(it=Me.data[Xe].length,Re+=it,H===void 0?H=it:0<it&&(be+=Math.abs(it-H),H=it));0<Me.data.length&&(Re/=Me.data.length-qe),(_e===void 0||be<=_e)&&(Pe===void 0||Pe<Re)&&1.99<Re&&(_e=be,je=mt,Pe=Re)}return{successful:!!(E.delimiter=je),bestDelimiter:je}})(oe,E.newline,E.skipEmptyLines,E.comments,E.delimitersToGuess)).successful?E.delimiter=he.bestDelimiter:(k=!0,E.delimiter=u.DefaultDelimiter),X.meta.delimiter=E.delimiter),N(E));return E.preview&&E.header&&he.preview++,_=oe,P=new b(he),X=P.parse(_,ge,me),Y(),Q?{meta:{paused:!0}}:X||{meta:{paused:!1}}},this.paused=function(){return Q},this.pause=function(){Q=!0,P.abort(),_=y(E.chunk)?"":_.substring(P.getCharIndex())},this.resume=function(){z.streamer._halted?(Q=!1,z.streamer.parseChunk(_,!0)):setTimeout(z.resume,3)},this.aborted=function(){return te},this.abort=function(){te=!0,P.abort(),X.meta.aborted=!0,y(E.complete)&&E.complete(X),_=""},this.guessLineEndings=function(G,he){G=G.substring(0,1048576);var he=new RegExp(f(he)+"([^]*?)"+f(he),"gm"),me=(G=G.replace(he,"")).split("\r"),he=G.split(`
`),G=1<he.length&&he[0].length<me[0].length;if(me.length===1||G)return`
`;for(var we=0,Te=0;Te<me.length;Te++)me[Te][0]===`
`&&we++;return we>=me.length/2?`\r
`:"\r"}}function f(E){return E.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function b(E){var _=(E=E||{}).delimiter,P=E.newline,k=E.comments,D=E.step,M=E.preview,$=E.fastMode,q=null,V=!1,z=E.quoteChar==null?'"':E.quoteChar,j=z;if(E.escapeChar!==void 0&&(j=E.escapeChar),(typeof _!="string"||-1<u.BAD_DELIMITERS.indexOf(_))&&(_=","),k===_)throw new Error("Comment character same as delimiter");k===!0?k="#":(typeof k!="string"||-1<u.BAD_DELIMITERS.indexOf(k))&&(k=!1),P!==`
`&&P!=="\r"&&P!==`\r
`&&(P=`
`);var U=0,Q=!1;this.parse=function(te,se,X){if(typeof te!="string")throw new Error("Input must be a string");var ye=te.length,Y=_.length,Se=P.length,de=k.length,oe=y(D),ge=[],me=[],he=[],G=U=0;if(!te)return be();if($||$!==!1&&te.indexOf(z)===-1){for(var we=te.split(P),Te=0;Te<we.length;Te++){if(he=we[Te],U+=he.length,Te!==we.length-1)U+=P.length;else if(X)return be();if(!k||he.substring(0,de)!==k){if(oe){if(ge=[],Pe(he.split(_)),Re(),Q)return be()}else Pe(he.split(_));if(M&&M<=Te)return ge=ge.slice(0,M),be(!0)}}return be()}for(var B=te.indexOf(_,U),ve=te.indexOf(P,U),je=new RegExp(f(j)+f(z),"g"),_e=te.indexOf(z,U);;)if(te[U]===z)for(_e=U,U++;;){if((_e=te.indexOf(z,_e+1))===-1)return X||me.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ge.length,index:U}),it();if(_e===ye-1)return it(te.substring(U,_e).replace(je,z));if(z===j&&te[_e+1]===j)_e++;else if(z===j||_e===0||te[_e-1]!==j){B!==-1&&B<_e+1&&(B=te.indexOf(_,_e+1));var H=Ye((ve=ve!==-1&&ve<_e+1?te.indexOf(P,_e+1):ve)===-1?B:Math.min(B,ve));if(te.substr(_e+1+H,Y)===_){he.push(te.substring(U,_e).replace(je,z)),te[U=_e+1+H+Y]!==z&&(_e=te.indexOf(z,U)),B=te.indexOf(_,U),ve=te.indexOf(P,U);break}if(H=Ye(ve),te.substring(_e+1+H,_e+1+H+Se)===P){if(he.push(te.substring(U,_e).replace(je,z)),mt(_e+1+H+Se),B=te.indexOf(_,U),_e=te.indexOf(z,U),oe&&(Re(),Q))return be();if(M&&ge.length>=M)return be(!0);break}me.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ge.length,index:U}),_e++}}else if(k&&he.length===0&&te.substring(U,U+de)===k){if(ve===-1)return be();U=ve+Se,ve=te.indexOf(P,U),B=te.indexOf(_,U)}else if(B!==-1&&(B<ve||ve===-1))he.push(te.substring(U,B)),U=B+Y,B=te.indexOf(_,U);else{if(ve===-1)break;if(he.push(te.substring(U,ve)),mt(ve+Se),oe&&(Re(),Q))return be();if(M&&ge.length>=M)return be(!0)}return it();function Pe(qe){ge.push(qe),G=U}function Ye(qe){var Me=0;return Me=qe!==-1&&(qe=te.substring(_e+1,qe))&&qe.trim()===""?qe.length:Me}function it(qe){return X||(qe===void 0&&(qe=te.substring(U)),he.push(qe),U=ye,Pe(he),oe&&Re()),be()}function mt(qe){U=qe,Pe(he),he=[],ve=te.indexOf(P,U)}function be(qe){if(E.header&&!se&&ge.length&&!V){var Me=ge[0],Xe=Object.create(null),ft=new Set(Me);let ca=!1;for(let ea=0;ea<Me.length;ea++){let Tt=Me[ea];if(Xe[Tt=y(E.transformHeader)?E.transformHeader(Tt,ea):Tt]){let He,$t=Xe[Tt];for(;He=Tt+"_"+$t,$t++,ft.has(He););ft.add(He),Me[ea]=He,Xe[Tt]++,ca=!0,(q=q===null?{}:q)[He]=Tt}else Xe[Tt]=1,Me[ea]=Tt;ft.add(Tt)}ca&&console.warn("Duplicate headers found and renamed."),V=!0}return{data:ge,errors:me,meta:{delimiter:_,linebreak:P,aborted:Q,truncated:!!qe,cursor:G+(se||0),renamedHeaders:q}}}function Re(){D(be()),ge=[],me=[]}},this.abort=function(){Q=!0},this.getCharIndex=function(){return U}}function v(E){var _=E.data,P=l[_.workerId],k=!1;if(_.error)P.userError(_.error,_.file);else if(_.results&&_.results.data){var D={abort:function(){k=!0,I(_.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:A,resume:A};if(y(P.userStep)){for(var M=0;M<_.results.data.length&&(P.userStep({data:_.results.data[M],errors:_.results.errors,meta:_.results.meta},D),!k);M++);delete _.results}else y(P.userChunk)&&(P.userChunk(_.results,D,_.file),delete _.results)}_.finished&&!k&&I(_.workerId,_.results)}function I(E,_){var P=l[E];y(P.userComplete)&&P.userComplete(_),P.terminate(),delete l[E]}function A(){throw new Error("Not implemented.")}function N(E){if(typeof E!="object"||E===null)return E;var _,P=Array.isArray(E)?[]:{};for(_ in E)P[_]=N(E[_]);return P}function x(E,_){return function(){E.apply(_,arguments)}}function y(E){return typeof E=="function"}return u.parse=function(E,_){var P=(_=_||{}).dynamicTyping||!1;if(y(P)&&(_.dynamicTypingFunction=P,P={}),_.dynamicTyping=P,_.transform=!!y(_.transform)&&_.transform,!_.worker||!u.WORKERS_SUPPORTED)return P=null,u.NODE_STREAM_INPUT,typeof E=="string"?(E=(k=>k.charCodeAt(0)!==65279?k:k.slice(1))(E),P=new(_.download?m:C)(_)):E.readable===!0&&y(E.read)&&y(E.on)?P=new S(_):(r.File&&E instanceof File||E instanceof Object)&&(P=new h(_)),P.stream(E);(P=(()=>{var k;return!!u.WORKERS_SUPPORTED&&(k=(()=>{var D=r.URL||r.webkitURL||null,M=n.toString();return u.BLOB_URL||(u.BLOB_URL=D.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",M,")();"],{type:"text/javascript"})))})(),(k=new r.Worker(k)).onmessage=v,k.id=c++,l[k.id]=k)})()).userStep=_.step,P.userChunk=_.chunk,P.userComplete=_.complete,P.userError=_.error,_.step=y(_.step),_.chunk=y(_.chunk),_.complete=y(_.complete),_.error=y(_.error),delete _.worker,P.postMessage({input:E,config:_,workerId:P.id})},u.unparse=function(E,_){var P=!1,k=!0,D=",",M=`\r
`,$='"',q=$+$,V=!1,z=null,j=!1,U=((()=>{if(typeof _=="object"){if(typeof _.delimiter!="string"||u.BAD_DELIMITERS.filter(function(se){return _.delimiter.indexOf(se)!==-1}).length||(D=_.delimiter),typeof _.quotes!="boolean"&&typeof _.quotes!="function"&&!Array.isArray(_.quotes)||(P=_.quotes),typeof _.skipEmptyLines!="boolean"&&typeof _.skipEmptyLines!="string"||(V=_.skipEmptyLines),typeof _.newline=="string"&&(M=_.newline),typeof _.quoteChar=="string"&&($=_.quoteChar),typeof _.header=="boolean"&&(k=_.header),Array.isArray(_.columns)){if(_.columns.length===0)throw new Error("Option columns is empty");z=_.columns}_.escapeChar!==void 0&&(q=_.escapeChar+$),_.escapeFormulae instanceof RegExp?j=_.escapeFormulae:typeof _.escapeFormulae=="boolean"&&_.escapeFormulae&&(j=/^[=+\-@\t\r].*$/)}})(),new RegExp(f($),"g"));if(typeof E=="string"&&(E=JSON.parse(E)),Array.isArray(E)){if(!E.length||Array.isArray(E[0]))return Q(null,E,V);if(typeof E[0]=="object")return Q(z||Object.keys(E[0]),E,V)}else if(typeof E=="object")return typeof E.data=="string"&&(E.data=JSON.parse(E.data)),Array.isArray(E.data)&&(E.fields||(E.fields=E.meta&&E.meta.fields||z),E.fields||(E.fields=Array.isArray(E.data[0])?E.fields:typeof E.data[0]=="object"?Object.keys(E.data[0]):[]),Array.isArray(E.data[0])||typeof E.data[0]=="object"||(E.data=[E.data])),Q(E.fields||[],E.data||[],V);throw new Error("Unable to serialize unrecognized input");function Q(se,X,ye){var Y="",Se=(typeof se=="string"&&(se=JSON.parse(se)),typeof X=="string"&&(X=JSON.parse(X)),Array.isArray(se)&&0<se.length),de=!Array.isArray(X[0]);if(Se&&k){for(var oe=0;oe<se.length;oe++)0<oe&&(Y+=D),Y+=te(se[oe],oe);0<X.length&&(Y+=M)}for(var ge=0;ge<X.length;ge++){var me=(Se?se:X[ge]).length,he=!1,G=Se?Object.keys(X[ge]).length===0:X[ge].length===0;if(ye&&!Se&&(he=ye==="greedy"?X[ge].join("").trim()==="":X[ge].length===1&&X[ge][0].length===0),ye==="greedy"&&Se){for(var we=[],Te=0;Te<me;Te++){var B=de?se[Te]:Te;we.push(X[ge][B])}he=we.join("").trim()===""}if(!he){for(var ve=0;ve<me;ve++){0<ve&&!G&&(Y+=D);var je=Se&&de?se[ve]:ve;Y+=te(X[ge][je],ve)}ge<X.length-1&&(!ye||0<me&&!G)&&(Y+=M)}}return Y}function te(se,X){var ye,Y;return se==null?"":se.constructor===Date?JSON.stringify(se).slice(1,25):(Y=!1,j&&typeof se=="string"&&j.test(se)&&(se="'"+se,Y=!0),ye=se.toString().replace(U,q),(Y=Y||P===!0||typeof P=="function"&&P(se,X)||Array.isArray(P)&&P[X]||((Se,de)=>{for(var oe=0;oe<de.length;oe++)if(-1<Se.indexOf(de[oe]))return!0;return!1})(ye,u.BAD_DELIMITERS)||-1<ye.indexOf(D)||ye.charAt(0)===" "||ye.charAt(ye.length-1)===" ")?$+ye+$:ye)}},u.RECORD_SEP=String.fromCharCode(30),u.UNIT_SEP=String.fromCharCode(31),u.BYTE_ORDER_MARK="\uFEFF",u.BAD_DELIMITERS=["\r",`
`,'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!o&&!!r.Worker,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=b,u.ParserHandle=w,u.NetworkStreamer=m,u.FileStreamer=h,u.StringStreamer=C,u.ReadableStreamStreamer=S,r.jQuery&&((s=r.jQuery).fn.parse=function(E){var _=E.config||{},P=[];return this.each(function(M){if(!(s(this).prop("tagName").toUpperCase()==="INPUT"&&s(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var $=0;$<this.files.length;$++)P.push({file:this.files[$],inputElem:this,instanceConfig:s.extend({},_)})}),k(),this;function k(){if(P.length===0)y(E.complete)&&E.complete();else{var M,$,q,V,z=P[0];if(y(E.before)){var j=E.before(z.file,z.inputElem);if(typeof j=="object"){if(j.action==="abort")return M="AbortError",$=z.file,q=z.inputElem,V=j.reason,void(y(E.error)&&E.error({name:M},$,q,V));if(j.action==="skip")return void D();typeof j.config=="object"&&(z.instanceConfig=s.extend(z.instanceConfig,j.config))}else if(j==="skip")return void D()}var U=z.instanceConfig.complete;z.instanceConfig.complete=function(Q){y(U)&&U(Q,z.file,z.inputElem),D()},u.parse(z.file,z.instanceConfig)}}function D(){P.splice(0,1),k()}}),i&&(r.onmessage=function(E){E=E.data,u.WORKER_ID===void 0&&E&&(u.WORKER_ID=E.workerId),typeof E.input=="string"?r.postMessage({workerId:u.WORKER_ID,results:u.parse(E.input,E.config),finished:!0}):(r.File&&E.input instanceof File||E.input instanceof Object)&&(E=u.parse(E.input,E.config))&&r.postMessage({workerId:u.WORKER_ID,results:E,finished:!0})}),(m.prototype=Object.create(d.prototype)).constructor=m,(h.prototype=Object.create(d.prototype)).constructor=h,(C.prototype=Object.create(C.prototype)).constructor=C,(S.prototype=Object.create(d.prototype)).constructor=S,u})})(xT);var $9=xT.exports;const B9=()=>{const{user:a,rol:e}=ht(),[n,r]=p.useState([]),[s,o]=p.useState([]),[i,l]=p.useState(!1),[c,u]=p.useState(0),d=["nombre","direccion","ciudad","region","telefono","email","web","categoria","descripcion","coordenadas_lat","coordenadas_lng"],m=p.useCallback(v=>{const I=v[0];I&&$9.parse(I,{header:!0,complete:A=>{console.log("CSV parsed:",A.data),r(A.data),h(A.data)},error:A=>{console.error("Error parsing CSV:",A)}})},[]),h=v=>{const I=v.map((A,N)=>{var E,_,P,k;const x=[],y=[];return(E=A.nombre)!=null&&E.trim()||x.push("Nombre es obligatorio"),(_=A.direccion)!=null&&_.trim()||x.push("Dirección es obligatoria"),(P=A.telefono)!=null&&P.trim()||y.push("Teléfono recomendado"),(k=A.web)!=null&&k.trim()||y.push("Sitio web recomendado"),A.email&&!/\S+@\S+\.\S+/.test(A.email)&&x.push("Formato de email inválido"),A.web&&!A.web.startsWith("http")&&y.push("URL debe empezar con http:// o https://"),{index:N,data:A,isValid:x.length===0,errors:x,warnings:y}});o(I)},C=async()=>{if(e!=="admin"){alert("Solo administradores pueden realizar carga masiva");return}l(!0),u(0);try{const v=s.filter(A=>A.isValid),I=500;for(let A=0;A<v.length;A+=I){const N=$k(F),x=v.slice(A,A+I);x.forEach(y=>{const E=Ne(W(F,"empresas")),_={...y.data,zona:"AV10_JULIO",calles:S(y.data.direccion),estado:"catalogada",origen:"catastro_masivo",fechaCreacion:sa(),fechaActualizacion:sa(),webValidada:!1,logoAsignado:!1,visitaAgente:!1,agenteAsignado:null,fechaVisita:null,creadoPor:a.uid,loteImportacion:`catastro_${new Date().getTime()}`,ubicacion:y.data.coordenadas_lat&&y.data.coordenadas_lng?{lat:parseFloat(y.data.coordenadas_lat),lng:parseFloat(y.data.coordenadas_lng)}:null};N.set(E,_)}),await N.commit(),u((A+x.length)/v.length*100)}alert(`✅ Catastro completado: ${v.length} empresas cargadas`),r([]),o([])}catch(v){console.error("Error en carga masiva:",v),alert("Error durante la carga masiva")}finally{l(!1),u(0)}},S=v=>["Avenida Matta","Santa Isabel","Vicuña Mackenna","Autopista Central","Av. Matta"].filter(A=>v.toLowerCase().includes(A.toLowerCase())),{getRootProps:w,getInputProps:f,isDragActive:b}=ET({onDrop:m,accept:{"text/csv":[".csv"],"application/vnd.ms-excel":[".csv"]},multiple:!1});return e!=="admin"?t.createElement("div",{className:"text-center p-8"},t.createElement("p",{className:"text-red-600"},"Solo administradores pueden acceder al catastro masivo"),t.createElement("p",{className:"text-gray-500 mt-2"},"Tu rol actual: ",e||"Sin rol")):t.createElement("div",{className:"max-w-6xl mx-auto p-6"},t.createElement("div",{className:"bg-white rounded-lg shadow-lg"},t.createElement("div",{className:"p-6 border-b"},t.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"📊 Catastro Masivo - Zona AV10 de Julio"),t.createElement("p",{className:"text-gray-600 mt-2"},"Cargar empresas desde CSV - Área: Av. Matta, Santa Isabel, Vicuña Mackenna, Autopista Central")),t.createElement("div",{className:"p-6"},t.createElement("div",{...w(),className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${b?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-400"}`},t.createElement("input",{...f()}),t.createElement("div",{className:"text-4xl mb-4"},"📄"),b?t.createElement("p",{className:"text-blue-600"},"Suelta el archivo CSV aquí..."):t.createElement("div",null,t.createElement("p",{className:"text-gray-700 font-medium"},"Arrastra un archivo CSV o haz clic para seleccionar"),t.createElement("p",{className:"text-sm text-gray-500 mt-2"},"Columnas esperadas: ",d.join(", ")))),t.createElement("div",{className:"mt-4 text-center"},t.createElement("button",{className:"text-blue-600 hover:text-blue-800 underline text-sm"},"📥 Descargar plantilla CSV"))),s.length>0&&t.createElement("div",{className:"p-6 border-t"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"📋 Resultados de Validación"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},t.createElement("div",{className:"bg-green-50 p-4 rounded-lg text-center"},t.createElement("div",{className:"text-2xl font-bold text-green-600"},s.filter(v=>v.isValid).length),t.createElement("div",{className:"text-sm text-green-800"},"Registros Válidos")),t.createElement("div",{className:"bg-red-50 p-4 rounded-lg text-center"},t.createElement("div",{className:"text-2xl font-bold text-red-600"},s.filter(v=>!v.isValid).length),t.createElement("div",{className:"text-sm text-red-800"},"Con Errores")),t.createElement("div",{className:"bg-yellow-50 p-4 rounded-lg text-center"},t.createElement("div",{className:"text-2xl font-bold text-yellow-600"},s.filter(v=>v.warnings.length>0).length),t.createElement("div",{className:"text-sm text-yellow-800"},"Con Advertencias"))),s.some(v=>!v.isValid)&&t.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4"},t.createElement("h4",{className:"font-semibold text-red-900 mb-2"},"❌ Registros con Errores:"),t.createElement("div",{className:"max-h-40 overflow-y-auto"},s.filter(v=>!v.isValid).slice(0,10).map((v,I)=>t.createElement("div",{key:I,className:"text-sm text-red-800 mb-1"},"Fila ",v.index+2,": ",v.errors.join(", "))))),t.createElement("div",{className:"flex justify-between items-center"},t.createElement("button",{onClick:()=>{r([]),o([])},className:"text-gray-600 hover:text-gray-800"},"🗑️ Limpiar datos"),t.createElement("button",{onClick:C,disabled:i||s.filter(v=>v.isValid).length===0,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"},i?"Procesando...":`✅ Cargar ${s.filter(v=>v.isValid).length} empresas`)),i&&t.createElement("div",{className:"mt-4"},t.createElement("div",{className:"bg-gray-200 rounded-full h-2"},t.createElement("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${c}%`}})),t.createElement("p",{className:"text-center text-sm text-gray-600 mt-2"},c.toFixed(0),"% completado")))))};function yT(a,e={}){const[n,r]=p.useState([]),[s,o]=p.useState(!0),[i,l]=p.useState(null),{where:c,orderBy:u,limit:d,realtime:m=!0}=e;p.useEffect(()=>{let w;const f=()=>{let b=W(F,a);return c&&(b=fe(b,pe(...c))),u&&(b=fe(b,st(...u))),d&&(b=fe(b,Ot(d))),b};return m?w=wa(f(),b=>{const v=b.docs.map(I=>({id:I.id,...I.data()}));r(v),o(!1)},b=>{l(b),o(!1)}):le(f()).then(b=>{const v=b.docs.map(I=>({id:I.id,...I.data()}));r(v),o(!1)}).catch(b=>{l(b),o(!1)}),()=>{w&&w()}},[a,JSON.stringify(e)]);const h=p.useCallback(async w=>{try{return(await ot(W(F,a),{...w,fechaCreacion:new Date,fechaActualizacion:new Date})).id}catch(f){throw new Error(`Error adding document: ${f.message}`)}},[a]),C=p.useCallback(async(w,f)=>{try{await ze(Ne(F,a,w),{...f,fechaActualizacion:new Date})}catch(b){throw new Error(`Error updating document: ${b.message}`)}},[a]),S=p.useCallback(async w=>{try{await on(Ne(F,a,w))}catch(f){throw new Error(`Error deleting document: ${f.message}`)}},[a]);return{data:n,loading:s,error:i,add:h,update:C,remove:S,refetch:()=>o(!0)}}class q_{static puedeTransicionar(e,n){return TE(e,n,!1)}static obtenerSiguientesPasos(e){return Pz(e,!1)}static obtenerDescripcionEstado(e){return Rz(e,!1)}static validarRequisitosActivacion(e){const n={webValidada:e.webValidada===!0,logoAsignado:e.logoAsignado===!0,informacionCompleta:!!(e.nombre&&e.direccion&&e.telefono),sinConflictos:!e.flagConflicto,validadaPorAgente:e.estado===ce.VALIDADA};return{puedeActivar:Object.values(n).every(Boolean),requisitos:n,faltantes:Object.entries(n).filter(([s,o])=>!o).map(([s])=>s)}}static generarRazonCambioEstado(e,n,r=""){const s={[`${ce.CATALOGADA}-${ce.PENDIENTE_VALIDACION}`]:"Empresa asignada a agente para validación",[`${ce.PENDIENTE_VALIDACION}-${ce.EN_VISITA}`]:"Agente programó visita de validación",[`${ce.EN_VISITA}-${ce.VALIDADA}`]:"Agente validó empresa en terreno",[`${ce.VALIDADA}-${ce.ACTIVA}`]:"Admin activó empresa completamente",[`${ce.ACTIVA}-${ce.SUSPENDIDA}`]:"Empresa suspendida por administrador",[`${ce.SUSPENDIDA}-${ce.ACTIVA}`]:"Empresa reactivada por administrador",[`${ce.ACTIVA}-${ce.INACTIVA}`]:"Empresa desactivada permanentemente"},o=`${e}-${n}`;return s[o]||r||`Cambio de ${e} a ${n}`}static obtenerFlujoCompleto(){return ml}static esEstadoFinal(e){return[ce.INACTIVA,ce.RECHAZADA].includes(e)}static esVisibleEnHome(e){var n;return((n=ml[e])==null?void 0:n.visible_en_home)||!1}static puedeGestionar(e){var n;return((n=ml[e])==null?void 0:n.puede_gestionar)||!1}}function q9(){const[a,e]=p.useState(!1),n=async(i,l,c="",u={})=>{e(!0);try{const d={estado:l,fechaActualizacion:new Date,ultimoCambioEstado:{fecha:new Date,nuevoEstado:l,motivo:c,...u},...u};switch(l){case ce.ACTIVA:d.fechaActivacion=new Date,d.visible=!0;break;case ce.RECHAZADA:d.fechaRechazo=new Date,d.visible=!1;break;case ce.SUSPENDIDA:d.fechaSuspension=new Date,d.visible=!1;break;case ce.VISITADA:d.visitaAgente=!0,d.fechaVisita=new Date;break}return await ze(Ne(F,"empresas",i),d),{success:!0}}catch(d){return console.error("Error cambiando estado:",d),{success:!1,error:d.message}}finally{e(!1)}};return{cambiarEstado:n,marcarVisitaAgente:async(i,l)=>await n(i,ce.VISITADA,"Visita realizada por agente de campo",{visitaAgente:!0,datosVisita:{...l,fecha:new Date}}),validarWeb:async(i,l)=>{e(!0);try{const c={webValidada:l.existe&&l.respondiendo,validacionWeb:l,fechaActualizacion:new Date};return await ze(Ne(F,"empresas",i),c),{success:!0}}catch(c){return console.error("Error validando web:",c),{success:!1,error:c.message}}finally{e(!1)}},asignarLogo:async(i,l)=>{e(!0);try{const c={logoUrl:l,logoAsignado:!0,fechaActualizacion:new Date};return await ze(Ne(F,"empresas",i),c),{success:!0}}catch(c){return console.error("Error asignando logo:",c),{success:!1,error:c.message}}finally{e(!1)}},loading:a,validarRequisitos:q_.validarRequisitosActivacion,obtenerSiguientesPasos:q_.obtenerSiguientesPasos}}async function W9(){console.log("🏗️ Creando empresas con estado 'ingresada'...");const a=[{nombre:"Taller Mecánico El Rápido",direccion:"Av. Las Industrias #123, Pudahuel",telefono:"+56 9 1234 5678",email:"contacto@elrapido.cl",categoria:"Taller Mecánico",rubro:"Taller Mecánico",descripcion:"Taller especializado en reparación y mantención de vehículos",web:"https://www.elrapido.cl",logo:"",logoAsignado:!1,webValidada:!1,estado:"ingresada",fechaCreacion:new Date,zona:"Pudahuel",region:"Metropolitana",ciudad:"Santiago"},{nombre:"Repuestos Automotrices Central",direccion:"Calle Comercial #456, Maipú",telefono:"+56 9 2345 6789",email:"ventas@centralrepuestos.cl",categoria:"Repuestos",rubro:"Repuestos",descripcion:"Distribuidora de repuestos para todo tipo de vehículos",web:"",logo:"",logoAsignado:!1,webValidada:!1,estado:"ingresada",fechaCreacion:new Date,zona:"Maipú",region:"Metropolitana",ciudad:"Santiago"},{nombre:"Lubricantes y Aceites Express",direccion:"Av. Industrial #789, Quilicura",telefono:"+56 9 3456 7890",email:"info@lubricantesexpress.cl",categoria:"Lubricantes",rubro:"Lubricantes",descripcion:"Venta de aceites y lubricantes para vehículos",web:"https://www.lubricantesexpress.cl",logo:"",logoAsignado:!1,webValidada:!1,estado:"ingresada",fechaCreacion:new Date,zona:"Quilicura",region:"Metropolitana",ciudad:"Santiago"},{nombre:"Ferretería Industrial Los Andes",direccion:"Calle Principal #321, Las Condes",telefono:"+56 9 4567 8901",email:"ventas@ferreterialosandes.cl",categoria:"Ferretería",rubro:"Ferretería",descripcion:"Ferretería especializada en herramientas industriales",web:"",logo:"",logoAsignado:!1,webValidada:!1,estado:"ingresada",fechaCreacion:new Date,zona:"Las Condes",region:"Metropolitana",ciudad:"Santiago"},{nombre:"Automotora Premium Chile",direccion:"Av. Kennedy #654, Las Condes",telefono:"+56 9 5678 9012",email:"ventas@premiumchile.cl",categoria:"Automotora",rubro:"Automotora",descripcion:"Venta de vehículos premium con garantía extendida",web:"https://www.premiumchile.cl",logo:"",logoAsignado:!1,webValidada:!1,estado:"ingresada",fechaCreacion:new Date,zona:"Las Condes",region:"Metropolitana",ciudad:"Santiago"}];for(let e=0;e<a.length;e++)try{const n=await ot(W(F,"empresas"),a[e]);console.log(`✅ Empresa ingresada ${e+1}/5 creada:`,a[e].nombre,"ID:",n.id)}catch(n){console.error(`❌ Error creando empresa ingresada ${e+1}:`,n)}console.log("🎉 Empresas con estado 'ingresada' creadas")}const G9=()=>{const{rol:a}=ht(),[e,n]=p.useState("todos"),[r,s]=p.useState(null),[o,i]=p.useState(!1),[l,c]=p.useState(!1),[u,d]=p.useState(!1),{cambiarEstado:m,validarWeb:h,asignarLogo:C,loading:S}=q9(),{data:w,loading:f}=yT("empresas",{orderBy:["fecha_creacion","desc"]});console.log("🔍 Empresas obtenidas de Firestore:",w),console.log('🔍 Empresas con estado "ingresada":',w==null?void 0:w.filter(k=>k.estado==="ingresada"));const b=k=>typeof k=="string"?k:!k||typeof k!="object"?"Horarios no disponibles":k.general?k.general:k.lunes||k.martes?Object.entries(k).filter(([D,M])=>M&&M.activo).map(([D,M])=>`${D==="lunes"?"Lun":D==="martes"?"Mar":D==="miercoles"?"Mié":D==="jueves"?"Jue":D==="viernes"?"Vie":D==="sabado"?"Sáb":"Dom"} ${M.inicio}-${M.fin}`).join(", "):"Horarios no disponibles",v=k=>{const D={id:k.id,nombre:k.nombre,direccion:k.direccion,telefono:k.telefono,email:k.email,web:k.web||k.sitio_web,logo:k.logo||k.logo_url,logoAsignado:k.logoAsignado||!!(k.logo||k.logo_url),webValidada:k.webValidada||!1,visitaAgente:k.visitaAgente||!1,estado:k.estado,categoria:k.categoria||k.rubro,zona:k.zona||k.ciudad,region:k.region,ciudad:k.ciudad,fechaCreacion:k.fechaCreacion||k.fecha_creacion,tipo_empresa:k.tipo_empresa,es_comunidad:k.es_comunidad,marcas:k.marcas||[],horarios:b(k.horarios||k.horario_atencion),descripcion:k.descripcion,creado_por:k.creado_por,lat:k.lat,lng:k.lng};return console.log("🔧 Normalizando empresa:",k.nombre,D),console.log("🕐 Horarios originales:",k.horarios),console.log("🕐 Horarios normalizados:",D.horarios),D},I=(w==null?void 0:w.filter(k=>{const D=e==="todos"?["ingresada","validada","En Revisión","activa","Rechazada"].includes(k.estado):k.estado===e;return console.log(`🔍 Empresa ${k.nombre} (${k.estado}) - Cumple filtro: ${D}`),D}).map(v))||[];console.log("🔍 Empresas filtradas y normalizadas:",I);const A=async k=>{i(!0);try{return{existe:!0,respondiendo:(await fetch("https://httpbin.org/delay/1")).ok,tiempoRespuesta:1200,titulo:"Sitio web de empresa",descripcion:"Descripción del sitio",esComercial:!0}}catch(D){return console.error("Error validando sitio web:",D),{existe:!1,error:D.message}}finally{i(!1)}},N=async(k,D)=>{try{return await new Promise(M=>setTimeout(M,1e3)),`https://via.placeholder.com/150x150?text=${encodeURIComponent(k.substring(0,2))}`}catch(M){return console.error("Error buscando logo:",M),null}},x=()=>{d(!0)},y=()=>{d(!1)},E=async()=>{if(window.confirm('¿Quieres crear 5 empresas de ejemplo con estado "ingresada" para testing del panel de validación?')){c(!0);try{await W9(),alert("✅ Empresas de ejemplo creadas exitosamente. Recarga la página para verlas.")}catch(k){console.error("Error creando empresas de ejemplo:",k),alert("❌ Error creando empresas de ejemplo")}finally{c(!1)}}},_=async(k,D)=>{try{switch(D){case"validar_web":const M=k.web||k.sitio_web;if(M){const V=await A(M);await h(k.id,V)}break;case"asignar_logo":const $=await N(k.nombre,k.web||k.sitio_web);$&&await C(k.id,$);break;case"activar":await m(k.id,"activa","Activación manual por administrador");break;case"rechazar":const q=prompt("Motivo de rechazo:");q&&await m(k.id,"Rechazada",q);break;case"revisar":await m(k.id,"En Revisión","Marcada para revisión manual");break}s(null)}catch(M){console.error("Error procesando empresa:",M),alert("Error al procesar la empresa")}},P=({empresa:k})=>{var D,M,$;return t.createElement("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"flex justify-between items-start mb-3"},t.createElement("div",null,t.createElement("h3",{className:"font-semibold text-gray-900"},k.nombre),t.createElement("p",{className:"text-sm text-gray-600"},k.direccion),t.createElement("p",{className:"text-xs text-gray-500"},"Zona: ",k.zona," | Creado: ",(($=(M=(D=k.fechaCreacion)==null?void 0:D.toDate)==null?void 0:M.call(D))==null?void 0:$.toLocaleDateString())||"N/A")),t.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${k.estado==="ingresada"?"bg-teal-100 text-teal-800":k.estado==="validada"?"bg-blue-100 text-blue-800":k.estado==="En Revisión"?"bg-yellow-100 text-yellow-800":k.estado==="activa"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},k.estado)),t.createElement("div",{className:"flex space-x-3 mb-3 text-xs"},t.createElement("span",{className:`flex items-center ${k.webValidada?"text-green-600":"text-gray-400"}`},k.webValidada?"✅":"❓"," Web"),t.createElement("span",{className:`flex items-center ${k.logoAsignado?"text-green-600":"text-gray-400"}`},k.logoAsignado?"✅":"❓"," Logo"),t.createElement("span",{className:`flex items-center ${k.visitaAgente?"text-green-600":"text-gray-400"}`},k.visitaAgente?"✅":"❓"," Visita")),t.createElement("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600 mb-3"},t.createElement("div",null,"📞 ",k.telefono||"No disponible"),t.createElement("div",null,"✉️ ",k.email||"No disponible"),t.createElement("div",null,"🌐 ",k.web?t.createElement("a",{href:k.web,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},k.web.length>30?k.web.substring(0,30)+"...":k.web):"No disponible"),t.createElement("div",null,"🏷️ ",k.categoria||"Sin categoría"),k.tipo_empresa&&t.createElement("div",null,"🏢 Tipo: ",k.tipo_empresa),k.creado_por&&t.createElement("div",null,"👤 Creado por: ",k.creado_por)),t.createElement("div",{className:"flex flex-wrap gap-2"},t.createElement("button",{onClick:()=>s(k),className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded hover:bg-blue-200"},"👁️ Ver detalles"),!k.webValidada&&(k.web||k.sitio_web)&&t.createElement("button",{onClick:()=>_(k,"validar_web"),disabled:o||S,className:"text-xs bg-yellow-100 text-yellow-700 px-2 py-1 rounded hover:bg-yellow-200 disabled:opacity-50"},"🔍 Validar web"),!k.logoAsignado&&!k.logo&&t.createElement("button",{onClick:()=>_(k,"asignar_logo"),disabled:S,className:"text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded hover:bg-purple-200 disabled:opacity-50"},"🖼️ Buscar logo"),k.webValidada&&k.logoAsignado&&(k.estado==="ingresada"||k.estado==="validada")&&t.createElement("button",{onClick:()=>_(k,"activar"),disabled:S,className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded hover:bg-green-200 disabled:opacity-50"},"✅ Activar"),t.createElement("button",{onClick:()=>_(k,"rechazar"),disabled:S,className:"text-xs bg-red-100 text-red-700 px-2 py-1 rounded hover:bg-red-200 disabled:opacity-50"},"❌ Rechazar")))};return a!=="admin"?t.createElement("div",{className:"text-center p-8"},t.createElement("p",{className:"text-red-600"},"Solo administradores pueden acceder al panel de validación"),t.createElement("p",{className:"text-gray-500 mt-2"},"Tu rol actual: ",a||"Sin rol")):t.createElement("div",{className:"max-w-7xl mx-auto p-6"},t.createElement("div",{className:"bg-white rounded-lg shadow-lg"},t.createElement("div",{className:"p-6 border-b"},t.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"🔍 Panel de Validación - Catastro AV10 de Julio"),t.createElement("p",{className:"text-gray-600 mt-2"},"Validación y activación de empresas del catastro masivo")),t.createElement("div",{className:"p-6 border-b bg-gray-50"},t.createElement("div",{className:"flex flex-wrap gap-4 items-center"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Estado:"),t.createElement("select",{value:e,onChange:k=>n(k.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm"},t.createElement("option",{value:"todos"},"Todos los Estados"),t.createElement("option",{value:"ingresada"},"Ingresadas"),t.createElement("option",{value:"validada"},"Validadas"),t.createElement("option",{value:"En Revisión"},"En Revisión"),t.createElement("option",{value:"Activa"},"Activas"),t.createElement("option",{value:"Rechazada"},"Rechazadas"))),t.createElement("div",{className:"flex gap-2"},t.createElement("button",{onClick:x,className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors"},"🏢 Crear Empresa Pública"),t.createElement("button",{onClick:E,disabled:l,className:"bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors"},l?"🔄 Creando...":"➕ Crear Empresas Ejemplo"),t.createElement("button",{onClick:()=>window.location.reload(),className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors"},"🔄 Recargar")),t.createElement("div",{className:"flex-1"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm"},t.createElement("div",{className:"bg-teal-50 p-3 rounded text-center"},t.createElement("div",{className:"font-bold text-teal-600"},(w==null?void 0:w.filter(k=>k.estado==="ingresada").length)||0),t.createElement("div",{className:"text-teal-800"},"Ingresadas")),t.createElement("div",{className:"bg-blue-50 p-3 rounded text-center"},t.createElement("div",{className:"font-bold text-blue-600"},(w==null?void 0:w.filter(k=>k.estado==="validada").length)||0),t.createElement("div",{className:"text-blue-800"},"Validadas")),t.createElement("div",{className:"bg-yellow-50 p-3 rounded text-center"},t.createElement("div",{className:"font-bold text-yellow-600"},(w==null?void 0:w.filter(k=>k.estado==="En Revisión").length)||0),t.createElement("div",{className:"text-yellow-800"},"En Revisión")),t.createElement("div",{className:"bg-green-50 p-3 rounded text-center"},t.createElement("div",{className:"font-bold text-green-600"},(w==null?void 0:w.filter(k=>k.estado==="activa").length)||0),t.createElement("div",{className:"text-green-800"},"Activadas")),t.createElement("div",{className:"bg-red-50 p-3 rounded text-center"},t.createElement("div",{className:"font-bold text-red-600"},(w==null?void 0:w.filter(k=>k.estado==="Rechazada").length)||0),t.createElement("div",{className:"text-red-800"},"Rechazadas")))))),t.createElement("div",{className:"p-6"},f?t.createElement("div",{className:"text-center py-8"},t.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),t.createElement("p",{className:"mt-2 text-gray-600"},"Cargando empresas...")):(I==null?void 0:I.length)>0?t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4"},I.map(k=>t.createElement(P,{key:k.id,empresa:k}))):t.createElement("div",{className:"text-center py-8 text-gray-500"},e==="todos"?"No hay empresas en proceso de validación":`No hay empresas con estado "${e}"`))),r&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},t.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},t.createElement("div",{className:"p-6"},t.createElement("div",{className:"flex justify-between items-start mb-4"},t.createElement("h2",{className:"text-xl font-bold text-gray-900"},r.nombre),t.createElement("button",{onClick:()=>s(null),className:"text-gray-400 hover:text-gray-600"},"✕")),t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},t.createElement("div",null,t.createElement("strong",null,"Dirección:")," ",r.direccion),t.createElement("div",null,t.createElement("strong",null,"Ciudad:")," ",r.ciudad),t.createElement("div",null,t.createElement("strong",null,"Región:")," ",r.region),t.createElement("div",null,t.createElement("strong",null,"Teléfono:")," ",r.telefono),t.createElement("div",null,t.createElement("strong",null,"Email:")," ",r.email),t.createElement("div",null,t.createElement("strong",null,"Sitio Web:"),r.web&&t.createElement("a",{href:r.web,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline ml-1"},r.web)),r.tipo_empresa&&t.createElement("div",null,t.createElement("strong",null,"Tipo de Empresa:")," ",r.tipo_empresa),r.creado_por&&t.createElement("div",null,t.createElement("strong",null,"Creado por:")," ",r.creado_por),r.es_comunidad!==void 0&&t.createElement("div",null,t.createElement("strong",null,"Es Comunidad:")," ",r.es_comunidad?"Sí":"No")),r.descripcion&&t.createElement("div",null,t.createElement("strong",null,"Descripción:"),t.createElement("p",{className:"mt-1 text-gray-700"},r.descripcion)),r.marcas&&r.marcas.length>0&&t.createElement("div",null,t.createElement("strong",null,"Marcas:"),t.createElement("div",{className:"mt-1 flex flex-wrap gap-1"},r.marcas.map((k,D)=>t.createElement("span",{key:D,className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs"},k)))),r.horarios&&t.createElement("div",null,t.createElement("strong",null,"Horarios:"),t.createElement("p",{className:"mt-1 text-gray-700"},r.horarios)),r.validacionWeb&&t.createElement("div",{className:"bg-gray-50 p-4 rounded-lg"},t.createElement("strong",null,"Validación Web:"),t.createElement("div",{className:"mt-2 text-sm"},t.createElement("div",null,"✅ Existe: ",r.validacionWeb.existe?"Sí":"No"),t.createElement("div",null,"⚡ Respondiendo: ",r.validacionWeb.respondiendo?"Sí":"No"),r.validacionWeb.titulo&&t.createElement("div",null,"📄 Título: ",r.validacionWeb.titulo))))))),u&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},t.createElement("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto"},t.createElement("div",{className:"p-6"},t.createElement("div",{className:"flex justify-between items-start mb-4"},t.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Crear Empresa Pública"),t.createElement("button",{onClick:y,className:"text-gray-400 hover:text-gray-600"},"✕")),t.createElement(Xg,{onClose:y,onSuccess:()=>{y(),window.location.reload()}})))))};function W_(){ht();const[a,e]=p.useState([]),[n,r]=p.useState(!0),[s,o]=p.useState(!1),[i,l]=p.useState(null),[c,u]=p.useState({nombre:"",email:"",telefono:"",zona_asignada:"",password:"",generar_password:!1,enviar_email:!1,activo:!0}),d=["AV10_JULIO_NORTE","AV10_JULIO_SUR","AV10_JULIO_CENTRO","MATTA_ORIENTE","MATTA_PONIENTE","SANTA_ISABEL_NORTE","SANTA_ISABEL_SUR","VICUNA_MACKENNA_NORTE","VICUNA_MACKENNA_SUR","AUTOPISTA_CENTRAL"],{data:m}=yT("empresas",{where:["agenteAsignado","!=",null]}),[h,C]=p.useState(!1),[S,w]=p.useState(!1),[f,b]=p.useState(null),[v,I]=p.useState(""),[A,N]=p.useState(!1),[x,y]=p.useState(null),[E,_]=p.useState({email:"",password:"",confirmPassword:""}),[P,k]=p.useState("tabla"),[D,M]=p.useState(!1),[$,q]=p.useState(null),[V,z]=p.useState([]),[j,U]=p.useState([]);p.useEffect(()=>{Q()},[]);const Q=async()=>{try{r(!0);const H=fe(W(F,"agentes"),st("nombre")),Ye=(await le(H)).docs.map(it=>({id:it.id,...it.data()}));e(Ye)}catch(H){console.error("Error cargando agentes:",H)}finally{r(!1)}},te=()=>{const H="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#$%&";let Pe="";for(let Ye=0;Ye<12;Ye++)Pe+=H.charAt(Math.floor(Math.random()*H.length));return Pe},se=()=>{const H=te();u(Pe=>({...Pe,password:H,generar_password:!0}))},X=(H=null)=>{H?(l(H),u({nombre:H.nombre||"",email:H.email||"",telefono:H.telefono||"",zona_asignada:H.zona_asignada||"",password:"",generar_password:!1,enviar_email:!1,activo:H.activo!==!1})):(l(null),u({nombre:"",email:"",telefono:"",zona_asignada:"",password:"",generar_password:!1,enviar_email:!1,activo:!0})),o(!0)},ye=()=>{o(!1),l(null),u({nombre:"",email:"",telefono:"",zona_asignada:"",password:"",generar_password:!1,enviar_email:!1,activo:!0})},Y=async H=>{H.preventDefault(),C(!0);try{if(i){if(await ze(Ne(F,"agentes",i.id),{nombre:c.nombre,telefono:c.telefono,zona_asignada:c.zona_asignada,activo:c.activo,fechaActualizacion:new Date}),c.email!==i.email){const Pe=fe(W(F,"usuarios"),pe("agenteId","==",i.id)),Ye=await le(Pe);Ye.empty||await ze(Ye.docs[0].ref,{email:c.email})}alert("Agente actualizado exitosamente")}else{const Pe={nombre:c.nombre,email:c.email,telefono:c.telefono,zona_asignada:c.zona_asignada,activo:c.activo,fechaCreacion:new Date,empresasAsignadas:0,visitasRealizadas:0,empresasActivadas:0,permisos:{crear_solicitudes:!0,activar_empresas:!1,gestionar_perfil:!0}},Ye=await ot(W(F,"agentes"),Pe);if(c.password){const it=iu();try{const mt=await es(it,c.email,c.password);await Ar(Ne(F,"usuarios",mt.user.uid),{uid:mt.user.uid,email:c.email,nombre:c.nombre,rol:"agente",agenteId:Ye.id,telefono:c.telefono,zona:c.zona_asignada,activo:c.activo,fechaCreacion:new Date,creadoPorAdmin:!0}),alert("Agente creado exitosamente con credenciales de acceso")}catch(mt){console.error("Error creando usuario:",mt),alert("Agente creado pero error al crear credenciales: "+mt.message)}}else alert("Agente creado exitosamente. Asigna credenciales más tarde.")}await Q(),ye()}catch(Pe){console.error("Error guardando agente:",Pe),alert("Error al guardar agente: "+Pe.message)}finally{C(!1)}},Se=async H=>{try{await ze(Ne(F,"agentes",H.id),{activo:!H.activo,fechaActualizacion:new Date});const Pe=fe(W(F,"usuarios"),pe("agenteId","==",H.id)),Ye=await le(Pe);Ye.empty||await ze(Ye.docs[0].ref,{activo:!H.activo}),await Q(),alert(`Agente ${H.activo?"desactivado":"activado"} exitosamente`)}catch(Pe){console.error("Error cambiando estado:",Pe),alert("Error al cambiar estado: "+Pe.message)}},de=async H=>{if(confirm(`¿Estás seguro de eliminar al agente ${H.nombre}?`))try{await on(Ne(F,"agentes",H.id)),await Q(),alert("Agente eliminado exitosamente")}catch(Pe){console.error("Error eliminando agente:",Pe),alert("Error al eliminar agente: "+Pe.message)}},oe=()=>{w(!1),b(null),I("")},ge=()=>{I(te())},me=async()=>{if(!v){alert("Debes generar o ingresar una nueva contraseña");return}C(!0);try{const H=iu(),Pe=fe(W(F,"usuarios"),pe("email","==",f.email));if((await le(Pe)).empty){alert("No se encontró usuario para este agente");return}alert("Contraseña actualizada. El agente debe usar la nueva contraseña en su próximo login."),oe()}catch(H){console.error("Error cambiando clave:",H),alert("Error al cambiar clave: "+H.message)}finally{C(!1)}},he=()=>{const H=te();_(Pe=>({...Pe,password:H,confirmPassword:H}))},G=()=>{N(!1),y(null),_({email:"",password:"",confirmPassword:""})},we=async()=>{if(!E.email||!E.password){alert("Debes completar email y contraseña");return}if(E.password!==E.confirmPassword){alert("Las contraseñas no coinciden");return}C(!0);try{const H=iu(),Pe=await es(H,E.email,E.password);await ze(Ne(F,"agentes",x.id),{email:E.email,fechaActualizacion:new Date}),await Ar(Ne(F,"usuarios",Pe.user.uid),{uid:Pe.user.uid,email:E.email,nombre:x.nombre,rol:"agente",agenteId:x.id,telefono:x.telefono,zona:x.zona_asignada,activo:x.activo,fechaCreacion:new Date,creadoPorAdmin:!0}),alert(`Credenciales asignadas exitosamente.
Email: ${E.email}
Contraseña: ${E.password}

El agente ya puede acceder a su panel de gestión.`),await Q(),G()}catch(H){console.error("Error asignando credenciales:",H),alert("Error al asignar credenciales: "+H.message)}finally{C(!1)}},Te=async H=>{try{q(H),U([]);const Pe=await le(fe(W(F,"empresas"),pe("agenteAsignado","==",null),pe("estado","in",["catalogada","pendiente_validacion"])));if(Pe.docs.length===0){alert("No hay empresas disponibles para asignar");return}const Ye=Pe.docs.map(it=>({id:it.id,...it.data()}));z(Ye),M(!0)}catch(Pe){console.error("Error cargando empresas disponibles:",Pe),alert("Error al cargar empresas disponibles: "+Pe.message)}},B=async()=>{if(j.length===0){alert("Debes seleccionar al menos una empresa");return}try{C(!0);const H=$k(F);j.forEach(Pe=>{const Ye=Ne(F,"empresas",Pe);H.update(Ye,{agenteAsignado:$.id,fechaAsignacion:new Date})}),await H.commit(),alert(`${j.length} empresas asignadas al agente ${$.nombre}`),await Q(),M(!1),q(null),z([]),U([])}catch(H){console.error("Error asignando empresas:",H),alert("Error al asignar empresas: "+H.message)}finally{C(!1)}},ve=()=>{M(!1),q(null),z([]),U([])},je=({agente:H})=>{const Pe=(m==null?void 0:m.filter(mt=>mt.agenteAsignado===H.id))||[],Ye=Pe.filter(mt=>mt.visitaAgente).length,it=Pe.filter(mt=>mt.estado==="validada").length;return t.createElement("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200"},t.createElement("div",{className:"flex items-center justify-between mb-4"},t.createElement("div",null,t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},H.nombre),t.createElement("p",{className:"text-sm text-gray-500"},H.email)),t.createElement("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${H.activo!==!1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},H.activo!==!1?"Activo":"Inactivo")),t.createElement("div",{className:"space-y-2 mb-4"},t.createElement("div",{className:"text-sm"},t.createElement("span",{className:"font-medium"},"Teléfono:")," ",H.telefono||"No especificado"),t.createElement("div",{className:"text-sm"},t.createElement("span",{className:"font-medium"},"Zona:")," ",H.zona_asignada||"Sin asignar")),t.createElement("div",{className:"grid grid-cols-3 gap-2 mb-4 text-center"},t.createElement("div",{className:"bg-blue-50 rounded p-2"},t.createElement("div",{className:"text-lg font-bold text-blue-600"},Pe.length),t.createElement("div",{className:"text-xs text-blue-600"},"Empresas")),t.createElement("div",{className:"bg-green-50 rounded p-2"},t.createElement("div",{className:"text-lg font-bold text-green-600"},Ye),t.createElement("div",{className:"text-xs text-green-600"},"Visitas")),t.createElement("div",{className:"bg-purple-50 rounded p-2"},t.createElement("div",{className:"text-lg font-bold text-purple-600"},it),t.createElement("div",{className:"text-xs text-purple-600"},"Validadas"))),t.createElement("div",{className:"flex flex-wrap gap-2"},t.createElement("button",{onClick:()=>X(H),className:"text-xs bg-blue-100 text-blue-700 px-3 py-1 rounded hover:bg-blue-200"},"✏️ Editar"),t.createElement("button",{onClick:()=>Te(H),className:"text-xs bg-green-100 text-green-700 px-3 py-1 rounded hover:bg-green-200"},"📋 Asignar empresas"),!H.email&&t.createElement("button",{onClick:()=>{y(H),_({email:"",password:"",confirmPassword:""}),N(!0)},className:"text-xs bg-purple-100 text-purple-700 px-3 py-1 rounded hover:bg-purple-200"},"🔑 Asignar credenciales"),t.createElement("button",{onClick:()=>Se(H),className:`text-xs px-3 py-1 rounded ${H.activo!==!1?"bg-yellow-100 text-yellow-700 hover:bg-yellow-200":"bg-green-100 text-green-700 hover:bg-green-200"}`},H.activo!==!1?"⏸️ Desactivar":"▶️ Activar")))},_e={total:a.length,activos:a.filter(H=>H.activo!==!1).length,inactivos:a.filter(H=>H.activo===!1).length,empresasAsignadas:(m==null?void 0:m.length)||0,visitasRealizadas:(m==null?void 0:m.filter(H=>H.visitaAgente).length)||0};return n?t.createElement("div",{className:"flex items-center justify-center p-8"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),t.createElement("p",{className:"text-gray-600"},"Cargando agentes..."))):t.createElement("div",{className:"p-6"},t.createElement("div",{className:"mb-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Gestión Unificada de Agentes de Campo"),t.createElement("p",{className:"text-gray-600"},"Administra los agentes que pueden crear solicitudes y activar empresas en terreno")),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6"},t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-blue-800"},_e.total),t.createElement("div",{className:"text-blue-600 text-sm"},"Total Agentes")),t.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-green-800"},_e.activos),t.createElement("div",{className:"text-green-600 text-sm"},"Agentes Activos")),t.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-red-800"},_e.inactivos),t.createElement("div",{className:"text-red-600 text-sm"},"Agentes Inactivos")),t.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-purple-800"},_e.empresasAsignadas),t.createElement("div",{className:"text-purple-600 text-sm"},"Empresas Asignadas")),t.createElement("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 text-center"},t.createElement("div",{className:"text-2xl font-bold text-orange-800"},_e.visitasRealizadas),t.createElement("div",{className:"text-orange-600 text-sm"},"Visitas Realizadas"))),t.createElement("div",{className:"flex justify-between items-center mb-6"},t.createElement("button",{onClick:()=>X(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},"➕ Agregar Nuevo Agente"),t.createElement("div",{className:"flex items-center space-x-2"},t.createElement("span",{className:"text-sm text-gray-600"},"Vista:"),t.createElement("button",{onClick:()=>k("tabla"),className:`px-3 py-1 rounded text-sm ${P==="tabla"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"📊 Tabla"),t.createElement("button",{onClick:()=>k("tarjetas"),className:`px-3 py-1 rounded text-sm ${P==="tarjetas"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"🃏 Tarjetas"))),P==="tabla"?t.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},t.createElement("div",{className:"overflow-x-auto"},t.createElement("table",{className:"min-w-full"},t.createElement("thead",{className:"bg-gray-50"},t.createElement("tr",null,t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Agente"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Contacto"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Zona Asignada"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Estado"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Estadísticas"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Fecha Creación"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Acciones"))),t.createElement("tbody",{className:"divide-y divide-gray-200"},a.map(H=>{var mt,be,Re;const Pe=(m==null?void 0:m.filter(qe=>qe.agenteAsignado===H.id))||[],Ye=Pe.filter(qe=>qe.visitaAgente).length,it=Pe.filter(qe=>qe.estado==="validada").length;return t.createElement("tr",{key:H.id,className:"hover:bg-gray-50"},t.createElement("td",{className:"px-6 py-4"},t.createElement("div",null,t.createElement("div",{className:"font-medium text-gray-900"},H.nombre),t.createElement("div",{className:"text-sm text-gray-500"},"ID: ",H.id.slice(-6)))),t.createElement("td",{className:"px-6 py-4"},t.createElement("div",{className:"text-sm"},t.createElement("div",null,H.email||"Sin credenciales"),t.createElement("div",{className:"text-gray-500"},H.telefono))),t.createElement("td",{className:"px-6 py-4"},t.createElement("span",{className:"text-sm text-gray-900"},H.zona_asignada||"Sin asignar")),t.createElement("td",{className:"px-6 py-4"},t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${H.activo!==!1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},H.activo!==!1?"Activo":"Inactivo")),t.createElement("td",{className:"px-6 py-4"},t.createElement("div",{className:"text-sm"},t.createElement("div",null,"📊 ",Pe.length," empresas"),t.createElement("div",null,"✅ ",Ye," visitas"),t.createElement("div",null,"🎯 ",it," validadas"))),t.createElement("td",{className:"px-6 py-4 text-sm text-gray-500"},((Re=(be=(mt=H.fechaCreacion)==null?void 0:mt.toDate)==null?void 0:be.call(mt))==null?void 0:Re.toLocaleDateString())||"N/A"),t.createElement("td",{className:"px-6 py-4"},t.createElement("div",{className:"flex space-x-2"},t.createElement("button",{onClick:()=>X(H),className:"text-blue-600 hover:text-blue-900 text-sm"},"Editar"),t.createElement("button",{onClick:()=>Te(H),className:"text-green-600 hover:text-green-900 text-sm"},"Asignar"),!H.email&&t.createElement("button",{onClick:()=>{y(H),_({email:"",password:"",confirmPassword:""}),N(!0)},className:"text-purple-600 hover:text-purple-900 text-sm"},"Credenciales"),t.createElement("button",{onClick:()=>Se(H),className:`text-sm ${H.activo!==!1?"text-yellow-600 hover:text-yellow-900":"text-green-600 hover:text-green-900"}`},H.activo!==!1?"Desactivar":"Activar"),t.createElement("button",{onClick:()=>de(H),className:"text-red-600 hover:text-red-900 text-sm"},"Eliminar"))))}))))):t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6"},a.map(H=>t.createElement(je,{key:H.id,agente:H}))),s&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},t.createElement("div",{className:"bg-white rounded-lg max-w-md w-full"},t.createElement("form",{onSubmit:Y,className:"p-6"},t.createElement("h2",{className:"text-xl font-bold text-gray-900 mb-4"},i?"Editar Agente":"Nuevo Agente"),t.createElement("div",{className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Nombre completo *"),t.createElement("input",{type:"text",value:c.nombre,onChange:H=>u({...c,nombre:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Email *"),t.createElement("input",{type:"email",value:c.email,onChange:H=>u({...c,email:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Teléfono"),t.createElement("input",{type:"tel",value:c.telefono,onChange:H=>u({...c,telefono:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Zona asignada"),t.createElement("select",{value:c.zona_asignada,onChange:H=>u({...c,zona_asignada:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:""},"Seleccionar zona"),d.map(H=>t.createElement("option",{key:H,value:H},H)))),!i&&t.createElement(t.Fragment,null,t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Contraseña"),t.createElement("div",{className:"flex space-x-2"},t.createElement("input",{type:"text",value:c.password,onChange:H=>u({...c,password:H.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Dejar vacío para asignar después"}),t.createElement("button",{type:"button",onClick:se,className:"px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700"},"🔐")))),t.createElement("div",{className:"flex items-center"},t.createElement("input",{type:"checkbox",checked:c.activo,onChange:H=>u({...c,activo:H.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),t.createElement("label",{className:"ml-2 text-sm text-gray-700"},"Agente activo"))),t.createElement("div",{className:"flex justify-end space-x-3 mt-6"},t.createElement("button",{type:"button",onClick:ye,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"},"Cancelar"),t.createElement("button",{type:"submit",disabled:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-400 disabled:cursor-not-allowed"},h?"Guardando...":i?"Actualizar":"Crear"))))),S&&f&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},t.createElement("div",{className:"bg-white rounded-lg max-w-md w-full p-6"},t.createElement("h2",{className:"text-xl font-bold text-gray-900 mb-4"},"Cambiar Contraseña - ",f.nombre),t.createElement("div",{className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Nueva contraseña"),t.createElement("div",{className:"flex space-x-2"},t.createElement("input",{type:"text",value:v,onChange:H=>I(H.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.createElement("button",{type:"button",onClick:ge,className:"px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700"},"🔐")))),t.createElement("div",{className:"flex justify-end space-x-3 mt-6"},t.createElement("button",{onClick:oe,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"},"Cancelar"),t.createElement("button",{onClick:me,disabled:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-400 disabled:cursor-not-allowed"},h?"Cambiando...":"Cambiar Contraseña")))),A&&x&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},t.createElement("div",{className:"bg-white rounded-lg max-w-md w-full p-6"},t.createElement("h2",{className:"text-xl font-bold text-gray-900 mb-4"},"Asignar Credenciales - ",x.nombre),t.createElement("div",{className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Email *"),t.createElement("input",{type:"email",value:E.email,onChange:H=>_({...E,email:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Contraseña *"),t.createElement("div",{className:"flex space-x-2"},t.createElement("input",{type:"text",value:E.password,onChange:H=>_({...E,password:H.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),t.createElement("button",{type:"button",onClick:he,className:"px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700"},"🔐"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Confirmar Contraseña *"),t.createElement("input",{type:"text",value:E.confirmPassword,onChange:H=>_({...E,confirmPassword:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}))),t.createElement("div",{className:"flex justify-end space-x-3 mt-6"},t.createElement("button",{onClick:G,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"},"Cancelar"),t.createElement("button",{onClick:we,disabled:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-400 disabled:cursor-not-allowed"},h?"Asignando...":"Asignar Credenciales")))),D&&$&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},t.createElement("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden"},t.createElement("div",{className:"flex justify-between items-center p-6 border-b border-gray-200"},t.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Asignar Empresas - ",$.nombre),t.createElement("button",{onClick:ve,className:"text-gray-400 hover:text-gray-600 transition-colors"},t.createElement("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})))),t.createElement("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]"},t.createElement("div",{className:"mb-4"},t.createElement("p",{className:"text-sm text-gray-600 mb-4"},"Selecciona las empresas que deseas asignar al agente ",$.nombre,":"),t.createElement("div",{className:"flex justify-between items-center mb-4"},t.createElement("span",{className:"text-sm text-gray-600"},j.length," de ",V.length," empresas seleccionadas"),t.createElement("button",{onClick:()=>U(V.map(H=>H.id)),className:"text-sm text-blue-600 hover:text-blue-800"},"Seleccionar todas"))),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},V.map(H=>t.createElement("div",{key:H.id,className:"border border-gray-200 rounded-lg p-4"},t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("input",{type:"checkbox",checked:j.includes(H.id),onChange:Pe=>{Pe.target.checked?U([...j,H.id]):U(j.filter(Ye=>Ye!==H.id))},className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),t.createElement("div",{className:"flex-1"},t.createElement("h3",{className:"font-medium text-gray-900"},H.nombre),t.createElement("p",{className:"text-sm text-gray-500"},H.direccion),t.createElement("div",{className:"flex items-center space-x-2 mt-2"},t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${H.estado==="catalogada"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`},H.estado==="catalogada"?"Catalogada":"Pendiente"),H.tipo&&t.createElement("span",{className:"text-xs text-gray-500"},H.tipo))))))),V.length===0&&t.createElement("div",{className:"text-center py-8"},t.createElement("p",{className:"text-gray-500"},"No hay empresas disponibles para asignar"))),t.createElement("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200"},t.createElement("button",{onClick:ve,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"},"Cancelar"),t.createElement("button",{onClick:B,disabled:h||j.length===0,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-400 disabled:cursor-not-allowed"},h?"Asignando...":`Asignar ${j.length} empresas`)))))}function H9(){const[a,e]=p.useState(!1),[n,r]=p.useState(""),[s,o]=p.useState(!1),i=async()=>{e(!0),r("");try{const d=(await es(Pt,"admin@av10dejulio.com","admin123456")).user;await Ar(Ne(F,"usuarios",d.uid),{email:d.email,rol:"admin",nombre:"Administrador",created:new Date,activo:!0}),r("✅ Usuario admin creado exitosamente!")}catch(u){console.error("Error creando admin:",u),u.code==="auth/email-already-in-use"?(r("⚠️ El email ya está en uso. Intentando actualizar rol..."),await l()):r(`❌ Error: ${u.message}`)}e(!1)},l=async()=>{try{const u=Pt.currentUser;u?(await Ar(Ne(F,"usuarios",u.uid),{email:u.email,rol:"admin",nombre:"Administrador",updated:new Date,activo:!0},{merge:!0}),r("✅ Rol actualizado a admin para el usuario actual!")):r("❌ No hay usuario logueado para actualizar")}catch(u){r(`❌ Error actualizando rol: ${u.message}`)}},c=async()=>{e(!0),r("");try{const u=Pt.currentUser;if(u){const d=await en(Ne(F,"usuarios",u.uid));if(d.exists()){const m=d.data();r(`Usuario actual: ${m.email} - Rol: ${m.rol}`)}else r("Usuario autenticado pero sin documento en usuarios - Crea el documento admin")}else r("No hay usuario autenticado")}catch(u){r(`Error verificando usuario: ${u.message}`)}e(!1)};return t.createElement("div",{className:"fixed top-4 right-4 bg-white border border-gray-300 rounded-lg shadow-lg p-4 max-w-xs z-50"},t.createElement("div",{className:"flex justify-between items-center mb-2"},t.createElement("h3",{className:"font-bold text-sm"},"Admin Setup"),t.createElement("button",{onClick:()=>o(!s),className:"text-gray-500 hover:text-gray-700 text-xs"},s?"📖":"📕")),!s&&t.createElement(t.Fragment,null,t.createElement("button",{onClick:c,disabled:a,className:"w-full mb-2 bg-blue-500 text-white px-3 py-1 rounded text-xs hover:bg-blue-600 disabled:opacity-50"},a?"Verificando...":"Verificar Usuario"),t.createElement("button",{onClick:i,disabled:a,className:"w-full mb-2 bg-green-500 text-white px-3 py-1 rounded text-xs hover:bg-green-600 disabled:opacity-50"},a?"Creando...":"Crear/Actualizar Admin"),t.createElement("button",{onClick:l,disabled:a,className:"w-full mb-2 bg-purple-500 text-white px-3 py-1 rounded text-xs hover:bg-purple-600 disabled:opacity-50"},a?"Actualizando...":"Hacer Admin Actual"),n&&t.createElement("div",{className:"text-xs mt-2 p-2 bg-gray-100 rounded max-h-20 overflow-y-auto"},n),t.createElement("div",{className:"text-xs mt-2 text-gray-600"},"Email: admin@av10dejulio.com",t.createElement("br",null),"Pass: admin123456")))}const av=({value:a=0,onChange:e=null,readonly:n=!1,size:r="md",showValue:s=!0,className:o="",color:i="yellow"})=>{const[l,c]=p.useState(0),[u,d]=p.useState(a);p.useEffect(()=>{d(a)},[a]);const m={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"},h={yellow:{filled:"text-yellow-400",empty:"text-gray-300"},blue:{filled:"text-blue-400",empty:"text-gray-300"},red:{filled:"text-red-400",empty:"text-gray-300"},green:{filled:"text-green-400",empty:"text-gray-300"}},C=v=>{n||(d(v),e&&e(v))},S=v=>{n||c(v)},w=()=>{n||c(0)},f=l||u||a,b=h[i]||h.yellow;return t.createElement("div",{className:`flex items-center gap-1 ${o}`},t.createElement("div",{className:"flex items-center"},[1,2,3,4,5].map(v=>t.createElement("button",{key:v,type:"button",className:`${m[r]} ${n?"cursor-default":"cursor-pointer hover:scale-110"} transition-transform duration-150 focus:outline-none`,onClick:()=>C(v),onMouseEnter:()=>S(v),onMouseLeave:w,disabled:n,"aria-label":`${v} star${v!==1?"s":""}`},t.createElement("svg",{className:`w-full h-full fill-current transition-colors duration-150 ${v<=f?b.filled:b.empty}`,viewBox:"0 0 24 24"},t.createElement("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}))))),s&&t.createElement("span",{className:"text-sm text-gray-600 ml-2 font-medium"},f>0?f.toFixed(1):"0.0"," / 5"))},NT=({proveedorId:a,productoId:e=null,showModeration:n=!1,limitCount:r=10})=>{const{user:s,rol:o}=ht(),[i,l]=p.useState([]),[c,u]=p.useState(!0),[d,m]=p.useState("all"),[h,C]=p.useState("");p.useEffect(()=>{S()},[a,e,d]);const S=async()=>{u(!0);try{let I=[pe("proveedorId","==",a)];e?I.push(pe("productoId","==",e)):I.push(pe("productoId","==",null)),n&&d!=="all"?I.push(pe("estado","==",d)):n||I.push(pe("estado","==","aprobada")),I.push(st("fecha","desc")),r&&I.push(Ot(r));const A=fe(W(F,"reseñas"),...I),N=await le(A);l(N.docs.map(x=>({id:x.id,...x.data()})))}catch(I){console.error("Error fetching reviews:",I),l([])}finally{u(!1)}},w=async(I,A)=>{C(I);try{await ze(Ne(F,"reseñas",I),{estado:A,moderadoPor:s.uid,fechaModeracion:new Date}),l(i.map(N=>N.id===I?{...N,estado:A}:N))}catch(N){console.error("Error moderating review:",N)}finally{C("")}},f=async I=>{if(window.confirm("¿Estás seguro de que quieres eliminar esta reseña?")){C(I);try{await on(Ne(F,"reseñas",I)),l(i.filter(A=>A.id!==I))}catch(A){console.error("Error deleting review:",A)}finally{C("")}}},b=I=>I?I.toDate?I.toDate().toLocaleDateString():I instanceof Date?I.toLocaleDateString():new Date(I).toLocaleDateString():"",v=I=>{switch(I){case"aprobada":return"bg-green-100 text-green-800";case"pendiente":return"bg-yellow-100 text-yellow-800";case"rechazada":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return c?t.createElement("div",{className:"flex justify-center py-8"},t.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})):t.createElement("div",{className:"space-y-4"},n&&t.createElement("div",{className:"flex flex-wrap gap-2 mb-4"},t.createElement("button",{onClick:()=>m("all"),className:`px-3 py-1 rounded text-sm ${d==="all"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Todas"),t.createElement("button",{onClick:()=>m("pendiente"),className:`px-3 py-1 rounded text-sm ${d==="pendiente"?"bg-yellow-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Pendientes"),t.createElement("button",{onClick:()=>m("aprobada"),className:`px-3 py-1 rounded text-sm ${d==="aprobada"?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Aprobadas"),t.createElement("button",{onClick:()=>m("rechazada"),className:`px-3 py-1 rounded text-sm ${d==="rechazada"?"bg-red-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Rechazadas")),i.length===0?t.createElement("div",{className:"text-center py-8 text-gray-500"},d==="all"||!n?"No hay reseñas aún":`No hay reseñas ${d}s`):t.createElement("div",{className:"space-y-4"},i.map(I=>t.createElement("div",{key:I.id,className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm"},t.createElement("div",{className:"flex items-start justify-between"},t.createElement("div",{className:"flex-1"},t.createElement("div",{className:"flex items-center gap-3 mb-2"},t.createElement(av,{value:I.puntaje,readonly:!0,size:"sm",showValue:!1}),t.createElement("span",{className:"text-sm text-gray-600"},"por ",I.usuarioNombre||I.usuarioEmail),t.createElement("span",{className:"text-xs text-gray-400"},b(I.fecha)),n&&t.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${v(I.estado)}`},I.estado||"pendiente")),t.createElement("p",{className:"text-gray-800 text-sm leading-relaxed"},I.comentario)),n&&o==="admin"&&t.createElement("div",{className:"flex flex-col gap-1 ml-4"},I.estado!=="aprobada"&&t.createElement("button",{onClick:()=>w(I.id,"aprobada"),disabled:h===I.id,className:"px-2 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50"},"✓ Aprobar"),I.estado!=="rechazada"&&t.createElement("button",{onClick:()=>w(I.id,"rechazada"),disabled:h===I.id,className:"px-2 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700 disabled:opacity-50"},"✗ Rechazar"),t.createElement("button",{onClick:()=>f(I.id),disabled:h===I.id,className:"px-2 py-1 bg-gray-600 text-white text-xs rounded hover:bg-gray-700 disabled:opacity-50"},"🗑 Eliminar")))))))};function VE({children:a}){const{user:e,rol:n,loading:r}=ht();return r?t.createElement("div",null,"Cargando..."):e&&n==="admin"?a:t.createElement(kA,{to:"/login"})}const K9=()=>{ht();const[a,e]=p.useState([]),[n,r]=p.useState({}),[s,o]=p.useState({}),[i,l]=p.useState(!0),[c,u]=p.useState("pendiente"),[d,m]=p.useState({total:0,pendiente:0,aprobada:0,rechazada:0});p.useEffect(()=>{C(),h()},[c]);const h=async()=>{try{const f=fe(W(F,"reseñas")),b=await le(f),v={total:0,pendiente:0,aprobada:0,rechazada:0};b.docs.forEach(I=>{const A=I.data();v.total++,v[A.estado||"pendiente"]++}),m(v)}catch(f){console.error("Error fetching stats:",f)}},C=async()=>{l(!0);try{let f;c==="all"?f=fe(W(F,"reseñas"),st("fecha","desc")):f=fe(W(F,"reseñas"),pe("estado","==",c),st("fecha","desc"));const v=(await le(f)).docs.map(y=>({id:y.id,...y.data()}));e(v);const I=[...new Set(v.map(y=>y.proveedorId))],A=[...new Set(v.filter(y=>y.productoId).map(y=>y.productoId))],N={};for(const y of I)try{const E=await en(Ne(F,"empresas",y));E.exists()&&(N[y]=E.data())}catch(E){console.error("Error fetching provider:",y,E)}r(N);const x={};for(const y of A)try{const E=await en(Ne(F,"productos",y));E.exists()&&(x[y]=E.data())}catch(E){console.error("Error fetching product:",y,E)}o(x)}catch(f){console.error("Error fetching reviews:",f)}finally{l(!1)}},S=f=>f?f.toDate?f.toDate().toLocaleString():f instanceof Date?f.toLocaleString():new Date(f).toLocaleString():"",w=f=>{switch(f){case"aprobada":return"bg-green-100 text-green-800";case"pendiente":return"bg-yellow-100 text-yellow-800";case"rechazada":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return t.createElement(VE,null,t.createElement(er,null,t.createElement("div",{className:"max-w-7xl mx-auto"},t.createElement("div",{className:"mb-8"},t.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Moderación de Reseñas"),t.createElement("p",{className:"text-gray-600"},"Gestiona y modera las reseñas de proveedores y productos")),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-8"},t.createElement("div",{className:"bg-blue-100 p-4 rounded-lg text-center"},t.createElement("div",{className:"text-2xl font-bold text-blue-900"},d.total),t.createElement("div",{className:"text-sm text-blue-700"},"Total")),t.createElement("div",{className:"bg-yellow-100 p-4 rounded-lg text-center"},t.createElement("div",{className:"text-2xl font-bold text-yellow-900"},d.pendiente),t.createElement("div",{className:"text-sm text-yellow-700"},"Pendientes")),t.createElement("div",{className:"bg-green-100 p-4 rounded-lg text-center"},t.createElement("div",{className:"text-2xl font-bold text-green-900"},d.aprobada),t.createElement("div",{className:"text-sm text-green-700"},"Aprobadas")),t.createElement("div",{className:"bg-red-100 p-4 rounded-lg text-center"},t.createElement("div",{className:"text-2xl font-bold text-red-900"},d.rechazada),t.createElement("div",{className:"text-sm text-red-700"},"Rechazadas"))),t.createElement("div",{className:"flex flex-wrap gap-2 mb-6"},t.createElement("button",{onClick:()=>u("all"),className:`px-4 py-2 rounded text-sm font-medium ${c==="all"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Todas (",d.total,")"),t.createElement("button",{onClick:()=>u("pendiente"),className:`px-4 py-2 rounded text-sm font-medium ${c==="pendiente"?"bg-yellow-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Pendientes (",d.pendiente,")"),t.createElement("button",{onClick:()=>u("aprobada"),className:`px-4 py-2 rounded text-sm font-medium ${c==="aprobada"?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Aprobadas (",d.aprobada,")"),t.createElement("button",{onClick:()=>u("rechazada"),className:`px-4 py-2 rounded text-sm font-medium ${c==="rechazada"?"bg-red-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Rechazadas (",d.rechazada,")")),i?t.createElement("div",{className:"flex justify-center py-12"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})):a.length===0?t.createElement("div",{className:"text-center py-12 text-gray-500"},"No hay reseñas ",c==="all"?"":c+"s"," en este momento"):t.createElement("div",{className:"space-y-4"},a.map(f=>{var b,v,I;return t.createElement("div",{key:f.id,className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm"},t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4"},t.createElement("div",{className:"lg:col-span-2"},t.createElement("div",{className:"flex items-start justify-between mb-3"},t.createElement("div",null,t.createElement("div",{className:"flex items-center gap-2 mb-1"},t.createElement("div",{className:"flex text-yellow-400"},"★".repeat(f.puntaje),"☆".repeat(5-f.puntaje)),t.createElement("span",{className:"text-sm text-gray-600"},f.puntaje,"/5"),t.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${w(f.estado)}`},f.estado||"pendiente")),t.createElement("div",{className:"text-sm text-gray-600"},"Por: ",f.usuarioNombre||f.usuarioEmail),t.createElement("div",{className:"text-xs text-gray-400"},S(f.fecha)))),t.createElement("p",{className:"text-gray-800 mb-3 leading-relaxed"},f.comentario)),t.createElement("div",{className:"bg-gray-50 p-4 rounded-lg"},t.createElement("h4",{className:"font-medium text-gray-900 mb-2"},f.productoId?"Producto":"Proveedor"),f.productoId?t.createElement("div",null,t.createElement("div",{className:"text-sm font-medium text-gray-800"},((b=s[f.productoId])==null?void 0:b.nombre)||"Producto eliminado"),t.createElement("div",{className:"text-xs text-gray-600 mt-1"},"Proveedor: ",((v=n[f.proveedorId])==null?void 0:v.nombre)||"N/A")):t.createElement("div",{className:"text-sm font-medium text-gray-800"},((I=n[f.proveedorId])==null?void 0:I.nombre)||"Proveedor eliminado"),t.createElement("div",{className:"mt-4"},t.createElement(NT,{proveedorId:f.proveedorId,productoId:f.productoId,showModeration:!0,limitCount:1})))))})))))},Q9=()=>{const{user:a}=ht(),[e,n]=p.useState([]),[r,s]=p.useState(!0),[o,i]=p.useState("all"),[l,c]=p.useState(null),[u,d]=p.useState(""),[m,h]=p.useState(!1);p.useEffect(()=>{C()},[o]);const C=async()=>{s(!0);try{let x=fe(W(F,"tickets"),st("fechaCreacion","desc")),E=(await le(x)).docs.map(_=>({id:_.id,..._.data()}));o!=="all"&&(E=E.filter(_=>{switch(o){case"abierto":return _.estado==="abierto";case"en_proceso":return _.estado==="en_proceso";case"resuelto":return _.estado==="resuelto";case"cerrado":return _.estado==="cerrado";case"alta_prioridad":return _.prioridad==="alta"||_.prioridad==="urgente";case"sin_respuesta":return!_.respuestas||_.respuestas.length===0;default:return!0}})),n(E)}catch(x){console.error("Error fetching tickets:",x)}finally{s(!1)}},S=async x=>{if(c(x),!x.visto)try{await ze(Ne(F,"tickets",x.id),{visto:!0,fechaActualizacion:sa()}),n(y=>y.map(E=>E.id===x.id?{...E,visto:!0}:E))}catch(y){console.error("Error marking ticket as seen:",y)}},w=async(x,y)=>{try{await ze(Ne(F,"tickets",x),{estado:y,fechaActualizacion:sa(),...y==="resuelto"&&{resuelto:!0}}),n(E=>E.map(_=>_.id===x?{..._,estado:y}:_)),l&&l.id===x&&c(E=>({...E,estado:y}))}catch(E){console.error("Error updating ticket status:",E)}},f=async()=>{if(!(!u.trim()||!l)){h(!0);try{const x={mensaje:u.trim(),autor:a.displayName||a.email,autorId:a.uid,fecha:sa(),esAdmin:!0},y=l.respuestas||[];y.push(x),await ze(Ne(F,"tickets",l.id),{respuestas:y,estado:"en_proceso",fechaActualizacion:sa()}),c(E=>({...E,respuestas:y,estado:"en_proceso"})),n(E=>E.map(_=>_.id===l.id?{..._,respuestas:y,estado:"en_proceso"}:_)),d("")}catch(x){console.error("Error sending response:",x)}finally{h(!1)}}},b=x=>{switch(x){case"abierto":return"bg-blue-100 text-blue-800";case"en_proceso":return"bg-yellow-100 text-yellow-800";case"resuelto":return"bg-green-100 text-green-800";case"cerrado":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},v=x=>{switch(x){case"baja":return"text-green-600";case"media":return"text-yellow-600";case"alta":return"text-orange-600";case"urgente":return"text-red-600";default:return"text-gray-600"}},I=x=>x?(x.toDate?x.toDate():new Date(x)).toLocaleString():"",N=(()=>{const x=e.length,y=e.filter(k=>k.estado==="abierto").length,E=e.filter(k=>k.estado==="en_proceso").length,_=e.filter(k=>k.estado==="resuelto").length,P=e.filter(k=>!k.respuestas||k.respuestas.length===0).length;return{total:x,abiertos:y,enProceso:E,resueltos:_,sinRespuesta:P}})();return r?t.createElement("div",{className:"flex justify-center py-8"},t.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})):t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6"},t.createElement("div",{className:"lg:col-span-2"},t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6"},t.createElement("div",{className:"bg-white p-3 rounded-lg shadow-sm text-center"},t.createElement("div",{className:"text-xl font-bold text-blue-600"},N.total),t.createElement("div",{className:"text-xs text-gray-600"},"Total")),t.createElement("div",{className:"bg-white p-3 rounded-lg shadow-sm text-center"},t.createElement("div",{className:"text-xl font-bold text-blue-600"},N.abiertos),t.createElement("div",{className:"text-xs text-gray-600"},"Abiertos")),t.createElement("div",{className:"bg-white p-3 rounded-lg shadow-sm text-center"},t.createElement("div",{className:"text-xl font-bold text-yellow-600"},N.enProceso),t.createElement("div",{className:"text-xs text-gray-600"},"En Proceso")),t.createElement("div",{className:"bg-white p-3 rounded-lg shadow-sm text-center"},t.createElement("div",{className:"text-xl font-bold text-green-600"},N.resueltos),t.createElement("div",{className:"text-xs text-gray-600"},"Resueltos")),t.createElement("div",{className:"bg-white p-3 rounded-lg shadow-sm text-center"},t.createElement("div",{className:"text-xl font-bold text-red-600"},N.sinRespuesta),t.createElement("div",{className:"text-xs text-gray-600"},"Sin Respuesta"))),t.createElement("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6"},t.createElement("div",{className:"flex flex-wrap gap-2"},[{key:"all",label:"Todos"},{key:"abierto",label:"Abiertos"},{key:"en_proceso",label:"En Proceso"},{key:"resuelto",label:"Resueltos"},{key:"alta_prioridad",label:"Alta Prioridad"},{key:"sin_respuesta",label:"Sin Respuesta"}].map(x=>t.createElement("button",{key:x.key,onClick:()=>i(x.key),className:`px-3 py-1 rounded text-sm ${o===x.key?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},x.label)))),t.createElement("div",{className:"space-y-3"},e.map(x=>t.createElement("div",{key:x.id,onClick:()=>S(x),className:`bg-white rounded-lg shadow-sm border p-4 cursor-pointer hover:shadow-md transition-shadow ${(l==null?void 0:l.id)===x.id?"ring-2 ring-blue-500":""} ${x.visto?"":"border-l-4 border-l-blue-500"}`},t.createElement("div",{className:"flex items-start justify-between mb-2"},t.createElement("div",{className:"flex-1"},t.createElement("h3",{className:"font-medium text-gray-900 mb-1"},x.asunto),t.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600"},t.createElement("span",null,x.nombre),t.createElement("span",null,"•"),t.createElement("span",null,x.email),t.createElement("span",null,"•"),t.createElement("span",null,I(x.fechaCreacion)))),t.createElement("div",{className:"flex flex-col items-end gap-1"},t.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${b(x.estado)}`},x.estado),t.createElement("span",{className:`text-xs font-medium ${v(x.prioridad)}`},x.prioridad))),t.createElement("p",{className:"text-sm text-gray-700 line-clamp-2"},x.mensaje),t.createElement("div",{className:"flex items-center justify-between mt-2"},t.createElement("div",{className:"flex items-center gap-2"},t.createElement("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded"},x.tipo),x.categoria&&t.createElement("span",{className:"bg-gray-100 text-gray-700 text-xs px-2 py-1 rounded"},x.categoria)),x.respuestas&&x.respuestas.length>0&&t.createElement("span",{className:"text-xs text-green-600 font-medium"},x.respuestas.length," respuesta(s)")))),e.length===0&&t.createElement("div",{className:"text-center py-8 text-gray-500"},"No hay tickets para mostrar"))),t.createElement("div",{className:"lg:col-span-1"},l?t.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 sticky top-4"},t.createElement("div",{className:"mb-4"},t.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-2"},l.asunto),t.createElement("div",{className:"flex items-center justify-between mb-3"},t.createElement("span",{className:`px-2 py-1 rounded text-sm font-medium ${b(l.estado)}`},l.estado),t.createElement("select",{value:l.estado,onChange:x=>w(l.id,x.target.value),className:"text-sm border border-gray-300 rounded px-2 py-1"},t.createElement("option",{value:"abierto"},"Abierto"),t.createElement("option",{value:"en_proceso"},"En Proceso"),t.createElement("option",{value:"resuelto"},"Resuelto"),t.createElement("option",{value:"cerrado"},"Cerrado"))),t.createElement("div",{className:"text-sm text-gray-600 space-y-1"},t.createElement("div",null,t.createElement("strong",null,"De:")," ",l.nombre),t.createElement("div",null,t.createElement("strong",null,"Email:")," ",l.email),l.telefono&&t.createElement("div",null,t.createElement("strong",null,"Teléfono:")," ",l.telefono),t.createElement("div",null,t.createElement("strong",null,"Tipo:")," ",l.tipo),l.categoria&&t.createElement("div",null,t.createElement("strong",null,"Categoría:")," ",l.categoria),t.createElement("div",null,t.createElement("strong",null,"Prioridad:"),t.createElement("span",{className:v(l.prioridad)}," "+l.prioridad)),t.createElement("div",null,t.createElement("strong",null,"Fecha:")," ",I(l.fechaCreacion)))),t.createElement("div",{className:"mb-4"},t.createElement("h3",{className:"font-medium text-gray-900 mb-2"},"Mensaje:"),t.createElement("div",{className:"bg-gray-50 p-3 rounded text-sm text-gray-700"},l.mensaje)),l.respuestas&&l.respuestas.length>0&&t.createElement("div",{className:"mb-4"},t.createElement("h3",{className:"font-medium text-gray-900 mb-2"},"Respuestas:"),t.createElement("div",{className:"space-y-2 max-h-40 overflow-y-auto"},l.respuestas.map((x,y)=>t.createElement("div",{key:y,className:"bg-blue-50 p-3 rounded text-sm"},t.createElement("div",{className:"font-medium text-blue-900 mb-1"},x.autor," - ",I(x.fecha)),t.createElement("div",{className:"text-blue-800"},x.mensaje))))),t.createElement("div",null,t.createElement("h3",{className:"font-medium text-gray-900 mb-2"},"Responder:"),t.createElement("textarea",{value:u,onChange:x=>d(x.target.value),placeholder:"Escribe tu respuesta...",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4}),t.createElement("button",{onClick:f,disabled:!u.trim()||m,className:"w-full mt-2 bg-blue-600 text-white py-2 px-4 rounded text-sm hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"},m?"Enviando...":"Enviar Respuesta"))):t.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 text-center text-gray-500"},"Selecciona un ticket para ver los detalles")))},J9=()=>t.createElement(er,null,t.createElement("div",{className:"space-y-6"},t.createElement("div",null,t.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Gestión de Tickets y Feedback"),t.createElement("p",{className:"text-gray-600 mt-2"},"Administra las consultas, sugerencias, reclamos y solicitudes de soporte de los usuarios.")),t.createElement(Q9,null))),Y9=()=>{const{user:a}=ht(),[e,n]=p.useState([]),[r,s]=p.useState(!0),[o,i]=p.useState(!1),[l,c]=p.useState(null),[u,d]=p.useState({titulo:"",tipo:"blog",categoria:"mantenimiento",contenido:"",descripcion:"",videoUrl:"",imagenUrl:"",tags:"",orden:0,estado:"activo"}),m=[{value:"blog",label:"Artículo de Blog"},{value:"tip",label:"Tip/Consejo"},{value:"tutorial",label:"Tutorial"},{value:"video",label:"Video"},{value:"faq",label:"Pregunta Frecuente"}],h=[{value:"mantenimiento",label:"Mantenimiento Vehicular"},{value:"repuestos",label:"Selección de Repuestos"},{value:"seguridad",label:"Seguridad Vial"},{value:"general",label:"General"}];p.useEffect(()=>{C()},[]);const C=async()=>{s(!0);try{const N=fe(W(F,"recursos_educativos"),st("orden","asc"),st("fechaCreacion","desc")),x=await le(N);n(x.docs.map(y=>({id:y.id,...y.data()})))}catch(N){console.error("Error fetching resources:",N)}finally{s(!1)}},S=async N=>{if(N.preventDefault(),!u.titulo.trim()||!u.contenido.trim()){alert("Por favor completa los campos obligatorios");return}try{const x={...u,tags:u.tags.split(",").map(y=>y.trim()).filter(y=>y),orden:parseInt(u.orden)||0,fechaActualizacion:sa(),actualizadoPor:a.uid};l?await ze(Ne(F,"recursos_educativos",l.id),x):(x.fechaCreacion=sa(),x.creadoPor=a.uid,await ot(W(F,"recursos_educativos"),x)),b(),C()}catch(x){console.error("Error saving resource:",x),alert("Error al guardar el recurso")}},w=N=>{c(N),d({...N,tags:Array.isArray(N.tags)?N.tags.join(", "):""}),i(!0)},f=async N=>{if(window.confirm("¿Estás seguro de que quieres eliminar este recurso?"))try{await on(Ne(F,"recursos_educativos",N)),C()}catch(x){console.error("Error deleting resource:",x),alert("Error al eliminar el recurso")}},b=()=>{d({titulo:"",tipo:"blog",categoria:"mantenimiento",contenido:"",descripcion:"",videoUrl:"",imagenUrl:"",tags:"",orden:0,estado:"activo"}),c(null),i(!1)},v=N=>N?N.toDate?N.toDate().toLocaleDateString():N instanceof Date?N.toLocaleDateString():new Date(N).toLocaleDateString():"",I=N=>{switch(N){case"activo":return"bg-green-100 text-green-800";case"borrador":return"bg-yellow-100 text-yellow-800";case"archivado":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},A=N=>{switch(N){case"blog":return"📝";case"tip":return"💡";case"tutorial":return"🎓";case"video":return"🎥";case"faq":return"❓";default:return"📄"}};return t.createElement(VE,null,t.createElement(er,null,t.createElement("div",{className:"max-w-7xl mx-auto"},t.createElement("div",{className:"mb-8 flex justify-between items-center"},t.createElement("div",null,t.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Gestión de Recursos Educativos"),t.createElement("p",{className:"text-gray-600"},"Administra contenido educativo para usuarios")),t.createElement("button",{onClick:()=>i(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700"},"Nuevo Recurso")),o&&t.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-8"},t.createElement("div",{className:"flex justify-between items-center mb-4"},t.createElement("h2",{className:"text-xl font-semibold"},l?"Editar Recurso":"Nuevo Recurso"),t.createElement("button",{onClick:b,className:"text-gray-500 hover:text-gray-700"},"✕")),t.createElement("form",{onSubmit:S,className:"space-y-4"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Título *"),t.createElement("input",{type:"text",value:u.titulo,onChange:N=>d({...u,titulo:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Tipo de Recurso"),t.createElement("select",{value:u.tipo,onChange:N=>d({...u,tipo:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},m.map(N=>t.createElement("option",{key:N.value,value:N.value},N.label)))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Categoría"),t.createElement("select",{value:u.categoria,onChange:N=>d({...u,categoria:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},h.map(N=>t.createElement("option",{key:N.value,value:N.value},N.label)))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Estado"),t.createElement("select",{value:u.estado,onChange:N=>d({...u,estado:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"activo"},"Activo"),t.createElement("option",{value:"borrador"},"Borrador"),t.createElement("option",{value:"archivado"},"Archivado")))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Descripción Breve"),t.createElement("textarea",{value:u.descripcion,onChange:N=>d({...u,descripcion:N.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Descripción corta para mostrar en listados..."})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Contenido *"),t.createElement("textarea",{value:u.contenido,onChange:N=>d({...u,contenido:N.target.value}),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Contenido completo del recurso...",required:!0})),u.tipo==="video"&&t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"URL del Video"),t.createElement("input",{type:"url",value:u.videoUrl,onChange:N=>d({...u,videoUrl:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://youtube.com/..."})),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"URL de Imagen"),t.createElement("input",{type:"url",value:u.imagenUrl,onChange:N=>d({...u,imagenUrl:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Tags (separados por comas)"),t.createElement("input",{type:"text",value:u.tags,onChange:N=>d({...u,tags:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"mantenimiento, aceite, filtros"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Orden"),t.createElement("input",{type:"number",value:u.orden,onChange:N=>d({...u,orden:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0"}))),t.createElement("div",{className:"flex gap-2"},t.createElement("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700"},l?"Actualizar":"Crear"," Recurso"),t.createElement("button",{type:"button",onClick:b,className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400"},"Cancelar")))),r?t.createElement("div",{className:"flex justify-center py-12"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})):t.createElement("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden"},t.createElement("div",{className:"overflow-x-auto"},t.createElement("table",{className:"min-w-full divide-y divide-gray-200"},t.createElement("thead",{className:"bg-gray-50"},t.createElement("tr",null,t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Recurso"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tipo"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Categoría"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Fecha"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),t.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},e.map(N=>{var x,y;return t.createElement("tr",{key:N.id,className:"hover:bg-gray-50"},t.createElement("td",{className:"px-6 py-4"},t.createElement("div",{className:"flex items-start"},t.createElement("span",{className:"text-2xl mr-3"},A(N.tipo)),t.createElement("div",null,t.createElement("div",{className:"text-sm font-medium text-gray-900"},N.titulo),N.descripcion&&t.createElement("div",{className:"text-sm text-gray-500 mt-1"},N.descripcion.substring(0,100),"..."),N.tags&&N.tags.length>0&&t.createElement("div",{className:"flex flex-wrap gap-1 mt-2"},N.tags.slice(0,3).map((E,_)=>t.createElement("span",{key:_,className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full"},E)),N.tags.length>3&&t.createElement("span",{className:"text-xs text-gray-500"},"+",N.tags.length-3," más"))))),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("span",{className:"text-sm text-gray-900"},((x=m.find(E=>E.value===N.tipo))==null?void 0:x.label)||N.tipo)),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("span",{className:"text-sm text-gray-900"},((y=h.find(E=>E.value===N.categoria))==null?void 0:y.label)||N.categoria)),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${I(N.estado)}`},N.estado)),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},v(N.fechaCreacion)),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},t.createElement("div",{className:"flex gap-2"},t.createElement("button",{onClick:()=>w(N),className:"text-blue-600 hover:text-blue-900"},"Editar"),t.createElement("button",{onClick:()=>f(N.id),className:"text-red-600 hover:text-red-900"},"Eliminar"))))})))),e.length===0&&t.createElement("div",{className:"text-center py-12 text-gray-500"},"No hay recursos educativos creados aún")))))};function Z9({empresa:a,onLogoUpload:e,saving:n}){const[r,s]=p.useState(!1),[o,i]=p.useState(!1),[l,c]=p.useState(a.logo_url||a.logo||null),[u,d]=p.useState(a.galeria||[]),[m,h]=p.useState(!1),[C,S]=p.useState(!1),[w,f]=p.useState(""),[b,v]=p.useState(""),I=p.useRef(null),A=p.useRef(null),N=$=>{$.preventDefault(),$.stopPropagation(),$.type==="dragenter"||$.type==="dragover"?s(!0):$.type==="dragleave"&&s(!1)},x=$=>{$.preventDefault(),$.stopPropagation(),s(!1),$.dataTransfer.files&&$.dataTransfer.files[0]&&E($.dataTransfer.files[0])},y=$=>{$.preventDefault(),$.target.files&&$.target.files[0]&&E($.target.files[0])},E=async $=>{if(!$.type.includes("png")&&!$.type.includes("jpeg")&&!$.type.includes("jpg")){f("Por favor, selecciona un archivo PNG o JPG"),setTimeout(()=>f(""),5e3);return}if($.size>2*1024*1024){f("El archivo es muy grande. Máximo 2MB"),setTimeout(()=>f(""),5e3);return}try{i(!0),f(""),v("");const q=new FileReader;q.onload=z=>c(z.target.result),q.readAsDataURL($);const V=await e($);c(V),S(!0),v("✅ Logo subido y guardado correctamente"),setTimeout(()=>v(""),5e3)}catch(q){console.error("Error subiendo logo:",q),f("Error al subir el logo. Inténtalo nuevamente."),setTimeout(()=>f(""),5e3),c(a.logo_url||a.logo||null)}finally{i(!1)}},_=()=>{var $;($=I.current)==null||$.click()},P=async()=>{if(window.confirm("¿Estás seguro de que quieres eliminar el logo?"))try{i(!0),f(""),v(""),await e(null),c(null),S(!1),v("✅ Logo eliminado correctamente"),setTimeout(()=>v(""),5e3)}catch($){console.error("Error eliminando logo:",$),f("Error al eliminar el logo"),setTimeout(()=>f(""),5e3)}finally{i(!1)}},k=async $=>{try{h(!0),f("");const q=[];for(let z of $){if(!z.type.includes("image/")){f(`${z.name} no es una imagen válida`),setTimeout(()=>f(""),5e3);continue}if(z.size>5*1024*1024){f(`${z.name} es muy grande. Máximo 5MB por imagen`),setTimeout(()=>f(""),5e3);continue}const j=Fl(ci,`galeria/empresas/${a.id}/${Date.now()}-${z.name}`);await Uu(j,z);const U=await jl(j);q.push(U)}const V=[...u,...q];d(V),await e(null,"galeria",V),q.length>0&&(v(`✅ ${q.length} imagen(es) subida(s) correctamente`),setTimeout(()=>v(""),5e3))}catch(q){console.error("Error subiendo imágenes:",q),f("Error al subir las imágenes"),setTimeout(()=>f(""),5e3)}finally{h(!1)}},D=async $=>{if(window.confirm("¿Eliminar esta imagen de la galería?"))try{f("");const q=u.filter((V,z)=>z!==$);d(q),await e(null,"galeria",q),v("✅ Imagen eliminada de la galería"),setTimeout(()=>v(""),5e3)}catch(q){console.error("Error eliminando imagen:",q),f("Error al eliminar la imagen"),setTimeout(()=>f(""),5e3)}},M=async()=>{if(window.confirm("¿Generar un logo automático basado en el nombre de la empresa?"))try{i(!0),f(""),v("");const $=document.createElement("canvas");$.width=400,$.height=400;const q=$.getContext("2d"),V=q.createLinearGradient(0,0,400,400);V.addColorStop(0,"#3B82F6"),V.addColorStop(1,"#1E40AF"),q.fillStyle=V,q.fillRect(0,0,400,400);const j=(a.nombre||"Empresa").split(" ").map(U=>U.charAt(0)).join("").substring(0,3);q.fillStyle="white",q.font="bold 120px Arial",q.textAlign="center",q.textBaseline="middle",q.fillText(j,200,200),$.toBlob(async U=>{try{const Q=Fl(ci,`logos/empresas/auto-${a.id}-${Date.now()}.png`);await Uu(Q,U);const te=await jl(Q);await e({logoURL:te,esAutomatico:!0}),c(te),S(!0),v("✅ Logo automático generado y guardado correctamente"),setTimeout(()=>v(""),5e3)}catch(Q){throw console.error("Error subiendo logo automático:",Q),f("Error al generar el logo automático"),setTimeout(()=>f(""),5e3),Q}},"image/png")}catch($){console.error("Error generando logo:",$),f("Error al generar el logo automático"),setTimeout(()=>f(""),5e3)}finally{i(!1)}};return t.createElement("div",{className:"p-6 space-y-8"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Gestión de Logo y Galería"),t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",{className:"flex items-center gap-2"},t.createElement("span",{className:"text-blue-600 text-lg"},a.logo_url||a.logo?"✅":"⚠️"),t.createElement("div",null,t.createElement("p",{className:"font-medium text-blue-900"},a.logo_url||a.logo?"Logo configurado":"Logo pendiente de configuración"),t.createElement("p",{className:"text-sm text-blue-700"},a.logo_url||a.logo?"El logo está visible en el sistema y se muestra correctamente":"Selecciona o genera un logo para tu empresa"))),a.logoAsignado&&t.createElement("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium"},"✓ Asignado"))),t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("h4",{className:"text-md font-medium text-gray-700 mb-3"},"Logo de la Empresa"),t.createElement("div",{className:"border-2 border-gray-200 rounded-lg p-6 text-center bg-gray-50"},l?t.createElement("div",{className:"space-y-4"},t.createElement("img",{src:l,alt:"Logo de la empresa",className:"w-32 h-32 object-contain mx-auto bg-white border rounded-lg shadow-sm",onError:$=>{$.target.style.display="none",$.target.nextSibling.style.display="block"}}),t.createElement("div",{style:{display:"none"},className:"w-32 h-32 bg-gray-200 rounded-lg mx-auto flex items-center justify-center"},t.createElement("span",{className:"text-4xl text-gray-400"},"🖼️")),t.createElement("div",{className:"space-y-2"},t.createElement("div",{className:"flex items-center justify-center gap-2 text-green-600"},t.createElement("span",null,"✅"),t.createElement("span",{className:"font-medium"},"Logo cargado correctamente")),t.createElement("p",{className:"text-sm text-gray-600"},C?"Logo subido y guardado en la base de datos":"Logo visible en el sistema"),t.createElement("div",{className:"flex justify-center gap-2"},t.createElement("button",{onClick:P,disabled:o,className:"text-red-600 hover:text-red-800 text-sm underline disabled:opacity-50"},"Eliminar logo")))):t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"w-32 h-32 bg-gray-200 rounded-lg mx-auto flex items-center justify-center"},t.createElement("span",{className:"text-4xl text-gray-400"},"🖼️")),t.createElement("p",{className:"text-gray-500"},"No hay logo asignado"),!a.web&&t.createElement("button",{onClick:M,disabled:o,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 transition-colors text-sm"},"✨ Generar Logo Automático")))),t.createElement("div",null,t.createElement("h4",{className:"text-md font-medium text-gray-700 mb-3"},"Subir Nuevo Logo"),b&&t.createElement("div",{className:"mb-4 p-3 bg-green-100 border border-green-300 rounded-lg text-green-800 text-sm"},b),w&&t.createElement("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-800 text-sm"},"❌ ",w),t.createElement("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${r?"border-blue-500 bg-blue-50":"border-gray-300 bg-gray-50 hover:border-gray-400"}`,onDragEnter:N,onDragLeave:N,onDragOver:N,onDrop:x},t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"text-4xl"},"📁"),o?t.createElement("div",{className:"space-y-2"},t.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),t.createElement("p",{className:"text-blue-600"},"Subiendo logo...")):t.createElement(t.Fragment,null,t.createElement("div",{className:"space-y-2"},t.createElement("p",{className:"text-gray-700 font-medium"},"Arrastra y suelta un archivo aquí"),t.createElement("p",{className:"text-gray-500 text-sm"},"o haz clic para seleccionar")),t.createElement("button",{onClick:_,disabled:o||n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors"},"Seleccionar Archivo")))),t.createElement("input",{ref:I,type:"file",className:"hidden",accept:".png,.jpg,.jpeg",onChange:y}),l&&!o&&t.createElement("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",{className:"flex items-center gap-2"},t.createElement("span",{className:"text-green-600 text-lg"},"✅"),t.createElement("span",{className:"text-green-800 font-medium"},"Logo listo para guardar")),t.createElement("button",{onClick:()=>{v("✅ Logo guardado correctamente en la base de datos"),setTimeout(()=>v(""),5e3)},disabled:n,className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors font-medium shadow-lg"},n?"Guardando...":"💾 Guardar Logo")),t.createElement("p",{className:"text-green-700 text-sm mt-2"},"El logo se guarda automáticamente al seleccionarlo. Este botón confirma que se ha guardado en la base de datos.")),t.createElement("div",{className:"mt-4 text-sm text-gray-600 space-y-1"},t.createElement("p",null,"• Formatos permitidos: PNG, JPG, JPEG"),t.createElement("p",null,"• Tamaño máximo: 2MB"),t.createElement("p",null,"• Recomendado: Logo cuadrado (500x500px) con fondo transparente")))),t.createElement("div",{className:"border-t border-gray-200 pt-8"},t.createElement("div",{className:"flex items-center justify-between mb-4"},t.createElement("div",null,t.createElement("h4",{className:"text-md font-medium text-gray-700"},"Galería de Fotos del Local"),t.createElement("p",{className:"text-sm text-gray-500 mt-1"},"Sube fotos del local, productos o servicios para el perfil web")),t.createElement("button",{onClick:()=>{var $;return($=A.current)==null?void 0:$.click()},disabled:m,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors"},m?"Subiendo...":"📷 Agregar Fotos")),t.createElement("input",{ref:A,type:"file",className:"hidden",accept:"image/*",multiple:!0,onChange:$=>$.target.files.length>0&&k(Array.from($.target.files))}),u.length>0?t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},u.map(($,q)=>t.createElement("div",{key:q,className:"relative group"},t.createElement("img",{src:$,alt:`Foto ${q+1}`,className:"w-full h-32 object-cover rounded-lg border"}),t.createElement("button",{onClick:()=>D(q),className:"absolute top-2 right-2 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-xs"},"✕")))):t.createElement("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center"},t.createElement("div",{className:"text-4xl text-gray-400 mb-2"},"📸"),t.createElement("p",{className:"text-gray-500"},"No hay fotos en la galería"),t.createElement("p",{className:"text-gray-400 text-sm mt-1"},"Las fotos ayudan a los clientes a conocer mejor tu local")),t.createElement("div",{className:"mt-4 text-sm text-gray-600"},t.createElement("p",null,"• Máximo 5MB por imagen • Formatos: JPG, PNG • Recomendado: fotos del local, productos, equipo"))),t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},t.createElement("h5",{className:"font-medium text-blue-900 mb-2"},"💡 Consejos para un buen logo:"),t.createElement("ul",{className:"text-sm text-blue-800 space-y-1"},t.createElement("li",null,"• Usa un fondo transparente (PNG) para mejor integración"),t.createElement("li",null,"• Asegúrate de que sea legible en tamaños pequeños"),t.createElement("li",null,"• Mantén un diseño simple y reconocible"),t.createElement("li",null,"• Usa colores que representen tu marca"))),!a.web&&t.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},t.createElement("h5",{className:"font-medium text-green-900 mb-2"},"🌐 Perfil Web para PYME:"),t.createElement("ul",{className:"text-sm text-green-800 space-y-1"},t.createElement("li",null,"• Tu empresa tendrá un perfil web completo"),t.createElement("li",null,"• Los clientes podrán ver fotos y información"),t.createElement("li",null,"• Incluye horarios, servicios y contacto"),t.createElement("li",null,"• Perfecto para emprendimientos sin sitio web")),a.logoAsignado&&u.length>0&&t.createElement("div",{className:"mt-2 flex items-center gap-2 text-green-700"},t.createElement("span",null,"✓"),t.createElement("span",{className:"text-sm font-medium"},"Perfil listo para publicar")))),a.logoAsignado&&t.createElement("div",{className:"mt-4"},t.createElement("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm"},t.createElement("span",null,"✓"),"Logo asignado correctamente")))}function X9({empresa:a,onUpdate:e}){var A;const[n,r]=p.useState({descripcionCompleta:a.descripcionCompleta||"",servicios:a.servicios&&a.servicios.length>0?a.servicios:a.servicios_completos&&a.servicios_completos.length>0?a.servicios_completos:a.categorias_servicios&&a.categorias_servicios.length>0?a.categorias_servicios:(A=a.datos_solicitud)!=null&&A.servicios&&a.datos_solicitud.servicios.length>0?a.datos_solicitud.servicios:[],galeria:a.galeria||[],contactoAdicional:a.contactoAdicional||{whatsapp:"",facebook:"",instagram:"",direccionCompleta:""},caracteristicas:a.caracteristicas||[],testimonios:a.testimonios||[]}),[s,o]=p.useState(""),[i,l]=p.useState(""),[c,u]=p.useState({cliente:"",comentario:"",rating:5}),[d,m]=p.useState(!1),h=()=>{if(s.trim()){const N=[...n.servicios,s.trim()];r(x=>({...x,servicios:N})),o("")}},C=N=>{const x=n.servicios.filter((y,E)=>E!==N);r(y=>({...y,servicios:x}))},S=()=>{if(i.trim()){const N=[...n.caracteristicas,i.trim()];r(x=>({...x,caracteristicas:N})),l("")}},w=N=>{const x=n.caracteristicas.filter((y,E)=>E!==N);r(y=>({...y,caracteristicas:x}))},f=()=>{if(c.cliente.trim()&&c.comentario.trim()){const N=[...n.testimonios,{...c}];r(x=>({...x,testimonios:N})),u({cliente:"",comentario:"",rating:5})}},b=N=>{const x=n.testimonios.filter((y,E)=>E!==N);r(y=>({...y,testimonios:x}))},v=()=>{Object.keys(n).forEach(N=>{e(N,n[N])}),alert("Perfil web actualizado correctamente")},I=()=>{if(!a.horarios)return"Horarios no definidos";const N=Object.entries(a.horarios).filter(([x,y])=>y.activo).map(([x,y])=>`${x.charAt(0).toUpperCase()+x.slice(1)}: ${y.inicio} - ${y.fin}`);return N.length>0?N.join(", "):"Cerrado todos los días"};return d?t.createElement("div",{className:"p-6"},t.createElement("div",{className:"flex items-center justify-between mb-6"},t.createElement("h3",{className:"text-lg font-semibold"},"Vista Previa del Perfil Web"),t.createElement("button",{onClick:()=>m(!1),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200"},"← Volver a Editar")),t.createElement("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden shadow-lg max-w-4xl mx-auto"},t.createElement("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6"},t.createElement("div",{className:"flex items-center gap-6"},(a.logo_url||a.logo)&&t.createElement("img",{src:a.logo_url||a.logo,alt:a.nombre,className:"w-20 h-20 bg-white rounded-lg p-2 object-contain",onError:N=>{N.target.style.display="none"}}),t.createElement("div",null,t.createElement("h1",{className:"text-3xl font-bold"},a.nombre),t.createElement("p",{className:"text-blue-100 mt-1"},a.categoria),t.createElement("div",{className:"flex items-center gap-4 mt-2 text-sm"},a.telefono&&t.createElement("span",null,"📞 ",a.telefono),a.email&&t.createElement("span",null,"📧 ",a.email))))),t.createElement("div",{className:"p-6 space-y-8"},n.descripcionCompleta&&t.createElement("section",null,t.createElement("h2",{className:"text-xl font-semibold mb-3"},"Acerca de Nosotros"),t.createElement("p",{className:"text-gray-700 leading-relaxed"},n.descripcionCompleta)),n.servicios.length>0&&t.createElement("section",null,t.createElement("h2",{className:"text-xl font-semibold mb-3"},"Nuestros Servicios"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},n.servicios.map((N,x)=>t.createElement("div",{key:x,className:"flex items-center gap-2 p-3 bg-blue-50 rounded-lg"},t.createElement("span",{className:"text-blue-600"},"✓"),t.createElement("span",null,N))))),n.caracteristicas.length>0&&t.createElement("section",null,t.createElement("h2",{className:"text-xl font-semibold mb-3"},"¿Por qué Elegirnos?"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},n.caracteristicas.map((N,x)=>t.createElement("div",{key:x,className:"flex items-center gap-2 p-3 border border-gray-200 rounded-lg"},t.createElement("span",{className:"text-green-600"},"⭐"),t.createElement("span",null,N))))),t.createElement("section",null,t.createElement("h2",{className:"text-xl font-semibold mb-3"},"Horarios de Atención"),t.createElement("div",{className:"bg-gray-50 p-4 rounded-lg"},t.createElement("p",{className:"text-gray-700"},I()))),n.testimonios.length>0&&t.createElement("section",null,t.createElement("h2",{className:"text-xl font-semibold mb-3"},"Lo que Dicen Nuestros Clientes"),t.createElement("div",{className:"space-y-4"},n.testimonios.map((N,x)=>t.createElement("div",{key:x,className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded"},t.createElement("div",{className:"flex items-center gap-1 mb-2"},[...Array(5)].map((y,E)=>t.createElement("span",{key:E,className:`text-lg ${E<N.rating?"text-yellow-500":"text-gray-300"}`},"⭐"))),t.createElement("p",{className:"text-gray-700 italic"},'"',N.comentario,'"'),t.createElement("p",{className:"text-gray-600 text-sm mt-2"},"- ",N.cliente))))),t.createElement("section",null,t.createElement("h2",{className:"text-xl font-semibold mb-3"},"Contacto"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",{className:"space-y-3"},a.direccion&&t.createElement("div",{className:"flex items-center gap-2"},t.createElement("span",null,"📍"),t.createElement("span",null,a.direccion)),n.contactoAdicional.whatsapp&&t.createElement("div",{className:"flex items-center gap-2"},t.createElement("span",null,"📱"),t.createElement("span",null,"WhatsApp: ",n.contactoAdicional.whatsapp))),t.createElement("div",{className:"space-y-3"},n.contactoAdicional.facebook&&t.createElement("div",{className:"flex items-center gap-2"},t.createElement("span",null,"📘"),t.createElement("span",null,"Facebook: ",n.contactoAdicional.facebook)),n.contactoAdicional.instagram&&t.createElement("div",{className:"flex items-center gap-2"},t.createElement("span",null,"📷"),t.createElement("span",null,"Instagram: ",n.contactoAdicional.instagram)))))))):t.createElement("div",{className:"p-6"},t.createElement("div",{className:"flex items-center justify-between mb-6"},t.createElement("div",null,t.createElement("h3",{className:"text-lg font-semibold"},"Perfil Web de la Empresa"),t.createElement("p",{className:"text-gray-600 text-sm mt-1"},a.web?"Información adicional para complementar el sitio web existente":"Crea un perfil web completo para empresas sin sitio web propio")),t.createElement("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200"},"👁️ Vista Previa")),t.createElement("div",{className:"space-y-8"},t.createElement("section",null,t.createElement("h4",{className:"font-medium text-gray-900 mb-3"},"Descripción Completa"),t.createElement("textarea",{value:n.descripcionCompleta,onChange:N=>r(x=>({...x,descripcionCompleta:N.target.value})),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe detalladamente la empresa, su historia, misión, especialidades..."})),t.createElement("section",null,t.createElement("h4",{className:"font-medium text-gray-900 mb-3"},"Servicios Ofrecidos"),t.createElement("div",{className:"space-y-3"},t.createElement("div",{className:"flex gap-2"},t.createElement("input",{type:"text",value:s,onChange:N=>o(N.target.value),onKeyPress:N=>N.key==="Enter"&&h(),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Reparación de frenos, Venta de repuestos..."}),t.createElement("button",{onClick:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},"Agregar")),t.createElement("div",{className:"space-y-2"},n.servicios.map((N,x)=>t.createElement("div",{key:x,className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg"},t.createElement("span",null,N),t.createElement("button",{onClick:()=>C(x),className:"text-red-600 hover:text-red-800"},"✕")))))),t.createElement("section",null,t.createElement("h4",{className:"font-medium text-gray-900 mb-3"},"Características Distintivas"),t.createElement("div",{className:"space-y-3"},t.createElement("div",{className:"flex gap-2"},t.createElement("input",{type:"text",value:i,onChange:N=>l(N.target.value),onKeyPress:N=>N.key==="Enter"&&S(),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: 20 años de experiencia, Garantía extendida..."}),t.createElement("button",{onClick:S,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"},"Agregar")),t.createElement("div",{className:"space-y-2"},n.caracteristicas.map((N,x)=>t.createElement("div",{key:x,className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg"},t.createElement("span",null,N),t.createElement("button",{onClick:()=>w(x),className:"text-red-600 hover:text-red-800"},"✕")))))),t.createElement("section",null,t.createElement("h4",{className:"font-medium text-gray-900 mb-3"},"Información de Contacto Adicional"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"WhatsApp"),t.createElement("input",{type:"text",value:n.contactoAdicional.whatsapp,onChange:N=>r(x=>({...x,contactoAdicional:{...x.contactoAdicional,whatsapp:N.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"+56 9 1234 5678"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Facebook"),t.createElement("input",{type:"text",value:n.contactoAdicional.facebook,onChange:N=>r(x=>({...x,contactoAdicional:{...x.contactoAdicional,facebook:N.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"@empresapage"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Instagram"),t.createElement("input",{type:"text",value:n.contactoAdicional.instagram,onChange:N=>r(x=>({...x,contactoAdicional:{...x.contactoAdicional,instagram:N.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"@empresa"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Dirección Completa"),t.createElement("input",{type:"text",value:n.contactoAdicional.direccionCompleta,onChange:N=>r(x=>({...x,contactoAdicional:{...x.contactoAdicional,direccionCompleta:N.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Calle, número, comuna, región"})))),t.createElement("section",null,t.createElement("h4",{className:"font-medium text-gray-900 mb-3"},"Testimonios de Clientes"),t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"border border-gray-200 rounded-lg p-4"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3"},t.createElement("input",{type:"text",value:c.cliente,onChange:N=>u(x=>({...x,cliente:N.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre del cliente"}),t.createElement("select",{value:c.rating,onChange:N=>u(x=>({...x,rating:parseInt(N.target.value)})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:5},"5 estrellas"),t.createElement("option",{value:4},"4 estrellas"),t.createElement("option",{value:3},"3 estrellas"),t.createElement("option",{value:2},"2 estrellas"),t.createElement("option",{value:1},"1 estrella")),t.createElement("button",{onClick:f,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700"},"Agregar")),t.createElement("textarea",{value:c.comentario,onChange:N=>u(x=>({...x,comentario:N.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Comentario del cliente..."})),t.createElement("div",{className:"space-y-3"},n.testimonios.map((N,x)=>t.createElement("div",{key:x,className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},t.createElement("div",{className:"flex items-center justify-between mb-2"},t.createElement("div",{className:"flex items-center gap-2"},t.createElement("span",{className:"font-medium"},N.cliente),t.createElement("div",{className:"flex"},[...Array(5)].map((y,E)=>t.createElement("span",{key:E,className:`${E<N.rating?"text-yellow-500":"text-gray-300"}`},"⭐")))),t.createElement("button",{onClick:()=>b(x),className:"text-red-600 hover:text-red-800"},"✕")),t.createElement("p",{className:"text-gray-700"},'"',N.comentario,'"')))))),t.createElement("div",{className:"flex justify-end pt-6 border-t border-gray-200"},t.createElement("button",{onClick:v,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},"Guardar Perfil Web"))))}function e$(){var ye,Y,Se;const[a,e]=p.useState([]);p.useEffect(()=>{(async()=>{try{const oe=await le(W(F,"agentes"));e(oe.docs.map(ge=>({id:ge.id,...ge.data()})))}catch(oe){console.error("Error cargando agentes:",oe)}})()},[]);const{empresaId:n}=Ni(),r=Ct(),[s,o]=p.useState(null),[i,l]=p.useState(!0),[c,u]=p.useState(!1),[d,m]=p.useState(!1),[h,C]=p.useState(!1),[S,w]=p.useState(!1),[f,b]=p.useState("general"),[v,I]=p.useState(""),[A,N]=p.useState(!1),[x,y]=p.useState({email:"",password:"",confirmPassword:""}),[E,_]=p.useState(null);p.useEffect(()=>{P()},[n]);const P=async()=>{try{const de=Ne(F,"empresas",n),oe=await en(de);if(oe.exists()){const ge=oe.data();console.log("📊 Datos de empresa cargados:",ge),console.log("🕐 Horario de atención:",ge.horario_atencion),console.log("🕐 Horarios:",ge.horarios),o({id:oe.id,...ge}),u(!!ge.credencialesGeneradas),m(ge.estado==="pendiente_validación"),ge.credencialesGeneradas&&ge.usuario_empresa&&_(ge.usuario_empresa)}else I("Empresa no encontrada")}catch(de){console.error("Error cargando empresa:",de),I("Error al cargar la empresa")}finally{l(!1)}},k=async(de,oe)=>{try{if(w(!0),de==="multiple"&&typeof oe=="object"){const ge={...oe,fecha_actualizacion:new Date};oe.estado==="validada"&&(ge.credencialesGeneradas=!1),await ze(Ne(F,"empresas",n),ge),o(me=>({...me,...oe})),console.log("✅ Cambios múltiples guardados exitosamente")}else{const ge={[de]:oe,fecha_actualizacion:new Date};de==="estado"&&oe==="validada"&&(ge.credencialesGeneradas=!1),await ze(Ne(F,"empresas",n),ge),o(me=>({...me,[de]:oe})),console.log(`✅ Campo '${de}' actualizado exitosamente`)}setTimeout(()=>w(!1),1e3)}catch(ge){console.error("Error actualizando empresa:",ge),I("Error al actualizar la empresa"),w(!1)}},D=async(de,oe="logo",ge=null)=>{try{if(w(!0),oe==="galeria"){await ze(Ne(F,"empresas",n),{galeria:ge,fecha_actualizacion:new Date}),o(me=>({...me,galeria:ge})),w(!1);return}if(de===null){await ze(Ne(F,"empresas",n),{logo:null,logo_url:null,fecha_actualizacion:new Date}),o(me=>({...me,logo:null,logo_url:null})),w(!1);return}if(typeof de=="object"&&de.logoURL){await ze(Ne(F,"empresas",n),{logo:de.logoURL,logo_url:de.logoURL,logoAsignado:!0,fecha_actualizacion:new Date}),o(me=>({...me,logo:de.logoURL,logo_url:de.logoURL,logoAsignado:!0})),w(!1);return}if(de instanceof File){const me=Date.now(),he=`logo-${n}-${me}.${de.name.split(".").pop()}`,G=Fl(ci,`logos/empresas/${he}`),we=await Uu(G,de),Te=`gs://${ci.app.options.storageBucket}/${we.ref.fullPath}`,B=await jl(we.ref);return await ze(Ne(F,"empresas",n),{logo:Te,logo_url:B,logoAsignado:!0,fecha_actualizacion:new Date}),o(ve=>({...ve,logo:Te,logo_url:B,logoAsignado:!0})),console.log("✅ Logo subido exitosamente:",{gsUrl:Te,downloadURL:B}),w(!1),B}}catch(me){throw console.error("Error subiendo logo:",me),I("Error al subir el logo"),me}finally{w(!1)}},M=async()=>{var oe;const de=s.email||((oe=s.representante)==null?void 0:oe.email)||"";y({email:de,password:"",confirmPassword:""}),N(!0)},$=()=>{const de="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let oe="";for(let ge=0;ge<12;ge++)oe+=de.charAt(Math.floor(Math.random()*de.length));y(ge=>({...ge,password:oe,confirmPassword:oe}))},q=async()=>{if(!x.email||!x.password){alert("Debes completar email y contraseña");return}if(x.password!==x.confirmPassword){alert("Las contraseñas no coinciden");return}if(x.password.length<6){alert("La contraseña debe tener al menos 6 caracteres");return}C(!0);try{const oe=(await es(Pt,x.email,x.password)).user.uid;await Ar(Ne(F,"usuarios",oe),{uid:oe,email:x.email,nombre:s.nombre,rol:"proveedor",empresaId:n,activo:!0,fechaCreacion:new Date,creadoPorAdmin:!0,empresa:{nombre:s.nombre,id:n,estado:s.estado}}),await ze(Ne(F,"empresas",n),{credencialesGeneradas:!0,fecha_credenciales:new Date,usuario_empresa:{email:x.email,uid:oe,fecha_asignacion:new Date,admin_asignador:"admin"},uid_auth:oe}),u(!0),_({email:x.email,uid:oe,fecha_asignacion:new Date,admin_asignador:"admin"}),N(!1),y({email:"",password:"",confirmPassword:""}),alert(`✅ Credenciales creadas exitosamente!

📧 Email: ${x.email}
🔑 Contraseña: ${x.password}

📋 IMPORTANTE:
• Envía estas credenciales a la empresa
• La empresa puede hacer login inmediatamente
• Accederá a su panel de empresa`)}catch(de){console.error("Error creando credenciales:",de),de.code==="auth/email-already-in-use"?alert("❌ Error: El email ya está en uso por otro usuario. Usa un email diferente."):alert(`❌ Error creando credenciales: ${de.message}`)}finally{C(!1)}};if(v)return t.createElement("div",{className:"p-6"},t.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4"},t.createElement("p",{className:"text-red-800"},v),t.createElement("button",{onClick:()=>r("/admin/empresas"),className:"mt-2 text-red-600 underline"},"Volver al listado")));if(!s)return null;const V=s.estado==="pendiente",z=s.estado==="activa",j=s.estado==="pendiente_validación",U=s.estado==="validada"&&!c,Q=async()=>{await k("estado","activa")},te=async()=>{await k("estado","pendiente_validación"),m(!0)},se=async()=>{await k("estado","validada")},X=[{id:"general",label:"Información General",icon:"📋"},{id:"representante",label:"Representante",icon:"👤"},{id:"servicios",label:"Servicios y Marcas",icon:"🛠️"},{id:"logo",label:"Logo",icon:"🖼️"},{id:"horarios",label:"Horarios",icon:"🕒"},{id:"agente",label:"Agente",icon:"🧑‍💼"},{id:"revision",label:"Revisión Admin",icon:"🔍"},{id:"metadata",label:"Metadata",icon:"⚙️"},{id:"perfil",label:"Perfil Web",icon:"🌐"}];return t.createElement("div",{className:"p-6 max-w-6xl mx-auto"},t.createElement("div",{className:"mb-6"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Editar Empresa: ",s.nombre),t.createElement("p",{className:"text-gray-600 mt-1"},"Gestiona la información, logo, horarios y perfil web de la empresa"),t.createElement("div",{className:"mt-4 flex flex-col gap-2"},t.createElement("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${s.estado==="pendiente"?"bg-yellow-100 text-yellow-800":s.estado==="activa"?"bg-green-100 text-green-800":s.estado==="pendiente_validación"?"bg-blue-100 text-blue-800":s.estado==="validada"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`},"Estado: ",s.estado||"Sin estado"),V&&t.createElement("button",{onClick:Q,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 mt-2"},"Activar empresa (visible en home)"),z&&!d&&t.createElement("button",{onClick:te,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 mt-2"},"Solicitar perfil/acceso"),j&&t.createElement("button",{onClick:se,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 mt-2"},"Validar empresa (por agente)"),U&&t.createElement("button",{onClick:M,disabled:h,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 mt-2"},h?"Generando credenciales...":"🔑 Crear credenciales de login"),c&&E&&t.createElement("div",{className:"mt-2 p-3 bg-indigo-50 border border-indigo-200 rounded-lg"},t.createElement("div",{className:"flex items-center gap-2 text-indigo-800 mb-2"},t.createElement("span",{className:"text-lg"},"✅"),t.createElement("span",{className:"font-semibold"},"Credenciales creadas")),t.createElement("div",{className:"text-sm text-indigo-700"},t.createElement("p",null,t.createElement("strong",null,"Email:")," ",E.email),t.createElement("p",null,t.createElement("strong",null,"Fecha:")," ",((Se=(Y=(ye=E.fecha_asignacion)==null?void 0:ye.toDate)==null?void 0:Y.call(ye))==null?void 0:Se.toLocaleDateString())||"N/A"),t.createElement("p",null,t.createElement("strong",null,"UID:")," ",E.uid)),t.createElement("button",{onClick:()=>N(!0),className:"mt-2 text-xs bg-indigo-100 text-indigo-700 px-2 py-1 rounded hover:bg-indigo-200"},"🔄 Cambiar credenciales")))),t.createElement("div",{className:"flex items-center gap-3"},S&&t.createElement("div",{className:"flex items-center gap-2 text-green-600"},t.createElement("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600"}),t.createElement("span",{className:"text-sm"},"Guardando...")),t.createElement("button",{onClick:()=>r("/admin/empresas"),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors"},"← Volver"))),t.createElement("div",{className:"mt-4 flex items-center gap-4"},s.web?t.createElement("a",{href:s.web.startsWith("http")?s.web:`https://${s.web}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm underline"},"🔗 Ver sitio web"):t.createElement("a",{href:`/perfil-empresa/${n}`,target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:text-green-800 text-sm underline"},"🌐 Ver Perfil Público"),s.web?t.createElement("a",{href:s.web.startsWith("http")?s.web:`https://${s.web}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm underline"},"🔗 Ver sitio web"):t.createElement("a",{href:`/perfil-empresa/${n}`,target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:text-green-800 text-sm underline"},"🌐 Ver Perfil Público"))),t.createElement("div",{className:"mb-6"},t.createElement("div",{className:"border-b border-gray-200"},t.createElement("nav",{className:"-mb-px flex space-x-8"},X.map(de=>t.createElement("button",{key:de.id,onClick:()=>b(de.id),className:`py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${f===de.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`},t.createElement("span",{className:"mr-2"},de.icon),de.label))))),t.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},f==="general"&&t.createElement(a$,{empresa:s,onUpdate:k,saving:S}),f==="representante"&&t.createElement(n$,{empresa:s,onUpdate:k,saving:S}),f==="servicios"&&t.createElement(r$,{empresa:s,onUpdate:k,saving:S}),f==="logo"&&t.createElement(Z9,{empresa:s,onLogoUpload:D,saving:S}),f==="horarios"&&t.createElement(i$,{empresa:s,onUpdate:k,saving:S}),f==="agente"&&t.createElement(t$,{empresa:s,agentes:a,onUpdate:k,saving:S}),f==="revision"&&t.createElement(s$,{empresa:s,onUpdate:k,saving:S}),f==="metadata"&&t.createElement(o$,{empresa:s,onUpdate:k,saving:S}),f==="perfil"&&t.createElement(X9,{empresa:s,onUpdate:k})),A&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-8 max-w-md w-full mx-4"},t.createElement("div",{className:"flex justify-between items-center mb-6"},t.createElement("h2",{className:"text-xl font-bold text-gray-800"},"🔑 Crear Credenciales de Login"),t.createElement("button",{onClick:()=>N(!1),className:"text-gray-500 hover:text-gray-700 text-2xl font-bold"},"×")),t.createElement("div",{className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email de acceso *"),t.createElement("input",{type:"email",value:x.email,onChange:de=>y(oe=>({...oe,email:de.target.value})),placeholder:"email@empresa.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),t.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Recomendado: usar el email del representante legal")),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña *"),t.createElement("div",{className:"flex space-x-2"},t.createElement("input",{type:"text",value:x.password,onChange:de=>y(oe=>({...oe,password:de.target.value})),placeholder:"Contraseña",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"}),t.createElement("button",{type:"button",onClick:$,className:"px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-sm"},"🎲 Generar")),t.createElement("p",{className:"text-xs text-gray-500 mt-1"},'Mínimo 6 caracteres. Usa el botón "Generar" para crear una contraseña segura.')),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirmar contraseña *"),t.createElement("input",{type:"text",value:x.confirmPassword,onChange:de=>y(oe=>({...oe,confirmPassword:de.target.value})),placeholder:"Repite la contraseña",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"})),t.createElement("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg"},t.createElement("div",{className:"flex items-start gap-2"},t.createElement("span",{className:"text-blue-600 text-lg"},"ℹ️"),t.createElement("div",{className:"text-sm text-blue-800"},t.createElement("p",{className:"font-semibold mb-1"},"Importante:"),t.createElement("ul",{className:"list-disc list-inside space-y-1"},t.createElement("li",null,"Se creará un usuario real en el sistema"),t.createElement("li",null,"La empresa podrá hacer login inmediatamente"),t.createElement("li",null,"Accederá a su panel de empresa"),t.createElement("li",null,"Guarda estas credenciales de forma segura")))))),t.createElement("div",{className:"flex justify-end space-x-3 mt-6 pt-4 border-t"},t.createElement("button",{type:"button",onClick:()=>N(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"},"Cancelar"),t.createElement("button",{onClick:q,disabled:h,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50"},h?"⏳ Creando...":"✅ Crear Credenciales")))))}function t$({empresa:a,agentes:e,onUpdate:n,saving:r}){return t.createElement("div",{className:"p-6"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Asignar Agente"),t.createElement("select",{value:a.agenteAsignado||"",onChange:s=>n("agenteAsignado",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",disabled:r},t.createElement("option",{value:""},"Sin agente asignado"),e.map(s=>t.createElement("option",{key:s.id,value:s.id},s.nombre))))}function a$({empresa:a,onUpdate:e,saving:n}){const[r,s]=p.useState({nombre:a.nombre||"",email:a.email||"",telefono:a.telefono||"",direccion:a.direccion||"",web:a.web||"",categoria:a.categoria||"",descripcion:a.descripcion||"",estado:a.estado||"inactiva",tipoEmpresa:a.tipoEmpresa||"proveedor"}),[o,i]=p.useState(""),l=u=>{const{name:d,value:m}=u.target;s(h=>({...h,[d]:m}))};p.useEffect(()=>{s({nombre:a.nombre||"",email:a.email||"",telefono:a.telefono||"",direccion:a.direccion||"",web:a.web||"",categoria:a.categoria||"",descripcion:a.descripcion||"",estado:a.estado||"inactiva",tipoEmpresa:a.tipoEmpresa||"proveedor"})},[a]);const c=async()=>{try{const u={};if(Object.keys(r).forEach(d=>{r[d]!==a[d]&&(u[d]=r[d])}),Object.keys(u).length===0){console.log("No hay cambios para guardar");return}console.log("Guardando cambios:",u),await e("multiple",u),i("✅ Cambios guardados exitosamente"),setTimeout(()=>i(""),3e3)}catch(u){console.error("Error al guardar cambios:",u),i("❌ Error al guardar los cambios"),setTimeout(()=>i(""),3e3)}};return t.createElement("div",{className:"p-6"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Información General"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombre de la empresa *"),t.createElement("input",{type:"text",name:"nombre",value:r.nombre,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email"),t.createElement("input",{type:"email",name:"email",value:r.email,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"email@empresa.com"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono"),t.createElement("input",{type:"tel",name:"telefono",value:r.telefono,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Sitio web"),t.createElement("input",{type:"url",name:"web",value:r.web,onChange:l,placeholder:"https://ejemplo.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Categoría"),t.createElement("select",{name:"categoria",value:r.categoria,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:""},"Seleccionar categoría"),t.createElement("option",{value:"Repuestos"},"Repuestos"),t.createElement("option",{value:"Servicios"},"Servicios"),t.createElement("option",{value:"Talleres"},"Talleres"),t.createElement("option",{value:"Seguros"},"Seguros"),t.createElement("option",{value:"Venta de Vehículos"},"Venta de Vehículos"),t.createElement("option",{value:"Otros"},"Otros"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Estado"),t.createElement("select",{name:"estado",value:r.estado,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"activa"},"Activa"),t.createElement("option",{value:"inactiva"},"Inactiva"),t.createElement("option",{value:"en_revision"},"En Revisión"),t.createElement("option",{value:"suspendida"},"Suspendida"))),t.createElement("div",{className:"md:col-span-2"},t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Horario de Atención Actual"),t.createElement("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-lg"},a.horario_atencion?t.createElement("p",{className:"text-gray-800 font-medium"},a.horario_atencion):t.createElement("p",{className:"text-gray-500 italic"},"No hay horarios configurados"),t.createElement("p",{className:"text-xs text-gray-500 mt-1"},'Para modificar horarios, ve a la pestaña "Horarios"'))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tipo de Empresa"),t.createElement("select",{name:"tipoEmpresa",value:r.tipoEmpresa,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"proveedor"},"Proveedor"),t.createElement("option",{value:"pyme"},"PyME"),t.createElement("option",{value:"empresa"},"Empresa"),t.createElement("option",{value:"emprendimiento"},"Emprendimiento"),t.createElement("option",{value:"local"},"Local"),t.createElement("option",{value:"premium"},"Premium")))),t.createElement("div",{className:"mt-6"},t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Dirección"),t.createElement("input",{type:"text",name:"direccion",value:r.direccion,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",{className:"mt-6"},t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Descripción"),t.createElement("textarea",{name:"descripcion",value:r.descripcion,onChange:l,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Descripción de la empresa y sus servicios..."})),o&&t.createElement("div",{className:`mt-4 p-3 rounded-lg text-sm ${o.includes("✅")?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"}`},o),t.createElement("div",{className:"mt-6 flex justify-end"},t.createElement("button",{onClick:c,disabled:n,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors"},n?"Guardando...":"Guardar Cambios")))}function n$({empresa:a,onUpdate:e,saving:n}){const r=a.representante||{},[s,o]=p.useState({nombre:r.nombre||"",apellidos:r.apellidos||"",email:r.email||"",telefono:r.telefono||"",cargo:r.cargo||"",cedula:r.cedula||""}),i=c=>{const{name:u,value:d}=c.target;o(m=>({...m,[u]:d}))},l=()=>{e("representante",s)};return t.createElement("div",{className:"p-6"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Información del Representante"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombres *"),t.createElement("input",{type:"text",name:"nombre",value:s.nombre,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Apellidos *"),t.createElement("input",{type:"text",name:"apellidos",value:s.apellidos,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email *"),t.createElement("input",{type:"email",name:"email",value:s.email,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono *"),t.createElement("input",{type:"tel",name:"telefono",value:s.telefono,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Cargo"),t.createElement("input",{type:"text",name:"cargo",value:s.cargo,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Cédula"),t.createElement("input",{type:"text",name:"cedula",value:s.cedula,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}))),t.createElement("div",{className:"mt-6 flex justify-end"},t.createElement("button",{onClick:l,disabled:n,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors"},n?"Guardando...":"Guardar Representante")))}function r$({empresa:a,onUpdate:e,saving:n}){const[r,s]=p.useState(a.servicios||[]),[o,i]=p.useState(a.marcas||[]),[l,c]=p.useState(a.categorias||[]),[u,d]=p.useState(""),[m,h]=p.useState(""),[C,S]=p.useState(""),[w,f]=p.useState("servicios"),b=["Reparación de Motor","Cambio de Aceite","Alineación","Balanceado","Frenos","Suspensión","Sistema Eléctrico","Air Bag","Transmisión","Radiador","Batería","Llantas","Pintura","Soldadura","Tapicería","Vidrios","Cerrajería","Grúa","Lavado","Encerado","Detallado"],v=["Toyota","Chevrolet","Ford","Nissan","Hyundai","Kia","Mazda","Honda","Volkswagen","Renault","Peugeot","Citroën","Fiat","BMW","Mercedes-Benz","Audi","Volvo","Jeep","Mitsubishi","Subaru"],I=["Auto","Camioneta","Camión","Bus","Moto","Pickup","SUV","Van","Camión de Carga","Tractor","Maquinaria Pesada","Bicicleta"],A=(k=null)=>{const D=k||u.trim();if(D&&!r.includes(D)){const M=[...r,D];s(M),d(""),e("servicios",M)}},N=(k=null)=>{const D=k||m.trim();if(D&&!o.includes(D)){const M=[...o,D];i(M),h(""),e("marcas",M)}},x=(k=null)=>{const D=k||C.trim();if(D&&!l.includes(D)){const M=[...l,D];c(M),S(""),e("categorias",M)}},y=k=>{const D=r.filter((M,$)=>$!==k);s(D),e("servicios",D)},E=k=>{const D=o.filter((M,$)=>$!==k);i(D),e("marcas",D)},_=k=>{const D=l.filter((M,$)=>$!==k);c(D),e("categorias",D)},P=(k,D)=>{k.key==="Enter"&&(k.preventDefault(),D==="servicio"?A():D==="marca"?N():D==="categoria"&&x())};return t.createElement("div",{className:"p-6"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Servicios, Marcas y Categorías"),t.createElement("div",{className:"mb-6"},t.createElement("div",{className:"flex border-b border-gray-200"},t.createElement("button",{onClick:()=>f("servicios"),className:`px-4 py-2 font-medium ${w==="servicios"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`},"🛠️ Servicios (",r.length,")"),t.createElement("button",{onClick:()=>f("marcas"),className:`px-4 py-2 font-medium ${w==="marcas"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`},"🚗 Marcas (",o.length,")"),t.createElement("button",{onClick:()=>f("categorias"),className:`px-4 py-2 font-medium ${w==="categorias"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`},"🚙 Categorías (",l.length,")"))),w==="servicios"&&t.createElement("div",null,t.createElement("div",{className:"mb-6"},t.createElement("h4",{className:"text-md font-semibold mb-3"},"Servicios Comunes"),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2"},b.filter(k=>!r.includes(k)).map((k,D)=>t.createElement("button",{key:D,onClick:()=>A(k),className:"px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-blue-100 hover:text-blue-700 transition-colors text-left"},"+ ",k)))),t.createElement("div",{className:"mb-6"},t.createElement("h4",{className:"text-md font-semibold mb-3"},"Agregar Servicio Personalizado"),t.createElement("div",{className:"flex gap-2"},t.createElement("input",{type:"text",value:u,onChange:k=>d(k.target.value),onKeyPress:k=>P(k,"servicio"),placeholder:"Nombre del servicio personalizado...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.createElement("button",{onClick:()=>A(),disabled:!u.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors"},"Agregar"))),t.createElement("div",null,t.createElement("h4",{className:"text-md font-semibold mb-3"},"Servicios Seleccionados"),r.length===0?t.createElement("p",{className:"text-gray-500 text-center py-6 bg-gray-50 rounded-lg"},"No hay servicios seleccionados"):t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2"},r.map((k,D)=>t.createElement("div",{key:D,className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg"},t.createElement("span",{className:"flex-1 text-green-800"},"✓ ",k),t.createElement("button",{onClick:()=>y(D),className:"text-red-600 hover:text-red-800 p-1 ml-2",title:"Eliminar servicio"},"✕")))))),w==="marcas"&&t.createElement("div",null,t.createElement("div",{className:"mb-6"},t.createElement("h4",{className:"text-md font-semibold mb-3"},"Marcas Comunes"),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2"},v.filter(k=>!o.includes(k)).map((k,D)=>t.createElement("button",{key:D,onClick:()=>N(k),className:"px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-blue-100 hover:text-blue-700 transition-colors text-left"},"+ ",k)))),t.createElement("div",{className:"mb-6"},t.createElement("h4",{className:"text-md font-semibold mb-3"},"Agregar Marca Personalizada"),t.createElement("div",{className:"flex gap-2"},t.createElement("input",{type:"text",value:m,onChange:k=>h(k.target.value),onKeyPress:k=>P(k,"marca"),placeholder:"Nombre de la marca personalizada...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.createElement("button",{onClick:()=>N(),disabled:!m.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors"},"Agregar"))),t.createElement("div",null,t.createElement("h4",{className:"text-md font-semibold mb-3"},"Marcas Seleccionadas"),o.length===0?t.createElement("p",{className:"text-gray-500 text-center py-6 bg-gray-50 rounded-lg"},"No hay marcas seleccionadas"):t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2"},o.map((k,D)=>t.createElement("div",{key:D,className:"flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg"},t.createElement("span",{className:"flex-1 text-blue-800"},"🚗 ",k),t.createElement("button",{onClick:()=>E(D),className:"text-red-600 hover:text-red-800 p-1 ml-2",title:"Eliminar marca"},"✕")))))),w==="categorias"&&t.createElement("div",null,t.createElement("div",{className:"mb-6"},t.createElement("h4",{className:"text-md font-semibold mb-3"},"Tipos de Vehículos Comunes"),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2"},I.filter(k=>!l.includes(k)).map((k,D)=>t.createElement("button",{key:D,onClick:()=>x(k),className:"px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-purple-100 hover:text-purple-700 transition-colors text-left"},"+ ",k)))),t.createElement("div",{className:"mb-6"},t.createElement("h4",{className:"text-md font-semibold mb-3"},"Agregar Tipo de Vehículo Personalizado"),t.createElement("div",{className:"flex gap-2"},t.createElement("input",{type:"text",value:C,onChange:k=>S(k.target.value),onKeyPress:k=>P(k,"categoria"),placeholder:"Nombre del tipo de vehículo personalizado...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"}),t.createElement("button",{onClick:()=>x(),disabled:!C.trim(),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 transition-colors"},"Agregar"))),t.createElement("div",null,t.createElement("h4",{className:"text-md font-semibold mb-3"},"Tipos de Vehículos Seleccionados"),l.length===0?t.createElement("p",{className:"text-gray-500 text-center py-6 bg-gray-50 rounded-lg"},"No hay tipos de vehículos seleccionados"):t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2"},l.map((k,D)=>t.createElement("div",{key:D,className:"flex items-center justify-between p-3 bg-purple-50 border border-purple-200 rounded-lg"},t.createElement("span",{className:"flex-1 text-purple-800"},"🚙 ",k),t.createElement("button",{onClick:()=>_(D),className:"text-red-600 hover:text-red-800 p-1 ml-2",title:"Eliminar tipo de vehículo"},"✕")))))))}function s$({empresa:a,onUpdate:e,saving:n}){var u,d,m,h;const r={logoValido:a.logo&&a.logo.length>0,webValida:!a.web||a.web.startsWith("http")&&a.web.length>10,imagenesMinimas:a.galeria&&a.galeria.length>=2,serviciosCompletos:a.servicios&&a.servicios.length>=2,marcasDefinidas:a.marcas&&a.marcas.length>=2,categoriasDefinidas:a.categorias&&a.categorias.length>=2,horariosCompletos:a.horarios&&Object.values(a.horarios).some(C=>C.abierto),informacionCompleta:a.nombre&&a.telefono&&a.email&&a.direccion,representanteCompleto:a.representante&&a.representante.nombre&&a.representante.email},s=Object.keys(r).length,o=Object.values(r).filter(Boolean).length,i=Math.round(o/s*100),l=(C,S)=>{e(C,S)},c=i>=80?"excelente":i>=60?"bueno":i>=40?"regular":"deficiente";return t.createElement("div",{className:"p-6"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"🔍 Revisión Administrativa"),t.createElement("div",{className:"mb-6 p-4 rounded-lg border-2",style:{borderColor:c==="excelente"?"#22c55e":c==="bueno"?"#3b82f6":c==="regular"?"#f59e0b":"#ef4444",backgroundColor:c==="excelente"?"#f0fdf4":c==="bueno"?"#eff6ff":c==="regular"?"#fffbeb":"#fef2f2"}},t.createElement("div",{className:"flex items-center justify-between mb-3"},t.createElement("h4",{className:"font-semibold text-lg"},"Estado General del Perfil"),t.createElement("span",{className:"text-2xl"},c==="excelente"?"🟢":c==="bueno"?"🔵":c==="regular"?"🟡":"🔴")),t.createElement("div",{className:"flex items-center gap-4"},t.createElement("div",{className:"flex-1 bg-gray-200 rounded-full h-3"},t.createElement("div",{className:"h-3 rounded-full transition-all duration-300",style:{width:`${i}%`,backgroundColor:c==="excelente"?"#22c55e":c==="bueno"?"#3b82f6":c==="regular"?"#f59e0b":"#ef4444"}})),t.createElement("span",{className:"font-bold text-lg"},i,"%")),t.createElement("p",{className:"text-sm mt-2 opacity-75"},o," de ",s," elementos completados")),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",{className:`p-4 rounded-lg border-l-4 ${r.logoValido?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h5",{className:"font-medium"},"🖼️ Logo de la Empresa"),t.createElement("p",{className:"text-sm text-gray-600"},"Logo asignado y visible")),t.createElement("span",{className:"text-2xl"},r.logoValido?"✅":"❌")),!r.logoValido&&t.createElement("p",{className:"text-red-600 text-sm mt-2"},'⚠️ Subir o asignar logo en la pestaña "Logo"')),t.createElement("div",{className:`p-4 rounded-lg border-l-4 ${r.webValida?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h5",{className:"font-medium"},"🌐 Página Web"),t.createElement("p",{className:"text-sm text-gray-600"},"URL válida o perfil público")),t.createElement("span",{className:"text-2xl"},r.webValida?"✅":"❌")),!r.webValida&&a.web&&t.createElement("p",{className:"text-red-600 text-sm mt-2"},"⚠️ URL de página web no es válida")),t.createElement("div",{className:`p-4 rounded-lg border-l-4 ${r.imagenesMinimas?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h5",{className:"font-medium"},"📸 Galería de Imágenes"),t.createElement("p",{className:"text-sm text-gray-600"},"Mínimo 2 imágenes del local")),t.createElement("span",{className:"text-2xl"},r.imagenesMinimas?"✅":"❌")),!r.imagenesMinimas&&t.createElement("p",{className:"text-red-600 text-sm mt-2"},"⚠️ Faltan imágenes (",((u=a.galeria)==null?void 0:u.length)||0,"/2 mínimo)")),t.createElement("div",{className:`p-4 rounded-lg border-l-4 ${r.serviciosCompletos?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h5",{className:"font-medium"},"🛠️ Servicios Ofrecidos"),t.createElement("p",{className:"text-sm text-gray-600"},"Mínimo 2 servicios definidos")),t.createElement("span",{className:"text-2xl"},r.serviciosCompletos?"✅":"❌")),!r.serviciosCompletos&&t.createElement("p",{className:"text-red-600 text-sm mt-2"},"⚠️ Definir servicios (",((d=a.servicios)==null?void 0:d.length)||0,"/2 mínimo)")),t.createElement("div",{className:`p-4 rounded-lg border-l-4 ${r.marcasDefinidas?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h5",{className:"font-medium"},"🚗 Marcas que Trabaja"),t.createElement("p",{className:"text-sm text-gray-600"},"Mínimo 2 marcas definidas")),t.createElement("span",{className:"text-2xl"},r.marcasDefinidas?"✅":"❌")),!r.marcasDefinidas&&t.createElement("p",{className:"text-red-600 text-sm mt-2"},"⚠️ Definir marcas (",((m=a.marcas)==null?void 0:m.length)||0,"/2 mínimo)")),t.createElement("div",{className:`p-4 rounded-lg border-l-4 ${r.categoriasDefinidas?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h5",{className:"font-medium"},"🚙 Tipos de Vehículos"),t.createElement("p",{className:"text-sm text-gray-600"},"Mínimo 2 tipos definidos")),t.createElement("span",{className:"text-2xl"},r.categoriasDefinidas?"✅":"❌")),!r.categoriasDefinidas&&t.createElement("p",{className:"text-red-600 text-sm mt-2"},"⚠️ Definir tipos de vehículos (",((h=a.categorias)==null?void 0:h.length)||0,"/2 mínimo)")),t.createElement("div",{className:`p-4 rounded-lg border-l-4 ${r.horariosCompletos?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h5",{className:"font-medium"},"🕒 Horarios de Atención"),t.createElement("p",{className:"text-sm text-gray-600"},"Al menos un día con horario")),t.createElement("span",{className:"text-2xl"},r.horariosCompletos?"✅":"❌")),!r.horariosCompletos&&t.createElement("p",{className:"text-red-600 text-sm mt-2"},'⚠️ Configurar horarios en la pestaña "Horarios"')),t.createElement("div",{className:`p-4 rounded-lg border-l-4 ${r.informacionCompleta?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h5",{className:"font-medium"},"📋 Información General"),t.createElement("p",{className:"text-sm text-gray-600"},"Datos básicos completos")),t.createElement("span",{className:"text-2xl"},r.informacionCompleta?"✅":"❌")),!r.informacionCompleta&&t.createElement("p",{className:"text-red-600 text-sm mt-2"},"⚠️ Completar información general")),t.createElement("div",{className:`p-4 rounded-lg border-l-4 ${r.representanteCompleto?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h5",{className:"font-medium"},"👤 Representante Legal"),t.createElement("p",{className:"text-sm text-gray-600"},"Datos del representante")),t.createElement("span",{className:"text-2xl"},r.representanteCompleto?"✅":"❌")),!r.representanteCompleto&&t.createElement("p",{className:"text-red-600 text-sm mt-2"},"⚠️ Completar datos del representante"))),t.createElement("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg"},t.createElement("h4",{className:"font-semibold mb-3"},"⚡ Acciones Rápidas de Validación"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3"},t.createElement("button",{onClick:()=>l("logoValidado",!0),disabled:n,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors"},"✅ Validar Logo"),t.createElement("button",{onClick:()=>l("webValidada",!0),disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors"},"🌐 Validar Web"),t.createElement("button",{onClick:()=>l("imagenesValidadas",!0),disabled:n,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 transition-colors"},"📸 Validar Imágenes")),i>=80&&t.createElement("div",{className:"mt-4 p-3 bg-green-100 border border-green-300 rounded-lg"},t.createElement("div",{className:"flex items-center gap-2"},t.createElement("span",{className:"text-green-600 text-lg"},"🎉"),t.createElement("div",null,t.createElement("p",{className:"font-semibold text-green-800"},"¡Perfil Listo para Publicación!"),t.createElement("button",{onClick:()=>{l("perfilPublico",!0),l("estado","activa")},disabled:n,className:"mt-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors"},"🚀 Activar Perfil Público"))))),t.createElement("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg"},t.createElement("h4",{className:"font-semibold mb-3"},"👁️ Vista Previa"),t.createElement("div",{className:"flex gap-3"},t.createElement("a",{href:`/empresa/${a.id}`,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},"🌐 Ver Perfil Público"),t.createElement("a",{href:"/admin/empresas",className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"},"📋 Volver al Listado"))))}function o$({empresa:a,onUpdate:e,saving:n}){const[r,s]=p.useState({etapa_proceso:a.etapa_proceso||"pendiente",logoAsignado:a.logoAsignado||!1,logoValidado:a.logoValidado||!1,webValidada:a.webValidada||!1,imagenesValidadas:a.imagenesValidadas||!1,galeriaCompleta:a.galeriaCompleta||!1,telefonoValidado:a.telefonoValidado||!1,emailValidado:a.emailValidado||!1,ubicacionVerificada:a.ubicacionVerificada||!1,documentosCompletos:a.documentosCompletos||!1,perfilPublico:a.perfilPublico||!1,agenteAsignado:a.agenteAsignado||"",notas_admin:a.notas_admin||"",fecha_verificacion:a.fecha_verificacion||"",prioridad:a.prioridad||"normal"}),o=u=>{const{name:d,value:m,type:h,checked:C}=u.target;s(S=>({...S,[d]:h==="checkbox"?C:m}))},i=()=>{Object.keys(r).forEach(u=>{r[u]!==a[u]&&e(u,r[u])})},l=[{value:"pendiente",label:"Pendiente"},{value:"en_revision",label:"En Revisión"},{value:"validacion_documentos",label:"Validación de Documentos"},{value:"verificacion_datos",label:"Verificación de Datos"},{value:"asignacion_agente",label:"Asignación de Agente"},{value:"completado",label:"Completado"},{value:"rechazado",label:"Rechazado"}],c=[{value:"baja",label:"Baja"},{value:"normal",label:"Normal"},{value:"alta",label:"Alta"},{value:"urgente",label:"Urgente"}];return t.createElement("div",{className:"p-6"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Metadata y Control"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Etapa del Proceso"),t.createElement("select",{name:"etapa_proceso",value:r.etapa_proceso,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},l.map(u=>t.createElement("option",{key:u.value,value:u.value},u.label)))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Prioridad"),t.createElement("select",{name:"prioridad",value:r.prioridad,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},c.map(u=>t.createElement("option",{key:u.value,value:u.value},u.label)))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Agente Asignado"),t.createElement("input",{type:"text",name:"agenteAsignado",value:r.agenteAsignado,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ID o nombre del agente"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Fecha de Verificación"),t.createElement("input",{type:"date",name:"fecha_verificacion",value:r.fecha_verificacion,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}))),t.createElement("div",{className:"mt-6"},t.createElement("h4",{className:"text-md font-semibold mb-3"},"Estados de Validación"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("label",{className:"flex items-center"},t.createElement("input",{type:"checkbox",name:"logoAsignado",checked:r.logoAsignado,onChange:o,className:"mr-2"}),"Logo Asignado"),t.createElement("label",{className:"flex items-center"},t.createElement("input",{type:"checkbox",name:"logoValidado",checked:r.logoValidado,onChange:o,className:"mr-2"}),t.createElement("span",{className:"text-green-600"},"✓ Logo Validado")),t.createElement("label",{className:"flex items-center"},t.createElement("input",{type:"checkbox",name:"webValidada",checked:r.webValidada,onChange:o,className:"mr-2"}),t.createElement("span",{className:"text-green-600"},"✓ Web Validada")),t.createElement("label",{className:"flex items-center"},t.createElement("input",{type:"checkbox",name:"imagenesValidadas",checked:r.imagenesValidadas,onChange:o,className:"mr-2"}),t.createElement("span",{className:"text-green-600"},"✓ Imágenes Validadas")),t.createElement("label",{className:"flex items-center"},t.createElement("input",{type:"checkbox",name:"galeriaCompleta",checked:r.galeriaCompleta,onChange:o,className:"mr-2"}),t.createElement("span",{className:"text-blue-600"},"📸 Galería Completa")),t.createElement("label",{className:"flex items-center"},t.createElement("input",{type:"checkbox",name:"telefonoValidado",checked:r.telefonoValidado,onChange:o,className:"mr-2"}),"Teléfono Validado"),t.createElement("label",{className:"flex items-center"},t.createElement("input",{type:"checkbox",name:"emailValidado",checked:r.emailValidado,onChange:o,className:"mr-2"}),"Email Validado"),t.createElement("label",{className:"flex items-center"},t.createElement("input",{type:"checkbox",name:"ubicacionVerificada",checked:r.ubicacionVerificada,onChange:o,className:"mr-2"}),"Ubicación Verificada"),t.createElement("label",{className:"flex items-center"},t.createElement("input",{type:"checkbox",name:"documentosCompletos",checked:r.documentosCompletos,onChange:o,className:"mr-2"}),"Documentos Completos"),t.createElement("label",{className:"flex items-center"},t.createElement("input",{type:"checkbox",name:"perfilPublico",checked:r.perfilPublico,onChange:o,className:"mr-2"}),"Perfil Público Activo"))),t.createElement("div",{className:"mt-6"},t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Notas Administrativas"),t.createElement("textarea",{name:"notas_admin",value:r.notas_admin,onChange:o,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Notas internas del administrador..."})),t.createElement("div",{className:"mt-6 flex justify-end"},t.createElement("button",{onClick:i,disabled:n,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors"},n?"Guardando...":"Guardar Metadata")))}function i$({empresa:a,onUpdate:e,saving:n}){const r=[{key:"lunes",label:"Lunes",emoji:"📅"},{key:"martes",label:"Martes",emoji:"📅"},{key:"miercoles",label:"Miércoles",emoji:"📅"},{key:"jueves",label:"Jueves",emoji:"📅"},{key:"viernes",label:"Viernes",emoji:"📅"},{key:"sabado",label:"Sábado",emoji:"📅"},{key:"domingo",label:"Domingo",emoji:"📅"}],s={abierto:!1,apertura:"08:00",cierre:"18:00",descanso_inicio:"",descanso_fin:"",turno_continuo:!0},[o,i]=p.useState(()=>{let f=a.horarios||{};Object.keys(f).length===0&&a.horario_atencion&&(console.log("📝 Horario de atención encontrado:",a.horario_atencion),f=u(a.horario_atencion));const b={};return r.forEach(v=>{b[v.key]={...s,...f[v.key]}}),b}),[l,c]=p.useState("personalizado"),u=f=>{if(!f)return{};console.log("🔄 Parseando horarios del texto:",f);const b={},v=["lunes","martes","miercoles","jueves","viernes","sabado","domingo"],I={lun:"lunes",mar:"martes",mié:"miercoles",jue:"jueves",vie:"viernes",sáb:"sabado",dom:"domingo"};return f.split(",").map(N=>N.trim()).forEach(N=>{let x=null;for(const[y,E]of Object.entries(I))if(N.toLowerCase().includes(y.toLowerCase())){x=E;break}if(x){const y=N.match(/(\d{1,2}:\d{2})-(\d{1,2}:\d{2})/);if(y){const[E,_,P]=y;b[x]={abierto:!0,apertura:_,cierre:P,turno_continuo:!0,descanso_inicio:"",descanso_fin:""},console.log(`✅ Día ${x}: ${_}-${P}`)}}}),v.forEach(N=>{b[N]||(b[N]={abierto:!1,apertura:"09:00",cierre:"18:00",turno_continuo:!0,descanso_inicio:"",descanso_fin:""})}),console.log("📊 Horarios parseados:",b),b},d=(f,b,v)=>{const I={...o,[f]:{...o[f],[b]:v}};i(I)},m=f=>{let b={...o};switch(f){case"comercial":r.forEach(v=>{["lunes","martes","miercoles","jueves","viernes"].includes(v.key)?b[v.key]={...s,abierto:!0,apertura:"08:00",cierre:"18:00",turno_continuo:!0}:v.key==="sabado"?b[v.key]={...s,abierto:!0,apertura:"08:00",cierre:"13:00",turno_continuo:!0}:b[v.key]={...s,abierto:!1}});break;case"taller":r.forEach(v=>{["lunes","martes","miercoles","jueves","viernes","sabado"].includes(v.key)?b[v.key]={...s,abierto:!0,apertura:"07:00",cierre:"17:00",descanso_inicio:"12:00",descanso_fin:"13:00",turno_continuo:!1}:b[v.key]={...s,abierto:!1}});break;case"24h":r.forEach(v=>{b[v.key]={...s,abierto:!0,apertura:"00:00",cierre:"23:59",turno_continuo:!0}});break;case"cerrado":r.forEach(v=>{b[v.key]={...s,abierto:!1}});break}i(b),c(f)},h=f=>b=>{const v={...o,[b]:{...o[f]}};i(v)},C=()=>{e("horarios",o)},S=f=>{if(!f)return"";const[b,v]=f.split(":");return`${b}:${v}`},w=f=>f.abierto?f.turno_continuo?`${S(f.apertura)} - ${S(f.cierre)}`:`${S(f.apertura)}-${S(f.descanso_inicio)} | ${S(f.descanso_fin)}-${S(f.cierre)}`:"Cerrado";return t.createElement("div",{className:"p-6"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Gestión de Horarios"),t.createElement("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg"},t.createElement("h4",{className:"text-md font-semibold mb-3"},"⚡ Configuraciones Rápidas"),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2"},t.createElement("button",{onClick:()=>m("comercial"),className:`p-3 rounded-lg text-sm font-medium transition-colors ${l==="comercial"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-blue-50"}`},"🏢 Comercial",t.createElement("br",null),t.createElement("span",{className:"text-xs opacity-75"},"L-V 8-18, S 8-13")),t.createElement("button",{onClick:()=>m("taller"),className:`p-3 rounded-lg text-sm font-medium transition-colors ${l==="taller"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-blue-50"}`},"🔧 Taller",t.createElement("br",null),t.createElement("span",{className:"text-xs opacity-75"},"L-S 7-17 (descanso)")),t.createElement("button",{onClick:()=>m("24h"),className:`p-3 rounded-lg text-sm font-medium transition-colors ${l==="24h"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-blue-50"}`},"🌙 24 Horas",t.createElement("br",null),t.createElement("span",{className:"text-xs opacity-75"},"Todos los días")),t.createElement("button",{onClick:()=>m("cerrado"),className:`p-3 rounded-lg text-sm font-medium transition-colors ${l==="cerrado"?"bg-red-600 text-white":"bg-white text-gray-700 hover:bg-red-50"}`},"🚫 Cerrado",t.createElement("br",null),t.createElement("span",{className:"text-xs opacity-75"},"Todos los días")))),t.createElement("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg"},t.createElement("h4",{className:"text-md font-semibold mb-3"},"📋 Resumen Semanal"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2"},r.map(f=>t.createElement("div",{key:f.key,className:"flex justify-between items-center p-2 bg-white rounded"},t.createElement("span",{className:"font-medium"},f.emoji," ",f.label,":"),t.createElement("span",{className:`text-sm ${o[f.key].abierto?"text-green-600":"text-red-600"}`},w(o[f.key])))))),t.createElement("div",{className:"space-y-4"},t.createElement("h4",{className:"text-md font-semibold"},"⚙️ Configuración Detallada"),r.map(f=>t.createElement("div",{key:f.key,className:"border border-gray-200 rounded-lg p-4"},t.createElement("div",{className:"flex items-center justify-between mb-3"},t.createElement("h5",{className:"font-semibold text-gray-800"},f.emoji," ",f.label),t.createElement("div",{className:"flex items-center gap-2"},t.createElement("span",{className:"text-xs text-gray-500"},"Copiar a:"),r.filter(b=>b.key!==f.key).map(b=>t.createElement("button",{key:b.key,onClick:()=>h(f.key)(b.key),className:"text-xs px-2 py-1 bg-gray-100 hover:bg-gray-200 rounded",title:`Copiar horario a ${b.label}`},b.label.substring(0,3))))),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},t.createElement("div",{className:"flex items-center"},t.createElement("label",{className:"flex items-center cursor-pointer"},t.createElement("input",{type:"checkbox",checked:o[f.key].abierto,onChange:b=>d(f.key,"abierto",b.target.checked),className:"mr-2"}),t.createElement("span",{className:`font-medium ${o[f.key].abierto?"text-green-600":"text-red-600"}`},o[f.key].abierto?"✅ Abierto":"❌ Cerrado"))),o[f.key].abierto&&t.createElement(t.Fragment,null,t.createElement("div",null,t.createElement("label",{className:"block text-xs font-medium text-gray-700 mb-1"},"🌅 Apertura"),t.createElement("input",{type:"time",value:o[f.key].apertura,onChange:b=>d(f.key,"apertura",b.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-xs font-medium text-gray-700 mb-1"},"🌆 Cierre"),t.createElement("input",{type:"time",value:o[f.key].cierre,onChange:b=>d(f.key,"cierre",b.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"})),t.createElement("div",{className:"flex items-center"},t.createElement("label",{className:"flex items-center cursor-pointer"},t.createElement("input",{type:"checkbox",checked:o[f.key].turno_continuo,onChange:b=>d(f.key,"turno_continuo",b.target.checked),className:"mr-2"}),t.createElement("span",{className:"text-sm"},"⏰ Turno continuo"))))),o[f.key].abierto&&!o[f.key].turno_continuo&&t.createElement("div",{className:"mt-3 pt-3 border-t border-gray-100"},t.createElement("p",{className:"text-sm font-medium text-gray-700 mb-2"},"🍽️ Horario de Descanso"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-xs font-medium text-gray-600 mb-1"},"Inicio descanso"),t.createElement("input",{type:"time",value:o[f.key].descanso_inicio,onChange:b=>d(f.key,"descanso_inicio",b.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-xs font-medium text-gray-600 mb-1"},"Fin descanso"),t.createElement("input",{type:"time",value:o[f.key].descanso_fin,onChange:b=>d(f.key,"descanso_fin",b.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"}))))))),t.createElement("div",{className:"mt-6 flex justify-end"},t.createElement("button",{onClick:C,disabled:n,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors"},n?"Guardando...":"Guardar Horarios")))}function vh(a){return a?a.startsWith("http")?a:`/images/${a}`:""}function bh(a){if(!a)return"bg-gray-100 text-gray-800";switch(a.toLowerCase()){case"enviado":case"pendiente":return"bg-yellow-100 text-yellow-800";case"activo":case"activa":return"bg-green-100 text-green-800";case"revision":case"en revisión":case"en revision":return"bg-orange-100 text-orange-800";case"cancelado":case"inactivo":case"inactiva":return"bg-red-100 text-red-800";case"suspendido":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}}function l$(){const[a,e]=p.useState([]),[n,r]=p.useState([]),[s,o]=p.useState({estado:"",busqueda:"",tipoVista:"grid",mostrar:"todos"}),[i,l]=p.useState(!0),[c,u]=p.useState(null),[d,m]=p.useState(!1),h=Ct();p.useEffect(()=>{console.log("🔍 ListadoProveedoresAdmin: Iniciando carga de datos...");const b=fe(W(F,"empresas"),pe("estado","in",["activa","validada"]),st("fecha_registro","desc")),v=wa(b,N=>{const x=N.docs.map(y=>({id:y.id,...y.data(),tipo:"empresa"}));console.log("🏢 Empresas cargadas:",x.length,x),e(x)},N=>{console.error("❌ Error cargando empresas:",N);const x=fe(W(F,"empresas"),pe("estado","in",["activa","validada"]));wa(x,y=>{const E=y.docs.map(_=>({id:_.id,..._.data(),tipo:"empresa"}));console.log("🏢 Empresas cargadas (sin orden):",E.length,E),e(E)})}),I=fe(W(F,"solicitudes_empresa"),st("fecha_solicitud","desc")),A=wa(I,N=>{const x=N.docs.map(y=>({id:y.id,...y.data(),tipo:"solicitud"}));console.log("📋 Solicitudes cargadas:",x.length,x),r(x),l(!1)},N=>{console.error("❌ Error cargando solicitudes:",N);const x=W(F,"solicitudes_empresa");wa(x,y=>{const E=y.docs.map(_=>({id:_.id,..._.data(),tipo:"solicitud"}));console.log("📋 Solicitudes cargadas (sin orden):",E.length,E),r(E),l(!1)})});return()=>{v(),A()}},[]);const C=()=>{let b=[];if(s.mostrar==="todos"||s.mostrar==="empresas"){const v=a.filter(I=>{const A=(I.estado||"").toLowerCase();return A==="activa"||A==="validada"});b=[...b,...v]}return(s.mostrar==="todos"||s.mostrar==="solicitudes")&&(b=[...b,...n]),console.log(`📊 Combinando datos: filtro="${s.mostrar}", empresas=${a.length}, solicitudes=${n.length}, total=${b.length}`),b},S=C().filter(b=>{if(s.estado&&(b.estado||"").toLowerCase()!==s.estado.toLowerCase())return!1;if(s.busqueda){const v=s.busqueda.toLowerCase();return(b.nombre||"").toLowerCase().includes(v)||(b.nombre_empresa||"").toLowerCase().includes(v)||(b.email||"").toLowerCase().includes(v)||(b.email_empresa||"").toLowerCase().includes(v)||(b.rut||"").toLowerCase().includes(v)||(b.rut_empresa||"").toLowerCase().includes(v)||(b.agente_nombre||"").toLowerCase().includes(v)||(b.tipoEmpresa||"").toLowerCase().includes(v)}return!0});console.log(`🔍 Después del filtrado: ${S.length} items mostrados de ${C().length} totales`),console.log("📋 Items filtrados:",S);const w=async(b,v)=>{try{await ze(Ne(F,"empresas",b),{estado:v,fechaActualizacion:new Date})}catch(I){console.error("Error al actualizar estado:",I)}},f=b=>b?(b.toDate?b.toDate():new Date(b)).toLocaleDateString("es-CL"):"N/A";return i?t.createElement("div",{className:"flex items-center justify-center h-64"},t.createElement("div",{className:"text-lg"},"Cargando proveedores...")):t.createElement("div",{className:"p-6 bg-gray-50 min-h-screen"},t.createElement("div",{className:"mb-6"},t.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Gestión de Proveedores y Empresas"),t.createElement("p",{className:"text-gray-600"},"Administra empresas activas y solicitudes de registro (incluyendo las de agentes de campo)")),t.createElement("div",{className:"mb-6 bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-lg p-4"},t.createElement("div",{className:"flex items-start"},t.createElement("div",{className:"flex-shrink-0"},t.createElement("span",{className:"text-2xl"},"ℹ️")),t.createElement("div",{className:"ml-3"},t.createElement("h3",{className:"text-sm font-medium text-green-900 mb-2"},"Vista Unificada: Empresas y Solicitudes"),t.createElement("div",{className:"text-sm text-green-700 space-y-1"},t.createElement("p",null,"• ",t.createElement("strong",null,"Empresas Activas"),": Proveedores ya registrados y funcionando"),t.createElement("p",null,"• ",t.createElement("strong",null,"Solicitudes"),": Nuevas empresas pendientes (web y agentes de campo)"),t.createElement("p",null,"• ",t.createElement("strong",null,"Filtros"),': Usa el filtro "Mostrar" para ver solo empresas, solo solicitudes o ambos'))))),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6"},t.createElement("div",{className:"bg-white rounded-lg shadow p-4"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"p-2 bg-green-100 rounded-lg"},t.createElement("span",{className:"text-xl"},"🏢")),t.createElement("div",{className:"ml-3"},t.createElement("p",{className:"text-xl font-bold text-gray-900"},a.length),t.createElement("p",{className:"text-gray-600 text-sm"},"Empresas Activas")))),t.createElement("div",{className:"bg-white rounded-lg shadow p-4"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"p-2 bg-blue-100 rounded-lg"},t.createElement("span",{className:"text-xl"},"📋")),t.createElement("div",{className:"ml-3"},t.createElement("p",{className:"text-xl font-bold text-blue-900"},n.length),t.createElement("p",{className:"text-blue-600 text-sm"},"Solicitudes Total")))),t.createElement("div",{className:"bg-white rounded-lg shadow p-4"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"p-2 bg-green-100 rounded-lg"},t.createElement("span",{className:"text-xl"},"✅")),t.createElement("div",{className:"ml-3"},t.createElement("p",{className:"text-xl font-bold text-green-600"},a.filter(b=>{const v=(b.estado||"").toLowerCase();return v==="activa"||v==="validada"}).length),t.createElement("p",{className:"text-green-600 text-sm"},"Activas")))),t.createElement("div",{className:"bg-white rounded-lg shadow p-4"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"p-2 bg-yellow-100 rounded-lg"},t.createElement("span",{className:"text-xl"},"⏳")),t.createElement("div",{className:"ml-3"},t.createElement("p",{className:"text-xl font-bold text-yellow-600"},n.filter(b=>b.estado==="pendiente"||b.estado==="en_revision").length),t.createElement("p",{className:"text-yellow-600 text-sm"},"Pendientes")))),t.createElement("div",{className:"bg-white rounded-lg shadow p-4"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"p-2 bg-purple-100 rounded-lg"},t.createElement("span",{className:"text-xl"},"👨‍💼")),t.createElement("div",{className:"ml-3"},t.createElement("p",{className:"text-xl font-bold text-purple-600"},n.filter(b=>b.agente_id||b.origen==="agente_campo").length),t.createElement("p",{className:"text-purple-600 text-sm"},"De Agentes"))))),t.createElement("div",{className:"bg-white rounded-lg shadow mb-6 p-6"},t.createElement("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},t.createElement("div",{className:"flex flex-col md:flex-row gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Mostrar"),t.createElement("select",{value:s.mostrar,onChange:b=>o({...s,mostrar:b.target.value}),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"todos"},"Todo (Empresas y Solicitudes)"),t.createElement("option",{value:"empresas"},"Solo Empresas Activas"),t.createElement("option",{value:"solicitudes"},"Solo Solicitudes"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Estado"),t.createElement("select",{value:s.estado,onChange:b=>o({...s,estado:b.target.value}),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:""},"Todos los estados"),t.createElement("option",{value:"activa"},"Activos"),t.createElement("option",{value:"pendiente"},"Pendientes"),t.createElement("option",{value:"en_revision"},"En Revisión"),t.createElement("option",{value:"activada"},"Activadas (Visible en Home)"),t.createElement("option",{value:"credenciales_asignadas"},"Con Credenciales"),t.createElement("option",{value:"inactiva"},"Inactivos"),t.createElement("option",{value:"rechazada"},"Rechazadas"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Buscar"),t.createElement("input",{type:"text",placeholder:"Buscar por nombre, email, RUT o agente...",value:s.busqueda,onChange:b=>o({...s,busqueda:b.target.value}),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 min-w-64"}))),t.createElement("div",{className:"flex items-center gap-2"},t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Vista:"),t.createElement("div",{className:"flex bg-gray-100 rounded-lg p-1"},t.createElement("button",{onClick:()=>o({...s,tipoVista:"grid"}),className:`px-3 py-1 rounded text-sm ${s.tipoVista==="grid"?"bg-white shadow text-blue-600":"text-gray-600 hover:text-gray-900"}`},"📊 Tarjetas"),t.createElement("button",{onClick:()=>o({...s,tipoVista:"table"}),className:`px-3 py-1 rounded text-sm ${s.tipoVista==="table"?"bg-white shadow text-blue-600":"text-gray-600 hover:text-gray-900"}`},"📋 Tabla"))))),t.createElement("div",{className:"mb-4 flex justify-between items-center"},t.createElement("p",{className:"text-gray-600"},"Mostrando ",S.length," de ",C().length," elementos (",a.length," empresas activas, ",n.length," solicitudes)"),t.createElement("button",{onClick:async()=>{console.log("=== DEBUG INFO ==="),console.log("Proveedores:",a),console.log("Solicitudes:",n),console.log("Filtros:",s),console.log("Items filtrados:",S),console.log("Total items:",C());try{const b=await le(W(F,"empresas"));console.log("=== EMPRESAS EN FIRESTORE ==="),console.log("Total documentos en empresas:",b.size),b.docs.forEach(I=>{console.log(`Empresa ${I.id}:`,I.data())});const v=await le(W(F,"solicitudes_empresa"));console.log("=== SOLICITUDES EN FIRESTORE ==="),console.log("Total documentos en solicitudes:",v.size),v.docs.forEach(I=>{console.log(`Solicitud ${I.id}:`,I.data())})}catch(b){console.error("Error en debug:",b)}},className:"px-3 py-1 bg-yellow-500 text-white rounded text-sm hover:bg-yellow-600"},"🐛 Debug")),S.length===0?t.createElement("div",{className:"bg-white rounded-lg shadow p-12 text-center"},t.createElement("span",{className:"text-6xl mb-4 block"},"🔍"),t.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No se encontraron elementos"),t.createElement("p",{className:"text-gray-600"},"Intenta ajustar los filtros de búsqueda")):t.createElement(t.Fragment,null,s.tipoVista==="grid"&&t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},S.map(b=>t.createElement("div",{key:`${b.tipo}-${b.id}`,className:"bg-white rounded-lg shadow hover:shadow-lg transition-shadow p-6"},t.createElement("div",{className:"flex items-start justify-between mb-4"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"w-12 h-12 rounded flex items-center justify-center"},b.tipo==="empresa"?b.logo?t.createElement("img",{src:vh(b.logo),alt:"Logo",className:"w-12 h-12 object-contain rounded border bg-gray-50"}):t.createElement("div",{className:"w-12 h-12 bg-green-100 rounded flex items-center justify-center"},t.createElement("span",{className:"text-green-600 text-xl"},"🏢")):t.createElement("div",{className:"w-12 h-12 bg-blue-100 rounded flex items-center justify-center"},t.createElement("span",{className:"text-blue-600 text-xl"},"📋"))),t.createElement("div",{className:"ml-3"},t.createElement("h3",{className:"font-semibold text-gray-900"},b.nombre||b.nombre_empresa||"Sin nombre"),t.createElement("p",{className:"text-sm text-gray-600"},b.rut||b.rut_empresa||"Sin RUT"),b.tipo==="solicitud"&&t.createElement("p",{className:"text-xs text-blue-600 font-medium"},b.agente_nombre?`Por agente: ${b.agente_nombre}`:"Solicitud web"))),t.createElement("div",{className:"flex flex-col items-end"},t.createElement("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${bh(b.estado)}`},b.estado||"Sin estado"),t.createElement("span",{className:"text-xs text-gray-500 mt-1"},b.tipo==="empresa"?"Empresa":"Solicitud"))),t.createElement("div",{className:"space-y-2 mb-4"},t.createElement("div",{className:"flex items-center text-sm text-gray-600"},t.createElement("span",{className:"w-4"},"📧"),t.createElement("span",{className:"ml-2"},b.email||b.email_empresa||"Sin email")),b.telefono||b.telefono_empresa?t.createElement("div",{className:"flex items-center text-sm text-gray-600"},t.createElement("span",{className:"w-4"},"📱"),t.createElement("span",{className:"ml-2"},b.telefono||b.telefono_empresa)):null,b.tipo==="empresa"&&t.createElement("div",{className:"flex items-center text-sm text-gray-600"},t.createElement("span",{className:"w-4"},"🌐"),t.createElement("span",{className:"ml-2"},b.web?t.createElement("a",{href:b.web.startsWith("http")?b.web:`https://${b.web}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},b.web):"Sin sitio web")),t.createElement("div",{className:"flex items-center text-sm text-gray-600"},t.createElement("span",{className:"w-4"},"📅"),t.createElement("span",{className:"ml-2"},b.tipo==="empresa"?`Registrado: ${f(b.fecha_registro)}`:`Solicitado: ${f(b.fecha_solicitud)}`))),t.createElement("div",{className:"flex gap-2"},t.createElement("button",{onClick:()=>{u(b),m(!0)},className:"flex-1 bg-blue-600 text-white px-3 py-2 rounded text-sm hover:bg-blue-700 transition-colors"},"Ver Detalles"),b.tipo==="empresa"?t.createElement("button",{onClick:()=>h(`/admin/editar-empresa/${b.id}`),className:"flex-1 bg-gray-600 text-white px-3 py-2 rounded text-sm hover:bg-gray-700 transition-colors"},"Editar"):t.createElement("button",{onClick:()=>h("/admin/solicitudes-registro"),className:"flex-1 bg-purple-600 text-white px-3 py-2 rounded text-sm hover:bg-purple-700 transition-colors"},"Gestionar"))))),s.tipoVista==="table"&&t.createElement("div",{className:"bg-white rounded-lg shadow overflow-hidden"},t.createElement("div",{className:"overflow-x-auto"},t.createElement("table",{className:"min-w-full divide-y divide-gray-200"},t.createElement("thead",{className:"bg-gray-50"},t.createElement("tr",null,t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tipo / Empresa"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Contacto"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Fecha / Agente"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),t.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},S.map(b=>t.createElement("tr",{key:`${b.tipo}-${b.id}`,className:"hover:bg-gray-50"},t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("div",{className:"flex items-center"},b.tipo==="empresa"?b.logo?t.createElement("img",{src:vh(b.logo),alt:"Logo",className:"w-10 h-10 object-contain rounded border bg-gray-50"}):t.createElement("div",{className:"w-10 h-10 bg-green-100 rounded flex items-center justify-center"},t.createElement("span",{className:"text-green-600"},"🏢")):t.createElement("div",{className:"w-10 h-10 bg-blue-100 rounded flex items-center justify-center"},t.createElement("span",{className:"text-blue-600"},"📋")),t.createElement("div",{className:"ml-4"},t.createElement("div",{className:"text-sm font-medium text-gray-900"},b.nombre||b.nombre_empresa||"Sin nombre"),t.createElement("div",{className:"text-sm text-gray-500"},b.rut||b.rut_empresa||"Sin RUT"),t.createElement("div",{className:"text-xs text-gray-400"},b.tipo==="empresa"?"Empresa Activa":"Solicitud")))),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("div",{className:"text-sm text-gray-900"},b.email||b.email_empresa||"Sin email"),t.createElement("div",{className:"text-sm text-gray-500"},b.telefono||b.telefono_empresa||"Sin teléfono")),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${bh(b.estado)}`},b.estado||"Sin estado")),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},t.createElement("div",null,b.tipo==="empresa"?f(b.fecha_registro):f(b.fecha_solicitud)),b.agente_nombre&&t.createElement("div",{className:"text-xs text-purple-600"},"Agente: ",b.agente_nombre)),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},t.createElement("div",{className:"flex space-x-2"},t.createElement("button",{onClick:()=>{u(b),m(!0)},className:"text-blue-600 hover:text-blue-900"},"Ver"),b.tipo==="empresa"?t.createElement(t.Fragment,null,t.createElement("button",{onClick:()=>h(`/admin/editar-empresa/${b.id}`),className:"text-gray-600 hover:text-gray-900"},"Editar"),t.createElement("select",{value:b.estado||"",onChange:v=>w(b.id,v.target.value),className:"text-xs border border-gray-300 rounded px-2 py-1"},t.createElement("option",{value:"activa"},"Activo"),t.createElement("option",{value:"inactiva"},"Inactivo"),t.createElement("option",{value:"suspendida"},"Suspendido"))):t.createElement("button",{onClick:()=>h("/admin/solicitudes-registro"),className:"text-purple-600 hover:text-purple-900"},"Gestionar")))))))))),d&&c&&t.createElement("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},t.createElement("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white"},t.createElement("div",{className:"mt-3"},t.createElement("div",{className:"flex justify-between items-center mb-4"},t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Detalles del Proveedor"),t.createElement("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600"},"✕")),t.createElement("div",{className:"space-y-4 max-h-96 overflow-y-auto"},t.createElement("div",{className:"flex items-center mb-6"},c.logo?t.createElement("img",{src:vh(c.logo),alt:"Logo",className:"w-16 h-16 object-contain rounded border bg-gray-50"}):t.createElement("div",{className:"w-16 h-16 bg-gray-200 rounded flex items-center justify-center"},t.createElement("span",{className:"text-gray-500 text-2xl"},"🏢")),t.createElement("div",{className:"ml-4"},t.createElement("h4",{className:"text-xl font-semibold"},c.nombre||"Sin nombre"),t.createElement("p",{className:"text-gray-600"},c.rut||"Sin RUT"))),t.createElement("div",{className:"grid grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Email"),t.createElement("p",{className:"text-sm text-gray-900"},c.email||"N/A")),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Teléfono"),t.createElement("p",{className:"text-sm text-gray-900"},c.telefono||"N/A")),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Dirección"),t.createElement("p",{className:"text-sm text-gray-900"},c.direccion||"N/A")),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Estado"),t.createElement("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${bh(c.estado)}`},c.estado||"Sin estado")),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Sitio Web"),c.web?t.createElement("a",{href:c.web.startsWith("http")?c.web:`https://${c.web}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-sm"},c.web):t.createElement("p",{className:"text-sm text-gray-900"},"N/A")),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Fecha de Registro"),t.createElement("p",{className:"text-sm text-gray-900"},f(c.fechaRegistro))))),t.createElement("div",{className:"mt-6 flex justify-end space-x-3"},t.createElement("button",{onClick:()=>{h(`/admin/editar-empresa/${c.id}`),m(!1)},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"},"Editar Proveedor"),t.createElement("button",{onClick:()=>m(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400"},"Cerrar"))))))}function c$(){const[a,e]=p.useState(!0),n=Ct(),r=()=>{e(!1),n("/admin")},s=()=>{e(!1),n("/admin")};return t.createElement("div",{className:"min-h-screen bg-gray-50"},a&&t.createElement(Xg,{onClose:r,onSuccess:s}))}function wT(){const{user:a,rol:e}=ht(),[n,r]=p.useState([]),[s,o]=p.useState([]),[i,l]=p.useState([]),[c,u]=p.useState([]),[d,m]=p.useState(!0),[h,C]=p.useState("cotizar"),[S,w]=p.useState(!1);p.useState({}),p.useEffect(()=>{f()},[]);const f=async()=>{try{const A=await le(W(F,"companias_seguros"));r(A.docs.map(x=>({id:x.id,...x.data()})));const N=await le(W(F,"tipos_seguros"));if(o(N.docs.map(x=>({id:x.id,...x.data()}))),a){const x=fe(W(F,"cotizaciones_seguros"),pe("userId","==",a.uid)),y=await le(x);l(y.docs.map(P=>({id:P.id,...P.data()})));const E=fe(W(F,"polizas_seguros"),pe("userId","==",a.uid)),_=await le(E);u(_.docs.map(P=>({id:P.id,...P.data()})))}}catch(A){console.error("Error loading data:",A)}finally{m(!1)}},b=async A=>{try{const N={userId:a.uid,vehiculo:A,estado:"pendiente",fechaCreacion:new Date,companias:n.map(x=>({id:x.id,nombre:x.nombre,cotizacion:v(A,x)}))};await ot(W(F,"cotizaciones_seguros"),N),await f(),w(!1)}catch(N){console.error("Error creating cotización:",N)}},v=(A,N)=>{const x=A.valor*.02,y=A.antiguedad>10?1.3:1,E=A.region==="RM"?1.2:1;return Math.round(x*y*E*N.factor)},I=async(A,N)=>{try{const x=i.find(_=>_.id===A),y=x.companias.find(_=>_.id===N),E={userId:a.uid,cotizacionId:A,companiaId:N,vehiculo:x.vehiculo,prima:y.cotizacion,estado:"activa",fechaInicio:new Date,fechaVencimiento:new Date(Date.now()+365*24*60*60*1e3),numeroPoliza:`POL-${Date.now()}`};await ot(W(F,"polizas_seguros"),E),await ze(Ne(F,"cotizaciones_seguros",A),{estado:"contratada"}),await f()}catch(x){console.error("Error contracting insurance:",x)}};return d?t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement("div",{className:"animate-pulse"},t.createElement("div",{className:"h-8 bg-gray-300 rounded mb-4"}),t.createElement("div",{className:"space-y-4"},[1,2,3].map(A=>t.createElement("div",{key:A,className:"h-20 bg-gray-300 rounded"}))))):t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement("div",{className:"bg-white rounded-lg shadow-lg p-6"},t.createElement("h1",{className:"text-3xl font-bold text-gray-800 mb-6"},"🛡️ Seguros Automotrices"),t.createElement("div",{className:"flex space-x-4 mb-6 border-b"},t.createElement("button",{className:`pb-2 px-4 ${h==="cotizar"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>C("cotizar")},"Cotizar Seguro"),t.createElement("button",{className:`pb-2 px-4 ${h==="cotizaciones"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>C("cotizaciones")},"Mis Cotizaciones"),t.createElement("button",{className:`pb-2 px-4 ${h==="polizas"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>C("polizas")},"Mis Pólizas"),e==="admin"&&t.createElement("button",{className:`pb-2 px-4 ${h==="admin"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>C("admin")},"Administración")),h==="cotizar"&&t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-blue-50 p-4 rounded-lg"},t.createElement("h3",{className:"text-lg font-semibold mb-2"},"Cotiza tu seguro automotriz"),t.createElement("p",{className:"text-gray-700 mb-4"},"Compara precios de las principales compañías de seguros en Chile"),t.createElement("button",{className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",onClick:()=>w(!0)},"Iniciar Cotización")),t.createElement("div",null,t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Compañías Disponibles"),t.createElement("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4"},n.map(A=>{var N;return t.createElement("div",{key:A.id,className:"border rounded-lg p-4"},t.createElement("div",{className:"flex items-center gap-3 mb-2"},t.createElement("img",{src:A.logo||"/images/default-insurance.png",alt:A.nombre,className:"w-12 h-12 object-contain"}),t.createElement("div",null,t.createElement("h4",{className:"font-semibold"},A.nombre),t.createElement("div",{className:"flex items-center gap-1"},t.createElement("span",{className:"text-yellow-500"},"★"),t.createElement("span",{className:"text-sm"},A.rating||4.5)))),t.createElement("p",{className:"text-sm text-gray-600"},A.descripcion),t.createElement("div",{className:"mt-2 flex flex-wrap gap-1"},(N=A.cobertura)==null?void 0:N.map(x=>t.createElement("span",{key:x,className:"text-xs bg-gray-100 px-2 py-1 rounded"},x))))})))),h==="cotizaciones"&&t.createElement("div",{className:"space-y-4"},t.createElement("h3",{className:"text-lg font-semibold"},"Mis Cotizaciones"),i.length===0?t.createElement("p",{className:"text-gray-500"},"No tienes cotizaciones aún."):i.map(A=>t.createElement("div",{key:A.id,className:"border rounded-lg p-4"},t.createElement("div",{className:"flex justify-between items-start mb-2"},t.createElement("div",null,t.createElement("h4",{className:"font-semibold"},A.vehiculo.marca," ",A.vehiculo.modelo," ",A.vehiculo.año),t.createElement("p",{className:"text-sm text-gray-600"},"Patente: ",A.vehiculo.patente)),t.createElement("span",{className:`px-2 py-1 rounded text-xs ${A.estado==="pendiente"?"bg-yellow-100 text-yellow-800":A.estado==="contratada"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`},A.estado)),t.createElement("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4"},A.companias.map(N=>t.createElement("div",{key:N.id,className:"border rounded p-3"},t.createElement("div",{className:"flex justify-between items-center"},t.createElement("span",{className:"font-medium"},N.nombre),t.createElement("span",{className:"text-lg font-bold text-blue-600"},"$",N.cotizacion.toLocaleString())),A.estado==="pendiente"&&t.createElement("button",{className:"w-full mt-2 bg-green-600 text-white py-1 px-3 rounded text-sm hover:bg-green-700",onClick:()=>I(A.id,N.id)},"Contratar"))))))),h==="polizas"&&t.createElement("div",{className:"space-y-4"},t.createElement("h3",{className:"text-lg font-semibold"},"Mis Pólizas"),c.length===0?t.createElement("p",{className:"text-gray-500"},"No tienes pólizas contratadas."):c.map(A=>t.createElement("div",{key:A.id,className:"border rounded-lg p-4"},t.createElement("div",{className:"flex justify-between items-start mb-4"},t.createElement("div",null,t.createElement("h4",{className:"font-semibold"},"Póliza #",A.numeroPoliza),t.createElement("p",{className:"text-sm text-gray-600"},A.vehiculo.marca," ",A.vehiculo.modelo," ",A.vehiculo.año)),t.createElement("span",{className:`px-2 py-1 rounded text-xs ${A.estado==="activa"?"bg-green-100 text-green-800":A.estado==="vencida"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`},A.estado)),t.createElement("div",{className:"grid md:grid-cols-3 gap-4 text-sm"},t.createElement("div",null,t.createElement("span",{className:"text-gray-600"},"Prima Mensual:"),t.createElement("p",{className:"font-semibold"},"$",(A.prima/12).toLocaleString())),t.createElement("div",null,t.createElement("span",{className:"text-gray-600"},"Inicio:"),t.createElement("p",{className:"font-semibold"},new Date(A.fechaInicio.seconds*1e3).toLocaleDateString())),t.createElement("div",null,t.createElement("span",{className:"text-gray-600"},"Vencimiento:"),t.createElement("p",{className:"font-semibold"},new Date(A.fechaVencimiento.seconds*1e3).toLocaleDateString()))),t.createElement("div",{className:"flex gap-2 mt-4"},t.createElement("button",{className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Ver Detalles"),t.createElement("button",{className:"bg-gray-600 text-white px-4 py-2 rounded text-sm hover:bg-gray-700"},"Descargar Póliza")))))),S&&t.createElement(u$,{onClose:()=>w(!1),onSubmit:b,tiposSeguros:s}))}function u$({onClose:a,onSubmit:e,tiposSeguros:n}){const[r,s]=p.useState({marca:"",modelo:"",año:"",patente:"",valor:"",uso:"particular",region:"",tipoSeguro:""}),o=i=>{i.preventDefault(),e(r)};return t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Datos del Vehículo"),t.createElement("form",{onSubmit:o,className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Marca"),t.createElement("input",{type:"text",className:"w-full border rounded px-3 py-2",value:r.marca,onChange:i=>s(l=>({...l,marca:i.target.value})),required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Modelo"),t.createElement("input",{type:"text",className:"w-full border rounded px-3 py-2",value:r.modelo,onChange:i=>s(l=>({...l,modelo:i.target.value})),required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Año"),t.createElement("input",{type:"number",className:"w-full border rounded px-3 py-2",value:r.año,onChange:i=>s(l=>({...l,año:parseInt(i.target.value)})),min:"1990",max:new Date().getFullYear()+1,required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Patente"),t.createElement("input",{type:"text",className:"w-full border rounded px-3 py-2",value:r.patente,onChange:i=>s(l=>({...l,patente:i.target.value.toUpperCase()})),placeholder:"XXXX00",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Valor del Vehículo (UF)"),t.createElement("input",{type:"number",className:"w-full border rounded px-3 py-2",value:r.valor,onChange:i=>s(l=>({...l,valor:parseInt(i.target.value)})),required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Uso del Vehículo"),t.createElement("select",{className:"w-full border rounded px-3 py-2",value:r.uso,onChange:i=>s(l=>({...l,uso:i.target.value})),required:!0},t.createElement("option",{value:"particular"},"Particular"),t.createElement("option",{value:"comercial"},"Comercial"),t.createElement("option",{value:"taxi"},"Taxi"),t.createElement("option",{value:"uber"},"Uber/Cabify"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Región"),t.createElement("select",{className:"w-full border rounded px-3 py-2",value:r.region,onChange:i=>s(l=>({...l,region:i.target.value})),required:!0},t.createElement("option",{value:""},"Seleccionar región"),t.createElement("option",{value:"RM"},"Región Metropolitana"),t.createElement("option",{value:"V"},"Valparaíso"),t.createElement("option",{value:"VIII"},"Biobío"),t.createElement("option",{value:"IX"},"La Araucanía"),t.createElement("option",{value:"X"},"Los Lagos"))),t.createElement("div",{className:"flex gap-2 pt-4"},t.createElement("button",{type:"button",className:"flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded hover:bg-gray-50",onClick:a},"Cancelar"),t.createElement("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700"},"Cotizar")))))}function _T(){const{user:a,rol:e}=ht(),[n,r]=p.useState([]),[s,o]=p.useState([]),[i,l]=p.useState([]),[c,u]=p.useState(!0),[d,m]=p.useState("agendar"),[h,C]=p.useState(!1),[S,w]=p.useState(null);p.useEffect(()=>{f()},[]);const f=async()=>{try{const A=await le(W(F,"centros_revision"));if(r(A.docs.map(N=>({id:N.id,...N.data()}))),a){const N=fe(W(F,"revisiones_tecnicas"),pe("userId","==",a.uid)),x=await le(N);o(x.docs.map(_=>({id:_.id,..._.data()})));const y=fe(W(F,"vehiculos_usuario"),pe("userId","==",a.uid)),E=await le(y);l(E.docs.map(_=>({id:_.id,..._.data()})))}}catch(A){console.error("Error loading data:",A)}finally{u(!1)}},b=async A=>{try{const N={userId:a.uid,centroId:A.centroId,vehiculoId:A.vehiculoId,fechaCita:A.fecha,horaCita:A.hora,tipoRevision:A.tipo,estado:"agendada",precio:A.precio,fechaCreacion:new Date};await ot(W(F,"revisiones_tecnicas"),N),await f(),C(!1)}catch(N){console.error("Error scheduling revision:",N)}},v=A=>{if(!A)return null;const N=new Date(A.fecha.seconds*1e3);return N.setFullYear(N.getFullYear()+1),N},I=A=>{if(!A)return null;const x=A-new Date;return Math.ceil(x/(1e3*60*60*24))};return c?t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement("div",{className:"animate-pulse"},t.createElement("div",{className:"h-8 bg-gray-300 rounded mb-4"}),t.createElement("div",{className:"space-y-4"},[1,2,3].map(A=>t.createElement("div",{key:A,className:"h-20 bg-gray-300 rounded"}))))):t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement("div",{className:"bg-white rounded-lg shadow-lg p-6"},t.createElement("h1",{className:"text-3xl font-bold text-gray-800 mb-6"},"🔧 Revisión Técnica"),t.createElement("div",{className:"flex space-x-4 mb-6 border-b"},t.createElement("button",{className:`pb-2 px-4 ${d==="agendar"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>m("agendar")},"Agendar Cita"),t.createElement("button",{className:`pb-2 px-4 ${d==="revisiones"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>m("revisiones")},"Mis Revisiones"),t.createElement("button",{className:`pb-2 px-4 ${d==="recordatorios"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>m("recordatorios")},"Recordatorios"),e==="admin"&&t.createElement("button",{className:`pb-2 px-4 ${d==="admin"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>m("admin")},"Administración")),d==="agendar"&&t.createElement("div",{className:"space-y-6"},i.length>0&&t.createElement("div",{className:"bg-yellow-50 p-4 rounded-lg"},t.createElement("h3",{className:"text-lg font-semibold mb-3"},"Estado de tus Vehículos"),t.createElement("div",{className:"space-y-3"},i.map(A=>{const N=s.filter(E=>E.vehiculoId===A.id&&E.estado==="aprobada").sort((E,_)=>{var P,k;return((P=_.fecha)==null?void 0:P.seconds)-((k=E.fecha)==null?void 0:k.seconds)})[0],x=v(N),y=x?I(x):null;return t.createElement("div",{key:A.id,className:"flex justify-between items-center border-b pb-2"},t.createElement("div",null,t.createElement("h4",{className:"font-medium"},A.marca," ",A.modelo," - ",A.patente),t.createElement("p",{className:"text-sm text-gray-600"},N?`Última revisión: ${new Date(N.fecha.seconds*1e3).toLocaleDateString()}`:"Sin revisiones registradas")),t.createElement("div",{className:"text-right"},y!==null&&t.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${y<0?"bg-red-100 text-red-800":y<=30?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`},y<0?"Vencida":y<=30?`${y} días restantes`:"Al día")))}))),t.createElement("div",null,t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Centros de Revisión Técnica"),t.createElement("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4"},n.map(A=>{var N,x;return t.createElement("div",{key:A.id,className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"flex items-start justify-between mb-3"},t.createElement("div",null,t.createElement("h4",{className:"font-semibold"},A.nombre),t.createElement("p",{className:"text-sm text-gray-600"},A.direccion),t.createElement("p",{className:"text-sm text-gray-600"},A.comuna,", ",A.region)),t.createElement("div",{className:"text-right"},t.createElement("div",{className:"flex items-center gap-1"},t.createElement("span",{className:"text-yellow-500"},"★"),t.createElement("span",{className:"text-sm"},A.rating||4.2)),t.createElement("p",{className:"text-sm text-gray-600"},A.distancia||"2.5"," km"))),t.createElement("div",{className:"space-y-2 mb-4"},t.createElement("div",{className:"flex justify-between text-sm"},t.createElement("span",null,"Precio desde:"),t.createElement("span",{className:"font-semibold"},"$",(N=A.precioBase)==null?void 0:N.toLocaleString())),t.createElement("div",{className:"flex justify-between text-sm"},t.createElement("span",null,"Tiempo promedio:"),t.createElement("span",null,A.tiempoPromedio||"45"," min")),t.createElement("div",{className:"flex justify-between text-sm"},t.createElement("span",null,"Horarios:"),t.createElement("span",null,A.horarios||"L-V 8-18, S 8-14"))),t.createElement("div",{className:"flex flex-wrap gap-1 mb-3"},(x=A.servicios)==null?void 0:x.map(y=>t.createElement("span",{key:y,className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded"},y))),t.createElement("button",{className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700",onClick:()=>{w(A),C(!0)}},"Agendar Cita"))})))),d==="revisiones"&&t.createElement("div",{className:"space-y-4"},t.createElement("h3",{className:"text-lg font-semibold"},"Historial de Revisiones"),s.length===0?t.createElement("p",{className:"text-gray-500"},"No tienes revisiones registradas."):t.createElement("div",{className:"space-y-4"},s.sort((A,N)=>{var x,y;return((x=N.fechaCreacion)==null?void 0:x.seconds)-((y=A.fechaCreacion)==null?void 0:y.seconds)}).map(A=>{var y;const N=n.find(E=>E.id===A.centroId),x=i.find(E=>E.id===A.vehiculoId);return t.createElement("div",{key:A.id,className:"border rounded-lg p-4"},t.createElement("div",{className:"flex justify-between items-start mb-3"},t.createElement("div",null,t.createElement("h4",{className:"font-semibold"},x==null?void 0:x.marca," ",x==null?void 0:x.modelo," - ",x==null?void 0:x.patente),t.createElement("p",{className:"text-sm text-gray-600"},N==null?void 0:N.nombre),t.createElement("p",{className:"text-sm text-gray-600"},A.fechaCita&&new Date(A.fechaCita.seconds*1e3).toLocaleDateString(),A.horaCita&&` - ${A.horaCita}`)),t.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${A.estado==="agendada"?"bg-blue-100 text-blue-800":A.estado==="en_proceso"?"bg-yellow-100 text-yellow-800":A.estado==="aprobada"?"bg-green-100 text-green-800":A.estado==="rechazada"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`},A.estado)),t.createElement("div",{className:"grid md:grid-cols-3 gap-4 text-sm"},t.createElement("div",null,t.createElement("span",{className:"text-gray-600"},"Tipo:"),t.createElement("p",{className:"font-medium"},A.tipoRevision)),t.createElement("div",null,t.createElement("span",{className:"text-gray-600"},"Precio:"),t.createElement("p",{className:"font-medium"},"$",(y=A.precio)==null?void 0:y.toLocaleString())),t.createElement("div",null,t.createElement("span",{className:"text-gray-600"},"Resultado:"),t.createElement("p",{className:"font-medium"},A.estado==="aprobada"?"✅ Aprobada":A.estado==="rechazada"?"❌ Rechazada":"⏳ Pendiente"))),A.observaciones&&t.createElement("div",{className:"mt-3 p-3 bg-gray-50 rounded"},t.createElement("span",{className:"text-sm font-medium"},"Observaciones:"),t.createElement("p",{className:"text-sm mt-1"},A.observaciones)),t.createElement("div",{className:"flex gap-2 mt-4"},t.createElement("button",{className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Ver Certificado"),A.estado==="agendada"&&t.createElement("button",{className:"bg-yellow-600 text-white px-4 py-2 rounded text-sm hover:bg-yellow-700"},"Reprogramar")))}))),d==="recordatorios"&&t.createElement("div",{className:"space-y-4"},t.createElement("h3",{className:"text-lg font-semibold"},"Recordatorios de Vencimiento"),t.createElement("div",{className:"bg-blue-50 p-4 rounded-lg"},t.createElement("h4",{className:"font-semibold mb-2"},"Configurar Notificaciones"),t.createElement("div",{className:"space-y-3"},t.createElement("label",{className:"flex items-center gap-2"},t.createElement("input",{type:"checkbox",className:"rounded",defaultChecked:!0}),t.createElement("span",null,"Email 30 días antes del vencimiento")),t.createElement("label",{className:"flex items-center gap-2"},t.createElement("input",{type:"checkbox",className:"rounded",defaultChecked:!0}),t.createElement("span",null,"Email 7 días antes del vencimiento")),t.createElement("label",{className:"flex items-center gap-2"},t.createElement("input",{type:"checkbox",className:"rounded"}),t.createElement("span",null,"SMS 3 días antes del vencimiento")),t.createElement("label",{className:"flex items-center gap-2"},t.createElement("input",{type:"checkbox",className:"rounded"}),t.createElement("span",null,"Notificaciones push en la app"))),t.createElement("button",{className:"mt-3 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"Guardar Preferencias")),t.createElement("div",null,t.createElement("h4",{className:"font-semibold mb-3"},"Próximos Vencimientos"),t.createElement("div",{className:"space-y-3"},i.map(A=>{const N=s.filter(E=>E.vehiculoId===A.id&&E.estado==="aprobada").sort((E,_)=>{var P,k;return((P=_.fecha)==null?void 0:P.seconds)-((k=E.fecha)==null?void 0:k.seconds)})[0],x=v(N),y=x?I(x):null;return x?t.createElement("div",{key:A.id,className:"border rounded-lg p-4"},t.createElement("div",{className:"flex justify-between items-center"},t.createElement("div",null,t.createElement("h5",{className:"font-medium"},A.marca," ",A.modelo," - ",A.patente),t.createElement("p",{className:"text-sm text-gray-600"},"Vence: ",x.toLocaleDateString())),t.createElement("div",{className:"text-right"},t.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${y<0?"bg-red-100 text-red-800":y<=30?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`},y<0?`Vencida hace ${Math.abs(y)} días`:y===0?"Vence hoy":`${y} días restantes`),y<=30&&t.createElement("button",{className:"block mt-2 bg-blue-600 text-white px-3 py-1 rounded text-xs hover:bg-blue-700"},"Agendar Ahora")))):null}))))),h&&S&&t.createElement(d$,{centro:S,vehiculos:i,onClose:()=>C(!1),onSubmit:b}))}function d$({centro:a,vehiculos:e,onClose:n,onSubmit:r}){const[s,o]=p.useState({vehiculoId:"",fecha:"",hora:"",tipo:"anual",precio:a.precioBase||25e3}),[i]=p.useState(["09:00","09:30","10:00","10:30","11:00","11:30","14:00","14:30","15:00","15:30","16:00","16:30"]),l=u=>{u.preventDefault(),r({...s,centroId:a.id})},c=[];for(let u=1;u<=30;u++){const d=new Date;d.setDate(d.getDate()+u),d.getDay()!==0&&c.push(d.toISOString().split("T")[0])}return t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Agendar en ",a.nombre),t.createElement("form",{onSubmit:l,className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Vehículo"),t.createElement("select",{className:"w-full border rounded px-3 py-2",value:s.vehiculoId,onChange:u=>o(d=>({...d,vehiculoId:u.target.value})),required:!0},t.createElement("option",{value:""},"Seleccionar vehículo"),e.map(u=>t.createElement("option",{key:u.id,value:u.id},u.marca," ",u.modelo," - ",u.patente)))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Tipo de Revisión"),t.createElement("select",{className:"w-full border rounded px-3 py-2",value:s.tipo,onChange:u=>o(d=>({...d,tipo:u.target.value})),required:!0},t.createElement("option",{value:"anual"},"Revisión Anual"),t.createElement("option",{value:"semestral"},"Revisión Semestral (Transporte)"),t.createElement("option",{value:"primera_vez"},"Primera Vez"),t.createElement("option",{value:"reinspeccion"},"Reinspección"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Fecha"),t.createElement("select",{className:"w-full border rounded px-3 py-2",value:s.fecha,onChange:u=>o(d=>({...d,fecha:u.target.value})),required:!0},t.createElement("option",{value:""},"Seleccionar fecha"),c.map(u=>{const d=new Date(u);return t.createElement("option",{key:u,value:u},d.toLocaleDateString("es-CL",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))}))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Hora"),t.createElement("select",{className:"w-full border rounded px-3 py-2",value:s.hora,onChange:u=>o(d=>({...d,hora:u.target.value})),required:!0},t.createElement("option",{value:""},"Seleccionar hora"),i.map(u=>t.createElement("option",{key:u,value:u},u)))),t.createElement("div",{className:"bg-gray-50 p-3 rounded"},t.createElement("div",{className:"flex justify-between items-center"},t.createElement("span",{className:"font-medium"},"Total a pagar:"),t.createElement("span",{className:"text-lg font-bold"},"$",s.precio.toLocaleString())),t.createElement("p",{className:"text-xs text-gray-600 mt-1"},"Pago en efectivo o tarjeta en el centro")),t.createElement("div",{className:"flex gap-2 pt-4"},t.createElement("button",{type:"button",className:"flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded hover:bg-gray-50",onClick:n},"Cancelar"),t.createElement("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700"},"Confirmar Cita")))))}function CT(){const{user:a,rol:e}=ht(),[n,r]=p.useState([]),[s,o]=p.useState([]),[i,l]=p.useState([]),[c,u]=p.useState(!0),[d,m]=p.useState("buscar"),[h,C]=p.useState(!1),[S,w]=p.useState(null),[f,b]=p.useState({servicio:"",ubicacion:"",emergencia:!1,precio:""});p.useEffect(()=>{v()},[]);const v=async()=>{try{const N=fe(W(F,"empresas"),pe("rubro","==","Vulcanización"),pe("tipoEmpresa","==","pyme"),pe("estado","==","activa")),y=(await le(N)).docs.map(_=>{const P=_.data();return{id:_.id,...P,nombre:P.nombre||P.razonSocial,direccion:P.direccion,comuna:P.comuna,telefono:P.telefono,email:P.email,horarios:P.horarios||"L-V 8:00-18:00, S 8:00-13:00",servicios:P.servicios||["Parche de Neumático","Cambio de Neumático","Balanceado","Alineación"],precioBase:P.precioBase||15e3,emergencia24h:P.emergencia24h||!1,servicioDomicilio:P.servicioDomicilio||!0,rating:P.rating||4.2,tiempoRespuesta:P.tiempoRespuesta||"20",promociones:P.promociones||!1}});r(y);const E=await le(W(F,"tipos_servicios_vulcanizadora"));if(o(E.docs.map(_=>({id:_.id,..._.data()}))),a){const _=fe(W(F,"servicios_vulcanizadora"),pe("userId","==",a.uid)),P=await le(_);l(P.docs.map(k=>({id:k.id,...k.data()})))}}catch(N){console.error("Error loading data:",N)}finally{u(!1)}},I=async N=>{try{const x={userId:a.uid,vulcanizadoraId:N.vulcanizadoraId,tipoServicio:N.tipoServicio,descripcion:N.descripcion,ubicacion:N.ubicacion,emergencia:N.emergencia,estado:"solicitado",fechaSolicitud:new Date,precioEstimado:N.precioEstimado};await ot(W(F,"servicios_vulcanizadora"),x),await v(),C(!1)}catch(x){console.error("Error requesting service:",x)}},A=n.filter(N=>{var x,y;return!(f.servicio&&!((x=N.servicios)!=null&&x.includes(f.servicio))||f.ubicacion&&!((y=N.comuna)!=null&&y.toLowerCase().includes(f.ubicacion.toLowerCase()))||f.emergencia&&!N.emergencia24h)});return c?t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement("div",{className:"animate-pulse"},t.createElement("div",{className:"h-8 bg-gray-300 rounded mb-4"}),t.createElement("div",{className:"space-y-4"},[1,2,3].map(N=>t.createElement("div",{key:N,className:"h-20 bg-gray-300 rounded"}))))):t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement("div",{className:"bg-white rounded-lg shadow-lg p-6"},t.createElement("h1",{className:"text-3xl font-bold text-gray-800 mb-2"},"🏁 Vulcanizaciones"),t.createElement("p",{className:"text-gray-600 mb-6"},"Encuentra PyMEs especializadas en servicios de vulcanización y neumáticos. Estas empresas forman parte de nuestra red de proveedores locales registrados."),t.createElement("div",{className:"flex space-x-4 mb-6 border-b"},t.createElement("button",{className:`pb-2 px-4 ${d==="buscar"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>m("buscar")},"Buscar Servicios"),t.createElement("button",{className:`pb-2 px-4 ${d==="emergencia"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>m("emergencia")},"🆘 Emergencia"),t.createElement("button",{className:`pb-2 px-4 ${d==="servicios"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>m("servicios")},"Mis Servicios"),e==="admin"&&t.createElement("button",{className:`pb-2 px-4 ${d==="admin"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>m("admin")},"Administración")),d==="buscar"&&t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-gray-50 p-4 rounded-lg"},t.createElement("h3",{className:"font-semibold mb-3"},"Filtrar Servicios"),t.createElement("div",{className:"grid md:grid-cols-4 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Tipo de Servicio"),t.createElement("select",{className:"w-full border rounded px-3 py-2",value:f.servicio,onChange:N=>b(x=>({...x,servicio:N.target.value}))},t.createElement("option",{value:""},"Todos los servicios"),t.createElement("option",{value:"parche"},"Parche de Neumático"),t.createElement("option",{value:"cambio_neumatico"},"Cambio de Neumático"),t.createElement("option",{value:"balanceado"},"Balanceado"),t.createElement("option",{value:"alineacion"},"Alineación"),t.createElement("option",{value:"rotacion"},"Rotación de Neumáticos"),t.createElement("option",{value:"valvula"},"Cambio de Válvula"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Ubicación"),t.createElement("input",{type:"text",className:"w-full border rounded px-3 py-2",placeholder:"Comuna o sector",value:f.ubicacion,onChange:N=>b(x=>({...x,ubicacion:N.target.value}))})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Disponibilidad"),t.createElement("label",{className:"flex items-center gap-2 mt-2"},t.createElement("input",{type:"checkbox",checked:f.emergencia,onChange:N=>b(x=>({...x,emergencia:N.target.checked}))}),t.createElement("span",{className:"text-sm"},"24 horas"))),t.createElement("div",{className:"flex items-end"},t.createElement("button",{className:"w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700",onClick:()=>{}},"Buscar")))),t.createElement("div",null,t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Vulcanizadoras Disponibles (",A.length,")"),A.length===0?t.createElement("div",{className:"text-center py-8"},t.createElement("div",{className:"text-6xl mb-4"},"🏁"),t.createElement("h3",{className:"text-lg font-semibold text-gray-600 mb-2"},"No hay vulcanizadoras disponibles"),t.createElement("p",{className:"text-gray-500 mb-4"},"No se encontraron empresas de vulcanización que coincidan con tus criterios de búsqueda."),t.createElement("p",{className:"text-sm text-gray-400"},"Las vulcanizadoras listadas son PyMEs especializadas en servicios de neumáticos.")):t.createElement("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4"},A.map(N=>{var x,y;return t.createElement("div",{key:N.id,className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"flex items-start justify-between mb-3"},t.createElement("div",null,t.createElement("h4",{className:"font-semibold"},N.nombre),t.createElement("p",{className:"text-sm text-gray-600"},N.direccion),t.createElement("p",{className:"text-sm text-gray-600"},N.comuna),t.createElement("p",{className:"text-sm text-gray-600"},N.telefono)),t.createElement("div",{className:"text-right"},t.createElement("div",{className:"flex items-center gap-1"},t.createElement("span",{className:"text-yellow-500"},"★"),t.createElement("span",{className:"text-sm"},N.rating||4.3)),t.createElement("p",{className:"text-sm text-gray-600"},N.distancia||"1.2"," km"))),t.createElement("div",{className:"mb-3"},t.createElement("div",{className:"flex flex-wrap gap-1"},(x=N.servicios)==null?void 0:x.map(E=>t.createElement("span",{key:E,className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded"},E)))),t.createElement("div",{className:"space-y-1 mb-3 text-sm"},t.createElement("div",{className:"flex justify-between"},t.createElement("span",null,"Horarios:"),t.createElement("span",{className:"font-medium"},N.horarios||"L-S 8-20")),t.createElement("div",{className:"flex justify-between"},t.createElement("span",null,"Tiempo respuesta:"),t.createElement("span",{className:"font-medium"},N.tiempoRespuesta||"15"," min")),t.createElement("div",{className:"flex justify-between"},t.createElement("span",null,"Precio desde:"),t.createElement("span",{className:"font-medium"},"$",(y=N.precioBase)==null?void 0:y.toLocaleString()))),t.createElement("div",{className:"flex gap-1 mb-3"},N.emergencia24h&&t.createElement("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded"},"24h"),N.servicioDomicilio&&t.createElement("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded"},"A domicilio"),N.promociones&&t.createElement("span",{className:"text-xs bg-orange-100 text-orange-800 px-2 py-1 rounded"},"Promociones")),t.createElement("div",{className:"flex gap-2"},t.createElement("button",{className:"flex-1 bg-blue-600 text-white py-2 px-3 rounded text-sm hover:bg-blue-700",onClick:()=>{w(N),C(!0)}},"Solicitar Servicio"),t.createElement("button",{className:"bg-gray-200 text-gray-700 py-2 px-3 rounded text-sm hover:bg-gray-300"},"📞")))})))),d==="emergencia"&&t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6"},t.createElement("div",{className:"flex items-center gap-3 mb-4"},t.createElement("span",{className:"text-4xl"},"🆘"),t.createElement("div",null,t.createElement("h3",{className:"text-xl font-bold text-red-800"},"Servicio de Emergencia"),t.createElement("p",{className:"text-red-700"},"Disponible las 24 horas, los 7 días de la semana"))),t.createElement("div",{className:"grid md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("h4",{className:"font-semibold mb-2"},"¿Qué incluye?"),t.createElement("ul",{className:"space-y-1 text-sm"},t.createElement("li",null,"✅ Asistencia en carretera"),t.createElement("li",null,"✅ Cambio de neumático pinchado"),t.createElement("li",null,"✅ Reparación temporal en sitio"),t.createElement("li",null,"✅ Remolque a vulcanizadora más cercana"),t.createElement("li",null,"✅ Tiempo de respuesta: 15-30 minutos"))),t.createElement("div",null,t.createElement("h4",{className:"font-semibold mb-2"},"Tarifas de Emergencia"),t.createElement("div",{className:"space-y-1 text-sm"},t.createElement("div",{className:"flex justify-between"},t.createElement("span",null,"Servicio base (07:00-22:00):"),t.createElement("span",{className:"font-medium"},"$25.000")),t.createElement("div",{className:"flex justify-between"},t.createElement("span",null,"Recargo nocturno (22:00-07:00):"),t.createElement("span",{className:"font-medium"},"+$10.000")),t.createElement("div",{className:"flex justify-between"},t.createElement("span",null,"Fin de semana/festivos:"),t.createElement("span",{className:"font-medium"},"+$5.000"))))),t.createElement("div",{className:"flex gap-4 mt-6"},t.createElement("button",{className:"bg-red-600 text-white px-6 py-3 rounded-lg text-lg font-semibold hover:bg-red-700"},"🚨 Llamar Emergencia"),t.createElement("button",{className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700"},"📍 Compartir Ubicación"))),t.createElement("div",null,t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Vulcanizadoras 24 Horas"),t.createElement("div",{className:"grid md:grid-cols-2 gap-4"},n.filter(N=>N.emergencia24h).map(N=>t.createElement("div",{key:N.id,className:"border rounded-lg p-4 bg-red-50"},t.createElement("div",{className:"flex justify-between items-start mb-2"},t.createElement("div",null,t.createElement("h4",{className:"font-semibold"},N.nombre),t.createElement("p",{className:"text-sm text-gray-600"},N.comuna)),t.createElement("span",{className:"bg-red-100 text-red-800 px-2 py-1 rounded text-xs"},"24h")),t.createElement("div",{className:"flex justify-between items-center"},t.createElement("div",null,t.createElement("p",{className:"text-sm font-medium"},"📞 ",N.telefono),t.createElement("p",{className:"text-sm text-gray-600"},N.distancia||"2.1"," km")),t.createElement("button",{className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700"},"Llamar"))))))),d==="servicios"&&t.createElement("div",{className:"space-y-4"},t.createElement("h3",{className:"text-lg font-semibold"},"Historial de Servicios"),i.length===0?t.createElement("p",{className:"text-gray-500"},"No tienes servicios registrados."):t.createElement("div",{className:"space-y-4"},i.sort((N,x)=>{var y,E;return((y=x.fechaSolicitud)==null?void 0:y.seconds)-((E=N.fechaSolicitud)==null?void 0:E.seconds)}).map(N=>{var y;const x=n.find(E=>E.id===N.vulcanizadoraId);return t.createElement("div",{key:N.id,className:"border rounded-lg p-4"},t.createElement("div",{className:"flex justify-between items-start mb-3"},t.createElement("div",null,t.createElement("h4",{className:"font-semibold"},x==null?void 0:x.nombre),t.createElement("p",{className:"text-sm text-gray-600"},N.tipoServicio),t.createElement("p",{className:"text-sm text-gray-600"},N.fechaSolicitud&&new Date(N.fechaSolicitud.seconds*1e3).toLocaleString())),t.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${N.estado==="solicitado"?"bg-blue-100 text-blue-800":N.estado==="en_proceso"?"bg-yellow-100 text-yellow-800":N.estado==="completado"?"bg-green-100 text-green-800":N.estado==="cancelado"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`},N.estado)),N.descripcion&&t.createElement("p",{className:"text-sm text-gray-700 mb-3"},N.descripcion),t.createElement("div",{className:"grid md:grid-cols-3 gap-4 text-sm"},t.createElement("div",null,t.createElement("span",{className:"text-gray-600"},"Ubicación:"),t.createElement("p",{className:"font-medium"},N.ubicacion)),t.createElement("div",null,t.createElement("span",{className:"text-gray-600"},"Precio:"),t.createElement("p",{className:"font-medium"},N.precioFinal?`$${N.precioFinal.toLocaleString()}`:`Est. $${(y=N.precioEstimado)==null?void 0:y.toLocaleString()}`)),t.createElement("div",null,t.createElement("span",{className:"text-gray-600"},"Emergencia:"),t.createElement("p",{className:"font-medium"},N.emergencia?"🆘 Sí":"✅ Normal"))),t.createElement("div",{className:"flex gap-2 mt-4"},t.createElement("button",{className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Ver Detalles"),N.estado==="completado"&&t.createElement("button",{className:"bg-yellow-600 text-white px-4 py-2 rounded text-sm hover:bg-yellow-700"},"Calificar Servicio")))})))),h&&S&&t.createElement(m$,{vulcanizadora:S,servicios:s,onClose:()=>C(!1),onSubmit:I}))}function m$({vulcanizadora:a,servicios:e,onClose:n,onSubmit:r}){const[s,o]=p.useState({tipoServicio:"",descripcion:"",ubicacion:"",emergencia:!1,precioEstimado:0}),[i,l]=p.useState(!1),c=d=>{d.preventDefault(),r({...s,vulcanizadoraId:a.id})},u=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(d=>{const{latitude:m,longitude:h}=d.coords;o(C=>({...C,ubicacion:`${m}, ${h}`})),l(!0)},d=>{console.error("Error getting location:",d),alert("No se pudo obtener la ubicación. Por favor, ingresa manualmente.")})};return t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto"},t.createElement("h3",{className:"text-lg font-semibold mb-4"},"Solicitar Servicio - ",a.nombre),t.createElement("form",{onSubmit:c,className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Tipo de Servicio"),t.createElement("select",{className:"w-full border rounded px-3 py-2",value:s.tipoServicio,onChange:d=>{var C;const m=d.target.value,h=((C=a.precios)==null?void 0:C[m])||a.precioBase||15e3;o(S=>({...S,tipoServicio:m,precioEstimado:h}))},required:!0},t.createElement("option",{value:""},"Seleccionar servicio"),t.createElement("option",{value:"parche"},"Parche de Neumático"),t.createElement("option",{value:"cambio_neumatico"},"Cambio de Neumático"),t.createElement("option",{value:"balanceado"},"Balanceado"),t.createElement("option",{value:"alineacion"},"Alineación"),t.createElement("option",{value:"rotacion"},"Rotación de Neumáticos"),t.createElement("option",{value:"valvula"},"Cambio de Válvula"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Descripción del Problema"),t.createElement("textarea",{className:"w-full border rounded px-3 py-2",rows:"3",placeholder:"Describe tu problema o necesidad...",value:s.descripcion,onChange:d=>o(m=>({...m,descripcion:d.target.value})),required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium mb-1"},"Ubicación"),t.createElement("div",{className:"flex gap-2"},t.createElement("input",{type:"text",className:"flex-1 border rounded px-3 py-2",placeholder:"Dirección o coordenadas",value:s.ubicacion,onChange:d=>o(m=>({...m,ubicacion:d.target.value})),required:!0}),t.createElement("button",{type:"button",className:"bg-blue-600 text-white px-3 py-2 rounded hover:bg-blue-700",onClick:u},"📍")),i&&t.createElement("p",{className:"text-xs text-green-600 mt-1"},"✅ Ubicación obtenida automáticamente")),t.createElement("div",null,t.createElement("label",{className:"flex items-center gap-2"},t.createElement("input",{type:"checkbox",checked:s.emergencia,onChange:d=>{const m=d.target.checked;o(h=>({...h,emergencia:m,precioEstimado:m?h.precioEstimado*1.5:h.precioEstimado/1.5}))}}),t.createElement("span",{className:"text-sm"},"🆘 Servicio de emergencia (+50%)"))),t.createElement("div",{className:"bg-gray-50 p-3 rounded"},t.createElement("div",{className:"flex justify-between items-center"},t.createElement("span",{className:"font-medium"},"Precio estimado:"),t.createElement("span",{className:"text-lg font-bold"},"$",Math.round(s.precioEstimado).toLocaleString())),t.createElement("p",{className:"text-xs text-gray-600 mt-1"},"El precio final puede variar según la evaluación técnica")),t.createElement("div",{className:"flex gap-2 pt-4"},t.createElement("button",{type:"button",className:"flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded hover:bg-gray-50",onClick:n},"Cancelar"),t.createElement("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700"},"Solicitar Servicio")))))}const ST=()=>{ht(),p.useState([]),p.useState([]);const a={aceite_usado:{nombre:"Aceite de Motor",descripcion:"Entrega el aceite usado de tu cambio",puntos:50,beneficio:"Descuento en próximo cambio de aceite"},neumaticos:{nombre:"Neumáticos Viejos",descripcion:"Al cambiar neumáticos, entrega los usados",puntos:200,beneficio:"Crédito para alineación o balanceo"},bateria:{nombre:"Batería Agotada",descripcion:"Cambio de batería con reciclaje",puntos:300,beneficio:"Descuento en nueva batería"},filtros:{nombre:"Filtros Usados",descripcion:"Filtros de aceite, aire y combustible",puntos:30,beneficio:"Acumulable para servicios gratuitos"}},e=[{vehiculo:"Toyota Corolla 2018",material:"aceite_usado",fecha_estimada:"2025-02-15",km_actuales:85e3,km_proximo_cambio:9e4},{vehiculo:"Toyota Corolla 2018",material:"neumaticos",fecha_estimada:"2025-06-01",razon:"Desgaste estimado según uso"}];return t.createElement("div",{className:"p-6 bg-gray-50 min-h-screen"},t.createElement("div",{className:"max-w-6xl mx-auto"},t.createElement("div",{className:"bg-gradient-to-r from-green-600 to-blue-600 text-white p-6 rounded-lg mb-6"},t.createElement("h1",{className:"text-2xl font-bold"},"♻️ Mi Centro de Reciclaje"),t.createElement("p",{className:"mt-2"},"Recicla responsablemente y obtén beneficios para tu vehículo")),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},t.createElement("div",{className:"bg-white p-4 rounded-lg shadow"},t.createElement("h3",{className:"text-lg font-semibold text-green-600"},"🏆 Puntos EcoAV10"),t.createElement("p",{className:"text-3xl font-bold"},"1,250"),t.createElement("p",{className:"text-sm text-gray-600"},"Puntos acumulados")),t.createElement("div",{className:"bg-white p-4 rounded-lg shadow"},t.createElement("h3",{className:"text-lg font-semibold text-blue-600"},"💰 Ahorros"),t.createElement("p",{className:"text-3xl font-bold"},"$45,000"),t.createElement("p",{className:"text-sm text-gray-600"},"En descuentos obtenidos")),t.createElement("div",{className:"bg-white p-4 rounded-lg shadow"},t.createElement("h3",{className:"text-lg font-semibold text-purple-600"},"🌱 Impacto"),t.createElement("p",{className:"text-3xl font-bold"},"85 kg"),t.createElement("p",{className:"text-sm text-gray-600"},"CO₂ evitado"))),t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement("h2",{className:"text-xl font-bold mb-4"},"📅 Próximos Reciclajes"),e.map((n,r)=>t.createElement("div",{key:r,className:"border-b py-4 last:border-b-0"},t.createElement("div",{className:"flex justify-between items-start"},t.createElement("div",{className:"flex-1"},t.createElement("h3",{className:"font-semibold"},a[n.material].nombre),t.createElement("p",{className:"text-sm text-gray-600"},n.vehiculo),t.createElement("p",{className:"text-sm text-green-600"},"+",a[n.material].puntos," puntos EcoAV10"),n.km_actuales&&t.createElement("p",{className:"text-sm text-orange-600"},"Próximo cambio en ",n.km_proximo_cambio-n.km_actuales," km")),t.createElement("div",{className:"text-right"},t.createElement("p",{className:"text-sm font-semibold"},n.fecha_estimada),t.createElement("button",{className:"bg-green-600 text-white px-3 py-1 rounded text-sm mt-2 hover:bg-green-700"},"Programar"))))),t.createElement("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg"},t.createElement("h3",{className:"font-semibold text-blue-800"},"💡 Consejo Eco"),t.createElement("p",{className:"text-sm text-blue-700"},"El aceite usado se puede reciclar indefinidamente. ¡Una sola gota puede contaminar 1000 litros de agua!"))),t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement("h2",{className:"text-xl font-bold mb-4"},"🔄 Materiales que Puedes Reciclar"),Object.entries(a).map(([n,r])=>t.createElement("div",{key:n,className:"border-b py-4 last:border-b-0"},t.createElement("div",{className:"flex justify-between items-start"},t.createElement("div",{className:"flex-1"},t.createElement("h3",{className:"font-semibold"},r.nombre),t.createElement("p",{className:"text-sm text-gray-600"},r.descripcion),t.createElement("p",{className:"text-sm text-green-600"},"Beneficio: ",r.beneficio)),t.createElement("div",{className:"text-right"},t.createElement("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-sm"},"+",r.puntos," pts"))))))),t.createElement("div",{className:"bg-white rounded-lg shadow p-6 mt-6"},t.createElement("h2",{className:"text-xl font-bold mb-4"},"📊 Historial de Reciclaje"),t.createElement("div",{className:"overflow-x-auto"},t.createElement("table",{className:"w-full"},t.createElement("thead",null,t.createElement("tr",{className:"border-b"},t.createElement("th",{className:"text-left py-2"},"Fecha"),t.createElement("th",{className:"text-left py-2"},"Material"),t.createElement("th",{className:"text-left py-2"},"Vehículo"),t.createElement("th",{className:"text-left py-2"},"Puntos"),t.createElement("th",{className:"text-left py-2"},"Beneficio"))),t.createElement("tbody",null,t.createElement("tr",{className:"border-b"},t.createElement("td",{className:"py-2"},"12/01/2025"),t.createElement("td",{className:"py-2"},"Aceite de Motor"),t.createElement("td",{className:"py-2"},"Toyota Corolla"),t.createElement("td",{className:"py-2 text-green-600"},"+50"),t.createElement("td",{className:"py-2"},"$5,000 descuento aplicado")),t.createElement("tr",{className:"border-b"},t.createElement("td",{className:"py-2"},"08/01/2025"),t.createElement("td",{className:"py-2"},"Filtro de Aceite"),t.createElement("td",{className:"py-2"},"Toyota Corolla"),t.createElement("td",{className:"py-2 text-green-600"},"+30"),t.createElement("td",{className:"py-2"},"Puntos acumulados")),t.createElement("tr",{className:"border-b"},t.createElement("td",{className:"py-2"},"15/12/2024"),t.createElement("td",{className:"py-2"},"Batería"),t.createElement("td",{className:"py-2"},"Toyota Corolla"),t.createElement("td",{className:"py-2 text-green-600"},"+300"),t.createElement("td",{className:"py-2"},"$15,000 descuento aplicado")))))),t.createElement("div",{className:"bg-white rounded-lg shadow p-6 mt-6"},t.createElement("h2",{className:"text-xl font-bold mb-4"},"🎁 Canjea tus Puntos EcoAV10"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},t.createElement("div",{className:"border rounded-lg p-4"},t.createElement("h3",{className:"font-semibold"},"Cambio de Aceite"),t.createElement("p",{className:"text-sm text-gray-600"},"Servicio completo"),t.createElement("p",{className:"text-lg font-bold text-green-600"},"1,000 puntos"),t.createElement("button",{className:"w-full bg-green-600 text-white py-2 rounded mt-2 hover:bg-green-700"},"Canjear")),t.createElement("div",{className:"border rounded-lg p-4"},t.createElement("h3",{className:"font-semibold"},"Alineación"),t.createElement("p",{className:"text-sm text-gray-600"},"Alineación computarizada"),t.createElement("p",{className:"text-lg font-bold text-blue-600"},"800 puntos"),t.createElement("button",{className:"w-full bg-blue-600 text-white py-2 rounded mt-2 hover:bg-blue-700"},"Canjear")),t.createElement("div",{className:"border rounded-lg p-4"},t.createElement("h3",{className:"font-semibold"},"Revisión Completa"),t.createElement("p",{className:"text-sm text-gray-600"},"Check-up vehicular"),t.createElement("p",{className:"text-lg font-bold text-purple-600"},"600 puntos"),t.createElement("button",{className:"w-full bg-purple-600 text-white py-2 rounded mt-2 hover:bg-purple-700"},"Canjear"))))))},kT=()=>{ht(),p.useState([]),p.useState({notificaciones_email:!0,notificaciones_push:!0,anticipacion_dias:30});const a={permiso_circulacion:{nombre:"Permiso de Circulación",mes_vencimiento:3,icono:"📋",color:"red",recordatorios:[60,30,15,7,1],requisitos:["revision_tecnica","seguro_obligatorio","multas_pagadas"],proveedores:["municipalidad","gestores_automotrices"]},seguro_obligatorio:{nombre:"Seguro Obligatorio",mes_vencimiento:3,icono:"🛡️",color:"blue",recordatorios:[45,20,10,5],requisitos:["vehiculo_vigente"],proveedores:["compañias_seguro"]},revision_tecnica:{nombre:"Revisión Técnica",tipo:"anual",icono:"🔧",color:"green",recordatorios:[60,30,15,7],requisitos:["vehiculo_operativo"],proveedores:["plantas_revision"]},mantenimiento_preventivo:{nombre:"Mantenimiento Preventivo",tipo:"km_o_tiempo",icono:"⚙️",color:"orange",intervalos:{aceite:{km:5e3,meses:6},filtros:{km:15e3,meses:12},frenos:{km:2e4,meses:18},neumaticos:{km:4e4,años:4}}}},e=[{id:1,tipo:"permiso_circulacion",vehiculo:"Toyota Corolla 2018 - ABCD12",fecha_vencimiento:"2025-03-31",dias_restantes:45,estado:"pendiente",acciones_requeridas:[{tarea:"Renovar revisión técnica",completada:!1,vencimiento:"2025-02-28"},{tarea:"Renovar seguro obligatorio",completada:!1,vencimiento:"2025-03-15"},{tarea:"Verificar multas pendientes",completada:!0,fecha_completada:"2025-01-10"}]},{id:2,tipo:"seguro_obligatorio",vehiculo:"Toyota Corolla 2018 - ABCD12",fecha_vencimiento:"2025-03-15",dias_restantes:30,estado:"pendiente",cotizaciones_disponibles:[{compañia:"Mapfre",precio:45e3,cobertura:"SOAP"},{compañia:"Liberty",precio:42e3,cobertura:"SOAP"},{compañia:"HDI",precio:47e3,cobertura:"SOAP + RC"}]},{id:3,tipo:"mantenimiento_preventivo",vehiculo:"Toyota Corolla 2018 - ABCD12",servicio:"Cambio de aceite",km_actual:87500,km_proximo:9e4,fecha_estimada:"2025-02-20",dias_restantes:15,estado:"urgente"}],n=(s,o)=>o==="urgente"?"border-red-500 bg-red-50":o==="proximo"?"border-yellow-500 bg-yellow-50":"border-gray-300 bg-white",r=s=>s<=7?"🚨":s<=15?"⚠️":s<=30?"⏰":"📅";return t.createElement("div",{className:"p-6 bg-gray-50 min-h-screen"},t.createElement("div",{className:"max-w-6xl mx-auto"},t.createElement("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 rounded-lg mb-6"},t.createElement("h1",{className:"text-2xl font-bold"},"🔔 Centro de Recordatorios AV10"),t.createElement("p",{className:"mt-2"},"Mantén tu vehículo al día con recordatorios inteligentes")),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},t.createElement("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-red-500"},t.createElement("h3",{className:"text-lg font-semibold text-red-600"},"🚨 Urgentes"),t.createElement("p",{className:"text-2xl font-bold"},"2"),t.createElement("p",{className:"text-sm text-gray-600"},"Requieren atención inmediata")),t.createElement("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-yellow-500"},t.createElement("h3",{className:"text-lg font-semibold text-yellow-600"},"⚠️ Próximos"),t.createElement("p",{className:"text-2xl font-bold"},"3"),t.createElement("p",{className:"text-sm text-gray-600"},"En los próximos 30 días")),t.createElement("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-green-500"},t.createElement("h3",{className:"text-lg font-semibold text-green-600"},"✅ Completados"),t.createElement("p",{className:"text-2xl font-bold"},"8"),t.createElement("p",{className:"text-sm text-gray-600"},"Este año")),t.createElement("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-blue-500"},t.createElement("h3",{className:"text-lg font-semibold text-blue-600"},"💰 Ahorrado"),t.createElement("p",{className:"text-2xl font-bold"},"$85,000"),t.createElement("p",{className:"text-sm text-gray-600"},"En multas evitadas"))),t.createElement("div",{className:"space-y-4"},e.map(s=>{var o,i;return t.createElement("div",{key:s.id,className:`rounded-lg border-2 p-6 shadow-sm ${n(s.tipo,s.estado)}`},t.createElement("div",{className:"flex items-start justify-between"},t.createElement("div",{className:"flex-1"},t.createElement("div",{className:"flex items-center gap-3 mb-2"},t.createElement("span",{className:"text-2xl"},r(s.dias_restantes)),t.createElement("div",null,t.createElement("h3",{className:"text-lg font-bold"},(o=a[s.tipo])==null?void 0:o.icono," ",(i=a[s.tipo])==null?void 0:i.nombre),t.createElement("p",{className:"text-sm text-gray-600"},s.vehiculo))),s.tipo==="permiso_circulacion"&&t.createElement("div",{className:"mt-4"},t.createElement("h4",{className:"font-semibold mb-2"},"📋 Acciones Requeridas:"),t.createElement("div",{className:"space-y-2"},s.acciones_requeridas.map((l,c)=>t.createElement("div",{key:c,className:"flex items-center gap-2"},t.createElement("input",{type:"checkbox",checked:l.completada,className:"rounded",readOnly:!0}),t.createElement("span",{className:l.completada?"line-through text-gray-500":""},l.tarea),l.vencimiento&&!l.completada&&t.createElement("span",{className:"text-red-600 text-sm"},"(Vence: ",l.vencimiento,")"),l.completada&&t.createElement("span",{className:"text-green-600 text-sm"},"✓ ",l.fecha_completada))))),s.tipo==="seguro_obligatorio"&&t.createElement("div",{className:"mt-4"},t.createElement("h4",{className:"font-semibold mb-2"},"💰 Cotizaciones Disponibles:"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2"},s.cotizaciones_disponibles.map((l,c)=>t.createElement("div",{key:c,className:"border rounded p-3 bg-white"},t.createElement("h5",{className:"font-semibold"},l.compañia),t.createElement("p",{className:"text-green-600 font-bold"},"$",l.precio.toLocaleString()),t.createElement("p",{className:"text-sm text-gray-600"},l.cobertura),t.createElement("button",{className:"w-full bg-blue-600 text-white px-3 py-1 rounded text-sm mt-2 hover:bg-blue-700"},"Contratar"))))),s.tipo==="mantenimiento_preventivo"&&t.createElement("div",{className:"mt-4"},t.createElement("div",{className:"flex items-center gap-4"},t.createElement("div",null,t.createElement("span",{className:"text-sm text-gray-600"},"KM Actual:"),t.createElement("span",{className:"font-bold ml-1"},s.km_actual.toLocaleString())),t.createElement("div",null,t.createElement("span",{className:"text-sm text-gray-600"},"Próximo servicio:"),t.createElement("span",{className:"font-bold ml-1"},s.km_proximo.toLocaleString())),t.createElement("div",null,t.createElement("span",{className:"text-sm text-gray-600"},"Faltan:"),t.createElement("span",{className:"font-bold ml-1 text-orange-600"},s.km_proximo-s.km_actual," km"))))),t.createElement("div",{className:"text-right"},t.createElement("div",{className:"mb-2"},t.createElement("span",{className:"text-sm text-gray-600"},"Vence en:"),t.createElement("p",{className:"text-xl font-bold text-red-600"},s.dias_restantes," días"),t.createElement("p",{className:"text-sm text-gray-600"},s.fecha_vencimiento||s.fecha_estimada)),t.createElement("div",{className:"space-y-2"},t.createElement("button",{className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 w-full"},"Ver Proveedores"),t.createElement("button",{className:"bg-green-600 text-white px-4 py-2 rounded text-sm hover:bg-green-700 w-full"},"Programar"),t.createElement("button",{className:"border border-gray-300 text-gray-700 px-4 py-2 rounded text-sm hover:bg-gray-100 w-full"},"Posponer")))))})),t.createElement("div",{className:"bg-white rounded-lg shadow p-6 mt-6"},t.createElement("h2",{className:"text-xl font-bold mb-4"},"📅 Calendario Marzo 2025 - Renovaciones"),t.createElement("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4"},t.createElement("h3",{className:"font-bold text-red-800"},"🚨 ¡Mes Crítico para Renovaciones!"),t.createElement("p",{className:"text-red-700"},"En marzo vencen permisos de circulación y seguros obligatorios. Programa tus trámites con anticipación para evitar multas.")),t.createElement("div",{className:"grid grid-cols-7 gap-2 text-center"},["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"].map(s=>t.createElement("div",{key:s,className:"font-bold p-2 bg-gray-100 rounded"},s)),Array.from({length:31},(s,o)=>o+1).map(s=>t.createElement("div",{key:s,className:`p-2 border rounded ${s===15?"bg-blue-100 border-blue-500":s===31?"bg-red-100 border-red-500":"border-gray-200"}`},t.createElement("div",{className:"font-semibold"},s),s===15&&t.createElement("div",{className:"text-xs text-blue-700"},"Seguros"),s===31&&t.createElement("div",{className:"text-xs text-red-700"},"Permisos")))))))};function p$(){return t.createElement(er,null,t.createElement(IA,null,t.createElement(De,{index:!0,element:t.createElement(y8,null)}),t.createElement(De,{path:"servicios/seguros",element:t.createElement(wT,null)}),t.createElement(De,{path:"servicios/revision-tecnica",element:t.createElement(_T,null)}),t.createElement(De,{path:"servicios/vulcanizaciones",element:t.createElement(CT,null)}),t.createElement(De,{path:"servicios/reciclaje",element:t.createElement(ST,null)}),t.createElement(De,{path:"recordatorios",element:t.createElement(kT,null)}),t.createElement(De,{path:"empresas",element:t.createElement(_8,null)}),t.createElement(De,{path:"crear-empresa-publica",element:t.createElement(c$,null)}),t.createElement(De,{path:"editar-empresa/:empresaId",element:t.createElement(e$,null)}),t.createElement(De,{path:"editar-solicitud",element:t.createElement(C8,null)}),t.createElement(De,{path:"solicitudes-registro",element:t.createElement(S8,null)}),t.createElement(De,{path:"marcas",element:t.createElement(N8,null)}),t.createElement(De,{path:"tipos-empresa",element:t.createElement(I8,null)}),t.createElement(De,{path:"categorias",element:t.createElement(U8,null)}),t.createElement(De,{path:"solicitudes-cliente",element:t.createElement(V8,null)}),t.createElement(De,{path:"solicitudes-comunidad",element:t.createElement(O8,null)}),t.createElement(De,{path:"notificaciones",element:t.createElement(z8,null)}),t.createElement(De,{path:"validacion-clientes",element:t.createElement($8,null)}),t.createElement(De,{path:"estadisticas",element:t.createElement(B8,null)}),t.createElement(De,{path:"moderacion-reseñas",element:t.createElement(K9,null)}),t.createElement(De,{path:"gestion-tickets",element:t.createElement(J9,null)}),t.createElement(De,{path:"recursos-educativos",element:t.createElement(Y9,null)}),t.createElement(De,{path:"configuracion-sistema",element:t.createElement(H9,null)}),t.createElement(De,{path:"catastro-masivo",element:t.createElement(B9,null)}),t.createElement(De,{path:"panel-validacion",element:t.createElement(G9,null)}),t.createElement(De,{path:"agentes-campo",element:t.createElement(W_,null)}),t.createElement(De,{path:"gestion-agentes",element:t.createElement(W_,null)}),t.createElement(De,{path:"campañas",element:t.createElement(R8,null)}),t.createElement(De,{path:"productos",element:t.createElement(M8,null)}),t.createElement(De,{path:"proveedores",element:t.createElement(l$,null)})))}function g$(){const{user:a,rol:e}=ht(),n=Ct();return p.useEffect(()=>{n(a?e==="admin"?"/admin":e==="proveedor"?"/dashboard/proveedor":e==="agente"?"/agente":e==="mecanico"?"/dashboard/mecanico":e==="cliente"?`/dashboard/cliente/${a.uid}`:`/dashboard/cliente/${a.uid}`:"/login")},[a,e,n]),t.createElement("div",null,"Cargando dashboard...")}function Mi({children:a,rol:e}){const{user:n,rol:r,loading:s}=ht();return console.log("ProtectedRoute - User:",n==null?void 0:n.email,"Required rol:",e,"User rol:",r,"Loading:",s),s?t.createElement("div",{className:"flex items-center justify-center min-h-screen"},t.createElement("div",{className:"text-lg"},"Verificando permisos...")):n?e&&r!==e?(console.log(`ProtectedRoute - Access denied: required ${e}, user has ${r}`),t.createElement("div",{className:"flex items-center justify-center min-h-screen"},t.createElement("div",{className:"text-center"},t.createElement("h2",{className:"text-xl font-bold text-red-600 mb-2"},"Acceso Denegado"),t.createElement("p",{className:"text-gray-600 mb-4"},"Se requiere rol '",e,"' pero tienes rol '",r||"ninguno","'"),t.createElement("button",{onClick:()=>window.history.back(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"Volver")))):(console.log("ProtectedRoute - Access granted"),a):(console.log("ProtectedRoute - Redirecting to login: no user"),t.createElement(kA,{to:"/login"}))}function f$(){const{user:a}=ht(),[e,n]=p.useState(!1),[r,s]=p.useState(!1),[o,i]=p.useState("default");p.useEffect(()=>{"Notification"in window&&i(Notification.permission),l()},[a]);const l=async()=>{if(a)try{const m=localStorage.getItem(`notifications_${a.uid}`);n(m==="true")}catch(m){console.error("Error verificando estado de suscripción:",m)}},c=async()=>{if(!a){alert("Debes estar logueado para recibir notificaciones");return}s(!0);try{const m=await ya.subscribeUser(a.uid,a.rol);if(m.success)n(!0),i("granted"),localStorage.setItem(`notifications_${a.uid}`,"true"),ya.showInAppNotification({title:"🔔 Notificaciones Activadas",body:"Ahora recibirás notificaciones importantes sobre tu cuenta",icon:"/logo192.png"});else throw new Error(m.error)}catch(m){console.error("Error suscribiendo a notificaciones:",m),alert("Error al activar notificaciones: "+m.message)}s(!1)},u=async()=>{if(a){s(!0);try{const m=await ya.unsubscribeUser(a.uid);if(m.success)n(!1),localStorage.removeItem(`notifications_${a.uid}`),ya.showInAppNotification({title:"🔕 Notificaciones Desactivadas",body:"Ya no recibirás notificaciones push",icon:"/logo192.png"});else throw new Error(m.error)}catch(m){console.error("Error desuscribiendo notificaciones:",m),alert("Error al desactivar notificaciones: "+m.message)}s(!1)}},d=m=>{const h={cliente:["🔧 Recordatorios de mantenimiento","📋 Estado de solicitudes","🏪 Nuevos proveedores en tu área","💰 Ofertas especiales"],proveedor:["📬 Nuevas solicitudes de clientes","📊 Reportes de rendimiento","🎯 Nuevas campañas disponibles","✅ Estado de validaciones"],agente:["🏢 Nuevas empresas asignadas","📍 Recordatorios de visitas","📊 Reportes de actividad","🎯 Objetivos y metas"],admin:["🚨 Alertas del sistema","📈 Reportes automáticos","👥 Actividad de usuarios","🔄 Estados de procesos"]};return h[m]||h.cliente};return ya.isSupported?o==="denied"?t.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4"},t.createElement("div",{className:"flex"},t.createElement("div",{className:"flex-shrink-0"},t.createElement("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},t.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))),t.createElement("div",{className:"ml-3"},t.createElement("p",{className:"text-sm text-red-700"},"Las notificaciones están bloqueadas. Para habilitarlas, ve a la configuración de tu navegador.")))):t.createElement("div",{className:"bg-white rounded-lg border border-gray-200 p-6"},t.createElement("div",{className:"flex items-center justify-between mb-4"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"🔔 Notificaciones Push"),t.createElement("div",{className:"flex items-center"},e?t.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},"Activas"):t.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},"Inactivas"))),t.createElement("div",{className:"mb-4"},t.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Recibe notificaciones importantes directamente en tu dispositivo:"),t.createElement("ul",{className:"text-sm text-gray-600 space-y-1"},d(a==null?void 0:a.rol).map((m,h)=>t.createElement("li",{key:h,className:"flex items-start"},t.createElement("span",{className:"mr-2"},"•"),t.createElement("span",null,m))))),t.createElement("div",{className:"flex space-x-3"},e?t.createElement("button",{onClick:u,disabled:r,className:"flex-1 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"},r?t.createElement("div",{className:"flex items-center justify-center"},t.createElement("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},t.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),"Desactivando..."):"Desactivar Notificaciones"):t.createElement("button",{onClick:c,disabled:r,className:"flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"},r?t.createElement("div",{className:"flex items-center justify-center"},t.createElement("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},t.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),"Activando..."):"Activar Notificaciones"),e&&t.createElement("button",{onClick:()=>{ya.showInAppNotification({title:"🧪 Notificación de Prueba",body:"Esta es una notificación de prueba para verificar el funcionamiento del sistema",icon:"/logo192.png"})},className:"px-3 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg text-sm font-medium transition-colors"},"Prueba")),o==="default"&&t.createElement("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg"},t.createElement("p",{className:"text-xs text-blue-700"},"💡 ",t.createElement("strong",null,"Tip:"),' Al activar las notificaciones, tu navegador te pedirá permiso. Asegúrate de hacer clic en "Permitir" para recibir las notificaciones.'))):t.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},t.createElement("div",{className:"flex"},t.createElement("div",{className:"flex-shrink-0"},t.createElement("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},t.createElement("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"}))),t.createElement("div",{className:"ml-3"},t.createElement("p",{className:"text-sm text-yellow-700"},"Las notificaciones push no están disponibles en este navegador."))))}function G_(){const{user:a,rol:e}=ht(),n=Ct(),[r,s]=p.useState(!0),[o,i]=p.useState(null),[l,c]=p.useState([]),[u,d]=p.useState(null),[m,h]=p.useState({observaciones:"",estado_validacion:ce.PENDIENTE_VALIDACION,ubicacion_verificada:!1,documentos_validados:!1,establecimiento_operativo:!1,fotos_subidas:[]}),[C,S]=p.useState(!1),[w,f]=p.useState(!1),[b,v]=p.useState(!1);console.log("🔍 DashboardAgente - User:",a==null?void 0:a.email,"Rol:",e),p.useEffect(()=>{a&&e==="agente"?I():a&&e!=="agente"&&s(!1)},[a,e]);const I=async()=>{try{console.log("🔍 DashboardAgente - loadAgenteData started"),s(!0);const x=fe(W(F,"agentes"),pe("email","==",a.email));console.log("🔍 DashboardAgente - Querying agentes with email:",a.email);const y=await le(x);if(console.log("🔍 DashboardAgente - Agente snapshot size:",y.size),y.empty)console.log("🔍 DashboardAgente - No agente found for email:",a.email),ya.showInAppNotification({title:"⚠️ Agente No Encontrado",body:"No se encontró información de agente para tu cuenta. Contacta al administrador.",icon:"/logo192.png"});else{const E={id:y.docs[0].id,...y.docs[0].data()};console.log("🔍 DashboardAgente - Agente data found:",E),i(E),await A(E.id)}}catch(x){console.error("❌ DashboardAgente - Error loading agente data:",x),ya.showInAppNotification({title:"❌ Error Cargando Datos",body:"No se pudieron cargar los datos del agente",icon:"/logo192.png"})}finally{s(!1)}},A=async x=>{try{console.log("🔍 DashboardAgente - loadEmpresasAsignadas started for agenteId:",x),v(!0);const y=fe(W(F,"empresas"),pe("agenteAsignado","==",x)),E=await le(y);console.log("🔍 DashboardAgente - Empresas snapshot size:",E.size);const _=E.docs.map(P=>({id:P.id,...P.data()}));console.log("🔍 DashboardAgente - Empresas loaded:",_),c(_)}catch(y){console.error("❌ DashboardAgente - Error loading empresas asignadas:",y),ya.showInAppNotification({title:"❌ Error Cargando Empresas",body:"No se pudieron cargar las empresas asignadas",icon:"/logo192.png"})}finally{v(!1)}},N=async x=>{if(x.preventDefault(),!!u){if(m.estado_validacion===ce.ACTIVA&&(!o.permisos||!o.permisos.activar_empresas)){ya.showInAppNotification({title:"⚠️ Permisos Insuficientes",body:"No tienes permisos para activar empresas. Contacta al administrador.",icon:"/logo192.png"});return}f(!0);try{const y={estado:m.estado_validacion,validacion_agente:{agente_id:o.id,agente_nombre:o.nombre,fecha_visita:sa(),observaciones:m.observaciones,ubicacion_verificada:m.ubicacion_verificada,documentos_validados:m.documentos_validados,establecimiento_operativo:m.establecimiento_operativo,fotos_subidas:m.fotos_subidas},fecha_ultima_validacion:sa()};m.estado_validacion===ce.ACTIVA&&(y.validada=!0,y.fecha_validacion=sa()),await ze(Ne(F,"empresas",u.id),y),await ot(W(F,"visitas_campo"),{empresa_id:u.id,empresa_nombre:u.nombre,agente_id:o.id,agente_nombre:o.nombre,fecha_visita:sa(),estado_validacion:m.estado_validacion,observaciones:m.observaciones,ubicacion_verificada:m.ubicacion_verificada,documentos_validados:m.documentos_validados,establecimiento_operativo:m.establecimiento_operativo,fotos_subidas:m.fotos_subidas}),ya.showInAppNotification({title:"✅ Validación Completada",body:`Empresa ${u.nombre} validada exitosamente`,icon:"/logo192.png"}),await A(o.id),S(!1),d(null),h({observaciones:"",estado_validacion:ce.PENDIENTE_VALIDACION,ubicacion_verificada:!1,documentos_validados:!1,establecimiento_operativo:!1,fotos_subidas:[]})}catch(y){console.error("Error submitting validation:",y),ya.showInAppNotification({title:"❌ Error en Validación",body:"No se pudo completar la validación. Intenta nuevamente.",icon:"/logo192.png"})}finally{f(!1)}}};return r?(console.log("🔍 DashboardAgente - Rendering loading state"),t.createElement(er,null,t.createElement("div",{className:"flex items-center justify-center h-64"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})))):e!=="agente"?(console.log("🔍 DashboardAgente - Rendering access denied, rol:",e),t.createElement(er,null,t.createElement("div",{className:"text-center p-8"},t.createElement("h2",{className:"text-2xl font-bold text-red-600 mb-4"},"Acceso Denegado"),t.createElement("p",{className:"text-gray-600"},"Solo agentes de campo pueden acceder a esta sección.")))):(console.log("🔍 DashboardAgente - Rendering main dashboard, agente:",o),t.createElement(er,null,t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Panel de Agente de Campo"),t.createElement("p",{className:"text-gray-600 mt-1"},o==null?void 0:o.nombre," - Zona: ",o==null?void 0:o.zona)),t.createElement("div",{className:"text-right"},t.createElement("div",{className:"text-sm text-gray-500"},"Última actividad"),t.createElement("div",{className:"text-lg font-semibold text-gray-900"},new Date().toLocaleDateString())))),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6"},t.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"p-2 bg-blue-100 rounded-lg"},t.createElement("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"}))),t.createElement("div",{className:"ml-4"},t.createElement("p",{className:"text-sm font-medium text-gray-600"},"Empresas Asignadas"),t.createElement("p",{className:"text-2xl font-bold text-gray-900"},l.length)))),t.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"p-2 bg-green-100 rounded-lg"},t.createElement("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"}))),t.createElement("div",{className:"ml-4"},t.createElement("p",{className:"text-sm font-medium text-gray-600"},"Validadas"),t.createElement("p",{className:"text-2xl font-bold text-gray-900"},l.filter(x=>x.estado===ce.VALIDADA).length)))),t.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"p-2 bg-yellow-100 rounded-lg"},t.createElement("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"}))),t.createElement("div",{className:"ml-4"},t.createElement("p",{className:"text-sm font-medium text-gray-600"},"Pendientes"),t.createElement("p",{className:"text-2xl font-bold text-gray-900"},l.filter(x=>x.estado===ce.PENDIENTE_VALIDACION).length))))),t.createElement("div",{className:"bg-white rounded-lg shadow-sm"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Empresas Asignadas"),t.createElement("p",{className:"text-sm text-gray-600"},"Gestiona las validaciones de campo")),t.createElement("button",{onClick:()=>n("/agente/nueva-empresa"),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium"},"+ Registrar Nueva Empresa"))),t.createElement("div",{className:"overflow-x-auto"},t.createElement("table",{className:"min-w-full divide-y divide-gray-200"},t.createElement("thead",{className:"bg-gray-50"},t.createElement("tr",null,t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Empresa"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Dirección"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Teléfono"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),t.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},b?t.createElement("tr",null,t.createElement("td",{colSpan:"5",className:"px-6 py-8 text-center"},t.createElement("div",{className:"flex items-center justify-center"},t.createElement("svg",{className:"animate-spin h-6 w-6 text-blue-600 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},t.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),"Cargando empresas..."))):l.length===0?t.createElement("tr",null,t.createElement("td",{colSpan:"5",className:"px-6 py-8 text-center"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-gray-400 mb-4"},t.createElement("svg",{className:"mx-auto h-12 w-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"}))),t.createElement("p",{className:"text-gray-500 mb-4"},"No tienes empresas asignadas actualmente."),t.createElement("button",{onClick:()=>n("/agente/nueva-empresa"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},"Registrar Primera Empresa")))):l.map(x=>t.createElement("tr",{key:x.id,className:"hover:bg-gray-50"},t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"flex-shrink-0 h-10 w-10"},t.createElement(h$,{logo:x.logo_url||x.logo,nombre:x.nombre})),t.createElement("div",{className:"ml-4"},t.createElement("div",{className:"text-sm font-medium text-gray-900"},x.nombre),t.createElement("div",{className:"text-sm text-gray-500"},x.tipo)))),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${x.estado===ce.ACTIVA?"bg-green-100 text-green-800":x.estado===ce.PENDIENTE_VALIDACION?"bg-yellow-100 text-yellow-800":x.estado===ce.VALIDADA?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`},x.estado===ce.ACTIVA?"Activa":x.estado===ce.PENDIENTE_VALIDACION?"Pendiente":x.estado===ce.VALIDADA?"Validada":"Inactiva")),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},x.direccion||"No especificada"),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},x.telefono||"No especificado"),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},t.createElement("div",{className:"flex space-x-2"},t.createElement("button",{onClick:()=>n(`/agente/empresa/${x.id}`),className:"text-blue-600 hover:text-blue-900 font-medium"},"Ver Detalle"),t.createElement("button",{onClick:()=>{d(x),S(!0)},className:"text-green-600 hover:text-green-900 font-medium"},"Validar"))))))))),C&&u&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},t.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-hidden"},t.createElement("div",{className:"flex justify-between items-center p-6 border-b border-gray-200"},t.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Validar Empresa: ",u.nombre),t.createElement("button",{type:"button",onClick:()=>S(!1),className:"text-gray-400 hover:text-gray-600 transition-colors"},t.createElement("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})))),t.createElement("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]"},t.createElement("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg"},t.createElement("h3",{className:"font-semibold text-gray-900 mb-2"},"Información de la Empresa"),t.createElement("div",{className:"grid grid-cols-2 gap-4 text-sm"},t.createElement("div",null,t.createElement("span",{className:"font-medium"},"Nombre:")," ",u.nombre),t.createElement("div",null,t.createElement("span",{className:"font-medium"},"Tipo:")," ",u.tipo),t.createElement("div",null,t.createElement("span",{className:"font-medium"},"Dirección:")," ",u.direccion||"No especificada"),t.createElement("div",null,t.createElement("span",{className:"font-medium"},"Teléfono:")," ",u.telefono||"No especificado"))),t.createElement("form",{onSubmit:N,className:"space-y-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Estado de Validación"),t.createElement("select",{value:m.estado_validacion,onChange:x=>h({...m,estado_validacion:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:ce.PENDIENTE_VALIDACION},"Pendiente de Validación"),t.createElement("option",{value:ce.EN_VISITA},"En Visita"),t.createElement("option",{value:ce.VALIDADA},"Validada"),t.createElement("option",{value:ce.ACTIVA},"Activa"),t.createElement("option",{value:ce.RECHAZADA},"Rechazada"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-3"},"Checklist de Validación"),t.createElement("div",{className:"space-y-3"},t.createElement("label",{className:"flex items-center"},t.createElement("input",{type:"checkbox",checked:m.ubicacion_verificada,onChange:x=>h({...m,ubicacion_verificada:x.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),t.createElement("span",{className:"ml-2 text-sm text-gray-700"},"Ubicación verificada")),t.createElement("label",{className:"flex items-center"},t.createElement("input",{type:"checkbox",checked:m.documentos_validados,onChange:x=>h({...m,documentos_validados:x.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),t.createElement("span",{className:"ml-2 text-sm text-gray-700"},"Documentos validados")),t.createElement("label",{className:"flex items-center"},t.createElement("input",{type:"checkbox",checked:m.establecimiento_operativo,onChange:x=>h({...m,establecimiento_operativo:x.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),t.createElement("span",{className:"ml-2 text-sm text-gray-700"},"Establecimiento operativo")))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Observaciones"),t.createElement("textarea",{value:m.observaciones,onChange:x=>h({...m,observaciones:x.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe los detalles de la visita y validación..."})),t.createElement("div",{className:"flex justify-end space-x-3 pt-4"},t.createElement("button",{type:"button",onClick:()=>S(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"},"Cancelar"),t.createElement("button",{type:"submit",disabled:w,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:bg-blue-400 disabled:cursor-not-allowed"},w?t.createElement("div",{className:"flex items-center justify-center"},t.createElement("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},t.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),"Guardando..."):"Guardar Validación")))))))))}function h$({logo:a,nombre:e}){const{imageUrl:n,loading:r,error:s}=ui(a);return a?r?t.createElement("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center"},t.createElement("div",{className:"w-4 h-4 border-2 border-gray-400 border-t-blue-600 rounded-full animate-spin"})):s||!n?t.createElement("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center"},t.createElement("span",{className:"text-xs text-gray-500"},"!")):t.createElement("img",{className:"h-10 w-10 rounded-full object-cover",src:n,alt:e,onError:o=>{o.target.style.display="none",o.target.nextSibling.style.display="flex"}}):t.createElement("img",{className:"h-10 w-10 rounded-full object-cover bg-gray-200",src:"/images/no-image-placeholder.png",alt:e})}function v$(){const{user:a,rol:e}=ht(),n=Ct(),[r,s]=p.useState(!1),[o,i]=p.useState({nombre:"",email:"",telefono:"",direccion:"",ciudad:"",region:"",web:"",categoria:"",tipo:"Taller Mecánico",descripcion:"",representante:{nombre:"",apellidos:"",email:"",telefono:"",cargo:"",cedula:""},servicios:[],marcas:[],horarios:{},estado:"activa",validada:!0,fecha_validacion:sa(),agente_validador:(a==null?void 0:a.email)||"",notas_validacion:""}),[l,c]=p.useState(""),[u,d]=p.useState("");if(e!=="agente")return t.createElement(er,null,t.createElement("div",{className:"text-center p-8"},t.createElement("h2",{className:"text-2xl font-bold text-red-600 mb-4"},"Acceso Denegado"),t.createElement("p",{className:"text-gray-600"},"Solo agentes de campo pueden acceder a esta sección.")));const m=b=>{const{name:v,value:I}=b.target;if(v.includes(".")){const[A,N]=v.split(".");i(x=>({...x,[A]:{...x[A],[N]:I}}))}else i(A=>({...A,[v]:I}))},h=()=>{l.trim()&&(i(b=>({...b,servicios:[...b.servicios,l.trim()]})),c(""))},C=b=>{i(v=>({...v,servicios:v.servicios.filter((I,A)=>A!==b)}))},S=()=>{u.trim()&&(i(b=>({...b,marcas:[...b.marcas,u.trim()]})),d(""))},w=b=>{i(v=>({...v,marcas:v.marcas.filter((I,A)=>A!==b)}))},f=async b=>{var v;b.preventDefault(),s(!0);try{const I=fe(W(F,"agentes"),pe("email","==",a.email)),N=(v=(await le(I)).docs[0])==null?void 0:v.id,x={...o,agenteAsignado:N,fecha_creacion:sa(),fecha_validacion:sa(),validada:!0,estado:"activa",agente_validador:a.email,agente_validador_id:N};await ot(W(F,"empresas"),x),ya.showInAppNotification({title:"✅ Empresa Registrada",body:`La empresa ${o.nombre} ha sido registrada exitosamente`,icon:"/logo192.png"}),n("/agente/empresas-asignadas")}catch(I){console.error("Error registering empresa:",I),ya.showInAppNotification({title:"❌ Error al Registrar",body:"No se pudo registrar la empresa. Intenta nuevamente.",icon:"/logo192.png"})}finally{s(!1)}};return t.createElement(er,null,t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"✅ Registrar Empresa Validada"),t.createElement("p",{className:"text-gray-600 mt-1"},"Registra una nueva empresa que has validado en terreno")),t.createElement("button",{onClick:()=>n("/agente/empresas-asignadas"),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors"},"← Volver"))),t.createElement("div",{className:"bg-white rounded-lg shadow-sm"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Información de la Empresa"),t.createElement("p",{className:"text-sm text-gray-600"},"Completa todos los campos requeridos")),t.createElement("form",{onSubmit:f,className:"p-6 space-y-6"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombre de la Empresa *"),t.createElement("input",{type:"text",name:"nombre",value:o.nombre,onChange:m,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tipo de Empresa"),t.createElement("select",{name:"tipo",value:o.tipo,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"Taller Mecánico"},"Taller Mecánico"),t.createElement("option",{value:"Repuestos"},"Repuestos"),t.createElement("option",{value:"Lubricentro"},"Lubricentro"),t.createElement("option",{value:"Vulcanización"},"Vulcanización"),t.createElement("option",{value:"Seguros"},"Seguros"),t.createElement("option",{value:"Revisión Técnica"},"Revisión Técnica"),t.createElement("option",{value:"Otro"},"Otro"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email"),t.createElement("input",{type:"email",name:"email",value:o.email,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono *"),t.createElement("input",{type:"tel",name:"telefono",value:o.telefono,onChange:m,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Dirección *"),t.createElement("input",{type:"text",name:"direccion",value:o.direccion,onChange:m,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Ciudad"),t.createElement("input",{type:"text",name:"ciudad",value:o.ciudad,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Región"),t.createElement("input",{type:"text",name:"region",value:o.region,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Sitio Web"),t.createElement("input",{type:"url",name:"web",value:o.web,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Categoría"),t.createElement("input",{type:"text",name:"categoria",value:o.categoria,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Descripción"),t.createElement("textarea",{name:"descripcion",value:o.descripcion,onChange:m,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe los servicios y características de la empresa..."})),t.createElement("div",{className:"border-t pt-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Información del Representante"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombre"),t.createElement("input",{type:"text",name:"representante.nombre",value:o.representante.nombre,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Apellidos"),t.createElement("input",{type:"text",name:"representante.apellidos",value:o.representante.apellidos,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email"),t.createElement("input",{type:"email",name:"representante.email",value:o.representante.email,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono"),t.createElement("input",{type:"tel",name:"representante.telefono",value:o.representante.telefono,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Cargo"),t.createElement("input",{type:"text",name:"representante.cargo",value:o.representante.cargo,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Cédula"),t.createElement("input",{type:"text",name:"representante.cedula",value:o.representante.cedula,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})))),t.createElement("div",{className:"border-t pt-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Servicios"),t.createElement("div",{className:"flex gap-2 mb-4"},t.createElement("input",{type:"text",value:l,onChange:b=>c(b.target.value),placeholder:"Agregar servicio...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.createElement("button",{type:"button",onClick:h,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"},"Agregar")),t.createElement("div",{className:"flex flex-wrap gap-2"},o.servicios.map((b,v)=>t.createElement("span",{key:v,className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm flex items-center gap-2"},b,t.createElement("button",{type:"button",onClick:()=>C(v),className:"text-blue-600 hover:text-blue-800"},"×"))))),t.createElement("div",{className:"border-t pt-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Marcas"),t.createElement("div",{className:"flex gap-2 mb-4"},t.createElement("input",{type:"text",value:u,onChange:b=>d(b.target.value),placeholder:"Agregar marca...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.createElement("button",{type:"button",onClick:S,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700"},"Agregar")),t.createElement("div",{className:"flex flex-wrap gap-2"},o.marcas.map((b,v)=>t.createElement("span",{key:v,className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm flex items-center gap-2"},b,t.createElement("button",{type:"button",onClick:()=>w(v),className:"text-green-600 hover:text-green-800"},"×"))))),t.createElement("div",{className:"border-t pt-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Notas de Validación"),t.createElement("textarea",{name:"notas_validacion",value:o.notas_validacion,onChange:m,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe los detalles de la validación realizada en terreno..."})),t.createElement("div",{className:"flex justify-end space-x-3 pt-6 border-t"},t.createElement("button",{type:"button",onClick:()=>n("/agente/empresas-asignadas"),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"},"Cancelar"),t.createElement("button",{type:"submit",disabled:r,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium disabled:bg-green-400 disabled:cursor-not-allowed"},r?t.createElement("div",{className:"flex items-center justify-center"},t.createElement("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},t.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),"Registrando..."):"Registrar Empresa"))))))}const IT={"Arica y Parinacota":["Arica","Camarones","Putre","General Lagos"],Tarapacá:["Iquique","Alto Hospicio","Pozo Almonte","Camiña","Colchane","Huara","Pica"],Antofagasta:["Antofagasta","Mejillones","Sierra Gorda","Taltal","Calama","Ollagüe","San Pedro de Atacama","Tocopilla","María Elena"],Atacama:["Copiapó","Caldera","Tierra Amarilla","Chañaral","Diego de Almagro","Vallenar","Alto del Carmen","Freirina","Huasco"],Coquimbo:["La Serena","Coquimbo","Andacollo","La Higuera","Paiguano","Vicuña","Illapel","Canela","Los Vilos","Salamanca","Ovalle","Combarbalá","Monte Patria","Punitaqui","Río Hurtado"],Valparaíso:["Valparaíso","Casablanca","Concón","Juan Fernández","Puchuncaví","Quintero","Viña del Mar","Isla de Pascua","Los Andes","Calle Larga","Rinconada","San Esteban","La Ligua","Cabildo","Papudo","Petorca","Zapallar","Quillota","Calera","Hijuelas","La Cruz","Nogales","San Antonio","Algarrobo","Cartagena","El Quisco","El Tabo","Santo Domingo","San Felipe","Catemu","Llaillay","Panquehue","Putaendo","Santa María","Quilpué","Limache","Olmué","Villa Alemana"],Metropolitana:["Santiago","Cerrillos","Cerro Navia","Conchalí","El Bosque","Estación Central","Huechuraba","Independencia","La Cisterna","La Florida","La Granja","La Pintana","La Reina","Las Condes","Lo Barnechea","Lo Espejo","Lo Prado","Macul","Maipú","Ñuñoa","Pedro Aguirre Cerda","Peñalolén","Providencia","Pudahuel","Quilicura","Quinta Normal","Recoleta","Renca","San Joaquín","San Miguel","San Ramón","Vitacura","Puente Alto","Pirque","San José de Maipo","Colina","Lampa","Tiltil","San Bernardo","Buin","Calera de Tango","Paine","Melipilla","Alhué","Curacaví","María Pinto","San Pedro","Talagante","El Monte","Isla de Maipo","Padre Hurtado","Peñaflor"],"O'Higgins":["Rancagua","Codegua","Coinco","Coltauco","Doñihue","Graneros","Las Cabras","Machalí","Malloa","Mostazal","Olivar","Peumo","Pichidegua","Quinta de Tilcoco","Rengo","Requínoa","San Vicente","Pichilemu","La Estrella","Litueche","Marchihue","Navidad","Paredones","San Fernando","Chépica","Chimbarongo","Lolol","Nancagua","Palmilla","Peralillo","Placilla","Pumanque","Santa Cruz"],Maule:["Talca","Constitución","Curepto","Empedrado","Maule","Pelarco","Pencahue","Río Claro","San Clemente","San Rafael","Cauquenes","Chanco","Pelluhue","Curicó","Hualañé","Licantén","Molina","Rauco","Romeral","Sagrada Familia","Teno","Vichuquén","Linares","Colbún","Longaví","Parral","Retiro","San Javier","Villa Alegre","Yerbas Buenas"],Ñuble:["Chillán","Bulnes","Cobquecura","Coelemu","Coihueco","Chillán Viejo","El Carmen","Ninhue","Ñiquén","Pemuco","Pinto","Portezuelo","Quillón","Quirihue","Ránquil","San Carlos","San Fabián","San Ignacio","San Nicolás","Treguaco","Yungay"],Biobío:["Concepción","Coronel","Chiguayante","Florida","Hualqui","Lota","Penco","San Pedro de la Paz","Santa Juana","Talcahuano","Tomé","Hualpén","Lebu","Arauco","Cañete","Contulmo","Curanilahue","Los Álamos","Tirúa","Los Ángeles","Antuco","Cabrero","Laja","Mulchén","Nacimiento","Negrete","Quilaco","Quilleco","San Rosendo","Santa Bárbara","Tucapel","Yumbel","Alto Biobío"],"La Araucanía":["Temuco","Carahue","Cunco","Curarrehue","Freire","Galvarino","Gorbea","Lautaro","Loncoche","Melipeuco","Nueva Imperial","Padre Las Casas","Perquenco","Pitrufquén","Pucón","Saavedra","Teodoro Schmidt","Toltén","Vilcún","Villarrica","Cholchol","Angol","Collipulli","Curacautín","Ercilla","Lonquimay","Los Sauces","Lumaco","Purén","Renaico","Traiguén","Victoria"],"Los Ríos":["Valdivia","Corral","Lanco","Los Lagos","Máfil","Mariquina","Paillaco","Panguipulli","La Unión","Futrono","Lago Ranco","Río Bueno"],"Los Lagos":["Puerto Montt","Calbuco","Cochamó","Fresia","Frutillar","Los Muermos","Llanquihue","Maullín","Puerto Varas","Castro","Ancud","Chonchi","Curaco de Vélez","Dalcahue","Puqueldón","Queilén","Quellón","Quemchi","Quinchao","Osorno","Puerto Octay","Purranque","Puyehue","Río Negro","San Juan de la Costa","San Pablo","Chaitén","Futaleufú","Hualaihué","Palena"],Aysén:["Coyhaique","Lago Verde","Aysén","Cisnes","Guaitecas","Cochrane","O'Higgins","Tortel","Chile Chico","Río Ibáñez"],Magallanes:["Punta Arenas","Laguna Blanca","Río Verde","San Gregorio","Cabo de Hornos","Antártica","Porvenir","Primavera","Timaukel","Natales","Torres del Paine"]},b$=()=>Object.keys(IT),H_=a=>IT[a]||[];function E$(){const a=Ct(),[e,n]=p.useState(1),[r,s]=p.useState({nombres:"",apellidos:"",rut:"",telefono:"",email:"",direccion:"",comuna:"",ciudad:"",region:"",fecha_nacimiento:"",profesion:"",empresa:"",motivo_registro:"",servicios_interes:[],acepta_terminos:!1,acepta_notificaciones:!0,password:"",confirm_password:""}),[o,i]=p.useState({}),[l,c]=p.useState(!1),[u,d]=p.useState(!1),[m,h]=p.useState(5),[C,S]=p.useState([]),[w,f]=p.useState([]);p.useEffect(()=>{S(b$())},[]),p.useEffect(()=>{r.region?(f(H_(r.region)),r.comuna&&!H_(r.region).includes(r.comuna)&&s(x=>({...x,comuna:""}))):f([])},[r.region]);const b=x=>{const{name:y,value:E,type:_,checked:P}=x.target;s(_==="checkbox"?y==="servicios_interes"?k=>({...k,servicios_interes:P?[...k.servicios_interes,E]:k.servicios_interes.filter(D=>D!==E)}):k=>({...k,[y]:P}):k=>({...k,[y]:E})),o[y]&&i(k=>({...k,[y]:""}))},v=()=>{const x={};return e===1?(r.nombres.trim()||(x.nombres="Los nombres son obligatorios"),r.apellidos.trim()||(x.apellidos="Los apellidos son obligatorios"),r.rut.trim()||(x.rut="El RUT es obligatorio"),r.telefono.trim()||(x.telefono="El teléfono es obligatorio"),r.email.trim()||(x.email="El email es obligatorio"),r.email&&!/\S+@\S+\.\S+/.test(r.email)&&(x.email="El email no es válido")):e===2?(r.direccion.trim()||(x.direccion="La dirección es obligatoria"),r.comuna.trim()||(x.comuna="La comuna es obligatoria"),r.ciudad.trim()||(x.ciudad="La ciudad es obligatoria"),r.region.trim()||(x.region="La región es obligatoria")):e===3?(r.fecha_nacimiento||(x.fecha_nacimiento="La fecha de nacimiento es obligatoria"),r.motivo_registro.trim()||(x.motivo_registro="El motivo de registro es obligatorio"),r.servicios_interes.length===0&&(x.servicios_interes="Selecciona al menos un servicio de interés")):e===4&&(r.password||(x.password="La contraseña es obligatoria"),r.password&&r.password.length<6&&(x.password="La contraseña debe tener al menos 6 caracteres"),r.password!==r.confirm_password&&(x.confirm_password="Las contraseñas no coinciden"),r.acepta_terminos||(x.acepta_terminos="Debes aceptar los términos y condiciones")),i(x),Object.keys(x).length===0},I=()=>{v()&&n(x=>x+1)},A=()=>{n(x=>x-1)},N=async x=>{if(x.preventDefault(),!!v()){c(!0);try{const y=fe(W(F,"solicitudes_cliente"),pe("email","==",r.email));if(!(await le(y)).empty){i({email:"Ya existe una solicitud con este email"}),c(!1);return}const{password:_,confirm_password:P,...k}=r,D={...k,fecha_solicitud:new Date,estado_general:"enviada",etapa_actual:"validacion_datos",progreso_porcentaje:0,etapas:{validacion_datos:{estado:"pendiente",fecha_inicio:new Date,fecha_fin:null,comentarios:"",responsable:null},confirmacion_final:{estado:"pendiente",fecha_inicio:null,fecha_fin:null,comentarios:"",responsable:null}},documentos_adjuntos:[],notas_admin:"",agente_asignado:null,fecha_entrevista:null,puntuacion_evaluacion:null,motivo_rechazo:"",fecha_aprobacion:null,ip_registro:window.location.hostname,user_agent:navigator.userAgent,referencia:"web_directa",tipo_registro:"sin_auth",password_hash:btoa(r.password)},M=await ot(W(F,"solicitudes_cliente"),D);await Ws.createInAppNotification("admin","validacion","Nueva Solicitud de Cliente",`${r.nombres} ${r.apellidos} ha enviado una solicitud de registro`,{solicitudId:M.id,clienteNombre:`${r.nombres} ${r.apellidos}`,clienteEmail:r.email,etapaActual:"revision_inicial",origen:"registro_cliente"}),d(!0);const $=setInterval(()=>{h(q=>q<=1?(clearInterval($),a("/"),0):q-1)},1e3)}catch(y){console.error("Error creating client request:",y),alert("Error al enviar la solicitud. Por favor, intenta nuevamente.")}finally{c(!1)}}};return u?t.createElement("div",{className:"text-center space-y-6"},t.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6"},t.createElement("div",{className:"text-6xl mb-4"},"✅"),t.createElement("h2",{className:"text-2xl font-bold text-green-800 mb-2"},"¡Solicitud enviada exitosamente!"),t.createElement("p",{className:"text-green-700 mb-4"},"Hemos recibido tu solicitud de registro y será procesada en las próximas 24-48 horas."),t.createElement("div",{className:"bg-white border border-green-200 rounded-lg p-4 mb-4"},t.createElement("h3",{className:"font-semibold text-green-800 mb-2"},"¿Qué sigue ahora?"),t.createElement("div",{className:"text-sm text-green-700 text-left space-y-1"},t.createElement("p",null,"1. 📋 Nuestro equipo revisará tu información"),t.createElement("p",null,"2. ✉️ Te contactaremos por email para confirmar datos"),t.createElement("p",null,"3. 👤 Se te asignará un agente de campo local"),t.createElement("p",null,"4. 📞 Programaremos una breve entrevista (opcional)"),t.createElement("p",null,"5. 🎉 Una vez aprobado, recibirás tus credenciales de acceso"))),t.createElement("div",{className:"space-y-3"},t.createElement("p",{className:"text-sm text-green-600"},"📧 Te enviaremos actualizaciones a: ",t.createElement("strong",null,r.email)),t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4"},t.createElement("p",{className:"text-blue-800 text-center"},"🔄 Serás redirigido al inicio en ",t.createElement("strong",null,m)," segundos...")),t.createElement("div",{className:"flex gap-3 justify-center"},t.createElement("button",{onClick:()=>a("/"),className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors"},"Ir al Inicio Ahora"),t.createElement("button",{onClick:()=>a("/registro-proveedor"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors"},"Registrar Proveedor"))))):t.createElement("form",{onSubmit:e===4?N:x=>{x.preventDefault(),I()}},e===1&&t.createElement("div",{className:"space-y-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Información Personal"),t.createElement("div",{className:"grid md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombres *"),t.createElement("input",{type:"text",name:"nombres",value:r.nombres,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.nombres?"border-red-500":"border-gray-300"}`,placeholder:"Ingresa tus nombres"}),o.nombres&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},o.nombres)),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Apellidos *"),t.createElement("input",{type:"text",name:"apellidos",value:r.apellidos,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.apellidos?"border-red-500":"border-gray-300"}`,placeholder:"Ingresa tus apellidos"}),o.apellidos&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},o.apellidos)),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"RUT *"),t.createElement("input",{type:"text",name:"rut",value:r.rut,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.rut?"border-red-500":"border-gray-300"}`,placeholder:"12.345.678-9"}),o.rut&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},o.rut)),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono *"),t.createElement("input",{type:"tel",name:"telefono",value:r.telefono,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.telefono?"border-red-500":"border-gray-300"}`,placeholder:"+56 9 1234 5678"}),o.telefono&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},o.telefono)),t.createElement("div",{className:"md:col-span-2"},t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email *"),t.createElement("input",{type:"email",name:"email",value:r.email,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.email?"border-red-500":"border-gray-300"}`,placeholder:"tu@email.com"}),o.email&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},o.email)))),e===2&&t.createElement("div",{className:"space-y-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Información de Residencia"),t.createElement("div",{className:"space-y-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Dirección *"),t.createElement("input",{type:"text",name:"direccion",value:r.direccion,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.direccion?"border-red-500":"border-gray-300"}`,placeholder:"Calle, número, departamento"}),o.direccion&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},o.direccion)),t.createElement("div",{className:"grid md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Comuna *"),t.createElement("input",{type:"text",name:"comuna",value:r.comuna,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.comuna?"border-red-500":"border-gray-300"}`,placeholder:"Tu comuna"}),o.comuna&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},o.comuna)),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Ciudad *"),t.createElement("input",{type:"text",name:"ciudad",value:r.ciudad,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.ciudad?"border-red-500":"border-gray-300"}`,placeholder:"Tu ciudad"}),o.ciudad&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},o.ciudad))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Región *"),t.createElement("select",{name:"region",value:r.region,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.region?"border-red-500":"border-gray-300"}`},t.createElement("option",{value:""},"Selecciona tu región"),t.createElement("option",{value:"Arica y Parinacota"},"Arica y Parinacota"),t.createElement("option",{value:"Tarapacá"},"Tarapacá"),t.createElement("option",{value:"Antofagasta"},"Antofagasta"),t.createElement("option",{value:"Atacama"},"Atacama"),t.createElement("option",{value:"Coquimbo"},"Coquimbo"),t.createElement("option",{value:"Valparaíso"},"Valparaíso"),t.createElement("option",{value:"Metropolitana"},"Metropolitana"),t.createElement("option",{value:"O'Higgins"},"O'Higgins"),t.createElement("option",{value:"Maule"},"Maule"),t.createElement("option",{value:"Ñuble"},"Ñuble"),t.createElement("option",{value:"Biobío"},"Biobío"),t.createElement("option",{value:"La Araucanía"},"La Araucanía"),t.createElement("option",{value:"Los Ríos"},"Los Ríos"),t.createElement("option",{value:"Los Lagos"},"Los Lagos"),t.createElement("option",{value:"Aysén"},"Aysén"),t.createElement("option",{value:"Magallanes"},"Magallanes")),o.region&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},o.region)))),e===3&&t.createElement("div",{className:"space-y-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Información Adicional"),t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"grid md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Fecha de Nacimiento *"),t.createElement("input",{type:"date",name:"fecha_nacimiento",value:r.fecha_nacimiento,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.fecha_nacimiento?"border-red-500":"border-gray-300"}`}),o.fecha_nacimiento&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},o.fecha_nacimiento)),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Profesión"),t.createElement("input",{type:"text",name:"profesion",value:r.profesion,onChange:b,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Tu profesión"}))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Empresa (Opcional)"),t.createElement("input",{type:"text",name:"empresa",value:r.empresa,onChange:b,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre de tu empresa"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Motivo de Registro *"),t.createElement("textarea",{name:"motivo_registro",value:r.motivo_registro,onChange:b,rows:3,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.motivo_registro?"border-red-500":"border-gray-300"}`,placeholder:"Cuéntanos por qué quieres registrarte en nuestra plataforma"}),o.motivo_registro&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},o.motivo_registro)),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-3"},"Servicios de Interés *"),t.createElement("div",{className:"grid md:grid-cols-2 gap-3"},["Repuestos y Autopartes","Mantención Preventiva","Reparaciones Mecánicas","Seguros Automotrices","Revisión Técnica","Vulcanización","Servicios de Emergencia","Reciclaje de Vehículos"].map(x=>t.createElement("label",{key:x,className:"flex items-center space-x-2"},t.createElement("input",{type:"checkbox",name:"servicios_interes",value:x,checked:r.servicios_interes.includes(x),onChange:b,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),t.createElement("span",{className:"text-sm text-gray-700"},x)))),o.servicios_interes&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},o.servicios_interes)))),e===4&&t.createElement("div",{className:"space-y-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Credenciales y Confirmación"),t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},t.createElement("h3",{className:"font-semibold text-blue-900 mb-2"},"Configura tu contraseña"),t.createElement("p",{className:"text-sm text-blue-800"},"Esta contraseña se usará para crear tu cuenta una vez que tu solicitud sea aprobada.")),t.createElement("div",{className:"grid md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña *"),t.createElement("input",{type:"password",name:"password",value:r.password,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.password?"border-red-500":"border-gray-300"}`,placeholder:"Mínimo 6 caracteres"}),o.password&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},o.password)),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirmar Contraseña *"),t.createElement("input",{type:"password",name:"confirm_password",value:r.confirm_password,onChange:b,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.confirm_password?"border-red-500":"border-gray-300"}`,placeholder:"Repite tu contraseña"}),o.confirm_password&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},o.confirm_password))),t.createElement("div",{className:"bg-gray-50 rounded-lg p-6"},t.createElement("h3",{className:"font-semibold text-lg mb-4"},"Resumen de tu información:"),t.createElement("div",{className:"grid md:grid-cols-2 gap-4 text-sm"},t.createElement("div",null,t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Nombre:")," ",r.nombres," ",r.apellidos),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"RUT:")," ",r.rut),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Email:")," ",r.email),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Teléfono:")," ",r.telefono),r.profesion&&t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Profesión:")," ",r.profesion)),t.createElement("div",null,t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Dirección:")," ",r.direccion),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Comuna:")," ",r.comuna),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Ciudad:")," ",r.ciudad),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Región:")," ",r.region),r.empresa&&t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Empresa:")," ",r.empresa)))),t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("input",{type:"checkbox",name:"acepta_terminos",checked:r.acepta_terminos,onChange:b,className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),t.createElement("label",{className:"text-sm text-gray-700"},"Acepto los ",t.createElement("a",{href:"/terminos",target:"_blank",className:"text-blue-600 hover:underline"},"términos y condiciones")," de AV10 de Julio *")),o.acepta_terminos&&t.createElement("p",{className:"text-red-500 text-sm"},o.acepta_terminos),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("input",{type:"checkbox",name:"acepta_notificaciones",checked:r.acepta_notificaciones,onChange:b,className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),t.createElement("label",{className:"text-sm text-gray-700"},"Acepto recibir notificaciones sobre recordatorios, ofertas y novedades de la plataforma"))),t.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},t.createElement("h4",{className:"font-semibold text-green-900 mb-2"},"¿Qué sigue después?"),t.createElement("div",{className:"text-sm text-green-800 space-y-1"},t.createElement("p",null,"1. Recibirás un email de confirmación inmediatamente"),t.createElement("p",null,"2. Tu solicitud será revisada en 24-48 horas"),t.createElement("p",null,"3. Te contactaremos para validar la información"),t.createElement("p",null,"4. Se te asignará un agente de campo de tu zona"),t.createElement("p",null,"5. Una vez aprobado, se activará tu cuenta con la contraseña elegida")))),t.createElement("div",{className:"flex justify-between mt-8"},e>1&&t.createElement("button",{type:"button",onClick:A,className:"bg-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-400 transition-colors"},"← Anterior"),t.createElement("div",{className:"flex-1"}),t.createElement("div",{className:"flex-1 flex justify-center items-center"},t.createElement("div",{className:"flex space-x-2"},[1,2,3,4].map(x=>t.createElement("div",{key:x,className:`w-3 h-3 rounded-full ${x<=e?"bg-blue-600":"bg-gray-300"}`}))),t.createElement("span",{className:"ml-3 text-sm text-gray-600"},"Paso ",e," de 4")),t.createElement("div",{className:"flex-1 flex justify-end"},e<4?t.createElement("button",{type:"button",onClick:I,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors"},"Siguiente →"):t.createElement("button",{type:"submit",disabled:l,className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50"},l?"Enviando Solicitud...":"📨 Enviar Solicitud"))))}function x$(){const{user:a}=ht(),e=Ct(),[n,r]=p.useState(null),[s,o]=p.useState(!0),[i,l]=p.useState(1),[c,u]=p.useState({nombres:"",apellidos:"",rut:"",telefono:"",email:"",direccion:"",comuna:"",ciudad:"",region:"",fecha_nacimiento:"",profesion:"",empresa:"",motivo_registro:"",servicios_interes:[],acepta_terminos:!1,acepta_notificaciones:!0}),[d,m]=p.useState({}),[h,C]=p.useState(!1),[S,w]=p.useState(null);p.useEffect(()=>{(async()=>{if(!a){o(!1);return}try{const x=fe(W(F,"perfiles_clientes"),pe("uid","==",a.uid)),y=await le(x);if(y.empty){const E=fe(W(F,"solicitudes_cliente"),pe("uid","==",a.uid)),_=await le(E);if(!_.empty){const P={id:_.docs[0].id,..._.docs[0].data()};w(P)}}else{const E=y.docs[0].data();r(E)}}catch(x){console.error("Error checking existing profile:",x)}finally{o(!1)}})()},[a]);const f=N=>{const{name:x,value:y,type:E,checked:_}=N.target;u(E==="checkbox"?x==="servicios_interes"?P=>({...P,servicios_interes:_?[...P.servicios_interes,y]:P.servicios_interes.filter(k=>k!==y)}):P=>({...P,[x]:_}):P=>({...P,[x]:y})),d[x]&&m(P=>({...P,[x]:""}))},b=()=>{const N={};return i===1?(c.nombres.trim()||(N.nombres="Los nombres son obligatorios"),c.apellidos.trim()||(N.apellidos="Los apellidos son obligatorios"),c.rut.trim()||(N.rut="El RUT es obligatorio"),c.telefono.trim()||(N.telefono="El teléfono es obligatorio"),c.email.trim()||(N.email="El email es obligatorio"),c.email&&!/\S+@\S+\.\S+/.test(c.email)&&(N.email="El email no es válido")):i===2?(c.direccion.trim()||(N.direccion="La dirección es obligatoria"),c.comuna.trim()||(N.comuna="La comuna es obligatoria"),c.ciudad.trim()||(N.ciudad="La ciudad es obligatoria"),c.region.trim()||(N.region="La región es obligatoria")):i===3?(c.fecha_nacimiento||(N.fecha_nacimiento="La fecha de nacimiento es obligatoria"),c.motivo_registro.trim()||(N.motivo_registro="El motivo de registro es obligatorio"),c.servicios_interes.length===0&&(N.servicios_interes="Selecciona al menos un servicio de interés")):i===4&&(c.acepta_terminos||(N.acepta_terminos="Debes aceptar los términos y condiciones")),m(N),Object.keys(N).length===0},v=()=>{b()&&l(N=>N+1)},I=()=>{l(N=>N-1)},A=async N=>{if(N.preventDefault(),!!b()){C(!0);try{const x={...c,uid:a.uid,email_usuario:a.email,fecha_solicitud:new Date,estado_general:"enviada",etapa_actual:"revision_inicial",progreso_porcentaje:10,etapas:{revision_inicial:{estado:"pendiente",fecha_inicio:new Date,fecha_fin:null,comentarios:"",responsable:null},validacion_datos:{estado:"pendiente",fecha_inicio:null,fecha_fin:null,comentarios:"",responsable:null},asignacion_agente:{estado:"pendiente",fecha_inicio:null,fecha_fin:null,comentarios:"",responsable:null},entrevista:{estado:"pendiente",fecha_inicio:null,fecha_fin:null,comentarios:"",responsable:null},aprobacion_final:{estado:"pendiente",fecha_inicio:null,fecha_fin:null,comentarios:"",responsable:null}},documentos_adjuntos:[],notas_admin:"",agente_asignado:null,fecha_entrevista:null,puntuacion_evaluacion:null,motivo_rechazo:"",fecha_aprobacion:null,ip_registro:window.location.hostname,user_agent:navigator.userAgent,referencia:"web_directa"},y=await ot(W(F,"solicitudes_cliente"),x);await Ws.createInAppNotification("admin","validacion","Nueva Solicitud de Cliente",`${c.nombres} ${c.apellidos} ha enviado una solicitud de registro`,{solicitudId:y.id,clienteNombre:`${c.nombres} ${c.apellidos}`,clienteEmail:c.email,etapaActual:"revision_inicial",origen:"registro_cliente"}),w({id:y.id,...x,estado_general:"enviada"})}catch(x){console.error("Error creating client request:",x),alert("Error al enviar la solicitud. Por favor, intenta nuevamente.")}finally{C(!1)}}};return a?s?t.createElement("div",{className:"min-h-screen flex items-center justify-center"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),t.createElement("p",{className:"text-gray-600"},"Cargando..."))):t.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},t.createElement("div",{className:"max-w-2xl mx-auto px-4"},t.createElement("div",{className:"bg-white rounded-lg shadow-md p-8"},t.createElement("div",{className:"text-center mb-8"},t.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Registro de Cliente"),t.createElement("p",{className:"text-gray-600"},"Completa tu perfil para acceder a todos nuestros servicios")),n?t.createElement("div",{className:"text-center space-y-4"},t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6"},t.createElement("h2",{className:"text-xl font-semibold text-blue-800 mb-2"},"¡Tu perfil ya está registrado!"),t.createElement("p",{className:"text-blue-600 mb-4"},"Estado: ",t.createElement("span",{className:"font-medium capitalize"},n.estado_validacion)),n.estado_validacion==="pendiente"&&t.createElement("p",{className:"text-sm text-blue-600 mb-4"},"Tu perfil está siendo revisado por nuestro equipo. Te notificaremos cuando esté aprobado."),n.estado_validacion==="validado"&&t.createElement("p",{className:"text-sm text-green-600 mb-4"},"¡Tu perfil ha sido validado! Ya puedes acceder a tu dashboard."),t.createElement("div",{className:"space-y-2"},t.createElement("button",{onClick:()=>e("/dashboard"),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors"},"Ir al Dashboard")))):S?t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6"},t.createElement("h2",{className:"text-xl font-semibold text-blue-800 mb-4"},"Tu solicitud está en proceso"),t.createElement("div",{className:"flex items-center justify-between mb-6"},t.createElement("div",null,t.createElement("p",{className:"text-sm text-gray-600"},"Estado de solicitud:"),t.createElement("span",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium ${S.estado_general==="enviada"?"bg-blue-100 text-blue-800":S.estado_general==="en_revision"?"bg-yellow-100 text-yellow-800":S.estado_general==="aprobada"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},S.estado_general==="enviada"?"Enviada":S.estado_general==="en_revision"?"En Revisión":S.estado_general==="aprobada"?"Aprobada":"Rechazada")),t.createElement("div",{className:"text-right"},t.createElement("p",{className:"text-sm text-gray-600"},"Progreso:"),t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"w-24 bg-gray-200 rounded-full h-2 mr-2"},t.createElement("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${S.progreso_porcentaje}%`}})),t.createElement("span",{className:"text-sm font-medium text-blue-600"},S.progreso_porcentaje,"%")))),t.createElement("div",{className:"space-y-4"},t.createElement("h3",{className:"font-semibold text-gray-900"},"Etapas del proceso:"),Object.entries(S.etapas||{}).map(([N,x],y)=>{const E={revision_inicial:"1. Revisión Inicial",validacion_datos:"2. Validación de Datos",asignacion_agente:"3. Asignación de Agente",entrevista:"4. Entrevista",aprobacion_final:"5. Aprobación Final"};return t.createElement("div",{key:N,className:"flex items-center space-x-3"},t.createElement("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${x.estado==="completada"?"bg-green-500 text-white":x.estado==="en_proceso"?"bg-blue-500 text-white":x.estado==="rechazada"?"bg-red-500 text-white":"bg-gray-300 text-gray-600"}`},x.estado==="completada"?"✓":x.estado==="rechazada"?"✗":y+1),t.createElement("div",{className:"flex-1"},t.createElement("p",{className:"font-medium text-gray-900"},E[N]),t.createElement("p",{className:"text-sm text-gray-600"},x.estado==="completada"?"Completada":x.estado==="en_proceso"?"En proceso":x.estado==="rechazada"?"Rechazada":"Pendiente",x.fecha_fin&&` - ${new Date(x.fecha_fin.toDate()).toLocaleDateString()}`),x.comentarios&&t.createElement("p",{className:"text-sm text-blue-600 mt-1"},x.comentarios)))})),S.estado_general==="enviada"&&t.createElement("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg"},t.createElement("p",{className:"text-sm text-blue-800"},"📋 Tu solicitud ha sido recibida y será revisada en las próximas 24-48 horas.")),S.agente_asignado&&t.createElement("div",{className:"mt-6 p-4 bg-green-50 rounded-lg"},t.createElement("p",{className:"text-sm text-green-800"},"👤 Agente asignado: ",S.agente_asignado.nombre),S.fecha_entrevista&&t.createElement("p",{className:"text-sm text-green-700 mt-1"},"📅 Entrevista programada: ",new Date(S.fecha_entrevista.toDate()).toLocaleDateString())),t.createElement("div",{className:"mt-6 text-center"},t.createElement("button",{onClick:()=>e("/dashboard"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors"},"Ver Mi Dashboard")))):t.createElement("form",{onSubmit:i===4?A:N=>{N.preventDefault(),v()}},i===1&&t.createElement("div",{className:"space-y-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Información Personal"),t.createElement("div",{className:"grid md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombres *"),t.createElement("input",{type:"text",name:"nombres",value:c.nombres,onChange:f,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.nombres?"border-red-500":"border-gray-300"}`,placeholder:"Ingresa tus nombres"}),d.nombres&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},d.nombres)),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Apellidos *"),t.createElement("input",{type:"text",name:"apellidos",value:c.apellidos,onChange:f,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.apellidos?"border-red-500":"border-gray-300"}`,placeholder:"Ingresa tus apellidos"}),d.apellidos&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},d.apellidos)),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"RUT *"),t.createElement("input",{type:"text",name:"rut",value:c.rut,onChange:f,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.rut?"border-red-500":"border-gray-300"}`,placeholder:"12.345.678-9"}),d.rut&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},d.rut)),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono *"),t.createElement("input",{type:"tel",name:"telefono",value:c.telefono,onChange:f,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.telefono?"border-red-500":"border-gray-300"}`,placeholder:"+56 9 1234 5678"}),d.telefono&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},d.telefono)),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email *"),t.createElement("input",{type:"email",name:"email",value:c.email,onChange:f,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.email?"border-red-500":"border-gray-300"}`,placeholder:"tu@email.com"}),d.email&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},d.email)))),i===2&&t.createElement("div",{className:"space-y-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Información de Residencia"),t.createElement("div",{className:"space-y-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Dirección *"),t.createElement("input",{type:"text",name:"direccion",value:c.direccion,onChange:f,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.direccion?"border-red-500":"border-gray-300"}`,placeholder:"Calle, número, departamento"}),d.direccion&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},d.direccion)),t.createElement("div",{className:"grid md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Comuna *"),t.createElement("input",{type:"text",name:"comuna",value:c.comuna,onChange:f,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.comuna?"border-red-500":"border-gray-300"}`,placeholder:"Tu comuna"}),d.comuna&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},d.comuna)),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Ciudad *"),t.createElement("input",{type:"text",name:"ciudad",value:c.ciudad,onChange:f,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.ciudad?"border-red-500":"border-gray-300"}`,placeholder:"Tu ciudad"}),d.ciudad&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},d.ciudad))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Región *"),t.createElement("select",{name:"region",value:c.region,onChange:f,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.region?"border-red-500":"border-gray-300"}`},t.createElement("option",{value:""},"Selecciona tu región"),t.createElement("option",{value:"Arica y Parinacota"},"Arica y Parinacota"),t.createElement("option",{value:"Tarapacá"},"Tarapacá"),t.createElement("option",{value:"Antofagasta"},"Antofagasta"),t.createElement("option",{value:"Atacama"},"Atacama"),t.createElement("option",{value:"Coquimbo"},"Coquimbo"),t.createElement("option",{value:"Valparaíso"},"Valparaíso"),t.createElement("option",{value:"Metropolitana"},"Metropolitana"),t.createElement("option",{value:"O'Higgins"},"O'Higgins"),t.createElement("option",{value:"Maule"},"Maule"),t.createElement("option",{value:"Ñuble"},"Ñuble"),t.createElement("option",{value:"Biobío"},"Biobío"),t.createElement("option",{value:"La Araucanía"},"La Araucanía"),t.createElement("option",{value:"Los Ríos"},"Los Ríos"),t.createElement("option",{value:"Los Lagos"},"Los Lagos"),t.createElement("option",{value:"Aysén"},"Aysén"),t.createElement("option",{value:"Magallanes"},"Magallanes")),d.region&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},d.region)))),i===3&&t.createElement("div",{className:"space-y-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Información Adicional"),t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"grid md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Fecha de Nacimiento *"),t.createElement("input",{type:"date",name:"fecha_nacimiento",value:c.fecha_nacimiento,onChange:f,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.fecha_nacimiento?"border-red-500":"border-gray-300"}`}),d.fecha_nacimiento&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},d.fecha_nacimiento)),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Profesión"),t.createElement("input",{type:"text",name:"profesion",value:c.profesion,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Tu profesión"}))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Empresa (Opcional)"),t.createElement("input",{type:"text",name:"empresa",value:c.empresa,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre de tu empresa"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Motivo de Registro *"),t.createElement("textarea",{name:"motivo_registro",value:c.motivo_registro,onChange:f,rows:3,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.motivo_registro?"border-red-500":"border-gray-300"}`,placeholder:"Cuéntanos por qué quieres registrarte en nuestra plataforma"}),d.motivo_registro&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},d.motivo_registro)),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-3"},"Servicios de Interés *"),t.createElement("div",{className:"grid md:grid-cols-2 gap-3"},["Repuestos y Autopartes","Mantención Preventiva","Reparaciones Mecánicas","Seguros Automotrices","Revisión Técnica","Vulcanización","Servicios de Emergencia","Reciclaje de Vehículos"].map(N=>t.createElement("label",{key:N,className:"flex items-center space-x-2"},t.createElement("input",{type:"checkbox",name:"servicios_interes",value:N,checked:c.servicios_interes.includes(N),onChange:f,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),t.createElement("span",{className:"text-sm text-gray-700"},N)))),d.servicios_interes&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},d.servicios_interes)))),i===4&&t.createElement("div",{className:"space-y-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Credenciales y Confirmación"),t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},t.createElement("h3",{className:"font-semibold text-blue-900 mb-2"},"Configura tu contraseña"),t.createElement("p",{className:"text-sm text-blue-800"},"Esta contraseña se usará para crear tu cuenta una vez que tu solicitud sea aprobada.")),t.createElement("div",{className:"grid md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña *"),t.createElement("input",{type:"password",name:"password",value:c.password,onChange:f,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.password?"border-red-500":"border-gray-300"}`,placeholder:"Mínimo 6 caracteres"}),d.password&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},d.password)),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirmar Contraseña *"),t.createElement("input",{type:"password",name:"confirm_password",value:c.confirm_password,onChange:f,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.confirm_password?"border-red-500":"border-gray-300"}`,placeholder:"Repite tu contraseña"}),d.confirm_password&&t.createElement("p",{className:"text-red-500 text-sm mt-1"},d.confirm_password))),t.createElement("div",{className:"bg-gray-50 rounded-lg p-6"},t.createElement("h3",{className:"font-semibold text-lg mb-4"},"Resumen de tu información:"),t.createElement("div",{className:"grid md:grid-cols-2 gap-4 text-sm"},t.createElement("div",null,t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Nombre:")," ",c.nombres," ",c.apellidos),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"RUT:")," ",c.rut),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Email:")," ",c.email),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Teléfono:")," ",c.telefono),c.profesion&&t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Profesión:")," ",c.profesion)),t.createElement("div",null,t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Dirección:")," ",c.direccion),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Comuna:")," ",c.comuna),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Ciudad:")," ",c.ciudad),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Región:")," ",c.region),c.empresa&&t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Empresa:")," ",c.empresa)))),t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("input",{type:"checkbox",name:"acepta_terminos",checked:c.acepta_terminos,onChange:f,className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),t.createElement("label",{className:"text-sm text-gray-700"},"Acepto los ",t.createElement("a",{href:"/terminos",target:"_blank",className:"text-blue-600 hover:underline"},"términos y condiciones")," de AV10 de Julio *")),d.acepta_terminos&&t.createElement("p",{className:"text-red-500 text-sm"},d.acepta_terminos),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("input",{type:"checkbox",name:"acepta_notificaciones",checked:c.acepta_notificaciones,onChange:f,className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),t.createElement("label",{className:"text-sm text-gray-700"},"Acepto recibir notificaciones sobre recordatorios, ofertas y novedades de la plataforma"))),t.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},t.createElement("h4",{className:"font-semibold text-green-900 mb-2"},"¿Qué sigue después?"),t.createElement("div",{className:"text-sm text-green-800 space-y-1"},t.createElement("p",null,"1. Recibirás un email de confirmación inmediatamente"),t.createElement("p",null,"2. Tu solicitud será revisada en 24-48 horas"),t.createElement("p",null,"3. Te contactaremos para validar la información"),t.createElement("p",null,"4. Se te asignará un agente de campo de tu zona"),t.createElement("p",null,"5. Una vez aprobado, se activará tu cuenta con la contraseña elegida")))),t.createElement("div",{className:"flex justify-between mt-8"},i>1&&t.createElement("button",{type:"button",onClick:I,className:"bg-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-400 transition-colors"},"← Anterior"),t.createElement("div",{className:"flex-1"}),t.createElement("div",{className:"flex-1 flex justify-center items-center"},t.createElement("div",{className:"flex space-x-2"},[1,2,3,4].map(N=>t.createElement("div",{key:N,className:`w-3 h-3 rounded-full ${N<=i?"bg-blue-600":"bg-gray-300"}`}))),t.createElement("span",{className:"ml-3 text-sm text-gray-600"},"Paso ",i," de 4")),t.createElement("div",{className:"flex-1 flex justify-end"},i<4?t.createElement("button",{type:"button",onClick:v,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors"},"Siguiente →"):t.createElement("button",{type:"submit",disabled:h,className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50"},h?"Enviando Solicitud...":"📨 Enviar Solicitud"))))))):t.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},t.createElement("div",{className:"max-w-2xl mx-auto px-4"},t.createElement("div",{className:"bg-white rounded-lg shadow-md p-8"},t.createElement("div",{className:"text-center mb-8"},t.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Registro de Cliente"),t.createElement("p",{className:"text-gray-600"},"Completa tu información para solicitar acceso a nuestros servicios"),t.createElement("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg"},t.createElement("p",{className:"text-sm text-blue-800"},"ℹ️ No necesitas tener una cuenta para enviar tu solicitud. El acceso se creará después de la aprobación."))),t.createElement(E$,null))))}function y$(){const a=Ct(),[e,n]=p.useState({email:"",password:"",confirmarPassword:""}),[r,s]=p.useState(!1),[o,i]=p.useState(""),l=C=>{const{name:S,value:w}=C.target;n(f=>({...f,[S]:w}))},c=()=>!e.email||!e.password||!e.confirmarPassword?(i("Por favor, completa todos los campos"),!1):e.password!==e.confirmarPassword?(i("Las contraseñas no coinciden"),!1):e.password.length<6?(i("La contraseña debe tener al menos 6 caracteres"),!1):!0,u=async C=>{try{const S=C.trim().toLowerCase();console.log("🔍 Buscando agente con email:",S),console.log("📧 Email original:",C),console.log("📧 Email normalizado:",S);const w=fe(W(F,"agentes"),pe("email","==",S),pe("requiere_registro","==",!0)),f=await le(w);if(console.log("📊 Agentes que requieren registro encontrados:",f.size),!f.empty){const N={tipo:"requiere_registro",id:f.docs[0].id,...f.docs[0].data()};return console.log("✅ Agente encontrado (requiere registro):",N),N}const b=fe(W(F,"agentes"),pe("email","==",S),pe("requiere_registro","==",!1)),v=await le(b);if(console.log("📊 Agentes ya registrados encontrados:",v.size),!v.empty){const N={tipo:"ya_registrado",id:v.docs[0].id,...v.docs[0].data()};return console.log("✅ Agente encontrado (ya registrado):",N),N}const I=fe(W(F,"agentes"),pe("email","==",S)),A=await le(I);if(console.log("📊 Total de agentes con este email (normalizado):",A.size),A.empty||A.docs.forEach((N,x)=>{console.log(`📋 Agente ${x+1}:`,{id:N.id,email:N.data().email,requiere_registro:N.data().requiere_registro,activo:N.data().activo,nombre:N.data().nombre})}),C!==S){console.log("🔄 Buscando con email original (sin normalizar)...");const N=fe(W(F,"agentes"),pe("email","==",C)),x=await le(N);console.log("📊 Agentes con email original:",x.size),x.empty||(console.log("⚠️ ENCONTRADO CON EMAIL SIN NORMALIZAR - Posible problema de normalización"),x.docs.forEach((y,E)=>{console.log(`📋 Agente sin normalizar ${E+1}:`,{id:y.id,email:y.data().email,requiere_registro:y.data().requiere_registro,activo:y.data().activo,nombre:y.data().nombre})}))}return console.log("❌ No se encontró agente con email:",S),null}catch(S){return console.error("Error buscando agente:",S),null}},d=async(C,S)=>{try{await ze(Ne(F,"agentes",C.id),{uid:S,requiere_registro:!1,fecha_activacion:new Date,password_temporal:null});const w=fe(W(F,"usuarios"),pe("email","==",C.email)),f=await le(w);if(f.empty)await Ar(Ne(F,"usuarios",S),{uid:S,email:C.email,nombre:C.nombre,rol:"agente",estado:"activo",activo:!0,fecha_registro:new Date});else{const b=f.docs[0];await ze(Ne(F,"usuarios",b.id),{uid:S,estado:"activo",fecha_activacion:new Date})}}catch(w){throw console.error("Error activando agente:",w),w}},m=async()=>{try{console.log("🔧 DEBUG: Verificando todos los agentes en el sistema...");const C=fe(W(F,"agentes")),S=await le(C);console.log(`📊 Total de agentes encontrados: ${S.size}`),S.docs.forEach((w,f)=>{const b=w.data();console.log(`👤 Agente ${f+1}:`,{id:w.id,email:b.email,nombre:b.nombre,requiere_registro:b.requiere_registro,activo:b.activo,password_temporal:b.password_temporal?"***":"sin password",fecha_creacion:b.fecha_creacion})}),alert(`Se encontraron ${S.size} agentes. Revisa la consola del navegador para más detalles.`)}catch(C){console.error("Error en debug:",C),alert("Error en debug: "+C.message)}},h=async C=>{if(C.preventDefault(),!!c()){s(!0),i("");try{const S=await u(e.email);if(!S){i(t.createElement("div",{className:"text-left"},t.createElement("p",{className:"font-semibold text-red-600 mb-2"},"Email no encontrado"),t.createElement("p",{className:"text-sm mb-3"},"Este email no está registrado como agente en el sistema."),t.createElement("p",{className:"text-sm text-gray-600"},"Contacta al administrador para que te agregue como agente."))),s(!1);return}if(S.tipo==="ya_registrado"){i(t.createElement("div",{className:"text-left"},t.createElement("p",{className:"font-semibold text-blue-600 mb-2"},"¡Ya tienes cuenta registrada!"),t.createElement("p",{className:"text-sm mb-3"},"Tu email ya está registrado en el sistema. Usa el login normal."),t.createElement("button",{onClick:()=>a("/login"),className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Ir al Login"))),s(!1);return}if(S.password_temporal!==e.password){i(t.createElement("div",{className:"text-left"},t.createElement("p",{className:"font-semibold text-red-600 mb-2"},"Contraseña incorrecta"),t.createElement("p",{className:"text-sm mb-3"},"La contraseña no coincide con la asignada por el administrador."),t.createElement("p",{className:"text-sm text-gray-600"},"Verifica las credenciales o contacta al administrador."))),s(!1);return}const w=await es(Pt,e.email,e.password);await d(S,w.user.uid),i(t.createElement("div",{className:"text-left"},t.createElement("p",{className:"font-semibold text-green-600 mb-2"},"¡Registro completado!"),t.createElement("p",{className:"text-sm"},"Redirigiendo a tu panel de agente..."))),setTimeout(()=>{a("/agente")},2e3)}catch(S){if(console.error("Error en registro:",S),S.code==="auth/email-already-in-use"){const w=await u(e.email);if(w&&w.tipo==="ya_registrado")i(t.createElement("div",{className:"text-left"},t.createElement("p",{className:"font-semibold text-blue-600 mb-2"},"Email ya registrado"),t.createElement("p",{className:"text-sm mb-3"},"Este email ya tiene una cuenta activa. Usa el login normal."),t.createElement("button",{onClick:()=>a("/login"),className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Ir al Login")));else try{await hI(Pt,e.email,e.password),i(t.createElement("div",{className:"text-left"},t.createElement("p",{className:"font-semibold text-green-600 mb-2"},"Iniciando sesión"),t.createElement("p",{className:"text-sm"},"Ya tenías cuenta creada. Redirigiendo..."))),setTimeout(()=>{a("/agente")},1500)}catch{i(t.createElement("div",{className:"text-left"},t.createElement("p",{className:"font-semibold text-red-600 mb-2"},"Email ya registrado"),t.createElement("p",{className:"text-sm mb-3"},"Este email ya tiene cuenta pero la contraseña no coincide."),t.createElement("button",{onClick:()=>a("/login"),className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Ir al Login")))}}else S.code==="auth/weak-password"?i("La contraseña debe tener al menos 6 caracteres"):i("Error en el registro: "+S.message)}finally{s(!1)}}};return t.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-100 via-white to-green-100 py-12 px-4"},t.createElement("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-8"},t.createElement("div",{className:"text-center mb-8"},t.createElement("h1",{className:"text-3xl font-bold text-gray-800 mb-2"},"Registro de Agente"),t.createElement("p",{className:"text-gray-600"},"Completa tu registro con las credenciales proporcionadas por el administrador")),t.createElement("form",{onSubmit:h,className:"space-y-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email (Usuario) *"),t.createElement("input",{type:"email",name:"email",value:e.email,onChange:l,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"tu.email@empresa.com",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña proporcionada por admin *"),t.createElement("input",{type:"password",name:"password",value:e.password,onChange:l,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Contraseña temporal",required:!0,minLength:6})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirmar contraseña *"),t.createElement("input",{type:"password",name:"confirmarPassword",value:e.confirmarPassword,onChange:l,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Confirma la contraseña",required:!0,minLength:6})),o&&t.createElement("div",{className:`p-4 rounded-lg text-sm ${typeof o=="string"&&(o.includes("exitosamente")||o.includes("Redirigiendo")||o.includes("Iniciando sesión"))||typeof o=="object"&&o.props&&o.props.children&&o.props.children.some(C=>C.props&&C.props.children&&(C.props.children.includes("completado")||C.props.children.includes("Iniciando sesión")))?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`},o),t.createElement("button",{type:"submit",disabled:r,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r?t.createElement("div",{className:"flex items-center justify-center"},t.createElement("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Procesando..."):"Completar Registro"),t.createElement("button",{type:"button",onClick:m,className:"w-full mt-2 bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 text-sm"},"🔧 Debug: Ver agentes en sistema")),t.createElement("div",{className:"mt-8 p-4 bg-blue-50 border border-blue-200 rounded-lg"},t.createElement("h3",{className:"font-medium text-blue-800 mb-2"},"📋 Instrucciones:"),t.createElement("ul",{className:"text-sm text-blue-700 space-y-1"},t.createElement("li",null,"• Usa el email y contraseña que te proporcionó el administrador"),t.createElement("li",null,"• Después del registro podrás acceder a tu panel de agente"),t.createElement("li",null,"• Desde tu panel podrás crear solicitudes de empresas"),t.createElement("li",null,"• Contacta al admin si tienes problemas con las credenciales")),t.createElement("div",{className:"mt-3 pt-3 border-t border-blue-200"},t.createElement("button",{onClick:()=>a("/ayuda-agentes"),className:"text-blue-600 hover:text-blue-800 underline text-sm"},"🆘 ¿Tienes problemas? Ver guía completa"))),t.createElement("div",{className:"mt-6 text-center"},t.createElement("p",{className:"text-sm text-gray-600"},"¿Ya tienes cuenta?"," ",t.createElement("button",{onClick:()=>a("/login"),className:"text-blue-600 hover:text-blue-800 underline"},"Iniciar sesión aquí")))))}function N$(){const[a,e]=p.useState({nombre:"",email:"",tipoEmpresa:"",rubro:"",telefono:"",aceptaTerminos:!1}),[n,r]=p.useState({}),[s,o]=p.useState(!1),i=()=>{const u={};return a.nombre||(u.nombre="El nombre es obligatorio"),(!a.email||!/^[^@]+@[^@]+\.[a-zA-Z]{2,}$/.test(a.email))&&(u.email="Email inválido"),a.tipoEmpresa||(u.tipoEmpresa="Selecciona un tipo de empresa"),a.rubro||(u.rubro="Selecciona un rubro"),(!a.telefono||!/^\d{9,15}$/.test(a.telefono))&&(u.telefono="Teléfono inválido"),a.aceptaTerminos||(u.aceptaTerminos="Debes aceptar los términos"),r(u),Object.keys(u).length===0},l=u=>{const{name:d,value:m,type:h,checked:C}=u.target;e(S=>({...S,[d]:h==="checkbox"?C:m}))},c=u=>{u.preventDefault(),i()&&o(!0)};return t.createElement("form",{className:"max-w-lg mx-auto p-6 bg-white rounded shadow",onSubmit:c},t.createElement("h2",{className:"text-2xl font-bold mb-4"},"Registro de Empresa"),t.createElement("div",{className:"mb-4"},t.createElement("label",{className:"block mb-1"},"Nombre *"),t.createElement("input",{name:"nombre",value:a.nombre,onChange:l,className:`w-full border p-2 rounded ${n.nombre?"border-red-500":""}`}),n.nombre&&t.createElement("span",{className:"text-red-500 text-sm"},n.nombre)),t.createElement("div",{className:"mb-4"},t.createElement("label",{className:"block mb-1"},"Email *"),t.createElement("input",{name:"email",value:a.email,onChange:l,className:`w-full border p-2 rounded ${n.email?"border-red-500":""}`}),n.email&&t.createElement("span",{className:"text-red-500 text-sm"},n.email)),t.createElement("div",{className:"mb-4"},t.createElement("label",{className:"block mb-1"},"Tipo de Empresa *"),t.createElement("select",{name:"tipoEmpresa",value:a.tipoEmpresa,onChange:l,className:`w-full border p-2 rounded ${n.tipoEmpresa?"border-red-500":""}`},t.createElement("option",{value:""},"Selecciona..."),t.createElement("option",{value:"proveedor"},"Proveedor"),t.createElement("option",{value:"pyme"},"PyME"),t.createElement("option",{value:"empresa"},"Empresa"),t.createElement("option",{value:"emprendimiento"},"Emprendimiento")),n.tipoEmpresa&&t.createElement("span",{className:"text-red-500 text-sm"},n.tipoEmpresa)),t.createElement("div",{className:"mb-4"},t.createElement("label",{className:"block mb-1"},"Rubro *"),t.createElement("input",{name:"rubro",value:a.rubro,onChange:l,className:`w-full border p-2 rounded ${n.rubro?"border-red-500":""}`}),n.rubro&&t.createElement("span",{className:"text-red-500 text-sm"},n.rubro)),t.createElement("div",{className:"mb-4"},t.createElement("label",{className:"block mb-1"},"Teléfono *"),t.createElement("input",{name:"telefono",value:a.telefono,onChange:l,className:`w-full border p-2 rounded ${n.telefono?"border-red-500":""}`}),n.telefono&&t.createElement("span",{className:"text-red-500 text-sm"},n.telefono)),t.createElement("div",{className:"mb-4 flex items-center"},t.createElement("input",{type:"checkbox",name:"aceptaTerminos",checked:a.aceptaTerminos,onChange:l,className:"mr-2"}),t.createElement("label",null,"Acepto los términos y condiciones *"),n.aceptaTerminos&&t.createElement("span",{className:"text-red-500 text-sm ml-2"},n.aceptaTerminos)),t.createElement("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded",disabled:s},"Registrar"),s&&t.createElement("div",{className:"mt-4 text-green-600 font-semibold"},"¡Registro exitoso!"))}function w$(){return t.createElement(N$,null)}function _$(){const a=Ct();p.useState("");const e=[{id:"cliente",title:"🚗 Cliente",description:"Propietarios de vehículos que buscan servicios confiables",benefits:["Acceso a proveedores verificados","Historial de servicios","Promociones exclusivas","Seguimiento de mantenimiento"],action:"Registrarse como Cliente",route:"/registro-cliente"},{id:"proveedor",title:"🏪 Proveedor",description:"Empresas y talleres que ofrecen servicios automotrices",benefits:["Acceso a base de clientes","Herramientas de gestión","Promoción digital","Red de contactos profesionales"],action:"Registrarse como Proveedor",route:"/registro-proveedor"},{id:"agente",title:"👨‍💼 Agente de Campo",description:"Profesionales que conectan empresas con la comunidad",benefits:["Comisiones por registro","Herramientas de trabajo","Capacitación continua","Flexibilidad horaria"],action:"Registrarse como Agente",route:"/registro-agente"}],n=r=>{a(r.route)};return t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(za,null),t.createElement("div",{className:"max-w-6xl mx-auto px-4 py-8"},t.createElement("div",{className:"text-center mb-12"},t.createElement("h1",{className:"text-4xl font-bold text-gray-900 mb-4"},"💎 Únete a la Comunidad AV10 de Julio"),t.createElement("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto"},"Somos una comunidad integral del sector automotriz que conecta ",t.createElement("strong",null,"clientes"),",",t.createElement("strong",null," proveedores")," y ",t.createElement("strong",null,"agentes de campo")," en un ecosistema colaborativo.")),t.createElement("div",{className:"bg-white rounded-xl shadow-sm p-8 mb-12"},t.createElement("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-6"},"Nuestra Comunidad en Números"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 text-center"},t.createElement("div",{className:"p-6 bg-blue-50 rounded-lg"},t.createElement("div",{className:"text-3xl font-bold text-blue-600 mb-2"},"500+"),t.createElement("div",{className:"text-gray-700"},"Clientes Activos"),t.createElement("div",{className:"text-sm text-gray-500 mt-1"},"Propietarios de vehículos")),t.createElement("div",{className:"p-6 bg-green-50 rounded-lg"},t.createElement("div",{className:"text-3xl font-bold text-green-600 mb-2"},"200+"),t.createElement("div",{className:"text-gray-700"},"Proveedores Verificados"),t.createElement("div",{className:"text-sm text-gray-500 mt-1"},"Talleres y empresas")),t.createElement("div",{className:"p-6 bg-purple-50 rounded-lg"},t.createElement("div",{className:"text-3xl font-bold text-purple-600 mb-2"},"50+"),t.createElement("div",{className:"text-gray-700"},"Agentes de Campo"),t.createElement("div",{className:"text-sm text-gray-500 mt-1"},"Conectores de la comunidad")))),t.createElement("div",{className:"mb-12"},t.createElement("h2",{className:"text-3xl font-bold text-center text-gray-900 mb-8"},"¿Cómo quieres formar parte?"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8"},e.map(r=>t.createElement("div",{key:r.id,className:"bg-white rounded-xl shadow-sm border-2 border-gray-200 hover:border-blue-300 transition-colors"},t.createElement("div",{className:"p-6"},t.createElement("div",{className:"text-center mb-6"},t.createElement("div",{className:"text-4xl mb-4"},r.title.split(" ")[0]),t.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-2"},r.title.slice(2)),t.createElement("p",{className:"text-gray-600"},r.description)),t.createElement("div",{className:"mb-6"},t.createElement("h4",{className:"font-semibold text-gray-900 mb-3"},"Beneficios:"),t.createElement("ul",{className:"space-y-2"},r.benefits.map((s,o)=>t.createElement("li",{key:o,className:"flex items-start gap-2 text-sm text-gray-600"},t.createElement("span",{className:"text-green-500 mt-1"},"✓"),s)))),t.createElement("button",{onClick:()=>n(r),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition-colors"},r.action)))))),t.createElement("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 rounded-xl text-white p-8 mb-12"},t.createElement("div",{className:"max-w-4xl mx-auto text-center"},t.createElement("h2",{className:"text-3xl font-bold mb-6"},"¿Por qué AV10 de Julio?"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 text-left"},t.createElement("div",null,t.createElement("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2"},"🤝 ",t.createElement("span",null,"Colaboración")),t.createElement("p",{className:"text-blue-100"},"Creamos conexiones reales entre todos los actores del ecosistema automotriz, facilitando relaciones de confianza y beneficio mutuo.")),t.createElement("div",null,t.createElement("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2"},"🔍 ",t.createElement("span",null,"Transparencia")),t.createElement("p",{className:"text-blue-100"},"Todos nuestros proveedores están verificados y los clientes pueden acceder a reseñas reales y servicios de calidad garantizada.")),t.createElement("div",null,t.createElement("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2"},"🚀 ",t.createElement("span",null,"Crecimiento")),t.createElement("p",{className:"text-blue-100"},"Ofrecemos herramientas y oportunidades para que cada miembro de la comunidad pueda crecer y desarrollarse profesionalmente.")),t.createElement("div",null,t.createElement("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2"},"🌟 ",t.createElement("span",null,"Innovación")),t.createElement("p",{className:"text-blue-100"},"Incorporamos tecnología y mejores prácticas para hacer más eficiente y conveniente la experiencia automotriz."))))),t.createElement("div",{className:"bg-white rounded-xl shadow-sm p-8 text-center"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-4"},"¿Tienes preguntas?"),t.createElement("p",{className:"text-gray-600 mb-6"},"Nuestro equipo está aquí para ayudarte a encontrar tu lugar en la comunidad."),t.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},t.createElement("button",{onClick:()=>a("/contacto"),className:"bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors"},"💬 Contactar Asesor"),t.createElement("button",{onClick:()=>a("/recursos"),className:"border-2 border-blue-600 text-blue-600 px-8 py-3 rounded-lg font-semibold hover:bg-blue-50 transition-colors"},"📚 Ver Recursos")))))}const C$=({empresa:a,size:e="md"})=>{const n=[],s={sm:{text:"text-xs",padding:"px-1.5 py-0.5",icon:"text-xs"},md:{text:"text-xs",padding:"px-2 py-1",icon:"text-sm"},lg:{text:"text-sm",padding:"px-3 py-1.5",icon:"text-base"}}[e],o=()=>{if(!a)return!1;const c=a.fechaRegistro||a.fechaCreacion,u=c&&new Date-(c.toDate?c.toDate():new Date(c))<2*365*24*60*60*1e3;return a.esPyme||u||a.numeroProductos&&a.numeroProductos<50},i=()=>{if(!a)return!1;const c=a.fechaRegistro||a.fechaCreacion,u=c&&new Date-(c.toDate?c.toDate():new Date(c))<6*30*24*60*60*1e3;return a.esEmprendimiento||u||a.numeroProductos&&a.numeroProductos<10},l=()=>a?a.esLocal||a.region&&a.region.toLowerCase().includes("metropolitana")||a.ciudad&&["santiago","providencia","las condes","vitacura"].includes(a.ciudad.toLowerCase()):!1;return i()?n.push({text:"🚀 Emprendimiento",bgColor:"bg-purple-100",textColor:"text-purple-800",borderColor:"border-purple-300"}):o()&&n.push({text:"⭐ PyME",bgColor:"bg-blue-100",textColor:"text-blue-800",borderColor:"border-blue-300"}),l()&&n.push({text:"📍 Local",bgColor:"bg-green-100",textColor:"text-green-800",borderColor:"border-green-300"}),a&&a.esNuevo&&n.push({text:"✨ Nuevo",bgColor:"bg-yellow-100",textColor:"text-yellow-800",borderColor:"border-yellow-300"}),a&&a.verificado&&n.push({text:"✓ Verificado",bgColor:"bg-emerald-100",textColor:"text-emerald-800",borderColor:"border-emerald-300"}),a&&a.esPremium&&n.push({text:"👑 Premium",bgColor:"bg-amber-100",textColor:"text-amber-800",borderColor:"border-amber-300"}),n.length===0?null:t.createElement("div",{className:"flex flex-wrap gap-1"},n.map((c,u)=>t.createElement("span",{key:u,className:`
            ${s.text} ${s.padding} 
            ${c.bgColor} ${c.textColor} ${c.borderColor}
            border rounded-full font-medium whitespace-nowrap
            inline-flex items-center gap-1
          `},c.text)))},S$=({proveedorId:a,showReviews:e=!0,compact:n=!1})=>{const[r,s]=p.useState({totalReviews:0,averageRating:0,ratingDistribution:{5:0,4:0,3:0,2:0,1:0}}),[o,i]=p.useState(!0);p.useEffect(()=>{l()},[a]);const l=async()=>{i(!0);try{const d=fe(W(F,"reseñas"),pe("proveedorId","==",a),pe("estado","==","aprobada")),h=(await le(d)).docs.map(b=>b.data());if(h.length===0){s({totalReviews:0,averageRating:0,ratingDistribution:{5:0,4:0,3:0,2:0,1:0}});return}const C=h.length,w=h.reduce((b,v)=>b+v.puntaje,0)/C,f={5:0,4:0,3:0,2:0,1:0};h.forEach(b=>{f[b.puntaje]=(f[b.puntaje]||0)+1}),s({totalReviews:C,averageRating:w,ratingDistribution:f})}catch(d){console.error("Error fetching reputation stats:",d)}finally{i(!1)}},c=d=>d>=4.5?{label:"Excelente",color:"text-green-600",bgColor:"bg-green-100"}:d>=4?{label:"Muy Bueno",color:"text-blue-600",bgColor:"bg-blue-100"}:d>=3.5?{label:"Bueno",color:"text-yellow-600",bgColor:"bg-yellow-100"}:d>=3?{label:"Regular",color:"text-orange-600",bgColor:"bg-orange-100"}:{label:"Necesita Mejorar",color:"text-red-600",bgColor:"bg-red-100"};if(o)return t.createElement("div",{className:"flex justify-center py-4"},t.createElement("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}));const u=c(r.averageRating);return n?t.createElement("div",{className:"flex items-center gap-2"},t.createElement(av,{value:r.averageRating,readonly:!0,size:"sm",showValue:!1}),t.createElement("span",{className:"text-sm text-gray-600"},r.averageRating.toFixed(1)," (",r.totalReviews," reseñas)")):t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Reputación del Proveedor"),r.totalReviews===0?t.createElement("div",{className:"text-center py-8 text-gray-500"},t.createElement("p",null,"Este proveedor aún no tiene reseñas")):t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-4xl font-bold text-gray-900 mb-2"},r.averageRating.toFixed(1)),t.createElement(av,{value:r.averageRating,readonly:!0,size:"lg",showValue:!1}),t.createElement("div",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium mt-3 ${u.bgColor} ${u.color}`},u.label),t.createElement("div",{className:"text-sm text-gray-600 mt-2"},"Basado en ",r.totalReviews," reseña",r.totalReviews!==1?"s":"")),t.createElement("div",{className:"space-y-2"},[5,4,3,2,1].map(d=>{const m=r.ratingDistribution[d]||0,h=r.totalReviews>0?m/r.totalReviews*100:0;return t.createElement("div",{key:d,className:"flex items-center gap-2 text-sm"},t.createElement("span",{className:"w-8 text-right"},d,"★"),t.createElement("div",{className:"flex-1 bg-gray-200 rounded-full h-2"},t.createElement("div",{className:"bg-yellow-400 h-2 rounded-full transition-all duration-300",style:{width:`${h}%`}})),t.createElement("span",{className:"w-8 text-gray-600"},m))})))),e&&t.createElement("div",null,t.createElement("h4",{className:"text-lg font-semibold text-gray-900 mb-4"},"Reseñas de Clientes"),t.createElement(NT,{proveedorId:a,limitCount:5})))},Nm=()=>{var S;const a=Ct(),[e,n]=p.useState([]),[r,s]=p.useState([]),[o,i]=p.useState(!0),[l,c]=p.useState("todos"),u=[{id:"vulcanizaciones",nombre:"Vulcanizaciones",icono:"🏁",descripcion:"Reparación de neumáticos, balanceo, alineación",servicios:["Reparación de neumáticos","Balanceo","Alineación","Venta de neumáticos"],ejemplos:["Vulcanización Express","Neumáticos 24/7","Centro de Llantas"],color:"bg-blue-50 border-blue-200 text-blue-800"},{id:"mecanica",nombre:"Talleres Mecánicos",icono:"🔧",descripcion:"Talleres de reparación mecánica y mantención",servicios:["Mantención preventiva","Reparaciones motor","Sistema eléctrico","Frenos"],ejemplos:["Taller Don Juan","Mecánica Rápida","Auto Service"],color:"bg-green-50 border-green-200 text-green-800"},{id:"lavado",nombre:"Lavado de Autos",icono:"🚿",descripcion:"Lavado, encerado y detailing automotriz",servicios:["Lavado completo","Encerado","Detailing","Limpieza interior"],ejemplos:["Car Wash Express","Lavado Premium","Detailing Pro"],color:"bg-cyan-50 border-cyan-200 text-cyan-800"},{id:"electricidad",nombre:"Electricidad Automotriz",icono:"⚡",descripcion:"Especialistas en sistemas eléctricos",servicios:["Diagnóstico computarizado","Aire acondicionado","Alarmas","Audio"],ejemplos:["Electro Auto","Diagnóstico Express","Audio Car"],color:"bg-yellow-50 border-yellow-200 text-yellow-800"},{id:"pintura",nombre:"Pintura y Carrocería",icono:"🎨",descripcion:"Pintura automotriz y trabajos de carrocería",servicios:["Pintura completa","Retoque","Pulido","Desabolladura"],ejemplos:["Pintura Express","Carrocería Total","Retoque Pro"],color:"bg-purple-50 border-purple-200 text-purple-800"},{id:"lubricentros",nombre:"Lubricentros",icono:"🛢️",descripción:"Cambio de aceite y lubricación",servicios:["Cambio de aceite","Filtros","Lubricación","Revisión básica"],ejemplos:["Lubri Express","Quick Oil","Centro Lubricación"],color:"bg-orange-50 border-orange-200 text-orange-800"},{id:"accesorios",nombre:"Accesorios",icono:"✨",descripcion:"Instalación de accesorios y personalización",servicios:["Insulfilm","Fundas","Cromados","Tuning básico"],ejemplos:["Accesorios Pro","Tuning Express","Auto Style"],color:"bg-pink-50 border-pink-200 text-pink-800"},{id:"gruas",nombre:"Grúas y Auxilio",icono:"🚛",descripción:"Servicios de grúa y rescate vehicular",servicios:["Grúa 24/7","Auxilio mecánico","Remolque","Rescate"],ejemplos:["Grúa Express","Auxilio 24h","Rescate Rápido"],color:"bg-red-50 border-red-200 text-red-800"}];p.useEffect(()=>{d()},[]),p.useEffect(()=>{h()},[e,l]);const d=async()=>{i(!0);try{const w=fe(W(F,"empresas"),pe("estado","in",["activa","validada"]),st("nombre")),v=(await le(w)).docs.map(I=>({id:I.id,...I.data()})).filter(I=>m(I));n(v)}catch(w){console.error("Error fetching providers:",w)}finally{i(!1)}},m=w=>{if(w.tipoEmpresa)return w.tipoEmpresa!=="proveedor";const f=w.fechaRegistro||w.fechaCreacion,b=f&&new Date-(f.toDate?f.toDate():new Date(f))<3*365*24*60*60*1e3;return w.esPyme||w.esEmprendimiento||b||w.numeroProductos&&w.numeroProductos<100||w.empleados&&w.empleados<20||u.some(v=>{var I;return((I=w.categorias)==null?void 0:I.some(A=>v.servicios.some(N=>A.toLowerCase().includes(N.toLowerCase())||N.toLowerCase().includes(A.toLowerCase()))))||w.nombre.toLowerCase().includes(v.nombre.toLowerCase())})},h=()=>{let w=[...e];if(l!=="todos"){const f=u.find(b=>b.id===l);f&&(w=w.filter(b=>[f.nombre,...f.servicios,f.descripcion.toLowerCase()].some(I=>{var A,N,x;return((A=b.categorias)==null?void 0:A.some(y=>y.toLowerCase().includes(I.toLowerCase())))||((N=b.servicios)==null?void 0:N.some(y=>y.toLowerCase().includes(I.toLowerCase())))||((x=b.descripcion)==null?void 0:x.toLowerCase().includes(I.toLowerCase()))||b.nombre.toLowerCase().includes(I.toLowerCase())})))}s(w)},C=w=>w?(w.toDate?w.toDate():new Date(w)).toLocaleDateString():"";return o?t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(za,null),t.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}))):t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(za,null),t.createElement("div",{className:"max-w-7xl mx-auto px-4 py-8"},t.createElement("div",{className:"bg-gradient-to-r from-green-600 via-blue-600 to-purple-600 rounded-2xl text-white p-8 mb-8"},t.createElement("div",{className:"max-w-4xl mx-auto text-center"},t.createElement("div",{className:"mb-6"},t.createElement("span",{className:"bg-yellow-400 text-blue-900 px-4 py-2 rounded-full text-sm font-bold"},"¡PARA PyMEs y EMPRENDEDORES!")),t.createElement("h1",{className:"text-4xl lg:text-5xl font-bold mb-4"},t.createElement("span",{className:"bg-gradient-to-r from-yellow-400 to-orange-400 bg-clip-text text-transparent"},"PyMEs Locales"),t.createElement("br",null),t.createElement("span",{className:"text-2xl lg:text-3xl"},"Sector Automotriz")),t.createElement("p",{className:"text-xl text-green-100 mb-8"},"Descubre talleres, vulcanizaciones y servicios especializados en tu zona"),t.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},t.createElement("button",{onClick:()=>a("/registro-proveedor"),className:"bg-yellow-400 hover:bg-yellow-500 text-blue-900 px-8 py-3 rounded-lg font-semibold text-lg transition-all transform hover:scale-105 shadow-lg"},"📝 Registrar mi PyME"),t.createElement("button",{onClick:()=>{const w=document.getElementById("sectores-pymes");w==null||w.scrollIntoView({behavior:"smooth"})},className:"border-2 border-white text-white hover:bg-white hover:text-blue-900 px-8 py-3 rounded-lg font-semibold text-lg transition-all"},"🔍 Explorar PyMEs"),t.createElement("button",{onClick:()=>a("/login?tipo=empresa"),className:"bg-white text-blue-700 px-10 py-4 rounded-xl font-bold text-lg hover:bg-blue-50 transition-colors shadow-xl border-2 border-white"},"🏢 Ya Tengo Cuenta")))),t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-8 mb-8"},t.createElement("div",{className:"max-w-4xl mx-auto text-center"},t.createElement("h2",{className:"text-2xl font-bold text-gray-800 mb-4"},"🚀 Impulsa tu negocio automotriz"),t.createElement("p",{className:"text-gray-600 mb-6"},"Conectamos PyMEs locales con clientes que necesitan servicios automotrices de calidad. Si tienes un taller, vulcanización o servicio especializado, este es tu espacio."),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-8"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl mb-2"},"🏪"),t.createElement("h3",{className:"font-semibold text-gray-800"},"PyMEs Locales"),t.createElement("p",{className:"text-gray-600 text-sm"},"Descubre negocios de barrio")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl mb-2"},"🔧"),t.createElement("h3",{className:"font-semibold text-gray-800"},"Servicios Especializados"),t.createElement("p",{className:"text-gray-600 text-sm"},"Talleres, vulcanizaciones y más")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl mb-2"},"🤝"),t.createElement("h3",{className:"font-semibold text-gray-800"},"Apoyo al Emprendimiento"),t.createElement("p",{className:"text-gray-600 text-sm"},"Impulsamos la economía local"))))),t.createElement("div",{className:"bg-white rounded-xl shadow-sm p-8 mb-8"},t.createElement("div",{className:"max-w-4xl mx-auto"},t.createElement("h2",{className:"text-3xl font-bold text-gray-900 text-center mb-6"},"🎁 Programa Especial para PyMEs y Emprendimientos"),t.createElement("div",{className:"grid md:grid-cols-2 gap-8"},t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"flex items-start gap-3"},t.createElement("div",{className:"bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"✓"),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"Ayuda para Crear Tu Página Web"),t.createElement("p",{className:"text-gray-600"},"Te ayudamos a crear tu presencia digital sin costo adicional. Perfil completo con fotos y servicios."))),t.createElement("div",{className:"flex items-start gap-3"},t.createElement("div",{className:"bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"✓"),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"1 Campaña Semanal Gratis"),t.createElement("p",{className:"text-gray-600"},"Promociona tus servicios con una campaña publicitaria semanal gratuita para destacar entre la competencia."))),t.createElement("div",{className:"flex items-start gap-3"},t.createElement("div",{className:"bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"✓"),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"Ingreso de Productos Sin Límite"),t.createElement("p",{className:"text-gray-600"},"Agrega todos tus productos y servicios con fotos, precios y descripciones detalladas."))),t.createElement("div",{className:"flex items-start gap-3"},t.createElement("div",{className:"bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"✓"),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"Asesoría Digital Personalizada"),t.createElement("p",{className:"text-gray-600"},"Sesiones gratuitas para ayudarte a maximizar tu presencia online y atraer más clientes.")))),t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"flex items-start gap-3"},t.createElement("div",{className:"bg-blue-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"⭐"),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"Acceso Directo a Clientes Locales"),t.createElement("p",{className:"text-gray-600"},"Conecta con vecinos y clientes de tu sector que buscan servicios confiables y cercanos."))),t.createElement("div",{className:"flex items-start gap-3"},t.createElement("div",{className:"bg-blue-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"⭐"),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"Herramientas de Gestión Simples"),t.createElement("p",{className:"text-gray-600"},"Dashboard fácil de usar para gestionar citas, clientes y ventas desde tu celular."))),t.createElement("div",{className:"flex items-start gap-3"},t.createElement("div",{className:"bg-blue-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"⭐"),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"Red de Colaboración Local"),t.createElement("p",{className:"text-gray-600"},"Conecta con otros emprendedores de tu sector para colaborar y referir clientes."))),t.createElement("div",{className:"flex items-start gap-3"},t.createElement("div",{className:"bg-blue-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"⭐"),t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"Soporte Técnico en Español"),t.createElement("p",{className:"text-gray-600"},"Equipo de soporte local que entiende las necesidades de los emprendedores chilenos."))))),t.createElement("div",{className:"text-center mt-8"},t.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},t.createElement("button",{onClick:()=>a("/registro-proveedor"),className:"bg-gradient-to-r from-green-600 to-blue-600 text-white px-10 py-4 rounded-xl font-semibold text-lg hover:from-green-700 hover:to-blue-700 transition-all transform hover:scale-105 shadow-lg"},"🚀 Comenzar Mi Transformación Digital"),t.createElement("button",{onClick:()=>a("/login?tipo=empresa"),className:"bg-white text-green-600 px-10 py-4 rounded-xl font-semibold text-lg hover:bg-green-50 transition-all border-2 border-green-600 shadow-lg"},"🏢 Ya Tengo Cuenta - Ingresar"))))),t.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-8",id:"sectores-pymes"},t.createElement("h3",{className:"text-2xl font-bold text-gray-900 mb-6 text-center"},"🔍 Explora PyMEs por Sector"),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-3"},t.createElement("button",{onClick:()=>c("todos"),className:`p-3 rounded-lg border-2 text-center transition-colors ${l==="todos"?"bg-blue-600 text-white border-blue-600":"bg-gray-50 border-gray-200 text-gray-700 hover:border-blue-300 hover:bg-blue-50"}`},t.createElement("div",{className:"text-lg mb-1"},"🏪"),t.createElement("div",{className:"text-xs font-medium"},"Todos")),u.map(w=>t.createElement("button",{key:w.id,onClick:()=>c(w.id),className:`p-3 rounded-lg border-2 text-center transition-colors ${l===w.id?"bg-blue-600 text-white border-blue-600":"bg-gray-50 border-gray-200 text-gray-700 hover:border-blue-300 hover:bg-blue-50"}`,title:w.descripcion},t.createElement("div",{className:"text-lg mb-1"},w.icono),t.createElement("div",{className:"text-xs font-medium"},w.nombre)))),l!=="todos"&&t.createElement("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg"},(()=>{const w=u.find(f=>f.id===l);return w?t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-blue-900 mb-2 flex items-center gap-2"},t.createElement("span",null,w.icono),w.nombre),t.createElement("p",{className:"text-blue-800 mb-3"},w.descripcion),t.createElement("div",{className:"space-y-2"},t.createElement("div",null,t.createElement("span",{className:"text-sm font-medium text-blue-700"},"Servicios típicos:"),t.createElement("div",{className:"flex flex-wrap gap-2 mt-1"},w.servicios.map((f,b)=>t.createElement("span",{key:b,className:"bg-blue-200 text-blue-800 px-3 py-1 rounded-full text-sm"},f)))),t.createElement("div",null,t.createElement("span",{className:"text-sm font-medium text-blue-700"},"Ejemplos:"),t.createElement("div",{className:"flex flex-wrap gap-2 mt-1"},w.ejemplos.map((f,b)=>t.createElement("span",{key:b,className:"bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm"},f)))))):null})())),t.createElement("div",{className:"bg-white rounded-xl shadow-sm p-8 mb-8"},t.createElement("h3",{className:"text-2xl font-bold text-gray-900 text-center mb-6"},"📊 Nuestra Comunidad de PyMEs"),t.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-green-600 mb-2"},r.length),t.createElement("div",{className:"text-sm text-gray-600"},"PyMEs Activas")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-blue-600 mb-2"},r.filter(w=>w.esEmprendimiento||w.fechaRegistro&&new Date-(w.fechaRegistro.toDate?w.fechaRegistro.toDate():new Date(w.fechaRegistro))<6*30*24*60*60*1e3).length),t.createElement("div",{className:"text-sm text-gray-600"},"🚀 Emprendimientos")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-purple-600 mb-2"},"8"),t.createElement("div",{className:"text-sm text-gray-600"},"🏭 Sectores Cubiertos")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-yellow-600 mb-2"},"95%"),t.createElement("div",{className:"text-sm text-gray-600"},"😊 Satisfacción")))),t.createElement("div",{className:"mb-6 text-center"},t.createElement("h3",{className:"text-xl font-semibold text-gray-900 mb-2"},l==="todos"?`${r.length} PyMEs y Emprendimientos Disponibles`:`${r.length} ${((S=u.find(w=>w.id===l))==null?void 0:S.nombre)||"Proveedores"} Disponibles`),t.createElement("p",{className:"text-gray-600"},"Conecta directamente con emprendedores locales que entienden tus necesidades")),r.length===0?t.createElement("div",{className:"text-center py-12"},t.createElement("div",{className:"text-gray-500 text-lg mb-4"},"No se encontraron PyMEs en este sector"),t.createElement("button",{onClick:()=>c("todos"),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"Ver todas las PyMEs")):t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},r.map(w=>t.createElement("div",{key:w.id,className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow"},t.createElement("div",{className:"p-4 border-b border-gray-100"},t.createElement("div",{className:"flex items-start gap-3"},w.logo&&t.createElement("img",{src:w.logo,alt:w.nombre,className:"w-12 h-12 object-contain rounded flex-shrink-0"}),t.createElement("div",{className:"flex-1 min-w-0"},t.createElement("h3",{className:"font-semibold text-gray-900 truncate"},w.nombre),t.createElement("div",{className:"mt-1"},t.createElement(C$,{empresa:w,size:"sm"}))))),t.createElement("div",{className:"p-4"},t.createElement("div",{className:"space-y-2 text-sm"},t.createElement("div",{className:"flex items-center gap-2"},t.createElement("span",{className:"text-gray-500"},"📍"),t.createElement("span",{className:"text-gray-700"},w.ciudad,", ",w.region)),w.telefono&&t.createElement("div",{className:"flex items-center gap-2"},t.createElement("span",{className:"text-gray-500"},"📞"),t.createElement("span",{className:"text-gray-700"},w.telefono)),w.fechaRegistro&&t.createElement("div",{className:"flex items-center gap-2"},t.createElement("span",{className:"text-gray-500"},"📅"),t.createElement("span",{className:"text-gray-700"},"Desde ",C(w.fechaRegistro)))),w.categorias&&w.categorias.length>0&&t.createElement("div",{className:"mt-3"},t.createElement("div",{className:"text-xs text-gray-500 mb-1"},"Servicios:"),t.createElement("div",{className:"flex flex-wrap gap-1"},w.categorias.slice(0,3).map((f,b)=>t.createElement("span",{key:b,className:"bg-green-100 text-green-700 text-xs px-2 py-1 rounded"},f)),w.categorias.length>3&&t.createElement("span",{className:"text-xs text-gray-500"},"+",w.categorias.length-3," más"))),t.createElement("div",{className:"mt-3"},t.createElement(S$,{proveedorId:w.id,compact:!0,showReviews:!1}))),t.createElement("div",{className:"p-4 bg-gray-50 border-t border-gray-100"},t.createElement("div",{className:"flex gap-2"},t.createElement("button",{onClick:()=>a(`/proveedor/${w.id}`),className:"flex-1 bg-green-600 text-white text-sm py-2 px-3 rounded hover:bg-green-700 transition-colors"},"Ver PyME"),w.telefono&&t.createElement("button",{onClick:()=>window.open(`https://wa.me/56${w.telefono.replace(/[^\d]/g,"")}`,"_blank"),className:"bg-green-500 text-white text-sm py-2 px-3 rounded hover:bg-green-600 transition-colors"},"📱 WhatsApp")))))),t.createElement("div",{className:"mt-12 space-y-8"},t.createElement("div",{className:"bg-gradient-to-r from-green-600 to-blue-600 rounded-2xl p-8 text-white"},t.createElement("div",{className:"max-w-3xl mx-auto text-center"},t.createElement("h3",{className:"text-3xl font-bold mb-4"},"🚀 ¿Tienes una PyME o Emprendimiento Automotriz?"),t.createElement("p",{className:"text-lg text-green-100 mb-6"},t.createElement("strong",null,"¡Te ayudamos a digitalizarte!")," Crearemos tu página web, te daremos una campaña semanal gratis y podrás agregar todos tus productos sin costo. Solo necesitas ganas de crecer."),t.createElement("div",{className:"bg-white/10 rounded-lg p-4 mb-6"},t.createElement("h4",{className:"font-semibold mb-2"},"🎁 Incluye:"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm"},t.createElement("div",null,"✅ Página web gratuita"),t.createElement("div",null,"✅ 1 campaña semanal"),t.createElement("div",null,"✅ Productos ilimitados"))),t.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},t.createElement("button",{onClick:()=>a("/registro-proveedor"),className:"bg-yellow-400 text-blue-900 px-10 py-4 rounded-xl font-bold text-lg hover:bg-yellow-500 transition-colors shadow-xl transform hover:scale-105"},"🌟 Registrar Mi PyME Gratis"),t.createElement("button",{onClick:()=>a("/login?tipo=empresa"),className:"bg-white text-blue-700 px-10 py-4 rounded-xl font-bold text-lg hover:bg-blue-50 transition-colors shadow-xl border-2 border-white"},"🏢 Ya Tengo Cuenta")))),t.createElement("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-8 text-white"},t.createElement("div",{className:"max-w-3xl mx-auto text-center"},t.createElement("h3",{className:"text-3xl font-bold mb-4"},"🏠 ¿Buscas Servicios Automotrices Locales?"),t.createElement("p",{className:"text-lg text-blue-100 mb-6"},"Encuentra emprendedores de tu barrio que ofrecen servicios personalizados, precios justos y la cercanía que necesitas para el cuidado de tu vehículo."),t.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},t.createElement("button",{onClick:()=>a("/registro-cliente"),className:"bg-white text-blue-700 px-8 py-3 rounded-lg font-semibold hover:bg-blue-50 transition-colors shadow-lg"},"👤 Registrar Mi Vehículo"),t.createElement("button",{onClick:()=>a("/login?tipo=cliente"),className:"bg-blue-400 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-300 transition-colors shadow-lg"},"🔑 Acceso Clientes"),t.createElement("button",{onClick:()=>{const w=document.getElementById("sectores-pymes");w==null||w.scrollIntoView({behavior:"smooth"})},className:"bg-blue-500 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-400 transition-colors border-2 border-blue-400"},"🔍 Explorar PyMEs")))))))},k$=()=>{const a=Ct(),[e,n]=p.useState({totalClientes:0,totalEmpresas:0,transaccionesEsteMes:0}),[r,s]=p.useState(!0);p.useEffect(()=>{o()},[]);const o=async()=>{try{const i=fe(W(F,"usuarios"),pe("rol","==","cliente")),l=await le(i),c=fe(W(F,"empresas"),pe("estado","==","activa")),u=await le(c);n({totalClientes:l.docs.length,totalEmpresas:u.docs.length,transaccionesEsteMes:Math.floor(Math.random()*150)+200})}catch(i){console.error("Error cargando estadísticas:",i),n({totalClientes:150,totalEmpresas:80,transaccionesEsteMes:320})}finally{s(!1)}};return t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(za,null),t.createElement("div",{className:"bg-gradient-to-r from-green-600 via-green-700 to-green-800 text-white"},t.createElement("div",{className:"max-w-7xl mx-auto px-4 py-16"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"mb-6"},t.createElement("span",{className:"bg-yellow-400 text-green-900 px-4 py-2 rounded-full text-sm font-bold"},"¡ÚNETE A NUESTRA COMUNIDAD!")),t.createElement("h1",{className:"text-4xl md:text-6xl font-bold mb-6"},"🌟 Área Cliente"),t.createElement("p",{className:"text-xl md:text-2xl text-green-100 mb-8 max-w-4xl mx-auto"},"Descubre los increíbles beneficios de ser parte de nuestra comunidad de",t.createElement("strong",{className:"text-yellow-400"}," ",e.totalClientes,"+ clientes registrados")," que ya disfrutan de acceso exclusivo a los mejores servicios automotrices."),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12 max-w-4xl mx-auto"},t.createElement("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20"},t.createElement("div",{className:"text-4xl font-bold text-yellow-400 mb-2"},r?"...":e.totalClientes,"+"),t.createElement("div",{className:"text-green-100"},"Clientes Registrados")),t.createElement("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20"},t.createElement("div",{className:"text-4xl font-bold text-yellow-400 mb-2"},r?"...":e.totalEmpresas,"+"),t.createElement("div",{className:"text-green-100"},"Empresas Verificadas")),t.createElement("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20"},t.createElement("div",{className:"text-4xl font-bold text-yellow-400 mb-2"},r?"...":e.transaccionesEsteMes,"+"),t.createElement("div",{className:"text-green-100"},"Consultas Este Mes"))),t.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},t.createElement("button",{onClick:()=>a("/login?tipo=cliente"),className:"bg-yellow-400 text-green-900 px-8 py-4 rounded-xl font-bold text-lg hover:bg-yellow-300 transition-colors shadow-xl"},"🔑 Ya Soy Cliente - Ingresar"),t.createElement("button",{onClick:()=>a("/registro-cliente"),className:"bg-white text-green-700 px-8 py-4 rounded-xl font-bold text-lg hover:bg-green-50 transition-colors shadow-xl"},"✨ Quiero Ser Cliente"))))),t.createElement("div",{className:"max-w-7xl mx-auto px-4 py-16"},t.createElement("div",{className:"text-center mb-16"},t.createElement("h2",{className:"text-4xl font-bold text-gray-900 mb-6"},"💎 Beneficios Exclusivos Para Clientes"),t.createElement("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto"},"Al registrarte como cliente, tendrás acceso a una red exclusiva de servicios automotrices con beneficios que no encontrarás en ningún otro lugar.")),t.createElement("div",{className:"grid md:grid-cols-3 gap-8 mb-16"},t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-8 text-center"},t.createElement("div",{className:"bg-blue-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6"},t.createElement("span",{className:"text-3xl"},"💰")),t.createElement("h3",{className:"text-2xl font-bold text-gray-900 mb-4"},"Precios Preferenciales"),t.createElement("p",{className:"text-gray-600 mb-6"},"Accede a descuentos exclusivos y precios especiales en todos los servicios de nuestras empresas afiliadas."),t.createElement("div",{className:"bg-green-50 p-4 rounded-lg"},t.createElement("span",{className:"text-green-700 font-semibold"},"Hasta 25% de descuento"))),t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-8 text-center"},t.createElement("div",{className:"bg-green-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6"},t.createElement("span",{className:"text-3xl"},"⭐")),t.createElement("h3",{className:"text-2xl font-bold text-gray-900 mb-4"},"Atención Prioritaria"),t.createElement("p",{className:"text-gray-600 mb-6"},"Recibe atención preferencial en todos nuestros proveedores afiliados con citas prioritarias y servicio VIP."),t.createElement("div",{className:"bg-blue-50 p-4 rounded-lg"},t.createElement("span",{className:"text-blue-700 font-semibold"},"Servicio VIP garantizado"))),t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-8 text-center"},t.createElement("div",{className:"bg-purple-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6"},t.createElement("span",{className:"text-3xl"},"🎁")),t.createElement("h3",{className:"text-2xl font-bold text-gray-900 mb-4"},"Promociones Exclusivas"),t.createElement("p",{className:"text-gray-600 mb-6"},"Participa en promociones especiales, sorteos y eventos exclusivos solo para miembros de nuestra comunidad."),t.createElement("div",{className:"bg-purple-50 p-4 rounded-lg"},t.createElement("span",{className:"text-purple-700 font-semibold"},"Eventos mensales")))),t.createElement("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 rounded-2xl p-8 mb-16"},t.createElement("h3",{className:"text-3xl font-bold text-center text-gray-900 mb-12"},"💬 Lo que Dicen Nuestros Clientes"),t.createElement("div",{className:"grid md:grid-cols-2 gap-8"},t.createElement("div",{className:"bg-white rounded-xl p-6 shadow-sm"},t.createElement("div",{className:"flex items-center mb-4"},t.createElement("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4"},t.createElement("span",{className:"text-blue-600 font-bold"},"JC")),t.createElement("div",null,t.createElement("div",{className:"font-semibold text-gray-900"},"Juan Carlos M."),t.createElement("div",{className:"text-gray-600 text-sm"},"Cliente desde 2023"))),t.createElement("p",{className:"text-gray-700 italic"},'"Desde que me registré como cliente, he ahorrado más del 30% en servicios automotrices. La atención es excelente y siempre hay promociones increíbles."')),t.createElement("div",{className:"bg-white rounded-xl p-6 shadow-sm"},t.createElement("div",{className:"flex items-center mb-4"},t.createElement("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-4"},t.createElement("span",{className:"text-green-600 font-bold"},"MR")),t.createElement("div",null,t.createElement("div",{className:"font-semibold text-gray-900"},"María Rodriguez"),t.createElement("div",{className:"text-gray-600 text-sm"},"Cliente desde 2022"))),t.createElement("p",{className:"text-gray-700 italic"},'"La calidad de los proveedores es excepcional. Como cliente registrada, siempre recibo el mejor servicio y precios justos."')))),t.createElement("div",{className:"bg-gradient-to-r from-orange-100 to-red-100 rounded-2xl p-8 mb-16"},t.createElement("div",{className:"text-center mb-8"},t.createElement("h3",{className:"text-3xl font-bold text-gray-900 mb-4"},"🎯 ¿Por Qué Tantas Empresas Quieren Estar Aquí?"),t.createElement("p",{className:"text-xl text-gray-700"},"Porque tenemos una base sólida de ",t.createElement("strong",null,e.totalClientes,"+ clientes registrados"),"que buscan activamente servicios automotrices de calidad.")),t.createElement("div",{className:"grid md:grid-cols-2 gap-8"},t.createElement("div",{className:"bg-white rounded-xl p-6"},t.createElement("h4",{className:"text-xl font-bold text-gray-900 mb-4"},"📊 Demanda Constante"),t.createElement("ul",{className:"space-y-2 text-gray-700"},t.createElement("li",{className:"flex items-center"},t.createElement("span",{className:"text-green-500 mr-2"},"✓")," ",e.transaccionesEsteMes,"+ consultas mensuales"),t.createElement("li",{className:"flex items-center"},t.createElement("span",{className:"text-green-500 mr-2"},"✓")," Clientes activos todo el año"),t.createElement("li",{className:"flex items-center"},t.createElement("span",{className:"text-green-500 mr-2"},"✓")," Búsquedas específicas por categoría"))),t.createElement("div",{className:"bg-white rounded-xl p-6"},t.createElement("h4",{className:"text-xl font-bold text-gray-900 mb-4"},"💎 Clientes de Calidad"),t.createElement("ul",{className:"space-y-2 text-gray-700"},t.createElement("li",{className:"flex items-center"},t.createElement("span",{className:"text-green-500 mr-2"},"✓")," Perfil verificado y confiable"),t.createElement("li",{className:"flex items-center"},t.createElement("span",{className:"text-green-500 mr-2"},"✓")," Buscan calidad, no solo precio"),t.createElement("li",{className:"flex items-center"},t.createElement("span",{className:"text-green-500 mr-2"},"✓")," Leales a buenos proveedores"))))),t.createElement("div",{className:"bg-gradient-to-r from-green-600 via-green-700 to-green-800 rounded-2xl text-white p-12 text-center"},t.createElement("h3",{className:"text-4xl font-bold mb-6"},"🚀 ¡Únete a Nuestra Comunidad Hoy!"),t.createElement("p",{className:"text-xl text-green-100 mb-8 max-w-3xl mx-auto"},"Forma parte de la red automotriz más grande de la Av. 10 de Julio. Miles de clientes ya confían en nosotros para encontrar los mejores servicios."),t.createElement("div",{className:"flex flex-col sm:flex-row gap-6 justify-center"},t.createElement("button",{onClick:()=>a("/registro-cliente"),className:"bg-yellow-400 text-green-900 px-10 py-4 rounded-xl font-bold text-xl hover:bg-yellow-300 transition-colors shadow-xl"},"✨ Registrarme Como Cliente"),t.createElement("button",{onClick:()=>a("/login?tipo=cliente"),className:"bg-white text-green-700 px-10 py-4 rounded-xl font-bold text-xl hover:bg-green-50 transition-colors shadow-xl"},"🔑 Ya Tengo Cuenta"),t.createElement("button",{onClick:()=>a("/proveedores"),className:"border-2 border-white text-white px-10 py-4 rounded-xl font-bold text-xl hover:bg-white hover:text-green-700 transition-colors"},"🔍 Ver Proveedores")))))},I$=()=>{const[a,e]=p.useState([]),[n,r]=p.useState(!0),[s,o]=p.useState("all"),[i,l]=p.useState(""),[c,u]=p.useState(null),d=[{value:"all",label:"Todas las Categorías",icon:"❓"},{value:"mantenimiento",label:"Mantenimiento Vehicular",icon:"🔧"},{value:"repuestos",label:"Selección de Repuestos",icon:"⚙️"},{value:"seguridad",label:"Seguridad Vial",icon:"🛡️"},{value:"general",label:"General",icon:"💡"},{value:"plataforma",label:"Uso de la Plataforma",icon:"💻"}];p.useEffect(()=>{m()},[]);const m=async()=>{r(!0);try{const f=fe(W(F,"recursos_educativos"),pe("tipo","==","faq"),pe("estado","==","activo"),st("orden","asc"),st("fechaCreacion","desc")),v=(await le(f)).docs.map(N=>({id:N.id,...N.data()})),A=[...[{id:"faq-que-es-plataforma",titulo:"¿Qué es la plataforma Av. 10 de Julio?",contenido:"Somos una plataforma digital que conecta a más de 200 proveedores del sector automotriz de la Av. 10 de Julio con clientes que buscan repuestos y servicios de calidad. Facilitamos la búsqueda y comparación de productos, permitiendo a los usuarios encontrar exactamente lo que necesitan.",categoria:"plataforma",orden:1},{id:"faq-como-buscar-repuestos",titulo:"¿Cómo puedo buscar repuestos específicos?",contenido:"Puedes buscar repuestos usando nuestros filtros por marca vehicular, categoría de producto, o utilizando la barra de búsqueda. También puedes navegar por proveedores específicos y ver sus catálogos completos.",categoria:"repuestos",orden:2},{id:"faq-como-contactar-proveedor",titulo:"¿Cómo contacto a un proveedor?",contenido:"En cada perfil de proveedor encontrarás información de contacto incluyendo teléfono, email y dirección. También puedes ver su ubicación en el mapa integrado para visitarlos directamente.",categoria:"plataforma",orden:3},{id:"faq-mantenimiento-preventivo",titulo:"¿Con qué frecuencia debo hacer mantenimiento preventivo?",contenido:"El mantenimiento preventivo debe realizarse según las especificaciones del fabricante, generalmente cada 5,000-10,000 km o cada 6 meses. Incluye cambio de aceite, filtros, revisión de frenos y sistema eléctrico.",categoria:"mantenimiento",orden:4},{id:"faq-elegir-aceite-motor",titulo:"¿Cómo elegir el aceite correcto para mi motor?",contenido:"Debes considerar la viscosidad recomendada por el fabricante (ej: 5W-30), el tipo de motor (gasolina/diésel), la edad del vehículo y las condiciones de manejo. Consulta el manual del propietario o pregunta a un especialista.",categoria:"mantenimiento",orden:5},{id:"faq-cuando-cambiar-frenos",titulo:"¿Cuándo debo cambiar las pastillas de freno?",contenido:"Las pastillas de freno deben cambiarse cuando el grosor sea menor a 3mm, escuches chirridos al frenar, sientas vibraciones en el pedal, o notes que el vehículo se desvía al frenar. La revisión debe ser cada 20,000-30,000 km.",categoria:"mantenimiento",orden:6},{id:"faq-repuestos-originales-vs-alternativos",titulo:"¿Repuestos originales vs alternativos?",contenido:"Los repuestos originales garantizan compatibilidad total pero son más costosos. Los alternativos de calidad pueden ofrecer buen rendimiento a menor precio. Busca marcas reconocidas y verifica garantías.",categoria:"repuestos",orden:7},{id:"faq-seguridad-conduccion",titulo:"¿Cuáles son los elementos básicos de seguridad?",contenido:"Mantén siempre en buen estado: neumáticos (presión y desgaste), frenos, luces, cinturones de seguridad, espejos y limpiaparabrisas. Revisa regularmente el sistema de suspensión y dirección.",categoria:"seguridad",orden:8}],...v].sort((N,x)=>N.orden-x.orden);e(A)}catch(f){console.error("Error fetching FAQs:",f)}finally{r(!1)}},h=a.filter(f=>{const b=s==="all"||f.categoria===s,v=!i||f.titulo.toLowerCase().includes(i.toLowerCase())||f.contenido.toLowerCase().includes(i.toLowerCase());return b&&v}),C=f=>{u(c===f?null:f)},S=f=>{const b=d.find(v=>v.value===f);return b?b.icon:"❓"},w=f=>{const b=d.find(v=>v.value===f);return b?b.label:f};return t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(za,null),t.createElement("div",{className:"max-w-4xl mx-auto px-4 py-8"},t.createElement("div",{className:"text-center mb-12"},t.createElement("h1",{className:"text-4xl font-bold text-gray-900 mb-4"},"❓ Preguntas Frecuentes"),t.createElement("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto"},"Encuentra respuestas a las preguntas más comunes sobre mantenimiento vehicular, repuestos y el uso de nuestra plataforma.")),t.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-8"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Buscar en preguntas frecuentes"),t.createElement("input",{type:"text",value:i,onChange:f=>l(f.target.value),placeholder:"Buscar pregunta o respuesta...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Categoría"),t.createElement("select",{value:s,onChange:f=>o(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},d.map(f=>t.createElement("option",{key:f.value,value:f.value},f.icon," ",f.label))))),t.createElement("div",{className:"flex flex-wrap gap-2"},t.createElement("span",{className:"text-sm font-medium text-gray-700"},"Filtros rápidos:"),d.slice(1).map(f=>t.createElement("button",{key:f.value,onClick:()=>o(f.value),className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${s===f.value?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`},f.icon," ",f.label)))),t.createElement("div",{className:"mb-4 text-sm text-gray-600"},n?"Cargando...":`${h.length} preguntas encontradas`),n?t.createElement("div",{className:"flex justify-center py-12"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})):h.length===0?t.createElement("div",{className:"text-center py-12 text-gray-500"},t.createElement("div",{className:"text-6xl mb-4"},"🤔"),t.createElement("h3",{className:"text-xl font-medium mb-2"},"No se encontraron preguntas"),t.createElement("p",null,"Intenta ajustar los filtros o términos de búsqueda")):t.createElement("div",{className:"space-y-4"},h.map((f,b)=>t.createElement("div",{key:f.id,className:"bg-white rounded-lg shadow-sm border overflow-hidden"},t.createElement("button",{onClick:()=>C(f.id),className:"w-full px-6 py-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors"},t.createElement("div",{className:"flex items-start gap-3 flex-1"},t.createElement("span",{className:"text-xl mt-1"},S(f.categoria)),t.createElement("div",null,t.createElement("h3",{className:"font-semibold text-gray-900 text-lg"},f.titulo),t.createElement("div",{className:"text-sm text-gray-500 mt-1"},w(f.categoria)))),t.createElement("div",{className:"text-2xl text-gray-400"},c===f.id?"−":"+")),c===f.id&&t.createElement("div",{className:"px-6 py-4 border-t bg-gray-50"},t.createElement("div",{className:"text-gray-800 leading-relaxed"},f.contenido.split(`
`).map((v,I)=>t.createElement("p",{key:I,className:"mb-3 last:mb-0"},v))))))),t.createElement("div",{className:"mt-12 bg-blue-50 border border-blue-200 rounded-lg p-8 text-center"},t.createElement("h2",{className:"text-2xl font-bold text-blue-900 mb-4"},"¿No encontraste lo que buscabas?"),t.createElement("p",{className:"text-blue-800 mb-6"},"Explora nuestros recursos educativos o contacta directamente con nuestros proveedores especializados."),t.createElement("div",{className:"flex flex-wrap justify-center gap-4"},t.createElement("button",{onClick:()=>window.location.href="/recursos",className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 font-medium"},"📚 Ver Recursos Educativos"),t.createElement("button",{onClick:()=>window.location.href="/proveedores",className:"bg-white text-blue-600 border border-blue-600 px-6 py-3 rounded-lg hover:bg-blue-50 font-medium"},"🏪 Buscar Proveedores"))),t.createElement("div",{className:"mt-12"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"📂 Categorías Populares"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},d.slice(1).map(f=>{const b=a.filter(v=>v.categoria===f.value).length;return t.createElement("button",{key:f.value,onClick:()=>o(f.value),className:"bg-white border border-gray-200 rounded-lg p-4 text-left hover:shadow-md transition-shadow"},t.createElement("div",{className:"flex items-center gap-3"},t.createElement("span",{className:"text-2xl"},f.icon),t.createElement("div",null,t.createElement("h3",{className:"font-semibold text-gray-900"},f.label),t.createElement("p",{className:"text-sm text-gray-500"},b," pregunta",b!==1?"s":""))))})))))},A$=()=>{const[a,e]=p.useState([]),[n,r]=p.useState([]),[s,o]=p.useState(!0),[i,l]=p.useState("all"),[c,u]=p.useState("all"),[d,m]=p.useState(""),h=Ct(),C=[{value:"all",label:"Todas las Categorías",icon:"📚"},{value:"mantenimiento",label:"Mantenimiento Vehicular",icon:"🔧"},{value:"repuestos",label:"Selección de Repuestos",icon:"⚙️"},{value:"seguridad",label:"Seguridad Vial",icon:"🛡️"},{value:"general",label:"General",icon:"💡"}],S=[{value:"all",label:"Todos los Tipos",icon:"📄"},{value:"blog",label:"Artículos",icon:"📝"},{value:"tip",label:"Tips",icon:"💡"},{value:"tutorial",label:"Tutoriales",icon:"🎓"},{value:"video",label:"Videos",icon:"🎥"},{value:"faq",label:"FAQ",icon:"❓"}];p.useEffect(()=>{w()},[]),p.useEffect(()=>{f()},[a,i,c,d]);const w=async()=>{o(!0);try{const y=fe(W(F,"recursos_educativos"),pe("estado","==","activo"),st("orden","asc"),st("fechaCreacion","desc")),E=await le(y);e(E.docs.map(_=>({id:_.id,..._.data()})))}catch(y){console.error("Error fetching resources:",y)}finally{o(!1)}},f=()=>{let y=a;if(i!=="all"&&(y=y.filter(E=>E.categoria===i)),c!=="all"&&(y=y.filter(E=>E.tipo===c)),d.trim()){const E=d.toLowerCase();y=y.filter(_=>{var P;return _.titulo.toLowerCase().includes(E)||((P=_.descripcion)==null?void 0:P.toLowerCase().includes(E))||_.contenido.toLowerCase().includes(E)||_.tags&&_.tags.some(k=>k.toLowerCase().includes(E))})}r(y)},b=y=>y?y.toDate?y.toDate().toLocaleDateString():y instanceof Date?y.toLocaleDateString():new Date(y).toLocaleDateString():"",v=y=>{const E=S.find(_=>_.value===y);return E?E.icon:"📄"},I=y=>{const E=S.find(_=>_.value===y);return E?E.label:y},A=y=>{const E=C.find(_=>_.value===y);return E?E.label:y},N=y=>{h(`/recursos/${y.id}`)},x=y=>{if(!y)return"";const E=/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/,_=y.match(E);return _?`https://www.youtube.com/embed/${_[1]}`:""};return t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(za,null),t.createElement("div",{className:"max-w-7xl mx-auto px-4 py-8"},t.createElement("div",{className:"text-center mb-12"},t.createElement("h1",{className:"text-4xl font-bold text-gray-900 mb-4"},"📚 Centro de Recursos Educativos"),t.createElement("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto"},"Aprende sobre mantenimiento vehicular, selección de repuestos y mucho más con nuestros recursos educativos especializados.")),t.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-8"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Buscar recursos"),t.createElement("input",{type:"text",value:d,onChange:y=>m(y.target.value),placeholder:"Buscar por título, contenido o tags...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Categoría"),t.createElement("select",{value:i,onChange:y=>l(y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},C.map(y=>t.createElement("option",{key:y.value,value:y.value},y.icon," ",y.label)))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Tipo de contenido"),t.createElement("select",{value:c,onChange:y=>u(y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},S.map(y=>t.createElement("option",{key:y.value,value:y.value},y.icon," ",y.label))))),t.createElement("div",{className:"flex flex-wrap gap-2"},t.createElement("span",{className:"text-sm font-medium text-gray-700"},"Filtros rápidos:"),C.slice(1).map(y=>t.createElement("button",{key:y.value,onClick:()=>l(y.value),className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${i===y.value?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`},y.icon," ",y.label)))),t.createElement("div",{className:"mb-4 text-sm text-gray-600"},s?"Cargando...":`${n.length} recursos encontrados`),s?t.createElement("div",{className:"flex justify-center py-12"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})):n.length===0?t.createElement("div",{className:"text-center py-12 text-gray-500"},t.createElement("div",{className:"text-6xl mb-4"},"🔍"),t.createElement("h3",{className:"text-xl font-medium mb-2"},"No se encontraron recursos"),t.createElement("p",null,"Intenta ajustar los filtros o términos de búsqueda")):t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},n.map(y=>t.createElement("div",{key:y.id,onClick:()=>N(y),className:"bg-white rounded-lg shadow-sm border hover:shadow-md transition-shadow cursor-pointer overflow-hidden"},y.tipo==="video"&&y.videoUrl?t.createElement("div",{className:"relative h-48 bg-gray-900"},x(y.videoUrl)?t.createElement("iframe",{src:x(y.videoUrl),className:"w-full h-full",allowFullScreen:!0,title:y.titulo}):t.createElement("div",{className:"w-full h-full flex items-center justify-center text-white"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-4xl mb-2"},"🎥"),t.createElement("div",{className:"text-sm"},"Video")))):y.imagenUrl?t.createElement("img",{src:y.imagenUrl,alt:y.titulo,className:"w-full h-48 object-cover"}):t.createElement("div",{className:"w-full h-48 bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center"},t.createElement("div",{className:"text-center text-white"},t.createElement("div",{className:"text-4xl mb-2"},v(y.tipo)),t.createElement("div",{className:"text-sm font-medium"},I(y.tipo)))),t.createElement("div",{className:"p-6"},t.createElement("div",{className:"flex items-center justify-between mb-3"},t.createElement("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full"},v(y.tipo)," ",I(y.tipo)),t.createElement("span",{className:"text-xs text-gray-500"},A(y.categoria))),t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2"},y.titulo),y.descripcion&&t.createElement("p",{className:"text-gray-600 text-sm mb-3 line-clamp-3"},y.descripcion),y.tags&&y.tags.length>0&&t.createElement("div",{className:"flex flex-wrap gap-1 mb-3"},y.tags.slice(0,3).map((E,_)=>t.createElement("span",{key:_,className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded"},"#",E)),y.tags.length>3&&t.createElement("span",{className:"text-xs text-gray-500"},"+",y.tags.length-3)),t.createElement("div",{className:"text-xs text-gray-400"},b(y.fechaCreacion)))))),!s&&!d&&i==="all"&&c==="all"&&t.createElement("div",{className:"mt-16"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"🔥 Recursos Más Populares"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},n.slice(0,4).map(y=>{var E;return t.createElement("div",{key:`popular-${y.id}`,onClick:()=>N(y),className:"bg-white rounded-lg shadow-sm border hover:shadow-md transition-shadow cursor-pointer p-6"},t.createElement("div",{className:"flex items-start gap-4"},t.createElement("div",{className:"text-3xl"},v(y.tipo)),t.createElement("div",{className:"flex-1"},t.createElement("h3",{className:"font-semibold text-gray-900 mb-1"},y.titulo),t.createElement("p",{className:"text-sm text-gray-600 mb-2"},(E=y.descripcion)==null?void 0:E.substring(0,120),"..."),t.createElement("div",{className:"flex items-center gap-2 text-xs text-gray-500"},t.createElement("span",null,I(y.tipo)),t.createElement("span",null,"•"),t.createElement("span",null,A(y.categoria))))))})))))},T$=()=>{const{resourceId:a}=Ni(),e=Ct(),[n,r]=p.useState(null),[s,o]=p.useState([]),[i,l]=p.useState(!0),[c,u]=p.useState("");p.useEffect(()=>{d()},[a]);const d=async()=>{l(!0);try{const b=await en(Ne(F,"recursos_educativos",a));if(!b.exists()){u("Recurso no encontrado");return}const v={id:b.id,...b.data()};if(r(v),v.categoria){const I=fe(W(F,"recursos_educativos"),pe("categoria","==",v.categoria),pe("estado","==","activo"),Ot(4)),N=(await le(I)).docs.map(x=>({id:x.id,...x.data()})).filter(x=>x.id!==a);o(N)}}catch(b){console.error("Error fetching resource details:",b),u("Error al cargar el recurso")}finally{l(!1)}},m=b=>b?b.toDate?b.toDate().toLocaleDateString():b instanceof Date?b.toLocaleDateString():new Date(b).toLocaleDateString():"",h=b=>{switch(b){case"blog":return"📝";case"tip":return"💡";case"tutorial":return"🎓";case"video":return"🎥";case"faq":return"❓";default:return"📄"}},C=b=>{switch(b){case"blog":return"Artículo de Blog";case"tip":return"Tip/Consejo";case"tutorial":return"Tutorial";case"video":return"Video";case"faq":return"Pregunta Frecuente";default:return b}},S=b=>{switch(b){case"mantenimiento":return"Mantenimiento Vehicular";case"repuestos":return"Selección de Repuestos";case"seguridad":return"Seguridad Vial";case"general":return"General";default:return b}},w=b=>{if(!b)return"";const v=/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/,I=b.match(v);return I?`https://www.youtube.com/embed/${I[1]}`:""},f=b=>b?b.split(`
`).filter(v=>v.trim()).map((v,I)=>t.createElement("p",{key:I,className:"mb-4 text-gray-800 leading-relaxed"},v.trim())):"";return i?t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(za,null),t.createElement("div",{className:"flex justify-center items-center h-96"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}))):c||!n?t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(za,null),t.createElement("div",{className:"max-w-4xl mx-auto px-4 py-8"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-6xl mb-4"},"😕"),t.createElement("h1",{className:"text-2xl font-bold text-gray-900 mb-4"},c||"Recurso no encontrado"),t.createElement("button",{onClick:()=>e("/recursos"),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"Volver a Recursos")))):t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(za,null),t.createElement("div",{className:"max-w-4xl mx-auto px-4 py-8"},t.createElement("div",{className:"mb-6"},t.createElement("button",{onClick:()=>e("/recursos"),className:"text-blue-600 hover:text-blue-800 flex items-center gap-1"},"← Volver a Recursos")),t.createElement("article",{className:"bg-white rounded-lg shadow-sm border overflow-hidden"},n.tipo==="video"&&n.videoUrl?t.createElement("div",{className:"relative h-64 md:h-96 bg-gray-900"},w(n.videoUrl)?t.createElement("iframe",{src:w(n.videoUrl),className:"w-full h-full",allowFullScreen:!0,title:n.titulo}):t.createElement("div",{className:"w-full h-full flex items-center justify-center text-white"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-6xl mb-4"},"🎥"),t.createElement("div",{className:"text-lg"},"Video no disponible")))):n.imagenUrl?t.createElement("img",{src:n.imagenUrl,alt:n.titulo,className:"w-full h-64 md:h-96 object-cover"}):t.createElement("div",{className:"w-full h-64 md:h-96 bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center"},t.createElement("div",{className:"text-center text-white"},t.createElement("div",{className:"text-6xl mb-4"},h(n.tipo)),t.createElement("div",{className:"text-xl font-medium"},C(n.tipo)))),t.createElement("div",{className:"p-8"},t.createElement("div",{className:"flex flex-wrap items-center gap-4 mb-6"},t.createElement("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm font-medium rounded-full"},h(n.tipo)," ",C(n.tipo)),t.createElement("span",{className:"px-3 py-1 bg-green-100 text-green-800 text-sm font-medium rounded-full"},"📚 ",S(n.categoria)),t.createElement("span",{className:"text-sm text-gray-500"},"📅 ",m(n.fechaCreacion))),t.createElement("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4"},n.titulo),n.descripcion&&t.createElement("div",{className:"text-xl text-gray-600 mb-8 leading-relaxed"},n.descripcion),n.tags&&n.tags.length>0&&t.createElement("div",{className:"mb-8"},t.createElement("div",{className:"flex flex-wrap gap-2"},n.tags.map((b,v)=>t.createElement("span",{key:v,className:"px-3 py-1 bg-gray-100 text-gray-700 text-sm rounded-full"},"#",b)))),t.createElement("div",{className:"prose prose-lg max-w-none"},n.tipo==="faq"?t.createElement("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-6 rounded"},t.createElement("div",{className:"flex"},t.createElement("div",{className:"text-2xl mr-3"},"❓"),t.createElement("div",null,t.createElement("h3",{className:"text-lg font-semibold text-blue-900 mb-2"},"Pregunta Frecuente"),t.createElement("div",{className:"text-blue-800"},f(n.contenido))))):n.tipo==="tip"?t.createElement("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-6 rounded"},t.createElement("div",{className:"flex"},t.createElement("div",{className:"text-2xl mr-3"},"💡"),t.createElement("div",null,t.createElement("h3",{className:"text-lg font-semibold text-yellow-900 mb-2"},"Tip Profesional"),t.createElement("div",{className:"text-yellow-800"},f(n.contenido))))):t.createElement("div",{className:"text-lg leading-relaxed"},f(n.contenido))),t.createElement("div",{className:"mt-12 p-6 bg-blue-50 rounded-lg border border-blue-200"},t.createElement("h3",{className:"text-lg font-semibold text-blue-900 mb-2"},"¿Te resultó útil este contenido?"),t.createElement("p",{className:"text-blue-800 mb-4"},"Explora más recursos educativos en nuestro centro de aprendizaje."),t.createElement("div",{className:"flex gap-3"},t.createElement("button",{onClick:()=>e("/recursos"),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"Ver más recursos"),t.createElement("button",{onClick:()=>e("/proveedores"),className:"bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300"},"Buscar proveedores"))))),s.length>0&&t.createElement("div",{className:"mt-12"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"📚 Recursos Relacionados"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},s.map(b=>{var v;return t.createElement("div",{key:b.id,onClick:()=>e(`/recursos/${b.id}`),className:"bg-white rounded-lg shadow-sm border hover:shadow-md transition-shadow cursor-pointer p-6"},t.createElement("div",{className:"flex items-start gap-4"},t.createElement("div",{className:"text-2xl"},h(b.tipo)),t.createElement("div",{className:"flex-1"},t.createElement("h3",{className:"font-semibold text-gray-900 mb-1"},b.titulo),t.createElement("p",{className:"text-sm text-gray-600 mb-2"},(v=b.descripcion)==null?void 0:v.substring(0,100),"..."),t.createElement("div",{className:"flex items-center gap-2 text-xs text-gray-500"},t.createElement("span",null,C(b.tipo)),t.createElement("span",null,"•"),t.createElement("span",null,m(b.fechaCreacion))))))})))))},P$=({type:a="general",onSubmitted:e=()=>{},className:n=""})=>{const{user:r}=ht(),[s,o]=p.useState({nombre:(r==null?void 0:r.displayName)||"",email:(r==null?void 0:r.email)||"",telefono:"",asunto:"",categoria:"",mensaje:"",prioridad:"media"}),[i,l]=p.useState(!1),[c,u]=p.useState(!1),[d,m]=p.useState(""),h={general:["Información general","Consulta sobre productos","Consulta sobre servicios","Otros"],suggestion:["Mejora de funcionalidades","Nueva característica","Mejora de diseño","Mejora de contenido","Otros"],complaint:["Problema con proveedor","Problema técnico","Problema de calidad","Problema de servicio","Otros"],support:["Problema técnico","Ayuda con cuenta","Ayuda con pedidos","Ayuda con navegación","Otros"]},C=[{value:"baja",label:"🟢 Baja",color:"text-green-600"},{value:"media",label:"🟡 Media",color:"text-yellow-600"},{value:"alta",label:"🟠 Alta",color:"text-orange-600"},{value:"urgente",label:"🔴 Urgente",color:"text-red-600"}],S=()=>{switch(a){case"suggestion":return{title:"💡 Formulario de Sugerencias",subtitle:"Ayúdanos a mejorar con tus ideas y comentarios",buttonText:"Enviar Sugerencia"};case"complaint":return{title:"⚠️ Formulario de Reclamos",subtitle:"Reporta cualquier problema o inconveniente",buttonText:"Enviar Reclamo"};case"support":return{title:"🆘 Formulario de Soporte",subtitle:"Obtén ayuda técnica y resuelve tus dudas",buttonText:"Solicitar Ayuda"};default:return{title:"📧 Formulario de Contacto",subtitle:"Contáctanos para cualquier consulta",buttonText:"Enviar Mensaje"}}},{title:w,subtitle:f,buttonText:b}=S(),v=A=>{const{name:N,value:x}=A.target;o(y=>({...y,[N]:x}))},I=async A=>{if(A.preventDefault(),l(!0),m(""),!s.nombre.trim()){m("El nombre es requerido"),l(!1);return}if(!s.email.trim()){m("El email es requerido"),l(!1);return}if(!s.asunto.trim()){m("El asunto es requerido"),l(!1);return}if(!s.mensaje.trim()||s.mensaje.trim().length<10){m("El mensaje debe tener al menos 10 caracteres"),l(!1);return}try{const N={...s,tipo:a,estado:"abierto",fechaCreacion:sa(),fechaActualizacion:sa(),usuarioId:(r==null?void 0:r.uid)||null,respuestas:[],visto:!1,resuelto:!1},x=await ot(W(F,"tickets"),N);u(!0),e(x.id),o({nombre:(r==null?void 0:r.displayName)||"",email:(r==null?void 0:r.email)||"",telefono:"",asunto:"",categoria:"",mensaje:"",prioridad:"media"})}catch(N){console.error("Error submitting form:",N),m("Error al enviar el formulario. Inténtalo de nuevo.")}finally{l(!1)}};if(c){const N=(()=>{switch(a){case"suggestion":return{title:"¡Sugerencia recibida!",message:"Agradecemos tu sugerencia para mejorar nuestra plataforma.",detail:"Nuestro equipo revisará tu propuesta y considerará implementarla en futuras actualizaciones.",followUp:"Te mantendremos informado sobre el estado de tu sugerencia."};case"complaint":return{title:"¡Reclamo registrado!",message:"Hemos registrado tu reclamo y lo estamos investigando.",detail:"Nuestro equipo de atención al cliente revisará tu caso prioritariamente.",followUp:"Te contactaremos dentro de las próximas 24 horas para darte seguimiento."};case"support":return{title:"¡Solicitud de soporte recibida!",message:"Hemos recibido tu solicitud de ayuda técnica.",detail:"Nuestro equipo técnico está revisando tu consulta para brindarte la mejor solución.",followUp:"Te responderemos con una solución o pasos a seguir muy pronto."};default:return{title:"¡Mensaje enviado correctamente!",message:"Hemos recibido tu consulta.",detail:"Nuestro equipo revisará tu mensaje y te proporcionará la información solicitada.",followUp:"Te contactaremos pronto a través del email proporcionado."}}})();return t.createElement("div",{className:`bg-green-50 border border-green-200 rounded-lg p-6 ${n}`},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-4xl mb-4"},"✅"),t.createElement("h3",{className:"text-lg font-semibold text-green-900 mb-2"},N.title),t.createElement("p",{className:"text-green-800 mb-3"},N.message),t.createElement("p",{className:"text-green-700 text-sm mb-3"},N.detail),t.createElement("p",{className:"text-green-600 text-sm mb-4 font-medium"},N.followUp),r&&t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3 mb-4"},t.createElement("p",{className:"text-blue-800 text-sm"},"💡 Puedes ver el estado de todas tus consultas en la sección"," ",t.createElement("a",{href:"/mis-consultas",className:"font-medium underline hover:text-blue-900"},'"Mis Consultas"'))),t.createElement("div",{className:"flex flex-col sm:flex-row gap-3 justify-center"},t.createElement("button",{onClick:()=>u(!1),className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition-colors"},"Enviar otro mensaje"),r&&t.createElement("a",{href:"/mis-consultas",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors text-center"},"Ver mis consultas"))))}return t.createElement("div",{className:`bg-white rounded-lg shadow-sm border border-gray-200 ${n}`},t.createElement("div",{className:"p-6"},t.createElement("div",{className:"mb-6"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},w),t.createElement("p",{className:"text-gray-600"},f)),t.createElement("form",{onSubmit:I,className:"space-y-4"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Nombre completo *"),t.createElement("input",{type:"text",name:"nombre",value:s.nombre,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Email *"),t.createElement("input",{type:"email",name:"email",value:s.email,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}))),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Teléfono"),t.createElement("input",{type:"tel",name:"telefono",value:s.telefono,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Categoría"),t.createElement("select",{name:"categoria",value:s.categoria,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},t.createElement("option",{value:""},"Seleccionar categoría"),h[a].map(A=>t.createElement("option",{key:A,value:A},A))))),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Asunto *"),t.createElement("input",{type:"text",name:"asunto",value:s.asunto,onChange:v,placeholder:"Describe brevemente tu consulta",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Prioridad"),t.createElement("select",{name:"prioridad",value:s.prioridad,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},C.map(A=>t.createElement("option",{key:A.value,value:A.value},A.label))))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Mensaje *"),t.createElement("textarea",{name:"mensaje",value:s.mensaje,onChange:v,rows:6,placeholder:"Describe detalladamente tu consulta, sugerencia o problema...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),t.createElement("div",{className:"text-xs text-gray-500 mt-1"},s.mensaje.length,"/1000 caracteres (mínimo 10)")),d&&t.createElement("div",{className:"bg-red-50 border border-red-200 rounded p-3"},t.createElement("p",{className:"text-red-800 text-sm"},d)),t.createElement("div",{className:"flex justify-end"},t.createElement("button",{type:"submit",disabled:i,className:"bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},i?"Enviando...":b)))))},R$=()=>{var u,d;const[a]=Ez(),[e,n]=p.useState("general"),[r,s]=p.useState(!1);p.useEffect(()=>{const m=a.get("type");m&&["general","suggestion","complaint","support"].includes(m)&&(n(m),s(!0))},[a]);const o=[{id:"general",title:"Consulta General",description:"Información sobre productos, servicios o la plataforma",icon:Wu,color:"blue"},{id:"suggestion",title:"Sugerencias",description:"Comparte ideas para mejorar la plataforma",icon:MA,color:"yellow"},{id:"complaint",title:"Reclamos",description:"Reporta problemas o inconvenientes",icon:PE,color:"red"},{id:"support",title:"Soporte Técnico",description:"Ayuda con problemas técnicos de la plataforma",icon:$z,color:"green"}],i=(m,h=!1)=>({blue:h?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300",yellow:h?"border-yellow-500 bg-yellow-50":"border-gray-200 hover:border-yellow-300",red:h?"border-red-500 bg-red-50":"border-gray-200 hover:border-red-300",green:h?"border-green-500 bg-green-50":"border-gray-200 hover:border-green-300"})[m],l=m=>({blue:"text-blue-600",yellow:"text-yellow-600",red:"text-red-600",green:"text-green-600"})[m],c=()=>{s(!1)};return t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(za,null),t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement("div",{className:"bg-white shadow-sm"},t.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"},t.createElement("div",{className:"text-center"},t.createElement("h1",{className:"text-4xl font-bold text-gray-900 mb-4"},"Contáctanos"),t.createElement("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto"},"Estamos aquí para ayudarte. Elige el tipo de consulta que mejor se adapte a tu necesidad y nos pondremos en contacto contigo lo antes posible.")))),t.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"},t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},t.createElement("div",{className:"lg:col-span-1"},t.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Información de Contacto"),t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"flex items-center"},t.createElement(r7,{className:"h-5 w-5 text-gray-400 mr-3"}),t.createElement("div",null,t.createElement("p",{className:"text-sm text-gray-600"},"Teléfono"),t.createElement("p",{className:"font-medium text-gray-900"},"+56 2 2345 6789"))),t.createElement("div",{className:"flex items-center"},t.createElement(t7,{className:"h-5 w-5 text-gray-400 mr-3"}),t.createElement("div",null,t.createElement("p",{className:"text-sm text-gray-600"},"Email"),t.createElement("p",{className:"font-medium text-gray-900"},"contacto@av10dejulio.cl"))),t.createElement("div",{className:"flex items-center"},t.createElement(Zz,{className:"h-5 w-5 text-gray-400 mr-3"}),t.createElement("div",null,t.createElement("p",{className:"text-sm text-gray-600"},"Dirección"),t.createElement("p",{className:"font-medium text-gray-900"},"Av. 10 de Julio 1234",t.createElement("br",null),"Santiago, Chile"))))),t.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Horarios de Atención"),t.createElement("div",{className:"space-y-2"},t.createElement("div",{className:"flex justify-between"},t.createElement("span",{className:"text-gray-600"},"Lunes - Viernes"),t.createElement("span",{className:"font-medium text-gray-900"},"9:00 - 18:00")),t.createElement("div",{className:"flex justify-between"},t.createElement("span",{className:"text-gray-600"},"Sábado"),t.createElement("span",{className:"font-medium text-gray-900"},"9:00 - 14:00")),t.createElement("div",{className:"flex justify-between"},t.createElement("span",{className:"text-gray-600"},"Domingo"),t.createElement("span",{className:"font-medium text-gray-900"},"Cerrado")))),t.createElement("div",{className:"mt-6"},t.createElement("a",{href:"/mis-consultas",className:"block w-full text-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"},"Ver mis consultas anteriores"))),t.createElement("div",{className:"lg:col-span-2"},r?t.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6"},t.createElement("div",{className:"flex items-center justify-between mb-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},(d=o.find(m=>m.id===e))==null?void 0:d.title),t.createElement("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-gray-600"},t.createElement("span",{className:"sr-only"},"Volver"),"←")),t.createElement(P$,{type:e,onSubmitted:c,className:"max-w-none"})):t.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-6"},"¿En qué podemos ayudarte?"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"},o.map(m=>{const h=m.icon,C=e===m.id;return t.createElement("button",{key:m.id,onClick:()=>n(m.id),className:`p-4 border-2 rounded-lg text-left transition-all ${i(m.color,C)}`},t.createElement("div",{className:"flex items-start"},t.createElement(h,{className:`h-6 w-6 mr-3 mt-1 ${l(m.color)}`}),t.createElement("div",null,t.createElement("h4",{className:"font-medium text-gray-900 mb-1"},m.title),t.createElement("p",{className:"text-sm text-gray-600"},m.description))))})),t.createElement("button",{onClick:()=>s(!0),className:"w-full px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors"},"Continuar con ",(u=o.find(m=>m.id===e))==null?void 0:u.title)))))))},D$=()=>t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(za,null),t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement(wT,null))),L$=()=>t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(za,null),t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement(_T,null))),M$=()=>t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(za,null),t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement(CT,null))),V$=()=>t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(za,null),t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement(ST,null))),O$=()=>t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement(za,null),t.createElement("div",{className:"container mx-auto px-4 py-8"},t.createElement(kT,null)));function Eh(){const{id:a}=Ni(),e=Ct(),[n,r]=p.useState(null),[s,o]=p.useState([]),[i,l]=p.useState([]),[c,u]=p.useState(!0),[d,m]=p.useState(null),h=f=>{if(!f||typeof f=="string")return f||"No disponibles";const b={lunes:"Lunes",martes:"Martes",miercoles:"Miércoles",jueves:"Jueves",viernes:"Viernes",sabado:"Sábado",domingo:"Domingo"},v=[];return Object.entries(f).forEach(([I,A])=>{if(A&&A.abierto){let N=`${b[I]}: `;A.turno_continuo?N+=`${A.apertura} - ${A.cierre}`:N+=`${A.apertura} - ${A.descanso_inicio}, ${A.descanso_fin} - ${A.cierre}`,v.push(N)}}),v.length>0?v.join(", "):"No disponibles"};p.useEffect(()=>{a&&(C(),S(),w())},[a]);const C=async()=>{try{const f=await en(Ne(F,"empresas",a));f.exists()?r({id:f.id,...f.data()}):m("Empresa no encontrada")}catch(f){m("Error al cargar datos de la empresa"),console.error("Error:",f)}finally{u(!1)}},S=async()=>{try{const f=fe(W(F,"productos"),pe("empresaId","==",a),pe("estado","==","aprobado"),st("fechaCreacion","desc"),Ot(6)),v=(await le(f)).docs.map(I=>({id:I.id,...I.data()}));o(v)}catch(f){console.error("Error al cargar productos:",f)}},w=async()=>{try{const f=fe(W(F,"campanas"),pe("empresaId","==",a),pe("estado","==","aprobada"),st("fechaCreacion","desc"),Ot(6)),v=(await le(f)).docs.map(I=>({id:I.id,...I.data()}));l(v)}catch(f){console.error("Error al cargar campañas:",f)}};return c?t.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),t.createElement("p",{className:"mt-4 text-lg text-gray-600"},"Cargando perfil de empresa..."))):d?t.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-red-600 text-6xl mb-4"},"⚠️"),t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Error"),t.createElement("p",{className:"text-gray-600 mb-4"},d),t.createElement("button",{onClick:()=>e("/"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700"},"Volver al inicio"))):t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement("div",{className:"bg-white shadow-sm border-b"},t.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},t.createElement("div",{className:"flex justify-between items-center py-4"},t.createElement("div",null,t.createElement("h1",{className:"text-2xl font-bold text-gray-900"},n==null?void 0:n.nombre),t.createElement("p",{className:"text-gray-600"},(n==null?void 0:n.rubro)||"Servicios automotrices")),t.createElement("div",{className:"flex space-x-3"},t.createElement("button",{onClick:()=>e("/"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700"},"Volver al Sitio"))))),t.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},t.createElement("div",{className:"lg:col-span-1 space-y-6"},t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Información de la Empresa"),t.createElement("div",{className:"space-y-3"},t.createElement("div",null,t.createElement("span",{className:"text-sm font-medium text-gray-500"},"Rubro:"),t.createElement("p",{className:"text-gray-900"},(n==null?void 0:n.rubro)||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"text-sm font-medium text-gray-500"},"Dirección:"),t.createElement("p",{className:"text-gray-900"},(n==null?void 0:n.direccion)||"No especificada")),t.createElement("div",null,t.createElement("span",{className:"text-sm font-medium text-gray-500"},"Teléfono:"),t.createElement("p",{className:"text-gray-900"},(n==null?void 0:n.telefono)||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"text-sm font-medium text-gray-500"},"Email:"),t.createElement("p",{className:"text-gray-900"},(n==null?void 0:n.email)||"No especificado")),(n==null?void 0:n.web)&&t.createElement("div",null,t.createElement("span",{className:"text-sm font-medium text-gray-500"},"Sitio Web:"),t.createElement("a",{href:n.web,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 block"},n.web)))),(n==null?void 0:n.descripcion)&&t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Descripción"),t.createElement("p",{className:"text-gray-600"},n.descripcion)),(n==null?void 0:n.servicios)&&n.servicios.length>0&&t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Servicios"),t.createElement("div",{className:"space-y-2"},n.servicios.map((f,b)=>t.createElement("div",{key:b,className:"flex items-center"},t.createElement("span",{className:"text-green-600 mr-2"},"✓"),t.createElement("span",{className:"text-gray-700"},f)))))),t.createElement("div",{className:"lg:col-span-2 space-y-6"},t.createElement("div",{className:"bg-white rounded-lg shadow"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Productos Destacados")),t.createElement("div",{className:"p-6"},s.length===0?t.createElement("div",{className:"text-center py-8"},t.createElement("div",{className:"text-gray-400 text-6xl mb-4"},"📦"),t.createElement("p",{className:"text-gray-600"},"Aún no hay productos disponibles")):t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},s.map(f=>t.createElement("div",{key:f.id,className:"border border-gray-200 rounded-lg p-4"},t.createElement("h4",{className:"font-semibold text-gray-900 mb-2"},f.nombre),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},f.descripcion),t.createElement("div",{className:"flex justify-between items-center"},t.createElement("span",{className:"text-lg font-bold text-blue-600"},"$",f.precio||"Consultar"),t.createElement("span",{className:"text-xs text-gray-500"},new Date(f.fechaCreacion).toLocaleDateString()))))))),t.createElement("div",{className:"bg-white rounded-lg shadow"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Campañas Activas")),t.createElement("div",{className:"p-6"},i.length===0?t.createElement("div",{className:"text-center py-8"},t.createElement("div",{className:"text-gray-400 text-6xl mb-4"},"🎯"),t.createElement("p",{className:"text-gray-600"},"Aún no hay campañas activas")):t.createElement("div",{className:"space-y-4"},i.map(f=>t.createElement("div",{key:f.id,className:"border border-gray-200 rounded-lg p-4"},t.createElement("h4",{className:"font-semibold text-gray-900 mb-2"},f.nombre),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},f.descripcion),t.createElement("div",{className:"flex justify-between items-center"},t.createElement("div",{className:"text-sm text-gray-500"},t.createElement("span",null,"Válida hasta: "),t.createElement("span",{className:"font-medium"},new Date(f.fechaFin).toLocaleDateString())),f.descuento&&t.createElement("span",{className:"bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium"},f.descuento,"% OFF"))))))),t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Contactar"),t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"flex items-center"},t.createElement("span",{className:"text-blue-600 mr-3"},"📞"),t.createElement("div",null,t.createElement("p",{className:"font-medium text-gray-900"},"Teléfono"),t.createElement("p",{className:"text-gray-600"},(n==null?void 0:n.telefono)||"No disponible"))),t.createElement("div",{className:"flex items-center"},t.createElement("span",{className:"text-blue-600 mr-3"},"✉️"),t.createElement("div",null,t.createElement("p",{className:"font-medium text-gray-900"},"Email"),t.createElement("p",{className:"text-gray-600"},(n==null?void 0:n.email)||"No disponible"))),t.createElement("div",{className:"flex items-center"},t.createElement("span",{className:"text-blue-600 mr-3"},"📍"),t.createElement("div",null,t.createElement("p",{className:"font-medium text-gray-900"},"Dirección"),t.createElement("p",{className:"text-gray-600"},(n==null?void 0:n.direccion)||"No disponible"))),(n==null?void 0:n.horarios)&&t.createElement("div",{className:"flex items-center"},t.createElement("span",{className:"text-blue-600 mr-3"},"🕒"),t.createElement("div",null,t.createElement("p",{className:"font-medium text-gray-900"},"Horarios de Atención"),t.createElement("p",{className:"text-gray-600"},typeof n.horarios=="string"?n.horarios:h(n.horarios))))))))))}function K_(){var ur,Tn,fo,ho,cc,Vt,vo,ms,ps,Ad,uc,Td,Pd,Rd,Dd,gs,Bn,dc,mc,pc,Dr,Ld,Md,Vd,qn,Od,jd,bo;const{empresaId:a}=Ni(),[e,n]=p.useState(null),[r,s]=p.useState(null),[o,i]=p.useState([]),[l,c]=p.useState([]),[u,d]=p.useState([]),[m,h]=p.useState({}),[C,S]=p.useState(!0),[w,f]=p.useState(""),[b,v]=p.useState("overview"),[I,A]=p.useState(!1),[N,x]=p.useState(!1),[y,E]=p.useState({nombre:"",descripcion:"",precio:"",categoria:"",marca:"",stock:"",imagen:null}),[_,P]=p.useState({titulo:"",descripcion:"",fechaInicio:"",fechaFin:"",presupuesto:"",tipo:"promocional"}),[k,D]=p.useState(!1),[M,$]=p.useState([]),[q,V]=p.useState([]),[z,j]=p.useState(!1),[U,Q]=p.useState([]),[te,se]=p.useState(!1),[X,ye]=p.useState(!1),[Y,Se]=p.useState([]),[de,oe]=p.useState(""),[ge,me]=p.useState(null),[he,G]=p.useState([]),[we,Te]=p.useState(!1),[B,ve]=p.useState({solicitudesDelMes:0,solicitudesAprobadas:0,solicitudesRechazadas:0,tiempoPromedioRespuesta:0,productosActivos:0,campanasActivas:0}),[je,_e]=p.useState(!1),[H,Pe]=p.useState({fechaInicio:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],fechaFin:new Date().toISOString().split("T")[0],tipo:"todos",estado:"todos"}),[Ye,it]=p.useState(!1),[mt,be]=p.useState([]),[Re,qe]=p.useState([]),[Me,Xe]=p.useState(new Date),[ft,ca]=p.useState("mes"),[ea,Tt]=p.useState(!1),[He,$t]=p.useState({titulo:"",descripcion:"",fechaInicio:"",fechaFin:"",tipo:"general",prioridad:"normal",recordatorio:!0,recordatorioAntes:"1_dia"}),[ne,K]=p.useState(!1),[Ge,Ke]=p.useState(!1),[Ze,et]=p.useState(!1),[Ue,Je]=p.useState(!1),[We,Rt]=p.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[lt,Dt]=p.useState({currentEmail:"",newEmail:"",confirmEmail:"",password:""}),[ut,ka]=p.useState({isEnabled:!1,method:"sms",phoneNumber:""}),[tt,ir]=p.useState({plan:"free",fechaInicio:null,fechaVencimiento:null,estado:"activa",caracteristicas:[],limitaciones:[]}),[$e,rc]=p.useState(!1);p.useState([]);const[ta,Un]=p.useState({email:"",password:"",confirmPassword:"",isProvisional:!0}),ef=async L=>{if(L.preventDefault(),ta.password!==ta.confirmPassword){alert("Las contraseñas no coinciden");return}if(ta.password.length<6){alert("La contraseña debe tener al menos 6 caracteres");return}try{const ie=(await es(iu(),ta.email,ta.password)).user;await ze(Ne(F,"empresas",r),{"credenciales.email":ta.email,"credenciales.password":ta.password,"credenciales.esProvisoria":ta.isProvisional,"credenciales.fechaAsignacion":new Date,"credenciales.fechaUltimoCambio":new Date,"credenciales.uid":ie.uid,"credenciales.estado":"activa"});try{await Ar(Ne(F,"usuarios",ie.uid),{email:ta.email,rol:"proveedor",empresaId:r,fechaCreacion:new Date,ultimoAcceso:new Date,estado:"activo"},{merge:!0})}catch(Oe){console.log("Usuario ya existe o error al crear documento de usuario:",Oe)}await Pr(),alert("Credenciales asignadas exitosamente. El usuario puede iniciar sesión ahora."),Je(!1),Un({email:"",password:"",confirmPassword:"",isProvisional:!0})}catch(ee){console.error("Error asignando credenciales:",ee);let ie="Error al asignar credenciales";ee.code==="auth/email-already-in-use"?ie="El email ya está en uso por otro usuario":ee.code==="auth/invalid-email"?ie="El formato del email no es válido":ee.code==="auth/weak-password"?ie="La contraseña es demasiado débil":ie+=": "+ee.message,alert(ie)}},tf=async L=>{L.preventDefault(),D(!0);try{if(We.newPassword!==We.confirmPassword){alert("❌ Las contraseñas no coinciden");return}if(We.newPassword.length<6){alert("❌ La nueva contraseña debe tener al menos 6 caracteres");return}const ee=Pt.currentUser;if(!ee){alert("❌ No hay usuario autenticado");return}const ie=ao.credential(ee.email,We.currentPassword);await ON(ee,ie),await t5(ee,We.newPassword);const Oe=Ne(F,"empresas",r);await ze(Oe,{"credenciales.password":We.newPassword,"credenciales.fechaUltimoCambio":new Date}),Rt({currentPassword:"",newPassword:"",confirmPassword:""}),K(!1),alert("✅ Contraseña cambiada exitosamente"),Pr()}catch(ee){console.error("Error cambiando contraseña:",ee),ee.code==="auth/wrong-password"?alert("❌ La contraseña actual es incorrecta"):ee.code==="auth/weak-password"?alert("❌ La contraseña es muy débil"):alert("❌ Error al cambiar la contraseña: "+ee.message)}finally{D(!1)}},cs=async L=>{L.preventDefault(),D(!0);try{if(lt.newEmail!==lt.confirmEmail){alert("❌ Los emails no coinciden");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(lt.newEmail)){alert("❌ Formato de email inválido");return}const ie=Pt.currentUser;if(!ie){alert("❌ No hay usuario autenticado");return}const Oe=ao.credential(ie.email,lt.password);await ON(ie,Oe),await e5(ie,lt.newEmail);const Qe=Ne(F,"empresas",r);await ze(Qe,{"credenciales.email":lt.newEmail,"credenciales.fechaUltimoCambioEmail":new Date}),Dt({currentEmail:"",newEmail:"",confirmEmail:"",password:""}),Ke(!1),alert("✅ Email cambiado exitosamente. Verifica tu nuevo email para confirmar el cambio."),Pr()}catch(ee){console.error("Error cambiando email:",ee),ee.code==="auth/wrong-password"?alert("❌ La contraseña es incorrecta"):ee.code==="auth/email-already-in-use"?alert("❌ Este email ya está en uso"):alert("❌ Error al cambiar el email: "+ee.message)}finally{D(!1)}},af=async L=>{L.preventDefault(),D(!0);try{const ee=[];for(let Oe=0;Oe<10;Oe++)ee.push(Math.random().toString(36).substring(2,10).toUpperCase());const ie=Ne(F,"empresas",r);await ze(ie,{configuracion2FA:{habilitado:ut.isEnabled,metodo:ut.method,telefono:ut.phoneNumber,codigosRespaldo:ee,fechaConfiguracion:new Date}}),ka({...ut,backupCodes:ee}),ut.isEnabled?alert(`✅ Autenticación de dos factores configurada exitosamente!

Códigos de respaldo generados. Guárdalos en un lugar seguro.`):alert("✅ Autenticación de dos factores deshabilitada"),Pr()}catch(ee){console.error("Error configurando 2FA:",ee),alert("❌ Error al configurar la autenticación de dos factores: "+ee.message)}finally{D(!1)}};p.useEffect(()=>{console.log("🚀 useEffect ejecutado con empresaIdParam:",a),console.log("👤 Usuario autenticado:",Pt.currentUser);let L=a;!L&&Pt.currentUser&&(L=Pt.currentUser.uid,console.log("🔑 Usando UID del usuario autenticado como empresaId:",L)),L?(s(L),S(!0),f(""),Pr(L)):(console.error("❌ No se puede determinar el empresaId"),f("No se puede determinar la empresa. Verifica tu autenticación."),S(!1))},[a]),p.useEffect(()=>{e&&!C&&(console.log("📊 Cargando datos adicionales para empresa:",e.id),lr(),xd(),yd(),oc(),us(),mo(),Nd(),nf(),po(),Ci(),Si(),sc())},[e,C]);const Pr=async L=>{var ee,ie;try{if(console.log("🔍 Buscando empresa con ID:",L),console.log("📊 Usuario actual:",(ee=Pt.currentUser)==null?void 0:ee.email,"UID:",(ie=Pt.currentUser)==null?void 0:ie.uid),!L){console.error("❌ No hay empresaId proporcionado"),f("No se proporcionó ID de empresa"),S(!1);return}const Oe=new Promise((nt,aa)=>{setTimeout(()=>aa(new Error("Timeout: La conexión tardó demasiado")),15e3)}),Qe=Ne(F,"empresas",L);console.log("📄 Referencia del documento:",Qe),console.log('🔍 Buscando en colección "empresas" con ID:',L);const _t=await Promise.race([en(Qe),Oe]);if(console.log("📋 Documento encontrado:",_t.exists()),_t.exists()){const nt={id:_t.id,..._t.data()};console.log("✅ Datos de empresa cargados:",nt),n(nt)}else console.error("❌ Empresa no encontrada en Firestore"),console.log("🔍 Intentando buscar por email del usuario..."),await wi()}catch(Oe){console.error("❌ Error cargando empresa:",Oe);let Qe="Error al cargar la empresa";Oe.message.includes("Timeout")?Qe="La conexión tardó demasiado. Verifica tu conexión a internet.":Oe.message.includes("Failed to fetch")||Oe.message.includes("Network")?Qe="Error de conexión. Verifica tu conexión a internet o VPN.":Oe.message.includes("permission-denied")?Qe="No tienes permisos para acceder a esta empresa.":Qe=`Error: ${Oe.message}`,f(Qe)}finally{S(!1)}},La=L=>{switch(L){case"metricas":return tt.plan!=="free";case"reportes":return tt.plan!=="free";case"clientes":return tt.plan!=="free";case"herramientas":return tt.plan!=="free";case"productos":return tt.plan==="free"?o.length<5:tt.plan==="premium"?o.length<25:!0;case"campanas":return tt.plan==="free"?l.length<2:tt.plan==="premium"?l.length<10:!0;default:return!0}},$n=L=>{switch(L){case"productos":return tt.plan==="free"?5:tt.plan==="premium"?25:"∞";case"campanas":return tt.plan==="free"?2:tt.plan==="premium"?10:"∞";default:return 0}},sc=async()=>{var L,ee,ie,Oe,Qe,_t;try{rc(!0);const nt={plan:((L=e==null?void 0:e.membresia)==null?void 0:L.plan)||"free",fechaInicio:((ee=e==null?void 0:e.membresia)==null?void 0:ee.fechaInicio)||new Date,fechaVencimiento:((ie=e==null?void 0:e.membresia)==null?void 0:ie.fechaVencimiento)||new Date(Date.now()+365*24*60*60*1e3),estado:((Oe=e==null?void 0:e.membresia)==null?void 0:Oe.estado)||"activa",caracteristicas:((Qe=e==null?void 0:e.membresia)==null?void 0:Qe.caracteristicas)||["Perfil básico visible","Hasta 5 productos","Hasta 2 campañas por mes","Soporte por email"],limitaciones:((_t=e==null?void 0:e.membresia)==null?void 0:_t.limitaciones)||["Sin acceso a métricas avanzadas","Sin prioridad en búsquedas","Sin acceso a herramientas premium"]};ir(nt),console.log("✅ Membresía cargada:",nt)}catch(nt){console.error("❌ Error cargando membresía:",nt)}finally{rc(!1)}},wi=async()=>{var L,ee;try{const ie=(L=Pt.currentUser)==null?void 0:L.email;if(!ie){console.error("❌ No hay email de usuario disponible"),f("No se puede determinar el email del usuario");return}console.log("🔍 Buscando empresa por email:",ie);const Oe=fe(W(F,"empresas"),pe("email","==",ie)),Qe=await le(Oe);if(console.log("📊 Empresas encontradas por email:",Qe.size),Qe.empty){console.log("🔍 Buscando en colección usuarios...");const _t=fe(W(F,"usuarios"),pe("email","==",ie)),nt=await le(_t);if(console.log("📊 Usuarios encontrados por email:",nt.size),!nt.empty){const Ia=nt.docs[0].data();if(console.log("📋 Datos del usuario:",Ia),Ia.empresaId){console.log("🔍 Usuario tiene empresaId, buscando empresa..."),await Pr(Ia.empresaId);return}}console.error("❌ No se encontró empresa por email ni por empresaId"),f("No se encontró empresa asociada a tu cuenta. Contacta al administrador.")}else{const _t=Qe.docs[0],nt={id:_t.id,..._t.data()};console.log("✅ Empresa encontrada por email:",nt),console.log("⚠️ UID de empresa:",_t.id,"vs UID de usuario:",(ee=Pt.currentUser)==null?void 0:ee.uid),n(nt),s(_t.id),f("")}}catch(ie){console.error("❌ Error buscando empresa por email:",ie),f("Error al buscar empresa por email: "+ie.message)}},lr=async()=>{try{const L=fe(W(F,"productos"),pe("empresaId","==",r),st("fechaCreacion","desc"),Ot(10)),ee=await le(L);i(ee.docs.map(ie=>({id:ie.id,...ie.data()})))}catch(L){console.error("Error cargando productos:",L)}},xd=async()=>{try{const L=fe(W(F,"campañas"),pe("empresaId","==",r),st("fechaCreacion","desc"),Ot(10)),ee=await le(L);c(ee.docs.map(ie=>({id:ie.id,...ie.data()})))}catch(L){console.error("Error cargando campañas:",L)}},yd=async()=>{try{const L=fe(W(F,"clientes"),pe("empresaId","==",r),st("fechaCreacion","desc"),Ot(10)),ee=await le(L);d(ee.docs.map(ie=>({id:ie.id,...ie.data()})))}catch(L){console.error("Error cargando clientes:",L)}},oc=async()=>{try{console.log("📈 Cargando métricas..."),h({visitasPerfil:1250,productosVendidos:89,clientesNuevos:23,calificacionPromedio:4.7,conversionRate:12.5,engagementRate:8.3}),console.log("✅ Métricas cargadas")}catch(L){console.error("❌ Error cargando métricas:",L)}},us=async()=>{try{j(!0);const L=fe(W(F,"solicitudes_producto"),pe("empresaId","==",r),st("fechaSolicitud","desc")),ee=await le(L);$(ee.docs.map(ie=>({id:ie.id,...ie.data()})))}catch(L){console.error("Error cargando solicitudes de productos:",L)}finally{j(!1)}},mo=async()=>{try{const L=fe(W(F,"solicitudes_campana"),pe("empresaId","==",r),st("fechaSolicitud","desc")),ee=await le(L);V(ee.docs.map(ie=>({id:ie.id,...ie.data()})))}catch(L){console.error("Error cargando solicitudes de campañas:",L)}},Nd=async()=>{try{const L=fe(W(F,"notificaciones"),pe("empresaId","==",r),pe("leida","==",!1),st("fechaCreacion","desc"),Ot(10)),ee=await le(L);Q(ee.docs.map(ie=>({id:ie.id,...ie.data()})))}catch(L){console.error("Error cargando notificaciones:",L)}},nf=async()=>{try{const L=fe(W(F,"solicitudes_producto"),pe("empresaId","==",r),pe("agenteAsignado","!=",null)),ee=await le(L);ee.docs.length>0&&me(ee.docs[0].data().agenteAsignado)}catch(L){console.error("Error cargando agente asignado:",L)}},_i=async()=>{if(de.trim())try{const L={empresaId:r,empresaNombre:e.nombre,agenteId:ge,mensaje:de,fechaEnvio:new Date,enviadoPor:"empresa",leido:!1};await ot(W(F,"chat_empresa_agente"),L),oe(""),Se(ee=>[...ee,L])}catch(L){console.error("Error enviando mensaje:",L)}},wd=async L=>{try{const ee=Ne(F,"notificaciones",L);await ze(ee,{leida:!0}),Q(ie=>ie.filter(Oe=>Oe.id!==L))}catch(ee){console.error("Error marcando notificación como leída:",ee)}},po=async()=>{try{Te(!0);const L=fe(W(F,"historial_cambios"),pe("empresaId","==",r),st("fechaCambio","desc"),Ot(20)),ee=await le(L);G(ee.docs.map(ie=>({id:ie.id,...ie.data()})))}catch(L){console.error("Error cargando historial de cambios:",L)}finally{Te(!1)}},ds=async(L,ee,ie)=>{try{const Qe=Ne(F,ee==="producto"?"solicitudes_producto":"solicitudes_campana",L);await ze(Qe,{prioridad:ie,fechaCambioPrioridad:new Date});const _t={empresaId:r,empresaNombre:e.nombre,solicitudId:L,tipoSolicitud:ee,tipoCambio:"cambio_prioridad",descripcion:`Prioridad cambiada a: ${ie}`,fechaCambio:new Date,usuario:"empresa"};await ot(W(F,"historial_cambios"),_t),ee==="producto"?us():mo(),po(),alert(`✅ Prioridad cambiada a: ${ie}`)}catch(Oe){console.error("Error cambiando prioridad:",Oe),alert("❌ Error al cambiar la prioridad")}},cr=async(L,ee)=>{if(confirm("¿Estás seguro de que quieres cancelar esta solicitud?"))try{const Oe=Ne(F,ee==="producto"?"solicitudes_producto":"solicitudes_campana",L);await ze(Oe,{estado:"cancelada",fechaCancelacion:new Date});const Qe={empresaId:r,empresaNombre:e.nombre,solicitudId:L,tipoSolicitud:ee,tipoCambio:"cancelacion",descripcion:"Solicitud cancelada por la empresa",fechaCambio:new Date,usuario:"empresa"};await ot(W(F,"historial_cambios"),Qe),ee==="producto"?us():mo(),po(),alert("✅ Solicitud cancelada exitosamente")}catch(ie){console.error("Error cancelando solicitud:",ie),alert("❌ Error al cancelar la solicitud")}},ic=async()=>{try{_e(!0);const L=new Date(H.fechaInicio),ee=new Date(H.fechaFin);ee.setHours(23,59,59,999);const ie=fe(W(F,"solicitudes_producto"),pe("empresaId","==",r),pe("fechaSolicitud",">=",L),pe("fechaSolicitud","<=",ee)),Oe=await le(ie),Qe=fe(W(F,"solicitudes_campana"),pe("empresaId","==",r),pe("fechaSolicitud",">=",L),pe("fechaSolicitud","<=",ee)),_t=await le(Qe),nt=[...Oe.docs.map(pt=>({id:pt.id,tipo:"producto",...pt.data()})),..._t.docs.map(pt=>({id:pt.id,tipo:"campana",...pt.data()}))];let aa=nt;H.tipo!=="todos"&&(aa=nt.filter(pt=>pt.tipo===H.tipo)),H.estado!=="todos"&&(aa=aa.filter(pt=>pt.estado===H.estado));const Ia=aa.filter(pt=>pt.estado==="aprobado").length,tn=aa.filter(pt=>pt.estado==="rechazado").length,dr=aa.filter(pt=>pt.estado==="pendiente").length,gc=aa.filter(pt=>pt.estado==="aprobado"||pt.estado==="rechazado");let Eo=0;if(gc.length>0){const pt=gc.filter(mr=>mr.fechaRespuesta&&mr.fechaSolicitud).map(mr=>{const xo=mr.fechaSolicitud.toDate();return(mr.fechaRespuesta.toDate()-xo)/864e5});pt.length>0&&(Eo=pt.reduce((mr,xo)=>mr+xo,0)/pt.length)}const Fd=fe(W(F,"productos"),pe("empresaId","==",r),pe("estado","==","activo")),Wn=await le(Fd),zd=fe(W(F,"campanas"),pe("empresaId","==",r),pe("estado","==","activa")),lf=await le(zd);ve({solicitudesDelMes:aa.length,solicitudesAprobadas:Ia,solicitudesRechazadas:tn,solicitudesPendientes:dr,tiempoPromedioRespuesta:Math.round(Eo*10)/10,productosActivos:Wn.size,campanasActivas:lf.size,detalles:{solicitudesPorTipo:{productos:aa.filter(pt=>pt.tipo==="producto").length,campanas:aa.filter(pt=>pt.tipo==="campana").length},solicitudesPorPrioridad:{urgente:aa.filter(pt=>pt.prioridad==="urgente").length,alta:aa.filter(pt=>pt.prioridad==="alta").length,normal:aa.filter(pt=>pt.prioridad==="normal").length,baja:aa.filter(pt=>pt.prioridad==="baja").length}}})}catch(L){console.error("Error generando reportes:",L),alert("❌ Error al generar los reportes")}finally{_e(!1)}},_d=L=>{L==="pdf"?alert(`📄 Generando reporte en PDF...

Esta funcionalidad estará disponible próximamente.`):L==="excel"&&alert(`📊 Generando reporte en Excel...

Esta funcionalidad estará disponible próximamente.`)},Ci=async()=>{try{const L=fe(W(F,"eventos_empresa"),pe("empresaId","==",r),st("fechaInicio","asc")),ee=await le(L);be(ee.docs.map(ie=>({id:ie.id,...ie.data()})))}catch(L){console.error("Error cargando eventos:",L)}},Si=async()=>{try{const L=fe(W(F,"recordatorios_empresa"),pe("empresaId","==",r),pe("activo","==",!0),st("fechaRecordatorio","asc")),ee=await le(L);qe(ee.docs.map(ie=>({id:ie.id,...ie.data()})))}catch(L){console.error("Error cargando recordatorios:",L)}},Cd=async L=>{L.preventDefault(),D(!0);try{const ee={empresaId:r,empresaNombre:e.nombre,titulo:He.titulo,descripcion:He.descripcion,fechaInicio:new Date(He.fechaInicio),fechaFin:new Date(He.fechaFin),tipo:He.tipo,prioridad:He.prioridad,recordatorio:He.recordatorio,recordatorioAntes:He.recordatorioAntes,fechaCreacion:new Date,activo:!0},ie=await ot(W(F,"eventos_empresa"),ee);if(He.recordatorio){const Oe=new Date(He.fechaInicio),Qe=parseInt(He.recordatorioAntes.split("_")[0]);Oe.setDate(Oe.getDate()-Qe);const _t={empresaId:r,empresaNombre:e.nombre,eventoId:ie.id,titulo:`Recordatorio: ${He.titulo}`,descripcion:He.descripcion,fechaEvento:new Date(He.fechaInicio),fechaRecordatorio:Oe,tipo:"evento",activo:!0,enviado:!1};await ot(W(F,"recordatorios_empresa"),_t)}$t({titulo:"",descripcion:"",fechaInicio:"",fechaFin:"",tipo:"general",prioridad:"normal",recordatorio:!0,recordatorioAntes:"1_dia"}),Tt(!1),Ci(),Si(),alert("✅ Evento creado exitosamente")}catch(ee){console.error("Error creando evento:",ee),alert("❌ Error al crear el evento")}finally{D(!1)}},lc=async L=>{if(confirm("¿Estás seguro de que quieres eliminar este evento?"))try{await on(Ne(F,"eventos_empresa",L));const ee=fe(W(F,"recordatorios_empresa"),pe("eventoId","==",L));(await le(ee)).docs.forEach(async Oe=>{await on(Oe.ref)}),Ci(),Si(),alert("✅ Evento eliminado exitosamente")}catch(ee){console.error("Error eliminando evento:",ee),alert("❌ Error al eliminar el evento")}},Rr=L=>{const ee=new Date(L);ee.setHours(0,0,0,0);const ie=new Date(L);return ie.setHours(23,59,59,999),mt.filter(Oe=>{const Qe=Oe.fechaInicio.toDate();return Qe>=ee&&Qe<=ie})},Sd=L=>{const ee=new Date(L);ee.setDate(ee.getDate()-ee.getDay()),ee.setHours(0,0,0,0);const ie=new Date(ee);return ie.setDate(ie.getDate()+6),ie.setHours(23,59,59,999),mt.filter(Oe=>{const Qe=Oe.fechaInicio.toDate();return Qe>=ee&&Qe<=ie})},kd=L=>{const ee=L.getFullYear(),ie=L.getMonth(),Oe=new Date(ee,ie,1),_t=new Date(ee,ie+1,0).getDate(),nt=Oe.getDay(),aa=[];let Ia=[];for(let tn=0;tn<nt;tn++){const dr=new Date(ee,ie,-nt+tn+1);Ia.push({fecha:dr,esDelMes:!1,eventos:Rr(dr)})}for(let tn=1;tn<=_t;tn++){const dr=new Date(ee,ie,tn);Ia.push({fecha:dr,esDelMes:!0,eventos:Rr(dr)}),Ia.length===7&&(aa.push(Ia),Ia=[])}if(Ia.length>0){for(;Ia.length<7;){const tn=new Date(ee,ie+1,Ia.length);Ia.push({fecha:tn,esDelMes:!1,eventos:Rr(tn)})}aa.push(Ia)}return aa},rf=async L=>{L.preventDefault(),D(!0);try{const ee={empresaId:r,empresaNombre:e.nombre,nombre:y.nombre,descripcion:y.descripcion,precio:parseFloat(y.precio),categoria:y.categoria,marca:y.marca,stock:parseInt(y.stock),estado:"pendiente",fechaSolicitud:new Date,tipo:"producto",revisado:!1,aprobado:!1,comentariosAdmin:"",agenteAsignado:null},ie=await ot(W(F,"solicitudes_producto"),ee);console.log("✅ Solicitud de producto enviada:",ie.id),E({nombre:"",descripcion:"",precio:"",categoria:"",marca:"",stock:"",imagen:null}),A(!1),alert("✅ Solicitud de producto enviada exitosamente. Será revisada por nuestro equipo."),us()}catch(ee){console.error("❌ Error enviando solicitud de producto:",ee),alert("❌ Error al enviar la solicitud. Inténtalo de nuevo.")}finally{D(!1)}},sf=async L=>{L.preventDefault(),D(!0);try{const ee={empresaId:r,empresaNombre:e.nombre,titulo:_.titulo,descripcion:_.descripcion,fechaInicio:_.fechaInicio,fechaFin:_.fechaFin,presupuesto:parseFloat(_.presupuesto),tipo:_.tipo,estado:"pendiente",fechaSolicitud:new Date,revisado:!1,aprobado:!1,comentariosAdmin:"",agenteAsignado:null},ie=await ot(W(F,"solicitudes_campana"),ee);console.log("✅ Solicitud de campaña enviada:",ie.id),P({titulo:"",descripcion:"",fechaInicio:"",fechaFin:"",presupuesto:"",tipo:"promocional"}),x(!1),alert("✅ Solicitud de campaña enviada exitosamente. Será revisada por nuestro equipo."),mo()}catch(ee){console.error("❌ Error enviando solicitud de campaña:",ee),alert("❌ Error al enviar la solicitud. Inténtalo de nuevo.")}finally{D(!1)}},go=()=>{E({nombre:"",descripcion:"",precio:"",categoria:"",marca:"",stock:"",imagen:null}),P({titulo:"",descripcion:"",fechaInicio:"",fechaFin:"",presupuesto:"",tipo:"promocional"})},Id=L=>{var ee;alert(`Vista previa del producto: ${L.nombre}

Categoría: ${L.categoria}
Marca: ${L.marca}
Precio: $${(ee=L.precio)==null?void 0:ee.toLocaleString()}

Descripción: ${L.descripcion}

Esta es una simulación de cómo se verá el producto una vez aprobado en la plataforma.`)},of=L=>{var ee;alert(`Vista previa de la campaña: ${L.titulo}

Tipo: ${L.tipo}
Presupuesto: $${((ee=L.presupuesto)==null?void 0:ee.toLocaleString())||"N/A"}
Duración: ${L.fechaInicio} - ${L.fechaFin}

Descripción: ${L.descripcion}

Esta es una simulación de cómo se verá la campaña una vez aprobada en la plataforma.`)};return C?t.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},t.createElement("div",{className:"text-center max-w-md mx-auto"},t.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto mb-6"}),t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Cargando dashboard empresarial"),t.createElement("p",{className:"text-gray-600 mb-4"},"Conectando con la base de datos..."),t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-left"},t.createElement("h3",{className:"font-medium text-blue-900 mb-2"},"📊 Procesando:"),t.createElement("div",{className:"space-y-2 text-sm text-blue-700"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),t.createElement("span",null,"Información de la empresa")),t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"w-2 h-2 bg-blue-400 rounded-full mr-2"}),t.createElement("span",null,"Productos y campañas")),t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"w-2 h-2 bg-blue-300 rounded-full mr-2"}),t.createElement("span",null,"Métricas y estadísticas")))),t.createElement("div",{className:"mt-6 text-xs text-gray-500"},t.createElement("p",null,"ID de empresa: ",r||"No proporcionado")))):w?t.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},t.createElement("div",{className:"text-center max-w-md mx-auto"},t.createElement("div",{className:"mb-6"},t.createElement("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},t.createElement("span",{className:"text-3xl"},"⚠️")),t.createElement("h1",{className:"text-2xl font-bold text-red-600 mb-2"},"Error al cargar el dashboard"),t.createElement("p",{className:"text-gray-700 mb-4"},w)),t.createElement("div",{className:"bg-gray-100 rounded-lg p-4 mb-6 text-left"},t.createElement("h3",{className:"font-medium text-gray-900 mb-2"},"📋 Información de depuración:"),t.createElement("div",{className:"space-y-2 text-sm text-gray-600"},t.createElement("p",null,t.createElement("span",{className:"font-medium"},"ID de empresa:")," ",r||"No proporcionado"),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"URL actual:")," ",window.location.href),t.createElement("p",null,t.createElement("span",{className:"font-medium"},"Timestamp:")," ",new Date().toLocaleString()))),t.createElement("div",{className:"space-y-3"},t.createElement("button",{onClick:()=>{f(""),S(!0),Pr()},className:"w-full bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors font-medium"},"🔄 Reintentar conexión"),t.createElement("button",{onClick:()=>window.location.reload(),className:"w-full bg-gray-600 text-white px-6 py-3 rounded-md hover:bg-gray-700 transition-colors font-medium"},"🔃 Recargar página completa"),t.createElement("button",{onClick:()=>window.history.back(),className:"w-full bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700 transition-colors font-medium"},"⬅️ Volver atrás")),t.createElement("div",{className:"mt-6 text-xs text-gray-500"},t.createElement("p",null,"Si el problema persiste, verifica:"),t.createElement("ul",{className:"list-disc list-inside mt-1 space-y-1"},t.createElement("li",null,"Conexión a internet"),t.createElement("li",null,"Configuración de VPN"),t.createElement("li",null,"Permisos de la empresa"))))):e?t.createElement(t.Fragment,null,t.createElement(za,null),t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement("div",{className:"bg-white shadow-sm border-b"},t.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",{className:"flex items-center space-x-4"},t.createElement("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center"},t.createElement("span",{className:"text-2xl font-bold text-blue-600"},((Tn=(ur=e.nombre)==null?void 0:ur.charAt(0))==null?void 0:Tn.toUpperCase())||"E")),t.createElement("div",null,t.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Dashboard de ",e.nombre),t.createElement("p",{className:"text-gray-600"},"Panel de gestión empresarial - Red AV 10 de Julio"))),t.createElement("div",{className:"flex items-center space-x-3"},t.createElement("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800"},"✓ Empresa Validada"),t.createElement("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800"},"🌟 Sello de Calidad"),t.createElement("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800"},"🟢 Conexión Activa"),t.createElement("button",{onClick:()=>se(!0),className:"relative inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800 hover:bg-yellow-200 transition-colors"},"🔔 Notificaciones",U.length>0&&t.createElement("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},U.length)),ge&&t.createElement("button",{onClick:()=>ye(!0),className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-purple-100 text-purple-800 hover:bg-purple-200 transition-colors"},"💬 Chat con Agente"))))),t.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},t.createElement("div",{className:"border-b border-gray-200 mb-8"},t.createElement("nav",{className:"-mb-px flex space-x-8"},[{id:"overview",name:"Resumen",icon:"📊"},{id:"productos",name:"Productos",icon:"📦"},{id:"campanas",name:"Campañas",icon:"📢"},{id:"solicitudes",name:"Solicitudes",icon:"📋"},{id:"historial",name:"Historial",icon:"📜"},{id:"reportes",name:"Reportes",icon:"📊",premium:!0},{id:"calendario",name:"Calendario",icon:"📅"},{id:"clientes",name:"Clientes",icon:"👥",premium:!0},{id:"metricas",name:"Métricas",icon:"📈",premium:!0},{id:"membresias",name:"Membresías",icon:"💎"},{id:"red",name:"Red AV 10",icon:"🌐"},{id:"herramientas",name:"Herramientas",icon:"🛠️",premium:!0},{id:"usuario",name:"Usuario",icon:"👤"}].map(L=>t.createElement("button",{key:L.id,onClick:()=>v(L.id),className:`py-2 px-1 border-b-2 font-medium text-sm relative ${b===L.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`},t.createElement("span",{className:"mr-2"},L.icon),L.name,L.premium&&tt.plan==="free"&&t.createElement("span",{className:"absolute -top-1 -right-1 bg-yellow-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center"},"💎"))))),t.createElement("div",{className:"space-y-6"},b==="overview"&&t.createElement("div",{className:"space-y-8"},t.createElement("div",{className:"bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 rounded-2xl p-8 text-white"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h1",{className:"text-3xl font-bold mb-2"},"¡Bienvenido de vuelta!"),t.createElement("p",{className:"text-blue-100 text-lg"},"Gestiona tu empresa y haz crecer tu negocio"),t.createElement("div",{className:"mt-4 flex items-center space-x-4"},t.createElement("span",{className:"bg-white/20 px-3 py-1 rounded-full text-sm"},"🏢 ",(e==null?void 0:e.nombre)||"Empresa"),t.createElement("span",{className:"bg-white/20 px-3 py-1 rounded-full text-sm"},"💎 Plan ",tt.plan.toUpperCase()))),t.createElement("div",{className:"text-right"},t.createElement("div",{className:"text-4xl mb-2"},"📊"),t.createElement("p",{className:"text-blue-100"},"Dashboard")))),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-blue-500 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("p",{className:"text-sm font-medium text-gray-600"},"Visitas al Perfil"),t.createElement("p",{className:"text-3xl font-bold text-gray-900"},((fo=m.visitasPerfil)==null?void 0:fo.toLocaleString())||0)),t.createElement("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center"},t.createElement("span",{className:"text-2xl"},"👥"))),t.createElement("div",{className:"mt-4 flex items-center text-sm text-green-600"},t.createElement("span",null,"↗️ +12%"),t.createElement("span",{className:"ml-2"},"vs mes anterior"))),t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-green-500 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("p",{className:"text-sm font-medium text-gray-600"},"Productos Activos"),t.createElement("p",{className:"text-3xl font-bold text-gray-900"},o.length||0)),t.createElement("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center"},t.createElement("span",{className:"text-2xl"},"📦"))),t.createElement("div",{className:"mt-4 flex items-center text-sm text-blue-600"},t.createElement("span",null,"📈 ",o.length>0?"Activos":"Sin productos"))),t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-yellow-500 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("p",{className:"text-sm font-medium text-gray-600"},"Campañas Activas"),t.createElement("p",{className:"text-3xl font-bold text-gray-900"},l.length||0)),t.createElement("div",{className:"w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center"},t.createElement("span",{className:"text-2xl"},"📢"))),t.createElement("div",{className:"mt-4 flex items-center text-sm text-yellow-600"},t.createElement("span",null,"🎯 ",l.length>0?"En ejecución":"Sin campañas"))),t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-purple-500 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("p",{className:"text-sm font-medium text-gray-600"},"Solicitudes"),t.createElement("p",{className:"text-3xl font-bold text-gray-900"},M.length+q.length||0)),t.createElement("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center"},t.createElement("span",{className:"text-2xl"},"📋"))),t.createElement("div",{className:"mt-4 flex items-center text-sm text-purple-600"},t.createElement("span",null,"⏳ Pendientes de revisión")))),t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-8"},t.createElement("h3",{className:"text-2xl font-bold text-gray-900 mb-6"},"⚡ Acciones Rápidas"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},t.createElement("button",{onClick:()=>v("productos"),className:"group p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl hover:from-blue-100 hover:to-blue-200 transition-all duration-300 transform hover:-translate-y-2 hover:shadow-lg border border-blue-200"},t.createElement("div",{className:"text-4xl mb-4 group-hover:scale-110 transition-transform duration-300"},"📦"),t.createElement("div",{className:"font-bold text-gray-900 mb-2"},"Gestionar Productos"),t.createElement("div",{className:"text-sm text-gray-600"},"Agregar, editar y organizar tu catálogo")),t.createElement("button",{onClick:()=>v("campanas"),className:"group p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-xl hover:from-green-100 hover:to-green-200 transition-all duration-300 transform hover:-translate-y-2 hover:shadow-lg border border-green-200"},t.createElement("div",{className:"text-4xl mb-4 group-hover:scale-110 transition-transform duration-300"},"📢"),t.createElement("div",{className:"font-bold text-gray-900 mb-2"},"Crear Campaña"),t.createElement("div",{className:"text-sm text-gray-600"},"Lanza promociones y ofertas")),t.createElement("button",{onClick:()=>v("solicitudes"),className:"group p-6 bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-xl hover:from-yellow-100 hover:to-yellow-200 transition-all duration-300 transform hover:-translate-y-2 hover:shadow-lg border border-yellow-200"},t.createElement("div",{className:"text-4xl mb-4 group-hover:scale-110 transition-transform duration-300"},"📋"),t.createElement("div",{className:"font-bold text-gray-900 mb-2"},"Ver Solicitudes"),t.createElement("div",{className:"text-sm text-gray-600"},"Revisa el estado de tus solicitudes")),t.createElement("button",{onClick:()=>v("membresias"),className:"group p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl hover:from-purple-100 hover:to-purple-200 transition-all duration-300 transform hover:-translate-y-2 hover:shadow-lg border border-purple-200"},t.createElement("div",{className:"text-4xl mb-4 group-hover:scale-110 transition-transform duration-300"},"💎"),t.createElement("div",{className:"font-bold text-gray-900 mb-2"},"Mejorar Plan"),t.createElement("div",{className:"text-sm text-gray-600"},"Desbloquea funcionalidades avanzadas")))),t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8"},t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-gray-200"},t.createElement("div",{className:"flex items-center justify-between mb-4"},t.createElement("h4",{className:"text-xl font-bold text-gray-900"},"💎 Plan de Membresía"),t.createElement("span",{className:`px-3 py-1 text-sm font-medium rounded-full ${tt.estado==="activa"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`},tt.estado==="activa"?"✅ Activa":"⚠️ Pendiente")),t.createElement("div",{className:"text-center mb-4"},t.createElement("div",{className:"text-4xl font-bold text-gray-900 mb-2"},tt.plan.toUpperCase()),t.createElement("p",{className:"text-gray-600"},tt.plan==="free"?"Plan gratuito":tt.plan==="premium"?"$29.99/mes":"$99.99/mes")),t.createElement("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg"},t.createElement("h5",{className:"font-medium text-gray-700 mb-2"},"📊 Límites del Plan"),t.createElement("div",{className:"grid grid-cols-2 gap-3 text-sm"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("span",{className:"text-gray-600"},"Productos:"),t.createElement("span",{className:`font-medium ${o.length>=$n("productos")?"text-red-600":"text-green-600"}`},o.length," / ",$n("productos"))),t.createElement("div",{className:"flex items-center justify-between"},t.createElement("span",{className:"text-gray-600"},"Campañas:"),t.createElement("span",{className:`font-medium ${l.length>=$n("campanas")?"text-red-600":"text-green-600"}`},l.length," / ",$n("campanas"))))),t.createElement("div",{className:"space-y-2"},tt.plan==="free"&&t.createElement(t.Fragment,null,t.createElement("div",{className:"flex items-center text-sm text-gray-600"},t.createElement("span",{className:"text-green-500 mr-2"},"✓"),"Hasta 5 productos"),t.createElement("div",{className:"flex items-center text-sm text-gray-600"},t.createElement("span",{className:"text-green-500 mr-2"},"✓"),"Hasta 2 campañas por mes"),t.createElement("div",{className:"flex items-center text-sm text-gray-600"},t.createElement("span",{className:"text-green-500 mr-2"},"✓"),"Perfil básico visible"))),tt.plan==="free"&&t.createElement("button",{onClick:()=>v("membresias"),className:"w-full mt-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 rounded-xl font-medium hover:from-blue-700 hover:to-purple-700 transition-all duration-300 transform hover:scale-105"},"🚀 Actualizar a Premium")),t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-gray-200"},t.createElement("div",{className:"flex items-center justify-between mb-4"},t.createElement("h4",{className:"text-xl font-bold text-gray-900"},"🔐 Credenciales"),t.createElement("span",{className:`px-3 py-1 text-sm font-medium rounded-full ${(ho=e==null?void 0:e.credenciales)!=null&&ho.email&&((cc=e==null?void 0:e.credenciales)!=null&&cc.password)?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`},(Vt=e==null?void 0:e.credenciales)!=null&&Vt.email&&((vo=e==null?void 0:e.credenciales)!=null&&vo.password)?"✅ Configuradas":"⚠️ Pendientes")),t.createElement("div",{className:"space-y-3"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("span",{className:"text-gray-600"},"Email:"),t.createElement("span",{className:"font-medium"},((ms=e==null?void 0:e.credenciales)==null?void 0:ms.email)||"No configurado")),t.createElement("div",{className:"flex items-center justify-between"},t.createElement("span",{className:"text-gray-600"},"Contraseña:"),t.createElement("span",{className:"font-medium"},(ps=e==null?void 0:e.credenciales)!=null&&ps.password?"••••••••":"No configurado")),t.createElement("div",{className:"flex items-center justify-between"},t.createElement("span",{className:"text-gray-600"},"Último acceso:"),t.createElement("span",{className:"font-medium"},e!=null&&e.ultimoAcceso?new Date(e.ultimoAcceso.toDate()).toLocaleDateString("es-ES"):"Nunca"))),(!((Ad=e==null?void 0:e.credenciales)!=null&&Ad.email)||!((uc=e==null?void 0:e.credenciales)!=null&&uc.password))&&t.createElement("button",{onClick:()=>Je(!0),className:"w-full mt-4 bg-orange-600 text-white py-3 rounded-xl font-medium hover:bg-orange-700 transition-all duration-300"},"🔑 Configurar Credenciales"))),t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-8"},t.createElement("h3",{className:"text-2xl font-bold text-gray-900 mb-6"},"🏢 Información de la Empresa"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6"},t.createElement("div",{className:"text-center p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl border border-blue-200"},t.createElement("div",{className:"text-4xl mb-3"},"🏪"),t.createElement("div",{className:"font-bold text-gray-900 text-lg mb-2"},(e==null?void 0:e.nombre)||"Nombre no disponible"),t.createElement("div",{className:"text-gray-600"},"Empresa")),t.createElement("div",{className:"text-center p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-xl border border-green-200"},t.createElement("div",{className:"text-4xl mb-3"},"📍"),t.createElement("div",{className:"font-bold text-gray-900 text-lg mb-2"},(e==null?void 0:e.direccion)||"Dirección no disponible"),t.createElement("div",{className:"text-gray-600"},"Ubicación")),t.createElement("div",{className:"text-center p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl border border-purple-200"},t.createElement("div",{className:"text-4xl mb-3"},"📞"),t.createElement("div",{className:"font-bold text-gray-900 text-lg mb-2"},(e==null?void 0:e.telefono)||"Teléfono no disponible"),t.createElement("div",{className:"text-gray-600"},"Contacto"))))),b==="productos"&&t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Gestión de Productos"),t.createElement("button",{onClick:()=>A(!0),disabled:!La("productos"),className:`px-4 py-2 rounded-md transition-colors ${La("productos")?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-400 text-gray-600 cursor-not-allowed"}`,title:La("productos")?"Agregar nuevo producto":`Límite alcanzado: ${$n("productos")} productos`},"+ Nuevo Producto",!La("productos")&&t.createElement("span",{className:"ml-2 text-xs"},"(",$n("productos"),")")))),t.createElement("div",{className:"p-6"},o.length>0?t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},o.map(L=>{var ee;return t.createElement("div",{key:L.id,className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("h4",{className:"font-medium text-gray-900 mb-2"},L.nombre),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},L.descripcion),t.createElement("div",{className:"flex items-center justify-between"},t.createElement("span",{className:"text-lg font-bold text-green-600"},"$",((ee=L.precio)==null?void 0:ee.toLocaleString())||"N/A"),t.createElement("div",{className:"flex space-x-2"},t.createElement("button",{className:"text-blue-600 hover:text-blue-800 text-sm"},"Editar"),t.createElement("button",{className:"text-red-600 hover:text-red-800 text-sm"},"Eliminar"))))})):t.createElement("div",{className:"text-center py-8 text-gray-500"},t.createElement("p",null,"No hay productos registrados aún."),t.createElement("button",{className:"mt-2 text-blue-600 hover:text-blue-800"},"Crear primer producto")))),b==="campanas"&&t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Gestión de Campañas"),t.createElement("button",{onClick:()=>x(!0),disabled:!La("campanas"),className:`px-4 py-2 rounded-md transition-colors ${La("campanas")?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-400 text-gray-600 cursor-not-allowed"}`,title:La("campanas")?"Crear nueva campaña":`Límite alcanzado: ${$n("campanas")} campañas`},"+ Nueva Campaña",!La("campanas")&&t.createElement("span",{className:"ml-2 text-xs"},"(",$n("campanas"),")")))),t.createElement("div",{className:"p-6"},l.length>0?t.createElement("div",{className:"space-y-4"},l.map(L=>{var ee;return t.createElement("div",{key:L.id,className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h4",{className:"font-medium text-gray-900"},L.titulo),t.createElement("p",{className:"text-sm text-gray-600"},L.descripcion),t.createElement("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-500"},t.createElement("span",null,"📅 ",L.fechaInicio),t.createElement("span",null,"📅 ",L.fechaFin),t.createElement("span",null,"💰 $",((ee=L.presupuesto)==null?void 0:ee.toLocaleString())||"N/A"))),t.createElement("div",{className:"flex space-x-2"},t.createElement("button",{className:"text-blue-600 hover:text-blue-800 text-sm"},"Editar"),t.createElement("button",{className:"text-green-600 hover:text-green-800 text-sm"},"Activar"),t.createElement("button",{className:"text-red-600 hover:text-red-800 text-sm"},"Pausar"))))})):t.createElement("div",{className:"text-center py-8 text-gray-500"},t.createElement("p",null,"No hay campañas activas."),t.createElement("button",{className:"mt-2 text-blue-600 hover:text-blue-800"},"Crear primera campaña")))),b==="solicitudes"&&t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"📦 Solicitudes de Productos"),t.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Estado de tus solicitudes de productos pendientes de aprobación")),t.createElement("div",{className:"p-6"},z?t.createElement("div",{className:"text-center py-8"},t.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),t.createElement("p",{className:"text-gray-500 mt-2"},"Cargando solicitudes...")):M.length>0?t.createElement("div",{className:"space-y-4"},M.map(L=>{var ee,ie,Oe,Qe;return t.createElement("div",{key:L.id,className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"flex items-start justify-between"},t.createElement("div",{className:"flex-1"},t.createElement("div",{className:"flex items-center space-x-3 mb-3"},t.createElement("h4",{className:"font-medium text-gray-900"},L.nombre),t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${L.estado==="pendiente"?"bg-yellow-100 text-yellow-800":L.estado==="aprobado"?"bg-green-100 text-green-800":L.estado==="rechazado"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`},L.estado==="pendiente"?"⏳ Pendiente":L.estado==="aprobado"?"✅ Aprobado":L.estado==="rechazado"?"❌ Rechazado":L.estado),L.prioridad&&t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${L.prioridad==="urgente"?"bg-red-100 text-red-800":L.prioridad==="alta"?"bg-orange-100 text-orange-800":L.prioridad==="normal"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`},L.prioridad==="urgente"?"🔴 Urgente":L.prioridad==="alta"?"🟠 Alta":L.prioridad==="normal"?"🟡 Normal":"🟢 Baja")),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3"},t.createElement("div",{className:"text-sm"},t.createElement("span",{className:"font-medium text-gray-700"},"Categoría:"),t.createElement("span",{className:"ml-2 text-gray-600"},L.categoria)),t.createElement("div",{className:"text-sm"},t.createElement("span",{className:"font-medium text-gray-700"},"Marca:"),t.createElement("span",{className:"ml-2 text-gray-600"},L.marca)),t.createElement("div",{className:"text-sm"},t.createElement("span",{className:"font-medium text-gray-700"},"Precio:"),t.createElement("span",{className:"ml-2 text-gray-600"},"$",(ee=L.precio)==null?void 0:ee.toLocaleString()))),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},L.descripcion),L.comentariosAdmin&&t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-3"},t.createElement("p",{className:"text-sm text-blue-800"},t.createElement("span",{className:"font-medium"},"💬 Comentarios del Admin:")," ",L.comentariosAdmin)),t.createElement("div",{className:"flex items-center justify-between text-xs text-gray-500"},t.createElement("span",null,"📅 Solicitado: ",((Qe=(Oe=(ie=L.fechaSolicitud)==null?void 0:ie.toDate)==null?void 0:Oe.call(ie))==null?void 0:Qe.toLocaleDateString())||"N/A"),L.agenteAsignado&&t.createElement("span",null,"👤 Agente: ",L.agenteAsignado)),L.estado==="pendiente"&&t.createElement("div",{className:"mt-3"},t.createElement("label",{className:"block text-xs font-medium text-gray-700 mb-1"},"Prioridad:"),t.createElement("select",{value:L.prioridad||"normal",onChange:_t=>ds(L.id,"producto",_t.target.value),className:"text-xs px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"},t.createElement("option",{value:"baja"},"🟢 Baja"),t.createElement("option",{value:"normal"},"🟡 Normal"),t.createElement("option",{value:"alta"},"🟠 Alta"),t.createElement("option",{value:"urgente"},"🔴 Urgente")))),t.createElement("div",{className:"ml-4 flex flex-col space-y-2"},t.createElement("button",{onClick:()=>Id(L),className:"text-blue-600 hover:text-blue-800 text-sm px-3 py-1 border border-blue-300 rounded hover:bg-blue-50"},"👁️ Vista Previa"),L.estado==="pendiente"&&t.createElement("button",{onClick:()=>cr(L.id,"producto"),className:"text-red-600 hover:text-red-800 text-sm px-3 py-1 border border-red-300 rounded hover:bg-red-50"},"❌ Cancelar"))))})):t.createElement("div",{className:"text-center py-8 text-gray-500"},t.createElement("p",null,"No hay solicitudes de productos pendientes."),t.createElement("button",{onClick:()=>A(!0),className:"mt-2 text-blue-600 hover:text-blue-800"},"Solicitar primer producto")))),t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"📢 Solicitudes de Campañas"),t.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Estado de tus solicitudes de campañas pendientes de aprobación")),t.createElement("div",{className:"p-6"},q.length>0?t.createElement("div",{className:"space-y-4"},q.map(L=>{var ee,ie,Oe,Qe;return t.createElement("div",{key:L.id,className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"flex items-start justify-between"},t.createElement("div",{className:"flex-1"},t.createElement("div",{className:"flex items-center space-x-3 mb-3"},t.createElement("h4",{className:"font-medium text-gray-900"},L.titulo),t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${L.estado==="pendiente"?"bg-yellow-100 text-yellow-800":L.estado==="aprobado"?"bg-green-100 text-green-800":L.estado==="rechazado"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`},L.estado==="pendiente"?"⏳ Pendiente":L.estado==="aprobado"?"✅ Aprobado":L.estado==="rechazado"?"❌ Rechazado":L.estado),L.prioridad&&t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${L.prioridad==="urgente"?"bg-red-100 text-red-800":L.prioridad==="alta"?"bg-orange-100 text-orange-800":L.prioridad==="normal"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`},L.prioridad==="urgente"?"🔴 Urgente":L.prioridad==="alta"?"🟠 Alta":L.prioridad==="normal"?"🟡 Normal":"🟢 Baja")),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3"},t.createElement("div",{className:"text-sm"},t.createElement("span",{className:"font-medium text-gray-700"},"Tipo:"),t.createElement("span",{className:"ml-2 text-gray-600 capitalize"},L.tipo)),t.createElement("div",{className:"text-sm"},t.createElement("span",{className:"font-medium text-gray-700"},"Presupuesto:"),t.createElement("span",{className:"ml-2 text-gray-600"},"$",(ee=L.presupuesto)==null?void 0:ee.toLocaleString())),t.createElement("div",{className:"text-sm"},t.createElement("span",{className:"font-medium text-gray-700"},"Duración:"),t.createElement("span",{className:"ml-2 text-gray-600"},L.fechaInicio," - ",L.fechaFin))),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},L.descripcion),L.comentariosAdmin&&t.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 mb-3"},t.createElement("p",{className:"text-sm text-green-800"},t.createElement("span",{className:"font-medium"},"💬 Comentarios del Admin:")," ",L.comentariosAdmin)),t.createElement("div",{className:"flex items-center justify-between text-xs text-gray-500"},t.createElement("span",null,"📅 Solicitado: ",((Qe=(Oe=(ie=L.fechaSolicitud)==null?void 0:ie.toDate)==null?void 0:Oe.call(ie))==null?void 0:Qe.toLocaleDateString())||"N/A"),L.agenteAsignado&&t.createElement("span",null,"👤 Agente: ",L.agenteAsignado)),L.estado==="pendiente"&&t.createElement("div",{className:"mt-3"},t.createElement("label",{className:"block text-xs font-medium text-gray-700 mb-1"},"Prioridad:"),t.createElement("select",{value:L.prioridad||"normal",onChange:_t=>ds(L.id,"campana",_t.target.value),className:"text-xs px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"},t.createElement("option",{value:"baja"},"🟢 Baja"),t.createElement("option",{value:"normal"},"🟡 Normal"),t.createElement("option",{value:"alta"},"🟠 Alta"),t.createElement("option",{value:"urgente"},"🔴 Urgente")))),t.createElement("div",{className:"ml-4 flex flex-col space-y-2"},t.createElement("button",{onClick:()=>of(L),className:"text-blue-600 hover:text-blue-800 text-sm px-3 py-1 border border-blue-300 rounded hover:bg-blue-50"},"👁️ Vista Previa"),L.estado==="pendiente"&&t.createElement("button",{onClick:()=>cr(L.id,"campana"),className:"text-red-600 hover:text-red-800 text-sm px-3 py-1 border border-red-300 rounded hover:bg-red-50"},"❌ Cancelar"))))})):t.createElement("div",{className:"text-center py-8 text-gray-500"},t.createElement("p",null,"No hay solicitudes de campañas pendientes."),t.createElement("button",{onClick:()=>x(!0),className:"mt-2 text-blue-600 hover:text-blue-800"},"Solicitar primera campaña"))))),b==="historial"&&t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"📜 Historial de Cambios"),t.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Registro de todas las modificaciones realizadas en tus solicitudes")),t.createElement("div",{className:"p-6"},we?t.createElement("div",{className:"text-center py-8"},t.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),t.createElement("p",{className:"text-gray-500 mt-2"},"Cargando historial...")):he.length>0?t.createElement("div",{className:"space-y-4"},he.map(L=>{var ee,ie,Oe,Qe,_t,nt;return t.createElement("div",{key:L.id,className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"flex items-start justify-between"},t.createElement("div",{className:"flex-1"},t.createElement("div",{className:"flex items-center space-x-3 mb-2"},t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${L.tipoCambio==="cambio_prioridad"?"bg-blue-100 text-blue-800":L.tipoCambio==="cancelacion"?"bg-red-100 text-red-800":L.tipoCambio==="aprobacion"?"bg-green-100 text-green-800":L.tipoCambio==="rechazo"?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"}`},L.tipoCambio==="cambio_prioridad"?"🔄 Cambio Prioridad":L.tipoCambio==="cancelacion"?"❌ Cancelación":L.tipoCambio==="aprobacion"?"✅ Aprobación":L.tipoCambio==="rechazo"?"⚠️ Rechazo":L.tipoCambio),t.createElement("span",{className:"text-xs text-gray-500"},((Oe=(ie=(ee=L.fechaCambio)==null?void 0:ee.toDate)==null?void 0:ie.call(ee))==null?void 0:Oe.toLocaleDateString())||"N/A"),t.createElement("span",{className:"text-xs text-gray-500"},((nt=(_t=(Qe=L.fechaCambio)==null?void 0:Qe.toDate)==null?void 0:_t.call(Qe))==null?void 0:nt.toLocaleTimeString())||"N/A")),t.createElement("h4",{className:"font-medium text-gray-900 mb-2"},L.descripcion),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3 text-sm"},t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Tipo:"),t.createElement("span",{className:"ml-2 text-gray-600 capitalize"},L.tipoSolicitud)),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Solicitud ID:"),t.createElement("span",{className:"ml-2 text-gray-600 font-mono text-xs"},L.solicitudId)),t.createElement("div",null,t.createElement("span",{className:"font-medium text-gray-700"},"Usuario:"),t.createElement("span",{className:"ml-2 text-gray-600 capitalize"},L.usuario))))))})):t.createElement("div",{className:"text-center py-8 text-gray-500"},t.createElement("p",null,"No hay cambios registrados aún."),t.createElement("p",{className:"text-sm mt-1"},"El historial se actualiza automáticamente con cada modificación."))))),b==="reportes"&&(La("reportes")?t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"📊 Generador de Reportes"),t.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Analiza el rendimiento de tu empresa con reportes personalizados")),t.createElement("div",{className:"p-6"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Fecha Inicio"),t.createElement("input",{type:"date",value:H.fechaInicio,onChange:L=>Pe({...H,fechaInicio:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Fecha Fin"),t.createElement("input",{type:"date",value:H.fechaFin,onChange:L=>Pe({...H,fechaFin:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tipo"),t.createElement("select",{value:H.tipo,onChange:L=>Pe({...H,tipo:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"todos"},"Todos"),t.createElement("option",{value:"producto"},"Productos"),t.createElement("option",{value:"campana"},"Campañas"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Estado"),t.createElement("select",{value:H.estado,onChange:L=>Pe({...H,estado:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"todos"},"Todos"),t.createElement("option",{value:"pendiente"},"Pendiente"),t.createElement("option",{value:"aprobado"},"Aprobado"),t.createElement("option",{value:"rechazado"},"Rechazado")))),t.createElement("div",{className:"flex space-x-3"},t.createElement("button",{onClick:ic,disabled:je,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50"},je?"Generando...":"📊 Generar Reporte"),t.createElement("button",{onClick:()=>it(!0),className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors"},"📄 Exportar")))),B.solicitudesDelMes>0&&t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4"},t.createElement("div",{className:"bg-white p-4 rounded-lg shadow"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"p-3 rounded-full bg-blue-100 text-blue-600"},"📝"),t.createElement("div",{className:"ml-4"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},B.solicitudesDelMes),t.createElement("p",{className:"text-sm text-gray-600"},"Solicitudes")))),t.createElement("div",{className:"bg-white p-4 rounded-lg shadow"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"p-3 rounded-full bg-green-100 text-green-600"},"✅"),t.createElement("div",{className:"ml-4"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},B.solicitudesAprobadas),t.createElement("p",{className:"text-sm text-gray-600"},"Aprobadas")))),t.createElement("div",{className:"bg-white p-4 rounded-lg shadow"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"p-3 rounded-full bg-red-100 text-red-600"},"❌"),t.createElement("div",{className:"ml-4"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},B.solicitudesRechazadas),t.createElement("p",{className:"text-sm text-gray-600"},"Rechazadas")))),t.createElement("div",{className:"bg-white p-4 rounded-lg shadow"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"p-3 rounded-full bg-yellow-100 text-yellow-600"},"⏳"),t.createElement("div",{className:"ml-4"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},B.solicitudesPendientes||0),t.createElement("p",{className:"text-sm text-gray-600"},"Pendientes")))),t.createElement("div",{className:"bg-white p-4 rounded-lg shadow"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"p-3 rounded-full bg-purple-100 text-purple-600"},"📦"),t.createElement("div",{className:"ml-4"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},B.productosActivos),t.createElement("p",{className:"text-sm text-gray-600"},"Productos Activos")))),t.createElement("div",{className:"bg-white p-4 rounded-lg shadow"},t.createElement("div",{className:"flex items-center"},t.createElement("div",{className:"p-3 rounded-full bg-orange-100 text-orange-600"},"📢"),t.createElement("div",{className:"ml-4"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},B.campanasActivas),t.createElement("p",{className:"text-sm text-gray-600"},"Campañas Activas"))))),B.detalles&&t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"📋 Distribución por Tipo")),t.createElement("div",{className:"p-6"},t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("span",{className:"text-sm text-gray-600"},"📦 Productos"),t.createElement("div",{className:"flex items-center space-x-2"},t.createElement("div",{className:"w-32 bg-gray-200 rounded-full h-2"},t.createElement("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${B.solicitudesDelMes>0?B.detalles.solicitudesPorTipo.productos/B.solicitudesDelMes*100:0}%`}})),t.createElement("span",{className:"text-sm font-medium text-gray-900"},B.detalles.solicitudesPorTipo.productos))),t.createElement("div",{className:"flex items-center justify-between"},t.createElement("span",{className:"text-sm text-gray-600"},"📢 Campañas"),t.createElement("div",{className:"flex items-center space-x-2"},t.createElement("div",{className:"w-32 bg-gray-200 rounded-full h-2"},t.createElement("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${B.solicitudesDelMes>0?B.detalles.solicitudesPorTipo.campanas/B.solicitudesDelMes*100:0}%`}})),t.createElement("span",{className:"text-sm font-medium text-gray-900"},B.detalles.solicitudesPorTipo.campanas)))))),t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"🎯 Distribución por Prioridad")),t.createElement("div",{className:"p-6"},t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("span",{className:"text-sm text-gray-600"},"🔴 Urgente"),t.createElement("div",{className:"flex items-center space-x-2"},t.createElement("div",{className:"w-32 bg-gray-200 rounded-full h-2"},t.createElement("div",{className:"bg-red-600 h-2 rounded-full",style:{width:`${B.solicitudesDelMes>0?B.detalles.solicitudesPorPrioridad.urgente/B.solicitudesDelMes*100:0}%`}})),t.createElement("span",{className:"text-sm font-medium text-gray-900"},B.detalles.solicitudesPorPrioridad.urgente))),t.createElement("div",{className:"flex items-center justify-between"},t.createElement("span",{className:"text-sm text-gray-600"},"🟠 Alta"),t.createElement("div",{className:"flex items-center space-x-2"},t.createElement("div",{className:"w-32 bg-gray-200 rounded-full h-2"},t.createElement("div",{className:"bg-orange-600 h-2 rounded-full",style:{width:`${B.solicitudesDelMes>0?B.detalles.solicitudesPorPrioridad.alta/B.solicitudesDelMes*100:0}%`}})),t.createElement("span",{className:"text-sm font-medium text-gray-900"},B.detalles.solicitudesPorPrioridad.alta))),t.createElement("div",{className:"flex items-center justify-between"},t.createElement("span",{className:"text-sm text-gray-600"},"🟡 Normal"),t.createElement("div",{className:"flex items-center space-x-2"},t.createElement("div",{className:"w-32 bg-gray-200 rounded-full h-2"},t.createElement("div",{className:"bg-yellow-600 h-2 rounded-full",style:{width:`${B.solicitudesDelMes>0?B.detalles.solicitudesPorPrioridad.normal/B.solicitudesDelMes*100:0}%`}})),t.createElement("span",{className:"text-sm font-medium text-gray-900"},B.detalles.solicitudesPorPrioridad.normal))),t.createElement("div",{className:"flex items-center justify-between"},t.createElement("span",{className:"text-sm text-gray-600"},"🟢 Baja"),t.createElement("div",{className:"flex items-center space-x-2"},t.createElement("div",{className:"w-32 bg-gray-200 rounded-full h-2"},t.createElement("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${B.solicitudesDelMes>0?B.detalles.solicitudesPorPrioridad.baja/B.solicitudesDelMes*100:0}%`}})),t.createElement("span",{className:"text-sm font-medium text-gray-900"},B.detalles.solicitudesPorPrioridad.baja))))))),B.tiempoPromedioRespuesta>0&&t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"⏱️ Métricas de Rendimiento")),t.createElement("div",{className:"p-6"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-blue-600"},B.tiempoPromedioRespuesta),t.createElement("div",{className:"text-sm text-gray-600 mt-1"},"Días promedio de respuesta")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-green-600"},B.solicitudesDelMes>0?Math.round(B.solicitudesAprobadas/B.solicitudesDelMes*100):0,"%"),t.createElement("div",{className:"text-sm text-gray-600 mt-1"},"Tasa de aprobación")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-purple-600"},B.productosActivos+B.campanasActivas),t.createElement("div",{className:"text-sm text-gray-600 mt-1"},"Total elementos activos")))))):t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-12 text-center"},t.createElement("div",{className:"text-6xl mb-6"},"📊"),t.createElement("h2",{className:"text-3xl font-bold text-gray-900 mb-4"},"Reportes Avanzados Premium"),t.createElement("p",{className:"text-lg text-gray-600 mb-8"},"Los reportes detallados están disponibles solo para planes Premium y Corporate.",t.createElement("br",null),"Actualiza tu plan para acceder a análisis y reportes personalizados."),t.createElement("button",{onClick:()=>v("membresias"),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-xl text-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all duration-300 transform hover:scale-105"},"🚀 Ver Planes Disponibles"))),b==="clientes"&&(La("clientes")?t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Gestión de Clientes")),t.createElement("div",{className:"p-6"},u.length>0?t.createElement("div",{className:"overflow-x-auto"},t.createElement("table",{className:"min-w-full divide-y divide-gray-200"},t.createElement("thead",{className:"bg-gray-50"},t.createElement("tr",null,t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Cliente"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Email"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),t.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),t.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},u.map(L=>t.createElement("tr",{key:L.id},t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("div",{className:"text-sm font-medium text-gray-900"},L.nombre||"Sin nombre")),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("div",{className:"text-sm text-gray-900"},L.email)),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},t.createElement("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800"},"Activo")),t.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},t.createElement("button",{className:"text-blue-600 hover:text-blue-900 mr-3"},"Ver"),t.createElement("button",{className:"text-green-600 hover:text-green-900"},"Contactar"))))))):t.createElement("div",{className:"text-center py-8 text-gray-500"},t.createElement("p",null,"No hay clientes registrados aún.")))):t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-12 text-center"},t.createElement("div",{className:"text-6xl mb-6"},"👥"),t.createElement("h2",{className:"text-3xl font-bold text-gray-900 mb-4"},"Gestión de Clientes Premium"),t.createElement("p",{className:"text-lg text-gray-600 mb-8"},"La gestión avanzada de clientes está disponible solo para planes Premium y Corporate.",t.createElement("br",null),"Actualiza tu plan para acceder a herramientas de CRM y gestión de relaciones."),t.createElement("button",{onClick:()=>v("membresias"),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-xl text-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all duration-300 transform hover:scale-105"},"🚀 Ver Planes Disponibles"))),b==="metricas"&&(La("metricas")?t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-white shadow rounded-lg p-6"},t.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4"},"Métricas de Rendimiento"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-blue-600"},((Td=m.visitasPerfil)==null?void 0:Td.toLocaleString())||0),t.createElement("div",{className:"text-sm text-gray-500"},"Visitas al Perfil")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-green-600"},m.productosVendidos||0),t.createElement("div",{className:"text-sm text-gray-500"},"Productos Vendidos")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-yellow-600"},m.clientesNuevos||0),t.createElement("div",{className:"text-sm text-gray-500"},"Clientes Nuevos")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-purple-600"},m.calificacionPromedio||0),t.createElement("div",{className:"text-sm text-gray-500"},"Calificación Promedio")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-indigo-600"},m.conversionRate||0,"%"),t.createElement("div",{className:"text-sm text-gray-500"},"Tasa de Conversión")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl font-bold text-pink-600"},m.engagementRate||0,"%"),t.createElement("div",{className:"text-sm text-gray-500"},"Tasa de Engagement")))),t.createElement("div",{className:"bg-white shadow rounded-lg p-6"},t.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4"},"Recomendaciones para Mejorar"),t.createElement("div",{className:"space-y-3"},t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("span",{className:"text-green-500 text-lg"},"✓"),t.createElement("div",null,t.createElement("p",{className:"font-medium text-gray-900"},"Optimizar descripciones de productos"),t.createElement("p",{className:"text-sm text-gray-600"},"Mejora las descripciones para aumentar la conversión"))),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("span",{className:"text-yellow-500 text-lg"},"⚠"),t.createElement("div",null,t.createElement("p",{className:"font-medium text-gray-900"},"Aumentar presencia en redes sociales"),t.createElement("p",{className:"text-sm text-gray-600"},"Mejora tu visibilidad online"))),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("span",{className:"text-blue-500 text-lg"},"💡"),t.createElement("div",null,t.createElement("p",{className:"font-medium text-gray-900"},"Crear campañas estacionales"),t.createElement("p",{className:"text-sm text-gray-600"},"Aprovecha las tendencias del mercado")))))):t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-12 text-center"},t.createElement("div",{className:"text-6xl mb-6"},"💎"),t.createElement("h2",{className:"text-3xl font-bold text-gray-900 mb-4"},"Funcionalidad Premium"),t.createElement("p",{className:"text-lg text-gray-600 mb-8"},"Las métricas avanzadas están disponibles solo para planes Premium y Corporate.",t.createElement("br",null),"Actualiza tu plan para acceder a análisis detallados de rendimiento."),t.createElement("button",{onClick:()=>v("membresias"),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-xl text-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all duration-300 transform hover:scale-105"},"🚀 Ver Planes Disponibles"))),b==="membresias"&&t.createElement("div",{className:"space-y-8"},t.createElement("div",{className:"bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 rounded-2xl p-8 text-white text-center"},t.createElement("h1",{className:"text-4xl font-bold mb-4"},"💎 Planes de Membresía"),t.createElement("p",{className:"text-xl text-purple-100"},"Elige el plan que mejor se adapte a tu negocio"),t.createElement("div",{className:"mt-4"},t.createElement("span",{className:"bg-white/20 px-4 py-2 rounded-full text-sm"},"Plan Actual: ",tt.plan.toUpperCase()))),$e?t.createElement("div",{className:"flex items-center justify-center py-16"},t.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"}),t.createElement("span",{className:"ml-4 text-gray-600 text-lg"},"Cargando información de membresía...")):t.createElement("div",{className:"space-y-8"},t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},t.createElement("div",{className:`relative bg-white rounded-2xl shadow-lg p-8 border-2 ${tt.plan==="free"?"border-purple-500 bg-purple-50":"border-gray-200"}`},tt.plan==="free"&&t.createElement("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2"},t.createElement("span",{className:"bg-purple-600 text-white px-4 py-2 rounded-full text-sm font-medium"},"Plan Actual")),t.createElement("div",{className:"text-center mb-6"},t.createElement("div",{className:"text-5xl mb-4"},"🚀"),t.createElement("h3",{className:"text-2xl font-bold text-gray-900 mb-2"},"Plan FREE"),t.createElement("div",{className:"text-4xl font-bold text-gray-900 mb-2"},"$0"),t.createElement("p",{className:"text-gray-600"},"Para empezar tu negocio")),t.createElement("div",{className:"space-y-4 mb-8"},t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Hasta 5 productos"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Hasta 2 campañas por mes"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Perfil básico visible"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Soporte por email"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Acceso básico al dashboard")),t.createElement("div",{className:"space-y-3 mb-6"},t.createElement("div",{className:"text-sm text-gray-600 font-medium"},"Limitaciones:"),t.createElement("div",{className:"flex items-center text-sm text-gray-500"},t.createElement("span",{className:"text-orange-500 mr-3"},"⚠"),"Sin métricas avanzadas"),t.createElement("div",{className:"flex items-center text-sm text-gray-500"},t.createElement("span",{className:"text-orange-500 mr-3"},"⚠"),"Sin reportes detallados"),t.createElement("div",{className:"flex items-center text-sm text-gray-500"},t.createElement("span",{className:"text-orange-500 mr-3"},"⚠"),"Sin gestión de clientes"),t.createElement("div",{className:"flex items-center text-sm text-gray-500"},t.createElement("span",{className:"text-orange-500 mr-3"},"⚠"),"Sin herramientas premium")),t.createElement("button",{className:`w-full py-3 rounded-xl font-medium transition-all duration-300 ${tt.plan==="free"?"bg-gray-300 text-gray-600 cursor-not-allowed":"bg-gray-600 text-white hover:bg-gray-700 transform hover:scale-105"}`,disabled:tt.plan==="free"},tt.plan==="free"?"Plan Actual":"Seleccionar")),t.createElement("div",{className:"relative bg-white rounded-2xl shadow-lg p-8 border-2 border-blue-500 transform scale-105"},t.createElement("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2"},t.createElement("span",{className:"bg-blue-600 text-white px-4 py-2 rounded-full text-sm font-medium"},"Más Popular")),t.createElement("div",{className:"text-center mb-6"},t.createElement("div",{className:"text-5xl mb-4"},"💎"),t.createElement("h3",{className:"text-2xl font-bold text-gray-900 mb-2"},"Plan PREMIUM"),t.createElement("div",{className:"text-4xl font-bold text-blue-600 mb-2"},"$29.99"),t.createElement("p",{className:"text-gray-600"},"Por mes")),t.createElement("div",{className:"space-y-4 mb-8"},t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Hasta 25 productos"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Hasta 10 campañas por mes"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Perfil destacado en búsquedas"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Métricas básicas"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Reportes mensuales"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Gestión básica de clientes"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Soporte prioritario"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Herramientas de marketing")),t.createElement("button",{className:`w-full py-3 rounded-xl font-medium transition-all duration-300 transform hover:scale-105 ${tt.plan==="premium"?"bg-blue-300 text-blue-600 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,disabled:tt.plan==="premium"},tt.plan==="premium"?"Plan Actual":"Actualizar a Premium")),t.createElement("div",{className:"relative bg-white rounded-2xl shadow-lg p-8 border-2 border-purple-500"},t.createElement("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2"},t.createElement("span",{className:"bg-purple-600 text-white px-4 py-2 rounded-full text-sm font-medium"},"Empresarial")),t.createElement("div",{className:"text-center mb-6"},t.createElement("div",{className:"text-5xl mb-4"},"🏢"),t.createElement("h3",{className:"text-2xl font-bold text-gray-900 mb-2"},"Plan CORPORATE"),t.createElement("div",{className:"text-4xl font-bold text-purple-600 mb-2"},"$99.99"),t.createElement("p",{className:"text-gray-600"},"Por mes")),t.createElement("div",{className:"space-y-4 mb-8"},t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Productos ilimitados"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Campañas ilimitadas"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Prioridad máxima en búsquedas"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Métricas avanzadas en tiempo real"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Reportes personalizados"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"CRM completo de clientes"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Herramientas premium"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Soporte 24/7 dedicado"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"Asesoría personalizada"),t.createElement("div",{className:"flex items-center text-sm text-gray-700"},t.createElement("span",{className:"text-green-500 mr-3 text-lg"},"✓"),"API de integración")),t.createElement("button",{className:`w-full py-3 rounded-xl font-medium transition-all duration-300 transform hover:scale-105 ${tt.plan==="corporate"?"bg-purple-300 text-purple-600 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700"}`,disabled:tt.plan==="corporate"},tt.plan==="corporate"?"Plan Actual":"Actualizar a Corporate"))),t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-8"},t.createElement("h3",{className:"text-2xl font-bold text-gray-900 mb-6 text-center"},"📊 Comparación de Funcionalidades"),t.createElement("div",{className:"overflow-x-auto"},t.createElement("table",{className:"w-full"},t.createElement("thead",null,t.createElement("tr",{className:"border-b-2 border-gray-200"},t.createElement("th",{className:"text-left py-4 px-6 text-lg font-bold text-gray-900"},"Funcionalidad"),t.createElement("th",{className:"text-center py-4 px-6 text-lg font-bold text-gray-900"},"FREE"),t.createElement("th",{className:"text-center py-4 px-6 text-lg font-bold text-blue-600"},"PREMIUM"),t.createElement("th",{className:"text-center py-4 px-6 text-lg font-bold text-purple-600"},"CORPORATE"))),t.createElement("tbody",{className:"divide-y divide-gray-200"},t.createElement("tr",null,t.createElement("td",{className:"py-4 px-6 font-medium"},"Productos"),t.createElement("td",{className:"text-center py-4 px-6"},"5"),t.createElement("td",{className:"text-center py-4 px-6"},"25"),t.createElement("td",{className:"text-center py-4 px-6"},"∞")),t.createElement("tr",null,t.createElement("td",{className:"py-4 px-6 font-medium"},"Campañas por mes"),t.createElement("td",{className:"text-center py-4 px-6"},"2"),t.createElement("td",{className:"text-center py-4 px-6"},"10"),t.createElement("td",{className:"text-center py-4 px-6"},"∞")),t.createElement("tr",null,t.createElement("td",{className:"py-4 px-6 font-medium"},"Métricas"),t.createElement("td",{className:"text-center py-4 px-6"},"❌"),t.createElement("td",{className:"text-center py-4 px-6"},"✅ Básicas"),t.createElement("td",{className:"text-center py-4 px-6"},"✅ Avanzadas")),t.createElement("tr",null,t.createElement("td",{className:"py-4 px-6 font-medium"},"Reportes"),t.createElement("td",{className:"text-center py-4 px-6"},"❌"),t.createElement("td",{className:"text-center py-4 px-6"},"✅ Mensuales"),t.createElement("td",{className:"text-center py-4 px-6"},"✅ Personalizados")),t.createElement("tr",null,t.createElement("td",{className:"py-4 px-6 font-medium"},"Gestión de Clientes"),t.createElement("td",{className:"text-center py-4 px-6"},"❌"),t.createElement("td",{className:"text-center py-4 px-6"},"✅ Básica"),t.createElement("td",{className:"text-center py-4 px-6"},"✅ Completa")),t.createElement("tr",null,t.createElement("td",{className:"py-4 px-6 font-medium"},"Herramientas Premium"),t.createElement("td",{className:"text-center py-4 px-6"},"❌"),t.createElement("td",{className:"text-center py-4 px-6"},"✅ Limitadas"),t.createElement("td",{className:"text-center py-4 px-6"},"✅ Todas")),t.createElement("tr",null,t.createElement("td",{className:"py-4 px-6 font-medium"},"Soporte"),t.createElement("td",{className:"text-center py-4 px-6"},"Email"),t.createElement("td",{className:"text-center py-4 px-6"},"Prioritario"),t.createElement("td",{className:"text-center py-4 px-6"},"24/7 Dedicado")))))),t.createElement("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-2xl p-8"},t.createElement("h3",{className:"text-2xl font-bold text-blue-900 mb-4 text-center"},"ℹ️ Información Importante"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.createElement("div",{className:"space-y-3"},t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("span",{className:"text-blue-600 text-lg"},"💳"),t.createElement("div",null,t.createElement("h4",{className:"font-medium text-blue-900"},"Facturación"),t.createElement("p",{className:"text-sm text-blue-800"},"Los cambios de plan se aplican al siguiente ciclo de facturación"))),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("span",{className:"text-blue-600 text-lg"},"🔄"),t.createElement("div",null,t.createElement("h4",{className:"font-medium text-blue-900"},"Flexibilidad"),t.createElement("p",{className:"text-sm text-blue-800"},"Puedes cambiar o cancelar tu suscripción en cualquier momento")))),t.createElement("div",{className:"space-y-3"},t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("span",{className:"text-blue-600 text-lg"},"🆘"),t.createElement("div",null,t.createElement("h4",{className:"font-medium text-blue-900"},"Soporte"),t.createElement("p",{className:"text-sm text-blue-800"},"El soporte premium está disponible 24/7 para planes pagos"))),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("span",{className:"text-blue-600 text-lg"},"📈"),t.createElement("div",null,t.createElement("h4",{className:"font-medium text-blue-900"},"Funcionalidades"),t.createElement("p",{className:"text-sm text-blue-800"},"Las métricas y reportes avanzados se desbloquean con planes superiores")))))))),b==="red"&&t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg p-6 text-white"},t.createElement("h3",{className:"text-2xl font-bold mb-4"},"🌐 Red AV 10 de Julio"),t.createElement("p",{className:"text-lg mb-4"},"Únete a la red más grande de proveedores automotrices de calidad en la región"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl mb-2"},"🌟"),t.createElement("div",{className:"font-medium"},"Sello de Calidad"),t.createElement("div",{className:"text-sm opacity-90"},"Certificación de excelencia")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl mb-2"},"🤝"),t.createElement("div",{className:"font-medium"},"Networking"),t.createElement("div",{className:"text-sm opacity-90"},"Conecta con otros proveedores")),t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-3xl mb-2"},"📈"),t.createElement("div",{className:"font-medium"},"Crecimiento"),t.createElement("div",{className:"text-sm opacity-90"},"Expande tu negocio")))),t.createElement("div",{className:"bg-white shadow rounded-lg p-6"},t.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4"},"Beneficios de la Red"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("span",{className:"text-green-500 text-lg"},"✓"),t.createElement("div",null,t.createElement("p",{className:"font-medium text-gray-900"},"Visibilidad Premium"),t.createElement("p",{className:"text-sm text-gray-600"},"Aparece primero en búsquedas"))),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("span",{className:"text-green-500 text-lg"},"✓"),t.createElement("div",null,t.createElement("p",{className:"font-medium text-gray-900"},"Reportes Avanzados"),t.createElement("p",{className:"text-sm text-gray-600"},"Métricas detalladas de rendimiento"))),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("span",{className:"text-green-500 text-lg"},"✓"),t.createElement("div",null,t.createElement("p",{className:"font-medium text-gray-900"},"Asesoría Especializada"),t.createElement("p",{className:"text-sm text-gray-600"},"Consultoría personalizada"))),t.createElement("div",{className:"flex items-start space-x-3"},t.createElement("span",{className:"text-green-500 text-lg"},"✓"),t.createElement("div",null,t.createElement("p",{className:"font-medium text-gray-900"},"Capacitaciones"),t.createElement("p",{className:"text-sm text-gray-600"},"Cursos y talleres exclusivos"))))),t.createElement("div",{className:"bg-white shadow rounded-lg p-6"},t.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4"},"Próximos Eventos de la Red"),t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"border-l-4 border-blue-500 pl-4"},t.createElement("h4",{className:"font-medium text-gray-900"},"Taller de Marketing Digital"),t.createElement("p",{className:"text-sm text-gray-600"},"15 de Diciembre, 2024 - 14:00 hrs"),t.createElement("p",{className:"text-sm text-gray-500"},"Aprende estrategias para aumentar ventas online")),t.createElement("div",{className:"border-l-4 border-green-500 pl-4"},t.createElement("h4",{className:"font-medium text-gray-900"},"Networking Empresarial"),t.createElement("p",{className:"text-sm text-gray-600"},"20 de Diciembre, 2024 - 18:00 hrs"),t.createElement("p",{className:"text-sm text-gray-500"},"Conecta con otros proveedores de la red"))))),b==="herramientas"&&(La("herramientas")?t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-white shadow rounded-lg p-6"},t.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4"},"🛠️ Herramientas de Gestión"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},t.createElement("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"text-3xl mb-3"},"📊"),t.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Analytics Avanzado"),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Métricas detalladas de rendimiento"),t.createElement("button",{className:"w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 transition-colors"},"Acceder")),t.createElement("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"text-3xl mb-3"},"📢"),t.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Gestor de Campañas"),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Crea y gestiona campañas automáticas"),t.createElement("button",{className:"w-full bg-green-600 text-white py-2 rounded-md hover:bg-green-700 transition-colors"},"Acceder")),t.createElement("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"text-3xl mb-3"},"👥"),t.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"CRM de Clientes"),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Gestiona tu base de clientes"),t.createElement("button",{className:"w-full bg-purple-600 text-white py-2 rounded-md hover:bg-purple-700 transition-colors"},"Acceder")),t.createElement("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"text-3xl mb-3"},"📈"),t.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Reportes Comparativos"),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Compara tu rendimiento con el mercado"),t.createElement("button",{className:"w-full bg-yellow-600 text-white py-2 rounded-md hover:bg-yellow-700 transition-colors"},"Acceder")),t.createElement("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"text-3xl mb-3"},"🎓"),t.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Capacitaciones"),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Cursos y talleres especializados"),t.createElement("button",{className:"w-full bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 transition-colors"},"Acceder")),t.createElement("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"text-3xl mb-3"},"💡"),t.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Asesoría"),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Consultoría personalizada"),t.createElement("button",{className:"w-full bg-pink-600 text-white py-2 rounded-md hover:bg-pink-700 transition-colors"},"Acceder")))),t.createElement("div",{className:"bg-white shadow rounded-lg p-6"},t.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4"},"🎯 Servicios con Descuento"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.createElement("div",{className:"border rounded-lg p-4"},t.createElement("div",{className:"flex items-center justify-between mb-3"},t.createElement("h4",{className:"font-medium text-gray-900"},"📸 Fotografía Profesional"),t.createElement("span",{className:"bg-red-100 text-red-800 text-xs font-medium px-2 py-1 rounded-full"},"-30%")),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Fotografía profesional para tus productos"),t.createElement("div",{className:"flex items-center justify-between"},t.createElement("span",{className:"text-lg font-bold text-green-600"},"$70.000"),t.createElement("span",{className:"text-sm text-gray-500 line-through"},"$100.000")),t.createElement("button",{className:"w-full mt-3 bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 transition-colors"},"Contratar")),t.createElement("div",{className:"border rounded-lg p-4"},t.createElement("div",{className:"flex items-center justify-between mb-3"},t.createElement("h4",{className:"font-medium text-gray-900"},"🎨 Diseño Gráfico"),t.createElement("span",{className:"bg-red-100 text-red-800 text-xs font-medium px-2 py-1 rounded-full"},"-25%")),t.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Diseño de logos, banners y material promocional"),t.createElement("div",{className:"flex items-center justify-between"},t.createElement("span",{className:"text-lg font-bold text-green-600"},"$150.000"),t.createElement("span",{className:"text-sm text-gray-500 line-through"},"$200.000")),t.createElement("button",{className:"w-full mt-3 bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 transition-colors"},"Contratar"))))):t.createElement("div",{className:"bg-white rounded-2xl shadow-lg p-12 text-center"},t.createElement("div",{className:"text-6xl mb-6"},"🛠️"),t.createElement("h2",{className:"text-3xl font-bold text-gray-900 mb-4"},"Herramientas Premium"),t.createElement("p",{className:"text-lg text-gray-600 mb-8"},"Las herramientas avanzadas están disponibles solo para planes Premium y Corporate.",t.createElement("br",null),"Actualiza tu plan para acceder a funcionalidades de gestión avanzada."),t.createElement("button",{onClick:()=>v("membresias"),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-xl text-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all duration-300 transform hover:scale-105"},"🚀 Ver Planes Disponibles"))),b==="usuario"&&t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-white shadow rounded-lg p-6"},t.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4"},"👤 Información del Usuario"),t.createElement("p",{className:"text-sm text-gray-600 mb-6"},"Credenciales de acceso y configuración de la cuenta"),t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},t.createElement("div",{className:"border rounded-lg p-4"},t.createElement("h4",{className:"font-medium text-gray-900 mb-3"},"🏢 Datos de la Empresa"),t.createElement("div",{className:"space-y-3"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Nombre de la Empresa"),t.createElement("p",{className:"text-sm text-gray-900 bg-gray-50 p-2 rounded border"},(e==null?void 0:e.nombre)||"No disponible")),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"RUT"),t.createElement("p",{className:"text-sm text-gray-900 bg-gray-50 p-2 rounded border"},(e==null?void 0:e.rut)||"No disponible")),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Email de Contacto"),t.createElement("p",{className:"text-sm text-gray-900 bg-gray-50 p-2 rounded border"},(e==null?void 0:e.email)||"No disponible")),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Teléfono"),t.createElement("p",{className:"text-sm text-gray-900 bg-gray-50 p-2 rounded border"},(e==null?void 0:e.telefono)||"No disponible")),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Estado"),t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${(e==null?void 0:e.estado)==="activa"?"bg-green-100 text-green-800":(e==null?void 0:e.estado)==="pendiente"?"bg-yellow-100 text-yellow-800":(e==null?void 0:e.estado)==="suspendida"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`},(e==null?void 0:e.estado)||"No disponible")))),t.createElement("div",{className:"border rounded-lg p-4"},t.createElement("h4",{className:"font-medium text-gray-900 mb-3"},"🔐 Credenciales de Acceso"),t.createElement("div",{className:"space-y-3"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Usuario (Email)"),t.createElement("div",{className:"flex items-center space-x-2"},t.createElement("p",{className:"text-sm text-gray-900 bg-gray-50 p-2 rounded border flex-1"},((Pd=e==null?void 0:e.credenciales)==null?void 0:Pd.email)||"No configurado"),((Rd=e==null?void 0:e.credenciales)==null?void 0:Rd.email)&&t.createElement("button",{className:"px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",onClick:()=>navigator.clipboard.writeText(e.credenciales.email),title:"Copiar email"},"📋"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Contraseña"),t.createElement("div",{className:"flex items-center space-x-2"},t.createElement("p",{className:"text-sm text-gray-900 bg-gray-50 p-2 rounded border flex-1"},(Dd=e==null?void 0:e.credenciales)!=null&&Dd.password?"••••••••":"No configurado"),((gs=e==null?void 0:e.credenciales)==null?void 0:gs.password)&&t.createElement("button",{className:"px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",onClick:()=>{navigator.clipboard.writeText(e.credenciales.password),alert("Contraseña copiada al portapapeles")},title:"Copiar contraseña"},"📋 Copiar")),((Bn=e==null?void 0:e.credenciales)==null?void 0:Bn.esProvisoria)&&t.createElement("div",{className:"mt-2 p-2 bg-orange-50 border border-orange-200 rounded"},t.createElement("span",{className:"inline-flex px-2 py-1 text-xs font-medium bg-orange-100 text-orange-800 rounded-full mb-2"},"⚠️ Contraseña Provisoria"),t.createElement("p",{className:"text-xs text-orange-700"},t.createElement("strong",null,"Importante:")," Esta contraseña debe ser cambiada por el proveedor en su primer acceso por seguridad."))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Rol del Usuario"),t.createElement("span",{className:"inline-flex px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full"},"🏢 Proveedor/Empresa")),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Estado de Credenciales"),t.createElement("div",{className:"flex items-center space-x-2"},t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${(dc=e==null?void 0:e.credenciales)!=null&&dc.email&&((mc=e==null?void 0:e.credenciales)!=null&&mc.password)?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`},(pc=e==null?void 0:e.credenciales)!=null&&pc.email&&((Dr=e==null?void 0:e.credenciales)!=null&&Dr.password)?"✅ Configuradas":"⚠️ Pendientes de Configuración"),(!((Ld=e==null?void 0:e.credenciales)!=null&&Ld.email)||!((Md=e==null?void 0:e.credenciales)!=null&&Md.password))&&t.createElement("button",{onClick:()=>Je(!0),className:"px-3 py-1 text-xs bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors"},"🔑 Asignar Credenciales"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Fecha de Asignación"),t.createElement("p",{className:"text-sm text-gray-900 bg-gray-50 p-2 rounded border"},(Vd=e==null?void 0:e.credenciales)!=null&&Vd.fechaAsignacion?new Date(e.credenciales.fechaAsignacion.toDate()).toLocaleString("es-ES"):"No asignadas")),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Último Acceso"),t.createElement("p",{className:"text-sm text-gray-900 bg-gray-50 p-2 rounded border"},e!=null&&e.ultimoAcceso?new Date(e.ultimoAcceso.toDate()).toLocaleString("es-ES"):"Nunca")),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700"},"UID de Firebase"),t.createElement("div",{className:"flex items-center space-x-2"},t.createElement("p",{className:"text-sm text-gray-900 bg-gray-50 p-2 rounded border flex-1 font-mono text-xs"},((qn=e==null?void 0:e.credenciales)==null?void 0:qn.uid)||"No disponible"),((Od=e==null?void 0:e.credenciales)==null?void 0:Od.uid)&&t.createElement("button",{className:"px-2 py-1 text-xs bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors",onClick:()=>{navigator.clipboard.writeText(e.credenciales.uid),alert("UID copiado al portapapeles")},title:"Copiar UID"},"📋")))))),t.createElement("div",{className:"mt-6 border rounded-lg p-4"},t.createElement("h4",{className:"font-medium text-gray-900 mb-3"},"⚙️ Acciones Disponibles"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},!((jd=e==null?void 0:e.credenciales)!=null&&jd.email)||!((bo=e==null?void 0:e.credenciales)!=null&&bo.password)?t.createElement("button",{onClick:()=>Je(!0),className:"flex items-center justify-center px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 transition-colors"},t.createElement("span",{className:"mr-2"},"🔑"),"Asignar Credenciales"):t.createElement("button",{onClick:()=>K(!0),className:"flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"},t.createElement("span",{className:"mr-2"},"🔑"),"Cambiar Contraseña"),t.createElement("button",{onClick:()=>{var L;Dt({...lt,currentEmail:((L=e==null?void 0:e.credenciales)==null?void 0:L.email)||""}),Ke(!0)},className:"flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors"},t.createElement("span",{className:"mr-2"},"📧"),"Cambiar Email"),t.createElement("button",{onClick:()=>{var L,ee,ie;ka({...ut,isEnabled:((L=e==null?void 0:e.configuracion2FA)==null?void 0:L.habilitado)||!1,method:((ee=e==null?void 0:e.configuracion2FA)==null?void 0:ee.metodo)||"sms",phoneNumber:((ie=e==null?void 0:e.configuracion2FA)==null?void 0:ie.telefono)||""}),et(!0)},className:"flex items-center justify-center px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors"},t.createElement("span",{className:"mr-2"},"🔒"),"Configurar 2FA"))),t.createElement("div",{className:"mt-6 border rounded-lg p-4"},t.createElement("h4",{className:"font-medium text-gray-900 mb-3"},"🛡️ Información de Seguridad"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.createElement("div",null,t.createElement("h5",{className:"font-medium text-gray-700 mb-2"},"Sesiones Activas"),t.createElement("div",{className:"space-y-2"},t.createElement("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded"},t.createElement("div",null,t.createElement("p",{className:"text-sm font-medium text-gray-900"},"Sesión Actual"),t.createElement("p",{className:"text-xs text-gray-600"},"Navegador: Chrome - Windows")),t.createElement("span",{className:"text-xs text-green-600 bg-green-100 px-2 py-1 rounded-full"},"Activa")))),t.createElement("div",null,t.createElement("h5",{className:"font-medium text-gray-700 mb-2"},"Actividad Reciente"),t.createElement("div",{className:"space-y-2"},t.createElement("div",{className:"text-sm text-gray-600"},t.createElement("p",null,"• Último login: ",new Date().toLocaleString("es-ES")),t.createElement("p",null,"• Cambios de contraseña: 0"),t.createElement("p",null,"• Intentos fallidos: 0")))))),t.createElement("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4"},t.createElement("h4",{className:"font-medium text-blue-900 mb-2"},"💡 Notas Importantes"),t.createElement("ul",{className:"text-sm text-blue-800 space-y-1"},t.createElement("li",null,"• Las credenciales son únicas para esta empresa y no deben compartirse"),t.createElement("li",null,"• Se recomienda cambiar la contraseña periódicamente"),t.createElement("li",null,"• En caso de pérdida de acceso, contactar al administrador"),t.createElement("li",null,'• El rol "Proveedor" permite acceso completo al dashboard'))))),b==="calendario"&&t.createElement("div",{className:"space-y-6"},t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"📅 Calendario Empresarial"),t.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Gestiona eventos, recordatorios y fechas importantes")),t.createElement("div",{className:"flex items-center space-x-3"},t.createElement("button",{onClick:()=>ca("mes"),className:`px-3 py-1 rounded-md text-sm font-medium ${ft==="mes"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Mes"),t.createElement("button",{onClick:()=>ca("semana"),className:`px-3 py-1 rounded-md text-sm font-medium ${ft==="semana"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Semana"),t.createElement("button",{onClick:()=>ca("dia"),className:`px-3 py-1 rounded-md text-sm font-medium ${ft==="dia"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Día"),t.createElement("button",{onClick:()=>Tt(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"},"+ Nuevo Evento"))))),t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("button",{onClick:()=>{const L=new Date(Me);ft==="mes"?L.setMonth(L.getMonth()-1):ft==="semana"?L.setDate(L.getDate()-7):L.setDate(L.getDate()-1),Xe(L)},className:"p-2 text-gray-400 hover:text-gray-600"},t.createElement("span",{className:"text-xl"},"←")),t.createElement("h2",{className:"text-xl font-semibold text-gray-900"},ft==="mes"&&Me.toLocaleDateString("es-ES",{month:"long",year:"numeric"}),ft==="semana"&&`Semana del ${Me.toLocaleDateString("es-ES",{day:"numeric",month:"short"})}`,ft==="dia"&&Me.toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long",year:"numeric"})),t.createElement("button",{onClick:()=>{const L=new Date(Me);ft==="mes"?L.setMonth(L.getMonth()+1):ft==="semana"?L.setDate(L.getDate()+7):L.setDate(L.getDate()+1),Xe(L)},className:"p-2 text-gray-400 hover:text-gray-600"},t.createElement("span",{className:"text-xl"},"→"))))),ft==="mes"&&t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"p-6"},t.createElement("div",{className:"grid grid-cols-7 gap-1"},["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"].map(L=>t.createElement("div",{key:L,className:"p-2 text-center text-sm font-medium text-gray-500 bg-gray-50"},L)),kd(Me).map((L,ee)=>L.map((ie,Oe)=>t.createElement("div",{key:`${ee}-${Oe}`,className:`min-h-[120px] p-2 border border-gray-200 ${ie.esDelMes?"bg-white":"bg-gray-50"} ${ie.fecha.toDateString()===new Date().toDateString()?"bg-blue-50 border-blue-300":""}`},t.createElement("div",{className:`text-sm font-medium ${ie.esDelMes?"text-gray-900":"text-gray-400"}`},ie.fecha.getDate()),t.createElement("div",{className:"mt-1 space-y-1"},ie.eventos.slice(0,3).map((Qe,_t)=>t.createElement("div",{key:_t,className:`text-xs p-1 rounded truncate cursor-pointer ${Qe.prioridad==="urgente"?"bg-red-100 text-red-800":Qe.prioridad==="alta"?"bg-orange-100 text-orange-800":Qe.prioridad==="normal"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,title:Qe.titulo},Qe.titulo)),ie.eventos.length>3&&t.createElement("div",{className:"text-xs text-gray-500 text-center"},"+",ie.eventos.length-3," más")))))))),ft==="semana"&&t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"p-6"},t.createElement("div",{className:"grid grid-cols-7 gap-4"},Sd(Me).map((L,ee)=>t.createElement("div",{key:ee,className:"p-3 border rounded-lg"},t.createElement("div",{className:"text-sm font-medium text-gray-900 mb-2"},L.fechaInicio.toDate().toLocaleDateString("es-ES",{weekday:"short",day:"numeric"})),t.createElement("div",{className:"space-y-2"},L.eventos.map((ie,Oe)=>t.createElement("div",{key:Oe,className:`text-xs p-2 rounded ${ie.prioridad==="urgente"?"bg-red-100 text-red-800":ie.prioridad==="alta"?"bg-orange-100 text-orange-800":ie.prioridad==="normal"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`},t.createElement("div",{className:"font-medium"},ie.titulo),t.createElement("div",{className:"text-xs opacity-75"},ie.descripcion))))))))),ft==="dia"&&t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"p-6"},t.createElement("div",{className:"space-y-4"},Rr(Me).map((L,ee)=>t.createElement("div",{key:ee,className:`p-4 border rounded-lg ${L.prioridad==="urgente"?"border-red-300 bg-red-50":L.prioridad==="alta"?"border-orange-300 bg-orange-50":L.prioridad==="normal"?"border-blue-300 bg-blue-50":"border-green-300 bg-green-50"}`},t.createElement("div",{className:"flex items-center justify-between"},t.createElement("div",null,t.createElement("h4",{className:"font-medium text-gray-900"},L.titulo),t.createElement("p",{className:"text-sm text-gray-600 mt-1"},L.descripcion),t.createElement("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500"},t.createElement("span",null,"🕐 ",L.fechaInicio.toDate().toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})),t.createElement("span",null,"📅 ",L.fechaInicio.toDate().toLocaleDateString("es-ES")),t.createElement("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${L.prioridad==="urgente"?"bg-red-100 text-red-800":L.prioridad==="alta"?"bg-orange-100 text-orange-800":L.prioridad==="normal"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`},L.prioridad))),t.createElement("button",{onClick:()=>lc(L.id),className:"text-red-600 hover:text-red-800 p-1"},"🗑️")))),Rr(Me).length===0&&t.createElement("div",{className:"text-center py-8 text-gray-500"},t.createElement("p",null,"No hay eventos programados para este día."),t.createElement("button",{onClick:()=>Tt(!0),className:"mt-2 text-blue-600 hover:text-blue-800"},"Crear primer evento"))))),t.createElement("div",{className:"bg-white shadow rounded-lg"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h3",{className:"text-lg font-medium text-gray-900"},"🔔 Recordatorios Activos"),t.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Próximos recordatorios programados")),t.createElement("div",{className:"p-6"},Re.length>0?t.createElement("div",{className:"space-y-3"},Re.slice(0,5).map(L=>t.createElement("div",{key:L.id,className:"flex items-center justify-between p-3 border rounded-lg"},t.createElement("div",null,t.createElement("div",{className:"font-medium text-gray-900"},L.titulo),t.createElement("div",{className:"text-sm text-gray-600"},L.descripcion),t.createElement("div",{className:"text-xs text-gray-500 mt-1"},"📅 ",L.fechaRecordatorio.toDate().toLocaleDateString("es-ES")," a las ",L.fechaRecordatorio.toDate().toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}))),t.createElement("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full"},"⏰ Pendiente")))):t.createElement("div",{className:"text-center py-8 text-gray-500"},t.createElement("p",null,"No hay recordatorios activos."),t.createElement("p",{className:"text-sm mt-1"},"Los recordatorios se crean automáticamente al crear eventos.")))))))),I&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto"},t.createElement("div",{className:"flex items-center justify-between mb-6"},t.createElement("h3",{className:"text-2xl font-bold text-gray-900"},"📦 Solicitar Nuevo Producto"),t.createElement("button",{onClick:()=>{A(!1),go()},className:"text-gray-400 hover:text-gray-600 text-2xl"},"×")),t.createElement("form",{onSubmit:rf,className:"space-y-4"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombre del Producto *"),t.createElement("input",{type:"text",required:!0,value:y.nombre,onChange:L=>E({...y,nombre:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Freno de disco delantero"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Categoría *"),t.createElement("select",{required:!0,value:y.categoria,onChange:L=>E({...y,categoria:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:""},"Seleccionar categoría"),t.createElement("option",{value:"frenos"},"Frenos"),t.createElement("option",{value:"motor"},"Motor"),t.createElement("option",{value:"suspension"},"Suspensión"),t.createElement("option",{value:"electrico"},"Eléctrico"),t.createElement("option",{value:"transmision"},"Transmisión"),t.createElement("option",{value:"accesorios"},"Accesorios"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Marca *"),t.createElement("input",{type:"text",required:!0,value:y.marca,onChange:L=>E({...y,marca:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Toyota, Honda, etc."})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Precio (CLP) *"),t.createElement("input",{type:"number",required:!0,min:"0",value:y.precio,onChange:L=>E({...y,precio:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"50000"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Stock Disponible *"),t.createElement("input",{type:"number",required:!0,min:"0",value:y.stock,onChange:L=>E({...y,stock:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"10"}))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Descripción Detallada *"),t.createElement("textarea",{required:!0,rows:"4",value:y.descripcion,onChange:L=>E({...y,descripcion:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe las características, especificaciones técnicas, compatibilidad..."})),t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},t.createElement("p",{className:"text-sm text-blue-800"},t.createElement("strong",null,"📋 Proceso de Revisión:")," Tu solicitud será revisada por nuestro equipo de administradores o agentes asignados. Una vez aprobada, el producto será visible en el catálogo principal de la plataforma.")),t.createElement("div",{className:"flex justify-end space-x-3 pt-4"},t.createElement("button",{type:"button",onClick:()=>{A(!1),go()},className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors"},"Cancelar"),t.createElement("button",{type:"submit",disabled:k,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50"},k?"Enviando...":"Enviar Solicitud"))))),N&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto"},t.createElement("div",{className:"flex items-center justify-between mb-6"},t.createElement("h3",{className:"text-2xl font-bold text-gray-900"},"📢 Solicitar Nueva Campaña"),t.createElement("button",{onClick:()=>{x(!1),go()},className:"text-gray-400 hover:text-gray-600 text-2xl"},"×")),t.createElement("form",{onSubmit:sf,className:"space-y-4"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Título de la Campaña *"),t.createElement("input",{type:"text",required:!0,value:_.titulo,onChange:L=>P({..._,titulo:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Ofertas de Verano"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tipo de Campaña *"),t.createElement("select",{required:!0,value:_.tipo,onChange:L=>P({..._,tipo:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"promocional"},"Promocional"),t.createElement("option",{value:"estacional"},"Estacional"),t.createElement("option",{value:"liquidacion"},"Liquidación"),t.createElement("option",{value:"lanzamiento"},"Lanzamiento"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Fecha de Inicio *"),t.createElement("input",{type:"date",required:!0,value:_.fechaInicio,onChange:L=>P({..._,fechaInicio:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Fecha de Fin *"),t.createElement("input",{type:"date",required:!0,value:_.fechaFin,onChange:L=>P({..._,fechaFin:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Presupuesto (CLP) *"),t.createElement("input",{type:"number",required:!0,min:"0",value:_.presupuesto,onChange:L=>P({..._,presupuesto:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"100000"}))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Descripción de la Campaña *"),t.createElement("textarea",{required:!0,rows:"4",value:_.descripcion,onChange:L=>P({..._,descripcion:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe los objetivos, público objetivo, productos incluidos, descuentos..."})),t.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},t.createElement("p",{className:"text-sm text-green-800"},t.createElement("strong",null,"📋 Proceso de Revisión:")," Tu solicitud de campaña será revisada por nuestro equipo de administradores o agentes asignados. Una vez aprobada, la campaña será visible en la plataforma y podrás gestionarla desde este dashboard.")),t.createElement("div",{className:"flex justify-end space-x-3 pt-4"},t.createElement("button",{type:"button",onClick:()=>{x(!1),go()},className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors"},"Cancelar"),t.createElement("button",{type:"submit",disabled:k,className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:opacity-50"},k?"Enviando...":"Enviar Solicitud"))))),te&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto"},t.createElement("div",{className:"flex items-center justify-between mb-6"},t.createElement("h3",{className:"text-2xl font-bold text-gray-900"},"🔔 Notificaciones"),t.createElement("button",{onClick:()=>se(!1),className:"text-gray-400 hover:text-gray-600 text-2xl"},"×")),t.createElement("div",{className:"space-y-4"},U.length>0?U.map(L=>{var ee,ie,Oe;return t.createElement("div",{key:L.id,className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"flex items-start justify-between"},t.createElement("div",{className:"flex-1"},t.createElement("div",{className:"flex items-center space-x-3 mb-2"},t.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${L.tipo==="aprobacion"?"bg-green-100 text-green-800":L.tipo==="rechazo"?"bg-red-100 text-red-800":L.tipo==="comentario"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`},L.tipo==="aprobacion"?"✅ Aprobación":L.tipo==="rechazo"?"❌ Rechazo":L.tipo==="comentario"?"💬 Comentario":L.tipo),t.createElement("span",{className:"text-xs text-gray-500"},((Oe=(ie=(ee=L.fechaCreacion)==null?void 0:ee.toDate)==null?void 0:ie.call(ee))==null?void 0:Oe.toLocaleDateString())||"N/A")),t.createElement("h4",{className:"font-medium text-gray-900 mb-2"},L.titulo),t.createElement("p",{className:"text-sm text-gray-600"},L.mensaje),L.solicitudId&&t.createElement("p",{className:"text-xs text-gray-500 mt-2"},"📋 Solicitud: ",L.solicitudId)),t.createElement("button",{onClick:()=>wd(L.id),className:"ml-4 text-blue-600 hover:text-blue-800 text-sm px-3 py-1 border border-blue-300 rounded hover:bg-blue-50"},"✓ Marcar leída")))}):t.createElement("div",{className:"text-center py-8 text-gray-500"},t.createElement("p",null,"No hay notificaciones pendientes."),t.createElement("p",{className:"text-sm mt-1"},"Te notificaremos cuando haya actualizaciones en tus solicitudes."))))),X&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto"},t.createElement("div",{className:"flex items-center justify-between mb-6"},t.createElement("h3",{className:"text-2xl font-bold text-gray-900"},"💬 Chat con Agente"),t.createElement("button",{onClick:()=>ye(!1),className:"text-gray-400 hover:text-gray-600 text-2xl"},"×")),t.createElement("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg"},t.createElement("p",{className:"text-sm text-blue-800"},t.createElement("strong",null,"Agente Asignado:")," ",ge),t.createElement("p",{className:"text-xs text-blue-600 mt-1"},"Puedes hacer preguntas sobre tus solicitudes o solicitar aclaraciones.")),t.createElement("div",{className:"border rounded-lg p-4 h-64 overflow-y-auto mb-4 bg-gray-50"},Y.length>0?t.createElement("div",{className:"space-y-3"},Y.map((L,ee)=>{var ie;return t.createElement("div",{key:ee,className:`flex ${L.enviadoPor==="empresa"?"justify-end":"justify-start"}`},t.createElement("div",{className:`max-w-xs px-3 py-2 rounded-lg ${L.enviadoPor==="empresa"?"bg-blue-600 text-white":"bg-white text-gray-800 border"}`},t.createElement("p",{className:"text-sm"},L.mensaje),t.createElement("p",{className:"text-xs opacity-75 mt-1"},((ie=L.fechaEnvio)==null?void 0:ie.toLocaleTimeString())||"N/A")))})):t.createElement("div",{className:"text-center text-gray-500 py-8"},t.createElement("p",null,"No hay mensajes aún."),t.createElement("p",{className:"text-sm mt-1"},"Inicia la conversación con tu agente."))),t.createElement("form",{onSubmit:L=>{L.preventDefault(),_i()},className:"flex space-x-2"},t.createElement("input",{type:"text",value:de,onChange:L=>oe(L.target.value),placeholder:"Escribe tu mensaje...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.createElement("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"},"Enviar")))),Ye&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4"},t.createElement("div",{className:"flex items-center justify-between mb-6"},t.createElement("h3",{className:"text-xl font-bold text-gray-900"},"�� Exportar Reporte"),t.createElement("button",{onClick:()=>it(!1),className:"text-gray-400 hover:text-gray-600 text-2xl"},"×")),t.createElement("div",{className:"space-y-4"},t.createElement("p",{className:"text-gray-600"},"Selecciona el formato para exportar tu reporte:"),t.createElement("div",{className:"grid grid-cols-1 gap-3"},t.createElement("button",{onClick:()=>{_d("pdf"),it(!1)},className:"flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"},t.createElement("span",{className:"text-2xl mr-3"},"📄"),t.createElement("div",{className:"text-left"},t.createElement("div",{className:"font-medium text-gray-900"},"Exportar como PDF"),t.createElement("div",{className:"text-sm text-gray-500"},"Ideal para imprimir o compartir"))),t.createElement("button",{onClick:()=>{_d("excel"),it(!1)},className:"flex items-center justify-center px-4 py-3 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"},t.createElement("span",{className:"text-2xl mr-3"},"📊"),t.createElement("div",{className:"text-left"},t.createElement("div",{className:"font-medium text-gray-900"},"Exportar como Excel"),t.createElement("div",{className:"text-sm text-gray-500"},"Perfecto para análisis de datos")))),t.createElement("div",{className:"mt-6 pt-4 border-t border-gray-200"},t.createElement("button",{onClick:()=>it(!1),className:"w-full px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors"},"Cancelar"))))),ne&&t.createElement("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},t.createElement("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},t.createElement("form",{onSubmit:tf},t.createElement("div",{className:"mb-4"},t.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"🔑 Cambiar Contraseña"),t.createElement("p",{className:"text-sm text-gray-600"},"Ingresa tu contraseña actual y la nueva contraseña")),t.createElement("div",{className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña Actual *"),t.createElement("input",{type:"password",required:!0,value:We.currentPassword,onChange:L=>Rt({...We,currentPassword:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingresa tu contraseña actual"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nueva Contraseña *"),t.createElement("input",{type:"password",required:!0,value:We.newPassword,onChange:L=>Rt({...We,newPassword:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Mínimo 6 caracteres",minLength:"6"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirmar Nueva Contraseña *"),t.createElement("input",{type:"password",required:!0,value:We.confirmPassword,onChange:L=>Rt({...We,confirmPassword:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Confirma la nueva contraseña"}))),t.createElement("div",{className:"flex justify-end space-x-3 pt-6"},t.createElement("button",{type:"button",onClick:()=>{K(!1),Rt({currentPassword:"",newPassword:"",confirmPassword:""})},className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors"},"Cancelar"),t.createElement("button",{type:"submit",disabled:k,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50"},k?"Cambiando...":"Cambiar Contraseña"))))),Ge&&t.createElement("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},t.createElement("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},t.createElement("form",{onSubmit:cs},t.createElement("div",{className:"mb-4"},t.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"📧 Cambiar Email"),t.createElement("p",{className:"text-sm text-gray-600"},"Actualiza tu dirección de correo electrónico")),t.createElement("div",{className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email Actual"),t.createElement("input",{type:"email",readOnly:!0,value:lt.currentEmail,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-600"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nuevo Email *"),t.createElement("input",{type:"email",required:!0,value:lt.newEmail,onChange:L=>Dt({...lt,newEmail:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"nuevo@email.com"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirmar Nuevo Email *"),t.createElement("input",{type:"email",required:!0,value:lt.confirmEmail,onChange:L=>Dt({...lt,confirmEmail:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Confirma el nuevo email"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña Actual *"),t.createElement("input",{type:"password",required:!0,value:lt.password,onChange:L=>Dt({...lt,password:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Confirma tu contraseña"}))),t.createElement("div",{className:"flex justify-end space-x-3 pt-6"},t.createElement("button",{type:"button",onClick:()=>{Ke(!1),Dt({currentEmail:"",newEmail:"",confirmEmail:"",password:""})},className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors"},"Cancelar"),t.createElement("button",{type:"submit",disabled:k,className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:opacity-50"},k?"Cambiando...":"Cambiar Email"))))),Ze&&t.createElement("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},t.createElement("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},t.createElement("form",{onSubmit:af},t.createElement("div",{className:"mb-4"},t.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"🔒 Configurar Autenticación 2FA"),t.createElement("p",{className:"text-sm text-gray-600"},"Añade una capa extra de seguridad a tu cuenta")),t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"flex items-center space-x-2"},t.createElement("input",{type:"checkbox",id:"enable2FA",checked:ut.isEnabled,onChange:L=>ka({...ut,isEnabled:L.target.checked}),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),t.createElement("label",{htmlFor:"enable2FA",className:"text-sm font-medium text-gray-700"},"Habilitar Autenticación de Dos Factores")),ut.isEnabled&&t.createElement(t.Fragment,null,t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Método de Verificación"),t.createElement("select",{value:ut.method,onChange:L=>ka({...ut,method:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"},t.createElement("option",{value:"sms"},"📱 SMS al teléfono"),t.createElement("option",{value:"app"},"📲 App de autenticación"))),ut.method==="sms"&&t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Número de Teléfono *"),t.createElement("input",{type:"tel",required:ut.isEnabled&&ut.method==="sms",value:ut.phoneNumber,onChange:L=>ka({...ut,phoneNumber:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"+56 9 1234 5678"})),ut.method==="app"&&t.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3"},t.createElement("p",{className:"text-sm text-blue-800"},"📲 Usa apps como Google Authenticator, Authy o Microsoft Authenticator para generar códigos de verificación.")),ut.backupCodes.length>0&&t.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3"},t.createElement("h5",{className:"font-medium text-yellow-800 mb-2"},"🔑 Códigos de Respaldo"),t.createElement("div",{className:"grid grid-cols-2 gap-1 text-xs font-mono"},ut.backupCodes.map((L,ee)=>t.createElement("span",{key:ee,className:"bg-yellow-100 px-2 py-1 rounded"},L))),t.createElement("p",{className:"text-xs text-yellow-700 mt-2"},"Guarda estos códigos en un lugar seguro. Los necesitarás si pierdes acceso a tu método principal.")))),t.createElement("div",{className:"flex justify-end space-x-3 pt-6"},t.createElement("button",{type:"button",onClick:()=>{et(!1),ka({isEnabled:!1,method:"sms",phoneNumber:"",backupCodes:[]})},className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors"},"Cancelar"),t.createElement("button",{type:"submit",disabled:k,className:"px-6 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors disabled:opacity-50"},k?"Configurando...":"Guardar Configuración"))))),ea&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto"},t.createElement("div",{className:"flex items-center justify-between mb-6"},t.createElement("h3",{className:"text-2xl font-bold text-gray-900"},"📅 Crear Nuevo Evento"),t.createElement("button",{onClick:()=>Tt(!1),className:"text-gray-400 hover:text-gray-600 text-2xl"},"×")),t.createElement("form",{onSubmit:Cd,className:"space-y-4"},t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Título del Evento *"),t.createElement("input",{type:"text",required:!0,value:He.titulo,onChange:L=>$t({...He,titulo:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Reunión con proveedor"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tipo de Evento *"),t.createElement("select",{required:!0,value:He.tipo,onChange:L=>$t({...He,tipo:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"general"},"General"),t.createElement("option",{value:"reunion"},"Reunión"),t.createElement("option",{value:"cita"},"Cita"),t.createElement("option",{value:"evento"},"Evento"),t.createElement("option",{value:"recordatorio"},"Recordatorio"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Fecha de Inicio *"),t.createElement("input",{type:"datetime-local",required:!0,value:He.fechaInicio,onChange:L=>$t({...He,fechaInicio:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Fecha de Fin *"),t.createElement("input",{type:"datetime-local",required:!0,value:He.fechaFin,onChange:L=>$t({...He,fechaFin:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Prioridad"),t.createElement("select",{value:He.prioridad,onChange:L=>$t({...He,prioridad:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"baja"},"🟢 Baja"),t.createElement("option",{value:"normal"},"🟡 Normal"),t.createElement("option",{value:"alta"},"🟠 Alta"),t.createElement("option",{value:"urgente"},"🔴 Urgente"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Recordatorio"),t.createElement("select",{value:He.recordatorioAntes,onChange:L=>$t({...He,recordatorioAntes:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"15_minutos"},"15 minutos antes"),t.createElement("option",{value:"1_hora"},"1 hora antes"),t.createElement("option",{value:"1_dia"},"1 día antes"),t.createElement("option",{value:"3_dias"},"3 días antes"),t.createElement("option",{value:"1_semana"},"1 semana antes")))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Descripción del Evento"),t.createElement("textarea",{rows:"4",value:He.descripcion,onChange:L=>$t({...He,descripcion:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe los detalles del evento, participantes, ubicación..."})),t.createElement("div",{className:"flex items-center space-x-2"},t.createElement("input",{type:"checkbox",id:"recordatorio",checked:He.recordatorio,onChange:L=>$t({...He,recordatorio:L.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),t.createElement("label",{htmlFor:"recordatorio",className:"text-sm text-gray-700"},"Crear recordatorio automático")),t.createElement("div",{className:"flex justify-end space-x-3 pt-4"},t.createElement("button",{type:"button",onClick:()=>Tt(!1),className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors"},"Cancelar"),t.createElement("button",{type:"submit",disabled:k,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50"},k?"Creando...":"Crear Evento"))))),Ue&&t.createElement("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},t.createElement("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},t.createElement("div",{className:"mb-4"},t.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"🔑 Asignar Credenciales de Acceso"),t.createElement("p",{className:"text-sm text-gray-600"},"Configura las credenciales para que el proveedor pueda acceder al sistema")),t.createElement("form",{onSubmit:ef},t.createElement("div",{className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email de Acceso *"),t.createElement("input",{type:"email",required:!0,value:ta.email,onChange:L=>Un({...ta,email:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"proveedor@empresa.com"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña Provisoria *"),t.createElement("input",{type:"password",required:!0,value:ta.password,onChange:L=>Un({...ta,password:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Mínimo 6 caracteres"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirmar Contraseña *"),t.createElement("input",{type:"password",required:!0,value:ta.confirmPassword,onChange:L=>Un({...ta,confirmPassword:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Repite la contraseña"})),t.createElement("div",{className:"flex items-center space-x-2"},t.createElement("input",{type:"checkbox",id:"isProvisional",checked:ta.isProvisional,onChange:L=>Un({...ta,isProvisional:L.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),t.createElement("label",{htmlFor:"isProvisional",className:"text-sm text-gray-700"},"Marcar como credenciales provisorias")),t.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3"},t.createElement("p",{className:"text-sm text-yellow-800"},t.createElement("strong",null,"⚠️ Importante:")," Las credenciales provisorias deben ser cambiadas por el proveedor en su primer acceso por seguridad."))),t.createElement("div",{className:"flex justify-end space-x-3 pt-4"},t.createElement("button",{type:"button",onClick:()=>Je(!1),className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors"},"Cancelar"),t.createElement("button",{type:"submit",className:"px-6 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 transition-colors"},"🔑 Asignar Credenciales")))))):t.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},t.createElement("div",{className:"text-center text-red-500"},t.createElement("h1",{className:"text-2xl font-bold mb-4"},"Empresa no encontrada"),t.createElement("p",null,"No se pudo cargar la información de la empresa."),t.createElement("div",{className:"mt-4 text-sm text-gray-600"},t.createElement("p",null,"🔍 ID de empresa: ",r||"No proporcionado"))))}function Q_(){const{clienteId:a}=Ni(),{user:e}=ht(),n=Ct(),r=a||(e==null?void 0:e.uid);console.log("DashboardClienteInterno - Debug:",{clienteId:a,userUid:e==null?void 0:e.uid,idCliente:r,user:e});const[s,o]=p.useState(null),[i,l]=p.useState([]),[c,u]=p.useState([]),[d,m]=p.useState([]),[h,C]=p.useState([]),[S,w]=p.useState([]),[f,b]=p.useState([]),[v,I]=p.useState(!0),[A,N]=p.useState(null),[x,y]=p.useState(!1),[E,_]=p.useState(!1),[P,k]=p.useState(!1),[D,M]=p.useState(!1),[$,q]=p.useState(!1),[V,z]=p.useState({marca:"",modelo:"",año:"",patente:"",kilometraje:"",tipo:"auto",color:"",combustible:"gasolina"}),[j,U]=p.useState({fecha:"",hora:"",servicio:"",descripcion:"",empresaId:"",empresaNombre:""});p.useEffect(()=>{if(console.log("🔍 useEffect - Debug completo:",{idCliente:r,userUid:e==null?void 0:e.uid,userEmail:e==null?void 0:e.email,user:e,loading:v,error:A}),r&&e){console.log("✅ Usuario autenticado, iniciando carga de datos...");const G=setTimeout(()=>{v&&(console.log("⏰ Timeout alcanzado, forzando carga del dashboard"),I(!1))},1e4);return(async()=>{try{console.log("🚀 Iniciando carga de datos..."),await Promise.all([Q(),te(),se(),X(),ye(),Y()]),i.length>0&&await Se(),console.log("✅ Todos los datos cargados exitosamente")}catch(Te){console.error("❌ Error cargando datos:",Te),N(Te.message)}finally{console.log("🏁 Finalizando carga de datos"),I(!1),clearTimeout(G)}})(),()=>clearTimeout(G)}else e?(console.log("⚠️ Estado intermedio, no hay usuario ni idCliente"),I(!1)):(console.log("❌ Usuario no autenticado, redirigiendo a login..."),n("/login"))},[r,e,n,v,A]),p.useEffect(()=>{e?(console.log("Usuario autenticado:",e.email,"UID:",e.uid),y(!0)):(console.log("No hay usuario autenticado"),y(!0))},[e]),p.useEffect(()=>{i.length>0?Se():b([])},[i]);const Q=async()=>{try{console.log("🔍 fetchCliente - Iniciando búsqueda..."),console.log("📋 Parámetros de búsqueda:",{idCliente:r,userEmail:e==null?void 0:e.email,userUid:e==null?void 0:e.uid}),console.log("🔎 Buscando en colección usuarios con ID:",r);let G=await en(Ne(F,"usuarios",r));if(G.exists()){const we=G.data();if(console.log("✅ Cliente encontrado en usuarios:",we),we.perfilClienteId){const B=await en(Ne(F,"perfiles_clientes",we.perfilClienteId));if(B.exists()){const ve=B.data(),je={id:r,nombre:we.nombre||`${ve.nombres||""} ${ve.apellidos||""}`.trim(),email:we.email,telefono:ve.telefono||"No especificado",direccion:ve.direccion||"No especificada",rol:we.rol,activo:we.activo,fechaCreacion:we.fechaCreacion,perfilClienteId:we.perfilClienteId,...ve};console.log("Cliente completo cargado:",je),o(je);return}}const Te={id:r,nombre:we.nombre||"Cliente",email:we.email,telefono:"No especificado",direccion:"No especificada",rol:we.rol,activo:we.activo,fechaCreacion:we.fechaCreacion,perfilClienteId:we.perfilClienteId};console.log("Cliente básico cargado:",Te),o(Te)}else{console.log("❌ Cliente no encontrado en usuarios, buscando en perfiles_clientes...");const we=fe(W(F,"perfiles_clientes"),pe("email","==",e==null?void 0:e.email),Ot(1)),Te=await le(we);if(Te.empty)throw console.log("No se encontró cliente en ninguna colección"),new Error("Cliente no encontrado en el sistema");{const B=Te.docs[0];console.log("Cliente encontrado en perfiles_clientes:",B.data());const ve={id:B.id,nombre:`${B.data().nombres||""} ${B.data().apellidos||""}`.trim(),email:B.data().email,telefono:B.data().telefono||"No especificado",direccion:B.data().direccion||"No especificada",rol:"cliente"};o(ve)}}}catch(G){throw console.error("Error al cargar datos del cliente:",G),G}},te=async()=>{try{const G=fe(W(F,"vehiculos"),pe("clienteId","==",r),st("fechaCreacion","desc")),Te=(await le(G)).docs.map(B=>({id:B.id,...B.data()}));l(Te)}catch(G){console.error("Error al cargar vehículos:",G)}},se=async()=>{try{const G=fe(W(F,"citas"),pe("clienteId","==",r),st("fecha","desc"),Ot(10)),Te=(await le(G)).docs.map(B=>({id:B.id,...B.data()}));u(Te)}catch(G){console.error("Error al cargar citas:",G)}},X=async()=>{try{const G=fe(W(F,"historial_servicios"),pe("clienteId","==",r),st("fecha","desc"),Ot(20)),Te=(await le(G)).docs.map(B=>({id:B.id,...B.data()}));m(Te)}catch(G){console.error("Error al cargar historial:",G)}},ye=async()=>{try{const G=fe(W(F,"notificaciones"),pe("clienteId","==",r),pe("leida","==",!1),st("fecha","desc"),Ot(20)),Te=(await le(G)).docs.map(B=>({id:B.id,...B.data()}));C(Te)}catch(G){console.error("Error al cargar notificaciones:",G)}},Y=async()=>{try{w([{id:1,titulo:"Mantenimiento Preventivo",descripcion:"Recuerda cambiar el aceite cada 5,000 km para mantener tu motor en óptimas condiciones.",categoria:"mantenimiento",prioridad:"alta"},{id:2,titulo:"Revisión de Neumáticos",descripcion:"Verifica la presión de tus neumáticos mensualmente para mayor seguridad.",categoria:"seguridad",prioridad:"media"},{id:3,titulo:"Limpieza del Filtro de Aire",descripcion:"Un filtro de aire limpio mejora el rendimiento y consumo de combustible.",categoria:"rendimiento",prioridad:"baja"}])}catch(G){console.error("Error al cargar consejos:",G)}},Se=async()=>{try{if(i.length===0){b([]);return}const G=[...new Set(i.map(_e=>_e.marca.toLowerCase()))],we=fe(W(F,"empresas"),pe("estado_validacion","==","activo"),pe("visible_en_busqueda","==",!0)),je=(await le(we)).docs.map(_e=>({id:_e.id,..._e.data()})).filter(_e=>{const H=_e.marcas_atendidas&&_e.marcas_atendidas.some(Ye=>G.includes(Ye.toLowerCase())),Pe=_e.categorias&&_e.categorias.length>0;return H&&Pe}).sort((_e,H)=>{var it,mt;const Pe=((it=_e.marcas_atendidas)==null?void 0:it.filter(be=>G.includes(be.toLowerCase())).length)||0;return(((mt=H.marcas_atendidas)==null?void 0:mt.filter(be=>G.includes(be.toLowerCase())).length)||0)-Pe});b(je.slice(0,6))}catch(G){console.error("Error al cargar empresas recomendadas:",G),b([])}},de=async G=>{G.preventDefault();try{const we={...V,clienteId:r,fechaCreacion:new Date,estado:"activo"};await ot(W(F,"vehiculos"),we),z({marca:"",modelo:"",año:"",patente:"",kilometraje:"",tipo:"auto",color:"",combustible:"gasolina"}),_(!1),await te(),i.length+1>0&&await Se()}catch(we){console.error("Error al crear vehículo:",we)}},oe=async G=>{G.preventDefault();try{const we={...j,clienteId:r,fechaCreacion:new Date,estado:"pendiente"};await ot(W(F,"citas"),we),U({fecha:"",hora:"",servicio:"",descripcion:"",empresaId:"",empresaNombre:""}),k(!1),se()}catch(we){console.error("Error al crear cita:",we)}},ge=async G=>{try{await ze(Ne(F,"notificaciones",G),{leida:!0,fechaLectura:new Date}),ye()}catch(we){console.error("Error al marcar notificación:",we)}},me=async G=>{if(window.confirm("¿Estás seguro de que quieres eliminar este vehículo?"))try{await on(Ne(F,"vehiculos",G)),te()}catch(we){console.error("Error al eliminar vehículo:",we)}};if(!x)return t.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),t.createElement("p",{className:"mt-4 text-lg text-gray-600"},"Verificando autenticación...")));if(!e)return t.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-red-600 text-6xl mb-4"},"🔒"),t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Acceso Restringido"),t.createElement("p",{className:"text-gray-600 mb-4"},"Debes iniciar sesión para acceder al dashboard"),t.createElement("button",{onClick:()=>n("/login"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700"},"Ir al Login")));const{rol:he}=ht();return he?he!=="cliente"?t.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-red-600 text-6xl mb-4"},"🚫"),t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Acceso Denegado"),t.createElement("p",{className:"text-gray-600 mb-4"},"Esta área es solo para clientes. Tu rol actual es: ",he),t.createElement("button",{onClick:()=>n("/"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700"},"Volver al Inicio"))):v?t.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),t.createElement("p",{className:"mt-4 text-lg text-gray-600"},"Cargando dashboard del cliente..."),t.createElement("p",{className:"text-sm text-gray-500 mt-2"},"Usuario: ",e.email))):A?t.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-red-600 text-6xl mb-4"},"⚠️"),t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Error"),t.createElement("p",{className:"text-gray-600 mb-4"},A),t.createElement("button",{onClick:()=>n("/"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700"},"Volver al inicio"))):t.createElement("div",{className:"min-h-screen bg-gray-50"},t.createElement("div",{className:"bg-white shadow-sm border-b"},t.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},t.createElement("div",{className:"flex justify-between items-center py-4"},t.createElement("div",null,t.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Dashboard del Cliente"),t.createElement("p",{className:"text-gray-600"},"Bienvenido, ",(s==null?void 0:s.nombre)||"Cliente")),t.createElement("div",{className:"flex space-x-3"},t.createElement("button",{onClick:()=>M(!0),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700"},"Mi Perfil"),t.createElement("button",{onClick:()=>n("/"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700"},"Volver al Sitio"))))),t.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},t.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},t.createElement("div",{className:"lg:col-span-1 space-y-6"},t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Mi Información"),t.createElement("div",{className:"space-y-3"},t.createElement("div",null,t.createElement("span",{className:"text-sm font-medium text-gray-500"},"Nombre:"),t.createElement("p",{className:"text-gray-900"},s==null?void 0:s.nombre)),t.createElement("div",null,t.createElement("span",{className:"text-sm font-medium text-gray-500"},"Email:"),t.createElement("p",{className:"text-gray-900"},s==null?void 0:s.email)),t.createElement("div",null,t.createElement("span",{className:"text-sm font-medium text-gray-500"},"Teléfono:"),t.createElement("p",{className:"text-gray-900"},(s==null?void 0:s.telefono)||"No especificado")),t.createElement("div",null,t.createElement("span",{className:"text-sm font-medium text-gray-500"},"Vehículos:"),t.createElement("p",{className:"text-gray-900"},i.length)))),t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"💡 Consejos del Día"),t.createElement("div",{className:"space-y-4"},S.slice(0,3).map(G=>t.createElement("div",{key:G.id,className:"border-l-4 border-blue-500 pl-4"},t.createElement("h4",{className:"font-medium text-gray-900 text-sm"},G.titulo),t.createElement("p",{className:"text-gray-600 text-xs mt-1"},G.descripcion),t.createElement("span",{className:`inline-block px-2 py-1 text-xs rounded-full mt-2 ${G.prioridad==="alta"?"bg-red-100 text-red-800":G.prioridad==="media"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`},G.prioridad))))),t.createElement("div",{className:"bg-white rounded-lg shadow p-6"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Acciones Rápidas"),t.createElement("div",{className:"space-y-3"},t.createElement("button",{onClick:()=>_(!0),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors"},"+ Agregar Vehículo"),t.createElement("button",{onClick:()=>k(!0),className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors"},"+ Agendar Cita"),t.createElement("button",{onClick:()=>n("/empresas"),className:"w-full bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors"},"Buscar Talleres")))),t.createElement("div",{className:"lg:col-span-2 space-y-6"},t.createElement("div",{className:"bg-white rounded-lg shadow"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("div",{className:"flex justify-between items-center"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Mis Vehículos"),t.createElement("button",{onClick:()=>_(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700"},"+ Agregar"))),t.createElement("div",{className:"p-6"},i.length===0?t.createElement("div",{className:"text-center py-8"},t.createElement("div",{className:"text-gray-400 text-6xl mb-4"},"🚗"),t.createElement("p",{className:"text-gray-600 mb-4"},"No tienes vehículos registrados"),t.createElement("button",{onClick:()=>_(!0),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700"},"Registrar mi primer vehículo")):t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},i.map(G=>t.createElement("div",{key:G.id,className:"border border-gray-200 rounded-lg p-4"},t.createElement("div",{className:"flex justify-between items-start mb-3"},t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900"},G.marca," ",G.modelo),t.createElement("p",{className:"text-sm text-gray-600"},G.año," • ",G.patente)),t.createElement("button",{onClick:()=>me(G.id),className:"text-red-600 hover:text-red-800"},"🗑️")),t.createElement("div",{className:"space-y-2 text-sm"},t.createElement("div",null,t.createElement("span",{className:"text-gray-500"},"Color:")," ",G.color),t.createElement("div",null,t.createElement("span",{className:"text-gray-500"},"Combustible:")," ",G.combustible),t.createElement("div",null,t.createElement("span",{className:"text-gray-500"},"Kilometraje:")," ",G.kilometraje," km"))))))),t.createElement("div",{className:"bg-white rounded-lg shadow"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("div",{className:"flex justify-between items-center"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Próximas Citas"),t.createElement("button",{onClick:()=>k(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700"},"+ Agendar"))),t.createElement("div",{className:"p-6"},c.length===0?t.createElement("div",{className:"text-center py-8"},t.createElement("div",{className:"text-gray-400 text-6xl mb-4"},"📅"),t.createElement("p",{className:"text-gray-600 mb-4"},"No tienes citas programadas"),t.createElement("button",{onClick:()=>k(!0),className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700"},"Agendar mi primera cita")):t.createElement("div",{className:"space-y-4"},c.map(G=>t.createElement("div",{key:G.id,className:"border border-gray-200 rounded-lg p-4"},t.createElement("div",{className:"flex justify-between items-start"},t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900"},G.servicio),t.createElement("p",{className:"text-sm text-gray-600"},G.descripcion),t.createElement("p",{className:"text-sm text-gray-500"},new Date(G.fecha).toLocaleDateString()," a las ",G.hora),G.empresaNombre&&t.createElement("p",{className:"text-sm text-blue-600"},G.empresaNombre)),t.createElement("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${G.estado==="confirmada"?"bg-green-100 text-green-800":G.estado==="pendiente"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`},G.estado))))))),i.length>0&&t.createElement("div",{className:"bg-white rounded-lg shadow"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"🏢 Talleres Recomendados"),t.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Empresas que atienden tus marcas de vehículos")),t.createElement("div",{className:"p-6"},f.length===0?t.createElement("div",{className:"text-center py-8"},t.createElement("div",{className:"text-gray-400 text-6xl mb-4"},"🔍"),t.createElement("p",{className:"text-gray-600 mb-4"},"No encontramos talleres que atiendan tus marcas"),t.createElement("button",{onClick:()=>n("/empresas"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700"},"Ver todos los talleres")):t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},f.map(G=>{var Te;const we=((Te=G.marcas_atendidas)==null?void 0:Te.filter(B=>i.some(ve=>ve.marca.toLowerCase()===B.toLowerCase())))||[];return t.createElement("div",{key:G.id,className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow"},t.createElement("div",{className:"flex justify-between items-start mb-3"},t.createElement("div",{className:"flex-1"},t.createElement("h4",{className:"font-semibold text-gray-900 text-lg"},G.nombre),t.createElement("p",{className:"text-sm text-gray-600"},G.direccion),G.telefono&&t.createElement("p",{className:"text-sm text-blue-600"},"📞 ",G.telefono)),t.createElement("div",{className:"text-right"},t.createElement("span",{className:"inline-block px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full"},"✓ Recomendado"))),we.length>0&&t.createElement("div",{className:"mb-3"},t.createElement("p",{className:"text-xs font-medium text-gray-500 mb-1"},"Marcas que atiende:"),t.createElement("div",{className:"flex flex-wrap gap-1"},we.map((B,ve)=>t.createElement("span",{key:ve,className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full"},B)))),G.categorias&&G.categorias.length>0&&t.createElement("div",{className:"mb-3"},t.createElement("p",{className:"text-xs font-medium text-gray-500 mb-1"},"Servicios:"),t.createElement("div",{className:"flex flex-wrap gap-1"},G.categorias.slice(0,3).map((B,ve)=>t.createElement("span",{key:ve,className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full"},B)),G.categorias.length>3&&t.createElement("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full"},"+",G.categorias.length-3))),t.createElement("div",{className:"flex space-x-2 pt-3 border-t border-gray-100"},t.createElement("button",{onClick:()=>{U({...j,empresaId:G.id,empresaNombre:G.nombre}),k(!0)},className:"flex-1 bg-green-600 text-white py-2 px-3 rounded text-sm hover:bg-green-700 transition-colors"},"📅 Agendar Cita"),t.createElement("button",{onClick:()=>n(`/empresa/${G.id}`),className:"flex-1 bg-blue-600 text-white py-2 px-3 rounded text-sm hover:bg-blue-700 transition-colors"},"👁️ Ver Perfil")))})),f.length>0&&t.createElement("div",{className:"mt-6 text-center"},t.createElement("button",{onClick:()=>n("/empresas"),className:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors"},"Ver más talleres")))),t.createElement("div",{className:"bg-white rounded-lg shadow"},t.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Historial de Servicios")),t.createElement("div",{className:"p-6"},d.length===0?t.createElement("div",{className:"text-center py-8"},t.createElement("div",{className:"text-gray-400 text-6xl mb-4"},"🔧"),t.createElement("p",{className:"text-gray-600"},"Aún no tienes servicios registrados")):t.createElement("div",{className:"space-y-4"},d.slice(0,5).map(G=>t.createElement("div",{key:G.id,className:"border border-gray-200 rounded-lg p-4"},t.createElement("div",{className:"flex justify-between items-start"},t.createElement("div",null,t.createElement("h4",{className:"font-semibold text-gray-900"},G.servicio),t.createElement("p",{className:"text-sm text-gray-600"},G.descripcion),t.createElement("p",{className:"text-sm text-gray-500"},new Date(G.fecha).toLocaleDateString()),G.empresaNombre&&t.createElement("p",{className:"text-sm text-blue-600"},G.empresaNombre)),t.createElement("div",{className:"text-right"},t.createElement("p",{className:"font-semibold text-gray-900"},"$",G.costo||"N/A"),t.createElement("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${G.estado==="completado"?"bg-green-100 text-green-800":G.estado==="en_proceso"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`},G.estado))))))))))),E&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Agregar Vehículo"),t.createElement("form",{onSubmit:de,className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Marca"),t.createElement("input",{type:"text",value:V.marca,onChange:G=>z({...V,marca:G.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Modelo"),t.createElement("input",{type:"text",value:V.modelo,onChange:G=>z({...V,modelo:G.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",{className:"grid grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Año"),t.createElement("input",{type:"number",value:V.año,onChange:G=>z({...V,año:G.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1900",max:new Date().getFullYear()+1,required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Patente"),t.createElement("input",{type:"text",value:V.patente,onChange:G=>z({...V,patente:G.target.value.toUpperCase()}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}))),t.createElement("div",{className:"grid grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Kilometraje"),t.createElement("input",{type:"number",value:V.kilometraje,onChange:G=>z({...V,kilometraje:G.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Tipo"),t.createElement("select",{value:V.tipo,onChange:G=>z({...V,tipo:G.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"auto"},"Auto"),t.createElement("option",{value:"camioneta"},"Camioneta"),t.createElement("option",{value:"moto"},"Moto"),t.createElement("option",{value:"camion"},"Camión")))),t.createElement("div",{className:"grid grid-cols-2 gap-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Color"),t.createElement("input",{type:"text",value:V.color,onChange:G=>z({...V,color:G.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Combustible"),t.createElement("select",{value:V.combustible,onChange:G=>z({...V,combustible:G.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},t.createElement("option",{value:"gasolina"},"Gasolina"),t.createElement("option",{value:"diesel"},"Diesel"),t.createElement("option",{value:"electrico"},"Eléctrico"),t.createElement("option",{value:"hibrido"},"Híbrido")))),t.createElement("div",{className:"flex space-x-3 pt-4"},t.createElement("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700"},"Guardar Vehículo"),t.createElement("button",{type:"button",onClick:()=>_(!1),className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400"},"Cancelar"))))),P&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Agendar Cita"),t.createElement("form",{onSubmit:oe,className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Fecha"),t.createElement("input",{type:"date",value:j.fecha,onChange:G=>U({...j,fecha:G.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",min:new Date().toISOString().split("T")[0],required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Hora"),t.createElement("input",{type:"time",value:j.hora,onChange:G=>U({...j,hora:G.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Servicio"),t.createElement("select",{value:j.servicio,onChange:G=>U({...j,servicio:G.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0},t.createElement("option",{value:""},"Seleccionar servicio"),t.createElement("option",{value:"mantenimiento"},"Mantenimiento"),t.createElement("option",{value:"reparacion"},"Reparación"),t.createElement("option",{value:"diagnostico"},"Diagnóstico"),t.createElement("option",{value:"cambio_aceite"},"Cambio de Aceite"),t.createElement("option",{value:"alineacion"},"Alineación"),t.createElement("option",{value:"frenos"},"Sistema de Frenos"),t.createElement("option",{value:"electrico"},"Sistema Eléctrico"))),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Descripción"),t.createElement("textarea",{value:j.descripcion,onChange:G=>U({...j,descripcion:G.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",placeholder:"Describe el problema o servicio que necesitas..."})),t.createElement("div",{className:"flex space-x-3 pt-4"},t.createElement("button",{type:"submit",className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700"},"Agendar Cita"),t.createElement("button",{type:"button",onClick:()=>k(!1),className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400"},"Cancelar"))))),D&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Mi Perfil"),t.createElement("div",{className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Nombre Completo"),t.createElement("input",{type:"text",defaultValue:s==null?void 0:s.nombre,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Email"),t.createElement("input",{type:"email",defaultValue:s==null?void 0:s.email,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Teléfono"),t.createElement("input",{type:"tel",defaultValue:s==null?void 0:s.telefono,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Dirección"),t.createElement("textarea",{defaultValue:s==null?void 0:s.direccion,className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3"})),t.createElement("div",{className:"flex space-x-3 pt-4"},t.createElement("button",{onClick:()=>M(!1),className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700"},"Guardar Cambios"),t.createElement("button",{onClick:()=>M(!1),className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400"},"Cancelar"))))),h.length>0&&t.createElement("div",{className:"fixed bottom-4 right-4 z-50"},t.createElement("button",{onClick:()=>q(!0),className:"bg-red-600 text-white p-3 rounded-full shadow-lg hover:bg-red-700 transition-colors"},"🔔 ",h.length)),$&&t.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},t.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4 max-h-96 overflow-y-auto"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Notificaciones"),t.createElement("div",{className:"space-y-3"},h.map(G=>t.createElement("div",{key:G.id,className:"border border-gray-200 rounded-lg p-3"},t.createElement("div",{className:"flex justify-between items-start"},t.createElement("div",null,t.createElement("h4",{className:"font-medium text-gray-900"},G.titulo),t.createElement("p",{className:"text-sm text-gray-600"},G.mensaje),t.createElement("p",{className:"text-xs text-gray-500"},new Date(G.fecha).toLocaleDateString())),t.createElement("button",{onClick:()=>ge(G.id),className:"text-blue-600 hover:text-blue-800 text-sm"},"Marcar leída"))))),t.createElement("button",{onClick:()=>q(!1),className:"w-full mt-4 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400"},"Cerrar")))):t.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"text-yellow-600 text-6xl mb-4"},"⚠️"),t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Rol No Asignado"),t.createElement("p",{className:"text-gray-600 mb-4"},"Tu cuenta no tiene un rol asignado. Contacta al administrador."),t.createElement("div",{className:"space-y-3"},t.createElement("button",{onClick:()=>n("/login"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 mr-3"},"Volver al Login"),t.createElement("button",{onClick:()=>n("/"),className:"bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700"},"Ir al Inicio"))))}function j$(){const{user:a}=ht(),[e,n]=p.useState(null),[r,s]=p.useState({}),[o,i]=p.useState(""),[l,c]=p.useState([]),[u,d]=p.useState([]);p.useEffect(()=>{async function w(){const b=(await en(Ne(F,"usuarios",a.uid))).data().empresaId,v=await en(Ne(F,"empresas",b));n({id:v.id,...v.data()}),s(v.data());const I=await le(W(F,"categorias"));c(I.docs.map(N=>N.data().nombre));const A=await le(W(F,"marcas"));d(A.docs.map(N=>N.data().nombre))}w()},[a]);function m(w){s(f=>({...f,[w.target.name]:w.target.value}))}function h(w){s(f=>({...f,categorias:Array.isArray(f.categorias)?f.categorias.includes(w)?f.categorias.filter(b=>b!==w):[...f.categorias,w]:[w]}))}function C(w){s(f=>({...f,marcas:Array.isArray(f.marcas)?f.marcas.includes(w)?f.marcas.filter(b=>b!==w):[...f.marcas,w]:[w]}))}async function S(w){w.preventDefault(),await ze(Ne(F,"empresas",e.id),{...r,categorias:typeof r.categorias=="string"?r.categorias.split(",").map(f=>f.trim()).filter(Boolean):r.categorias||[],marcas:typeof r.marcas=="string"?r.marcas.split(",").map(f=>f.trim()).filter(Boolean):r.marcas||[]}),n({...e,...r}),i("Datos actualizados con éxito"),setTimeout(()=>i(""),3e3)}return e?t.createElement("div",{className:"p-6 max-w-xl mx-auto"},t.createElement("h2",{className:"text-xl font-bold mb-4"},"Editar Información Proveedor"),o&&t.createElement("div",{className:"text-green-600 mb-2"},o),t.createElement("form",{onSubmit:S,className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block font-semibold mb-1"},"Nombre"),t.createElement("input",{name:"nombre",value:r.nombre||"",onChange:m,className:"w-full border p-2 rounded"})),t.createElement("div",null,t.createElement("label",{className:"block font-semibold mb-1"},"Dirección"),t.createElement("input",{name:"direccion",value:r.direccion||"",onChange:m,className:"w-full border p-2 rounded"})),t.createElement("div",null,t.createElement("label",{className:"block font-semibold mb-1"},"Web"),t.createElement("input",{name:"web",value:r.web||"",onChange:m,className:"w-full border p-2 rounded"})),t.createElement("div",null,t.createElement("label",{className:"block font-semibold mb-1"},"Teléfono"),t.createElement("input",{name:"telefono",value:r.telefono||"",onChange:m,className:"w-full border p-2 rounded"})),t.createElement("div",null,t.createElement("label",{className:"block font-semibold mb-1"},"Email"),t.createElement("input",{name:"email",value:r.email||"",onChange:m,className:"w-full border p-2 rounded"})),t.createElement("div",null,t.createElement("label",{className:"block font-semibold mb-1"},"Categorías"),t.createElement("div",{className:"flex flex-wrap gap-2"},l.map((w,f)=>t.createElement("button",{type:"button",key:f,onClick:()=>h(w),className:`px-3 py-1 rounded-full border text-sm
                  ${Array.isArray(r.categorias)&&r.categorias.includes(w)?"bg-green-600 text-white":"bg-green-100 text-green-800"}
                `},w)))),t.createElement("div",null,t.createElement("label",{className:"block font-semibold mb-1"},"Marcas"),t.createElement("div",{className:"flex flex-wrap gap-2"},u.map((w,f)=>t.createElement("button",{type:"button",key:f,onClick:()=>C(w),className:`px-3 py-1 rounded-full border text-sm
                  ${Array.isArray(r.marcas)&&r.marcas.includes(w)?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700"}
                `},w)))),t.createElement("div",{className:"flex gap-2 mt-4"},t.createElement("button",{type:"submit",className:"bg-green-600 text-white px-4 py-2 rounded"},"Guardar"),t.createElement("button",{type:"button",onClick:()=>window.history.back(),className:"bg-gray-400 text-white px-4 py-2 rounded"},"Cancelar")))):t.createElement("div",null,"Cargando...")}function F$(){var y,E;const{user:a}=ht(),[e,n]=p.useState(""),[r,s]=p.useState(""),[o,i]=p.useState(""),[l,c]=p.useState(""),[u,d]=p.useState(""),[m,h]=p.useState(""),[C,S]=p.useState(!1),[w,f]=p.useState(""),[b,v]=p.useState(""),[I,A]=p.useState(null),N=Ct();p.useEffect(()=>{async function _(){if(a){const P=fe(W(F,"empresas"),pe("email","==",a.email)),k=await le(P);k.empty||(v(k.docs[0].id),A(k.docs[0].data()))}}_()},[a]);async function x(_){if(_.preventDefault(),S(!0),f(""),!e||!r||!o||!l||!b||!I){f("Debes completar todos los campos principales, incluyendo empresa."),S(!1);return}if(!a){f("No hay usuario autenticado."),S(!1);return}try{await ot(W(F,"campanas"),{titulo:e,descripcion:r,fechaInicio:Kt.fromDate(new Date(o)),fechaFin:Kt.fromDate(new Date(l)),proveedorId:a.uid,idEmpresa:b,categorias:I.categorias||[],marcas:I.marcas||[],imagenURL:u,link:m,estado:"Enviada",fecha_creacion:sa()}),N("/proveedores")}catch{f("Error al guardar la campaña. Intenta nuevamente.")}finally{S(!1)}}return t.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-100 via-white to-green-100 py-10"},t.createElement("form",{onSubmit:x,className:"bg-white p-8 rounded shadow max-w-md w-full"},t.createElement("h2",{className:"text-2xl font-bold text-blue-900 mb-6 text-center"},"Solicitud de Nueva Campaña"),w&&t.createElement("div",{className:"mb-4 text-red-600"},w),t.createElement("label",{className:"block mb-2 font-semibold"},"Título de la campaña"),t.createElement("input",{className:"mb-4 w-full border p-2 rounded",value:e,onChange:_=>n(_.target.value),required:!0}),t.createElement("label",{className:"block mb-2 font-semibold"},"Descripción"),t.createElement("textarea",{className:"mb-4 w-full border p-2 rounded",value:r,onChange:_=>s(_.target.value),required:!0}),t.createElement("label",{className:"block mb-2 font-semibold"},"Fecha de inicio"),t.createElement("input",{type:"datetime-local",className:"mb-4 w-full border p-2 rounded",value:o,onChange:_=>i(_.target.value),required:!0}),t.createElement("label",{className:"block mb-2 font-semibold"},"Fecha de término"),t.createElement("input",{type:"datetime-local",className:"mb-4 w-full border p-2 rounded",value:l,onChange:_=>c(_.target.value),required:!0}),t.createElement("label",{className:"block mb-2 font-semibold"},"Imagen (URL)"),t.createElement("input",{className:"mb-4 w-full border p-2 rounded",value:u,onChange:_=>d(_.target.value),placeholder:"https://..."}),t.createElement("label",{className:"block mb-2 font-semibold"},"Link (opcional)"),t.createElement("input",{className:"mb-4 w-full border p-2 rounded",value:m,onChange:_=>h(_.target.value),placeholder:"https://..."}),t.createElement("div",{className:"mb-4"},t.createElement("label",{className:"font-semibold block mb-1"},"Categorías asociadas a tu empresa:"),(y=I==null?void 0:I.categorias)!=null&&y.length?t.createElement("div",{className:"flex flex-wrap gap-2"},I.categorias.map(_=>t.createElement("span",{key:_,className:"bg-gray-100 px-2 py-1 rounded text-sm"},_))):t.createElement("div",{className:"text-gray-500 text-sm"},"Sin categorías")),t.createElement("div",{className:"mb-4"},t.createElement("label",{className:"font-semibold block mb-1"},"Marcas asociadas a tu empresa:"),(E=I==null?void 0:I.marcas)!=null&&E.length?t.createElement("div",{className:"flex flex-wrap gap-2"},I.marcas.map(_=>t.createElement("span",{key:_,className:"bg-gray-100 px-2 py-1 rounded text-sm"},_))):t.createElement("div",{className:"text-gray-500 text-sm"},"Sin marcas")),t.createElement("button",{type:"submit",disabled:C,className:"bg-blue-700 hover:bg-blue-900 text-white w-full py-2 rounded font-semibold"},C?"Guardando...":"Guardar Campaña"),t.createElement("button",{type:"button",onClick:()=>N("/proveedores"),className:"w-full mt-3 text-blue-700 underline"},"Cancelar")))}function z$(){var N,x;const{user:a}=ht(),[e,n]=p.useState(""),[r,s]=p.useState(""),[o,i]=p.useState(""),[l,c]=p.useState(""),[u,d]=p.useState(""),[m,h]=p.useState(!1),[C,S]=p.useState(""),[w,f]=p.useState(""),[b,v]=p.useState(null),I=Ct();p.useEffect(()=>{async function y(){if(a){const E=fe(W(F,"empresas"),pe("email","==",a.email)),_=await le(E);_.empty||(f(_.docs[0].id),v(_.docs[0].data()))}}y()},[a]);async function A(y){if(y.preventDefault(),h(!0),S(""),!e||!r||!o||!w||!b){S("Debes completar todos los campos principales, incluyendo empresa."),h(!1);return}if(!a){S("No hay usuario autenticado."),h(!1);return}try{await ot(W(F,"productos"),{nombre:e,descripcion:r,precio:Number(o),proveedorId:a.uid,idEmpresa:w,categorias:b.categorias||[],marcas:b.marcas||[],imagenURL:l,link:u,estado:"Enviada",fecha_creacion:sa()}),I("/proveedores")}catch{S("Error al guardar el producto. Intenta nuevamente.")}finally{h(!1)}}return t.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-100 via-white to-green-100 py-10"},t.createElement("form",{onSubmit:A,className:"bg-white p-8 rounded shadow max-w-md w-full"},t.createElement("h2",{className:"text-2xl font-bold text-blue-900 mb-6 text-center"},"Solicitud de Nuevo Producto"),C&&t.createElement("div",{className:"mb-4 text-red-600"},C),t.createElement("label",{className:"block mb-2 font-semibold"},"Nombre del producto"),t.createElement("input",{className:"mb-4 w-full border p-2 rounded",value:e,onChange:y=>n(y.target.value),required:!0}),t.createElement("label",{className:"block mb-2 font-semibold"},"Descripción"),t.createElement("textarea",{className:"mb-4 w-full border p-2 rounded",value:r,onChange:y=>s(y.target.value),required:!0}),t.createElement("label",{className:"block mb-2 font-semibold"},"Precio"),t.createElement("input",{type:"number",className:"mb-4 w-full border p-2 rounded",value:o,onChange:y=>i(y.target.value),required:!0}),t.createElement("label",{className:"block mb-2 font-semibold"},"Imagen (URL)"),t.createElement("input",{className:"mb-4 w-full border p-2 rounded",value:l,onChange:y=>c(y.target.value),placeholder:"https://..."}),t.createElement("label",{className:"block mb-2 font-semibold"},"Link (opcional)"),t.createElement("input",{className:"mb-4 w-full border p-2 rounded",value:u,onChange:y=>d(y.target.value),placeholder:"https://..."}),t.createElement("div",{className:"mb-4"},t.createElement("label",{className:"font-semibold block mb-1"},"Categorías asociadas a tu empresa:"),(N=b==null?void 0:b.categorias)!=null&&N.length?t.createElement("div",{className:"flex flex-wrap gap-2"},b.categorias.map(y=>t.createElement("span",{key:y,className:"bg-gray-100 px-2 py-1 rounded text-sm"},y))):t.createElement("div",{className:"text-gray-500 text-sm"},"Sin categorías")),t.createElement("div",{className:"mb-4"},t.createElement("label",{className:"font-semibold block mb-1"},"Marcas asociadas a tu empresa:"),(x=b==null?void 0:b.marcas)!=null&&x.length?t.createElement("div",{className:"flex flex-wrap gap-2"},b.marcas.map(y=>t.createElement("span",{key:y,className:"bg-gray-100 px-2 py-1 rounded text-sm"},y))):t.createElement("div",{className:"text-gray-500 text-sm"},"Sin marcas")),t.createElement("button",{type:"submit",disabled:m,className:"bg-blue-700 hover:bg-blue-900 text-white w-full py-2 rounded font-semibold"},m?"Guardando...":"Guardar Producto"),t.createElement("button",{type:"button",onClick:()=>I("/proveedores"),className:"w-full mt-3 text-blue-700 underline"},"Cancelar")))}const U$=()=>{const[a,e]=p.useState(!1);p.useState(null);const n=[{id:"suggestion",title:"Sugerencia",description:"Comparte una idea para mejorar",icon:MA,color:"bg-yellow-500 hover:bg-yellow-600"},{id:"complaint",title:"Reclamo",description:"Reporta un problema",icon:PE,color:"bg-red-500 hover:bg-red-600"},{id:"general",title:"Consulta",description:"Haz una pregunta",icon:Wu,color:"bg-blue-500 hover:bg-blue-600"}],r=s=>{window.location.href=`/contacto?type=${s}`};return t.createElement(t.Fragment,null,t.createElement("div",{className:"fixed bottom-6 right-6 z-50"},t.createElement("button",{onClick:()=>e(!a),className:"bg-blue-600 hover:bg-blue-700 text-white rounded-full p-4 shadow-lg transition-all duration-200 hover:scale-105","aria-label":"Feedback rápido"},a?t.createElement(VA,{className:"h-6 w-6"}):t.createElement(Wu,{className:"h-6 w-6"}))),a&&t.createElement("div",{className:"fixed bottom-24 right-6 z-50"},t.createElement("div",{className:"bg-white rounded-lg shadow-xl border border-gray-200 p-4 w-72"},t.createElement("div",{className:"mb-4"},t.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-2"},"¿Cómo podemos ayudarte?"),t.createElement("p",{className:"text-sm text-gray-600"},"Selecciona el tipo de mensaje que quieres enviar")),t.createElement("div",{className:"space-y-2"},n.map(s=>{const o=s.icon;return t.createElement("button",{key:s.id,onClick:()=>r(s.id),className:`w-full flex items-center p-3 rounded-lg text-white transition-colors ${s.color}`},t.createElement(o,{className:"h-5 w-5 mr-3"}),t.createElement("div",{className:"text-left"},t.createElement("div",{className:"font-medium"},s.title),t.createElement("div",{className:"text-sm opacity-90"},s.description)))})),t.createElement("div",{className:"mt-4 pt-3 border-t border-gray-200"},t.createElement("a",{href:"/contacto",className:"block w-full text-center py-2 px-4 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors"},"Ver todas las opciones"))),t.createElement("div",{className:"fixed inset-0 z-40",onClick:()=>e(!1)})))},$$=()=>{const[a,e]=p.useState({connection:"testing...",empresas:"testing...",solicitudes_empresa:"testing...",solicitudes_cliente:"testing...",messaging:"testing...",serviceWorker:"testing...",errors:[]});p.useEffect(()=>{(async()=>{const s={connection:"",empresas:"",solicitudes_empresa:"",solicitudes_cliente:"",messaging:"",serviceWorker:"",errors:[]};try{console.log("🔥 Iniciando test de conexión Firebase..."),console.log("📋 Configuración actual:",{projectId:F.app.options.projectId,authDomain:F.app.options.authDomain}),s.connection="✅ Conectado";try{"serviceWorker"in navigator?(await navigator.serviceWorker.getRegistrations()).find(l=>l.active&&l.active.scriptURL.includes("firebase-messaging-sw.js"))?s.serviceWorker="✅ Firebase Service Worker activo":s.serviceWorker="⚠️ Firebase Service Worker no encontrado":s.serviceWorker="❌ Service Workers no soportados"}catch(o){s.serviceWorker=`❌ Error SW: ${o.message}`,s.errors.push(`Service Worker: ${o.message}`)}try{Xi?s.messaging="✅ Firebase Messaging inicializado":s.messaging="⚠️ Firebase Messaging no disponible"}catch(o){s.messaging=`❌ Error Messaging: ${o.message}`,s.errors.push(`Messaging: ${o.message}`)}try{const o=fe(W(F,"empresas"),Ot(5)),i=await le(o);s.empresas=`✅ ${i.size} documentos encontrados`,console.log("🏢 Empresas:",i.docs.map(l=>({id:l.id,data:l.data()})))}catch(o){s.empresas=`❌ Error: ${o.message}`,s.errors.push(`Empresas: ${o.message}`),console.error("❌ Error empresas:",o)}try{const o=fe(W(F,"solicitudes_empresa"),Ot(5)),i=await le(o);s.solicitudes_empresa=`✅ ${i.size} documentos encontrados`,console.log("📋 Solicitudes empresa:",i.docs.map(l=>({id:l.id,data:l.data()})))}catch(o){s.solicitudes_empresa=`❌ Error: ${o.message}`,s.errors.push(`Solicitudes empresa: ${o.message}`),console.error("❌ Error solicitudes empresa:",o)}try{const o=fe(W(F,"solicitudes_cliente"),Ot(5)),i=await le(o);s.solicitudes_cliente=`✅ ${i.size} documentos encontrados`,console.log("👥 Solicitudes cliente:",i.docs.map(l=>({id:l.id,data:l.data()})))}catch(o){s.solicitudes_cliente=`❌ Error: ${o.message}`,s.errors.push(`Solicitudes cliente: ${o.message}`),console.error("❌ Error solicitudes cliente:",o)}}catch(o){s.connection=`❌ Error de conexión: ${o.message}`,s.errors.push(`Conexión: ${o.message}`),console.error("❌ Error general:",o)}e(s)})()},[]);const n=async()=>{try{if("serviceWorker"in navigator){const r=await navigator.serviceWorker.register("/firebase-messaging-sw.js");return console.log("Firebase Service Worker registrado manualmente:",r),e(s=>({...s,serviceWorker:"✅ Firebase Service Worker registrado manualmente"})),r}}catch(r){console.error("Error registrando Firebase Service Worker manualmente:",r),e(s=>({...s,serviceWorker:`❌ Error registrando SW: ${r.message}`,errors:[...s.errors,`Service Worker manual: ${r.message}`]}))}};return t.createElement("div",{className:"p-6 bg-white rounded-lg shadow-lg max-w-4xl mx-auto"},t.createElement("h2",{className:"text-2xl font-bold mb-4 text-gray-800"},"🔥 Test de Conexión Firebase"),t.createElement("div",{className:"space-y-4"},t.createElement("div",{className:"bg-gray-50 p-4 rounded-lg"},t.createElement("h3",{className:"font-semibold text-lg mb-2"},"📊 Estado de las Colecciones"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},t.createElement("div",{className:"bg-white p-3 rounded border"},t.createElement("div",{className:"font-medium text-blue-600"},"Conexión Firebase"),t.createElement("div",{className:a.connection.includes("✅")?"text-green-600":"text-red-600"},a.connection)),t.createElement("div",{className:"bg-white p-3 rounded border"},t.createElement("div",{className:"font-medium text-blue-600"},"Service Worker"),t.createElement("div",{className:a.serviceWorker.includes("✅")?"text-green-600":a.serviceWorker.includes("⚠️")?"text-yellow-600":"text-red-600"},a.serviceWorker)),t.createElement("div",{className:"bg-white p-3 rounded border"},t.createElement("div",{className:"font-medium text-blue-600"},"Firebase Messaging"),t.createElement("div",{className:a.messaging.includes("✅")?"text-green-600":a.messaging.includes("⚠️")?"text-yellow-600":"text-red-600"},a.messaging)),t.createElement("div",{className:"bg-white p-3 rounded border"},t.createElement("div",{className:"font-medium text-blue-600"},"Empresas"),t.createElement("div",{className:a.empresas.includes("✅")?"text-green-600":"text-red-600"},a.empresas)),t.createElement("div",{className:"bg-white p-3 rounded border"},t.createElement("div",{className:"font-medium text-blue-600"},"Solicitudes Empresa"),t.createElement("div",{className:a.solicitudes_empresa.includes("✅")?"text-green-600":"text-red-600"},a.solicitudes_empresa)),t.createElement("div",{className:"bg-white p-3 rounded border"},t.createElement("div",{className:"font-medium text-blue-600"},"Solicitudes Cliente"),t.createElement("div",{className:a.solicitudes_cliente.includes("✅")?"text-green-600":"text-red-600"},a.solicitudes_cliente)))),a.errors.length>0&&t.createElement("div",{className:"bg-red-50 border border-red-200 p-4 rounded-lg"},t.createElement("h4",{className:"font-semibold text-red-800 mb-2"},"❌ Errores Detectados:"),t.createElement("ul",{className:"list-disc list-inside space-y-1"},a.errors.map((r,s)=>t.createElement("li",{key:s,className:"text-red-700 text-sm"},r)))),t.createElement("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg"},t.createElement("h4",{className:"font-semibold text-blue-800 mb-2"},"🔧 Información de Debug:"),t.createElement("div",{className:"text-sm text-blue-700 space-y-1"},t.createElement("div",null,t.createElement("strong",null,"Project ID:")," ",F.app.options.projectId),t.createElement("div",null,t.createElement("strong",null,"Auth Domain:")," ",F.app.options.authDomain),t.createElement("div",null,t.createElement("strong",null,"Database URL:")," ",F.app.options.databaseURL||"No configurada"))),t.createElement("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg"},t.createElement("h4",{className:"font-semibold text-yellow-800 mb-2"},"💡 Posibles Soluciones:"),t.createElement("ul",{className:"list-disc list-inside space-y-1 text-sm text-yellow-700 mb-4"},t.createElement("li",null,"Verificar que las reglas de Firestore permitan lectura pública o autenticada"),t.createElement("li",null,"Confirmar que el proyecto Firebase esté activo y las colecciones existan"),t.createElement("li",null,"Revisar la configuración de Firebase en firebase.js"),t.createElement("li",null,"Verificar que no haya problemas de CORS o red"),t.createElement("li",null,"Registrar manualmente el Service Worker para notificaciones")),t.createElement("button",{onClick:n,className:"bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"},"🔧 Registrar Service Worker Manualmente"))))};function B$(){const[a,e]=p.useState(""),[n,r]=p.useState([]),s=["gs://huamachuco-c0d9f.firebasestorage.app/logos/empresas/auto-OgYbz5JETdGDpaCp1vAJ-1753305145319.png","https://example.com/test-image.jpg","gs://invalid-bucket/path/to/image.png",""],o=()=>{const i=s.map(l=>({original:l,testUrl:l}));r(i)};return t.createElement("div",{className:"p-6 max-w-4xl mx-auto"},t.createElement("h1",{className:"text-2xl font-bold mb-6"},"🧪 Test de Conversión de URLs de Imagen"),t.createElement("div",{className:"mb-6"},t.createElement("h2",{className:"text-lg font-semibold mb-3"},"URLs de Prueba"),t.createElement("div",{className:"space-y-2"},s.map((i,l)=>t.createElement("div",{key:l,className:"p-3 bg-gray-100 rounded"},t.createElement("strong",null,"Test ",l+1,":")," ",i||"(URL vacía)",t.createElement(xh,{url:i}))))),t.createElement("div",{className:"mb-6"},t.createElement("h2",{className:"text-lg font-semibold mb-3"},"Probar URL Personalizada"),t.createElement("div",{className:"flex gap-2"},t.createElement("input",{type:"text",value:a,onChange:i=>e(i.target.value),placeholder:"Ingresa una URL gs:// o https://",className:"flex-1 p-2 border rounded"}),t.createElement("button",{onClick:()=>e(""),className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600"},"Limpiar")),a&&t.createElement(xh,{url:a})),t.createElement("button",{onClick:o,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},"Ejecutar Todos los Tests"),n.length>0&&t.createElement("div",{className:"mt-6"},t.createElement("h2",{className:"text-lg font-semibold mb-3"},"Resultados de los Tests"),t.createElement("div",{className:"space-y-2"},n.map((i,l)=>t.createElement("div",{key:l,className:"p-3 bg-gray-100 rounded"},t.createElement("strong",null,"Test ",l+1,":")," ",i.original||"(URL vacía)",t.createElement(xh,{url:i.testUrl}))))))}function xh({url:a}){const{imageUrl:e,loading:n,error:r}=ui(a);return t.createElement("div",{className:"mt-2 p-2 bg-white rounded border"},t.createElement("div",{className:"text-sm text-gray-600 mb-2"},t.createElement("strong",null,"Estado:")," ",n?"🔄 Cargando...":r?"❌ Error":e?"✅ Convertido":"⚠️ Sin URL"),r&&t.createElement("div",{className:"text-red-600 text-sm mb-2"},t.createElement("strong",null,"Error:")," ",r),e&&t.createElement("div",{className:"text-green-600 text-sm mb-2"},t.createElement("strong",null,"URL Convertida:")," ",e),t.createElement("div",{className:"flex items-center gap-4"},t.createElement("div",{className:"text-sm"},t.createElement("strong",null,"URL Original:"),t.createElement("div",{className:"text-xs text-gray-500 break-all"},a||"N/A")),t.createElement("div",{className:"text-sm"},t.createElement("strong",null,"URL Final:"),t.createElement("div",{className:"text-xs text-gray-500 break-all"},e||"N/A"))),e&&t.createElement("div",{className:"mt-2"},t.createElement("strong",null,"Vista Previa:"),t.createElement("div",{className:"mt-1"},t.createElement("img",{src:e,alt:"Test",className:"max-w-32 max-h-32 object-contain border rounded",onError:s=>{s.target.style.display="none",s.target.nextSibling.style.display="block"}}),t.createElement("div",{className:"hidden max-w-32 max-h-32 bg-red-100 border border-red-300 rounded flex items-center justify-center text-red-600 text-xs"},"Error al cargar imagen"))))}function q$(){const[a,e]=p.useState(null),[n,r]=p.useState(!1),[s,o]=p.useState(""),[i,l]=p.useState(""),c=d=>{const m=d.target.files[0];m&&(e(m),l(""))},u=async()=>{if(!a){l("Por favor selecciona un archivo");return}r(!0),l("");try{const d=Date.now(),m=`test-${Math.random().toString(36).substr(2,9)}-${d}`,h=a.name.split(".").pop(),C=`${m}.${h}`,S=Fl(ci,`logos/empresas/${C}`);console.log("📁 Subiendo archivo:",a.name),console.log("📍 Ruta en Storage:",S.fullPath);const w=await Uu(S,a);console.log("✅ Archivo subido exitosamente:",w.metadata.fullPath);const f=await jl(w.ref);console.log("🔗 URL de descarga:",f);const b=`gs://${S.bucket}/${S.fullPath}`;console.log("🏪 URL gs://:",b),o(f),alert(`Logo subido exitosamente!

📁 Archivo: ${a.name}
📍 Ruta Storage: ${S.fullPath}
🏪 URL gs://: ${b}
🔗 URL Descarga: ${f}`)}catch(d){console.error("❌ Error subiendo archivo:",d),l(`Error al subir archivo: ${d.message}`)}finally{r(!1)}};return t.createElement("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-lg"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"🧪 Prueba de Subida de Logos"),t.createElement("div",{className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Seleccionar Logo"),t.createElement("input",{type:"file",accept:"image/*",onChange:c,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),t.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Formatos: JPG, PNG, GIF. Máximo 5MB")),a&&t.createElement("div",{className:"p-4 bg-gray-50 rounded-lg"},t.createElement("h3",{className:"font-medium text-gray-900 mb-2"},"Archivo seleccionado:"),t.createElement("p",{className:"text-sm text-gray-600"},"📁 Nombre: ",a.name,t.createElement("br",null),"📏 Tamaño: ",(a.size/1024/1024).toFixed(2)," MB",t.createElement("br",null),"🎨 Tipo: ",a.type)),t.createElement("button",{onClick:u,disabled:!a||n,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},n?"⏳ Subiendo...":"🚀 Subir Logo"),i&&t.createElement("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded"},"❌ ",i),s&&t.createElement("div",{className:"p-4 bg-green-50 border border-green-400 rounded-lg"},t.createElement("h3",{className:"font-medium text-green-900 mb-2"},"✅ Logo subido exitosamente!"),t.createElement("div",{className:"space-y-2"},t.createElement("img",{src:s,alt:"Logo subido",className:"h-32 w-32 object-contain border border-gray-300 rounded"}),t.createElement("p",{className:"text-sm text-green-700"},"🔗 URL: ",t.createElement("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"underline"},s))))),t.createElement("div",{className:"mt-8 p-4 bg-blue-50 border border-blue-200 rounded-lg"},t.createElement("h3",{className:"font-medium text-blue-900 mb-2"},"ℹ️ Información de la Prueba"),t.createElement("p",{className:"text-sm text-blue-700"},"Este componente prueba la funcionalidad de subida de logos a Firebase Storage.",t.createElement("br",null),"Los archivos se guardan en la ruta: ",t.createElement("code",{className:"bg-blue-100 px-1 rounded"},"logos/empresas/"),t.createElement("br",null),"Se generan URLs únicas y se obtienen tanto la referencia gs:// como la URL de descarga.")))}function W$(){const[a]=p.useState(["gs://huamachuco-c0d9f.firebasestorage.app/logos/empresas/auto-06o13wsEv2yTK0y2fiIL-1753152184883.png","https://firebasestorage.googleapis.com/v0/b/huamachuco-c0d9f.appspot.com/o/logos%2Fempresas%2Fauto-06o13wsEv2yTK0y2fiIL-1753152184883.png?alt=media&token=example","","invalid-url"]);return t.createElement("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-lg"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"🧪 Prueba de Visualización de Logos"),t.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},a.map((e,n)=>t.createElement("div",{key:n,className:"border border-gray-200 rounded-lg p-4"},t.createElement("h3",{className:"font-medium text-gray-900 mb-3"},"Test ",n+1,": ",e?e.startsWith("gs://")?"URL gs://":"URL https://":"Sin URL"),t.createElement("div",{className:"mb-3"},t.createElement("strong",null,"URL:"),t.createElement("p",{className:"text-xs text-gray-600 break-all mt-1"},e||"N/A")),t.createElement(G$,{url:e})))),t.createElement("div",{className:"mt-8 p-4 bg-blue-50 border border-blue-200 rounded-lg"},t.createElement("h3",{className:"font-medium text-blue-900 mb-2"},"ℹ️ Información de la Prueba"),t.createElement("p",{className:"text-sm text-blue-700"},"Este componente prueba la visualización de logos usando el hook ",t.createElement("code",{className:"bg-blue-100 px-1 rounded"},"useImageUrl"),".",t.createElement("br",null),"- ",t.createElement("strong",null,"URL gs://"),": Debería convertirse automáticamente a URL de descarga",t.createElement("br",null),"- ",t.createElement("strong",null,"URL https://"),": Debería mostrarse directamente",t.createElement("br",null),"- ",t.createElement("strong",null,"Sin URL"),": Debería mostrar placeholder",t.createElement("br",null),"- ",t.createElement("strong",null,"URL inválida"),": Debería mostrar error")))}function G$({url:a}){const{imageUrl:e,loading:n,error:r}=ui(a);return a?n?t.createElement("div",{className:"w-32 h-32 bg-blue-100 rounded-lg flex items-center justify-center"},t.createElement("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),t.createElement("span",{className:"text-blue-600 text-sm ml-2"},"Convirtiendo...")):r||!e?t.createElement("div",{className:"w-32 h-32 bg-red-100 rounded-lg flex items-center justify-center border border-red-300"},t.createElement("div",{className:"text-center"},t.createElement("span",{className:"text-red-600 text-lg"},"❌"),t.createElement("p",{className:"text-red-600 text-xs mt-1"},"Error al cargar"),t.createElement("p",{className:"text-red-500 text-xs"},r))):t.createElement("div",{className:"w-32 h-32 bg-green-100 rounded-lg flex items-center justify-center border border-green-300"},t.createElement("img",{src:e,alt:"Logo de prueba",className:"max-w-full max-h-full object-contain",onError:s=>{console.error("Error cargando imagen:",s.target.src),s.target.style.display="none"}})):t.createElement("div",{className:"w-32 h-32 bg-gray-100 rounded-lg flex items-center justify-center border-2 border-dashed border-gray-300"},t.createElement("span",{className:"text-gray-500 text-sm"},"Sin logo"))}function H$(){const{user:a,rol:e,loading:n,error:r}=ht();return t.createElement("div",{className:"fixed top-4 right-4 bg-black text-white p-4 rounded-lg z-50 max-w-md"},t.createElement("h3",{className:"font-bold mb-2"},"🔍 Debug AuthProvider"),t.createElement("div",{className:"text-xs space-y-1"},t.createElement("div",null,t.createElement("strong",null,"User:")," ",a?"✅ Sí":"❌ No"),t.createElement("div",null,t.createElement("strong",null,"UID:")," ",(a==null?void 0:a.uid)||"N/A"),t.createElement("div",null,t.createElement("strong",null,"Email:")," ",(a==null?void 0:a.email)||"N/A"),t.createElement("div",null,t.createElement("strong",null,"Rol:")," ",e||"N/A"),t.createElement("div",null,t.createElement("strong",null,"Loading:")," ",n?"⏳ Sí":"✅ No"),t.createElement("div",null,t.createElement("strong",null,"Error:")," ",r||"N/A")),t.createElement("button",{onClick:()=>window.location.reload(),className:"mt-2 bg-blue-600 px-2 py-1 rounded text-xs"},"🔄 Recargar"))}class J_{static async deleteClientUser(e){try{console.log("🔍 Buscando usuario para eliminar:",e);const n=fe(W(F,"usuarios"),pe("email","==",e)),r=await le(n);if(!r.empty){const l=r.docs[0];console.log("✅ Usuario encontrado en usuarios:",l.id),await on(Ne(F,"usuarios",l.id)),console.log("🗑️ Documento eliminado de usuarios")}const s=fe(W(F,"perfiles_clientes"),pe("email","==",e)),o=await le(s);if(!o.empty){const l=o.docs[0];console.log("✅ Perfil encontrado en perfiles_clientes:",l.id),await on(Ne(F,"perfiles_clientes",l.id)),console.log("🗑️ Perfil eliminado de perfiles_clientes")}const i=Pt.currentUser;return i&&i.email===e&&(console.log("✅ Usuario autenticado encontrado, eliminando..."),await r5(i),console.log("🗑️ Usuario de Auth eliminado")),console.log("✅ Usuario eliminado completamente"),{success:!0}}catch(n){return console.error("❌ Error eliminando usuario:",n),{success:!1,error:n.message}}}static async checkUserExists(e){try{console.log("🔍 Verificando existencia del usuario:",e);const n=fe(W(F,"usuarios"),pe("email","==",e)),r=await le(n),s=fe(W(F,"perfiles_clientes"),pe("email","==",e)),o=await le(s),i={email:e,existsInUsuarios:!r.empty,existsInPerfiles:!o.empty,usuariosDoc:r.empty?null:r.docs[0].data(),perfilesDoc:o.empty?null:o.docs[0].data()};return console.log("📊 Estado del usuario:",i),i}catch(n){return console.error("❌ Error verificando usuario:",n),{success:!1,error:n.message}}}}function K$(){const[a,e]=p.useState(""),[n,r]=p.useState(""),[s,o]=p.useState(!1),[i,l]=p.useState(""),[c,u]=p.useState(null),d=async()=>{if(!a){l("❌ Por favor ingresa un email");return}o(!0),l("🔍 Verificando usuario...");try{const C=await J_.checkUserExists(a);u(C),l("✅ Verificación completada. Revisa la consola para más detalles.")}catch(C){l(`❌ Error: ${C.message}`)}finally{o(!1)}},m=async()=>{if(!a){l("❌ Por favor ingresa un email");return}o(!0),l("🗑️ Eliminando usuario...");try{const C=await J_.deleteClientUser(a);C.success?(l("✅ Usuario eliminado correctamente"),u(null)):l(`❌ Error: ${C.error}`)}catch(C){l(`❌ Error: ${C.message}`)}finally{o(!1)}},h=async()=>{if(!a||!n){l("❌ Por favor ingresa email y contraseña");return}o(!0),l("🔄 Recreando usuario...");try{const C={nombres:a.split("@")[0],apellidos:"Cliente",email:a,password_hash:btoa(n),telefono:"No especificado",direccion:"No especificada",comuna:"No especificada",region:"No especificada",rut:"No especificado",fecha_nacimiento:null,genero:""},S=await sT.createClientUser(C);S.success?(l("✅ Usuario recreado correctamente. Ahora debería poder iniciar sesión."),u(null)):l(`❌ Error: ${S.error}`)}catch(C){l(`❌ Error: ${C.message}`)}finally{o(!1)}};return t.createElement("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-lg"},t.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"🔄 Limpieza y Recreación de Usuarios Cliente"),t.createElement("div",{className:"space-y-4"},t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email del Usuario"),t.createElement("input",{type:"email",value:a,onChange:C=>e(C.target.value),placeholder:"clepez@gmail.com",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",null,t.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nueva Contraseña (para recrear)"),t.createElement("input",{type:"password",value:n,onChange:C=>r(C.target.value),placeholder:"Nueva contraseña",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),t.createElement("div",{className:"flex space-x-3"},t.createElement("button",{onClick:d,disabled:s,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50"},"🔍 Verificar Usuario"),t.createElement("button",{onClick:m,disabled:s,className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 disabled:opacity-50"},"🗑️ Eliminar Usuario"),t.createElement("button",{onClick:h,disabled:s,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50"},"🔄 Recrear Usuario")),i&&t.createElement("div",{className:`p-3 rounded-md ${i.includes("✅")?"bg-green-100 text-green-800":i.includes("❌")?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`},i),c&&t.createElement("div",{className:"bg-gray-100 p-4 rounded-md"},t.createElement("h3",{className:"font-semibold mb-2"},"📊 Estado del Usuario:"),t.createElement("div",{className:"text-sm space-y-1"},t.createElement("div",null,t.createElement("strong",null,"Email:")," ",c.email),t.createElement("div",null,t.createElement("strong",null,"En usuarios:")," ",c.existsInUsuarios?"✅ Sí":"❌ No"),t.createElement("div",null,t.createElement("strong",null,"En perfiles:")," ",c.existsInPerfiles?"✅ Sí":"❌ No"),c.usuariosDoc&&t.createElement("div",null,t.createElement("strong",null,"UID en usuarios:")," ",c.usuariosDoc.uid)))),t.createElement("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-md"},t.createElement("h3",{className:"font-semibold text-yellow-800 mb-2"},"⚠️ Instrucciones:"),t.createElement("ol",{className:"text-sm text-yellow-700 space-y-1 list-decimal list-inside"},t.createElement("li",null,"Ingresa el email del usuario a limpiar"),t.createElement("li",null,'Haz clic en "Verificar Usuario" para ver su estado actual'),t.createElement("li",null,'Haz clic en "Eliminar Usuario" para limpiarlo completamente'),t.createElement("li",null,'Ingresa una nueva contraseña y haz clic en "Recrear Usuario"'),t.createElement("li",null,"El usuario ahora debería poder iniciar sesión correctamente"))))}const Q$=[{nombre:"Mapfre",logo:"/images/mapfre-logo.png",rating:4.2,factor:1,descripcion:"Seguro automotriz completo con cobertura nacional",cobertura:["Responsabilidad Civil","Daños Propios","Robo","Incendio"],telefono:"+56 2 2000 0000",email:"contacto@mapfre.cl",sitioWeb:"https://www.mapfre.cl"},{nombre:"Zurich",logo:"/images/zurich-logo.png",rating:4.5,factor:1.1,descripcion:"Seguros premium con servicio de asistencia 24/7",cobertura:["Responsabilidad Civil","Daños Propios","Robo","Incendio","Fenómenos Naturales"],telefono:"+56 2 2100 0000",email:"seguros@zurich.cl",sitioWeb:"https://www.zurich.cl"},{nombre:"Liberty",logo:"/images/liberty-logo.png",rating:4,factor:.95,descripcion:"Seguros accesibles con planes flexibles",cobertura:["Responsabilidad Civil","Daños Propios","Robo"],telefono:"+56 2 2200 0000",email:"info@liberty.cl",sitioWeb:"https://www.liberty.cl"}],J$=[{nombre:"PRT Santiago Centro",direccion:"Av. Libertador Bernardo O'Higgins 1234",comuna:"Santiago",region:"RM",telefono:"+56 2 2300 0000",rating:4.3,precioBase:25e3,tiempoPromedio:45,horarios:"L-V 8:00-18:00, S 8:00-14:00",servicios:["Revisión Anual","Revisión Semestral","Primera Vez","Reinspección"],latitud:-33.4489,longitud:-70.6693},{nombre:"Centro Técnico Las Condes",direccion:"Av. Apoquindo 5678",comuna:"Las Condes",region:"RM",telefono:"+56 2 2400 0000",rating:4.6,precioBase:28e3,tiempoPromedio:40,horarios:"L-V 8:30-19:00, S 9:00-15:00",servicios:["Revisión Anual","Revisión Semestral","Primera Vez","Reinspección","Gases"],latitud:-33.415,longitud:-70.5747},{nombre:"Revisión Técnica Maipú",direccion:"Av. Pajaritos 9876",comuna:"Maipú",region:"RM",telefono:"+56 2 2500 0000",rating:4.1,precioBase:23e3,tiempoPromedio:50,horarios:"L-V 8:00-17:30, S 8:30-13:00",servicios:["Revisión Anual","Revisión Semestral","Primera Vez"],latitud:-33.5123,longitud:-70.7507}],Y$=[{nombre:"Vulcanización Express",direccion:"Av. Grecia 1234",comuna:"Ñuñoa",telefono:"+56 9 8765 4321",rating:4.4,precioBase:15e3,tiempoRespuesta:15,horarios:"L-D 8:00-22:00",emergencia24h:!0,servicioDomicilio:!0,promociones:!0,servicios:["parche","cambio_neumatico","balanceado","alineacion","valvula"],precios:{parche:8e3,cambio_neumatico:5e3,balanceado:12e3,alineacion:25e3,valvula:3e3},latitud:-33.4569,longitud:-70.5874},{nombre:"Neumáticos del Sur",direccion:"Av. Vicuña Mackenna 5678",comuna:"La Florida",telefono:"+56 9 7654 3210",rating:4.2,precioBase:12e3,tiempoRespuesta:20,horarios:"L-S 8:30-20:00",emergencia24h:!1,servicioDomicilio:!0,promociones:!1,servicios:["parche","cambio_neumatico","balanceado","rotacion"],precios:{parche:7e3,cambio_neumatico:4500,balanceado:1e4,rotacion:8e3},latitud:-33.5206,longitud:-70.5986},{nombre:"Vulca Rápido 24H",direccion:"Av. Providencia 9876",comuna:"Providencia",telefono:"+56 9 6543 2109",rating:4.7,precioBase:18e3,tiempoRespuesta:10,horarios:"24 horas",emergencia24h:!0,servicioDomicilio:!0,promociones:!0,servicios:["parche","cambio_neumatico","balanceado","alineacion","valvula","rotacion"],precios:{parche:1e4,cambio_neumatico:6e3,balanceado:15e3,alineacion:3e4,valvula:4e3,rotacion:12e3},latitud:-33.4255,longitud:-70.6118}],Z$=[{nombre:"Responsabilidad Civil",descripcion:"Cobertura obligatoria por daños a terceros",obligatorio:!0},{nombre:"Daños Propios",descripcion:"Cobertura para daños en tu propio vehículo",obligatorio:!1},{nombre:"Robo e Incendio",descripcion:"Protección contra robo total y daños por incendio",obligatorio:!1},{nombre:"Fenómenos Naturales",descripcion:"Cobertura para daños por terremotos, inundaciones, etc.",obligatorio:!1}],X$=async()=>{try{const a=localStorage.getItem("lastServiceInit"),e=new Date().toDateString();if(a===e)return!0;if((await le(W(F,"companias_seguros"))).empty)for(const i of Q$)await ot(W(F,"companias_seguros"),i);if((await le(W(F,"centros_revision"))).empty)for(const i of J$)await ot(W(F,"centros_revision"),i);if((await le(W(F,"vulcanizadoras"))).empty)for(const i of Y$)await ot(W(F,"vulcanizadoras"),i);if((await le(W(F,"tipos_seguros"))).empty)for(const i of Z$)await ot(W(F,"tipos_seguros"),i);return localStorage.setItem("lastServiceInit",e),!0}catch(a){return console.error("Error inicializando datos de servicios:",a),!1}};function eB(){const[a,e]=p.useState(null),[n,r]=p.useState(null),[s,o]=p.useState(!0);return p.useEffect(()=>{X$();const i=iE(Pt,l=>{if(e(l),l){const c=W(F,"usuarios"),u=wa(c,d=>{const h=d.docs.map(C=>({id:C.id,...C.data()})).find(C=>C.uid===l.uid||C.email===l.email);r(h),o(!1)});return()=>u()}else r(null),o(!1)});return()=>i()},[]),s?t.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gray-50"},t.createElement("div",{className:"text-center"},t.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),t.createElement("p",{className:"mt-4 text-gray-600"},"Cargando AV10 de Julio..."))):t.createElement(gz,null,t.createElement(kz,null,t.createElement("div",{className:"min-h-screen bg-gray-50"},a&&t.createElement(f$,{user:a}),t.createElement(IA,null,t.createElement(De,{path:"/",element:t.createElement(gw,null)}),t.createElement(De,{path:"/login",element:t.createElement(w7,null)}),t.createElement(De,{path:"/dashboard",element:t.createElement(Mi,null,t.createElement(g$,null))}),t.createElement(De,{path:"/dashboard/visualizar-solicitud/:id",element:t.createElement(v7,null)}),t.createElement(De,{path:"/admin/*",element:t.createElement(Mi,null,t.createElement(VE,null,t.createElement(p$,null)))}),t.createElement(De,{path:"/dashboard/agente",element:t.createElement(G_,null)}),t.createElement(De,{path:"/agente/empresas-asignadas",element:t.createElement(G_,null)}),t.createElement(De,{path:"/agente/nueva-empresa",element:t.createElement(v$,null)}),t.createElement(De,{path:"/agente/empresa/:empresaId",element:t.createElement(Lz,null)}),t.createElement(De,{path:"/dashboard/proveedor",element:t.createElement(Mi,null,t.createElement(K_,null))}),t.createElement(De,{path:"/empresa/mi-empresa",element:t.createElement(Mi,null,t.createElement(j$,null))}),t.createElement(De,{path:"/empresa/solicitar-campana",element:t.createElement(Mi,null,t.createElement(F$,null))}),t.createElement(De,{path:"/empresa/solicitar-producto",element:t.createElement(Mi,null,t.createElement(z$,null))}),t.createElement(De,{path:"/registro-cliente",element:t.createElement(x$,null)}),t.createElement(De,{path:"/registro-empresa",element:t.createElement(w$,null)}),t.createElement(De,{path:"/solicitud-comunidad",element:t.createElement(_$,null)}),t.createElement(De,{path:"/empresas",element:t.createElement(Nm,null)}),t.createElement(De,{path:"/proveedores",element:t.createElement(Nm,null)}),t.createElement(De,{path:"/proveedores-locales",element:t.createElement(Nm,null)}),t.createElement(De,{path:"/empresas-locales",element:t.createElement(Nm,null)}),t.createElement(De,{path:"/area-cliente",element:t.createElement(k$,null)}),t.createElement(De,{path:"/recursos",element:t.createElement(A$,null)}),t.createElement(De,{path:"/recursos/:resourceId",element:t.createElement(T$,null)}),t.createElement(De,{path:"/registro-agente",element:t.createElement(y$,null)}),t.createElement(De,{path:"/faq",element:t.createElement(I$,null)}),t.createElement(De,{path:"/contacto",element:t.createElement(R$,null)}),t.createElement(De,{path:"/servicios/seguros",element:t.createElement(D$,null)}),t.createElement(De,{path:"/servicios/revision-tecnica",element:t.createElement(L$,null)}),t.createElement(De,{path:"/servicios/vulcanizaciones",element:t.createElement(M$,null)}),t.createElement(De,{path:"/servicios/reciclaje",element:t.createElement(V$,null)}),t.createElement(De,{path:"/mis-recordatorios",element:t.createElement(O$,null)}),t.createElement(De,{path:"/empresa/:id",element:t.createElement(Eh,null)}),t.createElement(De,{path:"/proveedor/:id",element:t.createElement(Eh,null)}),t.createElement(De,{path:"/empresa/:empresaId",element:t.createElement(Eh,null)}),t.createElement(De,{path:"/perfil-proveedor/:empresaId",element:t.createElement(K_,null)}),t.createElement(De,{path:"/dashboard/cliente",element:t.createElement(Q_,null)}),t.createElement(De,{path:"/dashboard/cliente/:clienteId",element:t.createElement(Q_,null)}),t.createElement(De,{path:"/firebase-test",element:t.createElement($$,null)}),t.createElement(De,{path:"/test-images",element:t.createElement(B$,null)}),t.createElement(De,{path:"/test-logo-upload",element:t.createElement(q$,null)}),t.createElement(De,{path:"/test-logo-display",element:t.createElement(W$,null)}),t.createElement(De,{path:"/admin/cleanup-users",element:t.createElement(K$,null)}),t.createElement(De,{path:"*",element:t.createElement(gw,null)})),t.createElement(U$,null),t.createElement(H$,null))))}class tB extends t.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("ErrorBoundary atrapó un error:",e,n)}render(){var e;return this.state.hasError?t.createElement("div",{className:"p-8 text-center text-red-700"},t.createElement("h1",null,"¡Algo salió mal!"),t.createElement("p",null,(e=this.state.error)==null?void 0:e.toString())):this.props.children}}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(a=>{console.log("SW registrado con éxito:",a)}).catch(a=>{console.log("SW registración falló:",a)})});yh.createRoot(document.getElementById("root")).render(t.createElement(tB,null,t.createElement(eB,null)));export{W as $,Uk as A,ni as B,_r as C,va as D,sq as E,hi as F,$b as G,rq as H,oB as I,Fn as J,D3 as K,M3 as L,ot as M,RB as N,DB as O,nM as P,$a as Q,_B as R,dB as S,Kt as T,JB as U,Mg as V,tM as W,QB as X,PB as Y,fB as Z,PC as _,Ou as a,cB as a0,L3 as a1,q3 as a2,nq as a3,on as a4,KB as a5,bB as a6,aq as a7,Ne as a8,NB as a9,yB as aA,wa as aB,FB as aC,wB as aD,st as aE,qB as aF,WB as aG,X3 as aH,fe as aI,kk as aJ,uB as aK,HB as aL,sa as aM,Ar as aN,XB as aO,aB as aP,LB as aQ,kB as aR,SB as aS,TB as aT,EB as aU,ze as aV,ZB as aW,hB as aX,pe as aY,$k as aZ,pB as aa,gB as ab,vB as ac,tq as ad,AB as ae,IB as af,la as ag,pd as ah,G3 as ai,zB as aj,en as ak,MB as al,VB as am,le as an,OB as ao,jB as ap,V3 as aq,eq as ar,YB as as,mB as at,Ot as au,CB as av,xB as aw,UB as ax,BB as ay,$B as az,O3 as b,Ml as c,vi as d,Ut as e,xe as f,Xl as g,dd as h,Bm as i,$g as j,md as k,zg as l,Yb as m,Vl as n,Ug as o,Vo as p,aM as q,da as r,Qo as s,Ae as t,rB as u,S6 as v,Yt as w,oq as x,bt as y,nB as z};
