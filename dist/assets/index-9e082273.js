(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var _N=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function e0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var NN={exports:{}},Be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qc=Symbol.for("react.element"),fA=Symbol.for("react.portal"),hA=Symbol.for("react.fragment"),gA=Symbol.for("react.strict_mode"),vA=Symbol.for("react.profiler"),bA=Symbol.for("react.provider"),yA=Symbol.for("react.context"),EA=Symbol.for("react.forward_ref"),xA=Symbol.for("react.suspense"),wA=Symbol.for("react.memo"),_A=Symbol.for("react.lazy"),xy=Symbol.iterator;function NA(t){return t===null||typeof t!="object"?null:(t=xy&&t[xy]||t["@@iterator"],typeof t=="function"?t:null)}var CN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},SN=Object.assign,kN={};function $o(t,e,n){this.props=t,this.context=e,this.refs=kN,this.updater=n||CN}$o.prototype.isReactComponent={};$o.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};$o.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function IN(){}IN.prototype=$o.prototype;function t0(t,e,n){this.props=t,this.context=e,this.refs=kN,this.updater=n||CN}var n0=t0.prototype=new IN;n0.constructor=t0;SN(n0,$o.prototype);n0.isPureReactComponent=!0;var wy=Array.isArray,TN=Object.prototype.hasOwnProperty,r0={current:null},AN={key:!0,ref:!0,__self:!0,__source:!0};function PN(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)TN.call(e,r)&&!AN.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Qc,type:t,key:i,ref:o,props:s,_owner:r0.current}}function CA(t,e){return{$$typeof:Qc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function a0(t){return typeof t=="object"&&t!==null&&t.$$typeof===Qc}function SA(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var _y=/\/+/g;function cf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?SA(""+t.key):e.toString(36)}function hd(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Qc:case fA:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+cf(o,0):r,wy(s)?(n="",t!=null&&(n=t.replace(_y,"$&/")+"/"),hd(s,e,n,"",function(u){return u})):s!=null&&(a0(s)&&(s=CA(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(_y,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",wy(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+cf(i,l);o+=hd(i,e,n,c,s)}else if(c=NA(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+cf(i,l++),o+=hd(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ou(t,e,n){if(t==null)return t;var r=[],s=0;return hd(t,r,"","",function(i){return e.call(n,i,s++)}),r}function kA(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Sn={current:null},gd={transition:null},IA={ReactCurrentDispatcher:Sn,ReactCurrentBatchConfig:gd,ReactCurrentOwner:r0};function RN(){throw Error("act(...) is not supported in production builds of React.")}Be.Children={map:Ou,forEach:function(t,e,n){Ou(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ou(t,function(){e++}),e},toArray:function(t){return Ou(t,function(e){return e})||[]},only:function(t){if(!a0(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Be.Component=$o;Be.Fragment=hA;Be.Profiler=vA;Be.PureComponent=t0;Be.StrictMode=gA;Be.Suspense=xA;Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IA;Be.act=RN;Be.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=SN({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=r0.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)TN.call(e,c)&&!AN.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Qc,type:t.type,key:s,ref:i,props:r,_owner:o}};Be.createContext=function(t){return t={$$typeof:yA,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:bA,_context:t},t.Consumer=t};Be.createElement=PN;Be.createFactory=function(t){var e=PN.bind(null,t);return e.type=t,e};Be.createRef=function(){return{current:null}};Be.forwardRef=function(t){return{$$typeof:EA,render:t}};Be.isValidElement=a0;Be.lazy=function(t){return{$$typeof:_A,_payload:{_status:-1,_result:t},_init:kA}};Be.memo=function(t,e){return{$$typeof:wA,type:t,compare:e===void 0?null:e}};Be.startTransition=function(t){var e=gd.transition;gd.transition={};try{t()}finally{gd.transition=e}};Be.unstable_act=RN;Be.useCallback=function(t,e){return Sn.current.useCallback(t,e)};Be.useContext=function(t){return Sn.current.useContext(t)};Be.useDebugValue=function(){};Be.useDeferredValue=function(t){return Sn.current.useDeferredValue(t)};Be.useEffect=function(t,e){return Sn.current.useEffect(t,e)};Be.useId=function(){return Sn.current.useId()};Be.useImperativeHandle=function(t,e,n){return Sn.current.useImperativeHandle(t,e,n)};Be.useInsertionEffect=function(t,e){return Sn.current.useInsertionEffect(t,e)};Be.useLayoutEffect=function(t,e){return Sn.current.useLayoutEffect(t,e)};Be.useMemo=function(t,e){return Sn.current.useMemo(t,e)};Be.useReducer=function(t,e,n){return Sn.current.useReducer(t,e,n)};Be.useRef=function(t){return Sn.current.useRef(t)};Be.useState=function(t){return Sn.current.useState(t)};Be.useSyncExternalStore=function(t,e,n){return Sn.current.useSyncExternalStore(t,e,n)};Be.useTransition=function(){return Sn.current.useTransition()};Be.version="18.3.1";NN.exports=Be;var p=NN.exports;const a=e0(p);var gh={},LN={exports:{}},Jn={},DN={exports:{}},MN={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,z){var G=V.length;V.push(z);e:for(;0<G;){var Y=G-1>>>1,Z=V[Y];if(0<s(Z,z))V[Y]=z,V[G]=Z,G=Y;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var z=V[0],G=V.pop();if(G!==z){V[0]=G;e:for(var Y=0,Z=V.length,H=Z>>>1;Y<H;){var oe=2*(Y+1)-1,W=V[oe],he=oe+1,xe=V[he];if(0>s(W,G))he<Z&&0>s(xe,W)?(V[Y]=xe,V[he]=G,Y=he):(V[Y]=W,V[oe]=G,Y=oe);else if(he<Z&&0>s(xe,G))V[Y]=xe,V[he]=G,Y=he;else break e}}return z}function s(V,z){var G=V.sortIndex-z.sortIndex;return G!==0?G:V.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,g=3,v=!1,x=!1,E=!1,y=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(V){for(var z=n(u);z!==null;){if(z.callback===null)r(u);else if(z.startTime<=V)r(u),z.sortIndex=z.expirationTime,e(c,z);else break;z=n(u)}}function k(V){if(E=!1,T(V),!x)if(n(c)!==null)x=!0,D(_);else{var z=n(u);z!==null&&j(k,z.startTime-V)}}function _(V,z){x=!1,E&&(E=!1,h(b),b=-1),v=!0;var G=g;try{for(T(z),f=n(c);f!==null&&(!(f.expirationTime>z)||V&&!R());){var Y=f.callback;if(typeof Y=="function"){f.callback=null,g=f.priorityLevel;var Z=Y(f.expirationTime<=z);z=t.unstable_now(),typeof Z=="function"?f.callback=Z:f===n(c)&&r(c),T(z)}else r(c);f=n(c)}if(f!==null)var H=!0;else{var oe=n(u);oe!==null&&j(k,oe.startTime-z),H=!1}return H}finally{f=null,g=G,v=!1}}var S=!1,N=null,b=-1,w=5,A=-1;function R(){return!(t.unstable_now()-A<w)}function L(){if(N!==null){var V=t.unstable_now();A=V;var z=!0;try{z=N(!0,V)}finally{z?M():(S=!1,N=null)}}else S=!1}var M;if(typeof C=="function")M=function(){C(L)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,U=F.port2;F.port1.onmessage=L,M=function(){U.postMessage(null)}}else M=function(){y(L,0)};function D(V){N=V,S||(S=!0,M())}function j(V,z){b=y(function(){V(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){x||v||(x=!0,D(_))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(V){switch(g){case 1:case 2:case 3:var z=3;break;default:z=g}var G=g;g=z;try{return V()}finally{g=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,z){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var G=g;g=V;try{return z()}finally{g=G}},t.unstable_scheduleCallback=function(V,z,G){var Y=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?Y+G:Y):G=Y,V){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=G+Z,V={id:d++,callback:z,priorityLevel:V,startTime:G,expirationTime:Z,sortIndex:-1},G>Y?(V.sortIndex=G,e(u,V),n(c)===null&&V===n(u)&&(E?(h(b),b=-1):E=!0,j(k,G-Y))):(V.sortIndex=Z,e(c,V),x||v||(x=!0,D(_))),V},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(V){var z=g;return function(){var G=g;g=z;try{return V.apply(this,arguments)}finally{g=G}}}})(MN);DN.exports=MN;var TA=DN.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AA=p,Kn=TA;function se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ON=new Set,dc={};function vi(t,e){vo(t,e),vo(t+"Capture",e)}function vo(t,e){for(dc[t]=e,t=0;t<e.length;t++)ON.add(e[t])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vh=Object.prototype.hasOwnProperty,PA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ny={},Cy={};function RA(t){return vh.call(Cy,t)?!0:vh.call(Ny,t)?!1:PA.test(t)?Cy[t]=!0:(Ny[t]=!0,!1)}function LA(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function DA(t,e,n,r){if(e===null||typeof e>"u"||LA(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function kn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ln={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ln[t]=new kn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ln[e]=new kn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ln[t]=new kn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ln[t]=new kn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ln[t]=new kn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ln[t]=new kn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ln[t]=new kn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ln[t]=new kn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ln[t]=new kn(t,5,!1,t.toLowerCase(),null,!1,!1)});var s0=/[\-:]([a-z])/g;function i0(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(s0,i0);ln[e]=new kn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(s0,i0);ln[e]=new kn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(s0,i0);ln[e]=new kn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ln[t]=new kn(t,1,!1,t.toLowerCase(),null,!1,!1)});ln.xlinkHref=new kn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ln[t]=new kn(t,1,!1,t.toLowerCase(),null,!0,!0)});function o0(t,e,n,r){var s=ln.hasOwnProperty(e)?ln[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(DA(e,n,s,r)&&(n=null),r||s===null?RA(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ha=AA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vu=Symbol.for("react.element"),qi=Symbol.for("react.portal"),Wi=Symbol.for("react.fragment"),l0=Symbol.for("react.strict_mode"),bh=Symbol.for("react.profiler"),VN=Symbol.for("react.provider"),jN=Symbol.for("react.context"),c0=Symbol.for("react.forward_ref"),yh=Symbol.for("react.suspense"),Eh=Symbol.for("react.suspense_list"),u0=Symbol.for("react.memo"),La=Symbol.for("react.lazy"),FN=Symbol.for("react.offscreen"),Sy=Symbol.iterator;function El(t){return t===null||typeof t!="object"?null:(t=Sy&&t[Sy]||t["@@iterator"],typeof t=="function"?t:null)}var Ct=Object.assign,uf;function jl(t){if(uf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);uf=e&&e[1]||""}return`
`+uf+t}var df=!1;function mf(t,e){if(!t||df)return"";df=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{df=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?jl(t):""}function MA(t){switch(t.tag){case 5:return jl(t.type);case 16:return jl("Lazy");case 13:return jl("Suspense");case 19:return jl("SuspenseList");case 0:case 2:case 15:return t=mf(t.type,!1),t;case 11:return t=mf(t.type.render,!1),t;case 1:return t=mf(t.type,!0),t;default:return""}}function xh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Wi:return"Fragment";case qi:return"Portal";case bh:return"Profiler";case l0:return"StrictMode";case yh:return"Suspense";case Eh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case jN:return(t.displayName||"Context")+".Consumer";case VN:return(t._context.displayName||"Context")+".Provider";case c0:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case u0:return e=t.displayName||null,e!==null?e:xh(t.type)||"Memo";case La:e=t._payload,t=t._init;try{return xh(t(e))}catch{}}return null}function OA(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return xh(e);case 8:return e===l0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function as(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function zN(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function VA(t){var e=zN(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ju(t){t._valueTracker||(t._valueTracker=VA(t))}function UN(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=zN(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function $d(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function wh(t,e){var n=e.checked;return Ct({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ky(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=as(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function $N(t,e){e=e.checked,e!=null&&o0(t,"checked",e,!1)}function _h(t,e){$N(t,e);var n=as(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Nh(t,e.type,n):e.hasOwnProperty("defaultValue")&&Nh(t,e.type,as(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Iy(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Nh(t,e,n){(e!=="number"||$d(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Fl=Array.isArray;function ao(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+as(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Ch(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(se(91));return Ct({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ty(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(se(92));if(Fl(n)){if(1<n.length)throw Error(se(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:as(n)}}function BN(t,e){var n=as(e.value),r=as(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Ay(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function qN(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Sh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?qN(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Fu,WN=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Fu=Fu||document.createElement("div"),Fu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Fu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function mc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Kl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jA=["Webkit","ms","Moz","O"];Object.keys(Kl).forEach(function(t){jA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Kl[e]=Kl[t]})});function HN(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Kl.hasOwnProperty(t)&&Kl[t]?(""+e).trim():e+"px"}function GN(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=HN(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var FA=Ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kh(t,e){if(e){if(FA[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(se(62))}}function Ih(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Th=null;function d0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ah=null,so=null,io=null;function Py(t){if(t=Zc(t)){if(typeof Ah!="function")throw Error(se(280));var e=t.stateNode;e&&(e=np(e),Ah(t.stateNode,t.type,e))}}function KN(t){so?io?io.push(t):io=[t]:so=t}function QN(){if(so){var t=so,e=io;if(io=so=null,Py(t),e)for(t=0;t<e.length;t++)Py(e[t])}}function JN(t,e){return t(e)}function YN(){}var pf=!1;function ZN(t,e,n){if(pf)return t(e,n);pf=!0;try{return JN(t,e,n)}finally{pf=!1,(so!==null||io!==null)&&(YN(),QN())}}function pc(t,e){var n=t.stateNode;if(n===null)return null;var r=np(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(se(231,e,typeof n));return n}var Ph=!1;if(ia)try{var xl={};Object.defineProperty(xl,"passive",{get:function(){Ph=!0}}),window.addEventListener("test",xl,xl),window.removeEventListener("test",xl,xl)}catch{Ph=!1}function zA(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Ql=!1,Bd=null,qd=!1,Rh=null,UA={onError:function(t){Ql=!0,Bd=t}};function $A(t,e,n,r,s,i,o,l,c){Ql=!1,Bd=null,zA.apply(UA,arguments)}function BA(t,e,n,r,s,i,o,l,c){if($A.apply(this,arguments),Ql){if(Ql){var u=Bd;Ql=!1,Bd=null}else throw Error(se(198));qd||(qd=!0,Rh=u)}}function bi(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function XN(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ry(t){if(bi(t)!==t)throw Error(se(188))}function qA(t){var e=t.alternate;if(!e){if(e=bi(t),e===null)throw Error(se(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Ry(s),t;if(i===r)return Ry(s),e;i=i.sibling}throw Error(se(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(se(189))}}if(n.alternate!==r)throw Error(se(190))}if(n.tag!==3)throw Error(se(188));return n.stateNode.current===n?t:e}function e1(t){return t=qA(t),t!==null?t1(t):null}function t1(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=t1(t);if(e!==null)return e;t=t.sibling}return null}var n1=Kn.unstable_scheduleCallback,Ly=Kn.unstable_cancelCallback,WA=Kn.unstable_shouldYield,HA=Kn.unstable_requestPaint,Rt=Kn.unstable_now,GA=Kn.unstable_getCurrentPriorityLevel,m0=Kn.unstable_ImmediatePriority,r1=Kn.unstable_UserBlockingPriority,Wd=Kn.unstable_NormalPriority,KA=Kn.unstable_LowPriority,a1=Kn.unstable_IdlePriority,Zm=null,Mr=null;function QA(t){if(Mr&&typeof Mr.onCommitFiberRoot=="function")try{Mr.onCommitFiberRoot(Zm,t,void 0,(t.current.flags&128)===128)}catch{}}var hr=Math.clz32?Math.clz32:ZA,JA=Math.log,YA=Math.LN2;function ZA(t){return t>>>=0,t===0?32:31-(JA(t)/YA|0)|0}var zu=64,Uu=4194304;function zl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Hd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=zl(l):(i&=o,i!==0&&(r=zl(i)))}else o=n&~s,o!==0?r=zl(o):i!==0&&(r=zl(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-hr(e),s=1<<n,r|=t[n],e&=~s;return r}function XA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function eP(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-hr(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=XA(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function Lh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function s1(){var t=zu;return zu<<=1,!(zu&4194240)&&(zu=64),t}function ff(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Jc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-hr(e),t[e]=n}function tP(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-hr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function p0(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-hr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var nt=0;function i1(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var o1,f0,l1,c1,u1,Dh=!1,$u=[],Qa=null,Ja=null,Ya=null,fc=new Map,hc=new Map,Oa=[],nP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dy(t,e){switch(t){case"focusin":case"focusout":Qa=null;break;case"dragenter":case"dragleave":Ja=null;break;case"mouseover":case"mouseout":Ya=null;break;case"pointerover":case"pointerout":fc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":hc.delete(e.pointerId)}}function wl(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Zc(e),e!==null&&f0(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function rP(t,e,n,r,s){switch(e){case"focusin":return Qa=wl(Qa,t,e,n,r,s),!0;case"dragenter":return Ja=wl(Ja,t,e,n,r,s),!0;case"mouseover":return Ya=wl(Ya,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return fc.set(i,wl(fc.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,hc.set(i,wl(hc.get(i)||null,t,e,n,r,s)),!0}return!1}function d1(t){var e=zs(t.target);if(e!==null){var n=bi(e);if(n!==null){if(e=n.tag,e===13){if(e=XN(n),e!==null){t.blockedOn=e,u1(t.priority,function(){l1(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function vd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Mh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Th=r,n.target.dispatchEvent(r),Th=null}else return e=Zc(n),e!==null&&f0(e),t.blockedOn=n,!1;e.shift()}return!0}function My(t,e,n){vd(t)&&n.delete(e)}function aP(){Dh=!1,Qa!==null&&vd(Qa)&&(Qa=null),Ja!==null&&vd(Ja)&&(Ja=null),Ya!==null&&vd(Ya)&&(Ya=null),fc.forEach(My),hc.forEach(My)}function _l(t,e){t.blockedOn===e&&(t.blockedOn=null,Dh||(Dh=!0,Kn.unstable_scheduleCallback(Kn.unstable_NormalPriority,aP)))}function gc(t){function e(s){return _l(s,t)}if(0<$u.length){_l($u[0],t);for(var n=1;n<$u.length;n++){var r=$u[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Qa!==null&&_l(Qa,t),Ja!==null&&_l(Ja,t),Ya!==null&&_l(Ya,t),fc.forEach(e),hc.forEach(e),n=0;n<Oa.length;n++)r=Oa[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Oa.length&&(n=Oa[0],n.blockedOn===null);)d1(n),n.blockedOn===null&&Oa.shift()}var oo=ha.ReactCurrentBatchConfig,Gd=!0;function sP(t,e,n,r){var s=nt,i=oo.transition;oo.transition=null;try{nt=1,h0(t,e,n,r)}finally{nt=s,oo.transition=i}}function iP(t,e,n,r){var s=nt,i=oo.transition;oo.transition=null;try{nt=4,h0(t,e,n,r)}finally{nt=s,oo.transition=i}}function h0(t,e,n,r){if(Gd){var s=Mh(t,e,n,r);if(s===null)Nf(t,e,r,Kd,n),Dy(t,r);else if(rP(s,t,e,n,r))r.stopPropagation();else if(Dy(t,r),e&4&&-1<nP.indexOf(t)){for(;s!==null;){var i=Zc(s);if(i!==null&&o1(i),i=Mh(t,e,n,r),i===null&&Nf(t,e,r,Kd,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Nf(t,e,r,null,n)}}var Kd=null;function Mh(t,e,n,r){if(Kd=null,t=d0(r),t=zs(t),t!==null)if(e=bi(t),e===null)t=null;else if(n=e.tag,n===13){if(t=XN(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Kd=t,null}function m1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(GA()){case m0:return 1;case r1:return 4;case Wd:case KA:return 16;case a1:return 536870912;default:return 16}default:return 16}}var Ha=null,g0=null,bd=null;function p1(){if(bd)return bd;var t,e=g0,n=e.length,r,s="value"in Ha?Ha.value:Ha.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return bd=s.slice(t,1<r?1-r:void 0)}function yd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Bu(){return!0}function Oy(){return!1}function Yn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Bu:Oy,this.isPropagationStopped=Oy,this}return Ct(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Bu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Bu)},persist:function(){},isPersistent:Bu}),e}var Bo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},v0=Yn(Bo),Yc=Ct({},Bo,{view:0,detail:0}),oP=Yn(Yc),hf,gf,Nl,Xm=Ct({},Yc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:b0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Nl&&(Nl&&t.type==="mousemove"?(hf=t.screenX-Nl.screenX,gf=t.screenY-Nl.screenY):gf=hf=0,Nl=t),hf)},movementY:function(t){return"movementY"in t?t.movementY:gf}}),Vy=Yn(Xm),lP=Ct({},Xm,{dataTransfer:0}),cP=Yn(lP),uP=Ct({},Yc,{relatedTarget:0}),vf=Yn(uP),dP=Ct({},Bo,{animationName:0,elapsedTime:0,pseudoElement:0}),mP=Yn(dP),pP=Ct({},Bo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),fP=Yn(pP),hP=Ct({},Bo,{data:0}),jy=Yn(hP),gP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=bP[t])?!!e[t]:!1}function b0(){return yP}var EP=Ct({},Yc,{key:function(t){if(t.key){var e=gP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=yd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?vP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:b0,charCode:function(t){return t.type==="keypress"?yd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?yd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),xP=Yn(EP),wP=Ct({},Xm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fy=Yn(wP),_P=Ct({},Yc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:b0}),NP=Yn(_P),CP=Ct({},Bo,{propertyName:0,elapsedTime:0,pseudoElement:0}),SP=Yn(CP),kP=Ct({},Xm,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),IP=Yn(kP),TP=[9,13,27,32],y0=ia&&"CompositionEvent"in window,Jl=null;ia&&"documentMode"in document&&(Jl=document.documentMode);var AP=ia&&"TextEvent"in window&&!Jl,f1=ia&&(!y0||Jl&&8<Jl&&11>=Jl),zy=String.fromCharCode(32),Uy=!1;function h1(t,e){switch(t){case"keyup":return TP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function g1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Hi=!1;function PP(t,e){switch(t){case"compositionend":return g1(e);case"keypress":return e.which!==32?null:(Uy=!0,zy);case"textInput":return t=e.data,t===zy&&Uy?null:t;default:return null}}function RP(t,e){if(Hi)return t==="compositionend"||!y0&&h1(t,e)?(t=p1(),bd=g0=Ha=null,Hi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return f1&&e.locale!=="ko"?null:e.data;default:return null}}var LP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $y(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!LP[t.type]:e==="textarea"}function v1(t,e,n,r){KN(r),e=Qd(e,"onChange"),0<e.length&&(n=new v0("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Yl=null,vc=null;function DP(t){I1(t,0)}function ep(t){var e=Qi(t);if(UN(e))return t}function MP(t,e){if(t==="change")return e}var b1=!1;if(ia){var bf;if(ia){var yf="oninput"in document;if(!yf){var By=document.createElement("div");By.setAttribute("oninput","return;"),yf=typeof By.oninput=="function"}bf=yf}else bf=!1;b1=bf&&(!document.documentMode||9<document.documentMode)}function qy(){Yl&&(Yl.detachEvent("onpropertychange",y1),vc=Yl=null)}function y1(t){if(t.propertyName==="value"&&ep(vc)){var e=[];v1(e,vc,t,d0(t)),ZN(DP,e)}}function OP(t,e,n){t==="focusin"?(qy(),Yl=e,vc=n,Yl.attachEvent("onpropertychange",y1)):t==="focusout"&&qy()}function VP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ep(vc)}function jP(t,e){if(t==="click")return ep(e)}function FP(t,e){if(t==="input"||t==="change")return ep(e)}function zP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var vr=typeof Object.is=="function"?Object.is:zP;function bc(t,e){if(vr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!vh.call(e,s)||!vr(t[s],e[s]))return!1}return!0}function Wy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Hy(t,e){var n=Wy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Wy(n)}}function E1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?E1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function x1(){for(var t=window,e=$d();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=$d(t.document)}return e}function E0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function UP(t){var e=x1(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&E1(n.ownerDocument.documentElement,n)){if(r!==null&&E0(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Hy(n,i);var o=Hy(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var $P=ia&&"documentMode"in document&&11>=document.documentMode,Gi=null,Oh=null,Zl=null,Vh=!1;function Gy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Vh||Gi==null||Gi!==$d(r)||(r=Gi,"selectionStart"in r&&E0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Zl&&bc(Zl,r)||(Zl=r,r=Qd(Oh,"onSelect"),0<r.length&&(e=new v0("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Gi)))}function qu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ki={animationend:qu("Animation","AnimationEnd"),animationiteration:qu("Animation","AnimationIteration"),animationstart:qu("Animation","AnimationStart"),transitionend:qu("Transition","TransitionEnd")},Ef={},w1={};ia&&(w1=document.createElement("div").style,"AnimationEvent"in window||(delete Ki.animationend.animation,delete Ki.animationiteration.animation,delete Ki.animationstart.animation),"TransitionEvent"in window||delete Ki.transitionend.transition);function tp(t){if(Ef[t])return Ef[t];if(!Ki[t])return t;var e=Ki[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in w1)return Ef[t]=e[n];return t}var _1=tp("animationend"),N1=tp("animationiteration"),C1=tp("animationstart"),S1=tp("transitionend"),k1=new Map,Ky="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fs(t,e){k1.set(t,e),vi(e,[t])}for(var xf=0;xf<Ky.length;xf++){var wf=Ky[xf],BP=wf.toLowerCase(),qP=wf[0].toUpperCase()+wf.slice(1);fs(BP,"on"+qP)}fs(_1,"onAnimationEnd");fs(N1,"onAnimationIteration");fs(C1,"onAnimationStart");fs("dblclick","onDoubleClick");fs("focusin","onFocus");fs("focusout","onBlur");fs(S1,"onTransitionEnd");vo("onMouseEnter",["mouseout","mouseover"]);vo("onMouseLeave",["mouseout","mouseover"]);vo("onPointerEnter",["pointerout","pointerover"]);vo("onPointerLeave",["pointerout","pointerover"]);vi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vi("onBeforeInput",["compositionend","keypress","textInput","paste"]);vi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ul="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ul));function Qy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,BA(r,e,void 0,t),t.currentTarget=null}function I1(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;Qy(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;Qy(s,l,u),i=c}}}if(qd)throw t=Rh,qd=!1,Rh=null,t}function dt(t,e){var n=e[$h];n===void 0&&(n=e[$h]=new Set);var r=t+"__bubble";n.has(r)||(T1(e,t,2,!1),n.add(r))}function _f(t,e,n){var r=0;e&&(r|=4),T1(n,t,r,e)}var Wu="_reactListening"+Math.random().toString(36).slice(2);function yc(t){if(!t[Wu]){t[Wu]=!0,ON.forEach(function(n){n!=="selectionchange"&&(WP.has(n)||_f(n,!1,t),_f(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Wu]||(e[Wu]=!0,_f("selectionchange",!1,e))}}function T1(t,e,n,r){switch(m1(e)){case 1:var s=sP;break;case 4:s=iP;break;default:s=h0}n=s.bind(null,e,n,t),s=void 0,!Ph||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Nf(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=zs(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}ZN(function(){var u=i,d=d0(n),f=[];e:{var g=k1.get(t);if(g!==void 0){var v=v0,x=t;switch(t){case"keypress":if(yd(n)===0)break e;case"keydown":case"keyup":v=xP;break;case"focusin":x="focus",v=vf;break;case"focusout":x="blur",v=vf;break;case"beforeblur":case"afterblur":v=vf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Vy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=cP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=NP;break;case _1:case N1:case C1:v=mP;break;case S1:v=SP;break;case"scroll":v=oP;break;case"wheel":v=IP;break;case"copy":case"cut":case"paste":v=fP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Fy}var E=(e&4)!==0,y=!E&&t==="scroll",h=E?g!==null?g+"Capture":null:g;E=[];for(var C=u,T;C!==null;){T=C;var k=T.stateNode;if(T.tag===5&&k!==null&&(T=k,h!==null&&(k=pc(C,h),k!=null&&E.push(Ec(C,k,T)))),y)break;C=C.return}0<E.length&&(g=new v(g,x,null,n,d),f.push({event:g,listeners:E}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",g&&n!==Th&&(x=n.relatedTarget||n.fromElement)&&(zs(x)||x[oa]))break e;if((v||g)&&(g=d.window===d?d:(g=d.ownerDocument)?g.defaultView||g.parentWindow:window,v?(x=n.relatedTarget||n.toElement,v=u,x=x?zs(x):null,x!==null&&(y=bi(x),x!==y||x.tag!==5&&x.tag!==6)&&(x=null)):(v=null,x=u),v!==x)){if(E=Vy,k="onMouseLeave",h="onMouseEnter",C="mouse",(t==="pointerout"||t==="pointerover")&&(E=Fy,k="onPointerLeave",h="onPointerEnter",C="pointer"),y=v==null?g:Qi(v),T=x==null?g:Qi(x),g=new E(k,C+"leave",v,n,d),g.target=y,g.relatedTarget=T,k=null,zs(d)===u&&(E=new E(h,C+"enter",x,n,d),E.target=T,E.relatedTarget=y,k=E),y=k,v&&x)t:{for(E=v,h=x,C=0,T=E;T;T=Li(T))C++;for(T=0,k=h;k;k=Li(k))T++;for(;0<C-T;)E=Li(E),C--;for(;0<T-C;)h=Li(h),T--;for(;C--;){if(E===h||h!==null&&E===h.alternate)break t;E=Li(E),h=Li(h)}E=null}else E=null;v!==null&&Jy(f,g,v,E,!1),x!==null&&y!==null&&Jy(f,y,x,E,!0)}}e:{if(g=u?Qi(u):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var _=MP;else if($y(g))if(b1)_=FP;else{_=VP;var S=OP}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(_=jP);if(_&&(_=_(t,u))){v1(f,_,n,d);break e}S&&S(t,g,u),t==="focusout"&&(S=g._wrapperState)&&S.controlled&&g.type==="number"&&Nh(g,"number",g.value)}switch(S=u?Qi(u):window,t){case"focusin":($y(S)||S.contentEditable==="true")&&(Gi=S,Oh=u,Zl=null);break;case"focusout":Zl=Oh=Gi=null;break;case"mousedown":Vh=!0;break;case"contextmenu":case"mouseup":case"dragend":Vh=!1,Gy(f,n,d);break;case"selectionchange":if($P)break;case"keydown":case"keyup":Gy(f,n,d)}var N;if(y0)e:{switch(t){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Hi?h1(t,n)&&(b="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(b="onCompositionStart");b&&(f1&&n.locale!=="ko"&&(Hi||b!=="onCompositionStart"?b==="onCompositionEnd"&&Hi&&(N=p1()):(Ha=d,g0="value"in Ha?Ha.value:Ha.textContent,Hi=!0)),S=Qd(u,b),0<S.length&&(b=new jy(b,t,null,n,d),f.push({event:b,listeners:S}),N?b.data=N:(N=g1(n),N!==null&&(b.data=N)))),(N=AP?PP(t,n):RP(t,n))&&(u=Qd(u,"onBeforeInput"),0<u.length&&(d=new jy("onBeforeInput","beforeinput",null,n,d),f.push({event:d,listeners:u}),d.data=N))}I1(f,e)})}function Ec(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Qd(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=pc(t,n),i!=null&&r.unshift(Ec(t,i,s)),i=pc(t,e),i!=null&&r.push(Ec(t,i,s))),t=t.return}return r}function Li(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Jy(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=pc(n,i),c!=null&&o.unshift(Ec(n,c,l))):s||(c=pc(n,i),c!=null&&o.push(Ec(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var HP=/\r\n?/g,GP=/\u0000|\uFFFD/g;function Yy(t){return(typeof t=="string"?t:""+t).replace(HP,`
`).replace(GP,"")}function Hu(t,e,n){if(e=Yy(e),Yy(t)!==e&&n)throw Error(se(425))}function Jd(){}var jh=null,Fh=null;function zh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Uh=typeof setTimeout=="function"?setTimeout:void 0,KP=typeof clearTimeout=="function"?clearTimeout:void 0,Zy=typeof Promise=="function"?Promise:void 0,QP=typeof queueMicrotask=="function"?queueMicrotask:typeof Zy<"u"?function(t){return Zy.resolve(null).then(t).catch(JP)}:Uh;function JP(t){setTimeout(function(){throw t})}function Cf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),gc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);gc(e)}function Za(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Xy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var qo=Math.random().toString(36).slice(2),Ar="__reactFiber$"+qo,xc="__reactProps$"+qo,oa="__reactContainer$"+qo,$h="__reactEvents$"+qo,YP="__reactListeners$"+qo,ZP="__reactHandles$"+qo;function zs(t){var e=t[Ar];if(e)return e;for(var n=t.parentNode;n;){if(e=n[oa]||n[Ar]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Xy(t);t!==null;){if(n=t[Ar])return n;t=Xy(t)}return e}t=n,n=t.parentNode}return null}function Zc(t){return t=t[Ar]||t[oa],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Qi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(se(33))}function np(t){return t[xc]||null}var Bh=[],Ji=-1;function hs(t){return{current:t}}function pt(t){0>Ji||(t.current=Bh[Ji],Bh[Ji]=null,Ji--)}function lt(t,e){Ji++,Bh[Ji]=t.current,t.current=e}var ss={},En=hs(ss),Mn=hs(!1),Ys=ss;function bo(t,e){var n=t.type.contextTypes;if(!n)return ss;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function On(t){return t=t.childContextTypes,t!=null}function Yd(){pt(Mn),pt(En)}function eE(t,e,n){if(En.current!==ss)throw Error(se(168));lt(En,e),lt(Mn,n)}function A1(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(se(108,OA(t)||"Unknown",s));return Ct({},n,r)}function Zd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ss,Ys=En.current,lt(En,t),lt(Mn,Mn.current),!0}function tE(t,e,n){var r=t.stateNode;if(!r)throw Error(se(169));n?(t=A1(t,e,Ys),r.__reactInternalMemoizedMergedChildContext=t,pt(Mn),pt(En),lt(En,t)):pt(Mn),lt(Mn,n)}var Kr=null,rp=!1,Sf=!1;function P1(t){Kr===null?Kr=[t]:Kr.push(t)}function XP(t){rp=!0,P1(t)}function gs(){if(!Sf&&Kr!==null){Sf=!0;var t=0,e=nt;try{var n=Kr;for(nt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Kr=null,rp=!1}catch(s){throw Kr!==null&&(Kr=Kr.slice(t+1)),n1(m0,gs),s}finally{nt=e,Sf=!1}}return null}var Yi=[],Zi=0,Xd=null,em=0,er=[],tr=0,Zs=null,Qr=1,Jr="";function Ps(t,e){Yi[Zi++]=em,Yi[Zi++]=Xd,Xd=t,em=e}function R1(t,e,n){er[tr++]=Qr,er[tr++]=Jr,er[tr++]=Zs,Zs=t;var r=Qr;t=Jr;var s=32-hr(r)-1;r&=~(1<<s),n+=1;var i=32-hr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Qr=1<<32-hr(e)+s|n<<s|r,Jr=i+t}else Qr=1<<i|n<<s|r,Jr=t}function x0(t){t.return!==null&&(Ps(t,1),R1(t,1,0))}function w0(t){for(;t===Xd;)Xd=Yi[--Zi],Yi[Zi]=null,em=Yi[--Zi],Yi[Zi]=null;for(;t===Zs;)Zs=er[--tr],er[tr]=null,Jr=er[--tr],er[tr]=null,Qr=er[--tr],er[tr]=null}var Gn=null,Wn=null,gt=!1,fr=null;function L1(t,e){var n=nr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function nE(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Gn=t,Wn=Za(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Gn=t,Wn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Zs!==null?{id:Qr,overflow:Jr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=nr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Gn=t,Wn=null,!0):!1;default:return!1}}function qh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Wh(t){if(gt){var e=Wn;if(e){var n=e;if(!nE(t,e)){if(qh(t))throw Error(se(418));e=Za(n.nextSibling);var r=Gn;e&&nE(t,e)?L1(r,n):(t.flags=t.flags&-4097|2,gt=!1,Gn=t)}}else{if(qh(t))throw Error(se(418));t.flags=t.flags&-4097|2,gt=!1,Gn=t}}}function rE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Gn=t}function Gu(t){if(t!==Gn)return!1;if(!gt)return rE(t),gt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!zh(t.type,t.memoizedProps)),e&&(e=Wn)){if(qh(t))throw D1(),Error(se(418));for(;e;)L1(t,e),e=Za(e.nextSibling)}if(rE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Wn=Za(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Wn=null}}else Wn=Gn?Za(t.stateNode.nextSibling):null;return!0}function D1(){for(var t=Wn;t;)t=Za(t.nextSibling)}function yo(){Wn=Gn=null,gt=!1}function _0(t){fr===null?fr=[t]:fr.push(t)}var eR=ha.ReactCurrentBatchConfig;function Cl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(se(309));var r=n.stateNode}if(!r)throw Error(se(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(se(284));if(!n._owner)throw Error(se(290,t))}return t}function Ku(t,e){throw t=Object.prototype.toString.call(e),Error(se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function aE(t){var e=t._init;return e(t._payload)}function M1(t){function e(h,C){if(t){var T=h.deletions;T===null?(h.deletions=[C],h.flags|=16):T.push(C)}}function n(h,C){if(!t)return null;for(;C!==null;)e(h,C),C=C.sibling;return null}function r(h,C){for(h=new Map;C!==null;)C.key!==null?h.set(C.key,C):h.set(C.index,C),C=C.sibling;return h}function s(h,C){return h=ns(h,C),h.index=0,h.sibling=null,h}function i(h,C,T){return h.index=T,t?(T=h.alternate,T!==null?(T=T.index,T<C?(h.flags|=2,C):T):(h.flags|=2,C)):(h.flags|=1048576,C)}function o(h){return t&&h.alternate===null&&(h.flags|=2),h}function l(h,C,T,k){return C===null||C.tag!==6?(C=Lf(T,h.mode,k),C.return=h,C):(C=s(C,T),C.return=h,C)}function c(h,C,T,k){var _=T.type;return _===Wi?d(h,C,T.props.children,k,T.key):C!==null&&(C.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===La&&aE(_)===C.type)?(k=s(C,T.props),k.ref=Cl(h,C,T),k.return=h,k):(k=Sd(T.type,T.key,T.props,null,h.mode,k),k.ref=Cl(h,C,T),k.return=h,k)}function u(h,C,T,k){return C===null||C.tag!==4||C.stateNode.containerInfo!==T.containerInfo||C.stateNode.implementation!==T.implementation?(C=Df(T,h.mode,k),C.return=h,C):(C=s(C,T.children||[]),C.return=h,C)}function d(h,C,T,k,_){return C===null||C.tag!==7?(C=Gs(T,h.mode,k,_),C.return=h,C):(C=s(C,T),C.return=h,C)}function f(h,C,T){if(typeof C=="string"&&C!==""||typeof C=="number")return C=Lf(""+C,h.mode,T),C.return=h,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Vu:return T=Sd(C.type,C.key,C.props,null,h.mode,T),T.ref=Cl(h,null,C),T.return=h,T;case qi:return C=Df(C,h.mode,T),C.return=h,C;case La:var k=C._init;return f(h,k(C._payload),T)}if(Fl(C)||El(C))return C=Gs(C,h.mode,T,null),C.return=h,C;Ku(h,C)}return null}function g(h,C,T,k){var _=C!==null?C.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return _!==null?null:l(h,C,""+T,k);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Vu:return T.key===_?c(h,C,T,k):null;case qi:return T.key===_?u(h,C,T,k):null;case La:return _=T._init,g(h,C,_(T._payload),k)}if(Fl(T)||El(T))return _!==null?null:d(h,C,T,k,null);Ku(h,T)}return null}function v(h,C,T,k,_){if(typeof k=="string"&&k!==""||typeof k=="number")return h=h.get(T)||null,l(C,h,""+k,_);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Vu:return h=h.get(k.key===null?T:k.key)||null,c(C,h,k,_);case qi:return h=h.get(k.key===null?T:k.key)||null,u(C,h,k,_);case La:var S=k._init;return v(h,C,T,S(k._payload),_)}if(Fl(k)||El(k))return h=h.get(T)||null,d(C,h,k,_,null);Ku(C,k)}return null}function x(h,C,T,k){for(var _=null,S=null,N=C,b=C=0,w=null;N!==null&&b<T.length;b++){N.index>b?(w=N,N=null):w=N.sibling;var A=g(h,N,T[b],k);if(A===null){N===null&&(N=w);break}t&&N&&A.alternate===null&&e(h,N),C=i(A,C,b),S===null?_=A:S.sibling=A,S=A,N=w}if(b===T.length)return n(h,N),gt&&Ps(h,b),_;if(N===null){for(;b<T.length;b++)N=f(h,T[b],k),N!==null&&(C=i(N,C,b),S===null?_=N:S.sibling=N,S=N);return gt&&Ps(h,b),_}for(N=r(h,N);b<T.length;b++)w=v(N,h,b,T[b],k),w!==null&&(t&&w.alternate!==null&&N.delete(w.key===null?b:w.key),C=i(w,C,b),S===null?_=w:S.sibling=w,S=w);return t&&N.forEach(function(R){return e(h,R)}),gt&&Ps(h,b),_}function E(h,C,T,k){var _=El(T);if(typeof _!="function")throw Error(se(150));if(T=_.call(T),T==null)throw Error(se(151));for(var S=_=null,N=C,b=C=0,w=null,A=T.next();N!==null&&!A.done;b++,A=T.next()){N.index>b?(w=N,N=null):w=N.sibling;var R=g(h,N,A.value,k);if(R===null){N===null&&(N=w);break}t&&N&&R.alternate===null&&e(h,N),C=i(R,C,b),S===null?_=R:S.sibling=R,S=R,N=w}if(A.done)return n(h,N),gt&&Ps(h,b),_;if(N===null){for(;!A.done;b++,A=T.next())A=f(h,A.value,k),A!==null&&(C=i(A,C,b),S===null?_=A:S.sibling=A,S=A);return gt&&Ps(h,b),_}for(N=r(h,N);!A.done;b++,A=T.next())A=v(N,h,b,A.value,k),A!==null&&(t&&A.alternate!==null&&N.delete(A.key===null?b:A.key),C=i(A,C,b),S===null?_=A:S.sibling=A,S=A);return t&&N.forEach(function(L){return e(h,L)}),gt&&Ps(h,b),_}function y(h,C,T,k){if(typeof T=="object"&&T!==null&&T.type===Wi&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Vu:e:{for(var _=T.key,S=C;S!==null;){if(S.key===_){if(_=T.type,_===Wi){if(S.tag===7){n(h,S.sibling),C=s(S,T.props.children),C.return=h,h=C;break e}}else if(S.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===La&&aE(_)===S.type){n(h,S.sibling),C=s(S,T.props),C.ref=Cl(h,S,T),C.return=h,h=C;break e}n(h,S);break}else e(h,S);S=S.sibling}T.type===Wi?(C=Gs(T.props.children,h.mode,k,T.key),C.return=h,h=C):(k=Sd(T.type,T.key,T.props,null,h.mode,k),k.ref=Cl(h,C,T),k.return=h,h=k)}return o(h);case qi:e:{for(S=T.key;C!==null;){if(C.key===S)if(C.tag===4&&C.stateNode.containerInfo===T.containerInfo&&C.stateNode.implementation===T.implementation){n(h,C.sibling),C=s(C,T.children||[]),C.return=h,h=C;break e}else{n(h,C);break}else e(h,C);C=C.sibling}C=Df(T,h.mode,k),C.return=h,h=C}return o(h);case La:return S=T._init,y(h,C,S(T._payload),k)}if(Fl(T))return x(h,C,T,k);if(El(T))return E(h,C,T,k);Ku(h,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,C!==null&&C.tag===6?(n(h,C.sibling),C=s(C,T),C.return=h,h=C):(n(h,C),C=Lf(T,h.mode,k),C.return=h,h=C),o(h)):n(h,C)}return y}var Eo=M1(!0),O1=M1(!1),tm=hs(null),nm=null,Xi=null,N0=null;function C0(){N0=Xi=nm=null}function S0(t){var e=tm.current;pt(tm),t._currentValue=e}function Hh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function lo(t,e){nm=t,N0=Xi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Pn=!0),t.firstContext=null)}function ar(t){var e=t._currentValue;if(N0!==t)if(t={context:t,memoizedValue:e,next:null},Xi===null){if(nm===null)throw Error(se(308));Xi=t,nm.dependencies={lanes:0,firstContext:t}}else Xi=Xi.next=t;return e}var Us=null;function k0(t){Us===null?Us=[t]:Us.push(t)}function V1(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,k0(e)):(n.next=s.next,s.next=n),e.interleaved=n,la(t,r)}function la(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Da=!1;function I0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function j1(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ta(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Xa(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ye&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,la(t,n)}return s=r.interleaved,s===null?(e.next=e,k0(r)):(e.next=s.next,s.next=e),r.interleaved=e,la(t,n)}function Ed(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,p0(t,n)}}function sE(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function rm(t,e,n,r){var s=t.updateQueue;Da=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;o=0,d=u=c=null,l=i;do{var g=l.lane,v=l.eventTime;if((r&g)===g){d!==null&&(d=d.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=t,E=l;switch(g=e,v=n,E.tag){case 1:if(x=E.payload,typeof x=="function"){f=x.call(v,f,g);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=E.payload,g=typeof x=="function"?x.call(v,f,g):x,g==null)break e;f=Ct({},f,g);break e;case 2:Da=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[l]:g.push(l))}else v={eventTime:v,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=v,c=f):d=d.next=v,o|=g;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;g=l,l=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(1);if(d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ei|=o,t.lanes=o,t.memoizedState=f}}function iE(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(se(191,s));s.call(r)}}}var Xc={},Or=hs(Xc),wc=hs(Xc),_c=hs(Xc);function $s(t){if(t===Xc)throw Error(se(174));return t}function T0(t,e){switch(lt(_c,e),lt(wc,t),lt(Or,Xc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Sh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Sh(e,t)}pt(Or),lt(Or,e)}function xo(){pt(Or),pt(wc),pt(_c)}function F1(t){$s(_c.current);var e=$s(Or.current),n=Sh(e,t.type);e!==n&&(lt(wc,t),lt(Or,n))}function A0(t){wc.current===t&&(pt(Or),pt(wc))}var wt=hs(0);function am(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var kf=[];function P0(){for(var t=0;t<kf.length;t++)kf[t]._workInProgressVersionPrimary=null;kf.length=0}var xd=ha.ReactCurrentDispatcher,If=ha.ReactCurrentBatchConfig,Xs=0,_t=null,Bt=null,Yt=null,sm=!1,Xl=!1,Nc=0,tR=0;function mn(){throw Error(se(321))}function R0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!vr(t[n],e[n]))return!1;return!0}function L0(t,e,n,r,s,i){if(Xs=i,_t=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,xd.current=t===null||t.memoizedState===null?sR:iR,t=n(r,s),Xl){i=0;do{if(Xl=!1,Nc=0,25<=i)throw Error(se(301));i+=1,Yt=Bt=null,e.updateQueue=null,xd.current=oR,t=n(r,s)}while(Xl)}if(xd.current=im,e=Bt!==null&&Bt.next!==null,Xs=0,Yt=Bt=_t=null,sm=!1,e)throw Error(se(300));return t}function D0(){var t=Nc!==0;return Nc=0,t}function Tr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?_t.memoizedState=Yt=t:Yt=Yt.next=t,Yt}function sr(){if(Bt===null){var t=_t.alternate;t=t!==null?t.memoizedState:null}else t=Bt.next;var e=Yt===null?_t.memoizedState:Yt.next;if(e!==null)Yt=e,Bt=t;else{if(t===null)throw Error(se(310));Bt=t,t={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},Yt===null?_t.memoizedState=Yt=t:Yt=Yt.next=t}return Yt}function Cc(t,e){return typeof e=="function"?e(t):e}function Tf(t){var e=sr(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=Bt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((Xs&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=r):c=c.next=f,_t.lanes|=d,ei|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,vr(r,e.memoizedState)||(Pn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,_t.lanes|=i,ei|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Af(t){var e=sr(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);vr(i,e.memoizedState)||(Pn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function z1(){}function U1(t,e){var n=_t,r=sr(),s=e(),i=!vr(r.memoizedState,s);if(i&&(r.memoizedState=s,Pn=!0),r=r.queue,M0(q1.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Yt!==null&&Yt.memoizedState.tag&1){if(n.flags|=2048,Sc(9,B1.bind(null,n,r,s,e),void 0,null),Xt===null)throw Error(se(349));Xs&30||$1(n,e,s)}return s}function $1(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=_t.updateQueue,e===null?(e={lastEffect:null,stores:null},_t.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function B1(t,e,n,r){e.value=n,e.getSnapshot=r,W1(e)&&H1(t)}function q1(t,e,n){return n(function(){W1(e)&&H1(t)})}function W1(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!vr(t,n)}catch{return!0}}function H1(t){var e=la(t,1);e!==null&&gr(e,t,1,-1)}function oE(t){var e=Tr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Cc,lastRenderedState:t},e.queue=t,t=t.dispatch=aR.bind(null,_t,t),[e.memoizedState,t]}function Sc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=_t.updateQueue,e===null?(e={lastEffect:null,stores:null},_t.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function G1(){return sr().memoizedState}function wd(t,e,n,r){var s=Tr();_t.flags|=t,s.memoizedState=Sc(1|e,n,void 0,r===void 0?null:r)}function ap(t,e,n,r){var s=sr();r=r===void 0?null:r;var i=void 0;if(Bt!==null){var o=Bt.memoizedState;if(i=o.destroy,r!==null&&R0(r,o.deps)){s.memoizedState=Sc(e,n,i,r);return}}_t.flags|=t,s.memoizedState=Sc(1|e,n,i,r)}function lE(t,e){return wd(8390656,8,t,e)}function M0(t,e){return ap(2048,8,t,e)}function K1(t,e){return ap(4,2,t,e)}function Q1(t,e){return ap(4,4,t,e)}function J1(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Y1(t,e,n){return n=n!=null?n.concat([t]):null,ap(4,4,J1.bind(null,e,t),n)}function O0(){}function Z1(t,e){var n=sr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&R0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function X1(t,e){var n=sr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&R0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function eC(t,e,n){return Xs&21?(vr(n,e)||(n=s1(),_t.lanes|=n,ei|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Pn=!0),t.memoizedState=n)}function nR(t,e){var n=nt;nt=n!==0&&4>n?n:4,t(!0);var r=If.transition;If.transition={};try{t(!1),e()}finally{nt=n,If.transition=r}}function tC(){return sr().memoizedState}function rR(t,e,n){var r=ts(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},nC(t))rC(e,n);else if(n=V1(t,e,n,r),n!==null){var s=Cn();gr(n,t,r,s),aC(n,e,r)}}function aR(t,e,n){var r=ts(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(nC(t))rC(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,vr(l,o)){var c=e.interleaved;c===null?(s.next=s,k0(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=V1(t,e,s,r),n!==null&&(s=Cn(),gr(n,t,r,s),aC(n,e,r))}}function nC(t){var e=t.alternate;return t===_t||e!==null&&e===_t}function rC(t,e){Xl=sm=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function aC(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,p0(t,n)}}var im={readContext:ar,useCallback:mn,useContext:mn,useEffect:mn,useImperativeHandle:mn,useInsertionEffect:mn,useLayoutEffect:mn,useMemo:mn,useReducer:mn,useRef:mn,useState:mn,useDebugValue:mn,useDeferredValue:mn,useTransition:mn,useMutableSource:mn,useSyncExternalStore:mn,useId:mn,unstable_isNewReconciler:!1},sR={readContext:ar,useCallback:function(t,e){return Tr().memoizedState=[t,e===void 0?null:e],t},useContext:ar,useEffect:lE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,wd(4194308,4,J1.bind(null,e,t),n)},useLayoutEffect:function(t,e){return wd(4194308,4,t,e)},useInsertionEffect:function(t,e){return wd(4,2,t,e)},useMemo:function(t,e){var n=Tr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Tr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=rR.bind(null,_t,t),[r.memoizedState,t]},useRef:function(t){var e=Tr();return t={current:t},e.memoizedState=t},useState:oE,useDebugValue:O0,useDeferredValue:function(t){return Tr().memoizedState=t},useTransition:function(){var t=oE(!1),e=t[0];return t=nR.bind(null,t[1]),Tr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=_t,s=Tr();if(gt){if(n===void 0)throw Error(se(407));n=n()}else{if(n=e(),Xt===null)throw Error(se(349));Xs&30||$1(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,lE(q1.bind(null,r,i,t),[t]),r.flags|=2048,Sc(9,B1.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Tr(),e=Xt.identifierPrefix;if(gt){var n=Jr,r=Qr;n=(r&~(1<<32-hr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Nc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=tR++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},iR={readContext:ar,useCallback:Z1,useContext:ar,useEffect:M0,useImperativeHandle:Y1,useInsertionEffect:K1,useLayoutEffect:Q1,useMemo:X1,useReducer:Tf,useRef:G1,useState:function(){return Tf(Cc)},useDebugValue:O0,useDeferredValue:function(t){var e=sr();return eC(e,Bt.memoizedState,t)},useTransition:function(){var t=Tf(Cc)[0],e=sr().memoizedState;return[t,e]},useMutableSource:z1,useSyncExternalStore:U1,useId:tC,unstable_isNewReconciler:!1},oR={readContext:ar,useCallback:Z1,useContext:ar,useEffect:M0,useImperativeHandle:Y1,useInsertionEffect:K1,useLayoutEffect:Q1,useMemo:X1,useReducer:Af,useRef:G1,useState:function(){return Af(Cc)},useDebugValue:O0,useDeferredValue:function(t){var e=sr();return Bt===null?e.memoizedState=t:eC(e,Bt.memoizedState,t)},useTransition:function(){var t=Af(Cc)[0],e=sr().memoizedState;return[t,e]},useMutableSource:z1,useSyncExternalStore:U1,useId:tC,unstable_isNewReconciler:!1};function mr(t,e){if(t&&t.defaultProps){e=Ct({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Gh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ct({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var sp={isMounted:function(t){return(t=t._reactInternals)?bi(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Cn(),s=ts(t),i=ta(r,s);i.payload=e,n!=null&&(i.callback=n),e=Xa(t,i,s),e!==null&&(gr(e,t,s,r),Ed(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Cn(),s=ts(t),i=ta(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Xa(t,i,s),e!==null&&(gr(e,t,s,r),Ed(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Cn(),r=ts(t),s=ta(n,r);s.tag=2,e!=null&&(s.callback=e),e=Xa(t,s,r),e!==null&&(gr(e,t,r,n),Ed(e,t,r))}};function cE(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!bc(n,r)||!bc(s,i):!0}function sC(t,e,n){var r=!1,s=ss,i=e.contextType;return typeof i=="object"&&i!==null?i=ar(i):(s=On(e)?Ys:En.current,r=e.contextTypes,i=(r=r!=null)?bo(t,s):ss),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=sp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function uE(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&sp.enqueueReplaceState(e,e.state,null)}function Kh(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},I0(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=ar(i):(i=On(e)?Ys:En.current,s.context=bo(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Gh(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&sp.enqueueReplaceState(s,s.state,null),rm(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function wo(t,e){try{var n="",r=e;do n+=MA(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Pf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Qh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var lR=typeof WeakMap=="function"?WeakMap:Map;function iC(t,e,n){n=ta(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){lm||(lm=!0,sg=r),Qh(t,e)},n}function oC(t,e,n){n=ta(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Qh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Qh(t,e),typeof r!="function"&&(es===null?es=new Set([this]):es.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function dE(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new lR;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=wR.bind(null,t,e,n),e.then(t,t))}function mE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function pE(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ta(-1,1),e.tag=2,Xa(n,e,1))),n.lanes|=1),t)}var cR=ha.ReactCurrentOwner,Pn=!1;function _n(t,e,n,r){e.child=t===null?O1(e,null,n,r):Eo(e,t.child,n,r)}function fE(t,e,n,r,s){n=n.render;var i=e.ref;return lo(e,s),r=L0(t,e,n,r,i,s),n=D0(),t!==null&&!Pn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ca(t,e,s)):(gt&&n&&x0(e),e.flags|=1,_n(t,e,r,s),e.child)}function hE(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!q0(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,lC(t,e,i,r,s)):(t=Sd(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:bc,n(o,r)&&t.ref===e.ref)return ca(t,e,s)}return e.flags|=1,t=ns(i,r),t.ref=e.ref,t.return=e,e.child=t}function lC(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(bc(i,r)&&t.ref===e.ref)if(Pn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Pn=!0);else return e.lanes=t.lanes,ca(t,e,s)}return Jh(t,e,n,r,s)}function cC(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},lt(to,$n),$n|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,lt(to,$n),$n|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,lt(to,$n),$n|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,lt(to,$n),$n|=r;return _n(t,e,s,n),e.child}function uC(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Jh(t,e,n,r,s){var i=On(n)?Ys:En.current;return i=bo(e,i),lo(e,s),n=L0(t,e,n,r,i,s),r=D0(),t!==null&&!Pn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ca(t,e,s)):(gt&&r&&x0(e),e.flags|=1,_n(t,e,n,s),e.child)}function gE(t,e,n,r,s){if(On(n)){var i=!0;Zd(e)}else i=!1;if(lo(e,s),e.stateNode===null)_d(t,e),sC(e,n,r),Kh(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=ar(u):(u=On(n)?Ys:En.current,u=bo(e,u));var d=n.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&uE(e,o,r,u),Da=!1;var g=e.memoizedState;o.state=g,rm(e,r,o,s),c=e.memoizedState,l!==r||g!==c||Mn.current||Da?(typeof d=="function"&&(Gh(e,n,d,r),c=e.memoizedState),(l=Da||cE(e,n,l,r,g,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,j1(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:mr(e.type,l),o.props=u,f=e.pendingProps,g=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=ar(c):(c=On(n)?Ys:En.current,c=bo(e,c));var v=n.getDerivedStateFromProps;(d=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||g!==c)&&uE(e,o,r,c),Da=!1,g=e.memoizedState,o.state=g,rm(e,r,o,s);var x=e.memoizedState;l!==f||g!==x||Mn.current||Da?(typeof v=="function"&&(Gh(e,n,v,r),x=e.memoizedState),(u=Da||cE(e,n,u,r,g,x,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),o.props=r,o.state=x,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return Yh(t,e,n,r,i,s)}function Yh(t,e,n,r,s,i){uC(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&tE(e,n,!1),ca(t,e,i);r=e.stateNode,cR.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Eo(e,t.child,null,i),e.child=Eo(e,null,l,i)):_n(t,e,l,i),e.memoizedState=r.state,s&&tE(e,n,!0),e.child}function dC(t){var e=t.stateNode;e.pendingContext?eE(t,e.pendingContext,e.pendingContext!==e.context):e.context&&eE(t,e.context,!1),T0(t,e.containerInfo)}function vE(t,e,n,r,s){return yo(),_0(s),e.flags|=256,_n(t,e,n,r),e.child}var Zh={dehydrated:null,treeContext:null,retryLane:0};function Xh(t){return{baseLanes:t,cachePool:null,transitions:null}}function mC(t,e,n){var r=e.pendingProps,s=wt.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),lt(wt,s&1),t===null)return Wh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=lp(o,r,0,null),t=Gs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Xh(n),e.memoizedState=Zh,t):V0(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return uR(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=ns(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=ns(l,i):(i=Gs(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Xh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Zh,r}return i=t.child,t=i.sibling,r=ns(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function V0(t,e){return e=lp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Qu(t,e,n,r){return r!==null&&_0(r),Eo(e,t.child,null,n),t=V0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function uR(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Pf(Error(se(422))),Qu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=lp({mode:"visible",children:r.children},s,0,null),i=Gs(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Eo(e,t.child,null,o),e.child.memoizedState=Xh(o),e.memoizedState=Zh,i);if(!(e.mode&1))return Qu(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(se(419)),r=Pf(i,r,void 0),Qu(t,e,o,r)}if(l=(o&t.childLanes)!==0,Pn||l){if(r=Xt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,la(t,s),gr(r,t,s,-1))}return B0(),r=Pf(Error(se(421))),Qu(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=_R.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Wn=Za(s.nextSibling),Gn=e,gt=!0,fr=null,t!==null&&(er[tr++]=Qr,er[tr++]=Jr,er[tr++]=Zs,Qr=t.id,Jr=t.overflow,Zs=e),e=V0(e,r.children),e.flags|=4096,e)}function bE(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Hh(t.return,e,n)}function Rf(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function pC(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(_n(t,e,r.children,n),r=wt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&bE(t,n,e);else if(t.tag===19)bE(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(lt(wt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&am(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Rf(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&am(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Rf(e,!0,n,null,i);break;case"together":Rf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function _d(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ca(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ei|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(se(153));if(e.child!==null){for(t=e.child,n=ns(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ns(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function dR(t,e,n){switch(e.tag){case 3:dC(e),yo();break;case 5:F1(e);break;case 1:On(e.type)&&Zd(e);break;case 4:T0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;lt(tm,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(lt(wt,wt.current&1),e.flags|=128,null):n&e.child.childLanes?mC(t,e,n):(lt(wt,wt.current&1),t=ca(t,e,n),t!==null?t.sibling:null);lt(wt,wt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return pC(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),lt(wt,wt.current),r)break;return null;case 22:case 23:return e.lanes=0,cC(t,e,n)}return ca(t,e,n)}var fC,eg,hC,gC;fC=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};eg=function(){};hC=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,$s(Or.current);var i=null;switch(n){case"input":s=wh(t,s),r=wh(t,r),i=[];break;case"select":s=Ct({},s,{value:void 0}),r=Ct({},r,{value:void 0}),i=[];break;case"textarea":s=Ch(t,s),r=Ch(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Jd)}kh(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(dc.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(dc.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&dt("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};gC=function(t,e,n,r){n!==r&&(e.flags|=4)};function Sl(t,e){if(!gt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function pn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function mR(t,e,n){var r=e.pendingProps;switch(w0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pn(e),null;case 1:return On(e.type)&&Yd(),pn(e),null;case 3:return r=e.stateNode,xo(),pt(Mn),pt(En),P0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Gu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,fr!==null&&(lg(fr),fr=null))),eg(t,e),pn(e),null;case 5:A0(e);var s=$s(_c.current);if(n=e.type,t!==null&&e.stateNode!=null)hC(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(se(166));return pn(e),null}if(t=$s(Or.current),Gu(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Ar]=e,r[xc]=i,t=(e.mode&1)!==0,n){case"dialog":dt("cancel",r),dt("close",r);break;case"iframe":case"object":case"embed":dt("load",r);break;case"video":case"audio":for(s=0;s<Ul.length;s++)dt(Ul[s],r);break;case"source":dt("error",r);break;case"img":case"image":case"link":dt("error",r),dt("load",r);break;case"details":dt("toggle",r);break;case"input":ky(r,i),dt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},dt("invalid",r);break;case"textarea":Ty(r,i),dt("invalid",r)}kh(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Hu(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Hu(r.textContent,l,t),s=["children",""+l]):dc.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&dt("scroll",r)}switch(n){case"input":ju(r),Iy(r,i,!0);break;case"textarea":ju(r),Ay(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Jd)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=qN(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ar]=e,t[xc]=r,fC(t,e,!1,!1),e.stateNode=t;e:{switch(o=Ih(n,r),n){case"dialog":dt("cancel",t),dt("close",t),s=r;break;case"iframe":case"object":case"embed":dt("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ul.length;s++)dt(Ul[s],t);s=r;break;case"source":dt("error",t),s=r;break;case"img":case"image":case"link":dt("error",t),dt("load",t),s=r;break;case"details":dt("toggle",t),s=r;break;case"input":ky(t,r),s=wh(t,r),dt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ct({},r,{value:void 0}),dt("invalid",t);break;case"textarea":Ty(t,r),s=Ch(t,r),dt("invalid",t);break;default:s=r}kh(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?GN(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&WN(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&mc(t,c):typeof c=="number"&&mc(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(dc.hasOwnProperty(i)?c!=null&&i==="onScroll"&&dt("scroll",t):c!=null&&o0(t,i,c,o))}switch(n){case"input":ju(t),Iy(t,r,!1);break;case"textarea":ju(t),Ay(t);break;case"option":r.value!=null&&t.setAttribute("value",""+as(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ao(t,!!r.multiple,i,!1):r.defaultValue!=null&&ao(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Jd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return pn(e),null;case 6:if(t&&e.stateNode!=null)gC(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(se(166));if(n=$s(_c.current),$s(Or.current),Gu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ar]=e,(i=r.nodeValue!==n)&&(t=Gn,t!==null))switch(t.tag){case 3:Hu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Hu(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ar]=e,e.stateNode=r}return pn(e),null;case 13:if(pt(wt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(gt&&Wn!==null&&e.mode&1&&!(e.flags&128))D1(),yo(),e.flags|=98560,i=!1;else if(i=Gu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(se(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(se(317));i[Ar]=e}else yo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;pn(e),i=!1}else fr!==null&&(lg(fr),fr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||wt.current&1?qt===0&&(qt=3):B0())),e.updateQueue!==null&&(e.flags|=4),pn(e),null);case 4:return xo(),eg(t,e),t===null&&yc(e.stateNode.containerInfo),pn(e),null;case 10:return S0(e.type._context),pn(e),null;case 17:return On(e.type)&&Yd(),pn(e),null;case 19:if(pt(wt),i=e.memoizedState,i===null)return pn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Sl(i,!1);else{if(qt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=am(t),o!==null){for(e.flags|=128,Sl(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return lt(wt,wt.current&1|2),e.child}t=t.sibling}i.tail!==null&&Rt()>_o&&(e.flags|=128,r=!0,Sl(i,!1),e.lanes=4194304)}else{if(!r)if(t=am(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Sl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!gt)return pn(e),null}else 2*Rt()-i.renderingStartTime>_o&&n!==1073741824&&(e.flags|=128,r=!0,Sl(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Rt(),e.sibling=null,n=wt.current,lt(wt,r?n&1|2:n&1),e):(pn(e),null);case 22:case 23:return $0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?$n&1073741824&&(pn(e),e.subtreeFlags&6&&(e.flags|=8192)):pn(e),null;case 24:return null;case 25:return null}throw Error(se(156,e.tag))}function pR(t,e){switch(w0(e),e.tag){case 1:return On(e.type)&&Yd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return xo(),pt(Mn),pt(En),P0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return A0(e),null;case 13:if(pt(wt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(se(340));yo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return pt(wt),null;case 4:return xo(),null;case 10:return S0(e.type._context),null;case 22:case 23:return $0(),null;case 24:return null;default:return null}}var Ju=!1,gn=!1,fR=typeof WeakSet=="function"?WeakSet:Set,ve=null;function eo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){It(t,e,r)}else n.current=null}function tg(t,e,n){try{n()}catch(r){It(t,e,r)}}var yE=!1;function hR(t,e){if(jh=Gd,t=x1(),E0(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=t,g=null;t:for(;;){for(var v;f!==n||s!==0&&f.nodeType!==3||(l=o+s),f!==i||r!==0&&f.nodeType!==3||(c=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(v=f.firstChild)!==null;)g=f,f=v;for(;;){if(f===t)break t;if(g===n&&++u===s&&(l=o),g===i&&++d===r&&(c=o),(v=f.nextSibling)!==null)break;f=g,g=f.parentNode}f=v}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Fh={focusedElem:t,selectionRange:n},Gd=!1,ve=e;ve!==null;)if(e=ve,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ve=t;else for(;ve!==null;){e=ve;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var E=x.memoizedProps,y=x.memoizedState,h=e.stateNode,C=h.getSnapshotBeforeUpdate(e.elementType===e.type?E:mr(e.type,E),y);h.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(k){It(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,ve=t;break}ve=e.return}return x=yE,yE=!1,x}function ec(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&tg(e,n,i)}s=s.next}while(s!==r)}}function ip(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ng(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function vC(t){var e=t.alternate;e!==null&&(t.alternate=null,vC(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ar],delete e[xc],delete e[$h],delete e[YP],delete e[ZP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function bC(t){return t.tag===5||t.tag===3||t.tag===4}function EE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||bC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function rg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Jd));else if(r!==4&&(t=t.child,t!==null))for(rg(t,e,n),t=t.sibling;t!==null;)rg(t,e,n),t=t.sibling}function ag(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(ag(t,e,n),t=t.sibling;t!==null;)ag(t,e,n),t=t.sibling}var rn=null,pr=!1;function Ia(t,e,n){for(n=n.child;n!==null;)yC(t,e,n),n=n.sibling}function yC(t,e,n){if(Mr&&typeof Mr.onCommitFiberUnmount=="function")try{Mr.onCommitFiberUnmount(Zm,n)}catch{}switch(n.tag){case 5:gn||eo(n,e);case 6:var r=rn,s=pr;rn=null,Ia(t,e,n),rn=r,pr=s,rn!==null&&(pr?(t=rn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):rn.removeChild(n.stateNode));break;case 18:rn!==null&&(pr?(t=rn,n=n.stateNode,t.nodeType===8?Cf(t.parentNode,n):t.nodeType===1&&Cf(t,n),gc(t)):Cf(rn,n.stateNode));break;case 4:r=rn,s=pr,rn=n.stateNode.containerInfo,pr=!0,Ia(t,e,n),rn=r,pr=s;break;case 0:case 11:case 14:case 15:if(!gn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&tg(n,e,o),s=s.next}while(s!==r)}Ia(t,e,n);break;case 1:if(!gn&&(eo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){It(n,e,l)}Ia(t,e,n);break;case 21:Ia(t,e,n);break;case 22:n.mode&1?(gn=(r=gn)||n.memoizedState!==null,Ia(t,e,n),gn=r):Ia(t,e,n);break;default:Ia(t,e,n)}}function xE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new fR),e.forEach(function(r){var s=NR.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function dr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:rn=l.stateNode,pr=!1;break e;case 3:rn=l.stateNode.containerInfo,pr=!0;break e;case 4:rn=l.stateNode.containerInfo,pr=!0;break e}l=l.return}if(rn===null)throw Error(se(160));yC(i,o,s),rn=null,pr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){It(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)EC(e,t),e=e.sibling}function EC(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(dr(e,t),kr(t),r&4){try{ec(3,t,t.return),ip(3,t)}catch(E){It(t,t.return,E)}try{ec(5,t,t.return)}catch(E){It(t,t.return,E)}}break;case 1:dr(e,t),kr(t),r&512&&n!==null&&eo(n,n.return);break;case 5:if(dr(e,t),kr(t),r&512&&n!==null&&eo(n,n.return),t.flags&32){var s=t.stateNode;try{mc(s,"")}catch(E){It(t,t.return,E)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&$N(s,i),Ih(l,o);var u=Ih(l,i);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?GN(s,f):d==="dangerouslySetInnerHTML"?WN(s,f):d==="children"?mc(s,f):o0(s,d,f,u)}switch(l){case"input":_h(s,i);break;case"textarea":BN(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?ao(s,!!i.multiple,v,!1):g!==!!i.multiple&&(i.defaultValue!=null?ao(s,!!i.multiple,i.defaultValue,!0):ao(s,!!i.multiple,i.multiple?[]:"",!1))}s[xc]=i}catch(E){It(t,t.return,E)}}break;case 6:if(dr(e,t),kr(t),r&4){if(t.stateNode===null)throw Error(se(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(E){It(t,t.return,E)}}break;case 3:if(dr(e,t),kr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{gc(e.containerInfo)}catch(E){It(t,t.return,E)}break;case 4:dr(e,t),kr(t);break;case 13:dr(e,t),kr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(z0=Rt())),r&4&&xE(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(gn=(u=gn)||d,dr(e,t),gn=u):dr(e,t),kr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(ve=t,d=t.child;d!==null;){for(f=ve=d;ve!==null;){switch(g=ve,v=g.child,g.tag){case 0:case 11:case 14:case 15:ec(4,g,g.return);break;case 1:eo(g,g.return);var x=g.stateNode;if(typeof x.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(E){It(r,n,E)}}break;case 5:eo(g,g.return);break;case 22:if(g.memoizedState!==null){_E(f);continue}}v!==null?(v.return=g,ve=v):_E(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=HN("display",o))}catch(E){It(t,t.return,E)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(E){It(t,t.return,E)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:dr(e,t),kr(t),r&4&&xE(t);break;case 21:break;default:dr(e,t),kr(t)}}function kr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(bC(n)){var r=n;break e}n=n.return}throw Error(se(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(mc(s,""),r.flags&=-33);var i=EE(t);ag(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=EE(t);rg(t,l,o);break;default:throw Error(se(161))}}catch(c){It(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function gR(t,e,n){ve=t,xC(t)}function xC(t,e,n){for(var r=(t.mode&1)!==0;ve!==null;){var s=ve,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Ju;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||gn;l=Ju;var u=gn;if(Ju=o,(gn=c)&&!u)for(ve=s;ve!==null;)o=ve,c=o.child,o.tag===22&&o.memoizedState!==null?NE(s):c!==null?(c.return=o,ve=c):NE(s);for(;i!==null;)ve=i,xC(i),i=i.sibling;ve=s,Ju=l,gn=u}wE(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ve=i):wE(t)}}function wE(t){for(;ve!==null;){var e=ve;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:gn||ip(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!gn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:mr(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&iE(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}iE(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&gc(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}gn||e.flags&512&&ng(e)}catch(g){It(e,e.return,g)}}if(e===t){ve=null;break}if(n=e.sibling,n!==null){n.return=e.return,ve=n;break}ve=e.return}}function _E(t){for(;ve!==null;){var e=ve;if(e===t){ve=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ve=n;break}ve=e.return}}function NE(t){for(;ve!==null;){var e=ve;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ip(4,e)}catch(c){It(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){It(e,s,c)}}var i=e.return;try{ng(e)}catch(c){It(e,i,c)}break;case 5:var o=e.return;try{ng(e)}catch(c){It(e,o,c)}}}catch(c){It(e,e.return,c)}if(e===t){ve=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ve=l;break}ve=e.return}}var vR=Math.ceil,om=ha.ReactCurrentDispatcher,j0=ha.ReactCurrentOwner,rr=ha.ReactCurrentBatchConfig,Ye=0,Xt=null,Ft=null,on=0,$n=0,to=hs(0),qt=0,kc=null,ei=0,op=0,F0=0,tc=null,An=null,z0=0,_o=1/0,Hr=null,lm=!1,sg=null,es=null,Yu=!1,Ga=null,cm=0,nc=0,ig=null,Nd=-1,Cd=0;function Cn(){return Ye&6?Rt():Nd!==-1?Nd:Nd=Rt()}function ts(t){return t.mode&1?Ye&2&&on!==0?on&-on:eR.transition!==null?(Cd===0&&(Cd=s1()),Cd):(t=nt,t!==0||(t=window.event,t=t===void 0?16:m1(t.type)),t):1}function gr(t,e,n,r){if(50<nc)throw nc=0,ig=null,Error(se(185));Jc(t,n,r),(!(Ye&2)||t!==Xt)&&(t===Xt&&(!(Ye&2)&&(op|=n),qt===4&&Va(t,on)),Vn(t,r),n===1&&Ye===0&&!(e.mode&1)&&(_o=Rt()+500,rp&&gs()))}function Vn(t,e){var n=t.callbackNode;eP(t,e);var r=Hd(t,t===Xt?on:0);if(r===0)n!==null&&Ly(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Ly(n),e===1)t.tag===0?XP(CE.bind(null,t)):P1(CE.bind(null,t)),QP(function(){!(Ye&6)&&gs()}),n=null;else{switch(i1(r)){case 1:n=m0;break;case 4:n=r1;break;case 16:n=Wd;break;case 536870912:n=a1;break;default:n=Wd}n=TC(n,wC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function wC(t,e){if(Nd=-1,Cd=0,Ye&6)throw Error(se(327));var n=t.callbackNode;if(co()&&t.callbackNode!==n)return null;var r=Hd(t,t===Xt?on:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=um(t,r);else{e=r;var s=Ye;Ye|=2;var i=NC();(Xt!==t||on!==e)&&(Hr=null,_o=Rt()+500,Hs(t,e));do try{ER();break}catch(l){_C(t,l)}while(1);C0(),om.current=i,Ye=s,Ft!==null?e=0:(Xt=null,on=0,e=qt)}if(e!==0){if(e===2&&(s=Lh(t),s!==0&&(r=s,e=og(t,s))),e===1)throw n=kc,Hs(t,0),Va(t,r),Vn(t,Rt()),n;if(e===6)Va(t,r);else{if(s=t.current.alternate,!(r&30)&&!bR(s)&&(e=um(t,r),e===2&&(i=Lh(t),i!==0&&(r=i,e=og(t,i))),e===1))throw n=kc,Hs(t,0),Va(t,r),Vn(t,Rt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(se(345));case 2:Rs(t,An,Hr);break;case 3:if(Va(t,r),(r&130023424)===r&&(e=z0+500-Rt(),10<e)){if(Hd(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Cn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Uh(Rs.bind(null,t,An,Hr),e);break}Rs(t,An,Hr);break;case 4:if(Va(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-hr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Rt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*vR(r/1960))-r,10<r){t.timeoutHandle=Uh(Rs.bind(null,t,An,Hr),r);break}Rs(t,An,Hr);break;case 5:Rs(t,An,Hr);break;default:throw Error(se(329))}}}return Vn(t,Rt()),t.callbackNode===n?wC.bind(null,t):null}function og(t,e){var n=tc;return t.current.memoizedState.isDehydrated&&(Hs(t,e).flags|=256),t=um(t,e),t!==2&&(e=An,An=n,e!==null&&lg(e)),t}function lg(t){An===null?An=t:An.push.apply(An,t)}function bR(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!vr(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Va(t,e){for(e&=~F0,e&=~op,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-hr(e),r=1<<n;t[n]=-1,e&=~r}}function CE(t){if(Ye&6)throw Error(se(327));co();var e=Hd(t,0);if(!(e&1))return Vn(t,Rt()),null;var n=um(t,e);if(t.tag!==0&&n===2){var r=Lh(t);r!==0&&(e=r,n=og(t,r))}if(n===1)throw n=kc,Hs(t,0),Va(t,e),Vn(t,Rt()),n;if(n===6)throw Error(se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Rs(t,An,Hr),Vn(t,Rt()),null}function U0(t,e){var n=Ye;Ye|=1;try{return t(e)}finally{Ye=n,Ye===0&&(_o=Rt()+500,rp&&gs())}}function ti(t){Ga!==null&&Ga.tag===0&&!(Ye&6)&&co();var e=Ye;Ye|=1;var n=rr.transition,r=nt;try{if(rr.transition=null,nt=1,t)return t()}finally{nt=r,rr.transition=n,Ye=e,!(Ye&6)&&gs()}}function $0(){$n=to.current,pt(to)}function Hs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,KP(n)),Ft!==null)for(n=Ft.return;n!==null;){var r=n;switch(w0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Yd();break;case 3:xo(),pt(Mn),pt(En),P0();break;case 5:A0(r);break;case 4:xo();break;case 13:pt(wt);break;case 19:pt(wt);break;case 10:S0(r.type._context);break;case 22:case 23:$0()}n=n.return}if(Xt=t,Ft=t=ns(t.current,null),on=$n=e,qt=0,kc=null,F0=op=ei=0,An=tc=null,Us!==null){for(e=0;e<Us.length;e++)if(n=Us[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Us=null}return t}function _C(t,e){do{var n=Ft;try{if(C0(),xd.current=im,sm){for(var r=_t.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}sm=!1}if(Xs=0,Yt=Bt=_t=null,Xl=!1,Nc=0,j0.current=null,n===null||n.return===null){qt=1,kc=e,Ft=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=on,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var g=d.alternate;g?(d.updateQueue=g.updateQueue,d.memoizedState=g.memoizedState,d.lanes=g.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=mE(o);if(v!==null){v.flags&=-257,pE(v,o,l,i,e),v.mode&1&&dE(i,u,e),e=v,c=u;var x=e.updateQueue;if(x===null){var E=new Set;E.add(c),e.updateQueue=E}else x.add(c);break e}else{if(!(e&1)){dE(i,u,e),B0();break e}c=Error(se(426))}}else if(gt&&l.mode&1){var y=mE(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),pE(y,o,l,i,e),_0(wo(c,l));break e}}i=c=wo(c,l),qt!==4&&(qt=2),tc===null?tc=[i]:tc.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var h=iC(i,c,e);sE(i,h);break e;case 1:l=c;var C=i.type,T=i.stateNode;if(!(i.flags&128)&&(typeof C.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(es===null||!es.has(T)))){i.flags|=65536,e&=-e,i.lanes|=e;var k=oC(i,l,e);sE(i,k);break e}}i=i.return}while(i!==null)}SC(n)}catch(_){e=_,Ft===n&&n!==null&&(Ft=n=n.return);continue}break}while(1)}function NC(){var t=om.current;return om.current=im,t===null?im:t}function B0(){(qt===0||qt===3||qt===2)&&(qt=4),Xt===null||!(ei&268435455)&&!(op&268435455)||Va(Xt,on)}function um(t,e){var n=Ye;Ye|=2;var r=NC();(Xt!==t||on!==e)&&(Hr=null,Hs(t,e));do try{yR();break}catch(s){_C(t,s)}while(1);if(C0(),Ye=n,om.current=r,Ft!==null)throw Error(se(261));return Xt=null,on=0,qt}function yR(){for(;Ft!==null;)CC(Ft)}function ER(){for(;Ft!==null&&!WA();)CC(Ft)}function CC(t){var e=IC(t.alternate,t,$n);t.memoizedProps=t.pendingProps,e===null?SC(t):Ft=e,j0.current=null}function SC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=pR(n,e),n!==null){n.flags&=32767,Ft=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{qt=6,Ft=null;return}}else if(n=mR(n,e,$n),n!==null){Ft=n;return}if(e=e.sibling,e!==null){Ft=e;return}Ft=e=t}while(e!==null);qt===0&&(qt=5)}function Rs(t,e,n){var r=nt,s=rr.transition;try{rr.transition=null,nt=1,xR(t,e,n,r)}finally{rr.transition=s,nt=r}return null}function xR(t,e,n,r){do co();while(Ga!==null);if(Ye&6)throw Error(se(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(se(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(tP(t,i),t===Xt&&(Ft=Xt=null,on=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Yu||(Yu=!0,TC(Wd,function(){return co(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=rr.transition,rr.transition=null;var o=nt;nt=1;var l=Ye;Ye|=4,j0.current=null,hR(t,n),EC(n,t),UP(Fh),Gd=!!jh,Fh=jh=null,t.current=n,gR(n),HA(),Ye=l,nt=o,rr.transition=i}else t.current=n;if(Yu&&(Yu=!1,Ga=t,cm=s),i=t.pendingLanes,i===0&&(es=null),QA(n.stateNode),Vn(t,Rt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(lm)throw lm=!1,t=sg,sg=null,t;return cm&1&&t.tag!==0&&co(),i=t.pendingLanes,i&1?t===ig?nc++:(nc=0,ig=t):nc=0,gs(),null}function co(){if(Ga!==null){var t=i1(cm),e=rr.transition,n=nt;try{if(rr.transition=null,nt=16>t?16:t,Ga===null)var r=!1;else{if(t=Ga,Ga=null,cm=0,Ye&6)throw Error(se(331));var s=Ye;for(Ye|=4,ve=t.current;ve!==null;){var i=ve,o=i.child;if(ve.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(ve=u;ve!==null;){var d=ve;switch(d.tag){case 0:case 11:case 15:ec(8,d,i)}var f=d.child;if(f!==null)f.return=d,ve=f;else for(;ve!==null;){d=ve;var g=d.sibling,v=d.return;if(vC(d),d===u){ve=null;break}if(g!==null){g.return=v,ve=g;break}ve=v}}}var x=i.alternate;if(x!==null){var E=x.child;if(E!==null){x.child=null;do{var y=E.sibling;E.sibling=null,E=y}while(E!==null)}}ve=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ve=o;else e:for(;ve!==null;){if(i=ve,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ec(9,i,i.return)}var h=i.sibling;if(h!==null){h.return=i.return,ve=h;break e}ve=i.return}}var C=t.current;for(ve=C;ve!==null;){o=ve;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,ve=T;else e:for(o=C;ve!==null;){if(l=ve,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ip(9,l)}}catch(_){It(l,l.return,_)}if(l===o){ve=null;break e}var k=l.sibling;if(k!==null){k.return=l.return,ve=k;break e}ve=l.return}}if(Ye=s,gs(),Mr&&typeof Mr.onPostCommitFiberRoot=="function")try{Mr.onPostCommitFiberRoot(Zm,t)}catch{}r=!0}return r}finally{nt=n,rr.transition=e}}return!1}function SE(t,e,n){e=wo(n,e),e=iC(t,e,1),t=Xa(t,e,1),e=Cn(),t!==null&&(Jc(t,1,e),Vn(t,e))}function It(t,e,n){if(t.tag===3)SE(t,t,n);else for(;e!==null;){if(e.tag===3){SE(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(es===null||!es.has(r))){t=wo(n,t),t=oC(e,t,1),e=Xa(e,t,1),t=Cn(),e!==null&&(Jc(e,1,t),Vn(e,t));break}}e=e.return}}function wR(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Cn(),t.pingedLanes|=t.suspendedLanes&n,Xt===t&&(on&n)===n&&(qt===4||qt===3&&(on&130023424)===on&&500>Rt()-z0?Hs(t,0):F0|=n),Vn(t,e)}function kC(t,e){e===0&&(t.mode&1?(e=Uu,Uu<<=1,!(Uu&130023424)&&(Uu=4194304)):e=1);var n=Cn();t=la(t,e),t!==null&&(Jc(t,e,n),Vn(t,n))}function _R(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),kC(t,n)}function NR(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(se(314))}r!==null&&r.delete(e),kC(t,n)}var IC;IC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Mn.current)Pn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Pn=!1,dR(t,e,n);Pn=!!(t.flags&131072)}else Pn=!1,gt&&e.flags&1048576&&R1(e,em,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;_d(t,e),t=e.pendingProps;var s=bo(e,En.current);lo(e,n),s=L0(null,e,r,t,s,n);var i=D0();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,On(r)?(i=!0,Zd(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,I0(e),s.updater=sp,e.stateNode=s,s._reactInternals=e,Kh(e,r,t,n),e=Yh(null,e,r,!0,i,n)):(e.tag=0,gt&&i&&x0(e),_n(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(_d(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=SR(r),t=mr(r,t),s){case 0:e=Jh(null,e,r,t,n);break e;case 1:e=gE(null,e,r,t,n);break e;case 11:e=fE(null,e,r,t,n);break e;case 14:e=hE(null,e,r,mr(r.type,t),n);break e}throw Error(se(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mr(r,s),Jh(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mr(r,s),gE(t,e,r,s,n);case 3:e:{if(dC(e),t===null)throw Error(se(387));r=e.pendingProps,i=e.memoizedState,s=i.element,j1(t,e),rm(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=wo(Error(se(423)),e),e=vE(t,e,r,n,s);break e}else if(r!==s){s=wo(Error(se(424)),e),e=vE(t,e,r,n,s);break e}else for(Wn=Za(e.stateNode.containerInfo.firstChild),Gn=e,gt=!0,fr=null,n=O1(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(yo(),r===s){e=ca(t,e,n);break e}_n(t,e,r,n)}e=e.child}return e;case 5:return F1(e),t===null&&Wh(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,zh(r,s)?o=null:i!==null&&zh(r,i)&&(e.flags|=32),uC(t,e),_n(t,e,o,n),e.child;case 6:return t===null&&Wh(e),null;case 13:return mC(t,e,n);case 4:return T0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Eo(e,null,r,n):_n(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mr(r,s),fE(t,e,r,s,n);case 7:return _n(t,e,e.pendingProps,n),e.child;case 8:return _n(t,e,e.pendingProps.children,n),e.child;case 12:return _n(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,lt(tm,r._currentValue),r._currentValue=o,i!==null)if(vr(i.value,o)){if(i.children===s.children&&!Mn.current){e=ca(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=ta(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Hh(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(se(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Hh(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}_n(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,lo(e,n),s=ar(s),r=r(s),e.flags|=1,_n(t,e,r,n),e.child;case 14:return r=e.type,s=mr(r,e.pendingProps),s=mr(r.type,s),hE(t,e,r,s,n);case 15:return lC(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:mr(r,s),_d(t,e),e.tag=1,On(r)?(t=!0,Zd(e)):t=!1,lo(e,n),sC(e,r,s),Kh(e,r,s,n),Yh(null,e,r,!0,t,n);case 19:return pC(t,e,n);case 22:return cC(t,e,n)}throw Error(se(156,e.tag))};function TC(t,e){return n1(t,e)}function CR(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nr(t,e,n,r){return new CR(t,e,n,r)}function q0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function SR(t){if(typeof t=="function")return q0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===c0)return 11;if(t===u0)return 14}return 2}function ns(t,e){var n=t.alternate;return n===null?(n=nr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Sd(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")q0(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Wi:return Gs(n.children,s,i,e);case l0:o=8,s|=8;break;case bh:return t=nr(12,n,e,s|2),t.elementType=bh,t.lanes=i,t;case yh:return t=nr(13,n,e,s),t.elementType=yh,t.lanes=i,t;case Eh:return t=nr(19,n,e,s),t.elementType=Eh,t.lanes=i,t;case FN:return lp(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case VN:o=10;break e;case jN:o=9;break e;case c0:o=11;break e;case u0:o=14;break e;case La:o=16,r=null;break e}throw Error(se(130,t==null?t:typeof t,""))}return e=nr(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Gs(t,e,n,r){return t=nr(7,t,r,e),t.lanes=n,t}function lp(t,e,n,r){return t=nr(22,t,r,e),t.elementType=FN,t.lanes=n,t.stateNode={isHidden:!1},t}function Lf(t,e,n){return t=nr(6,t,null,e),t.lanes=n,t}function Df(t,e,n){return e=nr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function kR(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ff(0),this.expirationTimes=ff(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ff(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function W0(t,e,n,r,s,i,o,l,c){return t=new kR(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=nr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},I0(i),t}function IR(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function AC(t){if(!t)return ss;t=t._reactInternals;e:{if(bi(t)!==t||t.tag!==1)throw Error(se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(On(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(se(171))}if(t.tag===1){var n=t.type;if(On(n))return A1(t,n,e)}return e}function PC(t,e,n,r,s,i,o,l,c){return t=W0(n,r,!0,t,s,i,o,l,c),t.context=AC(null),n=t.current,r=Cn(),s=ts(n),i=ta(r,s),i.callback=e??null,Xa(n,i,s),t.current.lanes=s,Jc(t,s,r),Vn(t,r),t}function cp(t,e,n,r){var s=e.current,i=Cn(),o=ts(s);return n=AC(n),e.context===null?e.context=n:e.pendingContext=n,e=ta(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Xa(s,e,o),t!==null&&(gr(t,s,o,i),Ed(t,s,o)),o}function dm(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function kE(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function H0(t,e){kE(t,e),(t=t.alternate)&&kE(t,e)}function TR(){return null}var RC=typeof reportError=="function"?reportError:function(t){console.error(t)};function G0(t){this._internalRoot=t}up.prototype.render=G0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(se(409));cp(t,e,null,null)};up.prototype.unmount=G0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ti(function(){cp(null,t,null,null)}),e[oa]=null}};function up(t){this._internalRoot=t}up.prototype.unstable_scheduleHydration=function(t){if(t){var e=c1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Oa.length&&e!==0&&e<Oa[n].priority;n++);Oa.splice(n,0,t),n===0&&d1(t)}};function K0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function dp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function IE(){}function AR(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=dm(o);i.call(u)}}var o=PC(e,r,t,0,null,!1,!1,"",IE);return t._reactRootContainer=o,t[oa]=o.current,yc(t.nodeType===8?t.parentNode:t),ti(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=dm(c);l.call(u)}}var c=W0(t,0,!1,null,null,!1,!1,"",IE);return t._reactRootContainer=c,t[oa]=c.current,yc(t.nodeType===8?t.parentNode:t),ti(function(){cp(e,c,n,r)}),c}function mp(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=dm(o);l.call(c)}}cp(e,o,t,s)}else o=AR(n,e,t,s,r);return dm(o)}o1=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=zl(e.pendingLanes);n!==0&&(p0(e,n|1),Vn(e,Rt()),!(Ye&6)&&(_o=Rt()+500,gs()))}break;case 13:ti(function(){var r=la(t,1);if(r!==null){var s=Cn();gr(r,t,1,s)}}),H0(t,1)}};f0=function(t){if(t.tag===13){var e=la(t,134217728);if(e!==null){var n=Cn();gr(e,t,134217728,n)}H0(t,134217728)}};l1=function(t){if(t.tag===13){var e=ts(t),n=la(t,e);if(n!==null){var r=Cn();gr(n,t,e,r)}H0(t,e)}};c1=function(){return nt};u1=function(t,e){var n=nt;try{return nt=t,e()}finally{nt=n}};Ah=function(t,e,n){switch(e){case"input":if(_h(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=np(r);if(!s)throw Error(se(90));UN(r),_h(r,s)}}}break;case"textarea":BN(t,n);break;case"select":e=n.value,e!=null&&ao(t,!!n.multiple,e,!1)}};JN=U0;YN=ti;var PR={usingClientEntryPoint:!1,Events:[Zc,Qi,np,KN,QN,U0]},kl={findFiberByHostInstance:zs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RR={bundleType:kl.bundleType,version:kl.version,rendererPackageName:kl.rendererPackageName,rendererConfig:kl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ha.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=e1(t),t===null?null:t.stateNode},findFiberByHostInstance:kl.findFiberByHostInstance||TR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zu.isDisabled&&Zu.supportsFiber)try{Zm=Zu.inject(RR),Mr=Zu}catch{}}Jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=PR;Jn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!K0(e))throw Error(se(200));return IR(t,e,null,n)};Jn.createRoot=function(t,e){if(!K0(t))throw Error(se(299));var n=!1,r="",s=RC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=W0(t,1,!1,null,null,n,!1,r,s),t[oa]=e.current,yc(t.nodeType===8?t.parentNode:t),new G0(e)};Jn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(se(188)):(t=Object.keys(t).join(","),Error(se(268,t)));return t=e1(e),t=t===null?null:t.stateNode,t};Jn.flushSync=function(t){return ti(t)};Jn.hydrate=function(t,e,n){if(!dp(e))throw Error(se(200));return mp(null,t,e,!0,n)};Jn.hydrateRoot=function(t,e,n){if(!K0(t))throw Error(se(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=RC;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=PC(e,null,t,1,n??null,s,!1,i,o),t[oa]=e.current,yc(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new up(e)};Jn.render=function(t,e,n){if(!dp(e))throw Error(se(200));return mp(null,t,e,!1,n)};Jn.unmountComponentAtNode=function(t){if(!dp(t))throw Error(se(40));return t._reactRootContainer?(ti(function(){mp(null,null,t,!1,function(){t._reactRootContainer=null,t[oa]=null})}),!0):!1};Jn.unstable_batchedUpdates=U0;Jn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!dp(n))throw Error(se(200));if(t==null||t._reactInternals===void 0)throw Error(se(38));return mp(t,e,n,!1,r)};Jn.version="18.3.1-next-f1338f8080-20240426";function LC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(LC)}catch(t){console.error(t)}}LC(),LN.exports=Jn;var yi=LN.exports,TE=yi;gh.createRoot=TE.createRoot,gh.hydrateRoot=TE.hydrateRoot;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DC=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},LR=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},MC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,f=(i&3)<<4|l>>4;let g=(l&15)<<2|u>>6,v=u&63;c||(v=64,o||(g=64)),r.push(n[d],n[f],n[g],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(DC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):LR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||f==null)throw new DR;const g=i<<2|l>>4;if(r.push(g),u!==64){const v=l<<4&240|u>>2;if(r.push(v),f!==64){const x=u<<6&192|f;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class DR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const MR=function(t){const e=DC(t);return MC.encodeByteArray(e,!0)},mm=function(t){return MR(t).replace(/\./g,"")},OC=function(t){try{return MC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VR=()=>OR().__FIREBASE_DEFAULTS__,jR=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},FR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&OC(t[1]);return e&&JSON.parse(e)},pp=()=>{try{return VR()||jR()||FR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},VC=t=>{var e,n;return(n=(e=pp())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},jC=t=>{const e=VC(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},FC=()=>{var t;return(t=pp())===null||t===void 0?void 0:t.config},zC=t=>{var e;return(e=pp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[mm(JSON.stringify(n)),mm(JSON.stringify(o)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function UR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Wt())}function $R(){var t;const e=(t=pp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function BR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function qR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function WR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function HR(){const t=Wt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function $C(){return!$R()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Q0(){try{return typeof indexedDB=="object"}catch{return!1}}function BC(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function GR(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KR="FirebaseError";class xr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=KR,Object.setPrototypeOf(this,xr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ei.prototype.create)}}class Ei{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?QR(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new xr(s,l,r)}}function QR(t,e){return t.replace(JR,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const JR=/\{\$([^}]+)}/g;function YR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function is(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(AE(i)&&AE(o)){if(!is(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function AE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function $l(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Bl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function ZR(t,e){const n=new XR(t,e);return n.subscribe.bind(n)}class XR{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");eL(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Mf),s.error===void 0&&(s.error=Mf),s.complete===void 0&&(s.complete=Mf);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function eL(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Mf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(t){return t&&t._delegate?t._delegate:t}class ir{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ls="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new zR;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(rL(e))try{this.getOrInitializeService({instanceIdentifier:Ls})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Ls){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ls){return this.instances.has(e)}getOptions(e=Ls){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:nL(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ls){return this.component?this.component.multipleInstances?e:Ls:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function nL(t){return t===Ls?void 0:t}function rL(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new tL(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var We;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(We||(We={}));const sL={debug:We.DEBUG,verbose:We.VERBOSE,info:We.INFO,warn:We.WARN,error:We.ERROR,silent:We.SILENT},iL=We.INFO,oL={[We.DEBUG]:"log",[We.VERBOSE]:"log",[We.INFO]:"info",[We.WARN]:"warn",[We.ERROR]:"error"},lL=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=oL[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class J0{constructor(e){this.name=e,this._logLevel=iL,this._logHandler=lL,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in We))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?sL[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,We.DEBUG,...e),this._logHandler(this,We.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,We.VERBOSE,...e),this._logHandler(this,We.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,We.INFO,...e),this._logHandler(this,We.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,We.WARN,...e),this._logHandler(this,We.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,We.ERROR,...e),this._logHandler(this,We.ERROR,...e)}}const cL=(t,e)=>e.some(n=>t instanceof n);let PE,RE;function uL(){return PE||(PE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function dL(){return RE||(RE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const qC=new WeakMap,cg=new WeakMap,WC=new WeakMap,Of=new WeakMap,Y0=new WeakMap;function mL(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(na(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&qC.set(n,t)}).catch(()=>{}),Y0.set(e,t),e}function pL(t){if(cg.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});cg.set(t,e)}let ug={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return cg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||WC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return na(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function fL(t){ug=t(ug)}function hL(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Vf(this),e,...n);return WC.set(r,e.sort?e.sort():[e]),na(r)}:dL().includes(t)?function(...e){return t.apply(Vf(this),e),na(qC.get(this))}:function(...e){return na(t.apply(Vf(this),e))}}function gL(t){return typeof t=="function"?hL(t):(t instanceof IDBTransaction&&pL(t),cL(t,uL())?new Proxy(t,ug):t)}function na(t){if(t instanceof IDBRequest)return mL(t);if(Of.has(t))return Of.get(t);const e=gL(t);return e!==t&&(Of.set(t,e),Y0.set(e,t)),e}const Vf=t=>Y0.get(t);function fp(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=na(o);return r&&o.addEventListener("upgradeneeded",c=>{r(na(o.result),c.oldVersion,c.newVersion,na(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}function jf(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),na(n).then(()=>{})}const vL=["get","getKey","getAll","getAllKeys","count"],bL=["put","add","delete","clear"],Ff=new Map;function LE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ff.get(e))return Ff.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=bL.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||vL.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return Ff.set(e,i),i}fL(t=>({...t,get:(e,n,r)=>LE(e,n)||t.get(e,n,r),has:(e,n)=>!!LE(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(EL(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function EL(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const dg="@firebase/app",DE="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ua=new J0("@firebase/app"),xL="@firebase/app-compat",wL="@firebase/analytics-compat",_L="@firebase/analytics",NL="@firebase/app-check-compat",CL="@firebase/app-check",SL="@firebase/auth",kL="@firebase/auth-compat",IL="@firebase/database",TL="@firebase/data-connect",AL="@firebase/database-compat",PL="@firebase/functions",RL="@firebase/functions-compat",LL="@firebase/installations",DL="@firebase/installations-compat",ML="@firebase/messaging",OL="@firebase/messaging-compat",VL="@firebase/performance",jL="@firebase/performance-compat",FL="@firebase/remote-config",zL="@firebase/remote-config-compat",UL="@firebase/storage",$L="@firebase/storage-compat",BL="@firebase/firestore",qL="@firebase/vertexai-preview",WL="@firebase/firestore-compat",HL="firebase",GL="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pm="[DEFAULT]",KL={[dg]:"fire-core",[xL]:"fire-core-compat",[_L]:"fire-analytics",[wL]:"fire-analytics-compat",[CL]:"fire-app-check",[NL]:"fire-app-check-compat",[SL]:"fire-auth",[kL]:"fire-auth-compat",[IL]:"fire-rtdb",[TL]:"fire-data-connect",[AL]:"fire-rtdb-compat",[PL]:"fire-fn",[RL]:"fire-fn-compat",[LL]:"fire-iid",[DL]:"fire-iid-compat",[ML]:"fire-fcm",[OL]:"fire-fcm-compat",[VL]:"fire-perf",[jL]:"fire-perf-compat",[FL]:"fire-rc",[zL]:"fire-rc-compat",[UL]:"fire-gcs",[$L]:"fire-gcs-compat",[BL]:"fire-fst",[WL]:"fire-fst-compat",[qL]:"fire-vertex","fire-js":"fire-js",[HL]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fm=new Map,QL=new Map,mg=new Map;function ME(t,e){try{t.container.addComponent(e)}catch(n){ua.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function br(t){const e=t.name;if(mg.has(e))return ua.debug(`There were multiple attempts to register component ${e}.`),!1;mg.set(e,t);for(const n of fm.values())ME(n,t);for(const n of QL.values())ME(n,t);return!0}function ga(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function JL(t,e,n=pm){ga(t,e).clearInstance(n)}function Pr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YL={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},rs=new Ei("app","Firebase",YL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZL{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ir("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw rs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xi=GL;function HC(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:pm,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw rs.create("bad-app-name",{appName:String(s)});if(n||(n=FC()),!n)throw rs.create("no-options");const i=fm.get(s);if(i){if(is(n,i.options)&&is(r,i.config))return i;throw rs.create("duplicate-app",{appName:s})}const o=new aL(s);for(const c of mg.values())o.addComponent(c);const l=new ZL(n,r,o);return fm.set(s,l),l}function hp(t=pm){const e=fm.get(t);if(!e&&t===pm&&FC())return HC();if(!e)throw rs.create("no-app",{appName:t});return e}function jn(t,e,n){var r;let s=(r=KL[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ua.warn(l.join(" "));return}br(new ir(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL="firebase-heartbeat-database",eD=1,Ic="firebase-heartbeat-store";let zf=null;function GC(){return zf||(zf=fp(XL,eD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ic)}catch(n){console.warn(n)}}}}).catch(t=>{throw rs.create("idb-open",{originalErrorMessage:t.message})})),zf}async function tD(t){try{const n=(await GC()).transaction(Ic),r=await n.objectStore(Ic).get(KC(t));return await n.done,r}catch(e){if(e instanceof xr)ua.warn(e.message);else{const n=rs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ua.warn(n.message)}}}async function OE(t,e){try{const r=(await GC()).transaction(Ic,"readwrite");await r.objectStore(Ic).put(e,KC(t)),await r.done}catch(n){if(n instanceof xr)ua.warn(n.message);else{const r=rs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ua.warn(r.message)}}}function KC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nD=1024,rD=30*24*60*60*1e3;class aD{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new iD(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=VE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=rD}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ua.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=VE(),{heartbeatsToSend:r,unsentEntries:s}=sD(this._heartbeatsCache.heartbeats),i=mm(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return ua.warn(n),""}}}function VE(){return new Date().toISOString().substring(0,10)}function sD(t,e=nD){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),jE(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),jE(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class iD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Q0()?BC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await tD(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return OE(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return OE(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function jE(t){return mm(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oD(t){br(new ir("platform-logger",e=>new yL(e),"PRIVATE")),br(new ir("heartbeat",e=>new aD(e),"PRIVATE")),jn(dg,DE,t),jn(dg,DE,"esm2017"),jn("fire-js","")}oD("");var lD="firebase",cD="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jn(lD,cD,"app");var FE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ks,QC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,b){function w(){}w.prototype=b.prototype,N.D=b.prototype,N.prototype=new w,N.prototype.constructor=N,N.C=function(A,R,L){for(var M=Array(arguments.length-2),F=2;F<arguments.length;F++)M[F-2]=arguments[F];return b.prototype[R].apply(A,M)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(N,b,w){w||(w=0);var A=Array(16);if(typeof b=="string")for(var R=0;16>R;++R)A[R]=b.charCodeAt(w++)|b.charCodeAt(w++)<<8|b.charCodeAt(w++)<<16|b.charCodeAt(w++)<<24;else for(R=0;16>R;++R)A[R]=b[w++]|b[w++]<<8|b[w++]<<16|b[w++]<<24;b=N.g[0],w=N.g[1],R=N.g[2];var L=N.g[3],M=b+(L^w&(R^L))+A[0]+3614090360&4294967295;b=w+(M<<7&4294967295|M>>>25),M=L+(R^b&(w^R))+A[1]+3905402710&4294967295,L=b+(M<<12&4294967295|M>>>20),M=R+(w^L&(b^w))+A[2]+606105819&4294967295,R=L+(M<<17&4294967295|M>>>15),M=w+(b^R&(L^b))+A[3]+3250441966&4294967295,w=R+(M<<22&4294967295|M>>>10),M=b+(L^w&(R^L))+A[4]+4118548399&4294967295,b=w+(M<<7&4294967295|M>>>25),M=L+(R^b&(w^R))+A[5]+1200080426&4294967295,L=b+(M<<12&4294967295|M>>>20),M=R+(w^L&(b^w))+A[6]+2821735955&4294967295,R=L+(M<<17&4294967295|M>>>15),M=w+(b^R&(L^b))+A[7]+4249261313&4294967295,w=R+(M<<22&4294967295|M>>>10),M=b+(L^w&(R^L))+A[8]+1770035416&4294967295,b=w+(M<<7&4294967295|M>>>25),M=L+(R^b&(w^R))+A[9]+2336552879&4294967295,L=b+(M<<12&4294967295|M>>>20),M=R+(w^L&(b^w))+A[10]+4294925233&4294967295,R=L+(M<<17&4294967295|M>>>15),M=w+(b^R&(L^b))+A[11]+2304563134&4294967295,w=R+(M<<22&4294967295|M>>>10),M=b+(L^w&(R^L))+A[12]+1804603682&4294967295,b=w+(M<<7&4294967295|M>>>25),M=L+(R^b&(w^R))+A[13]+4254626195&4294967295,L=b+(M<<12&4294967295|M>>>20),M=R+(w^L&(b^w))+A[14]+2792965006&4294967295,R=L+(M<<17&4294967295|M>>>15),M=w+(b^R&(L^b))+A[15]+1236535329&4294967295,w=R+(M<<22&4294967295|M>>>10),M=b+(R^L&(w^R))+A[1]+4129170786&4294967295,b=w+(M<<5&4294967295|M>>>27),M=L+(w^R&(b^w))+A[6]+3225465664&4294967295,L=b+(M<<9&4294967295|M>>>23),M=R+(b^w&(L^b))+A[11]+643717713&4294967295,R=L+(M<<14&4294967295|M>>>18),M=w+(L^b&(R^L))+A[0]+3921069994&4294967295,w=R+(M<<20&4294967295|M>>>12),M=b+(R^L&(w^R))+A[5]+3593408605&4294967295,b=w+(M<<5&4294967295|M>>>27),M=L+(w^R&(b^w))+A[10]+38016083&4294967295,L=b+(M<<9&4294967295|M>>>23),M=R+(b^w&(L^b))+A[15]+3634488961&4294967295,R=L+(M<<14&4294967295|M>>>18),M=w+(L^b&(R^L))+A[4]+3889429448&4294967295,w=R+(M<<20&4294967295|M>>>12),M=b+(R^L&(w^R))+A[9]+568446438&4294967295,b=w+(M<<5&4294967295|M>>>27),M=L+(w^R&(b^w))+A[14]+3275163606&4294967295,L=b+(M<<9&4294967295|M>>>23),M=R+(b^w&(L^b))+A[3]+4107603335&4294967295,R=L+(M<<14&4294967295|M>>>18),M=w+(L^b&(R^L))+A[8]+1163531501&4294967295,w=R+(M<<20&4294967295|M>>>12),M=b+(R^L&(w^R))+A[13]+2850285829&4294967295,b=w+(M<<5&4294967295|M>>>27),M=L+(w^R&(b^w))+A[2]+4243563512&4294967295,L=b+(M<<9&4294967295|M>>>23),M=R+(b^w&(L^b))+A[7]+1735328473&4294967295,R=L+(M<<14&4294967295|M>>>18),M=w+(L^b&(R^L))+A[12]+2368359562&4294967295,w=R+(M<<20&4294967295|M>>>12),M=b+(w^R^L)+A[5]+4294588738&4294967295,b=w+(M<<4&4294967295|M>>>28),M=L+(b^w^R)+A[8]+2272392833&4294967295,L=b+(M<<11&4294967295|M>>>21),M=R+(L^b^w)+A[11]+1839030562&4294967295,R=L+(M<<16&4294967295|M>>>16),M=w+(R^L^b)+A[14]+4259657740&4294967295,w=R+(M<<23&4294967295|M>>>9),M=b+(w^R^L)+A[1]+2763975236&4294967295,b=w+(M<<4&4294967295|M>>>28),M=L+(b^w^R)+A[4]+1272893353&4294967295,L=b+(M<<11&4294967295|M>>>21),M=R+(L^b^w)+A[7]+4139469664&4294967295,R=L+(M<<16&4294967295|M>>>16),M=w+(R^L^b)+A[10]+3200236656&4294967295,w=R+(M<<23&4294967295|M>>>9),M=b+(w^R^L)+A[13]+681279174&4294967295,b=w+(M<<4&4294967295|M>>>28),M=L+(b^w^R)+A[0]+3936430074&4294967295,L=b+(M<<11&4294967295|M>>>21),M=R+(L^b^w)+A[3]+3572445317&4294967295,R=L+(M<<16&4294967295|M>>>16),M=w+(R^L^b)+A[6]+76029189&4294967295,w=R+(M<<23&4294967295|M>>>9),M=b+(w^R^L)+A[9]+3654602809&4294967295,b=w+(M<<4&4294967295|M>>>28),M=L+(b^w^R)+A[12]+3873151461&4294967295,L=b+(M<<11&4294967295|M>>>21),M=R+(L^b^w)+A[15]+530742520&4294967295,R=L+(M<<16&4294967295|M>>>16),M=w+(R^L^b)+A[2]+3299628645&4294967295,w=R+(M<<23&4294967295|M>>>9),M=b+(R^(w|~L))+A[0]+4096336452&4294967295,b=w+(M<<6&4294967295|M>>>26),M=L+(w^(b|~R))+A[7]+1126891415&4294967295,L=b+(M<<10&4294967295|M>>>22),M=R+(b^(L|~w))+A[14]+2878612391&4294967295,R=L+(M<<15&4294967295|M>>>17),M=w+(L^(R|~b))+A[5]+4237533241&4294967295,w=R+(M<<21&4294967295|M>>>11),M=b+(R^(w|~L))+A[12]+1700485571&4294967295,b=w+(M<<6&4294967295|M>>>26),M=L+(w^(b|~R))+A[3]+2399980690&4294967295,L=b+(M<<10&4294967295|M>>>22),M=R+(b^(L|~w))+A[10]+4293915773&4294967295,R=L+(M<<15&4294967295|M>>>17),M=w+(L^(R|~b))+A[1]+2240044497&4294967295,w=R+(M<<21&4294967295|M>>>11),M=b+(R^(w|~L))+A[8]+1873313359&4294967295,b=w+(M<<6&4294967295|M>>>26),M=L+(w^(b|~R))+A[15]+4264355552&4294967295,L=b+(M<<10&4294967295|M>>>22),M=R+(b^(L|~w))+A[6]+2734768916&4294967295,R=L+(M<<15&4294967295|M>>>17),M=w+(L^(R|~b))+A[13]+1309151649&4294967295,w=R+(M<<21&4294967295|M>>>11),M=b+(R^(w|~L))+A[4]+4149444226&4294967295,b=w+(M<<6&4294967295|M>>>26),M=L+(w^(b|~R))+A[11]+3174756917&4294967295,L=b+(M<<10&4294967295|M>>>22),M=R+(b^(L|~w))+A[2]+718787259&4294967295,R=L+(M<<15&4294967295|M>>>17),M=w+(L^(R|~b))+A[9]+3951481745&4294967295,N.g[0]=N.g[0]+b&4294967295,N.g[1]=N.g[1]+(R+(M<<21&4294967295|M>>>11))&4294967295,N.g[2]=N.g[2]+R&4294967295,N.g[3]=N.g[3]+L&4294967295}r.prototype.u=function(N,b){b===void 0&&(b=N.length);for(var w=b-this.blockSize,A=this.B,R=this.h,L=0;L<b;){if(R==0)for(;L<=w;)s(this,N,L),L+=this.blockSize;if(typeof N=="string"){for(;L<b;)if(A[R++]=N.charCodeAt(L++),R==this.blockSize){s(this,A),R=0;break}}else for(;L<b;)if(A[R++]=N[L++],R==this.blockSize){s(this,A),R=0;break}}this.h=R,this.o+=b},r.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var b=1;b<N.length-8;++b)N[b]=0;var w=8*this.o;for(b=N.length-8;b<N.length;++b)N[b]=w&255,w/=256;for(this.u(N),N=Array(16),b=w=0;4>b;++b)for(var A=0;32>A;A+=8)N[w++]=this.g[b]>>>A&255;return N};function i(N,b){var w=l;return Object.prototype.hasOwnProperty.call(w,N)?w[N]:w[N]=b(N)}function o(N,b){this.h=b;for(var w=[],A=!0,R=N.length-1;0<=R;R--){var L=N[R]|0;A&&L==b||(w[R]=L,A=!1)}this.g=w}var l={};function c(N){return-128<=N&&128>N?i(N,function(b){return new o([b|0],0>b?-1:0)}):new o([N|0],0>N?-1:0)}function u(N){if(isNaN(N)||!isFinite(N))return f;if(0>N)return y(u(-N));for(var b=[],w=1,A=0;N>=w;A++)b[A]=N/w|0,w*=4294967296;return new o(b,0)}function d(N,b){if(N.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(N.charAt(0)=="-")return y(d(N.substring(1),b));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=u(Math.pow(b,8)),A=f,R=0;R<N.length;R+=8){var L=Math.min(8,N.length-R),M=parseInt(N.substring(R,R+L),b);8>L?(L=u(Math.pow(b,L)),A=A.j(L).add(u(M))):(A=A.j(w),A=A.add(u(M)))}return A}var f=c(0),g=c(1),v=c(16777216);t=o.prototype,t.m=function(){if(E(this))return-y(this).m();for(var N=0,b=1,w=0;w<this.g.length;w++){var A=this.i(w);N+=(0<=A?A:4294967296+A)*b,b*=4294967296}return N},t.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(x(this))return"0";if(E(this))return"-"+y(this).toString(N);for(var b=u(Math.pow(N,6)),w=this,A="";;){var R=k(w,b).g;w=h(w,R.j(b));var L=((0<w.g.length?w.g[0]:w.h)>>>0).toString(N);if(w=R,x(w))return L+A;for(;6>L.length;)L="0"+L;A=L+A}},t.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function x(N){if(N.h!=0)return!1;for(var b=0;b<N.g.length;b++)if(N.g[b]!=0)return!1;return!0}function E(N){return N.h==-1}t.l=function(N){return N=h(this,N),E(N)?-1:x(N)?0:1};function y(N){for(var b=N.g.length,w=[],A=0;A<b;A++)w[A]=~N.g[A];return new o(w,~N.h).add(g)}t.abs=function(){return E(this)?y(this):this},t.add=function(N){for(var b=Math.max(this.g.length,N.g.length),w=[],A=0,R=0;R<=b;R++){var L=A+(this.i(R)&65535)+(N.i(R)&65535),M=(L>>>16)+(this.i(R)>>>16)+(N.i(R)>>>16);A=M>>>16,L&=65535,M&=65535,w[R]=M<<16|L}return new o(w,w[w.length-1]&-2147483648?-1:0)};function h(N,b){return N.add(y(b))}t.j=function(N){if(x(this)||x(N))return f;if(E(this))return E(N)?y(this).j(y(N)):y(y(this).j(N));if(E(N))return y(this.j(y(N)));if(0>this.l(v)&&0>N.l(v))return u(this.m()*N.m());for(var b=this.g.length+N.g.length,w=[],A=0;A<2*b;A++)w[A]=0;for(A=0;A<this.g.length;A++)for(var R=0;R<N.g.length;R++){var L=this.i(A)>>>16,M=this.i(A)&65535,F=N.i(R)>>>16,U=N.i(R)&65535;w[2*A+2*R]+=M*U,C(w,2*A+2*R),w[2*A+2*R+1]+=L*U,C(w,2*A+2*R+1),w[2*A+2*R+1]+=M*F,C(w,2*A+2*R+1),w[2*A+2*R+2]+=L*F,C(w,2*A+2*R+2)}for(A=0;A<b;A++)w[A]=w[2*A+1]<<16|w[2*A];for(A=b;A<2*b;A++)w[A]=0;return new o(w,0)};function C(N,b){for(;(N[b]&65535)!=N[b];)N[b+1]+=N[b]>>>16,N[b]&=65535,b++}function T(N,b){this.g=N,this.h=b}function k(N,b){if(x(b))throw Error("division by zero");if(x(N))return new T(f,f);if(E(N))return b=k(y(N),b),new T(y(b.g),y(b.h));if(E(b))return b=k(N,y(b)),new T(y(b.g),b.h);if(30<N.g.length){if(E(N)||E(b))throw Error("slowDivide_ only works with positive integers.");for(var w=g,A=b;0>=A.l(N);)w=_(w),A=_(A);var R=S(w,1),L=S(A,1);for(A=S(A,2),w=S(w,2);!x(A);){var M=L.add(A);0>=M.l(N)&&(R=R.add(w),L=M),A=S(A,1),w=S(w,1)}return b=h(N,R.j(b)),new T(R,b)}for(R=f;0<=N.l(b);){for(w=Math.max(1,Math.floor(N.m()/b.m())),A=Math.ceil(Math.log(w)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),L=u(w),M=L.j(b);E(M)||0<M.l(N);)w-=A,L=u(w),M=L.j(b);x(L)&&(L=g),R=R.add(L),N=h(N,M)}return new T(R,N)}t.A=function(N){return k(this,N).h},t.and=function(N){for(var b=Math.max(this.g.length,N.g.length),w=[],A=0;A<b;A++)w[A]=this.i(A)&N.i(A);return new o(w,this.h&N.h)},t.or=function(N){for(var b=Math.max(this.g.length,N.g.length),w=[],A=0;A<b;A++)w[A]=this.i(A)|N.i(A);return new o(w,this.h|N.h)},t.xor=function(N){for(var b=Math.max(this.g.length,N.g.length),w=[],A=0;A<b;A++)w[A]=this.i(A)^N.i(A);return new o(w,this.h^N.h)};function _(N){for(var b=N.g.length+1,w=[],A=0;A<b;A++)w[A]=N.i(A)<<1|N.i(A-1)>>>31;return new o(w,N.h)}function S(N,b){var w=b>>5;b%=32;for(var A=N.g.length-w,R=[],L=0;L<A;L++)R[L]=0<b?N.i(L+w)>>>b|N.i(L+w+1)<<32-b:N.i(L+w);return new o(R,N.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,QC=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Ks=o}).apply(typeof FE<"u"?FE:typeof self<"u"?self:typeof window<"u"?window:{});var Xu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var JC,ql,YC,kd,pg,ZC,XC,eS;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(m,I,P){return m==Array.prototype||m==Object.prototype||(m[I]=P.value),m};function n(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Xu=="object"&&Xu];for(var I=0;I<m.length;++I){var P=m[I];if(P&&P.Math==Math)return P}throw Error("Cannot find global object")}var r=n(this);function s(m,I){if(I)e:{var P=r;m=m.split(".");for(var O=0;O<m.length-1;O++){var B=m[O];if(!(B in P))break e;P=P[B]}m=m[m.length-1],O=P[m],I=I(O),I!=O&&I!=null&&e(P,m,{configurable:!0,writable:!0,value:I})}}function i(m,I){m instanceof String&&(m+="");var P=0,O=!1,B={next:function(){if(!O&&P<m.length){var J=P++;return{value:I(J,m[J]),done:!1}}return O=!0,{done:!0,value:void 0}}};return B[Symbol.iterator]=function(){return B},B}s("Array.prototype.values",function(m){return m||function(){return i(this,function(I,P){return P})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(m){var I=typeof m;return I=I!="object"?I:m?Array.isArray(m)?"array":I:"null",I=="array"||I=="object"&&typeof m.length=="number"}function u(m){var I=typeof m;return I=="object"&&m!=null||I=="function"}function d(m,I,P){return m.call.apply(m.bind,arguments)}function f(m,I,P){if(!m)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var B=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(B,O),m.apply(I,B)}}return function(){return m.apply(I,arguments)}}function g(m,I,P){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,g.apply(null,arguments)}function v(m,I){var P=Array.prototype.slice.call(arguments,1);return function(){var O=P.slice();return O.push.apply(O,arguments),m.apply(this,O)}}function x(m,I){function P(){}P.prototype=I.prototype,m.aa=I.prototype,m.prototype=new P,m.prototype.constructor=m,m.Qb=function(O,B,J){for(var ce=Array(arguments.length-2),at=2;at<arguments.length;at++)ce[at-2]=arguments[at];return I.prototype[B].apply(O,ce)}}function E(m){const I=m.length;if(0<I){const P=Array(I);for(let O=0;O<I;O++)P[O]=m[O];return P}return[]}function y(m,I){for(let P=1;P<arguments.length;P++){const O=arguments[P];if(c(O)){const B=m.length||0,J=O.length||0;m.length=B+J;for(let ce=0;ce<J;ce++)m[B+ce]=O[ce]}else m.push(O)}}class h{constructor(I,P){this.i=I,this.j=P,this.h=0,this.g=null}get(){let I;return 0<this.h?(this.h--,I=this.g,this.g=I.next,I.next=null):I=this.i(),I}}function C(m){return/^[\s\xa0]*$/.test(m)}function T(){var m=l.navigator;return m&&(m=m.userAgent)?m:""}function k(m){return k[" "](m),m}k[" "]=function(){};var _=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function S(m,I,P){for(const O in m)I.call(P,m[O],O,m)}function N(m,I){for(const P in m)I.call(void 0,m[P],P,m)}function b(m){const I={};for(const P in m)I[P]=m[P];return I}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(m,I){let P,O;for(let B=1;B<arguments.length;B++){O=arguments[B];for(P in O)m[P]=O[P];for(let J=0;J<w.length;J++)P=w[J],Object.prototype.hasOwnProperty.call(O,P)&&(m[P]=O[P])}}function R(m){var I=1;m=m.split(":");const P=[];for(;0<I&&m.length;)P.push(m.shift()),I--;return m.length&&P.push(m.join(":")),P}function L(m){l.setTimeout(()=>{throw m},0)}function M(){var m=z;let I=null;return m.g&&(I=m.g,m.g=m.g.next,m.g||(m.h=null),I.next=null),I}class F{constructor(){this.h=this.g=null}add(I,P){const O=U.get();O.set(I,P),this.h?this.h.next=O:this.g=O,this.h=O}}var U=new h(()=>new D,m=>m.reset());class D{constructor(){this.next=this.g=this.h=null}set(I,P){this.h=I,this.g=P,this.next=null}reset(){this.next=this.g=this.h=null}}let j,V=!1,z=new F,G=()=>{const m=l.Promise.resolve(void 0);j=()=>{m.then(Y)}};var Y=()=>{for(var m;m=M();){try{m.h.call(m.g)}catch(P){L(P)}var I=U;I.j(m),100>I.h&&(I.h++,m.next=I.g,I.g=m)}V=!1};function Z(){this.s=this.s,this.C=this.C}Z.prototype.s=!1,Z.prototype.ma=function(){this.s||(this.s=!0,this.N())},Z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(m,I){this.type=m,this.g=this.target=I,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var oe=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var m=!1,I=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const P=()=>{};l.addEventListener("test",P,I),l.removeEventListener("test",P,I)}catch{}return m}();function W(m,I){if(H.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m){var P=this.type=m.type,O=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;if(this.target=m.target||m.srcElement,this.g=I,I=m.relatedTarget){if(_){e:{try{k(I.nodeName);var B=!0;break e}catch{}B=!1}B||(I=null)}}else P=="mouseover"?I=m.fromElement:P=="mouseout"&&(I=m.toElement);this.relatedTarget=I,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=typeof m.pointerType=="string"?m.pointerType:he[m.pointerType]||"",this.state=m.state,this.i=m,m.defaultPrevented&&W.aa.h.call(this)}}x(W,H);var he={2:"touch",3:"pen",4:"mouse"};W.prototype.h=function(){W.aa.h.call(this);var m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var xe="closure_listenable_"+(1e6*Math.random()|0),ie=0;function be(m,I,P,O,B){this.listener=m,this.proxy=null,this.src=I,this.type=P,this.capture=!!O,this.ha=B,this.key=++ie,this.da=this.fa=!1}function ne(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function re(m){this.src=m,this.g={},this.h=0}re.prototype.add=function(m,I,P,O,B){var J=m.toString();m=this.g[J],m||(m=this.g[J]=[],this.h++);var ce=Oe(m,I,O,B);return-1<ce?(I=m[ce],P||(I.fa=!1)):(I=new be(I,this.src,J,!!O,B),I.fa=P,m.push(I)),I};function Se(m,I){var P=I.type;if(P in m.g){var O=m.g[P],B=Array.prototype.indexOf.call(O,I,void 0),J;(J=0<=B)&&Array.prototype.splice.call(O,B,1),J&&(ne(I),m.g[P].length==0&&(delete m.g[P],m.h--))}}function Oe(m,I,P,O){for(var B=0;B<m.length;++B){var J=m[B];if(!J.da&&J.listener==I&&J.capture==!!P&&J.ha==O)return B}return-1}var je="closure_lm_"+(1e6*Math.random()|0),Ee={};function Re(m,I,P,O,B){if(O&&O.once)return qe(m,I,P,O,B);if(Array.isArray(I)){for(var J=0;J<I.length;J++)Re(m,I[J],P,O,B);return null}return P=Pe(P),m&&m[xe]?m.K(I,P,u(O)?!!O.capture:!!O,B):ot(m,I,P,!1,O,B)}function ot(m,I,P,O,B,J){if(!I)throw Error("Invalid event type");var ce=u(B)?!!B.capture:!!B,at=ae(m);if(at||(m[je]=at=new re(m)),P=at.add(I,P,O,ce,J),P.proxy)return P;if(O=ke(),P.proxy=O,O.src=m,O.listener=P,m.addEventListener)oe||(B=ce),B===void 0&&(B=!1),m.addEventListener(I.toString(),O,B);else if(m.attachEvent)m.attachEvent(Kt(I.toString()),O);else if(m.addListener&&m.removeListener)m.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return P}function ke(){function m(P){return I.call(m.src,m.listener,P)}const I=In;return m}function qe(m,I,P,O,B){if(Array.isArray(I)){for(var J=0;J<I.length;J++)qe(m,I[J],P,O,B);return null}return P=Pe(P),m&&m[xe]?m.L(I,P,u(O)?!!O.capture:!!O,B):ot(m,I,P,!0,O,B)}function zt(m,I,P,O,B){if(Array.isArray(I))for(var J=0;J<I.length;J++)zt(m,I[J],P,O,B);else O=u(O)?!!O.capture:!!O,P=Pe(P),m&&m[xe]?(m=m.i,I=String(I).toString(),I in m.g&&(J=m.g[I],P=Oe(J,P,O,B),-1<P&&(ne(J[P]),Array.prototype.splice.call(J,P,1),J.length==0&&(delete m.g[I],m.h--)))):m&&(m=ae(m))&&(I=m.g[I.toString()],m=-1,I&&(m=Oe(I,P,O,B)),(P=-1<m?I[m]:null)&&tn(P))}function tn(m){if(typeof m!="number"&&m&&!m.da){var I=m.src;if(I&&I[xe])Se(I.i,m);else{var P=m.type,O=m.proxy;I.removeEventListener?I.removeEventListener(P,O,m.capture):I.detachEvent?I.detachEvent(Kt(P),O):I.addListener&&I.removeListener&&I.removeListener(O),(P=ae(I))?(Se(P,m),P.h==0&&(P.src=null,I[je]=null)):ne(m)}}}function Kt(m){return m in Ee?Ee[m]:Ee[m]="on"+m}function In(m,I){if(m.da)m=!0;else{I=new W(I,this);var P=m.listener,O=m.ha||m.src;m.fa&&tn(m),m=P.call(O,I)}return m}function ae(m){return m=m[je],m instanceof re?m:null}var ge="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pe(m){return typeof m=="function"?m:(m[ge]||(m[ge]=function(I){return m.handleEvent(I)}),m[ge])}function Ce(){Z.call(this),this.i=new re(this),this.M=this,this.F=null}x(Ce,Z),Ce.prototype[xe]=!0,Ce.prototype.removeEventListener=function(m,I,P,O){zt(this,m,I,P,O)};function Le(m,I){var P,O=m.F;if(O)for(P=[];O;O=O.F)P.push(O);if(m=m.M,O=I.type||I,typeof I=="string")I=new H(I,m);else if(I instanceof H)I.target=I.target||m;else{var B=I;I=new H(O,m),A(I,B)}if(B=!0,P)for(var J=P.length-1;0<=J;J--){var ce=I.g=P[J];B=Ut(ce,O,!0,I)&&B}if(ce=I.g=m,B=Ut(ce,O,!0,I)&&B,B=Ut(ce,O,!1,I)&&B,P)for(J=0;J<P.length;J++)ce=I.g=P[J],B=Ut(ce,O,!1,I)&&B}Ce.prototype.N=function(){if(Ce.aa.N.call(this),this.i){var m=this.i,I;for(I in m.g){for(var P=m.g[I],O=0;O<P.length;O++)ne(P[O]);delete m.g[I],m.h--}}this.F=null},Ce.prototype.K=function(m,I,P,O){return this.i.add(String(m),I,!1,P,O)},Ce.prototype.L=function(m,I,P,O){return this.i.add(String(m),I,!0,P,O)};function Ut(m,I,P,O){if(I=m.i.g[String(I)],!I)return!0;I=I.concat();for(var B=!0,J=0;J<I.length;++J){var ce=I[J];if(ce&&!ce.da&&ce.capture==P){var at=ce.listener,nn=ce.ha||ce.src;ce.fa&&Se(m.i,ce),B=at.call(nn,O)!==!1&&B}}return B&&!O.defaultPrevented}function xn(m,I,P){if(typeof m=="function")P&&(m=g(m,P));else if(m&&typeof m.handleEvent=="function")m=g(m.handleEvent,m);else throw Error("Invalid listener argument");return 2147483647<Number(I)?-1:l.setTimeout(m,I||0)}function Qt(m){m.g=xn(()=>{m.g=null,m.i&&(m.i=!1,Qt(m))},m.l);const I=m.h;m.h=null,m.m.apply(null,I)}class $t extends Z{constructor(I,P){super(),this.m=I,this.l=P,this.h=null,this.i=!1,this.g=null}j(I){this.h=arguments,this.g?this.i=!0:Qt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Vt(m){Z.call(this),this.h=m,this.g={}}x(Vt,Z);var zn=[];function cr(m){S(m.g,function(I,P){this.g.hasOwnProperty(P)&&tn(I)},m),m.g={}}Vt.prototype.N=function(){Vt.aa.N.call(this),cr(this)},Vt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Nr=l.JSON.stringify,Cr=l.JSON.parse,xa=class{stringify(m){return l.JSON.stringify(m,void 0)}parse(m){return l.JSON.parse(m,void 0)}};function Sr(){}Sr.prototype.h=null;function il(m){return m.h||(m.h=m.i())}function ol(){}var wa={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function _a(){H.call(this,"d")}x(_a,H);function Ii(){H.call(this,"c")}x(Ii,H);var Zn={},ll=null;function Br(){return ll=ll||new Ce}Zn.La="serverreachability";function cl(m){H.call(this,Zn.La,m)}x(cl,H);function Cs(m){const I=Br();Le(I,new cl(I))}Zn.STAT_EVENT="statevent";function Na(m,I){H.call(this,Zn.STAT_EVENT,m),this.stat=I}x(Na,H);function Ne(m){const I=Br();Le(I,new Na(I,m))}Zn.Ma="timingevent";function Mb(m,I){H.call(this,Zn.Ma,m),this.size=I}x(Mb,H);function ul(m,I){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){m()},I)}function dl(){this.g=!0}dl.prototype.xa=function(){this.g=!1};function WT(m,I,P,O,B,J){m.info(function(){if(m.g)if(J)for(var ce="",at=J.split("&"),nn=0;nn<at.length;nn++){var Ze=at[nn].split("=");if(1<Ze.length){var un=Ze[0];Ze=Ze[1];var dn=un.split("_");ce=2<=dn.length&&dn[1]=="type"?ce+(un+"="+Ze+"&"):ce+(un+"=redacted&")}}else ce=null;else ce=J;return"XMLHTTP REQ ("+O+") [attempt "+B+"]: "+I+`
`+P+`
`+ce})}function HT(m,I,P,O,B,J,ce){m.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+B+"]: "+I+`
`+P+`
`+J+" "+ce})}function Ti(m,I,P,O){m.info(function(){return"XMLHTTP TEXT ("+I+"): "+KT(m,P)+(O?" "+O:"")})}function GT(m,I){m.info(function(){return"TIMEOUT: "+I})}dl.prototype.info=function(){};function KT(m,I){if(!m.g)return I;if(!I)return null;try{var P=JSON.parse(I);if(P){for(m=0;m<P.length;m++)if(Array.isArray(P[m])){var O=P[m];if(!(2>O.length)){var B=O[1];if(Array.isArray(B)&&!(1>B.length)){var J=B[0];if(J!="noop"&&J!="stop"&&J!="close")for(var ce=1;ce<B.length;ce++)B[ce]=""}}}}return Nr(P)}catch{return I}}var wu={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ob={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Jp;function _u(){}x(_u,Sr),_u.prototype.g=function(){return new XMLHttpRequest},_u.prototype.i=function(){return{}},Jp=new _u;function Ca(m,I,P,O){this.j=m,this.i=I,this.l=P,this.R=O||1,this.U=new Vt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Vb}function Vb(){this.i=null,this.g="",this.h=!1}var jb={},Yp={};function Zp(m,I,P){m.L=1,m.v=ku(qr(I)),m.m=P,m.P=!0,Fb(m,null)}function Fb(m,I){m.F=Date.now(),Nu(m),m.A=qr(m.v);var P=m.A,O=m.R;Array.isArray(O)||(O=[String(O)]),Xb(P.i,"t",O),m.C=0,P=m.j.J,m.h=new Vb,m.g=vy(m.j,P?I:null,!m.m),0<m.O&&(m.M=new $t(g(m.Y,m,m.g),m.O)),I=m.U,P=m.g,O=m.ca;var B="readystatechange";Array.isArray(B)||(B&&(zn[0]=B.toString()),B=zn);for(var J=0;J<B.length;J++){var ce=Re(P,B[J],O||I.handleEvent,!1,I.h||I);if(!ce)break;I.g[ce.key]=ce}I=m.H?b(m.H):{},m.m?(m.u||(m.u="POST"),I["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.A,m.u,m.m,I)):(m.u="GET",m.g.ea(m.A,m.u,null,I)),Cs(),WT(m.i,m.u,m.A,m.l,m.R,m.m)}Ca.prototype.ca=function(m){m=m.target;const I=this.M;I&&Wr(m)==3?I.j():this.Y(m)},Ca.prototype.Y=function(m){try{if(m==this.g)e:{const dn=Wr(this.g);var I=this.g.Ba();const Ri=this.g.Z();if(!(3>dn)&&(dn!=3||this.g&&(this.h.h||this.g.oa()||iy(this.g)))){this.J||dn!=4||I==7||(I==8||0>=Ri?Cs(3):Cs(2)),Xp(this);var P=this.g.Z();this.X=P;t:if(zb(this)){var O=iy(this.g);m="";var B=O.length,J=Wr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ss(this),ml(this);var ce="";break t}this.h.i=new l.TextDecoder}for(I=0;I<B;I++)this.h.h=!0,m+=this.h.i.decode(O[I],{stream:!(J&&I==B-1)});O.length=0,this.h.g+=m,this.C=0,ce=this.h.g}else ce=this.g.oa();if(this.o=P==200,HT(this.i,this.u,this.A,this.l,this.R,dn,P),this.o){if(this.T&&!this.K){t:{if(this.g){var at,nn=this.g;if((at=nn.g?nn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(at)){var Ze=at;break t}}Ze=null}if(P=Ze)Ti(this.i,this.l,P,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ef(this,P);else{this.o=!1,this.s=3,Ne(12),Ss(this),ml(this);break e}}if(this.P){P=!0;let ur;for(;!this.J&&this.C<ce.length;)if(ur=QT(this,ce),ur==Yp){dn==4&&(this.s=4,Ne(14),P=!1),Ti(this.i,this.l,null,"[Incomplete Response]");break}else if(ur==jb){this.s=4,Ne(15),Ti(this.i,this.l,ce,"[Invalid Chunk]"),P=!1;break}else Ti(this.i,this.l,ur,null),ef(this,ur);if(zb(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),dn!=4||ce.length!=0||this.h.h||(this.s=1,Ne(16),P=!1),this.o=this.o&&P,!P)Ti(this.i,this.l,ce,"[Invalid Chunked Response]"),Ss(this),ml(this);else if(0<ce.length&&!this.W){this.W=!0;var un=this.j;un.g==this&&un.ba&&!un.M&&(un.j.info("Great, no buffering proxy detected. Bytes received: "+ce.length),of(un),un.M=!0,Ne(11))}}else Ti(this.i,this.l,ce,null),ef(this,ce);dn==4&&Ss(this),this.o&&!this.J&&(dn==4?py(this.j,this):(this.o=!1,Nu(this)))}else mA(this.g),P==400&&0<ce.indexOf("Unknown SID")?(this.s=3,Ne(12)):(this.s=0,Ne(13)),Ss(this),ml(this)}}}catch{}finally{}};function zb(m){return m.g?m.u=="GET"&&m.L!=2&&m.j.Ca:!1}function QT(m,I){var P=m.C,O=I.indexOf(`
`,P);return O==-1?Yp:(P=Number(I.substring(P,O)),isNaN(P)?jb:(O+=1,O+P>I.length?Yp:(I=I.slice(O,O+P),m.C=O+P,I)))}Ca.prototype.cancel=function(){this.J=!0,Ss(this)};function Nu(m){m.S=Date.now()+m.I,Ub(m,m.I)}function Ub(m,I){if(m.B!=null)throw Error("WatchDog timer not null");m.B=ul(g(m.ba,m),I)}function Xp(m){m.B&&(l.clearTimeout(m.B),m.B=null)}Ca.prototype.ba=function(){this.B=null;const m=Date.now();0<=m-this.S?(GT(this.i,this.A),this.L!=2&&(Cs(),Ne(17)),Ss(this),this.s=2,ml(this)):Ub(this,this.S-m)};function ml(m){m.j.G==0||m.J||py(m.j,m)}function Ss(m){Xp(m);var I=m.M;I&&typeof I.ma=="function"&&I.ma(),m.M=null,cr(m.U),m.g&&(I=m.g,m.g=null,I.abort(),I.ma())}function ef(m,I){try{var P=m.j;if(P.G!=0&&(P.g==m||tf(P.h,m))){if(!m.K&&tf(P.h,m)&&P.G==3){try{var O=P.Da.g.parse(I)}catch{O=null}if(Array.isArray(O)&&O.length==3){var B=O;if(B[0]==0){e:if(!P.u){if(P.g)if(P.g.F+3e3<m.F)Lu(P),Pu(P);else break e;sf(P),Ne(18)}}else P.za=B[1],0<P.za-P.T&&37500>B[2]&&P.F&&P.v==0&&!P.C&&(P.C=ul(g(P.Za,P),6e3));if(1>=qb(P.h)&&P.ca){try{P.ca()}catch{}P.ca=void 0}}else Is(P,11)}else if((m.K||P.g==m)&&Lu(P),!C(I))for(B=P.Da.g.parse(I),I=0;I<B.length;I++){let Ze=B[I];if(P.T=Ze[0],Ze=Ze[1],P.G==2)if(Ze[0]=="c"){P.K=Ze[1],P.ia=Ze[2];const un=Ze[3];un!=null&&(P.la=un,P.j.info("VER="+P.la));const dn=Ze[4];dn!=null&&(P.Aa=dn,P.j.info("SVER="+P.Aa));const Ri=Ze[5];Ri!=null&&typeof Ri=="number"&&0<Ri&&(O=1.5*Ri,P.L=O,P.j.info("backChannelRequestTimeoutMs_="+O)),O=P;const ur=m.g;if(ur){const Mu=ur.g?ur.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Mu){var J=O.h;J.g||Mu.indexOf("spdy")==-1&&Mu.indexOf("quic")==-1&&Mu.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(nf(J,J.h),J.h=null))}if(O.D){const lf=ur.g?ur.g.getResponseHeader("X-HTTP-Session-Id"):null;lf&&(O.ya=lf,ut(O.I,O.D,lf))}}P.G=3,P.l&&P.l.ua(),P.ba&&(P.R=Date.now()-m.F,P.j.info("Handshake RTT: "+P.R+"ms")),O=P;var ce=m;if(O.qa=gy(O,O.J?O.ia:null,O.W),ce.K){Wb(O.h,ce);var at=ce,nn=O.L;nn&&(at.I=nn),at.B&&(Xp(at),Nu(at)),O.g=ce}else dy(O);0<P.i.length&&Ru(P)}else Ze[0]!="stop"&&Ze[0]!="close"||Is(P,7);else P.G==3&&(Ze[0]=="stop"||Ze[0]=="close"?Ze[0]=="stop"?Is(P,7):af(P):Ze[0]!="noop"&&P.l&&P.l.ta(Ze),P.v=0)}}Cs(4)}catch{}}var JT=class{constructor(m,I){this.g=m,this.map=I}};function $b(m){this.l=m||10,l.PerformanceNavigationTiming?(m=l.performance.getEntriesByType("navigation"),m=0<m.length&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Bb(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function qb(m){return m.h?1:m.g?m.g.size:0}function tf(m,I){return m.h?m.h==I:m.g?m.g.has(I):!1}function nf(m,I){m.g?m.g.add(I):m.h=I}function Wb(m,I){m.h&&m.h==I?m.h=null:m.g&&m.g.has(I)&&m.g.delete(I)}$b.prototype.cancel=function(){if(this.i=Hb(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function Hb(m){if(m.h!=null)return m.i.concat(m.h.D);if(m.g!=null&&m.g.size!==0){let I=m.i;for(const P of m.g.values())I=I.concat(P.D);return I}return E(m.i)}function YT(m){if(m.V&&typeof m.V=="function")return m.V();if(typeof Map<"u"&&m instanceof Map||typeof Set<"u"&&m instanceof Set)return Array.from(m.values());if(typeof m=="string")return m.split("");if(c(m)){for(var I=[],P=m.length,O=0;O<P;O++)I.push(m[O]);return I}I=[],P=0;for(O in m)I[P++]=m[O];return I}function ZT(m){if(m.na&&typeof m.na=="function")return m.na();if(!m.V||typeof m.V!="function"){if(typeof Map<"u"&&m instanceof Map)return Array.from(m.keys());if(!(typeof Set<"u"&&m instanceof Set)){if(c(m)||typeof m=="string"){var I=[];m=m.length;for(var P=0;P<m;P++)I.push(P);return I}I=[],P=0;for(const O in m)I[P++]=O;return I}}}function Gb(m,I){if(m.forEach&&typeof m.forEach=="function")m.forEach(I,void 0);else if(c(m)||typeof m=="string")Array.prototype.forEach.call(m,I,void 0);else for(var P=ZT(m),O=YT(m),B=O.length,J=0;J<B;J++)I.call(void 0,O[J],P&&P[J],m)}var Kb=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function XT(m,I){if(m){m=m.split("&");for(var P=0;P<m.length;P++){var O=m[P].indexOf("="),B=null;if(0<=O){var J=m[P].substring(0,O);B=m[P].substring(O+1)}else J=m[P];I(J,B?decodeURIComponent(B.replace(/\+/g," ")):"")}}}function ks(m){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,m instanceof ks){this.h=m.h,Cu(this,m.j),this.o=m.o,this.g=m.g,Su(this,m.s),this.l=m.l;var I=m.i,P=new hl;P.i=I.i,I.g&&(P.g=new Map(I.g),P.h=I.h),Qb(this,P),this.m=m.m}else m&&(I=String(m).match(Kb))?(this.h=!1,Cu(this,I[1]||"",!0),this.o=pl(I[2]||""),this.g=pl(I[3]||"",!0),Su(this,I[4]),this.l=pl(I[5]||"",!0),Qb(this,I[6]||"",!0),this.m=pl(I[7]||"")):(this.h=!1,this.i=new hl(null,this.h))}ks.prototype.toString=function(){var m=[],I=this.j;I&&m.push(fl(I,Jb,!0),":");var P=this.g;return(P||I=="file")&&(m.push("//"),(I=this.o)&&m.push(fl(I,Jb,!0),"@"),m.push(encodeURIComponent(String(P)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),P=this.s,P!=null&&m.push(":",String(P))),(P=this.l)&&(this.g&&P.charAt(0)!="/"&&m.push("/"),m.push(fl(P,P.charAt(0)=="/"?nA:tA,!0))),(P=this.i.toString())&&m.push("?",P),(P=this.m)&&m.push("#",fl(P,aA)),m.join("")};function qr(m){return new ks(m)}function Cu(m,I,P){m.j=P?pl(I,!0):I,m.j&&(m.j=m.j.replace(/:$/,""))}function Su(m,I){if(I){if(I=Number(I),isNaN(I)||0>I)throw Error("Bad port number "+I);m.s=I}else m.s=null}function Qb(m,I,P){I instanceof hl?(m.i=I,sA(m.i,m.h)):(P||(I=fl(I,rA)),m.i=new hl(I,m.h))}function ut(m,I,P){m.i.set(I,P)}function ku(m){return ut(m,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),m}function pl(m,I){return m?I?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function fl(m,I,P){return typeof m=="string"?(m=encodeURI(m).replace(I,eA),P&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function eA(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var Jb=/[#\/\?@]/g,tA=/[#\?:]/g,nA=/[#\?]/g,rA=/[#\?@]/g,aA=/#/g;function hl(m,I){this.h=this.g=null,this.i=m||null,this.j=!!I}function Sa(m){m.g||(m.g=new Map,m.h=0,m.i&&XT(m.i,function(I,P){m.add(decodeURIComponent(I.replace(/\+/g," ")),P)}))}t=hl.prototype,t.add=function(m,I){Sa(this),this.i=null,m=Ai(this,m);var P=this.g.get(m);return P||this.g.set(m,P=[]),P.push(I),this.h+=1,this};function Yb(m,I){Sa(m),I=Ai(m,I),m.g.has(I)&&(m.i=null,m.h-=m.g.get(I).length,m.g.delete(I))}function Zb(m,I){return Sa(m),I=Ai(m,I),m.g.has(I)}t.forEach=function(m,I){Sa(this),this.g.forEach(function(P,O){P.forEach(function(B){m.call(I,B,O,this)},this)},this)},t.na=function(){Sa(this);const m=Array.from(this.g.values()),I=Array.from(this.g.keys()),P=[];for(let O=0;O<I.length;O++){const B=m[O];for(let J=0;J<B.length;J++)P.push(I[O])}return P},t.V=function(m){Sa(this);let I=[];if(typeof m=="string")Zb(this,m)&&(I=I.concat(this.g.get(Ai(this,m))));else{m=Array.from(this.g.values());for(let P=0;P<m.length;P++)I=I.concat(m[P])}return I},t.set=function(m,I){return Sa(this),this.i=null,m=Ai(this,m),Zb(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[I]),this.h+=1,this},t.get=function(m,I){return m?(m=this.V(m),0<m.length?String(m[0]):I):I};function Xb(m,I,P){Yb(m,I),0<P.length&&(m.i=null,m.g.set(Ai(m,I),E(P)),m.h+=P.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],I=Array.from(this.g.keys());for(var P=0;P<I.length;P++){var O=I[P];const J=encodeURIComponent(String(O)),ce=this.V(O);for(O=0;O<ce.length;O++){var B=J;ce[O]!==""&&(B+="="+encodeURIComponent(String(ce[O]))),m.push(B)}}return this.i=m.join("&")};function Ai(m,I){return I=String(I),m.j&&(I=I.toLowerCase()),I}function sA(m,I){I&&!m.j&&(Sa(m),m.i=null,m.g.forEach(function(P,O){var B=O.toLowerCase();O!=B&&(Yb(this,O),Xb(this,B,P))},m)),m.j=I}function iA(m,I){const P=new dl;if(l.Image){const O=new Image;O.onload=v(ka,P,"TestLoadImage: loaded",!0,I,O),O.onerror=v(ka,P,"TestLoadImage: error",!1,I,O),O.onabort=v(ka,P,"TestLoadImage: abort",!1,I,O),O.ontimeout=v(ka,P,"TestLoadImage: timeout",!1,I,O),l.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=m}else I(!1)}function oA(m,I){const P=new dl,O=new AbortController,B=setTimeout(()=>{O.abort(),ka(P,"TestPingServer: timeout",!1,I)},1e4);fetch(m,{signal:O.signal}).then(J=>{clearTimeout(B),J.ok?ka(P,"TestPingServer: ok",!0,I):ka(P,"TestPingServer: server error",!1,I)}).catch(()=>{clearTimeout(B),ka(P,"TestPingServer: error",!1,I)})}function ka(m,I,P,O,B){try{B&&(B.onload=null,B.onerror=null,B.onabort=null,B.ontimeout=null),O(P)}catch{}}function lA(){this.g=new xa}function cA(m,I,P){const O=P||"";try{Gb(m,function(B,J){let ce=B;u(B)&&(ce=Nr(B)),I.push(O+J+"="+encodeURIComponent(ce))})}catch(B){throw I.push(O+"type="+encodeURIComponent("_badmap")),B}}function Iu(m){this.l=m.Ub||null,this.j=m.eb||!1}x(Iu,Sr),Iu.prototype.g=function(){return new Tu(this.l,this.j)},Iu.prototype.i=function(m){return function(){return m}}({});function Tu(m,I){Ce.call(this),this.D=m,this.o=I,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(Tu,Ce),t=Tu.prototype,t.open=function(m,I){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=m,this.A=I,this.readyState=1,vl(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const I={headers:this.u,method:this.B,credentials:this.m,cache:void 0};m&&(I.body=m),(this.D||l).fetch(new Request(this.A,I)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,gl(this)),this.readyState=0},t.Sa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,vl(this)),this.g&&(this.readyState=3,vl(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ey(this)}else m.text().then(this.Ra.bind(this),this.ga.bind(this))};function ey(m){m.j.read().then(m.Pa.bind(m)).catch(m.ga.bind(m))}t.Pa=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var I=m.value?m.value:new Uint8Array(0);(I=this.v.decode(I,{stream:!m.done}))&&(this.response=this.responseText+=I)}m.done?gl(this):vl(this),this.readyState==3&&ey(this)}},t.Ra=function(m){this.g&&(this.response=this.responseText=m,gl(this))},t.Qa=function(m){this.g&&(this.response=m,gl(this))},t.ga=function(){this.g&&gl(this)};function gl(m){m.readyState=4,m.l=null,m.j=null,m.v=null,vl(m)}t.setRequestHeader=function(m,I){this.u.append(m,I)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],I=this.h.entries();for(var P=I.next();!P.done;)P=P.value,m.push(P[0]+": "+P[1]),P=I.next();return m.join(`\r
`)};function vl(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(Tu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function ty(m){let I="";return S(m,function(P,O){I+=O,I+=":",I+=P,I+=`\r
`}),I}function rf(m,I,P){e:{for(O in P){var O=!1;break e}O=!0}O||(P=ty(P),typeof m=="string"?P!=null&&encodeURIComponent(String(P)):ut(m,I,P))}function kt(m){Ce.call(this),this.headers=new Map,this.o=m||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(kt,Ce);var uA=/^https?$/i,dA=["POST","PUT"];t=kt.prototype,t.Ha=function(m){this.J=m},t.ea=function(m,I,P,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);I=I?I.toUpperCase():"GET",this.D=m,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Jp.g(),this.v=this.o?il(this.o):il(Jp),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(I,String(m),!0),this.B=!1}catch(J){ny(this,J);return}if(m=P||"",P=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var B in O)P.set(B,O[B]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const J of O.keys())P.set(J,O.get(J));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(P.keys()).find(J=>J.toLowerCase()=="content-type"),B=l.FormData&&m instanceof l.FormData,!(0<=Array.prototype.indexOf.call(dA,I,void 0))||O||B||P.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,ce]of P)this.g.setRequestHeader(J,ce);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{sy(this),this.u=!0,this.g.send(m),this.u=!1}catch(J){ny(this,J)}};function ny(m,I){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=I,m.m=5,ry(m),Au(m)}function ry(m){m.A||(m.A=!0,Le(m,"complete"),Le(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=m||7,Le(this,"complete"),Le(this,"abort"),Au(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Au(this,!0)),kt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?ay(this):this.bb())},t.bb=function(){ay(this)};function ay(m){if(m.h&&typeof o<"u"&&(!m.v[1]||Wr(m)!=4||m.Z()!=2)){if(m.u&&Wr(m)==4)xn(m.Ea,0,m);else if(Le(m,"readystatechange"),Wr(m)==4){m.h=!1;try{const ce=m.Z();e:switch(ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var I=!0;break e;default:I=!1}var P;if(!(P=I)){var O;if(O=ce===0){var B=String(m.D).match(Kb)[1]||null;!B&&l.self&&l.self.location&&(B=l.self.location.protocol.slice(0,-1)),O=!uA.test(B?B.toLowerCase():"")}P=O}if(P)Le(m,"complete"),Le(m,"success");else{m.m=6;try{var J=2<Wr(m)?m.g.statusText:""}catch{J=""}m.l=J+" ["+m.Z()+"]",ry(m)}}finally{Au(m)}}}}function Au(m,I){if(m.g){sy(m);const P=m.g,O=m.v[0]?()=>{}:null;m.g=null,m.v=null,I||Le(m,"ready");try{P.onreadystatechange=O}catch{}}}function sy(m){m.I&&(l.clearTimeout(m.I),m.I=null)}t.isActive=function(){return!!this.g};function Wr(m){return m.g?m.g.readyState:0}t.Z=function(){try{return 2<Wr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(m){if(this.g){var I=this.g.responseText;return m&&I.indexOf(m)==0&&(I=I.substring(m.length)),Cr(I)}};function iy(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.H){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function mA(m){const I={};m=(m.g&&2<=Wr(m)&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<m.length;O++){if(C(m[O]))continue;var P=R(m[O]);const B=P[0];if(P=P[1],typeof P!="string")continue;P=P.trim();const J=I[B]||[];I[B]=J,J.push(P)}N(I,function(O){return O.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function bl(m,I,P){return P&&P.internalChannelParams&&P.internalChannelParams[m]||I}function oy(m){this.Aa=0,this.i=[],this.j=new dl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=bl("failFast",!1,m),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=bl("baseRetryDelayMs",5e3,m),this.cb=bl("retryDelaySeedMs",1e4,m),this.Wa=bl("forwardChannelMaxRetries",2,m),this.wa=bl("forwardChannelRequestTimeoutMs",2e4,m),this.pa=m&&m.xmlHttpFactory||void 0,this.Xa=m&&m.Tb||void 0,this.Ca=m&&m.useFetchStreams||!1,this.L=void 0,this.J=m&&m.supportsCrossDomainXhr||!1,this.K="",this.h=new $b(m&&m.concurrentRequestLimit),this.Da=new lA,this.P=m&&m.fastHandshake||!1,this.O=m&&m.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=m&&m.Rb||!1,m&&m.xa&&this.j.xa(),m&&m.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&m&&m.detectBufferingProxy||!1,this.ja=void 0,m&&m.longPollingTimeout&&0<m.longPollingTimeout&&(this.ja=m.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=oy.prototype,t.la=8,t.G=1,t.connect=function(m,I,P,O){Ne(0),this.W=m,this.H=I||{},P&&O!==void 0&&(this.H.OSID=P,this.H.OAID=O),this.F=this.X,this.I=gy(this,null,this.W),Ru(this)};function af(m){if(ly(m),m.G==3){var I=m.U++,P=qr(m.I);if(ut(P,"SID",m.K),ut(P,"RID",I),ut(P,"TYPE","terminate"),yl(m,P),I=new Ca(m,m.j,I),I.L=2,I.v=ku(qr(P)),P=!1,l.navigator&&l.navigator.sendBeacon)try{P=l.navigator.sendBeacon(I.v.toString(),"")}catch{}!P&&l.Image&&(new Image().src=I.v,P=!0),P||(I.g=vy(I.j,null),I.g.ea(I.v)),I.F=Date.now(),Nu(I)}hy(m)}function Pu(m){m.g&&(of(m),m.g.cancel(),m.g=null)}function ly(m){Pu(m),m.u&&(l.clearTimeout(m.u),m.u=null),Lu(m),m.h.cancel(),m.s&&(typeof m.s=="number"&&l.clearTimeout(m.s),m.s=null)}function Ru(m){if(!Bb(m.h)&&!m.s){m.s=!0;var I=m.Ga;j||G(),V||(j(),V=!0),z.add(I,m),m.B=0}}function pA(m,I){return qb(m.h)>=m.h.j-(m.s?1:0)?!1:m.s?(m.i=I.D.concat(m.i),!0):m.G==1||m.G==2||m.B>=(m.Va?0:m.Wa)?!1:(m.s=ul(g(m.Ga,m,I),fy(m,m.B)),m.B++,!0)}t.Ga=function(m){if(this.s)if(this.s=null,this.G==1){if(!m){this.U=Math.floor(1e5*Math.random()),m=this.U++;const B=new Ca(this,this.j,m);let J=this.o;if(this.S&&(J?(J=b(J),A(J,this.S)):J=this.S),this.m!==null||this.O||(B.H=J,J=null),this.P)e:{for(var I=0,P=0;P<this.i.length;P++){t:{var O=this.i[P];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(I+=O,4096<I){I=P;break e}if(I===4096||P===this.i.length-1){I=P+1;break e}}I=1e3}else I=1e3;I=uy(this,B,I),P=qr(this.I),ut(P,"RID",m),ut(P,"CVER",22),this.D&&ut(P,"X-HTTP-Session-Id",this.D),yl(this,P),J&&(this.O?I="headers="+encodeURIComponent(String(ty(J)))+"&"+I:this.m&&rf(P,this.m,J)),nf(this.h,B),this.Ua&&ut(P,"TYPE","init"),this.P?(ut(P,"$req",I),ut(P,"SID","null"),B.T=!0,Zp(B,P,null)):Zp(B,P,I),this.G=2}}else this.G==3&&(m?cy(this,m):this.i.length==0||Bb(this.h)||cy(this))};function cy(m,I){var P;I?P=I.l:P=m.U++;const O=qr(m.I);ut(O,"SID",m.K),ut(O,"RID",P),ut(O,"AID",m.T),yl(m,O),m.m&&m.o&&rf(O,m.m,m.o),P=new Ca(m,m.j,P,m.B+1),m.m===null&&(P.H=m.o),I&&(m.i=I.D.concat(m.i)),I=uy(m,P,1e3),P.I=Math.round(.5*m.wa)+Math.round(.5*m.wa*Math.random()),nf(m.h,P),Zp(P,O,I)}function yl(m,I){m.H&&S(m.H,function(P,O){ut(I,O,P)}),m.l&&Gb({},function(P,O){ut(I,O,P)})}function uy(m,I,P){P=Math.min(m.i.length,P);var O=m.l?g(m.l.Na,m.l,m):null;e:{var B=m.i;let J=-1;for(;;){const ce=["count="+P];J==-1?0<P?(J=B[0].g,ce.push("ofs="+J)):J=0:ce.push("ofs="+J);let at=!0;for(let nn=0;nn<P;nn++){let Ze=B[nn].g;const un=B[nn].map;if(Ze-=J,0>Ze)J=Math.max(0,B[nn].g-100),at=!1;else try{cA(un,ce,"req"+Ze+"_")}catch{O&&O(un)}}if(at){O=ce.join("&");break e}}}return m=m.i.splice(0,P),I.D=m,O}function dy(m){if(!m.g&&!m.u){m.Y=1;var I=m.Fa;j||G(),V||(j(),V=!0),z.add(I,m),m.v=0}}function sf(m){return m.g||m.u||3<=m.v?!1:(m.Y++,m.u=ul(g(m.Fa,m),fy(m,m.v)),m.v++,!0)}t.Fa=function(){if(this.u=null,my(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var m=2*this.R;this.j.info("BP detection timer enabled: "+m),this.A=ul(g(this.ab,this),m)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ne(10),Pu(this),my(this))};function of(m){m.A!=null&&(l.clearTimeout(m.A),m.A=null)}function my(m){m.g=new Ca(m,m.j,"rpc",m.Y),m.m===null&&(m.g.H=m.o),m.g.O=0;var I=qr(m.qa);ut(I,"RID","rpc"),ut(I,"SID",m.K),ut(I,"AID",m.T),ut(I,"CI",m.F?"0":"1"),!m.F&&m.ja&&ut(I,"TO",m.ja),ut(I,"TYPE","xmlhttp"),yl(m,I),m.m&&m.o&&rf(I,m.m,m.o),m.L&&(m.g.I=m.L);var P=m.g;m=m.ia,P.L=1,P.v=ku(qr(I)),P.m=null,P.P=!0,Fb(P,m)}t.Za=function(){this.C!=null&&(this.C=null,Pu(this),sf(this),Ne(19))};function Lu(m){m.C!=null&&(l.clearTimeout(m.C),m.C=null)}function py(m,I){var P=null;if(m.g==I){Lu(m),of(m),m.g=null;var O=2}else if(tf(m.h,I))P=I.D,Wb(m.h,I),O=1;else return;if(m.G!=0){if(I.o)if(O==1){P=I.m?I.m.length:0,I=Date.now()-I.F;var B=m.B;O=Br(),Le(O,new Mb(O,P)),Ru(m)}else dy(m);else if(B=I.s,B==3||B==0&&0<I.X||!(O==1&&pA(m,I)||O==2&&sf(m)))switch(P&&0<P.length&&(I=m.h,I.i=I.i.concat(P)),B){case 1:Is(m,5);break;case 4:Is(m,10);break;case 3:Is(m,6);break;default:Is(m,2)}}}function fy(m,I){let P=m.Ta+Math.floor(Math.random()*m.cb);return m.isActive()||(P*=2),P*I}function Is(m,I){if(m.j.info("Error code "+I),I==2){var P=g(m.fb,m),O=m.Xa;const B=!O;O=new ks(O||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Cu(O,"https"),ku(O),B?iA(O.toString(),P):oA(O.toString(),P)}else Ne(2);m.G=0,m.l&&m.l.sa(I),hy(m),ly(m)}t.fb=function(m){m?(this.j.info("Successfully pinged google.com"),Ne(2)):(this.j.info("Failed to ping google.com"),Ne(1))};function hy(m){if(m.G=0,m.ka=[],m.l){const I=Hb(m.h);(I.length!=0||m.i.length!=0)&&(y(m.ka,I),y(m.ka,m.i),m.h.i.length=0,E(m.i),m.i.length=0),m.l.ra()}}function gy(m,I,P){var O=P instanceof ks?qr(P):new ks(P);if(O.g!="")I&&(O.g=I+"."+O.g),Su(O,O.s);else{var B=l.location;O=B.protocol,I=I?I+"."+B.hostname:B.hostname,B=+B.port;var J=new ks(null);O&&Cu(J,O),I&&(J.g=I),B&&Su(J,B),P&&(J.l=P),O=J}return P=m.D,I=m.ya,P&&I&&ut(O,P,I),ut(O,"VER",m.la),yl(m,O),O}function vy(m,I,P){if(I&&!m.J)throw Error("Can't create secondary domain capable XhrIo object.");return I=m.Ca&&!m.pa?new kt(new Iu({eb:P})):new kt(m.pa),I.Ha(m.J),I}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function by(){}t=by.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Du(){}Du.prototype.g=function(m,I){return new Un(m,I)};function Un(m,I){Ce.call(this),this.g=new oy(I),this.l=m,this.h=I&&I.messageUrlParams||null,m=I&&I.messageHeaders||null,I&&I.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=I&&I.initMessageHeaders||null,I&&I.messageContentType&&(m?m["X-WebChannel-Content-Type"]=I.messageContentType:m={"X-WebChannel-Content-Type":I.messageContentType}),I&&I.va&&(m?m["X-WebChannel-Client-Profile"]=I.va:m={"X-WebChannel-Client-Profile":I.va}),this.g.S=m,(m=I&&I.Sb)&&!C(m)&&(this.g.m=m),this.v=I&&I.supportsCrossDomainXhr||!1,this.u=I&&I.sendRawJson||!1,(I=I&&I.httpSessionIdParam)&&!C(I)&&(this.g.D=I,m=this.h,m!==null&&I in m&&(m=this.h,I in m&&delete m[I])),this.j=new Pi(this)}x(Un,Ce),Un.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Un.prototype.close=function(){af(this.g)},Un.prototype.o=function(m){var I=this.g;if(typeof m=="string"){var P={};P.__data__=m,m=P}else this.u&&(P={},P.__data__=Nr(m),m=P);I.i.push(new JT(I.Ya++,m)),I.G==3&&Ru(I)},Un.prototype.N=function(){this.g.l=null,delete this.j,af(this.g),delete this.g,Un.aa.N.call(this)};function yy(m){_a.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var I=m.__sm__;if(I){e:{for(const P in I){m=P;break e}m=void 0}(this.i=m)&&(m=this.i,I=I!==null&&m in I?I[m]:void 0),this.data=I}else this.data=m}x(yy,_a);function Ey(){Ii.call(this),this.status=1}x(Ey,Ii);function Pi(m){this.g=m}x(Pi,by),Pi.prototype.ua=function(){Le(this.g,"a")},Pi.prototype.ta=function(m){Le(this.g,new yy(m))},Pi.prototype.sa=function(m){Le(this.g,new Ey)},Pi.prototype.ra=function(){Le(this.g,"b")},Du.prototype.createWebChannel=Du.prototype.g,Un.prototype.send=Un.prototype.o,Un.prototype.open=Un.prototype.m,Un.prototype.close=Un.prototype.close,eS=function(){return new Du},XC=function(){return Br()},ZC=Zn,pg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},wu.NO_ERROR=0,wu.TIMEOUT=8,wu.HTTP_ERROR=6,kd=wu,Ob.COMPLETE="complete",YC=Ob,ol.EventType=wa,wa.OPEN="a",wa.CLOSE="b",wa.ERROR="c",wa.MESSAGE="d",Ce.prototype.listen=Ce.prototype.K,ql=ol,kt.prototype.listenOnce=kt.prototype.L,kt.prototype.getLastError=kt.prototype.Ka,kt.prototype.getLastErrorCode=kt.prototype.Ba,kt.prototype.getStatus=kt.prototype.Z,kt.prototype.getResponseJson=kt.prototype.Oa,kt.prototype.getResponseText=kt.prototype.oa,kt.prototype.send=kt.prototype.ea,kt.prototype.setWithCredentials=kt.prototype.Ha,JC=kt}).apply(typeof Xu<"u"?Xu:typeof self<"u"?self:typeof window<"u"?window:{});const zE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Zt.UNAUTHENTICATED=new Zt(null),Zt.GOOGLE_CREDENTIALS=new Zt("google-credentials-uid"),Zt.FIRST_PARTY=new Zt("first-party-uid"),Zt.MOCK_USER=new Zt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wo="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const os=new J0("@firebase/firestore");function zi(){return os.logLevel}function bB(t){os.setLogLevel(t)}function ee(t,...e){if(os.logLevel<=We.DEBUG){const n=e.map(Z0);os.debug(`Firestore (${Wo}): ${t}`,...n)}}function Lt(t,...e){if(os.logLevel<=We.ERROR){const n=e.map(Z0);os.error(`Firestore (${Wo}): ${t}`,...n)}}function or(t,...e){if(os.logLevel<=We.WARN){const n=e.map(Z0);os.warn(`Firestore (${Wo}): ${t}`,...n)}}function Z0(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function me(t="Unexpected state"){const e=`FIRESTORE (${Wo}) INTERNAL ASSERTION FAILED: `+t;throw Lt(e),new Error(e)}function ye(t,e){t||me()}function yB(t,e){t||me()}function le(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class te extends xr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class uD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Zt.UNAUTHENTICATED))}shutdown(){}}class dD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class mD{constructor(e){this.t=e,this.currentUser=Zt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ye(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new en;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new en,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new en)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ye(typeof r.accessToken=="string"),new tS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ye(e===null||typeof e=="string"),new Zt(e)}}class pD{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Zt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class fD{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new pD(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Zt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class nS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class hD{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){ye(this.o===void 0);const r=i=>{i.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ye(typeof n.token=="string"),this.R=n.token,new nS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class EB{getToken(){return Promise.resolve(new nS(""))}invalidateToken(){}start(e,n){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gD(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=gD(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Ae(t,e){return t<e?-1:t>e?1:0}function No(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function aS(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new te(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new te(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new te(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Nt.fromMillis(Date.now())}static fromDate(e){return Nt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Nt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ae(this.nanoseconds,e.nanoseconds):Ae(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.timestamp=e}static fromTimestamp(e){return new _e(e)}static min(){return new _e(new Nt(0,0))}static max(){return new _e(new Nt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(e,n,r){n===void 0?n=0:n>e.length&&me(),r===void 0?r=e.length-n:r>e.length-n&&me(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Tc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Tc?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class He extends Tc{construct(e,n,r){return new He(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new te(K.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new He(n)}static emptyPath(){return new He([])}}const vD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class vt extends Tc{construct(e,n,r){return new vt(e,n,r)}static isValidIdentifier(e){return vD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new vt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new te(K.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new te(K.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new te(K.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new te(K.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new vt(n)}static emptyPath(){return new vt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class de{constructor(e){this.path=e}static fromPath(e){return new de(He.fromString(e))}static fromName(e){return new de(He.fromString(e).popFirst(5))}static empty(){return new de(He.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&He.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return He.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new de(new He(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function fg(t){return t.fields.find(e=>e.kind===2)}function Ds(t){return t.fields.filter(e=>e.kind!==2)}function bD(t,e){let n=Ae(t.collectionGroup,e.collectionGroup);if(n!==0)return n;for(let r=0;r<Math.min(t.fields.length,e.fields.length);++r)if(n=yD(t.fields[r],e.fields[r]),n!==0)return n;return Ae(t.fields.length,e.fields.length)}Co.UNKNOWN_ID=-1;class Qs{constructor(e,n){this.fieldPath=e,this.kind=n}}function yD(t,e){const n=vt.comparator(t.fieldPath,e.fieldPath);return n!==0?n:Ae(t.kind,e.kind)}class So{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new So(0,Qn.min())}}function sS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=_e.fromTimestamp(r===1e9?new Nt(n+1,0):new Nt(n,r));return new Qn(s,de.empty(),e)}function iS(t){return new Qn(t.readTime,t.key,-1)}class Qn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Qn(_e.min(),de.empty(),-1)}static max(){return new Qn(_e.max(),de.empty(),-1)}}function X0(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=de.comparator(t.documentKey,e.documentKey),n!==0?n:Ae(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vs(t){if(t.code!==K.FAILED_PRECONDITION||t.message!==oS)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&me(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new q((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof q?n:q.resolve(n)}catch(n){return q.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):q.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):q.reject(n)}static resolve(e){return new q((n,r)=>{n(e)})}static reject(e){return new q((n,r)=>{r(e)})}static waitFor(e){return new q((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=q.resolve(!1);for(const r of e)n=n.next(s=>s?q.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new q((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(d=>{o[u]=d,++l,l===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new q((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new en,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new rc(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=ev(r.target.error);this.V.reject(new rc(e,s))}}static open(e,n,r,s){try{return new gp(n,e.transaction(s,r))}catch(i){throw new rc(n,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(ee("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new xD(n)}}class Vr{constructor(e,n,r){this.name=e,this.version=n,this.p=r,Vr.S(Wt())===12.2&&Lt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return ee("SimpleDb","Removing database:",e),Ms(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Q0())return!1;if(Vr.v())return!0;const e=Wt(),n=Vr.S(e),r=0<n&&n<10,s=cS(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(ee("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new rc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new te(K.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new te(K.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new rc(e,o))},s.onupgradeneeded=i=>{ee("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{ee("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=gp.open(this.db,e,i?"readonly":"readwrite",r),c=s(l).next(u=>(l.g(),u)).catch(u=>(l.abort(u),q.reject(u))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(ee("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function cS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class ED{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Ms(this.B.delete())}}class rc extends te{constructor(e,n){super(K.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function bs(t){return t.name==="IndexedDbTransactionError"}class xD{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(ee("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(ee("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ms(r)}add(e){return ee("SimpleDb","ADD",this.store.name,e,e),Ms(this.store.add(e))}get(e){return Ms(this.store.get(e)).next(n=>(n===void 0&&(n=null),ee("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return ee("SimpleDb","DELETE",this.store.name,e),Ms(this.store.delete(e))}count(){return ee("SimpleDb","COUNT",this.store.name),Ms(this.store.count())}U(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new q((o,l)=>{i.onerror=c=>{l(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new q((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,n){ee("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,l)=>l.delete())}J(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.W(s,n)}Y(e){const n=this.cursor({});return new q((r,s)=>{n.onerror=i=>{const o=ev(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():r()}):r()}})}W(e,n){const r=[];return new q((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void s();const c=new ED(l),u=n(l.primaryKey,l.value,c);if(u instanceof q){const d=u.catch(f=>(c.done(),q.reject(f)));r.push(d)}c.isDone?s():c.K===null?l.continue():l.continue(c.K)}}).next(()=>q.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ms(t){return new q((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=ev(r.target.error);n(s)}})}let UE=!1;function ev(t){const e=Vr.S(Wt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new te("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return UE||(UE=!0,setTimeout(()=>{throw r},0)),r}}return t}class wD{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){ee("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{ee("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){bs(n)?ee("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await vs(n)}await this.X(6e4)})}}class _D{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let s=n,i=!0;return q.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return ee("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(l=>{s-=l,r.add(o)});i=!1})).next(()=>n-s)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(l=>(ee("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,n,l))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=iS(i);X0(o,r)>0&&(r=o)}),new Qn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Rn.oe=-1;function tu(t){return t==null}function Ac(t){return t===0&&1/t==-1/0}function uS(t){return typeof t=="number"&&Number.isInteger(t)&&!Ac(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=$E(e)),e=ND(t.get(n),e);return $E(e)}function ND(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function $E(t){return t+""}function Rr(t){const e=t.length;if(ye(e>=2),e===2)return ye(t.charAt(0)===""&&t.charAt(1)===""),He.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&me(),t.charAt(o+1)){case"":const l=t.substring(i,o);let c;s.length===0?c=l:(s+=l,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:me()}i=o+2}return new He(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Id(t,e){return[t,vn(e)]}function dS(t,e,n){return[t,vn(e),n]}const CD={},SD=["prefixPath","collectionGroup","readTime","documentId"],kD=["prefixPath","collectionGroup","documentId"],ID=["collectionGroup","readTime","prefixPath","documentId"],TD=["canonicalId","targetId"],AD=["targetId","path"],PD=["path","targetId"],RD=["collectionId","parent"],LD=["indexId","uid"],DD=["uid","sequenceNumber"],MD=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],OD=["indexId","uid","orderedDocumentKey"],VD=["userId","collectionPath","documentId"],jD=["userId","collectionPath","largestBatchId"],FD=["userId","collectionGroup","largestBatchId"],mS=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],zD=[...mS,"documentOverlays"],pS=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],fS=pS,tv=[...fS,"indexConfiguration","indexState","indexEntries"],UD=tv,$D=[...tv,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg extends lS{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function Gt(t,e){const n=le(t);return Vr.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ys(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function hS(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function gS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e,n){this.comparator=e,this.root=n||an.EMPTY}insert(e,n){return new ct(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,an.BLACK,null,null))}remove(e){return new ct(this.comparator,this.root.remove(e,this.comparator).copy(null,null,an.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ed(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ed(this.root,e,this.comparator,!1)}getReverseIterator(){return new ed(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ed(this.root,e,this.comparator,!0)}}class ed{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class an{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??an.RED,this.left=s??an.EMPTY,this.right=i??an.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new an(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return an.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return an.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,an.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,an.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw me();const e=this.left.check();if(e!==this.right.check())throw me();return e+(this.isRed()?0:1)}}an.EMPTY=null,an.RED=!0,an.BLACK=!1;an.EMPTY=new class{constructor(){this.size=0}get key(){throw me()}get value(){throw me()}get color(){throw me()}get left(){throw me()}get right(){throw me()}copy(e,n,r,s,i){return this}insert(e,n,r){return new an(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e){this.comparator=e,this.data=new ct(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new WE(this.data.getIterator())}getIteratorFrom(e){return new WE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof rt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new rt(this.comparator);return n.data=e,n}}class WE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Di(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e){this.fields=e,e.sort(vt.comparator)}static empty(){return new Ln([])}unionWith(e){let n=new rt(vt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Ln(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return No(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wB(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new vS("Invalid base64 string: "+i):i}}(e);return new Tt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Tt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ae(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Tt.EMPTY_BYTE_STRING=new Tt("");const BD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function da(t){if(ye(!!t),typeof t=="string"){let e=0;const n=BD.exec(t);if(ye(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ht(t.seconds),nanos:ht(t.nanos)}}function ht(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ma(t){return typeof t=="string"?Tt.fromBase64String(t):Tt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vp(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function bp(t){const e=t.mapValue.fields.__previous_value__;return vp(e)?bp(e):e}function Pc(t){const e=da(t.mapValue.fields.__local_write_time__.timestampValue);return new Nt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qD{constructor(e,n,r,s,i,o,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class ni{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new ni("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ni&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ka={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Td={nullValue:"NULL_VALUE"};function ls(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vp(t)?4:bS(t)?9007199254740991:yp(t)?10:11:me()}function $r(t,e){if(t===e)return!0;const n=ls(t);if(n!==ls(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Pc(t).isEqual(Pc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=da(s.timestampValue),l=da(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ma(s.bytesValue).isEqual(ma(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ht(s.geoPointValue.latitude)===ht(i.geoPointValue.latitude)&&ht(s.geoPointValue.longitude)===ht(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ht(s.integerValue)===ht(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ht(s.doubleValue),l=ht(i.doubleValue);return o===l?Ac(o)===Ac(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return No(t.arrayValue.values||[],e.arrayValue.values||[],$r);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(qE(o)!==qE(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!$r(o[c],l[c])))return!1;return!0}(t,e);default:return me()}}function Rc(t,e){return(t.values||[]).find(n=>$r(n,e))!==void 0}function cs(t,e){if(t===e)return 0;const n=ls(t),r=ls(e);if(n!==r)return Ae(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ae(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=ht(i.integerValue||i.doubleValue),c=ht(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return HE(t.timestampValue,e.timestampValue);case 4:return HE(Pc(t),Pc(e));case 5:return Ae(t.stringValue,e.stringValue);case 6:return function(i,o){const l=ma(i),c=ma(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=Ae(l[u],c[u]);if(d!==0)return d}return Ae(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Ae(ht(i.latitude),ht(o.latitude));return l!==0?l:Ae(ht(i.longitude),ht(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return GE(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,d;const f=i.fields||{},g=o.fields||{},v=(l=f.value)===null||l===void 0?void 0:l.arrayValue,x=(c=g.value)===null||c===void 0?void 0:c.arrayValue,E=Ae(((u=v==null?void 0:v.values)===null||u===void 0?void 0:u.length)||0,((d=x==null?void 0:x.values)===null||d===void 0?void 0:d.length)||0);return E!==0?E:GE(v,x)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Ka.mapValue&&o===Ka.mapValue)return 0;if(i===Ka.mapValue)return 1;if(o===Ka.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){const g=Ae(c[f],d[f]);if(g!==0)return g;const v=cs(l[c[f]],u[d[f]]);if(v!==0)return v}return Ae(c.length,d.length)}(t.mapValue,e.mapValue);default:throw me()}}function HE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ae(t,e);const n=da(t),r=da(e),s=Ae(n.seconds,r.seconds);return s!==0?s:Ae(n.nanos,r.nanos)}function GE(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=cs(n[s],r[s]);if(i)return i}return Ae(n.length,r.length)}function ko(t){return gg(t)}function gg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=da(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ma(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return de.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=gg(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${gg(n.fields[o])}`;return s+"}"}(t.mapValue):me()}function Ad(t){switch(ls(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=bp(t);return e?16+Ad(e):16;case 5:return 2*t.stringValue.length;case 6:return ma(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Ad(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return ys(r.fields,(i,o)=>{s+=i.length+Ad(o)}),s}(t.mapValue);default:throw me()}}function ri(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function vg(t){return!!t&&"integerValue"in t}function Lc(t){return!!t&&"arrayValue"in t}function KE(t){return!!t&&"nullValue"in t}function QE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Pd(t){return!!t&&"mapValue"in t}function yp(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function ac(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ys(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ac(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ac(t.arrayValue.values[n]);return e}return Object.assign({},t)}function bS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const yS={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function WD(t){return"nullValue"in t?Td:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ri(ni.empty(),de.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?yp(t)?yS:{mapValue:{}}:me()}function HD(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ri(ni.empty(),de.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?yS:"mapValue"in t?yp(t)?{mapValue:{}}:Ka:me()}function JE(t,e){const n=cs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function YE(t,e){const n=cs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e){this.value=e}static empty(){return new sn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Pd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ac(n)}setAll(e){let n=vt.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=ac(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Pd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return $r(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Pd(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ys(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new sn(ac(this.value))}}function ES(t){const e=[];return ys(t.fields,(n,r)=>{const s=new vt([n]);if(Pd(r)){const i=ES(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Ln(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new mt(e,0,_e.min(),_e.min(),_e.min(),sn.empty(),0)}static newFoundDocument(e,n,r,s){return new mt(e,1,n,_e.min(),r,s,0)}static newNoDocument(e,n){return new mt(e,2,n,_e.min(),_e.min(),sn.empty(),0)}static newUnknownDocument(e,n){return new mt(e,3,n,_e.min(),_e.min(),sn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(_e.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=sn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=sn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=_e.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof mt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new mt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,n){this.position=e,this.inclusive=n}}function ZE(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=de.comparator(de.fromName(o.referenceValue),n.key):r=cs(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function XE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!$r(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e,n="asc"){this.field=e,this.dir=n}}function GD(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{}class Ge extends xS{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new KD(e,n,r):n==="array-contains"?new YD(e,r):n==="in"?new kS(e,r):n==="not-in"?new ZD(e,r):n==="array-contains-any"?new XD(e,r):new Ge(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new QD(e,r):new JD(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(cs(n,this.value)):n!==null&&ls(this.value)===ls(n)&&this.matchesComparison(cs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return me()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class tt extends xS{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new tt(e,n)}matches(e){return Io(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Io(t){return t.op==="and"}function bg(t){return t.op==="or"}function nv(t){return wS(t)&&Io(t)}function wS(t){for(const e of t.filters)if(e instanceof tt)return!1;return!0}function yg(t){if(t instanceof Ge)return t.field.canonicalString()+t.op.toString()+ko(t.value);if(nv(t))return t.filters.map(e=>yg(e)).join(",");{const e=t.filters.map(n=>yg(n)).join(",");return`${t.op}(${e})`}}function _S(t,e){return t instanceof Ge?function(r,s){return s instanceof Ge&&r.op===s.op&&r.field.isEqual(s.field)&&$r(r.value,s.value)}(t,e):t instanceof tt?function(r,s){return s instanceof tt&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&_S(o,s.filters[l]),!0):!1}(t,e):void me()}function NS(t,e){const n=t.filters.concat(e);return tt.create(n,t.op)}function CS(t){return t instanceof Ge?function(n){return`${n.field.canonicalString()} ${n.op} ${ko(n.value)}`}(t):t instanceof tt?function(n){return n.op.toString()+" {"+n.getFilters().map(CS).join(" ,")+"}"}(t):"Filter"}class KD extends Ge{constructor(e,n,r){super(e,n,r),this.key=de.fromName(r.referenceValue)}matches(e){const n=de.comparator(e.key,this.key);return this.matchesComparison(n)}}class QD extends Ge{constructor(e,n){super(e,"in",n),this.keys=SS("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class JD extends Ge{constructor(e,n){super(e,"not-in",n),this.keys=SS("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function SS(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>de.fromName(r.referenceValue))}class YD extends Ge{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Lc(n)&&Rc(n.arrayValue,this.value)}}class kS extends Ge{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Rc(this.value.arrayValue,n)}}class ZD extends Ge{constructor(e,n){super(e,"not-in",n)}matches(e){if(Rc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Rc(this.value.arrayValue,n)}}class XD extends Ge{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Lc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Rc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function Eg(t,e=null,n=[],r=[],s=null,i=null,o=null){return new e4(t,e,n,r,s,i,o)}function ai(t){const e=le(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>yg(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),tu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ko(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ko(r)).join(",")),e.ue=n}return e.ue}function nu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!GD(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!_S(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!XE(t.startAt,e.startAt)&&XE(t.endAt,e.endAt)}function hm(t){return de.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function gm(t,e){return t.filters.filter(n=>n instanceof Ge&&n.field.isEqual(e))}function ex(t,e,n){let r=Td,s=!0;for(const i of gm(t,e)){let o=Td,l=!0;switch(i.op){case"<":case"<=":o=WD(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=Td}JE({value:r,inclusive:s},{value:o,inclusive:l})<0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];JE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function tx(t,e,n){let r=Ka,s=!0;for(const i of gm(t,e)){let o=Ka,l=!0;switch(i.op){case">=":case">":o=HD(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=Ka}YE({value:r,inclusive:s},{value:o,inclusive:l})>0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];YE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function IS(t,e,n,r,s,i,o,l){return new va(t,e,n,r,s,i,o,l)}function Ho(t){return new va(t)}function nx(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function rv(t){return t.collectionGroup!==null}function uo(t){const e=le(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new rt(vt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Dc(i,r))}),n.has(vt.keyField().canonicalString())||e.ce.push(new Dc(vt.keyField(),r))}return e.ce}function bn(t){const e=le(t);return e.le||(e.le=AS(e,uo(t))),e.le}function TS(t){const e=le(t);return e.he||(e.he=AS(e,t.explicitOrderBy)),e.he}function AS(t,e){if(t.limitType==="F")return Eg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Dc(s.field,i)});const n=t.endAt?new us(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new us(t.startAt.position,t.startAt.inclusive):null;return Eg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function xg(t,e){const n=t.filters.concat([e]);return new va(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function vm(t,e,n){return new va(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ru(t,e){return nu(bn(t),bn(e))&&t.limitType===e.limitType}function PS(t){return`${ai(bn(t))}|lt:${t.limitType}`}function Ui(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>CS(s)).join(", ")}]`),tu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ko(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ko(s)).join(",")),`Target(${r})`}(bn(t))}; limitType=${t.limitType})`}function au(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):de.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of uo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=ZE(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,uo(r),s)||r.endAt&&!function(o,l,c){const u=ZE(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,uo(r),s))}(t,e)}function RS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function LS(t){return(e,n)=>{let r=!1;for(const s of uo(t)){const i=t4(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function t4(t,e,n){const r=t.field.isKeyField()?de.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?cs(c,u):me()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return me()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ys(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return gS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4=new ct(de.comparator);function Dn(){return n4}const DS=new ct(de.comparator);function Wl(...t){let e=DS;for(const n of t)e=e.insert(n.key,n);return e}function MS(t){let e=DS;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Lr(){return sc()}function OS(){return sc()}function sc(){return new ba(t=>t.toString(),(t,e)=>t.isEqual(e))}const r4=new ct(de.comparator),a4=new rt(de.comparator);function De(...t){let e=a4;for(const n of t)e=e.add(n);return e}const s4=new rt(Ae);function av(){return s4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ac(e)?"-0":e}}function VS(t){return{integerValue:""+t}}function jS(t,e){return uS(e)?VS(e):sv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(){this._=void 0}}function i4(t,e,n){return t instanceof To?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&vp(i)&&(i=bp(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof si?zS(t,e):t instanceof ii?US(t,e):function(s,i){const o=FS(s,i),l=rx(o)+rx(s.Pe);return vg(o)&&vg(s.Pe)?VS(l):sv(s.serializer,l)}(t,e)}function o4(t,e,n){return t instanceof si?zS(t,e):t instanceof ii?US(t,e):n}function FS(t,e){return t instanceof Ao?function(r){return vg(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class To extends Ep{}class si extends Ep{constructor(e){super(),this.elements=e}}function zS(t,e){const n=$S(e);for(const r of t.elements)n.some(s=>$r(s,r))||n.push(r);return{arrayValue:{values:n}}}class ii extends Ep{constructor(e){super(),this.elements=e}}function US(t,e){let n=$S(e);for(const r of t.elements)n=n.filter(s=>!$r(s,r));return{arrayValue:{values:n}}}class Ao extends Ep{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function rx(t){return ht(t.integerValue||t.doubleValue)}function $S(t){return Lc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,n){this.field=e,this.transform=n}}function l4(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof si&&s instanceof si||r instanceof ii&&s instanceof ii?No(r.elements,s.elements,$r):r instanceof Ao&&s instanceof Ao?$r(r.Pe,s.Pe):r instanceof To&&s instanceof To}(t.transform,e.transform)}class c4{constructor(e,n){this.version=e,this.transformResults=n}}class bt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new bt}static exists(e){return new bt(void 0,e)}static updateTime(e){return new bt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Rd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class xp{}function BS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ko(t.key,bt.none()):new Go(t.key,t.data,bt.none());{const n=t.data,r=sn.empty();let s=new rt(vt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ya(t.key,r,new Ln(s.toArray()),bt.none())}}function u4(t,e,n){t instanceof Go?function(s,i,o){const l=s.value.clone(),c=sx(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof ya?function(s,i,o){if(!Rd(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=sx(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(qS(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ic(t,e,n,r){return t instanceof Go?function(i,o,l,c){if(!Rd(i.precondition,o))return l;const u=i.value.clone(),d=ix(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof ya?function(i,o,l,c){if(!Rd(i.precondition,o))return l;const u=ix(i.fieldTransforms,c,o),d=o.data;return d.setAll(qS(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,l){return Rd(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function d4(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=FS(r.transform,s||null);i!=null&&(n===null&&(n=sn.empty()),n.set(r.field,i))}return n||null}function ax(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&No(r,s,(i,o)=>l4(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Go extends xp{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ya extends xp{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function qS(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function sx(t,e,n){const r=new Map;ye(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,o4(o,l,n[s]))}return r}function ix(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,i4(i,o,e))}return r}class Ko extends xp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class iv extends xp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&u4(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ic(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ic(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=OS();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=BS(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(_e.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),De())}isEqual(e){return this.batchId===e.batchId&&No(this.mutations,e.mutations,(n,r)=>ax(n,r))&&No(this.baseMutations,e.baseMutations,(n,r)=>ax(n,r))}}class lv{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ye(e.mutations.length===r.length);let s=function(){return r4}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new lv(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m4{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jt,Je;function HS(t){switch(t){default:return me();case K.CANCELLED:case K.UNKNOWN:case K.DEADLINE_EXCEEDED:case K.RESOURCE_EXHAUSTED:case K.INTERNAL:case K.UNAVAILABLE:case K.UNAUTHENTICATED:return!1;case K.INVALID_ARGUMENT:case K.NOT_FOUND:case K.ALREADY_EXISTS:case K.PERMISSION_DENIED:case K.FAILED_PRECONDITION:case K.ABORTED:case K.OUT_OF_RANGE:case K.UNIMPLEMENTED:case K.DATA_LOSS:return!0}}function GS(t){if(t===void 0)return Lt("GRPC error has no .code"),K.UNKNOWN;switch(t){case jt.OK:return K.OK;case jt.CANCELLED:return K.CANCELLED;case jt.UNKNOWN:return K.UNKNOWN;case jt.DEADLINE_EXCEEDED:return K.DEADLINE_EXCEEDED;case jt.RESOURCE_EXHAUSTED:return K.RESOURCE_EXHAUSTED;case jt.INTERNAL:return K.INTERNAL;case jt.UNAVAILABLE:return K.UNAVAILABLE;case jt.UNAUTHENTICATED:return K.UNAUTHENTICATED;case jt.INVALID_ARGUMENT:return K.INVALID_ARGUMENT;case jt.NOT_FOUND:return K.NOT_FOUND;case jt.ALREADY_EXISTS:return K.ALREADY_EXISTS;case jt.PERMISSION_DENIED:return K.PERMISSION_DENIED;case jt.FAILED_PRECONDITION:return K.FAILED_PRECONDITION;case jt.ABORTED:return K.ABORTED;case jt.OUT_OF_RANGE:return K.OUT_OF_RANGE;case jt.UNIMPLEMENTED:return K.UNIMPLEMENTED;case jt.DATA_LOSS:return K.DATA_LOSS;default:return me()}}(Je=jt||(jt={}))[Je.OK=0]="OK",Je[Je.CANCELLED=1]="CANCELLED",Je[Je.UNKNOWN=2]="UNKNOWN",Je[Je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Je[Je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Je[Je.NOT_FOUND=5]="NOT_FOUND",Je[Je.ALREADY_EXISTS=6]="ALREADY_EXISTS",Je[Je.PERMISSION_DENIED=7]="PERMISSION_DENIED",Je[Je.UNAUTHENTICATED=16]="UNAUTHENTICATED",Je[Je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Je[Je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Je[Je.ABORTED=10]="ABORTED",Je[Je.OUT_OF_RANGE=11]="OUT_OF_RANGE",Je[Je.UNIMPLEMENTED=12]="UNIMPLEMENTED",Je[Je.INTERNAL=13]="INTERNAL",Je[Je.UNAVAILABLE=14]="UNAVAILABLE",Je[Je.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bm=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p4=new Ks([4294967295,4294967295],0);function ox(t){const e=KS().encode(t),n=new QC;return n.update(e),new Uint8Array(n.digest())}function lx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ks([n,r],0),new Ks([s,i],0)]}class uv{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Hl(`Invalid padding: ${n}`);if(r<0)throw new Hl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Hl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Hl(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Ks.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Ks.fromNumber(r)));return s.compare(p4)===1&&(s=new Ks([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=ox(e),[r,s]=lx(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new uv(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=ox(e),[r,s]=lx(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Hl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,ou.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new iu(_e.min(),s,new ct(Ae),Dn(),De())}}class ou{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new ou(r,n,De(),De(),De())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class QS{constructor(e,n){this.targetId=e,this.me=n}}class JS{constructor(e,n,r=Tt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class cx{constructor(){this.fe=0,this.ge=dx(),this.pe=Tt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=De(),n=De(),r=De();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:me()}}),new ou(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=dx()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ye(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class f4{constructor(e){this.Le=e,this.Be=new Map,this.ke=Dn(),this.qe=ux(),this.Qe=new ct(Ae)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:me()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(hm(i))if(r===0){const o=new de(i.path);this.Ue(n,o,mt.newNoDocument(o,_e.min()))}else ye(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}bm==null||bm.et(function(d,f,g,v,x){var E,y,h,C,T,k;const _={localCacheCount:d,existenceFilterCount:f.count,databaseId:g.database,projectId:g.projectId},S=f.unchangedNames;return S&&(_.bloomFilter={applied:x===0,hashCount:(E=S==null?void 0:S.hashCount)!==null&&E!==void 0?E:0,bitmapLength:(C=(h=(y=S==null?void 0:S.bits)===null||y===void 0?void 0:y.bitmap)===null||h===void 0?void 0:h.length)!==null&&C!==void 0?C:0,padding:(k=(T=S==null?void 0:S.bits)===null||T===void 0?void 0:T.padding)!==null&&k!==void 0?k:0,mightContain:N=>{var b;return(b=v==null?void 0:v.mightContain(N))!==null&&b!==void 0&&b}}),_}(o,e.me,this.Le.tt(),l,c))}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=ma(r).toUint8Array()}catch(c){if(c instanceof vS)return or("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new uv(o,s,i)}catch(c){return or(c instanceof Hl?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&hm(l.target)){const c=new de(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,mt.newNoDocument(c,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=De();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new iu(e,n,this.Qe,this.ke,r);return this.ke=Dn(),this.qe=ux(),this.Qe=new ct(Ae),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new cx,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new rt(Ae),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new cx),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function ux(){return new ct(de.comparator)}function dx(){return new ct(de.comparator)}const h4=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),g4=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),v4=(()=>({and:"AND",or:"OR"}))();class b4{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function wg(t,e){return t.useProto3Json||tu(e)?e:{value:e}}function Po(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function YS(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function y4(t,e){return Po(t,e.toTimestamp())}function Mt(t){return ye(!!t),_e.fromTimestamp(function(n){const r=da(n);return new Nt(r.seconds,r.nanos)}(t))}function dv(t,e){return _g(t,e).canonicalString()}function _g(t,e){const n=function(s){return new He(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function ZS(t){const e=He.fromString(t);return ye(l2(e)),e}function Mc(t,e){return dv(t.databaseId,e.path)}function jr(t,e){const n=ZS(e);if(n.get(1)!==t.databaseId.projectId)throw new te(K.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new te(K.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new de(t2(n))}function XS(t,e){return dv(t.databaseId,e)}function e2(t){const e=ZS(t);return e.length===4?He.emptyPath():t2(e)}function Ng(t){return new He(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function t2(t){return ye(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function mx(t,e,n){return{name:Mc(t,e),fields:n.value.mapValue.fields}}function n2(t,e,n){const r=jr(t,e.name),s=Mt(e.updateTime),i=e.createTime?Mt(e.createTime):_e.min(),o=new sn({mapValue:{fields:e.fields}}),l=mt.newFoundDocument(r,s,i,o);return n&&l.setHasCommittedMutations(),n?l.setHasCommittedMutations():l}function E4(t,e){return"found"in e?function(r,s){ye(!!s.found),s.found.name,s.found.updateTime;const i=jr(r,s.found.name),o=Mt(s.found.updateTime),l=s.found.createTime?Mt(s.found.createTime):_e.min(),c=new sn({mapValue:{fields:s.found.fields}});return mt.newFoundDocument(i,o,l,c)}(t,e):"missing"in e?function(r,s){ye(!!s.missing),ye(!!s.readTime);const i=jr(r,s.missing),o=Mt(s.readTime);return mt.newNoDocument(i,o)}(t,e):me()}function x4(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:me()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(ye(d===void 0||typeof d=="string"),Tt.fromBase64String(d||"")):(ye(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Tt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?K.UNKNOWN:GS(u.code);return new te(d,u.message||"")}(o);n=new JS(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=jr(t,r.document.name),i=Mt(r.document.updateTime),o=r.document.createTime?Mt(r.document.createTime):_e.min(),l=new sn({mapValue:{fields:r.document.fields}}),c=mt.newFoundDocument(s,i,o,l),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Ld(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=jr(t,r.document),i=r.readTime?Mt(r.readTime):_e.min(),o=mt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Ld([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=jr(t,r.document),i=r.removedTargetIds||[];n=new Ld([],i,s,null)}else{if(!("filter"in e))return me();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new m4(s,i),l=r.targetId;n=new QS(l,o)}}return n}function Oc(t,e){let n;if(e instanceof Go)n={update:mx(t,e.key,e.value)};else if(e instanceof Ko)n={delete:Mc(t,e.key)};else if(e instanceof ya)n={update:mx(t,e.key,e.data),updateMask:k4(e.fieldMask)};else{if(!(e instanceof iv))return me();n={verify:Mc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof To)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof si)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ii)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ao)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw me()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:y4(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:me()}(t,e.precondition)),n}function Cg(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?bt.updateTime(Mt(i.updateTime)):i.exists!==void 0?bt.exists(i.exists):bt.none()}(e.currentDocument):bt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,l){let c=null;if("setToServerValue"in l)ye(l.setToServerValue==="REQUEST_TIME"),c=new To;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];c=new si(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];c=new ii(d)}else"increment"in l?c=new Ao(o,l.increment):me();const u=vt.fromServerFormat(l.fieldPath);return new su(u,c)}(t,s)):[];if(e.update){e.update.name;const s=jr(t,e.update.name),i=new sn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new Ln(u.map(d=>vt.fromServerFormat(d)))}(e.updateMask);return new ya(s,i,o,n,r)}return new Go(s,i,n,r)}if(e.delete){const s=jr(t,e.delete);return new Ko(s,n)}if(e.verify){const s=jr(t,e.verify);return new iv(s,n)}return me()}function w4(t,e){return t&&t.length>0?(ye(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?Mt(s.updateTime):Mt(i);return o.isEqual(_e.min())&&(o=Mt(i)),new c4(o,s.transformResults||[])}(n,e))):[]}function r2(t,e){return{documents:[XS(t,e.path)]}}function wp(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=XS(t,s);const i=function(u){if(u.length!==0)return o2(tt.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(g){return{field:ja(g.field),direction:N4(g.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=wg(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:s}}function a2(t,e,n,r){const{_t:s,parent:i}=wp(t,e),o={},l=[];let c=0;return n.forEach(u=>{const d=r?u.alias:"aggregate_"+c++;o[d]=u.alias,u.aggregateType==="count"?l.push({alias:d,count:{}}):u.aggregateType==="avg"?l.push({alias:d,avg:{field:ja(u.fieldPath)}}):u.aggregateType==="sum"&&l.push({alias:d,sum:{field:ja(u.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:l,structuredQuery:s.structuredQuery},parent:s.parent},ut:o,parent:i}}function s2(t){let e=e2(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ye(r===1);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(f){const g=i2(f);return g instanceof tt&&nv(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(g=>function(x){return new Dc($i(x.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(g))}(n.orderBy));let l=null;n.limit&&(l=function(f){let g;return g=typeof f=="object"?f.value:f,tu(g)?null:g}(n.limit));let c=null;n.startAt&&(c=function(f){const g=!!f.before,v=f.values||[];return new us(v,g)}(n.startAt));let u=null;return n.endAt&&(u=function(f){const g=!f.before,v=f.values||[];return new us(v,g)}(n.endAt)),IS(e,s,o,i,l,"F",c,u)}function _4(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return me()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function i2(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=$i(n.unaryFilter.field);return Ge.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=$i(n.unaryFilter.field);return Ge.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=$i(n.unaryFilter.field);return Ge.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=$i(n.unaryFilter.field);return Ge.create(o,"!=",{nullValue:"NULL_VALUE"});default:return me()}}(t):t.fieldFilter!==void 0?function(n){return Ge.create($i(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return me()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return tt.create(n.compositeFilter.filters.map(r=>i2(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return me()}}(n.compositeFilter.op))}(t):me()}function N4(t){return h4[t]}function C4(t){return g4[t]}function S4(t){return v4[t]}function ja(t){return{fieldPath:t.canonicalString()}}function $i(t){return vt.fromServerFormat(t.fieldPath)}function o2(t){return t instanceof Ge?function(n){if(n.op==="=="){if(QE(n.value))return{unaryFilter:{field:ja(n.field),op:"IS_NAN"}};if(KE(n.value))return{unaryFilter:{field:ja(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(QE(n.value))return{unaryFilter:{field:ja(n.field),op:"IS_NOT_NAN"}};if(KE(n.value))return{unaryFilter:{field:ja(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ja(n.field),op:C4(n.op),value:n.value}}}(t):t instanceof tt?function(n){const r=n.getFilters().map(s=>o2(s));return r.length===1?r[0]:{compositeFilter:{op:S4(n.op),filters:r}}}(t):me()}function k4(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function l2(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e,n,r,s,i=_e.min(),o=_e.min(),l=Tt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Yr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Yr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Yr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Yr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2{constructor(e){this.ct=e}}function I4(t,e){let n;if(e.document)n=n2(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=de.fromSegments(e.noDocument.path),s=li(e.noDocument.readTime);n=mt.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return me();{const r=de.fromSegments(e.unknownDocument.path),s=li(e.unknownDocument.version);n=mt.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new Nt(s[0],s[1]);return _e.fromTimestamp(i)}(e.readTime)),n}function px(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ym(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Mc(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Po(i,o.version.toTimestamp()),createTime:Po(i,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:oi(e.version)};else{if(!e.isUnknownDocument())return me();r.unknownDocument={path:n.path.toArray(),version:oi(e.version)}}return r}function ym(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function oi(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function li(t){const e=new Nt(t.seconds,t.nanoseconds);return _e.fromTimestamp(e)}function Os(t,e){const n=(e.baseMutations||[]).map(i=>Cg(t.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Cg(t.ct,i)),s=Nt.fromMillis(e.localWriteTimeMs);return new ov(e.batchId,s,n,r)}function Gl(t){const e=li(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?li(t.lastLimboFreeSnapshotVersion):_e.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){return ye(i.documents.length===1),bn(Ho(e2(i.documents[0])))}(t.query):function(i){return bn(s2(i))}(t.query),new Yr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Tt.fromBase64String(t.resumeToken))}function u2(t,e){const n=oi(e.snapshotVersion),r=oi(e.lastLimboFreeSnapshotVersion);let s;s=hm(e.target)?r2(t.ct,e.target):wp(t.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ai(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function mv(t){const e=s2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?vm(e,e.limit,"L"):e}function Uf(t,e){return new cv(e.largestBatchId,Cg(t.ct,e.overlayMutation))}function fx(t,e){const n=e.path.lastSegment();return[t,vn(e.path.popLast()),n]}function hx(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:oi(r.readTime),documentKey:vn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{getBundleMetadata(e,n){return gx(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:li(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return gx(e).put(function(s){return{bundleId:s.id,createTime:oi(Mt(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return vx(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:mv(i.bundledQuery),readTime:li(i.readTime)}}(r)})}saveNamedQuery(e,n){return vx(e).put(function(s){return{name:s.name,readTime:oi(Mt(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function gx(t){return Gt(t,"bundles")}function vx(t){return Gt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _p{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new _p(e,r)}getOverlay(e,n){return Il(e).get(fx(this.userId,n)).next(r=>r?Uf(this.serializer,r):null)}getOverlays(e,n){const r=Lr();return q.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const l=new cv(n,o);s.push(this.ht(e,l))}),q.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(vn(o.getCollectionPath())));const i=[];return s.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Il(e).j("collectionPathOverlayIndex",l))}),q.waitFor(i)}getOverlaysForCollection(e,n,r){const s=Lr(),i=vn(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Il(e).U("collectionPathOverlayIndex",o).next(l=>{for(const c of l){const u=Uf(this.serializer,c);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=Lr();let o;const l=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Il(e).J({index:"collectionGroupOverlayIndex",range:l},(c,u,d)=>{const f=Uf(this.serializer,u);i.size()<s||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>i)}ht(e,n){return Il(e).put(function(s,i,o){const[l,c,u]=fx(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Oc(s.ct,o.mutation)}}(this.serializer,this.userId,n))}}function Il(t){return Gt(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A4{Pt(e){return Gt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Tt.fromUint8Array(r):Tt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(ht(e.integerValue));else if("doubleValue"in e){const r=ht(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),Ac(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=da(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(ma(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?bS(e)?this.dt(n,Number.MAX_SAFE_INTEGER):yp(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):me()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const s of Object.keys(r))this.Vt(s,n),this.Tt(r[s],n)}wt(e,n){var r,s;const i=e.fields||{};this.dt(n,53);const o="value",l=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(n,15),n.At(ht(l)),this.Vt(o,n),this.Tt(i[o],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const s of r)this.Tt(s,n)}yt(e,n){this.dt(n,37),de.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}Vs.vt=new Vs;function P4(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function bx(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=P4(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class R4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=n.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=n.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const n=this.qt(e),r=bx(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}Kt(e){const n=this.qt(e),r=bx(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class L4{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class D4{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Tl{constructor(){this.jt=new R4,this.Ht=new L4(this.jt),this.Jt=new D4(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e,n,r,s){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new js(this.indexId,this.documentKey,this.arrayValue,r)}}function Ta(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=yx(t.arrayValue,e.arrayValue),n!==0?n:(n=yx(t.directionalValue,e.directionalValue),n!==0?n:de.comparator(t.documentKey,e.documentKey)))}function yx(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(e){this.Xt=new rt((n,r)=>vt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(ye(e.collectionGroup===this.collectionId),this.nn)return!1;const n=fg(e);if(n!==void 0&&!this.sn(n))return!1;const r=Ds(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=r[i];if(!this.on(l,c)||!this._n(this.en[o++],c))return!1}++i}for(;i<r.length;++i){const l=r[i];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new rt(vt.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Qs(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Qs(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Qs(r.field,r.dir==="asc"?0:1)));return new Co(Co.UNKNOWN_ID,this.collectionId,n,So.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d2(t){var e,n;if(ye(t instanceof Ge||t instanceof tt),t instanceof Ge){if(t instanceof kS){const s=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>Ge.create(t.field,"==",i)))||[];return tt.create(s,"or")}return t}const r=t.filters.map(s=>d2(s));return tt.create(r,t.op)}function M4(t){if(t.getFilters().length===0)return[];const e=Ig(d2(t));return ye(m2(e)),Sg(e)||kg(e)?[e]:e.getFilters()}function Sg(t){return t instanceof Ge}function kg(t){return t instanceof tt&&nv(t)}function m2(t){return Sg(t)||kg(t)||function(n){if(n instanceof tt&&bg(n)){for(const r of n.getFilters())if(!Sg(r)&&!kg(r))return!1;return!0}return!1}(t)}function Ig(t){if(ye(t instanceof Ge||t instanceof tt),t instanceof Ge)return t;if(t.filters.length===1)return Ig(t.filters[0]);const e=t.filters.map(r=>Ig(r));let n=tt.create(e,t.op);return n=Em(n),m2(n)?n:(ye(n instanceof tt),ye(Io(n)),ye(n.filters.length>1),n.filters.reduce((r,s)=>pv(r,s)))}function pv(t,e){let n;return ye(t instanceof Ge||t instanceof tt),ye(e instanceof Ge||e instanceof tt),n=t instanceof Ge?e instanceof Ge?function(s,i){return tt.create([s,i],"and")}(t,e):xx(t,e):e instanceof Ge?xx(e,t):function(s,i){if(ye(s.filters.length>0&&i.filters.length>0),Io(s)&&Io(i))return NS(s,i.getFilters());const o=bg(s)?s:i,l=bg(s)?i:s,c=o.filters.map(u=>pv(u,l));return tt.create(c,"or")}(t,e),Em(n)}function xx(t,e){if(Io(e))return NS(e,t.getFilters());{const n=e.filters.map(r=>pv(t,r));return tt.create(n,"or")}}function Em(t){if(ye(t instanceof Ge||t instanceof tt),t instanceof Ge)return t;const e=t.getFilters();if(e.length===1)return Em(e[0]);if(wS(t))return t;const n=e.map(s=>Em(s)),r=[];return n.forEach(s=>{s instanceof Ge?r.push(s):s instanceof tt&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:tt.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{constructor(){this.un=new fv}addToCollectionParentIndex(e,n){return this.un.add(n),q.resolve()}getCollectionParents(e,n){return q.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return q.resolve()}deleteFieldIndex(e,n){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,n){return q.resolve()}getDocumentsMatchingTarget(e,n){return q.resolve(null)}getIndexType(e,n){return q.resolve(0)}getFieldIndexes(e,n){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,n){return q.resolve(Qn.min())}getMinOffsetFromCollectionGroup(e,n){return q.resolve(Qn.min())}updateCollectionGroup(e,n,r){return q.resolve()}updateIndexEntries(e,n){return q.resolve()}}class fv{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new rt(He.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new rt(He.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const td=new Uint8Array(0);class V4{constructor(e,n){this.databaseId=n,this.cn=new fv,this.ln=new ba(r=>ai(r),(r,s)=>nu(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const i={collectionId:r,parent:vn(s)};return wx(e).put(i)}return q.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[aS(n),""],!1,!0);return wx(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Rr(o.parent))}return r})}addFieldIndex(e,n){const r=Al(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=Oi(e);return i.next(l=>{o.put(hx(l,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=Al(e),s=Oi(e),i=Mi(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Al(e),r=Mi(e),s=Oi(e);return n.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,n){return q.forEach(this.hn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new Ex(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Mi(e);let s=!0;const i=new Map;return q.forEach(this.hn(n),o=>this.Pn(e,o).next(l=>{s&&(s=!!l),i.set(o,l)})).next(()=>{if(s){let o=De();const l=[];return q.forEach(i,(c,u)=>{ee("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(k=>`${k.fieldPath}:${k.kind}`).join(",")}`}(c)} to execute ${ai(n)}`);const d=function(T,k){const _=fg(k);if(_===void 0)return null;for(const S of gm(T,_.fieldPath))switch(S.op){case"array-contains-any":return S.value.arrayValue.values||[];case"array-contains":return[S.value]}return null}(u,c),f=function(T,k){const _=new Map;for(const S of Ds(k))for(const N of gm(T,S.fieldPath))switch(N.op){case"==":case"in":_.set(S.fieldPath.canonicalString(),N.value);break;case"not-in":case"!=":return _.set(S.fieldPath.canonicalString(),N.value),Array.from(_.values())}return null}(u,c),g=function(T,k){const _=[];let S=!0;for(const N of Ds(k)){const b=N.kind===0?ex(T,N.fieldPath,T.startAt):tx(T,N.fieldPath,T.startAt);_.push(b.value),S&&(S=b.inclusive)}return new us(_,S)}(u,c),v=function(T,k){const _=[];let S=!0;for(const N of Ds(k)){const b=N.kind===0?tx(T,N.fieldPath,T.endAt):ex(T,N.fieldPath,T.endAt);_.push(b.value),S&&(S=b.inclusive)}return new us(_,S)}(u,c),x=this.In(c,u,g),E=this.In(c,u,v),y=this.Tn(c,u,f),h=this.En(c.indexId,d,x,g.inclusive,E,v.inclusive,y);return q.forEach(h,C=>r.G(C,n.limit).next(T=>{T.forEach(k=>{const _=de.fromSegments(k.documentKey);o.has(_)||(o=o.add(_),l.push(_))})}))}).next(()=>l)}return q.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=M4(tt.create(e.filters,"and")).map(r=>Eg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,s,i,o,l){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),u=c/(n!=null?n.length:1),d=[];for(let f=0;f<c;++f){const g=n?this.dn(n[f/u]):td,v=this.An(e,g,r[f%u],s),x=this.Rn(e,g,i[f%u],o),E=l.map(y=>this.An(e,g,y,!0));d.push(...this.createRange(v,x,E))}return d}An(e,n,r,s){const i=new js(e,de.empty(),n,r);return s?i:i.Zt()}Rn(e,n,r,s){const i=new js(e,de.empty(),n,r);return s?i.Zt():i}Pn(e,n){const r=new Ex(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const l of i)r.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,n){let r=2;const s=this.hn(n);return q.forEach(s,i=>this.Pn(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new rt(vt.comparator),d=!1;for(const f of c.filters)for(const g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:u=u.add(g.field));for(const f of c.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}Vn(e,n){const r=new Tl;for(const s of Ds(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);Vs.vt.It(i,o)}return r.zt()}dn(e){const n=new Tl;return Vs.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new Tl;return Vs.vt.It(ri(this.databaseId,n),r.Yt(function(i){const o=Ds(i);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let s=[];s.push(new Tl);let i=0;for(const o of Ds(e)){const l=r[i++];for(const c of s)if(this.fn(n,o.fieldPath)&&Lc(l))s=this.gn(s,o,l);else{const u=c.Yt(o.kind);Vs.vt.It(l,u)}}return this.pn(s)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const l of s){const c=new Tl;c.seed(l.zt()),Vs.vt.It(o,c.Yt(n.kind)),i.push(c)}return i}fn(e,n){return!!e.filters.find(r=>r instanceof Ge&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Al(e),s=Oi(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(i=>{const o=[];return q.forEach(i,l=>s.get([l.indexId,this.uid]).next(c=>{o.push(function(d,f){const g=f?new So(f.sequenceNumber,new Qn(li(f.readTime),new de(Rr(f.documentKey)),f.largestBatchId)):So.empty(),v=d.fields.map(([x,E])=>new Qs(vt.fromServerFormat(x),E));return new Co(d.indexId,d.collectionGroup,v,g)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:Ae(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=Al(e),i=Oi(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(l=>q.forEach(l,c=>i.put(hx(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return q.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?q.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(r.set(s.collectionGroup,l),q.forEach(l,c=>this.wn(e,s,c).next(u=>{const d=this.Sn(i,c);return u.isEqual(d)?q.resolve():this.bn(e,i,c,u,d)}))))})}Dn(e,n,r,s){return Mi(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,s){return Mi(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const s=Mi(e);let i=new rt(Ta);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(o,l)=>{i=i.add(new js(r.indexId,n,l.arrayValue,l.directionalValue))}).next(()=>i)}Sn(e,n){let r=new rt(Ta);const s=this.Vn(n,e);if(s==null)return r;const i=fg(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Lc(o))for(const l of o.arrayValue.values||[])r=r.add(new js(n.indexId,e.key,this.dn(l),s))}else r=r.add(new js(n.indexId,e.key,td,s));return r}bn(e,n,r,s,i){ee("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(c,u,d,f,g){const v=c.getIterator(),x=u.getIterator();let E=Di(v),y=Di(x);for(;E||y;){let h=!1,C=!1;if(E&&y){const T=d(E,y);T<0?C=!0:T>0&&(h=!0)}else E!=null?C=!0:h=!0;h?(f(y),y=Di(x)):C?(g(E),E=Di(v)):(E=Di(v),y=Di(x))}}(s,i,Ta,l=>{o.push(this.Dn(e,n,r,l))},l=>{o.push(this.vn(e,n,r,l))}),q.waitFor(o)}yn(e){let n=1;return Oi(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,l)=>Ta(o,l)).filter((o,l,c)=>!l||Ta(o,c[l-1])!==0);const s=[];s.push(e);for(const o of r){const l=Ta(o,e),c=Ta(o,n);if(l===0)s[0]=e.Zt();else if(l>0&&c<0)s.push(o),s.push(o.Zt());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const l=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,td,[]],c=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,td,[]];i.push(IDBKeyRange.bound(l,c))}return i}Cn(e,n){return Ta(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(_x)}getMinOffset(e,n){return q.mapArray(this.hn(n),r=>this.Pn(e,r).next(s=>s||me())).next(_x)}}function wx(t){return Gt(t,"collectionParents")}function Mi(t){return Gt(t,"indexEntries")}function Al(t){return Gt(t,"indexConfiguration")}function Oi(t){return Gt(t,"indexState")}function _x(t){ye(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;X0(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Qn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class hn{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new hn(e,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p2(t,e,n){const r=t.store("mutations"),s=t.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let l=0;const c=r.J({range:o},(d,f,g)=>(l++,g.delete()));i.push(c.next(()=>{ye(l===1)}));const u=[];for(const d of n.mutations){const f=dS(e,d.key.path,n.batchId);i.push(s.delete(f)),u.push(d.key)}return q.waitFor(i).next(()=>u)}function xm(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw me();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hn.DEFAULT_COLLECTION_PERCENTILE=10,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,hn.DEFAULT=new hn(41943040,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),hn.DISABLED=new hn(-1,0,0);class Np{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,n,r,s){ye(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Np(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Aa(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Bi(e),o=Aa(e);return o.add({}).next(l=>{ye(typeof l=="number");const c=new ov(l,n,r,s),u=function(v,x,E){const y=E.baseMutations.map(C=>Oc(v.ct,C)),h=E.mutations.map(C=>Oc(v.ct,C));return{userId:x,batchId:E.batchId,localWriteTimeMs:E.localWriteTime.toMillis(),baseMutations:y,mutations:h}}(this.serializer,this.userId,c),d=[];let f=new rt((g,v)=>Ae(g.canonicalString(),v.canonicalString()));for(const g of s){const v=dS(this.userId,g.key.path,l);f=f.add(g.key.path.popLast()),d.push(o.put(u)),d.push(i.put(v,CD))}return f.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),q.waitFor(d).next(()=>c)})}lookupMutationBatch(e,n){return Aa(e).get(n).next(r=>r?(ye(r.userId===this.userId),Os(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?q.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Fn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Aa(e).J({index:"userMutationsIndex",range:s},(o,l,c)=>{l.userId===this.userId&&(ye(l.batchId>=r),i=Os(this.serializer,l)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Aa(e).J({index:"userMutationsIndex",range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Aa(e).U("userMutationsIndex",n).next(r=>r.map(s=>Os(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Id(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Bi(e).J({range:s},(o,l,c)=>{const[u,d,f]=o,g=Rr(d);if(u===this.userId&&n.path.isEqual(g))return Aa(e).get(f).next(v=>{if(!v)throw me();ye(v.userId===this.userId),i.push(Os(this.serializer,v))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new rt(Ae);const s=[];return n.forEach(i=>{const o=Id(this.userId,i.path),l=IDBKeyRange.lowerBound(o),c=Bi(e).J({range:l},(u,d,f)=>{const[g,v,x]=u,E=Rr(v);g===this.userId&&i.path.isEqual(E)?r=r.add(x):f.done()});s.push(c)}),q.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Id(this.userId,r),o=IDBKeyRange.lowerBound(i);let l=new rt(Ae);return Bi(e).J({range:o},(c,u,d)=>{const[f,g,v]=c,x=Rr(g);f===this.userId&&r.isPrefixOf(x)?x.length===s&&(l=l.add(v)):d.done()}).next(()=>this.xn(e,l))}xn(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Aa(e).get(i).next(o=>{if(o===null)throw me();ye(o.userId===this.userId),r.push(Os(this.serializer,o))}))}),q.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return p2(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),q.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return q.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Bi(e).J({range:r},(i,o,l)=>{if(i[0]===this.userId){const c=Rr(i[1]);s.push(c)}else l.done()}).next(()=>{ye(s.length===0)})})}containsKey(e,n){return f2(e,this.userId,n)}Nn(e){return h2(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function f2(t,e,n){const r=Id(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Bi(t).J({range:i,H:!0},(l,c,u)=>{const[d,f,g]=l;d===e&&f===s&&(o=!0),u.done()}).next(()=>o)}function Aa(t){return Gt(t,"mutations")}function Bi(t){return Gt(t,"documentMutations")}function h2(t){return Gt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ci(0)}static kn(){return new ci(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new ci(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>_e.fromTimestamp(new Nt(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Qn(e,s)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Vi(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(ye(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Vi(e).J((o,l)=>{const c=Gl(l);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>q.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Vi(e).J((r,s)=>{const i=Gl(s);n(i)})}qn(e){return Cx(e).get("targetGlobalKey").next(n=>(ye(n!==null),n))}Qn(e,n){return Cx(e).put("targetGlobalKey",n)}Kn(e,n){return Vi(e).put(u2(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=ai(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Vi(e).J({range:s,index:"queryTargetsIndex"},(o,l,c)=>{const u=Gl(l);nu(n,u.target)&&(i=u,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=Fa(e);return n.forEach(o=>{const l=vn(o.path);s.push(i.put({targetId:r,path:l})),s.push(this.referenceDelegate.addReference(e,r,o))}),q.waitFor(s)}removeMatchingKeys(e,n,r){const s=Fa(e);return q.forEach(n,i=>{const o=vn(i.path);return q.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=Fa(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Fa(e);let i=De();return s.J({range:r,H:!0},(o,l,c)=>{const u=Rr(o[1]),d=new de(u);i=i.add(d)}).next(()=>i)}containsKey(e,n){const r=vn(n.path),s=IDBKeyRange.bound([r],[aS(r)],!1,!0);let i=0;return Fa(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,l],c,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}ot(e,n){return Vi(e).get(n).next(r=>r?Gl(r):null)}}function Vi(t){return Gt(t,"targets")}function Cx(t){return Gt(t,"targetGlobal")}function Fa(t){return Gt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sx([t,e],[n,r]){const s=Ae(t,n);return s===0?Ae(e,r):s}class F4{constructor(e){this.Un=e,this.buffer=new rt(Sx),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Sx(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class g2{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){ee("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){bs(n)?ee("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await vs(n)}await this.Hn(3e5)})}}class z4{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return q.resolve(Rn.oe);const r=new F4(n);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ee("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(Nx)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Nx):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,s,i,o,l,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,l=Date.now(),this.removeTargets(e,r,n))).next(f=>(i=f,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(u=Date.now(),zi()<=We.DEBUG&&ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function v2(t,e){return new z4(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U4{constructor(e,n){this.db=e,this.garbageCollector=v2(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,s)=>n(s))}addReference(e,n,r){return nd(e,r)}removeReference(e,n,r){return nd(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return nd(e,n)}nr(e,n){return function(s,i){let o=!1;return h2(s).Y(l=>f2(s,l,i).next(c=>(c&&(o=!0),q.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,l)=>{if(l<=n){const c=this.nr(e,o).next(u=>{if(!u)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,_e.min()),Fa(e).delete(function(f){return[0,vn(f.path)]}(o))))});s.push(c)}}).next(()=>q.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return nd(e,n)}tr(e,n){const r=Fa(e);let s,i=Rn.oe;return r.J({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:u})=>{o===0?(i!==Rn.oe&&n(new de(Rr(s)),i),i=u,s=c):i=Rn.oe}).next(()=>{i!==Rn.oe&&n(new de(Rr(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function nd(t,e){return Fa(t).put(function(r,s){return{targetId:0,path:vn(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2{constructor(){this.changes=new ba(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,mt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?q.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ts(e).put(r)}removeEntry(e,n,r){return Ts(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],ym(o),l[l.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=mt.newInvalidDocument(n);return Ts(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Pl(n))},(s,i)=>{r=this.ir(n,i)}).next(()=>r)}sr(e,n){let r={size:0,document:mt.newInvalidDocument(n)};return Ts(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Pl(n))},(s,i)=>{r={document:this.ir(n,i),size:xm(i)}}).next(()=>r)}getEntries(e,n){let r=Dn();return this._r(e,n,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(e,n){let r=Dn(),s=new ct(de.comparator);return this._r(e,n,(i,o)=>{const l=this.ir(i,o);r=r.insert(i,l),s=s.insert(i,xm(o))}).next(()=>({documents:r,ur:s}))}_r(e,n,r){if(n.isEmpty())return q.resolve();let s=new rt(Tx);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(Pl(s.first()),Pl(s.last())),o=s.getIterator();let l=o.getNext();return Ts(e).J({index:"documentKeyIndex",range:i},(c,u,d)=>{const f=de.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&Tx(l,f)<0;)r(l,null),l=o.getNext();l&&l.isEqual(f)&&(r(l,u),l=o.hasNext()?o.getNext():null),l?d.$(Pl(l)):d.done()}).next(()=>{for(;l;)r(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,l=[o.popLast().toArray(),o.lastSegment(),ym(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ts(e).U(IDBKeyRange.bound(l,c,!0)).next(u=>{i==null||i.incrementDocumentReadCount(u.length);let d=Dn();for(const f of u){const g=this.ir(de.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(au(n,g)||s.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,n,r,s){let i=Dn();const o=Ix(n,r),l=Ix(n,Qn.max());return Ts(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,u,d)=>{const f=this.ir(de.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(f.key,f),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new B4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return kx(e).get("remoteDocumentGlobalKey").next(n=>(ye(!!n),n))}rr(e,n){return kx(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=I4(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(_e.min())))return r}return mt.newInvalidDocument(e)}}function y2(t){return new $4(t)}class B4 extends b2{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new ba(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new rt((i,o)=>Ae(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.lr.get(i);if(n.push(this.cr.removeEntry(e,i,l.readTime)),o.isValidDocument()){const c=px(this.cr.serializer,o);s=s.add(i.path.popLast());const u=xm(c);r+=u-l.size,n.push(this.cr.addEntry(e,i,c))}else if(r-=l.size,this.trackRemovals){const c=px(this.cr.serializer,o.convertToNoDocument(_e.min()));n.push(this.cr.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.cr.updateMetadata(e,r)),q.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function kx(t){return Gt(t,"remoteDocumentGlobal")}function Ts(t){return Gt(t,"remoteDocumentsV14")}function Pl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Ix(t,e){const n=e.documentKey.path.toArray();return[t,ym(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Tx(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=Ae(n[i],r[i]),s)return s;return s=Ae(n.length,r.length),s||(s=Ae(n[n.length-2],r[r.length-2]),s||Ae(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&ic(r.mutation,s,Ln.empty(),Nt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,De()).next(()=>r))}getLocalViewOfDocuments(e,n,r=De()){const s=Lr();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Wl();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Lr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,De()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Dn();const o=sc(),l=function(){return sc()}();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof ya)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),ic(d.mutation,u,d.mutation.getFieldMask(),Nt.now())):o.set(u.key,Ln.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var f;return l.set(u,new q4(d,(f=o.get(u))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,n){const r=sc();let s=new ct((o,l)=>o-l),i=De();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||Ln.empty();d=l.applyToLocalView(u,d),r.set(c,d);const f=(s.get(l.batchId)||De()).add(c);s=s.insert(l.batchId,f)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,f=OS();d.forEach(g=>{if(!i.has(g)){const v=BS(n.get(g),r.get(g));v!==null&&f.set(g,v),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return q.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return de.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):rv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):q.resolve(Lr());let l=-1,c=i;return o.next(u=>q.forEach(u,(d,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(d)?q.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{c=c.insert(d,g)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,De())).next(d=>({batchId:l,changes:MS(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new de(n)).next(r=>{let s=Wl();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Wl();return this.indexManager.getCollectionParents(e,i).next(l=>q.forEach(l,c=>{const u=function(f,g){return new va(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((f,g)=>{o=o.insert(f,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,mt.newInvalidDocument(d)))});let l=Wl();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&ic(d.mutation,u,Ln.empty(),Nt.now()),au(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return q.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Mt(s.createTime)}}(n)),q.resolve()}getNamedQuery(e,n){return q.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:mv(s.bundledQuery),readTime:Mt(s.readTime)}}(n)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(){this.overlays=new ct(de.comparator),this.Ir=new Map}getOverlay(e,n){return q.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Lr();return q.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),q.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),q.resolve()}getOverlaysForCollection(e,n,r){const s=Lr(),i=n.length+1,o=new de(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return q.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ct((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=Lr(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=Lr(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return q.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new cv(n,r));let i=this.Ir.get(n);i===void 0&&(i=De(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(){this.sessionToken=Tt.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(){this.Tr=new rt(Jt.Er),this.dr=new rt(Jt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Jt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Jt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new de(new He([])),r=new Jt(n,e),s=new Jt(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new de(new He([])),r=new Jt(n,e),s=new Jt(n,e+1);let i=De();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Jt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Jt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return de.comparator(e.key,n.key)||Ae(e.wr,n.wr)}static Ar(e,n){return Ae(e.wr,n.wr)||de.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new rt(Jt.Er)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new ov(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new Jt(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return q.resolve(o)}lookupMutationBatch(e,n){return q.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return q.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Jt(n,0),s=new Jt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const l=this.Dr(o.wr);i.push(l)}),q.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new rt(Ae);return n.forEach(s=>{const i=new Jt(s,0),o=new Jt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),q.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;de.isDocumentKey(i)||(i=i.child(""));const o=new Jt(new de(i),0);let l=new rt(Ae);return this.br.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.wr)),!0)},o),q.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){ye(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return q.forEach(n.mutations,s=>{const i=new Jt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Jt(n,0),s=this.br.firstAfterOrEqual(r);return q.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(e){this.Mr=e,this.docs=function(){return new ct(de.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return q.resolve(r?r.document.mutableCopy():mt.newInvalidDocument(n))}getEntries(e,n){let r=Dn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():mt.newInvalidDocument(s))}),q.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Dn();const o=n.path,l=new de(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||X0(iS(d),r)<=0||(s.has(d.key)||au(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return q.resolve(i)}getAllFromCollectionGroup(e,n,r,s){me()}Or(e,n){return q.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new J4(this)}getSize(e){return q.resolve(this.size)}}class J4 extends b2{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),q.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e){this.persistence=e,this.Nr=new ba(n=>ai(n),nu),this.lastRemoteSnapshotVersion=_e.min(),this.highestTargetId=0,this.Lr=0,this.Br=new hv,this.targetCount=0,this.kr=ci.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),q.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ci(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,q.resolve()}updateTargetData(e,n){return this.Kn(n),q.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),q.waitFor(i).next(()=>s)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return q.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),q.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),q.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),q.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return q.resolve(r)}containsKey(e,n){return q.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Rn(0),this.Kr=!1,this.Kr=!0,this.$r=new G4,this.referenceDelegate=e(this),this.Ur=new Y4(this),this.indexManager=new O4,this.remoteDocumentCache=function(s){return new Q4(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new c2(n),this.Gr=new W4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new H4,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new K4(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){ee("MemoryPersistence","Starting transaction:",e);const s=new Z4(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return q.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class Z4 extends lS{constructor(e){super(),this.currentSequenceNumber=e}}class Cp{constructor(e){this.persistence=e,this.Jr=new hv,this.Yr=null}static Zr(e){return new Cp(e)}get Xr(){if(this.Yr)return this.Yr;throw me()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),q.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),q.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),q.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.Xr,r=>{const s=de.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,_e.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return q.or([()=>q.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}class wm{constructor(e,n){this.persistence=e,this.ti=new ba(r=>vn(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=v2(this,n)}static Zr(e,n){return new wm(e,n)}zr(){}jr(e){return q.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}Yn(e){const n=this.er(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}Zn(e,n){return q.forEach(this.ti,(r,s)=>this.nr(e,r,s).next(i=>i?q.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.Or(e,o=>this.nr(e,o,n).next(l=>{l||(r++,i.removeEntry(o,_e.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.ti.set(n,e.currentSequenceNumber),q.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.ti.set(r,e.currentSequenceNumber),q.resolve()}removeReference(e,n,r){return this.ti.set(r,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,n){return this.ti.set(n,e.currentSequenceNumber),q.resolve()}Wr(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Ad(e.data.value)),n}nr(e,n,r){return q.or([()=>this.persistence.Hr(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.ti.get(n);return q.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(e){this.serializer=e}O(e,n,r,s){const i=new gp("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",BE,{unique:!0}),c.createObjectStore("documentMutations")}(e),Ax(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=q.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),Ax(e)),o=o.next(()=>function(c){const u=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:_e.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",BE,{unique:!0});const f=u.store("mutations"),g=d.map(v=>f.put(v));return q.waitFor(g)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore("documentOverlays",{keyPath:VD});u.createIndex("collectionPathOverlayIndex",jD,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",FD,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore("remoteDocumentsV14",{keyPath:SD});u.createIndex("documentKeyIndex",kD),u.createIndex("collectionGroupIndex",ID)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:LD}).createIndex("sequenceNumberIndex",DD,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:MD}).createIndex("documentKeyIndex",OD,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let n=0;return e.store("remoteDocuments").J((r,s)=>{n+=xm(s)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(s=>q.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(l=>q.forEach(l,c=>{ye(c.userId===i.userId);const u=Os(this.serializer,c);return p2(e,i.userId,u).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,l)=>{const c=new He(o),u=function(f){return[0,vn(f)]}(c);i.push(n.get(u).next(d=>d?q.resolve():(f=>n.put({targetId:0,path:vn(f),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>q.waitFor(i))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:RD});const r=n.store("collectionParents"),s=new fv,i=o=>{if(s.add(o)){const l=o.lastSegment(),c=o.popLast();return r.put({collectionId:l,parent:vn(c)})}};return n.store("remoteDocuments").J({H:!0},(o,l)=>{const c=new He(o);return i(c.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,l,c],u)=>{const d=Rr(l);return i(d.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,s)=>{const i=Gl(s),o=u2(this.serializer,i);return n.put(o)})}_i(e,n){const r=n.store("remoteDocuments"),s=[];return r.J((i,o)=>{const l=n.store("remoteDocumentsV14"),c=function(f){return f.document?new de(He.fromString(f.document.name).popFirst(5)):f.noDocument?de.fromSegments(f.noDocument.path):f.unknownDocument?de.fromSegments(f.unknownDocument.path):me()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(l.put(u))}).next(()=>q.waitFor(s))}ai(e,n){const r=n.store("mutations"),s=y2(this.serializer),i=new gv(Cp.Zr,this.serializer.ct);return r.U().next(o=>{const l=new Map;return o.forEach(c=>{var u;let d=(u=l.get(c.userId))!==null&&u!==void 0?u:De();Os(this.serializer,c).keys().forEach(f=>d=d.add(f)),l.set(c.userId,d)}),q.forEach(l,(c,u)=>{const d=new Zt(u),f=_p.lt(this.serializer,d),g=i.getIndexManager(d),v=Np.lt(d,this.serializer,g,i.referenceDelegate);return new E2(s,v,f,g).recalculateAndSaveOverlaysForDocumentKeys(new hg(n,Rn.oe),c).next()})})}}function Ax(t){t.createObjectStore("targetDocuments",{keyPath:AD}).createIndex("documentTargetsIndex",PD,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",TD,{unique:!0}),t.createObjectStore("targetGlobal")}const $f="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class vv{constructor(e,n,r,s,i,o,l,c,u,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=i,this.window=o,this.document=l,this.ci=u,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=g=>Promise.resolve(),!vv.D())throw new te(K.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new U4(this,s),this.Ai=n+"main",this.serializer=new c2(c),this.Ri=new Vr(this.Ai,this.hi,new X4(this.serializer)),this.$r=new A4,this.Ur=new j4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=y2(this.serializer),this.Gr=new T4,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&Lt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new te(K.FAILED_PRECONDITION,$f);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Rn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>rd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(bs(e))return ee("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ee("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Rl(e).get("owner").next(n=>q.resolve(this.vi(n)))}Ci(e){return rd(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Gt(n,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(l=>i.indexOf(l)===-1);return q.forEach(o,l=>r.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?q.resolve(!0):Rl(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new te(K.FAILED_PRECONDITION,$f);return!1}}return!(!this.networkEnabled||!this.inForeground)||rd(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&ee("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new hg(e,Rn.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>rd(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return Np.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new V4(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return _p.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){ee("IndexedDbPersistence","Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===17?$D:c===16?UD:c===15?tv:c===14?fS:c===13?pS:c===12?zD:c===11?mS:void me()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,l=>(o=new hg(l,this.Qr?this.Qr.next():Rn.oe),n==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw Lt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new te(K.FAILED_PRECONDITION,oS);return r(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>r(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return Rl(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new te(K.FAILED_PRECONDITION,$f)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Rl(e).put("owner",n)}static D(){return Vr.D()}bi(e){const n=Rl(e);return n.get("owner").next(r=>this.vi(r)?(ee("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):q.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Lt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;$C()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return ee("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Lt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Lt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Rl(t){return Gt(t,"owner")}function rd(t){return Gt(t,"clientMetadata")}function bv(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=De(),s=De();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new yv(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x2{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return $C()?8:cS(Wt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new e6;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(zi()<=We.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",Ui(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),q.resolve()):(zi()<=We.DEBUG&&ee("QueryEngine","Query:",Ui(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(zi()<=We.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",Ui(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,bn(n))):q.resolve())}Yi(e,n){if(nx(n))return q.resolve(null);let r=bn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=vm(n,null,"F"),r=bn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=De(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ts(n,l);return this.ns(n,u,o,c.readTime)?this.Yi(e,vm(n,null,"F")):this.rs(e,u,n,c)}))})))}Zi(e,n,r,s){return nx(n)||s.isEqual(_e.min())?q.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?q.resolve(null):(zi()<=We.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ui(n)),this.rs(e,o,n,sS(s,-1)).next(l=>l))})}ts(e,n){let r=new rt(LS(e));return n.forEach((s,i)=>{au(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return zi()<=We.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",Ui(n)),this.Ji.getDocumentsMatchingQuery(e,n,Qn.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new ct(Ae),this._s=new ba(i=>ai(i),nu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new E2(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function w2(t,e,n,r){return new t6(t,e,n,r)}async function _2(t,e){const n=le(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=De();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function n6(t,e){const n=le(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const f=u.batch,g=f.keys();let v=q.resolve();return g.forEach(x=>{v=v.next(()=>d.getEntry(c,x)).next(E=>{const y=u.docVersions.get(x);ye(y!==null),E.version.compareTo(y)<0&&(f.applyToRemoteDocument(E,u),E.isValidDocument()&&(E.setReadTime(u.commitVersion),d.addEntry(E)))})}),v.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=De();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function N2(t){const e=le(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function r6(t,e){const n=le(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((d,f)=>{const g=s.get(f);if(!g)return;l.push(n.Ur.removeMatchingKeys(i,d.removedDocuments,f).next(()=>n.Ur.addMatchingKeys(i,d.addedDocuments,f)));let v=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?v=v.withResumeToken(Tt.EMPTY_BYTE_STRING,_e.min()).withLastLimboFreeSnapshotVersion(_e.min()):d.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(d.resumeToken,r)),s=s.insert(f,v),function(E,y,h){return E.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=3e8?!0:h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size>0}(g,v,d)&&l.push(n.Ur.updateTargetData(i,v))});let c=Dn(),u=De();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(C2(i,o,e.documentUpdates).next(d=>{c=d.Ps,u=d.Is})),!r.isEqual(_e.min())){const d=n.Ur.getLastRemoteSnapshotVersion(i).next(f=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return q.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.os=s,i))}function C2(t,e,n){let r=De(),s=De();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Dn();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(_e.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):ee("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:s}})}function a6(t,e){const n=le(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ro(t,e){const n=le(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,q.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new Yr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Lo(t,e,n){const r=le(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!bs(o))throw o;ee("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function _m(t,e,n){const r=le(t);let s=_e.min(),i=De();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const f=le(c),g=f._s.get(d);return g!==void 0?q.resolve(f.os.get(g)):f.Ur.getTargetData(u,d)}(r,o,bn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:_e.min(),n?i:De())).next(l=>(I2(r,RS(e),l),{documents:l,Ts:i})))}function S2(t,e){const n=le(t),r=le(n.Ur),s=n.os.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.ot(i,e).next(o=>o?o.target:null))}function k2(t,e){const n=le(t),r=n.us.get(e)||_e.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.cs.getAllFromCollectionGroup(s,e,sS(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(I2(n,e,s),s))}function I2(t,e,n){let r=t.us.get(e)||_e.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}async function s6(t,e,n,r){const s=le(t);let i=De(),o=Dn();for(const u of n){const d=e.Es(u.metadata.name);u.document&&(i=i.add(d));const f=e.ds(u);f.setReadTime(e.As(u.metadata.readTime)),o=o.insert(d,f)}const l=s.cs.newChangeBuffer({trackRemovals:!0}),c=await Ro(s,function(d){return bn(Ho(He.fromString(`__bundle__/docs/${d}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",u=>C2(u,l,o).next(d=>(l.apply(u),d)).next(d=>s.Ur.removeMatchingKeysForTargetId(u,c.targetId).next(()=>s.Ur.addMatchingKeys(u,i,c.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(u,d.Ps,d.Is)).next(()=>d.Ps)))}async function i6(t,e,n=De()){const r=await Ro(t,bn(mv(e.bundledQuery))),s=le(t);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=Mt(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Gr.saveNamedQuery(i,e);const l=r.withResumeToken(Tt.EMPTY_BYTE_STRING,o);return s.os=s.os.insert(l.targetId,l),s.Ur.updateTargetData(i,l).next(()=>s.Ur.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Ur.addMatchingKeys(i,n,r.targetId)).next(()=>s.Gr.saveNamedQuery(i,e))})}function Px(t,e){return`firestore_clients_${t}_${e}`}function Rx(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Bf(t,e){return`firestore_targets_${t}_${e}`}class Nm{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static Rs(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new te(s.error.code,s.error.message))),o?new Nm(e,n,s.state,i):(Lt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class oc{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new te(r.error.code,r.error.message))),i?new oc(e,r.state,s):(Lt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Cm{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=av();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=uS(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new Cm(e,i):(Lt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Ev{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Ev(n.clientId,n.onlineState):(Lt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Tg{constructor(){this.activeTargetIds=av()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class qf{constructor(e,n,r,s,i){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new ct(Ae),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=Px(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Tg),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const s=this.getItem(Px(this.persistenceKey,r));if(s){const i=Cm.Rs(r,s);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Bf(this.persistenceKey,e));if(s){const i=oc.Rs(e,s);i&&(r=i.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Bf(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.Qs(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return ee("SharedClientState","READ",e,n),n}setItem(e,n){ee("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){ee("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(ee("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void Lt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(i){let o=Rn.oe;if(i!=null)try{const l=JSON.parse(i);ye(typeof l=="number"),o=l}catch(l){Lt("SharedClientState","Failed to read sequence number from WebStorage",l)}return o}(n.newValue);r!==Rn.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(s=>this.syncEngine.eo(s)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const s=new Nm(this.currentUser,e,n,r),i=Rx(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Vs())}Qs(e){const n=Rx(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const s=Bf(this.persistenceKey,e),i=new oc(e,n,r);this.setItem(s,i.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return Cm.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return Nm.Rs(new Zt(i),s,n)}Ys(e,n){const r=this.Ms.exec(e),s=Number(r[1]);return oc.Rs(s,n)}Ls(e){return Ev.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);ee("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),s=this.ks(this.Ss),i=this.ks(r),o=[],l=[];return i.forEach(c=>{s.has(c)||o.push(c)}),s.forEach(c=>{i.has(c)||l.push(c)}),this.syncEngine.io(o,l).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=av();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class T2{constructor(){this.so=new Tg,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Tg,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ee("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ee("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ad=null;function Wf(){return ad===null?ad=function(){return 268435456+Math.round(2147483648*Math.random())}():ad++,"0x"+ad.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fn="WebChannelConnection";class u6 extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const l=Wf(),c=this.xo(n,r.toUriEncodedString());ee("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,o),this.No(n,c,u,s).then(d=>(ee("RestConnection",`Received RPC '${n}' ${l}: `,d),d),d=>{throw or("RestConnection",`RPC '${n}' ${l} failed with error: `,d,"url: ",c,"request:",s),d})}Lo(n,r,s,i,o,l){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Wo}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=l6[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=Wf();return new Promise((o,l)=>{const c=new JC;c.setWithCredentials(!0),c.listenOnce(YC.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case kd.NO_ERROR:const d=c.getResponseJson();ee(fn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case kd.TIMEOUT:ee(fn,`RPC '${e}' ${i} timed out`),l(new te(K.DEADLINE_EXCEEDED,"Request time out"));break;case kd.HTTP_ERROR:const f=c.getStatus();if(ee(fn,`RPC '${e}' ${i} failed with status:`,f,"response text:",c.getResponseText()),f>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const v=g==null?void 0:g.error;if(v&&v.status&&v.message){const x=function(y){const h=y.toLowerCase().replace(/_/g,"-");return Object.values(K).indexOf(h)>=0?h:K.UNKNOWN}(v.status);l(new te(x,v.message))}else l(new te(K.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new te(K.UNAVAILABLE,"Connection failed."));break;default:me()}}finally{ee(fn,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);ee(fn,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",u,r,15)})}Bo(e,n,r){const s=Wf(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=eS(),l=XC(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=i.join("");ee(fn,`Creating RPC '${e}' stream ${s}: ${d}`,c);const f=o.createWebChannel(d,c);let g=!1,v=!1;const x=new c6({Io:y=>{v?ee(fn,`Not sending because RPC '${e}' stream ${s} is closed:`,y):(g||(ee(fn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),g=!0),ee(fn,`RPC '${e}' stream ${s} sending:`,y),f.send(y))},To:()=>f.close()}),E=(y,h,C)=>{y.listen(h,T=>{try{C(T)}catch(k){setTimeout(()=>{throw k},0)}})};return E(f,ql.EventType.OPEN,()=>{v||(ee(fn,`RPC '${e}' stream ${s} transport opened.`),x.yo())}),E(f,ql.EventType.CLOSE,()=>{v||(v=!0,ee(fn,`RPC '${e}' stream ${s} transport closed`),x.So())}),E(f,ql.EventType.ERROR,y=>{v||(v=!0,or(fn,`RPC '${e}' stream ${s} transport errored:`,y),x.So(new te(K.UNAVAILABLE,"The operation could not be completed")))}),E(f,ql.EventType.MESSAGE,y=>{var h;if(!v){const C=y.data[0];ye(!!C);const T=C,k=T.error||((h=T[0])===null||h===void 0?void 0:h.error);if(k){ee(fn,`RPC '${e}' stream ${s} received error:`,k);const _=k.status;let S=function(w){const A=jt[w];if(A!==void 0)return GS(A)}(_),N=k.message;S===void 0&&(S=K.INTERNAL,N="Unknown error status: "+_+" with message "+k.message),v=!0,x.So(new te(S,N)),f.close()}else ee(fn,`RPC '${e}' stream ${s} received:`,C),x.bo(C)}}),E(l,ZC.STAT_EVENT,y=>{y.stat===pg.PROXY?ee(fn,`RPC '${e}' stream ${s} detected buffering proxy`):y.stat===pg.NOPROXY&&ee(fn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A2(){return typeof window<"u"?window:null}function Dd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lu(t){return new b4(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&ee("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P2{constructor(e,n,r,s,i,o,l,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new xv(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===K.RESOURCE_EXHAUSTED?(Lt(n.toString()),Lt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===K.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new te(K.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ee("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(ee("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class d6 extends P2{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=x4(this.serializer,e),r=function(i){if(!("targetChange"in i))return _e.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?_e.min():o.readTime?Mt(o.readTime):_e.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Ng(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=hm(c)?{documents:r2(i,c)}:{query:wp(i,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=YS(i,o.resumeToken);const u=wg(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(_e.min())>0){l.readTime=Po(i,o.snapshotVersion.toTimestamp());const u=wg(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=_4(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Ng(this.serializer),n.removeTarget=e,this.a_(n)}}class m6 extends P2{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return ye(!!e.streamToken),this.lastStreamToken=e.streamToken,ye(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ye(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=w4(e.writeResults,e.commitTime),r=Mt(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Ng(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Oc(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6 extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new te(K.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,_g(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new te(K.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,_g(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new te(K.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class f6{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Lt(n),this.D_=!1):ee("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Es(this)&&(ee("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=le(c);u.L_.add(4),await Qo(u),u.q_.set("Unknown"),u.L_.delete(4),await cu(u)}(this))})}),this.q_=new f6(r,s)}}async function cu(t){if(Es(t))for(const e of t.B_)await e(!0)}async function Qo(t){for(const e of t.B_)await e(!1)}function Sp(t,e){const n=le(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Nv(n)?_v(n):Yo(n).r_()&&wv(n,e))}function Do(t,e){const n=le(t),r=Yo(n);n.N_.delete(e),r.r_()&&R2(n,e),n.N_.size===0&&(r.r_()?r.o_():Es(n)&&n.q_.set("Unknown"))}function wv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(_e.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Yo(t).A_(e)}function R2(t,e){t.Q_.xe(e),Yo(t).R_(e)}function _v(t){t.Q_=new f4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Yo(t).start(),t.q_.v_()}function Nv(t){return Es(t)&&!Yo(t).n_()&&t.N_.size>0}function Es(t){return le(t).L_.size===0}function L2(t){t.Q_=void 0}async function g6(t){t.q_.set("Online")}async function v6(t){t.N_.forEach((e,n)=>{wv(t,e)})}async function b6(t,e){L2(t),Nv(t)?(t.q_.M_(e),_v(t)):t.q_.set("Unknown")}async function y6(t,e,n){if(t.q_.set("Online"),e instanceof JS&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){ee("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Sm(t,r)}else if(e instanceof Ld?t.Q_.Ke(e):e instanceof QS?t.Q_.He(e):t.Q_.We(e),!n.isEqual(_e.min()))try{const r=await N2(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.N_.get(u);d&&i.N_.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=i.N_.get(c);if(!d)return;i.N_.set(c,d.withResumeToken(Tt.EMPTY_BYTE_STRING,d.snapshotVersion)),R2(i,c);const f=new Yr(d.target,c,u,d.sequenceNumber);wv(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){ee("RemoteStore","Failed to raise snapshot:",r),await Sm(t,r)}}async function Sm(t,e,n){if(!bs(e))throw e;t.L_.add(1),await Qo(t),t.q_.set("Offline"),n||(n=()=>N2(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await cu(t)})}function D2(t,e){return e().catch(n=>Sm(t,n,e))}async function Jo(t){const e=le(t),n=ds(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;E6(e);)try{const s=await a6(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,x6(e,s)}catch(s){await Sm(e,s)}M2(e)&&O2(e)}function E6(t){return Es(t)&&t.O_.length<10}function x6(t,e){t.O_.push(e);const n=ds(t);n.r_()&&n.V_&&n.m_(e.mutations)}function M2(t){return Es(t)&&!ds(t).n_()&&t.O_.length>0}function O2(t){ds(t).start()}async function w6(t){ds(t).p_()}async function _6(t){const e=ds(t);for(const n of t.O_)e.m_(n.mutations)}async function N6(t,e,n){const r=t.O_.shift(),s=lv.from(r,e,n);await D2(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Jo(t)}async function C6(t,e){e&&ds(t).V_&&await async function(r,s){if(function(o){return HS(o)&&o!==K.ABORTED}(s.code)){const i=r.O_.shift();ds(r).s_(),await D2(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Jo(r)}}(t,e),M2(t)&&O2(t)}async function Dx(t,e){const n=le(t);n.asyncQueue.verifyOperationInProgress(),ee("RemoteStore","RemoteStore received new credentials");const r=Es(n);n.L_.add(3),await Qo(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await cu(n)}async function Ag(t,e){const n=le(t);e?(n.L_.delete(2),await cu(n)):e||(n.L_.add(2),await Qo(n),n.q_.set("Unknown"))}function Yo(t){return t.K_||(t.K_=function(n,r,s){const i=le(n);return i.w_(),new d6(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:g6.bind(null,t),Ro:v6.bind(null,t),mo:b6.bind(null,t),d_:y6.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Nv(t)?_v(t):t.q_.set("Unknown")):(await t.K_.stop(),L2(t))})),t.K_}function ds(t){return t.U_||(t.U_=function(n,r,s){const i=le(n);return i.w_(),new m6(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:w6.bind(null,t),mo:C6.bind(null,t),f_:_6.bind(null,t),g_:N6.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Jo(t)):(await t.U_.stop(),t.O_.length>0&&(ee("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new en,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new Cv(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new te(K.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Zo(t,e){if(Lt("AsyncQueue",`${e}: ${t}`),bs(t))return new te(K.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(e){this.comparator=e?(n,r)=>e(n,r)||de.comparator(n.key,r.key):(n,r)=>de.comparator(n.key,r.key),this.keyedMap=Wl(),this.sortedSet=new ct(this.comparator)}static emptySet(e){return new mo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof mo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new mo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mx{constructor(){this.W_=new ct(de.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):me():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Mo{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Mo(e,n,mo.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ru(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S6{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class k6{constructor(){this.queries=Ox(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=le(n),i=s.queries;s.queries=Ox(),i.forEach((o,l)=>{for(const c of l.j_)c.onError(r)})})(this,new te(K.ABORTED,"Firestore shutting down"))}}function Ox(){return new ba(t=>PS(t),ru)}async function Sv(t,e){const n=le(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new S6,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=Zo(o,`Initialization of query '${Ui(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Iv(n)}async function kv(t,e){const n=le(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function I6(t,e){const n=le(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(r=!0);o.z_=s}}r&&Iv(n)}function T6(t,e,n){const r=le(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Iv(t){t.Y_.forEach(e=>{e.next()})}var Pg,Vx;(Vx=Pg||(Pg={})).ea="default",Vx.Cache="cache";class Tv{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Mo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Mo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Pg.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e,n){this.aa=e,this.byteLength=n}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{constructor(e){this.serializer=e}Es(e){return jr(this.serializer,e)}ds(e){return e.metadata.exists?n2(this.serializer,e.document,!1):mt.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Mt(e)}}class P6{constructor(e,n,r){this.ca=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=V2(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++n;const r=He.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ha(e){const n=new Map,r=new jx(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.Es(s.metadata.name);for(const o of s.metadata.queries){const l=(n.get(o)||De()).add(i);n.set(o,l)}}return n}async complete(){const e=await s6(this.localStore,new jx(this.serializer),this.documents,this.ca.id),n=this.ha(this.documents);for(const r of this.queries)await i6(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function V2(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(e){this.key=e}}class F2{constructor(e){this.key=e}}class z2{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=De(),this.mutatedKeys=De(),this.Aa=LS(e),this.Ra=new mo(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Mx,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const g=s.get(d),v=au(this.query,f)?f:null,x=!!g&&this.mutatedKeys.has(g.key),E=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let y=!1;g&&v?g.data.isEqual(v.data)?x!==E&&(r.track({type:3,doc:v}),y=!0):this.ga(g,v)||(r.track({type:2,doc:v}),y=!0,(c&&this.Aa(v,c)>0||u&&this.Aa(v,u)<0)&&(l=!0)):!g&&v?(r.track({type:0,doc:v}),y=!0):g&&!v&&(r.track({type:1,doc:g}),y=!0,(c||u)&&(l=!0)),y&&(v?(o=o.add(v),i=E?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(v,x){const E=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return me()}};return E(v)-E(x)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new Mo(this.query,e.Ra,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Mx,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=De(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new F2(r))}),this.da.forEach(r=>{e.has(r)||n.push(new j2(r))}),n}ba(e){this.Ta=e.Ts,this.da=De();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Mo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class R6{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class L6{constructor(e){this.key=e,this.va=!1}}class D6{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new ba(l=>PS(l),ru),this.Ma=new Map,this.xa=new Set,this.Oa=new ct(de.comparator),this.Na=new Map,this.La=new hv,this.Ba={},this.ka=new Map,this.qa=ci.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function M6(t,e,n=!0){const r=kp(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await U2(r,e,n,!0),s}async function O6(t,e){const n=kp(t);await U2(n,e,!0,!1)}async function U2(t,e,n,r){const s=await Ro(t.localStore,bn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await Av(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&Sp(t.remoteStore,s),l}async function Av(t,e,n,r,s){t.Ka=(f,g,v)=>async function(E,y,h,C){let T=y.view.ma(h);T.ns&&(T=await _m(E.localStore,y.query,!1).then(({documents:N})=>y.view.ma(N,T)));const k=C&&C.targetChanges.get(y.targetId),_=C&&C.targetMismatches.get(y.targetId)!=null,S=y.view.applyChanges(T,E.isPrimaryClient,k,_);return Rg(E,y.targetId,S.wa),S.snapshot}(t,f,g,v);const i=await _m(t.localStore,e,!0),o=new z2(e,i.Ts),l=o.ma(i.documents),c=ou.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);Rg(t,n,u.wa);const d=new R6(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function V6(t,e,n){const r=le(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!ru(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Lo(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Do(r.remoteStore,s.targetId),Oo(r,s.targetId)}).catch(vs)):(Oo(r,s.targetId),await Lo(r.localStore,s.targetId,!0))}async function j6(t,e){const n=le(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Do(n.remoteStore,r.targetId))}async function F6(t,e,n){const r=Dv(t);try{const s=await function(o,l){const c=le(o),u=Nt.now(),d=l.reduce((v,x)=>v.add(x.key),De());let f,g;return c.persistence.runTransaction("Locally write mutations","readwrite",v=>{let x=Dn(),E=De();return c.cs.getEntries(v,d).next(y=>{x=y,x.forEach((h,C)=>{C.isValidDocument()||(E=E.add(h))})}).next(()=>c.localDocuments.getOverlayedDocuments(v,x)).next(y=>{f=y;const h=[];for(const C of l){const T=d4(C,f.get(C.key).overlayedDocument);T!=null&&h.push(new ya(C.key,T,ES(T.value.mapValue),bt.exists(!0)))}return c.mutationQueue.addMutationBatch(v,u,h,l)}).next(y=>{g=y;const h=y.applyToLocalDocumentSet(f,E);return c.documentOverlayCache.saveOverlays(v,y.batchId,h)})}).then(()=>({batchId:g.batchId,changes:MS(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new ct(Ae)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(r,s.batchId,n),await Ea(r,s.changes),await Jo(r.remoteStore)}catch(s){const i=Zo(s,"Failed to persist write");n.reject(i)}}async function $2(t,e){const n=le(t);try{const r=await r6(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(ye(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?ye(o.va):s.removedDocuments.size>0&&(ye(o.va),o.va=!1))}),await Ea(n,r,e)}catch(r){await vs(r)}}function Fx(t,e,n){const r=le(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=le(o);c.onlineState=l;let u=!1;c.queries.forEach((d,f)=>{for(const g of f.j_)g.Z_(l)&&(u=!0)}),u&&Iv(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function z6(t,e,n){const r=le(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new ct(de.comparator);o=o.insert(i,mt.newNoDocument(i,_e.min()));const l=De().add(i),c=new iu(_e.min(),new Map,new ct(Ae),o,l);await $2(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),Lv(r)}else await Lo(r.localStore,e,!1).then(()=>Oo(r,e,n)).catch(vs)}async function U6(t,e){const n=le(t),r=e.batch.batchId;try{const s=await n6(n.localStore,e);Rv(n,r,null),Pv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ea(n,s)}catch(s){await vs(s)}}async function $6(t,e,n){const r=le(t);try{const s=await function(o,l){const c=le(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(f=>(ye(f!==null),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);Rv(r,e,n),Pv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ea(r,s)}catch(s){await vs(s)}}async function B6(t,e){const n=le(t);Es(n.remoteStore)||ee("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const l=le(o);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>l.mutationQueue.getHighestUnacknowledgedBatchId(c))}(n.localStore);if(r===-1)return void e.resolve();const s=n.ka.get(r)||[];s.push(e),n.ka.set(r,s)}catch(r){const s=Zo(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function Pv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Rv(t,e,n){const r=le(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Oo(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||B2(t,r)})}function B2(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Do(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Lv(t))}function Rg(t,e,n){for(const r of n)r instanceof j2?(t.La.addReference(r.key,e),q6(t,r)):r instanceof F2?(ee("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||B2(t,r.key)):me()}function q6(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(ee("SyncEngine","New document in limbo: "+n),t.xa.add(r),Lv(t))}function Lv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new de(He.fromString(e)),r=t.qa.next();t.Na.set(r,new L6(n)),t.Oa=t.Oa.insert(n,r),Sp(t.remoteStore,new Yr(bn(Ho(n.path)),r,"TargetPurposeLimboResolution",Rn.oe))}}async function Ea(t,e,n){const r=le(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{o.push(r.Ka(c,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const f=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){s.push(u);const f=yv.Wi(c.targetId,u);i.push(f)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(c,u){const d=le(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>q.forEach(u,g=>q.forEach(g.$i,v=>d.persistence.referenceDelegate.addReference(f,g.targetId,v)).next(()=>q.forEach(g.Ui,v=>d.persistence.referenceDelegate.removeReference(f,g.targetId,v)))))}catch(f){if(!bs(f))throw f;ee("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const g=f.targetId;if(!f.fromCache){const v=d.os.get(g),x=v.snapshotVersion,E=v.withLastLimboFreeSnapshotVersion(x);d.os=d.os.insert(g,E)}}}(r.localStore,i))}async function W6(t,e){const n=le(t);if(!n.currentUser.isEqual(e)){ee("SyncEngine","User change. New user:",e.toKey());const r=await _2(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new te(K.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ea(n,r.hs)}}function H6(t,e){const n=le(t),r=n.Na.get(e);if(r&&r.va)return De().add(r.key);{let s=De();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const l=n.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}async function G6(t,e){const n=le(t),r=await _m(n.localStore,e.query,!0),s=e.view.ba(r);return n.isPrimaryClient&&Rg(n,e.targetId,s.wa),s}async function K6(t,e){const n=le(t);return k2(n.localStore,e).then(r=>Ea(n,r))}async function Q6(t,e,n,r){const s=le(t),i=await function(l,c){const u=le(l),d=le(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.Mn(f,c).next(g=>g?u.localDocuments.getDocuments(f,g):q.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await Jo(s.remoteStore):n==="acknowledged"||n==="rejected"?(Rv(s,e,r||null),Pv(s,e),function(l,c){le(le(l).mutationQueue).On(c)}(s.localStore,e)):me(),await Ea(s,i)):ee("SyncEngine","Cannot apply mutation batch with id: "+e)}async function J6(t,e){const n=le(t);if(kp(n),Dv(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await zx(n,r.toArray());n.Qa=!0,await Ag(n.remoteStore,!0);for(const i of s)Sp(n.remoteStore,i)}else if(e===!1&&n.Qa!==!1){const r=[];let s=Promise.resolve();n.Ma.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(Oo(n,o),Lo(n.localStore,o,!0))),Do(n.remoteStore,o)}),await s,await zx(n,r),function(o){const l=le(o);l.Na.forEach((c,u)=>{Do(l.remoteStore,u)}),l.La.pr(),l.Na=new Map,l.Oa=new ct(de.comparator)}(n),n.Qa=!1,await Ag(n.remoteStore,!1)}}async function zx(t,e,n){const r=le(t),s=[],i=[];for(const o of e){let l;const c=r.Ma.get(o);if(c&&c.length!==0){l=await Ro(r.localStore,bn(c[0]));for(const u of c){const d=r.Fa.get(u),f=await G6(r,d);f.snapshot&&i.push(f.snapshot)}}else{const u=await S2(r.localStore,o);l=await Ro(r.localStore,u),await Av(r,q2(u),o,!1,l.resumeToken)}s.push(l)}return r.Ca.d_(i),s}function q2(t){return IS(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Y6(t){return function(n){return le(le(n).persistence).Qi()}(le(t).localStore)}async function Z6(t,e,n,r){const s=le(t);if(s.Qa)return void ee("SyncEngine","Ignoring unexpected query state notification.");const i=s.Ma.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await k2(s.localStore,RS(i[0])),l=iu.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Tt.EMPTY_BYTE_STRING);await Ea(s,o,l);break}case"rejected":await Lo(s.localStore,e,!0),Oo(s,e,r);break;default:me()}}async function X6(t,e,n){const r=kp(t);if(r.Qa){for(const s of e){if(r.Ma.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){ee("SyncEngine","Adding an already active target "+s);continue}const i=await S2(r.localStore,s),o=await Ro(r.localStore,i);await Av(r,q2(i),o.targetId,!1,o.resumeToken),Sp(r.remoteStore,o)}for(const s of n)r.Ma.has(s)&&await Lo(r.localStore,s,!1).then(()=>{Do(r.remoteStore,s),Oo(r,s)}).catch(vs)}}function kp(t){const e=le(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=$2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=H6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=z6.bind(null,e),e.Ca.d_=I6.bind(null,e.eventManager),e.Ca.$a=T6.bind(null,e.eventManager),e}function Dv(t){const e=le(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=U6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$6.bind(null,e),e}function e3(t,e,n){const r=le(t);(async function(i,o,l){try{const c=await o.getMetadata();if(await function(v,x){const E=le(v),y=Mt(x.createTime);return E.persistence.runTransaction("hasNewerBundle","readonly",h=>E.Gr.getBundleMetadata(h,x.id)).then(h=>!!h&&h.createTime.compareTo(y)>=0)}(i.localStore,c))return await o.close(),l._completeWith(function(v){return{taskState:"Success",documentsLoaded:v.totalDocuments,bytesLoaded:v.totalBytes,totalDocuments:v.totalDocuments,totalBytes:v.totalBytes}}(c)),Promise.resolve(new Set);l._updateProgress(V2(c));const u=new P6(c,i.localStore,o.serializer);let d=await o.Ua();for(;d;){const g=await u.la(d);g&&l._updateProgress(g),d=await o.Ua()}const f=await u.complete();return await Ea(i,f.Ia,void 0),await function(v,x){const E=le(v);return E.persistence.runTransaction("Save bundle","readwrite",y=>E.Gr.saveBundleMetadata(y,x))}(i.localStore,c),l._completeWith(f.progress),Promise.resolve(f.Pa)}catch(c){return or("SyncEngine",`Loading bundle failed with ${c}`),l._failWith(c),Promise.resolve(new Set)}})(r,e,n).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class ms{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=lu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return w2(this.persistence,new x2,e.initialUser,this.serializer)}Ga(e){return new gv(Cp.Zr,this.serializer)}Wa(e){return new T2}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ms.provider={build:()=>new ms};class t3 extends ms{constructor(e){super(),this.cacheSizeBytes=e}ja(e,n){ye(this.persistence.referenceDelegate instanceof wm);const r=this.persistence.referenceDelegate.garbageCollector;return new g2(r,e.asyncQueue,n)}Ga(e){const n=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new gv(r=>wm.Zr(r,n),this.serializer)}}class Mv extends ms{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Dv(this.Ja.syncEngine),await Jo(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return w2(this.persistence,new x2,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new g2(r,e.asyncQueue,n)}Ha(e,n){const r=new _D(n,this.persistence);return new wD(e.asyncQueue,r)}Ga(e){const n=bv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new vv(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,A2(),Dd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new T2}}class W2 extends Mv{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof qf&&(this.sharedClientState.syncEngine={no:Q6.bind(null,n),ro:Z6.bind(null,n),io:X6.bind(null,n),Qi:Y6.bind(null,n),eo:K6.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await J6(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=A2();if(!qf.D(n))throw new te(K.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=bv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new qf(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class ps{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Fx(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=W6.bind(null,this.syncEngine),await Ag(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new k6}()}createDatastore(e){const n=lu(e.databaseInfo.databaseId),r=function(i){return new u6(i)}(e.databaseInfo);return function(i,o,l,c){return new p6(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new h6(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Fx(this.syncEngine,n,0),function(){return Lx.D()?new Lx:new o6}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,d){const f=new D6(s,i,o,l,c,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=le(s);ee("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Qo(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}ps.provider={build:()=>new ps};function Ux(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Lt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n3{constructor(e,n){this.Xa=e,this.serializer=n,this.metadata=new en,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const n=this.eu.decode(e),r=Number(n);isNaN(r)&&this.ru(`length string (${n}) is not valid number`);const s=await this.iu(r);return new A6(JSON.parse(s),e.length+r)}su(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const n=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r3{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new te(K.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,i){const o=le(s),l={documents:i.map(f=>Mc(o.serializer,f))},c=await o.Lo("BatchGetDocuments",o.serializer.databaseId,He.emptyPath(),l,i.length),u=new Map;c.forEach(f=>{const g=E4(o.serializer,f);u.set(g.key.toString(),g)});const d=[];return i.forEach(f=>{const g=u.get(f.toString());ye(!!g),d.push(g)}),d}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ko(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=de.fromPath(r);this.mutations.push(new iv(s,this.precondition(s)))}),await async function(r,s){const i=le(r),o={writes:s.map(l=>Oc(i.serializer,l))};await i.Mo("Commit",i.serializer.databaseId,He.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw me();n=_e.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new te(K.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(_e.min())?bt.exists(!1):bt.updateTime(n):bt.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(_e.min()))throw new te(K.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return bt.updateTime(n)}return bt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a3{constructor(e,n,r,s,i){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=i,this._u=r.maxAttempts,this.t_=new xv(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new r3(this.datastore),n=this.cu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.lu(s)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const n=this.updateFunction(e);return!tu(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!HS(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s3{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Zt.UNAUTHENTICATED,this.clientId=rS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ee("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ee("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new en;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Zo(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Hf(t,e){t.asyncQueue.verifyOperationInProgress(),ee("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await _2(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function $x(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Ov(t);ee("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Dx(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Dx(e.remoteStore,s)),t._onlineComponents=e}async function Ov(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee("FirestoreClient","Using user provided OfflineComponentProvider");try{await Hf(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===K.FAILED_PRECONDITION||s.code===K.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;or("Error using user provided cache. Falling back to memory cache: "+n),await Hf(t,new ms)}}else ee("FirestoreClient","Using default OfflineComponentProvider"),await Hf(t,new ms);return t._offlineComponents}async function Tp(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee("FirestoreClient","Using user provided OnlineComponentProvider"),await $x(t,t._uninitializedComponentsProvider._online)):(ee("FirestoreClient","Using default OnlineComponentProvider"),await $x(t,new ps))),t._onlineComponents}function H2(t){return Ov(t).then(e=>e.persistence)}function Xo(t){return Ov(t).then(e=>e.localStore)}function G2(t){return Tp(t).then(e=>e.remoteStore)}function Vv(t){return Tp(t).then(e=>e.syncEngine)}function K2(t){return Tp(t).then(e=>e.datastore)}async function Vo(t){const e=await Tp(t),n=e.eventManager;return n.onListen=M6.bind(null,e.syncEngine),n.onUnlisten=V6.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=O6.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=j6.bind(null,e.syncEngine),n}function i3(t){return t.asyncQueue.enqueue(async()=>{const e=await H2(t),n=await G2(t);return e.setNetworkEnabled(!0),function(s){const i=le(s);return i.L_.delete(0),cu(i)}(n)})}function o3(t){return t.asyncQueue.enqueue(async()=>{const e=await H2(t),n=await G2(t);return e.setNetworkEnabled(!1),async function(s){const i=le(s);i.L_.add(0),await Qo(i),i.q_.set("Offline")}(n)})}function l3(t,e){const n=new en;return t.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const l=await function(u,d){const f=le(u);return f.persistence.runTransaction("read document","readonly",g=>f.localDocuments.getDocument(g,d))}(s,i);l.isFoundDocument()?o.resolve(l):l.isNoDocument()?o.resolve(null):o.reject(new te(K.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const c=Zo(l,`Failed to get document '${i} from cache`);o.reject(c)}}(await Xo(t),e,n)),n.promise}function Q2(t,e,n={}){const r=new en;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new Ip({next:g=>{d.Za(),o.enqueueAndForget(()=>kv(i,f));const v=g.docs.has(l);!v&&g.fromCache?u.reject(new te(K.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&g.fromCache&&c&&c.source==="server"?u.reject(new te(K.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new Tv(Ho(l.path),d,{includeMetadataChanges:!0,_a:!0});return Sv(i,f)}(await Vo(t),t.asyncQueue,e,n,r)),r.promise}function c3(t,e){const n=new en;return t.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const l=await _m(s,i,!0),c=new z2(i,l.Ts),u=c.ma(l.documents),d=c.applyChanges(u,!1);o.resolve(d.snapshot)}catch(l){const c=Zo(l,`Failed to execute query '${i} against cache`);o.reject(c)}}(await Xo(t),e,n)),n.promise}function J2(t,e,n={}){const r=new en;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new Ip({next:g=>{d.Za(),o.enqueueAndForget(()=>kv(i,f)),g.fromCache&&c.source==="server"?u.reject(new te(K.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),f=new Tv(l,d,{includeMetadataChanges:!0,_a:!0});return Sv(i,f)}(await Vo(t),t.asyncQueue,e,n,r)),r.promise}function u3(t,e,n){const r=new en;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await K2(t);r.resolve(async function(o,l,c){var u;const d=le(o),{request:f,ut:g,parent:v}=a2(d.serializer,TS(l),c);d.connection.Fo||delete f.parent;const x=(await d.Lo("RunAggregationQuery",d.serializer.databaseId,v,f,1)).filter(y=>!!y.result);ye(x.length===1);const E=(u=x[0].result)===null||u===void 0?void 0:u.aggregateFields;return Object.keys(E).reduce((y,h)=>(y[g[h]]=E[h],y),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}function d3(t,e){const n=new Ip(e);return t.asyncQueue.enqueueAndForget(async()=>function(s,i){le(s).Y_.add(i),i.next()}(await Vo(t),n)),()=>{n.Za(),t.asyncQueue.enqueueAndForget(async()=>function(s,i){le(s).Y_.delete(i)}(await Vo(t),n))}}function m3(t,e,n,r){const s=function(o,l){let c;return c=typeof o=="string"?KS().encode(o):o,function(d,f){return new n3(d,f)}(function(d,f){if(d instanceof Uint8Array)return Ux(d,f);if(d instanceof ArrayBuffer)return Ux(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),l)}(n,lu(e));t.asyncQueue.enqueueAndForget(async()=>{e3(await Vv(t),s,r)})}function p3(t,e){return t.asyncQueue.enqueue(async()=>function(r,s){const i=le(r);return i.persistence.runTransaction("Get named query","readonly",o=>i.Gr.getNamedQuery(o,s))}(await Xo(t),e))}function f3(t,e){return t.asyncQueue.enqueue(async()=>async function(r,s){const i=le(r),o=i.indexManager,l=[];return i.persistence.runTransaction("Configure indexes","readwrite",c=>o.getFieldIndexes(c).next(u=>function(f,g,v,x,E){f=[...f],g=[...g],f.sort(v),g.sort(v);const y=f.length,h=g.length;let C=0,T=0;for(;C<h&&T<y;){const k=v(f[T],g[C]);k<0?E(f[T++]):k>0?x(g[C++]):(C++,T++)}for(;C<h;)x(g[C++]);for(;T<y;)E(f[T++])}(u,s,bD,d=>{l.push(o.addFieldIndex(c,d))},d=>{l.push(o.deleteFieldIndex(c,d))})).next(()=>q.waitFor(l)))}(await Xo(t),e))}function h3(t,e){return t.asyncQueue.enqueue(async()=>function(r,s){le(r).ss.zi=s}(await Xo(t),e))}function g3(t){return t.asyncQueue.enqueue(async()=>function(n){const r=le(n),s=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",i=>s.deleteAllFieldIndexes(i))}(await Xo(t)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y2(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bx=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jv(t,e,n){if(!n)throw new te(K.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function v3(t,e,n,r){if(e===!0&&r===!0)throw new te(K.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function qx(t){if(!de.isDocumentKey(t))throw new te(K.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Wx(t){if(de.isDocumentKey(t))throw new te(K.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ap(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":me()}function Ue(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new te(K.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ap(t);throw new te(K.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Z2(t,e){if(e<=0)throw new te(K.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hx{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new te(K.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}v3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Y2((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new te(K.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new te(K.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new te(K.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class uu{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Hx({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new te(K.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new te(K.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Hx(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new uD;switch(r.type){case"firstParty":return new fD(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new te(K.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Bx.get(n);r&&(ee("ComponentProvider","Removing Datastore"),Bx.delete(n),r.terminate())}(this),Promise.resolve()}}function b3(t,e,n,r={}){var s;const i=(t=Ue(t,uu))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&or("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,c;if(typeof r.mockUserToken=="string")l=r.mockUserToken,c=Zt.MOCK_USER;else{l=UC(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new te(K.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Zt(u)}t._authCredentials=new dD(new tS(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new cn(this.firestore,e,this._query)}}class Ot{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ot(this.firestore,e,this._key)}}class Fr extends cn{constructor(e,n,r){super(e,n,Ho(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ot(this.firestore,null,new de(e))}withConverter(e){return new Fr(this.firestore,e,this._path)}}function Q(t,e,...n){if(t=Ke(t),jv("collection","path",e),t instanceof uu){const r=He.fromString(e,...n);return Wx(r),new Fr(t,null,r)}{if(!(t instanceof Ot||t instanceof Fr))throw new te(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(He.fromString(e,...n));return Wx(r),new Fr(t.firestore,null,r)}}function CB(t,e){if(t=Ue(t,uu),jv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new te(K.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new cn(t,null,function(r){return new va(He.emptyPath(),r)}(e))}function we(t,e,...n){if(t=Ke(t),arguments.length===1&&(e=rS.newId()),jv("doc","path",e),t instanceof uu){const r=He.fromString(e,...n);return qx(r),new Ot(t,null,new de(r))}{if(!(t instanceof Ot||t instanceof Fr))throw new te(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(He.fromString(e,...n));return qx(r),new Ot(t.firestore,t instanceof Fr?t.converter:null,new de(r))}}function SB(t,e){return t=Ke(t),e=Ke(e),(t instanceof Ot||t instanceof Fr)&&(e instanceof Ot||e instanceof Fr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function X2(t,e){return t=Ke(t),e=Ke(e),t instanceof cn&&e instanceof cn&&t.firestore===e.firestore&&ru(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new xv(this,"async_queue_retry"),this.Vu=()=>{const r=Dd();r&&ee("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Dd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Dd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new en;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!bs(e))throw e;ee("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw Lt("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Cv.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&me()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function Lg(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class y3{constructor(){this._progressObserver={},this._taskCompletionResolver=new en,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kB=-1;class it extends uu{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Gx,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Gx(e),this._firestoreClient=void 0,await e}}}function IB(t,e,n){n||(n="(default)");const r=ga(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(is(i,e))return s;throw new te(K.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new te(K.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function E3(t,e){const n=typeof t=="object"?t:hp(),r=typeof t=="string"?t:e||"(default)",s=ga(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=jC("firestore");i&&b3(s,...i)}return s}function St(t){if(t._terminated)throw new te(K.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||ek(t),t._firestoreClient}function ek(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,d){return new qD(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Y2(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new s3(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function TB(t,e){or("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return tk(t,ps.provider,{build:r=>new Mv(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function AB(t){or("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=t._freezeSettings();tk(t,ps.provider,{build:n=>new W2(n,e.cacheSizeBytes)})}function tk(t,e,n){if((t=Ue(t,it))._firestoreClient||t._terminated)throw new te(K.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new te(K.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},ek(t)}function PB(t){if(t._initialized&&!t._terminated)throw new te(K.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new en;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Vr.D())return Promise.resolve();const s=r+"main";await Vr.delete(s)}(bv(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function RB(t){return function(n){const r=new en;return n.asyncQueue.enqueueAndForget(async()=>B6(await Vv(n),r)),r.promise}(St(t=Ue(t,it)))}function LB(t){return i3(St(t=Ue(t,it)))}function DB(t){return o3(St(t=Ue(t,it)))}function MB(t){return JL(t.app,"firestore",t._databaseId.database),t._delete()}function OB(t,e){const n=St(t=Ue(t,it)),r=new y3;return m3(n,t._databaseId,e,r),r}function VB(t,e){return p3(St(t=Ue(t,it)),e).then(n=>n?new cn(t,null,n.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class x3{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ui(Tt.fromBase64String(e))}catch(n){throw new te(K.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ui(Tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new te(K.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function jB(){return new wi("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new te(K.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new te(K.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ae(this._lat,e._lat)||Ae(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w3=/^__.*__$/;class _3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ya(e,this.data,this.fieldMask,n,this.fieldTransforms):new Go(e,this.data,n,this.fieldTransforms)}}class nk{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ya(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function rk(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw me()}}class Rp{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Rp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return km(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(rk(this.Cu)&&w3.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class N3{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||lu(e)}Qu(e,n,r,s=!1){return new Rp({Cu:e,methodName:n,qu:r,path:vt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ni(t){const e=t._freezeSettings(),n=lu(t._databaseId);return new N3(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Lp(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);Hv("Data must be an object, but it was:",o,r);const l=ik(r,o);let c,u;if(i.merge)c=new Ln(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const g=jc(e,f,n);if(!o.contains(g))throw new te(K.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);lk(d,g)||d.push(g)}c=new Ln(d),u=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=o.fieldTransforms;return new _3(new sn(l),c,u)}class du extends _i{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof du}}function ak(t,e,n){return new Rp({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class zv extends _i{_toFieldTransform(e){return new su(e.path,new To)}isEqual(e){return e instanceof zv}}class Uv extends _i{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=ak(this,e,!0),r=this.Ku.map(i=>Ci(i,n)),s=new si(r);return new su(e.path,s)}isEqual(e){return e instanceof Uv&&is(this.Ku,e.Ku)}}class $v extends _i{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=ak(this,e,!0),r=this.Ku.map(i=>Ci(i,n)),s=new ii(r);return new su(e.path,s)}isEqual(e){return e instanceof $v&&is(this.Ku,e.Ku)}}class Bv extends _i{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new Ao(e.serializer,jS(e.serializer,this.$u));return new su(e.path,n)}isEqual(e){return e instanceof Bv&&this.$u===e.$u}}function qv(t,e,n,r){const s=t.Qu(1,e,n);Hv("Data must be an object, but it was:",s,r);const i=[],o=sn.empty();ys(r,(c,u)=>{const d=Dp(e,c,n);u=Ke(u);const f=s.Nu(d);if(u instanceof du)i.push(d);else{const g=Ci(u,f);g!=null&&(i.push(d),o.set(d,g))}});const l=new Ln(i);return new nk(o,l,s.fieldTransforms)}function Wv(t,e,n,r,s,i){const o=t.Qu(1,e,n),l=[jc(e,r,n)],c=[s];if(i.length%2!=0)throw new te(K.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)l.push(jc(e,i[g])),c.push(i[g+1]);const u=[],d=sn.empty();for(let g=l.length-1;g>=0;--g)if(!lk(u,l[g])){const v=l[g];let x=c[g];x=Ke(x);const E=o.Nu(v);if(x instanceof du)u.push(v);else{const y=Ci(x,E);y!=null&&(u.push(v),d.set(v,y))}}const f=new Ln(u);return new nk(d,f,o.fieldTransforms)}function sk(t,e,n,r=!1){return Ci(n,t.Qu(r?4:3,e))}function Ci(t,e){if(ok(t=Ke(t)))return Hv("Unsupported field value:",e,t),ik(t,e);if(t instanceof _i)return function(r,s){if(!rk(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=Ci(l,s.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Ke(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return jS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Nt.fromDate(r);return{timestampValue:Po(s.serializer,i)}}if(r instanceof Nt){const i=new Nt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Po(s.serializer,i)}}if(r instanceof Fv)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ui)return{bytesValue:YS(s.serializer,r._byteString)};if(r instanceof Ot){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:dv(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Pp)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return sv(l.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Ap(r)}`)}(t,e)}function ik(t,e){const n={};return gS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ys(t,(r,s)=>{const i=Ci(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function ok(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Nt||t instanceof Fv||t instanceof ui||t instanceof Ot||t instanceof _i||t instanceof Pp)}function Hv(t,e,n){if(!ok(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Ap(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function jc(t,e,n){if((e=Ke(e))instanceof wi)return e._internalPath;if(typeof e=="string")return Dp(t,e);throw km("Field path arguments must be of type string or ",t,!1,void 0,n)}const C3=new RegExp("[~\\*/\\[\\]]");function Dp(t,e,n){if(e.search(C3)>=0)throw km(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new wi(...e.split("."))._internalPath}catch{throw km(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function km(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new te(K.INVALID_ARGUMENT,l+t+c)}function lk(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ot(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new S3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Mp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class S3 extends Fc{data(){return super.data()}}function Mp(t,e){return typeof e=="string"?Dp(t,e):e instanceof wi?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ck(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new te(K.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Gv{}class mu extends Gv{}function pe(t,e,...n){let r=[];e instanceof Gv&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof el).length,l=i.filter(c=>c instanceof pu).length;if(o>1||o>0&&l>0)throw new te(K.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class pu extends mu{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new pu(e,n,r)}_apply(e){const n=this._parse(e);return dk(e._query,n),new cn(e.firestore,e.converter,xg(e._query,n))}_parse(e){const n=Ni(e.firestore);return function(i,o,l,c,u,d,f){let g;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new te(K.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){Qx(f,d);const v=[];for(const x of f)v.push(Kx(c,i,x));g={arrayValue:{values:v}}}else g=Kx(c,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||Qx(f,d),g=sk(l,o,f,d==="in"||d==="not-in");return Ge.create(u,d,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function fe(t,e,n){const r=e,s=Mp("where",t);return pu._create(s,r,n)}class el extends Gv{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new el(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:tt.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)dk(o,c),o=xg(o,c)}(e._query,n),new cn(e.firestore,e.converter,xg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function FB(...t){return t.forEach(e=>mk("or",e)),el._create("or",t)}function zB(...t){return t.forEach(e=>mk("and",e)),el._create("and",t)}class Kv extends mu{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Kv(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new te(K.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new te(K.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Dc(i,o)}(e._query,this._field,this._direction);return new cn(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new va(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Et(t,e="asc"){const n=e,r=Mp("orderBy",t);return Kv._create(r,n)}class Op extends mu{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Op(e,n,r)}_apply(e){return new cn(e.firestore,e.converter,vm(e._query,this._limit,this._limitType))}}function jo(t){return Z2("limit",t),Op._create("limit",t,"F")}function UB(t){return Z2("limitToLast",t),Op._create("limitToLast",t,"L")}class Vp extends mu{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Vp(e,n,r)}_apply(e){const n=uk(e,this.type,this._docOrFields,this._inclusive);return new cn(e.firestore,e.converter,function(s,i){return new va(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function $B(...t){return Vp._create("startAt",t,!0)}function BB(...t){return Vp._create("startAfter",t,!1)}class jp extends mu{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new jp(e,n,r)}_apply(e){const n=uk(e,this.type,this._docOrFields,this._inclusive);return new cn(e.firestore,e.converter,function(s,i){return new va(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,n))}}function qB(...t){return jp._create("endBefore",t,!1)}function WB(...t){return jp._create("endAt",t,!0)}function uk(t,e,n,r){if(n[0]=Ke(n[0]),n[0]instanceof Fc)return function(i,o,l,c,u){if(!c)throw new te(K.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const d=[];for(const f of uo(i))if(f.field.isKeyField())d.push(ri(o,c.key));else{const g=c.data.field(f.field);if(vp(g))throw new te(K.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){const v=f.field.canonicalString();throw new te(K.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}d.push(g)}return new us(d,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=Ni(t.firestore);return function(o,l,c,u,d,f){const g=o.explicitOrderBy;if(d.length>g.length)throw new te(K.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const v=[];for(let x=0;x<d.length;x++){const E=d[x];if(g[x].field.isKeyField()){if(typeof E!="string")throw new te(K.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof E}`);if(!rv(o)&&E.indexOf("/")!==-1)throw new te(K.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${E}' contains a slash.`);const y=o.path.child(He.fromString(E));if(!de.isDocumentKey(y))throw new te(K.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${y}' is not because it contains an odd number of segments.`);const h=new de(y);v.push(ri(l,h))}else{const y=sk(c,u,E);v.push(y)}}return new us(v,f)}(t._query,t.firestore._databaseId,s,e,n,r)}}function Kx(t,e,n){if(typeof(n=Ke(n))=="string"){if(n==="")throw new te(K.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!rv(e)&&n.indexOf("/")!==-1)throw new te(K.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(He.fromString(n));if(!de.isDocumentKey(r))throw new te(K.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ri(t,new de(r))}if(n instanceof Ot)return ri(t,n._key);throw new te(K.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ap(n)}.`)}function Qx(t,e){if(!Array.isArray(t)||t.length===0)throw new te(K.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function dk(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new te(K.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new te(K.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function mk(t,e){if(!(e instanceof pu||e instanceof el))throw new te(K.INVALID_ARGUMENT,`Function ${t}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class pk{convertValue(e,n="none"){switch(ls(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ht(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ma(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw me()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ys(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>ht(o.doubleValue));return new Pp(i)}convertGeoPoint(e){return new Fv(ht(e.latitude),ht(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=bp(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Pc(e));default:return null}}convertTimestamp(e){const n=da(e);return new Nt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=He.fromString(e);ye(l2(r));const s=new ni(r.get(1),r.get(3)),i=new de(r.popFirst(5));return s.isEqual(n)||Lt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fp(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class k3 extends pk{constructor(e){super(),this.firestore=e}convertBytes(e){return new ui(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ot(this.firestore,null,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HB(t){return new Vc("sum",jc("sum",t))}function GB(t){return new Vc("avg",jc("average",t))}function I3(){return new Vc("count")}function KB(t,e){var n,r;return t instanceof Vc&&e instanceof Vc&&t.aggregateType===e.aggregateType&&((n=t._internalFieldPath)===null||n===void 0?void 0:n.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function QB(t,e){return X2(t.query,e.query)&&is(t.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fo extends Fc{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Md(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Mp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Md extends Fo{data(e={}){return super.data(e)}}class zo{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Bs(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Md(this._firestore,this._userDataWriter,r.key,r,new Bs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new te(K.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new Md(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Bs(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new Md(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Bs(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:T3(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function T3(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return me()}}function JB(t,e){return t instanceof Fo&&e instanceof Fo?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof zo&&e instanceof zo&&t._firestore===e._firestore&&X2(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function di(t){t=Ue(t,Ot);const e=Ue(t.firestore,it);return Q2(St(e),t._key).then(n=>Qv(e,t,n))}class xs extends pk{constructor(e){super(),this.firestore=e}convertBytes(e){return new ui(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ot(this.firestore,null,n)}}function YB(t){t=Ue(t,Ot);const e=Ue(t.firestore,it),n=St(e),r=new xs(e);return l3(n,t._key).then(s=>new Fo(e,r,t._key,s,new Bs(s!==null&&s.hasLocalMutations,!0),t.converter))}function ZB(t){t=Ue(t,Ot);const e=Ue(t.firestore,it);return Q2(St(e),t._key,{source:"server"}).then(n=>Qv(e,t,n))}function ue(t){t=Ue(t,cn);const e=Ue(t.firestore,it),n=St(e),r=new xs(e);return ck(t._query),J2(n,t._query).then(s=>new zo(e,r,t,s))}function XB(t){t=Ue(t,cn);const e=Ue(t.firestore,it),n=St(e),r=new xs(e);return c3(n,t._query).then(s=>new zo(e,r,t,s))}function e9(t){t=Ue(t,cn);const e=Ue(t.firestore,it),n=St(e),r=new xs(e);return J2(n,t._query,{source:"server"}).then(s=>new zo(e,r,t,s))}function Jx(t,e,n){t=Ue(t,Ot);const r=Ue(t.firestore,it),s=Fp(t.converter,e,n);return fu(r,[Lp(Ni(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,bt.none())])}function Me(t,e,n,...r){t=Ue(t,Ot);const s=Ue(t.firestore,it),i=Ni(s);let o;return o=typeof(e=Ke(e))=="string"||e instanceof wi?Wv(i,"updateDoc",t._key,e,n,r):qv(i,"updateDoc",t._key,e),fu(s,[o.toMutation(t._key,bt.exists(!0))])}function ws(t){return fu(Ue(t.firestore,it),[new Ko(t._key,bt.none())])}function ze(t,e){const n=Ue(t.firestore,it),r=we(t),s=Fp(t.converter,e);return fu(n,[Lp(Ni(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,bt.exists(!1))]).then(()=>r)}function Dt(t,...e){var n,r,s;t=Ke(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Lg(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Lg(e[o])){const f=e[o];e[o]=(n=f.next)===null||n===void 0?void 0:n.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let c,u,d;if(t instanceof Ot)u=Ue(t.firestore,it),d=Ho(t._key.path),c={next:f=>{e[o]&&e[o](Qv(u,t,f))},error:e[o+1],complete:e[o+2]};else{const f=Ue(t,cn);u=Ue(f.firestore,it),d=f._query;const g=new xs(u);c={next:v=>{e[o]&&e[o](new zo(u,g,f,v))},error:e[o+1],complete:e[o+2]},ck(t._query)}return function(g,v,x,E){const y=new Ip(E),h=new Tv(v,y,x);return g.asyncQueue.enqueueAndForget(async()=>Sv(await Vo(g),h)),()=>{y.Za(),g.asyncQueue.enqueueAndForget(async()=>kv(await Vo(g),h))}}(St(u),d,l,c)}function t9(t,e){return d3(St(t=Ue(t,it)),Lg(e)?e:{next:e})}function fu(t,e){return function(r,s){const i=new en;return r.asyncQueue.enqueueAndForget(async()=>F6(await Vv(r),s,i)),i.promise}(St(t),e)}function Qv(t,e,n){const r=n.docs.get(e._key),s=new xs(t);return new Fo(t,s,e._key,r,new Bs(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n9(t){return A3(t,{count:I3()})}function A3(t,e){const n=Ue(t.firestore,it),r=St(n),s=hS(e,(i,o)=>new WS(o,i.aggregateType,i._internalFieldPath));return u3(r,t._query,s).then(i=>function(l,c,u){const d=new xs(l);return new x3(c,d,u)}(n,t,i))}class P3{constructor(e){this.kind="memory",this._onlineComponentProvider=ps.provider,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=ms.provider}toJSON(){return{kind:this.kind}}}class R3{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=V3(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class L3{constructor(){this.kind="memoryEager",this._offlineComponentProvider=ms.provider}toJSON(){return{kind:this.kind}}}class D3{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new t3(e)}}toJSON(){return{kind:this.kind}}}function r9(){return new L3}function a9(t){return new D3(t==null?void 0:t.cacheSizeBytes)}function s9(t){return new P3(t)}function i9(t){return new R3(t)}class M3{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ps.provider,this._offlineComponentProvider={build:n=>new Mv(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class O3{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ps.provider,this._offlineComponentProvider={build:n=>new W2(n,e==null?void 0:e.cacheSizeBytes)}}}function V3(t){return new M3(t==null?void 0:t.forceOwnership)}function o9(){return new O3}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j3={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F3{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Ni(e)}set(e,n,r){this._verifyNotCommitted();const s=za(e,this._firestore),i=Fp(s.converter,n,r),o=Lp(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,bt.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=za(e,this._firestore);let o;return o=typeof(n=Ke(n))=="string"||n instanceof wi?Wv(this._dataReader,"WriteBatch.update",i._key,n,r,s):qv(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,bt.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=za(e,this._firestore);return this._mutations=this._mutations.concat(new Ko(n._key,bt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new te(K.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function za(t,e){if((t=Ke(t)).firestore!==e)throw new te(K.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3 extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=Ni(n)}get(n){const r=za(n,this._firestore),s=new k3(this._firestore);return this._transaction.lookup([r._key]).then(i=>{if(!i||i.length!==1)return me();const o=i[0];if(o.isFoundDocument())return new Fc(this._firestore,s,o.key,o,r.converter);if(o.isNoDocument())return new Fc(this._firestore,s,r._key,null,r.converter);throw me()})}set(n,r,s){const i=za(n,this._firestore),o=Fp(i.converter,r,s),l=Lp(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,s);return this._transaction.set(i._key,l),this}update(n,r,s,...i){const o=za(n,this._firestore);let l;return l=typeof(r=Ke(r))=="string"||r instanceof wi?Wv(this._dataReader,"Transaction.update",o._key,r,s,i):qv(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,l),this}delete(n){const r=za(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=za(e,this._firestore),r=new xs(this._firestore);return super.get(e).then(s=>new Fo(this._firestore,r,n._key,s._document,new Bs(!1,!1),n.converter))}}function c9(t,e,n){t=Ue(t,it);const r=Object.assign(Object.assign({},j3),n);return function(i){if(i.maxAttempts<1)throw new te(K.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,l){const c=new en;return i.asyncQueue.enqueueAndForget(async()=>{const u=await K2(i);new a3(i.asyncQueue,u,l,o,c).au()}),c.promise}(St(t),s=>e(new z3(t,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u9(){return new du("deleteField")}function qn(){return new zv("serverTimestamp")}function d9(...t){return new Uv("arrayUnion",t)}function m9(...t){return new $v("arrayRemove",t)}function p9(t){return new Bv("increment",t)}function f9(t){return new Pp(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fk(t){return St(t=Ue(t,it)),new F3(t,e=>fu(t,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h9(t,e){const n=St(t=Ue(t,it));if(!n._uninitializedComponentsProvider||n._uninitializedComponentsProvider._offline.kind==="memory")return or("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(i){const o=typeof i=="string"?function(u){try{return JSON.parse(u)}catch(d){throw new te(K.INVALID_ARGUMENT,"Failed to parse JSON: "+(d==null?void 0:d.message))}}(i):i,l=[];if(Array.isArray(o.indexes))for(const c of o.indexes){const u=Yx(c,"collectionGroup"),d=[];if(Array.isArray(c.fields))for(const f of c.fields){const g=Dp("setIndexConfiguration",Yx(f,"fieldPath"));f.arrayConfig==="CONTAINS"?d.push(new Qs(g,2)):f.order==="ASCENDING"?d.push(new Qs(g,0)):f.order==="DESCENDING"&&d.push(new Qs(g,1))}l.push(new Co(Co.UNKNOWN_ID,u,d,So.empty()))}return l}(e);return f3(n,r)}function Yx(t,e){if(typeof t[e]!="string")throw new te(K.INVALID_ARGUMENT,"Missing string value for: "+e);return t[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function g9(t){var e;t=Ue(t,it);const n=Zx.get(t);if(n)return n;if(((e=St(t)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const r=new U3(t);return Zx.set(t,r),r}function v9(t){hk(t,!0)}function b9(t){hk(t,!1)}function y9(t){g3(St(t._firestore)).then(e=>ee("deleting all persistent cache indexes succeeded")).catch(e=>or("deleting all persistent cache indexes failed",e))}function hk(t,e){h3(St(t._firestore),e).then(n=>ee(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(n=>or(`setting persistent cache index auto creation isEnabled=${e} failed`,n))}const Zx=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E9(t){var e;const n=(e=St(Ue(t.firestore,it))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return n===void 0?null:wp(n,bn(t._query))._t}function x9(t,e){var n;const r=hS(e,(i,o)=>new WS(o,i.aggregateType,i._internalFieldPath)),s=(n=St(Ue(t.firestore,it))._onlineComponents)===null||n===void 0?void 0:n.datastore.serializer;return s===void 0?null:a2(s,TS(t._query),r,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w9{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return Jv.instance.onExistenceFilterMismatch(e)}}class Jv{constructor(){this.Uu=new Map}static get instance(){return sd||(sd=new Jv,function(n){if(bm)throw new Error("a TestingHooksSpi instance is already set");bm=n}(sd)),sd}et(e){this.Uu.forEach(n=>n(e))}onExistenceFilterMismatch(e){const n=Symbol(),r=this.Uu;return r.set(n,e),()=>r.delete(n)}}let sd=null;(function(e,n=!0){(function(s){Wo=s})(xi),br(new ir("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new it(new mD(r.getProvider("auth-internal")),new hD(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new te(K.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ni(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),jn(zE,"4.7.3",e),jn(zE,"4.7.3","esm2017")})();function Yv(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Si(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(f){o(f)}}function c(d){try{u(r.throw(d))}catch(f){o(f)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})}function gk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const $3=gk,vk=new Ei("auth","Firebase",gk());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Im=new J0("@firebase/auth");function B3(t,...e){Im.logLevel<=We.WARN&&Im.warn(`Auth (${xi}): ${t}`,...e)}function Od(t,...e){Im.logLevel<=We.ERROR&&Im.error(`Auth (${xi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yr(t,...e){throw Zv(t,...e)}function zr(t,...e){return Zv(t,...e)}function bk(t,e,n){const r=Object.assign(Object.assign({},$3()),{[e]:n});return new Ei("auth","Firebase",r).create(e,{appName:t.name})}function ra(t){return bk(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Zv(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return vk.create(t,...e)}function Te(t,e,...n){if(!t)throw Zv(e,...n)}function Zr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Od(e),new Error(e)}function pa(t,e){t||Zr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function q3(){return Xx()==="http:"||Xx()==="https:"}function Xx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W3(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(q3()||qR()||"connection"in navigator)?navigator.onLine:!0}function H3(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e,n){this.shortDelay=e,this.longDelay=n,pa(n>e,"Short delay should be less than long delay!"),this.isMobile=UR()||WR()}get(){return W3()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xv(t,e){pa(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Zr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Zr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Zr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G3={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K3=new hu(3e4,6e4);function _s(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ns(t,e,n,r,s={}){return Ek(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=eu(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return BR()||(u.referrerPolicy="no-referrer"),yk.fetch()(xk(t,t.config.apiHost,n,l),u)})}async function Ek(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},G3),e);try{const s=new J3(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw id(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw id(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw id(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw id(t,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw bk(t,d,u);yr(t,d)}}catch(s){if(s instanceof xr)throw s;yr(t,"network-request-failed",{message:String(s)})}}async function gu(t,e,n,r,s={}){const i=await Ns(t,e,n,r,s);return"mfaPendingCredential"in i&&yr(t,"multi-factor-auth-required",{_serverResponse:i}),i}function xk(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Xv(t.config,s):`${t.config.apiScheme}://${s}`}function Q3(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class J3{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(zr(this.auth,"network-request-failed")),K3.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function id(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=zr(t,e,r);return s.customData._tokenResponse=n,s}function ew(t){return t!==void 0&&t.enterprise!==void 0}class Y3{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Q3(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function Z3(t,e){return Ns(t,"GET","/v2/recaptchaConfig",_s(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X3(t,e){return Ns(t,"POST","/v1/accounts:delete",e)}async function wk(t,e){return Ns(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function eM(t,e=!1){const n=Ke(t),r=await n.getIdToken(e),s=eb(r);Te(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:lc(Gf(s.auth_time)),issuedAtTime:lc(Gf(s.iat)),expirationTime:lc(Gf(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Gf(t){return Number(t)*1e3}function eb(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Od("JWT malformed, contained fewer than 3 sections"),null;try{const s=OC(n);return s?JSON.parse(s):(Od("Failed to decode base64 JWT payload"),null)}catch(s){return Od("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function tw(t){const e=eb(t);return Te(e,"internal-error"),Te(typeof e.exp<"u","internal-error"),Te(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zc(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof xr&&tM(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function tM({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=lc(this.lastLoginAt),this.creationTime=lc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tm(t){var e;const n=t.auth,r=await t.getIdToken(),s=await zc(t,wk(n,{idToken:r}));Te(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?_k(i.providerUserInfo):[],l=aM(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new Mg(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function rM(t){const e=Ke(t);await Tm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function aM(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function _k(t){return t.map(e=>{var{providerId:n}=e,r=Yv(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sM(t,e){const n=await Ek(t,{},async()=>{const r=eu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=xk(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",yk.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function iM(t,e){return Ns(t,"POST","/v2/accounts:revokeToken",_s(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Te(e.idToken,"internal-error"),Te(typeof e.idToken<"u","internal-error"),Te(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):tw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Te(e.length!==0,"internal-error");const n=tw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Te(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await sM(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new po;return r&&(Te(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(Te(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(Te(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new po,this.toJSON())}_performRefresh(){return Zr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pa(t,e){Te(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Xr{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Yv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new nM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Mg(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await zc(this,this.stsTokenManager.getToken(this.auth,e));return Te(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return eM(this,e)}reload(){return rM(this)}_assign(e){this!==e&&(Te(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Xr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Tm(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Pr(this.auth.app))return Promise.reject(ra(this.auth));const e=await this.getIdToken();return await zc(this,X3(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,c,u,d;const f=(r=n.displayName)!==null&&r!==void 0?r:void 0,g=(s=n.email)!==null&&s!==void 0?s:void 0,v=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,x=(o=n.photoURL)!==null&&o!==void 0?o:void 0,E=(l=n.tenantId)!==null&&l!==void 0?l:void 0,y=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,h=(u=n.createdAt)!==null&&u!==void 0?u:void 0,C=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:T,emailVerified:k,isAnonymous:_,providerData:S,stsTokenManager:N}=n;Te(T&&N,e,"internal-error");const b=po.fromJSON(this.name,N);Te(typeof T=="string",e,"internal-error"),Pa(f,e.name),Pa(g,e.name),Te(typeof k=="boolean",e,"internal-error"),Te(typeof _=="boolean",e,"internal-error"),Pa(v,e.name),Pa(x,e.name),Pa(E,e.name),Pa(y,e.name),Pa(h,e.name),Pa(C,e.name);const w=new Xr({uid:T,auth:e,email:g,emailVerified:k,displayName:f,isAnonymous:_,photoURL:x,phoneNumber:v,tenantId:E,stsTokenManager:b,createdAt:h,lastLoginAt:C});return S&&Array.isArray(S)&&(w.providerData=S.map(A=>Object.assign({},A))),y&&(w._redirectEventId=y),w}static async _fromIdTokenResponse(e,n,r=!1){const s=new po;s.updateFromServerResponse(n);const i=new Xr({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Tm(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Te(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?_k(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new po;l.updateFromIdToken(r);const c=new Xr({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Mg(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nw=new Map;function ea(t){pa(t instanceof Function,"Expected a class definition");let e=nw.get(t);return e?(pa(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,nw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Nk.type="NONE";const rw=Nk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vd(t,e,n){return`firebase:${t}:${e}:${n}`}class fo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Vd(this.userKey,s.apiKey,i),this.fullPersistenceKey=Vd("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Xr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new fo(ea(rw),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||ea(rw);const o=Vd(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(o);if(d){const f=Xr._fromJSON(e,d);u!==i&&(l=f),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new fo(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new fo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ik(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ck(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ak(e))return"Blackberry";if(Pk(e))return"Webos";if(Sk(e))return"Safari";if((e.includes("chrome/")||kk(e))&&!e.includes("edge/"))return"Chrome";if(Tk(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Ck(t=Wt()){return/firefox\//i.test(t)}function Sk(t=Wt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function kk(t=Wt()){return/crios\//i.test(t)}function Ik(t=Wt()){return/iemobile/i.test(t)}function Tk(t=Wt()){return/android/i.test(t)}function Ak(t=Wt()){return/blackberry/i.test(t)}function Pk(t=Wt()){return/webos/i.test(t)}function tb(t=Wt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function oM(t=Wt()){var e;return tb(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function lM(){return HR()&&document.documentMode===10}function Rk(t=Wt()){return tb(t)||Tk(t)||Pk(t)||Ak(t)||/windows phone/i.test(t)||Ik(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lk(t,e=[]){let n;switch(t){case"Browser":n=aw(Wt());break;case"Worker":n=`${aw(Wt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${xi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uM(t,e={}){return Ns(t,"GET","/v2/passwordPolicy",_s(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dM=6;class mM{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:dM,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pM{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sw(this),this.idTokenSubscription=new sw(this),this.beforeStateQueue=new cM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=vk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ea(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await fo.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await wk(this,{idToken:e}),r=await Xr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Pr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Te(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Tm(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=H3()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Pr(this.app))return Promise.reject(ra(this));const n=e?Ke(e):null;return n&&Te(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Te(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Pr(this.app)?Promise.reject(ra(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Pr(this.app)?Promise.reject(ra(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ea(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uM(this),n=new mM(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ei("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await iM(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ea(e)||this._popupRedirectResolver;Te(n,this,"argument-error"),this.redirectPersistenceManager=await fo.create(this,[ea(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Te(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Lk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&B3(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function ki(t){return Ke(t)}class sw{constructor(e){this.auth=e,this.observer=null,this.addObserver=ZR(n=>this.observer=n)}get next(){return Te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function fM(t){zp=t}function Dk(t){return zp.loadJS(t)}function hM(){return zp.recaptchaEnterpriseScript}function gM(){return zp.gapiScript}function vM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const bM="recaptcha-enterprise",yM="NO_RECAPTCHA";class EM{constructor(e){this.type=bM,this.auth=ki(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{Z3(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new Y3(c);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function s(i,o,l){const c=window.grecaptcha;ew(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(yM)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&ew(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=hM();c.length!==0&&(c+=l),Dk(c).then(()=>{s(l,i,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function iw(t,e,n,r=!1){const s=new EM(t);let i;try{i=await s.verify(n)}catch{i=await s.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Og(t,e,n,r){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await iw(t,e,n,n==="getOobCode");return r(t,i)}else return r(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await iw(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xM(t,e){const n=ga(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(is(i,e??{}))return s;yr(s,"already-initialized")}return n.initialize({options:e})}function wM(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ea);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function _M(t,e,n){const r=ki(t);Te(r._canInitEmulator,r,"emulator-config-failed"),Te(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=Mk(e),{host:o,port:l}=NM(e),c=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||CM()}function Mk(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function NM(t){const e=Mk(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:ow(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:ow(o)}}}function ow(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function CM(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Zr("not implemented")}_getIdTokenResponse(e){return Zr("not implemented")}_linkToIdToken(e,n){return Zr("not implemented")}_getReauthenticationResolver(e){return Zr("not implemented")}}async function SM(t,e){return Ns(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kM(t,e){return gu(t,"POST","/v1/accounts:signInWithPassword",_s(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IM(t,e){return gu(t,"POST","/v1/accounts:signInWithEmailLink",_s(t,e))}async function TM(t,e){return gu(t,"POST","/v1/accounts:signInWithEmailLink",_s(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc extends nb{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Uc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Uc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Og(e,n,"signInWithPassword",kM);case"emailLink":return IM(e,{email:this._email,oobCode:this._password});default:yr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Og(e,r,"signUpPassword",SM);case"emailLink":return TM(e,{idToken:n,email:this._email,oobCode:this._password});default:yr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ho(t,e){return gu(t,"POST","/v1/accounts:signInWithIdp",_s(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AM="http://localhost";class mi extends nb{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new mi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):yr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Yv(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new mi(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ho(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ho(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ho(e,n)}buildRequest(){const e={requestUri:AM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=eu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function RM(t){const e=$l(Bl(t)).link,n=e?$l(Bl(e)).deep_link_id:null,r=$l(Bl(t)).deep_link_id;return(r?$l(Bl(r)).link:null)||r||n||e||t}class rb{constructor(e){var n,r,s,i,o,l;const c=$l(Bl(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,f=PM((s=c.mode)!==null&&s!==void 0?s:null);Te(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=RM(e);try{return new rb(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(){this.providerId=tl.PROVIDER_ID}static credential(e,n){return Uc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=rb.parseLink(n);return Te(r,"argument-error"),Uc._fromEmailAndCode(e,r.code,r.tenantId)}}tl.PROVIDER_ID="password";tl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";tl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ok{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu extends Ok{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua extends vu{constructor(){super("facebook.com")}static credential(e){return mi._fromParams({providerId:Ua.PROVIDER_ID,signInMethod:Ua.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ua.credentialFromTaggedObject(e)}static credentialFromError(e){return Ua.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ua.credential(e.oauthAccessToken)}catch{return null}}}Ua.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ua.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a extends vu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return mi._fromParams({providerId:$a.PROVIDER_ID,signInMethod:$a.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return $a.credentialFromTaggedObject(e)}static credentialFromError(e){return $a.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return $a.credential(n,r)}catch{return null}}}$a.GOOGLE_SIGN_IN_METHOD="google.com";$a.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba extends vu{constructor(){super("github.com")}static credential(e){return mi._fromParams({providerId:Ba.PROVIDER_ID,signInMethod:Ba.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ba.credentialFromTaggedObject(e)}static credentialFromError(e){return Ba.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ba.credential(e.oauthAccessToken)}catch{return null}}}Ba.GITHUB_SIGN_IN_METHOD="github.com";Ba.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa extends vu{constructor(){super("twitter.com")}static credential(e,n){return mi._fromParams({providerId:qa.PROVIDER_ID,signInMethod:qa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return qa.credentialFromTaggedObject(e)}static credentialFromError(e){return qa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return qa.credential(n,r)}catch{return null}}}qa.TWITTER_SIGN_IN_METHOD="twitter.com";qa.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LM(t,e){return gu(t,"POST","/v1/accounts:signUp",_s(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Xr._fromIdTokenResponse(e,r,s),o=lw(r);return new pi({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=lw(r);return new pi({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function lw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am extends xr{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Am.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Am(e,n,r,s)}}function Vk(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Am._fromErrorAndOperation(t,i,e,r):i})}async function DM(t,e,n=!1){const r=await zc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return pi._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MM(t,e,n=!1){const{auth:r}=t;if(Pr(r.app))return Promise.reject(ra(r));const s="reauthenticate";try{const i=await zc(t,Vk(r,s,e,t),n);Te(i.idToken,r,"internal-error");const o=eb(i.idToken);Te(o,r,"internal-error");const{sub:l}=o;return Te(t.uid===l,r,"user-mismatch"),pi._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&yr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jk(t,e,n=!1){if(Pr(t.app))return Promise.reject(ra(t));const r="signIn",s=await Vk(t,r,e),i=await pi._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function OM(t,e){return jk(ki(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fk(t){const e=ki(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Pm(t,e,n){if(Pr(t.app))return Promise.reject(ra(t));const r=ki(t),o=await Og(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",LM).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Fk(t),c}),l=await pi._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function zk(t,e,n){return Pr(t.app)?Promise.reject(ra(t)):OM(Ke(t),tl.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Fk(t),r})}function VM(t,e,n,r){return Ke(t).onIdTokenChanged(e,n,r)}function jM(t,e,n){return Ke(t).beforeAuthStateChanged(e,n)}function ab(t,e,n,r){return Ke(t).onAuthStateChanged(e,n,r)}function FM(t){return Ke(t).signOut()}const Rm="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Rm,"1"),this.storage.removeItem(Rm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zM=1e3,UM=10;class $k extends Uk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Rk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);lM()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,UM):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},zM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}$k.type="LOCAL";const $M=$k;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk extends Uk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Bk.type="SESSION";const qk=Bk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BM(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Up(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await BM(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Up.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=sb("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const g=f;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(g.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ur(){return window}function WM(t){Ur().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wk(){return typeof Ur().WorkerGlobalScope<"u"&&typeof Ur().importScripts=="function"}async function HM(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function GM(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function KM(){return Wk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hk="firebaseLocalStorageDb",QM=1,Lm="firebaseLocalStorage",Gk="fbase_key";class bu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function $p(t,e){return t.transaction([Lm],e?"readwrite":"readonly").objectStore(Lm)}function JM(){const t=indexedDB.deleteDatabase(Hk);return new bu(t).toPromise()}function Vg(){const t=indexedDB.open(Hk,QM);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Lm,{keyPath:Gk})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Lm)?e(r):(r.close(),await JM(),e(await Vg()))})})}async function cw(t,e,n){const r=$p(t,!0).put({[Gk]:e,value:n});return new bu(r).toPromise()}async function YM(t,e){const n=$p(t,!1).get(e),r=await new bu(n).toPromise();return r===void 0?null:r.value}function uw(t,e){const n=$p(t,!0).delete(e);return new bu(n).toPromise()}const ZM=800,XM=3;class Kk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>XM)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Wk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Up._getInstance(KM()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await HM(),!this.activeServiceWorker)return;this.sender=new qM(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||GM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vg();return await cw(e,Rm,"1"),await uw(e,Rm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>cw(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>YM(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>uw(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=$p(s,!1).getAll();return new bu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ZM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Kk.type="LOCAL";const eO=Kk;new hu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tO(t,e){return e?ea(e):(Te(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib extends nb{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ho(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ho(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ho(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function nO(t){return jk(t.auth,new ib(t),t.bypassAuthState)}function rO(t){const{auth:e,user:n}=t;return Te(n,e,"internal-error"),MM(n,new ib(t),t.bypassAuthState)}async function aO(t){const{auth:e,user:n}=t;return Te(n,e,"internal-error"),DM(n,new ib(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return nO;case"linkViaPopup":case"linkViaRedirect":return aO;case"reauthViaPopup":case"reauthViaRedirect":return rO;default:yr(this.auth,"internal-error")}}resolve(e){pa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){pa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sO=new hu(2e3,1e4);class no extends Qk{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,no.currentPopupAction&&no.currentPopupAction.cancel(),no.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Te(e,this.auth,"internal-error"),e}async onExecution(){pa(this.filter.length===1,"Popup operations only handle one event");const e=sb();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(zr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(zr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,no.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(zr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,sO.get())};e()}}no.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iO="pendingRedirect",jd=new Map;class oO extends Qk{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=jd.get(this.auth._key());if(!e){try{const r=await lO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}jd.set(this.auth._key(),e)}return this.bypassAuthState||jd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function lO(t,e){const n=dO(e),r=uO(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function cO(t,e){jd.set(t._key(),e)}function uO(t){return ea(t._redirectPersistence)}function dO(t){return Vd(iO,t.config.apiKey,t.name)}async function mO(t,e,n=!1){if(Pr(t.app))return Promise.reject(ra(t));const r=ki(t),s=tO(r,e),o=await new oO(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pO=10*60*1e3;class fO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!hO(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Jk(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(zr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=pO&&this.cachedEventUids.clear(),this.cachedEventUids.has(dw(e))}saveEventToCache(e){this.cachedEventUids.add(dw(e)),this.lastProcessedEventTime=Date.now()}}function dw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Jk({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function hO(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Jk(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gO(t,e={}){return Ns(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,bO=/^https?/;async function yO(t){if(t.config.emulator)return;const{authorizedDomains:e}=await gO(t);for(const n of e)try{if(EO(n))return}catch{}yr(t,"unauthorized-domain")}function EO(t){const e=Dg(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!bO.test(n))return!1;if(vO.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xO=new hu(3e4,6e4);function mw(){const t=Ur().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function wO(t){return new Promise((e,n)=>{var r,s,i;function o(){mw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{mw(),n(zr(t,"network-request-failed"))},timeout:xO.get()})}if(!((s=(r=Ur().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Ur().gapi)===null||i===void 0)&&i.load)o();else{const l=vM("iframefcb");return Ur()[l]=()=>{gapi.load?o():n(zr(t,"network-request-failed"))},Dk(`${gM()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw Fd=null,e})}let Fd=null;function _O(t){return Fd=Fd||wO(t),Fd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NO=new hu(5e3,15e3),CO="__/auth/iframe",SO="emulator/auth/iframe",kO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},IO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function TO(t){const e=t.config;Te(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Xv(e,SO):`https://${t.config.authDomain}/${CO}`,r={apiKey:e.apiKey,appName:t.name,v:xi},s=IO.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${eu(r).slice(1)}`}async function AO(t){const e=await _O(t),n=Ur().gapi;return Te(n,t,"internal-error"),e.open({where:document.body,url:TO(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:kO,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=zr(t,"network-request-failed"),l=Ur().setTimeout(()=>{i(o)},NO.get());function c(){Ur().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},RO=500,LO=600,DO="_blank",MO="http://localhost";class pw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function OO(t,e,n,r=RO,s=LO){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},PO),{width:r.toString(),height:s.toString(),top:i,left:o}),u=Wt().toLowerCase();n&&(l=kk(u)?DO:n),Ck(u)&&(e=e||MO,c.scrollbars="yes");const d=Object.entries(c).reduce((g,[v,x])=>`${g}${v}=${x},`,"");if(oM(u)&&l!=="_self")return VO(e||"",l),new pw(null);const f=window.open(e||"",l,d);Te(f,t,"popup-blocked");try{f.focus()}catch{}return new pw(f)}function VO(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jO="__/auth/handler",FO="emulator/auth/handler",zO=encodeURIComponent("fac");async function fw(t,e,n,r,s,i){Te(t.config.authDomain,t,"auth-domain-config-required"),Te(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:xi,eventId:s};if(e instanceof Ok){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",YR(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries(i||{}))o[d]=f}if(e instanceof vu){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${zO}=${encodeURIComponent(c)}`:"";return`${UO(t)}?${eu(l).slice(1)}${u}`}function UO({config:t}){return t.emulator?Xv(t,FO):`https://${t.authDomain}/${jO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kf="webStorageSupport";class $O{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qk,this._completeRedirectFn=mO,this._overrideRedirectResult=cO}async _openPopup(e,n,r,s){var i;pa((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await fw(e,n,r,Dg(),s);return OO(e,o,sb())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await fw(e,n,r,Dg(),s);return WM(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(pa(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await AO(e),r=new fO(e);return n.register("authEvent",s=>(Te(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Kf,{type:Kf},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Kf];o!==void 0&&n(!!o),yr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=yO(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Rk()||Sk()||tb()}}const BO=$O;var hw="@firebase/auth",gw="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WO(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function HO(t){br(new ir("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;Te(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Lk(t)},u=new pM(r,s,i,c);return wM(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),br(new ir("auth-internal",e=>{const n=ki(e.getProvider("auth").getImmediate());return(r=>new qO(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),jn(hw,gw,WO(t)),jn(hw,gw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GO=5*60,KO=zC("authIdTokenMaxAge")||GO;let vw=null;const QO=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>KO)return;const s=n==null?void 0:n.token;vw!==s&&(vw=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function JO(t=hp()){const e=ga(t,"auth");if(e.isInitialized())return e.getImmediate();const n=xM(t,{popupRedirectResolver:BO,persistence:[eO,$M,qk]}),r=zC("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=QO(i.toString());jM(n,o,()=>o(n.currentUser)),VM(n,l=>o(l))}}const s=VC("auth");return s&&_M(n,`http://${s}`),n}function YO(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}fM({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=zr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",YO().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});HO("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yk="firebasestorage.googleapis.com",Zk="storageBucket",ZO=2*60*1e3,XO=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt extends xr{constructor(e,n,r=0){super(Qf(e),`Firebase Storage: ${n} (${Qf(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Pt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Qf(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var At;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(At||(At={}));function Qf(t){return"storage/"+t}function ob(){const t="An unknown error occurred, please check the error payload for server response.";return new Pt(At.UNKNOWN,t)}function e5(t){return new Pt(At.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function t5(t){return new Pt(At.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function n5(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Pt(At.UNAUTHENTICATED,t)}function r5(){return new Pt(At.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function a5(t){return new Pt(At.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function s5(){return new Pt(At.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function i5(){return new Pt(At.CANCELED,"User canceled the upload/download.")}function o5(t){return new Pt(At.INVALID_URL,"Invalid URL '"+t+"'.")}function l5(t){return new Pt(At.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function c5(){return new Pt(At.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Zk+"' property when initializing the app?")}function u5(){return new Pt(At.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function d5(){return new Pt(At.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function m5(t){return new Pt(At.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function jg(t){return new Pt(At.INVALID_ARGUMENT,t)}function Xk(){return new Pt(At.APP_DELETED,"The Firebase app was deleted.")}function p5(t){return new Pt(At.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function cc(t,e){return new Pt(At.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Ll(t){throw new Pt(At.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Hn.makeFromUrl(e,n)}catch{return new Hn(e,"")}if(r.path==="")return r;throw l5(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(k){k.path.charAt(k.path.length-1)==="/"&&(k.path_=k.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function u(k){k.path_=decodeURIComponent(k.path)}const d="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",v=new RegExp(`^https?://${f}/${d}/b/${s}/o${g}`,"i"),x={bucket:1,path:3},E=n===Yk?"(?:storage.googleapis.com|storage.cloud.google.com)":n,y="([^?#]*)",h=new RegExp(`^https?://${E}/${s}/${y}`,"i"),T=[{regex:l,indices:c,postModify:i},{regex:v,indices:x,postModify:u},{regex:h,indices:{bucket:1,path:2},postModify:u}];for(let k=0;k<T.length;k++){const _=T[k],S=_.regex.exec(e);if(S){const N=S[_.indices.bucket];let b=S[_.indices.path];b||(b=""),r=new Hn(N,b),_.postModify(r);break}}if(r==null)throw o5(e);return r}}class f5{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h5(t,e,n){let r=1,s=null,i=null,o=!1,l=0;function c(){return l===2}let u=!1;function d(...y){u||(u=!0,e.apply(null,y))}function f(y){s=setTimeout(()=>{s=null,t(v,c())},y)}function g(){i&&clearTimeout(i)}function v(y,...h){if(u){g();return}if(y){g(),d.call(null,y,...h);return}if(c()||o){g(),d.call(null,y,...h);return}r<64&&(r*=2);let T;l===1?(l=2,T=0):T=(r+Math.random())*1e3,f(T)}let x=!1;function E(y){x||(x=!0,g(),!u&&(s!==null?(y||(l=2),clearTimeout(s),f(0)):y||(l=1)))}return f(0),i=setTimeout(()=>{o=!0,E(!0)},n),E}function g5(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v5(t){return t!==void 0}function b5(t){return typeof t=="object"&&!Array.isArray(t)}function lb(t){return typeof t=="string"||t instanceof String}function bw(t){return cb()&&t instanceof Blob}function cb(){return typeof Blob<"u"}function yw(t,e,n,r){if(r<e)throw jg(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw jg(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bp(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function eI(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Js;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Js||(Js={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y5(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5{constructor(e,n,r,s,i,o,l,c,u,d,f,g=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=f,this.retry=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,x)=>{this.resolve_=v,this.reject_=x,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new od(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===Js.NO_ERROR,c=i.getStatus();if(!l||y5(c,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===Js.ABORT;r(!1,new od(!1,null,d));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new od(u,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());v5(c)?i(c):i()}catch(c){o(c)}else if(l!==null){const c=ob();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(s.canceled){const c=this.appDelete_?Xk():i5();o(c)}else{const c=s5();o(c)}};this.canceled_?n(!1,new od(!1,null,!0)):this.backoffId_=h5(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&g5(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class od{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function x5(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function w5(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function _5(t,e){e&&(t["X-Firebase-GMPID"]=e)}function N5(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function C5(t,e,n,r,s,i,o=!0){const l=eI(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return _5(u,e),x5(u,n),w5(u,i),N5(u,r),new E5(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S5(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function k5(...t){const e=S5();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(cb())return new Blob(t);throw new Pt(At.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function I5(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T5(t){if(typeof atob>"u")throw m5("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Jf{constructor(e,n){this.data=e,this.contentType=n||null}}function A5(t,e){switch(t){case Dr.RAW:return new Jf(tI(e));case Dr.BASE64:case Dr.BASE64URL:return new Jf(nI(t,e));case Dr.DATA_URL:return new Jf(R5(e),L5(e))}throw ob()}function tI(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function P5(t){let e;try{e=decodeURIComponent(t)}catch{throw cc(Dr.DATA_URL,"Malformed data URL.")}return tI(e)}function nI(t,e){switch(t){case Dr.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw cc(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Dr.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw cc(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=T5(e)}catch(s){throw s.message.includes("polyfill")?s:cc(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class rI{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw cc(Dr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=D5(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function R5(t){const e=new rI(t);return e.base64?nI(Dr.BASE64,e.rest):P5(e.rest)}function L5(t){return new rI(t).contentType}function D5(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e,n){let r=0,s="";bw(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(bw(this.data_)){const r=this.data_,s=I5(r,e,n);return s===null?null:new Wa(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Wa(r,!0)}}static getBlob(...e){if(cb()){const n=e.map(r=>r instanceof Wa?r.data_:r);return new Wa(k5.apply(null,n))}else{const n=e.map(o=>lb(o)?A5(Dr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)s[i++]=o[l]}),new Wa(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aI(t){let e;try{e=JSON.parse(t)}catch{return null}return b5(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M5(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function O5(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function sI(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V5(t,e){return e}class wn{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||V5}}let ld=null;function j5(t){return!lb(t)||t.length<2?t:sI(t)}function iI(){if(ld)return ld;const t=[];t.push(new wn("bucket")),t.push(new wn("generation")),t.push(new wn("metageneration")),t.push(new wn("name","fullPath",!0));function e(i,o){return j5(o)}const n=new wn("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new wn("size");return s.xform=r,t.push(s),t.push(new wn("timeCreated")),t.push(new wn("updated")),t.push(new wn("md5Hash",null,!0)),t.push(new wn("cacheControl",null,!0)),t.push(new wn("contentDisposition",null,!0)),t.push(new wn("contentEncoding",null,!0)),t.push(new wn("contentLanguage",null,!0)),t.push(new wn("contentType",null,!0)),t.push(new wn("metadata","customMetadata",!0)),ld=t,ld}function F5(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new Hn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function z5(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return F5(r,t),r}function oI(t,e,n){const r=aI(e);return r===null?null:z5(t,r,n)}function U5(t,e,n,r){const s=aI(e);if(s===null||!lb(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,f=t.fullPath,g="/b/"+o(d)+"/o/"+o(f),v=Bp(g,n,r),x=eI({alt:"media",token:u});return v+x})[0]}function $5(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class ub{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lI(t){if(!t)throw ob()}function B5(t,e){function n(r,s){const i=oI(t,s,e);return lI(i!==null),i}return n}function q5(t,e){function n(r,s){const i=oI(t,s,e);return lI(i!==null),U5(i,s,t.host,t._protocol)}return n}function cI(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=r5():s=n5():n.getStatus()===402?s=t5(t.bucket):n.getStatus()===403?s=a5(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function uI(t){const e=cI(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=e5(t.path)),i.serverResponse=s.serverResponse,i}return n}function W5(t,e,n){const r=e.fullServerUrl(),s=Bp(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new ub(s,i,q5(t,n),o);return l.errorHandler=uI(e),l}function H5(t,e){const n=e.fullServerUrl(),r=Bp(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(c,u){}const l=new ub(r,s,o,i);return l.successCodes=[200,204],l.errorHandler=uI(e),l}function G5(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function K5(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=G5(null,e)),r}function Q5(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let T="";for(let k=0;k<2;k++)T=T+Math.random().toString().slice(2);return T}const c=l();o["Content-Type"]="multipart/related; boundary="+c;const u=K5(e,r,s),d=$5(u,n),f="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,g=`\r
--`+c+"--",v=Wa.getBlob(f,r,g);if(v===null)throw u5();const x={name:u.fullPath},E=Bp(i,t.host,t._protocol),y="POST",h=t.maxUploadRetryTime,C=new ub(E,y,B5(t,n),h);return C.urlParams=x,C.headers=o,C.body=v.uploadData(),C.errorHandler=cI(e),C}class J5{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Js.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Js.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Js.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw Ll("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ll("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ll("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Ll("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ll("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Y5 extends J5{initXhr(){this.xhr_.responseType="text"}}function db(){return new Y5}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e,n){this._service=e,n instanceof Hn?this._location=n:this._location=Hn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new fi(e,n)}get root(){const e=new Hn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return sI(this._location.path)}get storage(){return this._service}get parent(){const e=M5(this._location.path);if(e===null)return null;const n=new Hn(this._location.bucket,e);return new fi(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw p5(e)}}function Z5(t,e,n){t._throwIfRoot("uploadBytes");const r=Q5(t.storage,t._location,iI(),new Wa(e,!0),n);return t.storage.makeRequestWithTokens(r,db).then(s=>({metadata:s,ref:t}))}function X5(t){t._throwIfRoot("getDownloadURL");const e=W5(t.storage,t._location,iI());return t.storage.makeRequestWithTokens(e,db).then(n=>{if(n===null)throw d5();return n})}function eV(t){t._throwIfRoot("deleteObject");const e=H5(t.storage,t._location);return t.storage.makeRequestWithTokens(e,db)}function tV(t,e){const n=O5(t._location.path,e),r=new Hn(t._location.bucket,n);return new fi(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nV(t){return/^[A-Za-z]+:\/\//.test(t)}function rV(t,e){return new fi(t,e)}function dI(t,e){if(t instanceof mb){const n=t;if(n._bucket==null)throw c5();const r=new fi(n,n._bucket);return e!=null?dI(r,e):r}else return e!==void 0?tV(t,e):t}function aV(t,e){if(e&&nV(e)){if(t instanceof mb)return rV(t,e);throw jg("To use ref(service, url), the first argument must be a Storage instance.")}else return dI(t,e)}function Ew(t,e){const n=e==null?void 0:e[Zk];return n==null?null:Hn.makeFromBucketSpec(n,t)}function sV(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:UC(s,t.app.options.projectId))}class mb{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=Yk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=ZO,this._maxUploadRetryTime=XO,this._requests=new Set,s!=null?this._bucket=Hn.makeFromBucketSpec(s,this._host):this._bucket=Ew(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Hn.makeFromBucketSpec(this._url,e):this._bucket=Ew(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){yw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){yw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new fi(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new f5(Xk());{const o=C5(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const xw="@firebase/storage",ww="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mI="storage";function Dm(t,e,n){return t=Ke(t),Z5(t,e,n)}function Mm(t){return t=Ke(t),X5(t)}function iV(t){return t=Ke(t),eV(t)}function $c(t,e){return t=Ke(t),aV(t,e)}function oV(t=hp(),e){t=Ke(t);const r=ga(t,mI).getImmediate({identifier:e}),s=jC("storage");return s&&lV(r,...s),r}function lV(t,e,n,r={}){sV(t,e,n,r)}function cV(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new mb(n,r,s,e,xi)}function uV(){br(new ir(mI,cV,"PUBLIC").setMultipleInstances(!0)),jn(xw,ww,""),jn(xw,ww,"esm2017")}uV();const pI="@firebase/installations",pb="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI=1e4,hI=`w:${pb}`,gI="FIS_v2",dV="https://firebaseinstallations.googleapis.com/v1",mV=60*60*1e3,pV="installations",fV="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hV={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},hi=new Ei(pV,fV,hV);function vI(t){return t instanceof xr&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bI({projectId:t}){return`${dV}/projects/${t}/installations`}function yI(t){return{token:t.token,requestStatus:2,expiresIn:vV(t.expiresIn),creationTime:Date.now()}}async function EI(t,e){const r=(await e.json()).error;return hi.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function xI({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function gV(t,{refreshToken:e}){const n=xI(t);return n.append("Authorization",bV(e)),n}async function wI(t){const e=await t();return e.status>=500&&e.status<600?t():e}function vV(t){return Number(t.replace("s","000"))}function bV(t){return`${gI} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yV({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=bI(t),s=xI(t),i=e.getImmediate({optional:!0});if(i){const u=await i.getHeartbeatsHeader();u&&s.append("x-firebase-client",u)}const o={fid:n,authVersion:gI,appId:t.appId,sdkVersion:hI},l={method:"POST",headers:s,body:JSON.stringify(o)},c=await wI(()=>fetch(r,l));if(c.ok){const u=await c.json();return{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:yI(u.authToken)}}else throw await EI("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _I(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EV(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xV=/^[cdef][\w-]{21}$/,Fg="";function wV(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=_V(t);return xV.test(n)?n:Fg}catch{return Fg}}function _V(t){return EV(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qp(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI=new Map;function CI(t,e){const n=qp(t);SI(n,e),NV(n,e)}function SI(t,e){const n=NI.get(t);if(n)for(const r of n)r(e)}function NV(t,e){const n=CV();n&&n.postMessage({key:t,fid:e}),SV()}let qs=null;function CV(){return!qs&&"BroadcastChannel"in self&&(qs=new BroadcastChannel("[Firebase] FID Change"),qs.onmessage=t=>{SI(t.data.key,t.data.fid)}),qs}function SV(){NI.size===0&&qs&&(qs.close(),qs=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kV="firebase-installations-database",IV=1,gi="firebase-installations-store";let Yf=null;function fb(){return Yf||(Yf=fp(kV,IV,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(gi)}}})),Yf}async function Om(t,e){const n=qp(t),s=(await fb()).transaction(gi,"readwrite"),i=s.objectStore(gi),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&CI(t,e.fid),e}async function kI(t){const e=qp(t),r=(await fb()).transaction(gi,"readwrite");await r.objectStore(gi).delete(e),await r.done}async function Wp(t,e){const n=qp(t),s=(await fb()).transaction(gi,"readwrite"),i=s.objectStore(gi),o=await i.get(n),l=e(o);return l===void 0?await i.delete(n):await i.put(l,n),await s.done,l&&(!o||o.fid!==l.fid)&&CI(t,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hb(t){let e;const n=await Wp(t.appConfig,r=>{const s=TV(r),i=AV(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===Fg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function TV(t){const e=t||{fid:wV(),registrationStatus:0};return II(e)}function AV(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(hi.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=PV(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:RV(t)}:{installationEntry:e}}async function PV(t,e){try{const n=await yV(t,e);return Om(t.appConfig,n)}catch(n){throw vI(n)&&n.customData.serverCode===409?await kI(t.appConfig):await Om(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function RV(t){let e=await _w(t.appConfig);for(;e.registrationStatus===1;)await _I(100),e=await _w(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await hb(t);return r||n}return e}function _w(t){return Wp(t,e=>{if(!e)throw hi.create("installation-not-found");return II(e)})}function II(t){return LV(t)?{fid:t.fid,registrationStatus:0}:t}function LV(t){return t.registrationStatus===1&&t.registrationTime+fI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DV({appConfig:t,heartbeatServiceProvider:e},n){const r=MV(t,n),s=gV(t,n),i=e.getImmediate({optional:!0});if(i){const u=await i.getHeartbeatsHeader();u&&s.append("x-firebase-client",u)}const o={installation:{sdkVersion:hI,appId:t.appId}},l={method:"POST",headers:s,body:JSON.stringify(o)},c=await wI(()=>fetch(r,l));if(c.ok){const u=await c.json();return yI(u)}else throw await EI("Generate Auth Token",c)}function MV(t,{fid:e}){return`${bI(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gb(t,e=!1){let n;const r=await Wp(t.appConfig,i=>{if(!TI(i))throw hi.create("not-registered");const o=i.authToken;if(!e&&jV(o))return i;if(o.requestStatus===1)return n=OV(t,e),i;{if(!navigator.onLine)throw hi.create("app-offline");const l=zV(i);return n=VV(t,l),l}});return n?await n:r.authToken}async function OV(t,e){let n=await Nw(t.appConfig);for(;n.authToken.requestStatus===1;)await _I(100),n=await Nw(t.appConfig);const r=n.authToken;return r.requestStatus===0?gb(t,e):r}function Nw(t){return Wp(t,e=>{if(!TI(e))throw hi.create("not-registered");const n=e.authToken;return UV(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function VV(t,e){try{const n=await DV(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await Om(t.appConfig,r),n}catch(n){if(vI(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await kI(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Om(t.appConfig,r)}throw n}}function TI(t){return t!==void 0&&t.registrationStatus===2}function jV(t){return t.requestStatus===2&&!FV(t)}function FV(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+mV}function zV(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function UV(t){return t.requestStatus===1&&t.requestTime+fI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $V(t){const e=t,{installationEntry:n,registrationPromise:r}=await hb(e);return r?r.catch(console.error):gb(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BV(t,e=!1){const n=t;return await qV(n),(await gb(n,e)).token}async function qV(t){const{registrationPromise:e}=await hb(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WV(t){if(!t||!t.options)throw Zf("App Configuration");if(!t.name)throw Zf("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Zf(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Zf(t){return hi.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI="installations",HV="installations-internal",GV=t=>{const e=t.getProvider("app").getImmediate(),n=WV(e),r=ga(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},KV=t=>{const e=t.getProvider("app").getImmediate(),n=ga(e,AI).getImmediate();return{getId:()=>$V(n),getToken:s=>BV(n,s)}};function QV(){br(new ir(AI,GV,"PUBLIC")),br(new ir(HV,KV,"PRIVATE"))}QV();jn(pI,pb);jn(pI,pb,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JV="/firebase-messaging-sw.js",YV="/firebase-cloud-messaging-push-scope",PI="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",ZV="https://fcmregistrations.googleapis.com/v1",RI="google.c.a.c_id",XV="google.c.a.c_l",ej="google.c.a.ts",tj="google.c.a.e";var Cw;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(Cw||(Cw={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Bc;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(Bc||(Bc={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gr(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function nj(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xf="fcm_token_details_db",rj=5,Sw="fcm_token_object_Store";async function aj(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(Xf))return null;let e=null;return(await fp(Xf,rj,{upgrade:async(r,s,i,o)=>{var l;if(s<2||!r.objectStoreNames.contains(Sw))return;const c=o.objectStore(Sw),u=await c.index("fcmSenderId").get(t);if(await c.clear(),!!u){if(s===2){const d=u;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:(l=d.createTime)!==null&&l!==void 0?l:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Gr(d.vapidKey)}}}else if(s===3){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Gr(d.auth),p256dh:Gr(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Gr(d.vapidKey)}}}else if(s===4){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Gr(d.auth),p256dh:Gr(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Gr(d.vapidKey)}}}}}})).close(),await jf(Xf),await jf("fcm_vapid_details_db"),await jf("undefined"),sj(e)?e:null}function sj(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ij="firebase-messaging-database",oj=1,qc="firebase-messaging-store";let eh=null;function LI(){return eh||(eh=fp(ij,oj,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(qc)}}})),eh}async function lj(t){const e=DI(t),r=await(await LI()).transaction(qc).objectStore(qc).get(e);if(r)return r;{const s=await aj(t.appConfig.senderId);if(s)return await vb(t,s),s}}async function vb(t,e){const n=DI(t),s=(await LI()).transaction(qc,"readwrite");return await s.objectStore(qc).put(e,n),await s.done,e}function DI({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cj={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},yn=new Ei("messaging","Messaging",cj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uj(t,e){const n=await yb(t),r=MI(e),s={method:"POST",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(bb(t.appConfig),s)).json()}catch(o){throw yn.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw yn.create("token-subscribe-failed",{errorInfo:o})}if(!i.token)throw yn.create("token-subscribe-no-token");return i.token}async function dj(t,e){const n=await yb(t),r=MI(e.subscriptionOptions),s={method:"PATCH",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(`${bb(t.appConfig)}/${e.token}`,s)).json()}catch(o){throw yn.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw yn.create("token-update-failed",{errorInfo:o})}if(!i.token)throw yn.create("token-update-no-token");return i.token}async function mj(t,e){const r={method:"DELETE",headers:await yb(t)};try{const i=await(await fetch(`${bb(t.appConfig)}/${e}`,r)).json();if(i.error){const o=i.error.message;throw yn.create("token-unsubscribe-failed",{errorInfo:o})}}catch(s){throw yn.create("token-unsubscribe-failed",{errorInfo:s==null?void 0:s.toString()})}}function bb({projectId:t}){return`${ZV}/projects/${t}/registrations`}async function yb({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function MI({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:e,p256dh:t}};return r!==PI&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pj=7*24*60*60*1e3;async function fj(t){const e=await gj(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Gr(e.getKey("auth")),p256dh:Gr(e.getKey("p256dh"))},r=await lj(t.firebaseDependencies);if(r){if(vj(r.subscriptionOptions,n))return Date.now()>=r.createTime+pj?hj(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await mj(t.firebaseDependencies,r.token)}catch(s){console.warn(s)}return kw(t.firebaseDependencies,n)}else return kw(t.firebaseDependencies,n)}async function hj(t,e){try{const n=await dj(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await vb(t.firebaseDependencies,r),n}catch(n){throw n}}async function kw(t,e){const r={token:await uj(t,e),createTime:Date.now(),subscriptionOptions:e};return await vb(t,r),r.token}async function gj(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:nj(e)})}function vj(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,s=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iw(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return bj(e,t),yj(e,t),Ej(e,t),e}function bj(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const s=e.notification.image;s&&(t.notification.image=s);const i=e.notification.icon;i&&(t.notification.icon=i)}function yj(t,e){e.data&&(t.data=e.data)}function Ej(t,e){var n,r,s,i,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const l=(s=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&s!==void 0?s:(i=e.notification)===null||i===void 0?void 0:i.click_action;l&&(t.fcmOptions.link=l);const c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xj(t){return typeof t=="object"&&!!t&&RI in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wj("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function wj(t,e){const n=[];for(let r=0;r<t.length;r++)n.push(t.charAt(r)),r<e.length&&n.push(e.charAt(r));return n.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _j(t){if(!t||!t.options)throw th("App Configuration Object");if(!t.name)throw th("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw th(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function th(t){return yn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nj{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=_j(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cj(t){try{t.swRegistration=await navigator.serviceWorker.register(JV,{scope:YV}),t.swRegistration.update().catch(()=>{})}catch(e){throw yn.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sj(t,e){if(!e&&!t.swRegistration&&await Cj(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw yn.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kj(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=PI)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OI(t,e){if(!navigator)throw yn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw yn.create("permission-blocked");return await kj(t,e==null?void 0:e.vapidKey),await Sj(t,e==null?void 0:e.serviceWorkerRegistration),fj(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ij(t,e,n){const r=Tj(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[RI],message_name:n[XV],message_time:n[ej],message_device_time:Math.floor(Date.now()/1e3)})}function Tj(t){switch(t){case Bc.NOTIFICATION_CLICKED:return"notification_open";case Bc.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Aj(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===Bc.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(Iw(n)):t.onMessageHandler.next(Iw(n)));const r=n.data;xj(r)&&r[tj]==="1"&&await Ij(t,n.messageType,r)}const Tw="@firebase/messaging",Aw="0.12.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pj=t=>{const e=new Nj(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>Aj(e,n)),e},Rj=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>OI(e,r)}};function Lj(){br(new ir("messaging",Pj,"PUBLIC")),br(new ir("messaging-internal",Rj,"PRIVATE")),jn(Tw,Aw),jn(Tw,Aw,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dj(){try{await BC()}catch{return!1}return typeof window<"u"&&Q0()&&GR()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mj(t,e){if(!navigator)throw yn.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VI(t=hp()){return Dj().then(e=>{if(!e)throw yn.create("unsupported-browser")},e=>{throw yn.create("indexed-db-unsupported")}),ga(Ke(t),"messaging").getImmediate()}async function jI(t,e){return t=Ke(t),OI(t,e)}function FI(t,e){return t=Ke(t),Mj(t,e)}Lj();const Oj={apiKey:"AIzaSyASi2ao3U8-D1rhdXfU-wUxji7PR_1muMo",authDomain:"av10dejulio-2ecc3.firebaseapp.com",projectId:"av10dejulio-2ecc3",storageBucket:"av10dejulio-2ecc3.appspot.com",messagingSenderId:"910468348910",appId:"1:910468348910:web:dd9a81bc1181a385dcacff",measurementId:"G-SZK5LL9Y14"},Hp=HC(Oj),$=E3(Hp),Fn=JO(Hp),Wc=oV(Hp),cd=VI(Hp),Vj="modulepreload",jj=function(t){return"/"+t},Pw={},zg=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=jj(i),i in Pw)return;Pw[i]=!0;const o=i.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const f=s[d];if(f.href===i&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":Vj,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};var Eb={};Object.defineProperty(Eb,"__esModule",{value:!0});Eb.parse=Wj;Eb.serialize=Hj;const Fj=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,zj=/^[\u0021-\u003A\u003C-\u007E]*$/,Uj=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,$j=/^[\u0020-\u003A\u003D-\u007E]*$/,Bj=Object.prototype.toString,qj=(()=>{const t=function(){};return t.prototype=Object.create(null),t})();function Wj(t,e){const n=new qj,r=t.length;if(r<2)return n;const s=(e==null?void 0:e.decode)||Gj;let i=0;do{const o=t.indexOf("=",i);if(o===-1)break;const l=t.indexOf(";",i),c=l===-1?r:l;if(o>c){i=t.lastIndexOf(";",o-1)+1;continue}const u=Rw(t,i,o),d=Lw(t,o,u),f=t.slice(u,d);if(n[f]===void 0){let g=Rw(t,o+1,c),v=Lw(t,c,g);const x=s(t.slice(g,v));n[f]=x}i=c+1}while(i<r);return n}function Rw(t,e,n){do{const r=t.charCodeAt(e);if(r!==32&&r!==9)return e}while(++e<n);return n}function Lw(t,e,n){for(;e>n;){const r=t.charCodeAt(--e);if(r!==32&&r!==9)return e+1}return n}function Hj(t,e,n){const r=(n==null?void 0:n.encode)||encodeURIComponent;if(!Fj.test(t))throw new TypeError(`argument name is invalid: ${t}`);const s=r(e);if(!zj.test(s))throw new TypeError(`argument val is invalid: ${e}`);let i=t+"="+s;if(!n)return i;if(n.maxAge!==void 0){if(!Number.isInteger(n.maxAge))throw new TypeError(`option maxAge is invalid: ${n.maxAge}`);i+="; Max-Age="+n.maxAge}if(n.domain){if(!Uj.test(n.domain))throw new TypeError(`option domain is invalid: ${n.domain}`);i+="; Domain="+n.domain}if(n.path){if(!$j.test(n.path))throw new TypeError(`option path is invalid: ${n.path}`);i+="; Path="+n.path}if(n.expires){if(!Kj(n.expires)||!Number.isFinite(n.expires.valueOf()))throw new TypeError(`option expires is invalid: ${n.expires}`);i+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(i+="; HttpOnly"),n.secure&&(i+="; Secure"),n.partitioned&&(i+="; Partitioned"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():void 0){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"none":i+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${n.sameSite}`)}return i}function Gj(t){if(t.indexOf("%")===-1)return t;try{return decodeURIComponent(t)}catch{return t}}function Kj(t){return Bj.call(t)==="[object Date]"}var Dw="popstate";function Qj(t={}){function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return Ug("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Hc(s)}return Yj(e,n,null,t)}function yt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Er(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Jj(){return Math.random().toString(36).substring(2,10)}function Mw(t,e){return{usr:t.state,key:t.key,idx:e}}function Ug(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?nl(e):e,state:n,key:e&&e.key||r||Jj()}}function Hc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function nl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function Yj(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l="POP",c=null,u=d();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function d(){return(o.state||{idx:null}).idx}function f(){l="POP";let y=d(),h=y==null?null:y-u;u=y,c&&c({action:l,location:E.location,delta:h})}function g(y,h){l="PUSH";let C=Ug(E.location,y,h);n&&n(C,y),u=d()+1;let T=Mw(C,u),k=E.createHref(C);try{o.pushState(T,"",k)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;s.location.assign(k)}i&&c&&c({action:l,location:E.location,delta:1})}function v(y,h){l="REPLACE";let C=Ug(E.location,y,h);n&&n(C,y),u=d();let T=Mw(C,u),k=E.createHref(C);o.replaceState(T,"",k),i&&c&&c({action:l,location:E.location,delta:0})}function x(y){return Zj(y)}let E={get action(){return l},get location(){return t(s,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Dw,f),c=y,()=>{s.removeEventListener(Dw,f),c=null}},createHref(y){return e(s,y)},createURL:x,encodeLocation(y){let h=x(y);return{pathname:h.pathname,search:h.search,hash:h.hash}},push:g,replace:v,go(y){return o.go(y)}};return E}function Zj(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),yt(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Hc(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function zI(t,e,n="/"){return Xj(t,e,n,!1)}function Xj(t,e,n,r){let s=typeof e=="string"?nl(e):e,i=fa(s.pathname||"/",n);if(i==null)return null;let o=UI(t);eF(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=dF(i);l=cF(o[c],u,r)}return l}function UI(t,e=[],n=[],r=""){let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(yt(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length));let u=aa([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(yt(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),UI(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:oF(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of $I(i.path))s(i,o,c)}),e}function $I(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=$I(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function eF(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:lF(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var tF=/^:[\w-]+$/,nF=3,rF=2,aF=1,sF=10,iF=-2,Ow=t=>t==="*";function oF(t,e){let n=t.split("/"),r=n.length;return n.some(Ow)&&(r+=iF),e&&(r+=rF),n.filter(s=>!Ow(s)).reduce((s,i)=>s+(tF.test(i)?nF:i===""?aF:sF),r)}function lF(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function cF(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=i==="/"?e:e.slice(i.length)||"/",f=Vm({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),g=c.route;if(!f&&u&&n&&!r[r.length-1].route.index&&(f=Vm({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:aa([i,f.pathname]),pathnameBase:hF(aa([i,f.pathnameBase])),route:g}),f.pathnameBase!=="/"&&(i=aa([i,f.pathnameBase]))}return o}function Vm(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=uF(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,{paramName:d,isOptional:f},g)=>{if(d==="*"){let x=l[g]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const v=l[g];return f&&!v?u[d]=void 0:u[d]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function uF(t,e=!1,n=!0){Er(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function dF(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Er(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function fa(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function mF(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?nl(t):t;return{pathname:n?n.startsWith("/")?n:pF(n,e):e,search:gF(r),hash:vF(s)}}function pF(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function nh(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function fF(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function xb(t){let e=fF(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function wb(t,e,n,r=!1){let s;typeof t=="string"?s=nl(t):(s={...t},yt(!s.pathname||!s.pathname.includes("?"),nh("?","pathname","search",s)),yt(!s.pathname||!s.pathname.includes("#"),nh("#","pathname","hash",s)),yt(!s.search||!s.search.includes("#"),nh("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),f-=1;s.pathname=g.join("/")}l=f>=0?e[f]:"/"}let c=mF(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var aa=t=>t.join("/").replace(/\/\/+/g,"/"),hF=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),gF=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,vF=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function bF(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var BI=["POST","PUT","PATCH","DELETE"];new Set(BI);var yF=["GET",...BI];new Set(yF);var rl=p.createContext(null);rl.displayName="DataRouter";var Gp=p.createContext(null);Gp.displayName="DataRouterState";var qI=p.createContext({isTransitioning:!1});qI.displayName="ViewTransition";var EF=p.createContext(new Map);EF.displayName="Fetchers";var xF=p.createContext(null);xF.displayName="Await";var wr=p.createContext(null);wr.displayName="Navigation";var yu=p.createContext(null);yu.displayName="Location";var _r=p.createContext({outlet:null,matches:[],isDataRoute:!1});_r.displayName="Route";var _b=p.createContext(null);_b.displayName="RouteError";function wF(t,{relative:e}={}){yt(al(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=p.useContext(wr),{hash:s,pathname:i,search:o}=Eu(t,{relative:e}),l=i;return n!=="/"&&(l=i==="/"?n:aa([n,i])),r.createHref({pathname:l,search:o,hash:s})}function al(){return p.useContext(yu)!=null}function lr(){return yt(al(),"useLocation() may be used only in the context of a <Router> component."),p.useContext(yu).location}var WI="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function HI(t){p.useContext(wr).static||p.useLayoutEffect(t)}function ft(){let{isDataRoute:t}=p.useContext(_r);return t?MF():_F()}function _F(){yt(al(),"useNavigate() may be used only in the context of a <Router> component.");let t=p.useContext(rl),{basename:e,navigator:n}=p.useContext(wr),{matches:r}=p.useContext(_r),{pathname:s}=lr(),i=JSON.stringify(xb(r)),o=p.useRef(!1);return HI(()=>{o.current=!0}),p.useCallback((c,u={})=>{if(Er(o.current,WI),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=wb(c,JSON.parse(i),s,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:aa([e,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[e,n,i,s,t])}p.createContext(null);function GI(){let{matches:t}=p.useContext(_r),e=t[t.length-1];return e?e.params:{}}function Eu(t,{relative:e}={}){let{matches:n}=p.useContext(_r),{pathname:r}=lr(),s=JSON.stringify(xb(n));return p.useMemo(()=>wb(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function NF(t,e){return KI(t,e)}function KI(t,e,n,r){var h;yt(al(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=p.useContext(wr),{matches:i}=p.useContext(_r),o=i[i.length-1],l=o?o.params:{},c=o?o.pathname:"/",u=o?o.pathnameBase:"/",d=o&&o.route;{let C=d&&d.path||"";QI(c,!d||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let f=lr(),g;if(e){let C=typeof e=="string"?nl(e):e;yt(u==="/"||((h=C.pathname)==null?void 0:h.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${C.pathname}" was given in the \`location\` prop.`),g=C}else g=f;let v=g.pathname||"/",x=v;if(u!=="/"){let C=u.replace(/^\//,"").split("/");x="/"+v.replace(/^\//,"").split("/").slice(C.length).join("/")}let E=zI(t,{pathname:x});Er(d||E!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),Er(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let y=TF(E&&E.map(C=>Object.assign({},C,{params:Object.assign({},l,C.params),pathname:aa([u,s.encodeLocation?s.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?u:aa([u,s.encodeLocation?s.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),i,n,r);return e&&y?p.createElement(yu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},y):y}function CF(){let t=DF(),e=bF(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=p.createElement(p.Fragment,null,p.createElement("p",null,"💿 Hey developer 👋"),p.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",p.createElement("code",{style:i},"ErrorBoundary")," or"," ",p.createElement("code",{style:i},"errorElement")," prop on your route.")),p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},e),n?p.createElement("pre",{style:s},n):null,o)}var SF=p.createElement(CF,null),kF=class extends p.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?p.createElement(_r.Provider,{value:this.props.routeContext},p.createElement(_b.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function IF({routeContext:t,match:e,children:n}){let r=p.useContext(rl);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),p.createElement(_r.Provider,{value:t},n)}function TF(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let s=t,i=n==null?void 0:n.errors;if(i!=null){let c=s.findIndex(u=>u.route.id&&(i==null?void 0:i[u.route.id])!==void 0);yt(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,c+1))}let o=!1,l=-1;if(n)for(let c=0;c<s.length;c++){let u=s[c];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(l=c),u.route.id){let{loaderData:d,errors:f}=n,g=u.route.loader&&!d.hasOwnProperty(u.route.id)&&(!f||f[u.route.id]===void 0);if(u.route.lazy||g){o=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((c,u,d)=>{let f,g=!1,v=null,x=null;n&&(f=i&&u.route.id?i[u.route.id]:void 0,v=u.route.errorElement||SF,o&&(l<0&&d===0?(QI("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,x=null):l===d&&(g=!0,x=u.route.hydrateFallbackElement||null)));let E=e.concat(s.slice(0,d+1)),y=()=>{let h;return f?h=v:g?h=x:u.route.Component?h=p.createElement(u.route.Component,null):u.route.element?h=u.route.element:h=c,p.createElement(IF,{match:u,routeContext:{outlet:c,matches:E,isDataRoute:n!=null},children:h})};return n&&(u.route.ErrorBoundary||u.route.errorElement||d===0)?p.createElement(kF,{location:n.location,revalidation:n.revalidation,component:v,error:f,children:y(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):y()},null)}function Nb(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function AF(t){let e=p.useContext(rl);return yt(e,Nb(t)),e}function PF(t){let e=p.useContext(Gp);return yt(e,Nb(t)),e}function RF(t){let e=p.useContext(_r);return yt(e,Nb(t)),e}function Cb(t){let e=RF(t),n=e.matches[e.matches.length-1];return yt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function LF(){return Cb("useRouteId")}function DF(){var r;let t=p.useContext(_b),e=PF("useRouteError"),n=Cb("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function MF(){let{router:t}=AF("useNavigate"),e=Cb("useNavigate"),n=p.useRef(!1);return HI(()=>{n.current=!0}),p.useCallback(async(s,i={})=>{Er(n.current,WI),n.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var Vw={};function QI(t,e,n){!e&&!Vw[t]&&(Vw[t]=!0,Er(!1,n))}p.memo(OF);function OF({routes:t,future:e,state:n}){return KI(t,void 0,n,e)}function JI({to:t,replace:e,state:n,relative:r}){yt(al(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=p.useContext(wr);Er(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=p.useContext(_r),{pathname:o}=lr(),l=ft(),c=wb(t,xb(i),o,r==="path"),u=JSON.stringify(c);return p.useEffect(()=>{l(JSON.parse(u),{replace:e,state:n,relative:r})},[l,u,r,e,n]),null}function Ie(t){yt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function VF({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1}){yt(!al(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=p.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof n=="string"&&(n=nl(n));let{pathname:c="/",search:u="",hash:d="",state:f=null,key:g="default"}=n,v=p.useMemo(()=>{let x=fa(c,o);return x==null?null:{location:{pathname:x,search:u,hash:d,state:f,key:g},navigationType:r}},[o,c,u,d,f,g,r]);return Er(v!=null,`<Router basename="${o}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:p.createElement(wr.Provider,{value:l},p.createElement(yu.Provider,{children:e,value:v}))}function Sb({children:t,location:e}){return NF($g(t),e)}function $g(t,e=[]){let n=[];return p.Children.forEach(t,(r,s)=>{if(!p.isValidElement(r))return;let i=[...e,s];if(r.type===p.Fragment){n.push.apply(n,$g(r.props.children,i));return}yt(r.type===Ie,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),yt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=$g(r.props.children,i)),n.push(o)}),n}var zd="get",Ud="application/x-www-form-urlencoded";function Kp(t){return t!=null&&typeof t.tagName=="string"}function jF(t){return Kp(t)&&t.tagName.toLowerCase()==="button"}function FF(t){return Kp(t)&&t.tagName.toLowerCase()==="form"}function zF(t){return Kp(t)&&t.tagName.toLowerCase()==="input"}function UF(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function $F(t,e){return t.button===0&&(!e||e==="_self")&&!UF(t)}var ud=null;function BF(){if(ud===null)try{new FormData(document.createElement("form"),0),ud=!1}catch{ud=!0}return ud}var qF=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function rh(t){return t!=null&&!qF.has(t)?(Er(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ud}"`),null):t}function WF(t,e){let n,r,s,i,o;if(FF(t)){let l=t.getAttribute("action");r=l?fa(l,e):null,n=t.getAttribute("method")||zd,s=rh(t.getAttribute("enctype"))||Ud,i=new FormData(t)}else if(jF(t)||zF(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(r=c?fa(c,e):null,n=t.getAttribute("formmethod")||l.getAttribute("method")||zd,s=rh(t.getAttribute("formenctype"))||rh(l.getAttribute("enctype"))||Ud,i=new FormData(l,t),!BF()){let{name:u,type:d,value:f}=t;if(d==="image"){let g=u?`${u}.`:"";i.append(`${g}x`,"0"),i.append(`${g}y`,"0")}else u&&i.append(u,f)}}else{if(Kp(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=zd,r=null,s=Ud,o=t}return i&&s==="text/plain"&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:o}}function kb(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function HF(t,e){if(t.id in e)return e[t.id];try{let n=await zg(()=>import(t.module),[]);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function GF(t){return t!=null&&typeof t.page=="string"}function KF(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function QF(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await HF(i,n);return o.links?o.links():[]}return[]}));return XF(r.flat(1).filter(KF).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function jw(t,e,n,r,s,i){let o=(c,u)=>n[u]?c.route.id!==n[u].route.id:!0,l=(c,u)=>{var d;return n[u].pathname!==c.pathname||((d=n[u].route.path)==null?void 0:d.endsWith("*"))&&n[u].params["*"]!==c.params["*"]};return i==="assets"?e.filter((c,u)=>o(c,u)||l(c,u)):i==="data"?e.filter((c,u)=>{var f;let d=r.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let g=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((f=n[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function JF(t,e,{includeHydrateFallback:n}={}){return YF(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function YF(t){return[...new Set(t)]}function ZF(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function XF(t,e){let n=new Set,r=new Set(e);return t.reduce((s,i)=>{if(e&&!GF(i)&&i.as==="script"&&i.href&&r.has(i.href))return s;let l=JSON.stringify(ZF(i));return n.has(l)||(n.add(l),s.push({key:l,link:i})),s},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var ez=new Set([100,101,204,205]);function tz(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&fa(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function YI(){let t=p.useContext(rl);return kb(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function nz(){let t=p.useContext(Gp);return kb(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Ib=p.createContext(void 0);Ib.displayName="FrameworkContext";function ZI(){let t=p.useContext(Ib);return kb(t,"You must render this element inside a <HydratedRouter> element"),t}function rz(t,e){let n=p.useContext(Ib),[r,s]=p.useState(!1),[i,o]=p.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:f}=e,g=p.useRef(null);p.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let E=h=>{h.forEach(C=>{o(C.isIntersecting)})},y=new IntersectionObserver(E,{threshold:.5});return g.current&&y.observe(g.current),()=>{y.disconnect()}}},[t]),p.useEffect(()=>{if(r){let E=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(E)}}},[r]);let v=()=>{s(!0)},x=()=>{s(!1),o(!1)};return n?t!=="intent"?[i,g,{}]:[i,g,{onFocus:Dl(l,v),onBlur:Dl(c,x),onMouseEnter:Dl(u,v),onMouseLeave:Dl(d,x),onTouchStart:Dl(f,v)}]:[!1,g,{}]}function Dl(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function az({page:t,...e}){let{router:n}=YI(),r=p.useMemo(()=>zI(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?p.createElement(iz,{page:t,matches:r,...e}):null}function sz(t){let{manifest:e,routeModules:n}=ZI(),[r,s]=p.useState([]);return p.useEffect(()=>{let i=!1;return QF(t,e,n).then(o=>{i||s(o)}),()=>{i=!0}},[t,e,n]),r}function iz({page:t,matches:e,...n}){let r=lr(),{manifest:s,routeModules:i}=ZI(),{basename:o}=YI(),{loaderData:l,matches:c}=nz(),u=p.useMemo(()=>jw(t,e,c,s,r,"data"),[t,e,c,s,r]),d=p.useMemo(()=>jw(t,e,c,s,r,"assets"),[t,e,c,s,r]),f=p.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let x=new Set,E=!1;if(e.forEach(h=>{var T;let C=s.routes[h.route.id];!C||!C.hasLoader||(!u.some(k=>k.route.id===h.route.id)&&h.route.id in l&&((T=i[h.route.id])!=null&&T.shouldRevalidate)||C.hasClientLoader?E=!0:x.add(h.route.id))}),x.size===0)return[];let y=tz(t,o);return E&&x.size>0&&y.searchParams.set("_routes",e.filter(h=>x.has(h.route.id)).map(h=>h.route.id).join(",")),[y.pathname+y.search]},[o,l,r,s,u,e,t,i]),g=p.useMemo(()=>JF(d,s),[d,s]),v=sz(d);return p.createElement(p.Fragment,null,f.map(x=>p.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...n})),g.map(x=>p.createElement("link",{key:x,rel:"modulepreload",href:x,...n})),v.map(({key:x,link:E})=>p.createElement("link",{key:x,...E})))}function oz(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var XI=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{XI&&(window.__reactRouterVersion="7.6.2")}catch{}function lz({basename:t,children:e,window:n}){let r=p.useRef();r.current==null&&(r.current=Qj({window:n,v5Compat:!0}));let s=r.current,[i,o]=p.useState({action:s.action,location:s.location}),l=p.useCallback(c=>{p.startTransition(()=>o(c))},[o]);return p.useLayoutEffect(()=>s.listen(l),[s,l]),p.createElement(VF,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:s})}var eT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tn=p.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f,...g},v){let{basename:x}=p.useContext(wr),E=typeof u=="string"&&eT.test(u),y,h=!1;if(typeof u=="string"&&E&&(y=u,XI))try{let w=new URL(window.location.href),A=u.startsWith("//")?new URL(w.protocol+u):new URL(u),R=fa(A.pathname,x);A.origin===w.origin&&R!=null?u=R+A.search+A.hash:h=!0}catch{Er(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let C=wF(u,{relative:s}),[T,k,_]=rz(r,g),S=mz(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:f});function N(w){e&&e(w),w.defaultPrevented||S(w)}let b=p.createElement("a",{...g,..._,href:y||C,onClick:h||i?e:N,ref:oz(v,k),target:c,"data-discover":!E&&n==="render"?"true":void 0});return T&&!E?p.createElement(p.Fragment,null,b,p.createElement(az,{page:C})):b});Tn.displayName="Link";var cz=p.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:o,viewTransition:l,children:c,...u},d){let f=Eu(o,{relative:u.relative}),g=lr(),v=p.useContext(Gp),{navigator:x,basename:E}=p.useContext(wr),y=v!=null&&vz(f)&&l===!0,h=x.encodeLocation?x.encodeLocation(f).pathname:f.pathname,C=g.pathname,T=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(C=C.toLowerCase(),T=T?T.toLowerCase():null,h=h.toLowerCase()),T&&E&&(T=fa(T,E)||T);const k=h!=="/"&&h.endsWith("/")?h.length-1:h.length;let _=C===h||!s&&C.startsWith(h)&&C.charAt(k)==="/",S=T!=null&&(T===h||!s&&T.startsWith(h)&&T.charAt(h.length)==="/"),N={isActive:_,isPending:S,isTransitioning:y},b=_?e:void 0,w;typeof r=="function"?w=r(N):w=[r,_?"active":null,S?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let A=typeof i=="function"?i(N):i;return p.createElement(Tn,{...u,"aria-current":b,className:w,ref:d,style:A,to:o,viewTransition:l},typeof c=="function"?c(N):c)});cz.displayName="NavLink";var uz=p.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:o=zd,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:f,...g},v)=>{let x=hz(),E=gz(l,{relative:u}),y=o.toLowerCase()==="get"?"get":"post",h=typeof l=="string"&&eT.test(l),C=T=>{if(c&&c(T),T.defaultPrevented)return;T.preventDefault();let k=T.nativeEvent.submitter,_=(k==null?void 0:k.getAttribute("formmethod"))||o;x(k||T.currentTarget,{fetcherKey:e,method:_,navigate:n,replace:s,state:i,relative:u,preventScrollReset:d,viewTransition:f})};return p.createElement("form",{ref:v,method:y,action:E,onSubmit:r?c:C,...g,"data-discover":!h&&t==="render"?"true":void 0})});uz.displayName="Form";function dz(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function tT(t){let e=p.useContext(rl);return yt(e,dz(t)),e}function mz(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:o}={}){let l=ft(),c=lr(),u=Eu(t,{relative:i});return p.useCallback(d=>{if($F(d,e)){d.preventDefault();let f=n!==void 0?n:Hc(c)===Hc(u);l(t,{replace:f,state:r,preventScrollReset:s,relative:i,viewTransition:o})}},[c,l,u,n,r,e,t,s,i,o])}var pz=0,fz=()=>`__${String(++pz)}__`;function hz(){let{router:t}=tT("useSubmit"),{basename:e}=p.useContext(wr),n=LF();return p.useCallback(async(r,s={})=>{let{action:i,method:o,encType:l,formData:c,body:u}=WF(r,e);if(s.navigate===!1){let d=s.fetcherKey||fz();await t.fetch(d,n,s.action||i,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||o,formEncType:s.encType||l,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||o,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,n])}function gz(t,{relative:e}={}){let{basename:n}=p.useContext(wr),r=p.useContext(_r);yt(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...Eu(t||".",{relative:e})},o=lr();if(t==null){i.search=o.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(f=>f).forEach(f=>l.append("index",f));let d=l.toString();i.search=d?`?${d}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:aa([n,i.pathname])),Hc(i)}function vz(t,e={}){let n=p.useContext(qI);yt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=tT("useViewTransitionState"),s=Eu(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=fa(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=fa(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Vm(s.pathname,o)!=null||Vm(s.pathname,i)!=null}[...ez];const nT=p.createContext();function Qe(){return p.useContext(nT)}function bz({children:t}){const[e,n]=p.useState(null),[r,s]=p.useState(null),[i,o]=p.useState(!0),[l,c]=p.useState(null);return p.useEffect(()=>ab(Fn,async d=>{try{if(d){console.log("Usuario logueado:",d.email,"UID:",d.uid);const f=await di(we($,"usuarios",d.uid));if(f.exists()){const g=f.data();console.log("Datos del usuario desde Firestore:",g),s(g.rol)}else console.log("No se encontró documento del usuario en Firestore"),s(null);n(d)}else console.log("Usuario no logueado"),n(null),s(null)}catch(f){console.error("Error en AuthProvider:",f),c(f.message)}finally{o(!1)}}),[]),a.createElement(nT.Provider,{value:{user:e,rol:r,loading:i,error:l}},t)}function yz(t,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},t),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"}))}const Ez=p.forwardRef(yz),xz=Ez;function wz(t,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},t),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"}))}const _z=p.forwardRef(wz),jm=_z;function Nz(t,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},t),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}const Cz=p.forwardRef(Nz),rT=Cz;function Sz(t,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},t),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"}))}const kz=p.forwardRef(Sz),Iz=kz;function Tz(t,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},t),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"}))}const Az=p.forwardRef(Tz),Pz=Az;function Rz(t,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},t),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"}))}const Lz=p.forwardRef(Rz),Dz=Lz;function Mz(t,e){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:e},t),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}const Oz=p.forwardRef(Mz),aT=Oz,Vz=()=>{const{rol:t}=Qe(),[e,n]=p.useState([]),[r,s]=p.useState(0),[i,o]=p.useState(!1),[l,c]=p.useState(!0);p.useEffect(()=>{t==="admin"&&u()},[t]);const u=async()=>{try{const g=pe(Q($,"tickets"),fe("visto","==",!1),Et("fechaCreacion","desc"),jo(5)),x=(await ue(g)).docs.map(k=>({id:k.id,...k.data(),type:"unread"})),E=pe(Q($,"tickets"),fe("prioridad","==","urgente"),fe("estado","!=","cerrado"),Et("fechaCreacion","desc"),jo(3)),h=(await ue(E)).docs.map(k=>({id:k.id,...k.data(),type:"urgent"})),T=[...x,...h].filter((k,_,S)=>_===S.findIndex(N=>N.id===k.id));n(T.slice(0,5)),s(x.length)}catch(g){console.error("Error fetching notifications:",g)}finally{c(!1)}},d=g=>{if(!g)return"Sin fecha";const v=g.toDate?g.toDate():new Date(g),E=Math.abs(new Date-v),y=Math.ceil(E/(1e3*60*60*24));return y===1?"Hoy":y===2?"Ayer":y<=7?`Hace ${y} días`:v.toLocaleDateString("es-ES")},f=g=>{switch(g){case"complaint":return a.createElement(rT,{className:"h-4 w-4 text-red-500"});case"support":return a.createElement(jm,{className:"h-4 w-4 text-blue-500"});default:return a.createElement(jm,{className:"h-4 w-4 text-gray-500"})}};return t!=="admin"||l?null:a.createElement("div",{className:"relative"},a.createElement("button",{onClick:()=>o(!i),className:"relative p-2 text-gray-400 hover:text-gray-600 transition-colors"},a.createElement(xz,{className:"h-6 w-6"}),r>0&&a.createElement("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},r>9?"9+":r)),i&&a.createElement("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-50"},a.createElement("div",{className:"py-1"},a.createElement("div",{className:"px-4 py-2 border-b border-gray-200"},a.createElement("h3",{className:"text-sm font-medium text-gray-900"},"Notificaciones de Tickets")),e.length===0?a.createElement("div",{className:"px-4 py-3 text-sm text-gray-500 text-center"},"No hay notificaciones nuevas"):a.createElement(a.Fragment,null,e.map(g=>a.createElement("a",{key:g.id,href:`/admin/gestion-tickets?ticket=${g.id}`,className:"block px-4 py-3 hover:bg-gray-50 transition-colors",onClick:()=>o(!1)},a.createElement("div",{className:"flex items-start"},a.createElement("div",{className:"flex-shrink-0 mr-3 mt-1"},f(g.tipo)),a.createElement("div",{className:"flex-1 min-w-0"},a.createElement("p",{className:"text-sm font-medium text-gray-900 truncate"},g.asunto),a.createElement("p",{className:"text-sm text-gray-500 truncate"},"De: ",g.nombre),a.createElement("div",{className:"flex items-center justify-between mt-1"},a.createElement("span",{className:"text-xs text-gray-400"},d(g.fechaCreacion)),a.createElement("div",{className:"flex items-center gap-1"},g.type==="unread"&&a.createElement("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full"},"Nuevo"),g.prioridad==="urgente"&&a.createElement("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full"},"Urgente"))))))),a.createElement("div",{className:"border-t border-gray-200"},a.createElement("a",{href:"/admin/gestion-tickets",className:"block px-4 py-2 text-sm text-blue-600 hover:text-blue-800 text-center",onClick:()=>o(!1)},"Ver todos los tickets"))))),i&&a.createElement("div",{className:"fixed inset-0 z-40",onClick:()=>o(!1)}))};class sa{static async createInAppNotification(e,n,r,s,i={}){try{const o={userId:e,tipo:n,titulo:r,mensaje:s,metadatos:i,leida:!1,fechaCreacion:new Date,fechaVencimiento:i.fechaVencimiento||null};return(await ze(Q($,"notificaciones"),o)).id}catch(o){throw console.error("Error creating notification:",o),o}}static async getUserNotifications(e,n=10){try{const r=pe(Q($,"notificaciones"),fe("userId","==",e),Et("fechaCreacion","desc"),jo(n));return(await ue(r)).docs.map(i=>({id:i.id,...i.data()}))}catch(r){return console.error("Error getting notifications:",r),[]}}static async markAsRead(e){try{await Me(we($,"notificaciones",e),{leida:!0,fechaLectura:new Date})}catch(n){console.error("Error marking notification as read:",n)}}static async getUnreadCount(e){try{const n=pe(Q($,"notificaciones"),fe("userId","==",e),fe("leida","==",!1));return(await ue(n)).size}catch(n){return console.error("Error getting unread count:",n),0}}static async notifyClientValidationStatus(e,n,r=""){const s={activo:{titulo:"¡Perfil Validado! 🎉",mensaje:"Tu perfil ha sido validado exitosamente. Ya puedes acceder a todos nuestros servicios y gestionar tus vehículos.",tipo:"validacion"},rechazado:{titulo:"Perfil Rechazado ❌",mensaje:`Tu perfil ha sido rechazado. ${r?`Motivo: ${r}`:"Por favor, revisa los datos ingresados y vuelve a intentar."}`,tipo:"validacion"},suspendido:{titulo:"Perfil Suspendido ⚠️",mensaje:`Tu perfil ha sido suspendido temporalmente. ${r?`Motivo: ${r}`:"Contacta con soporte para más información."}`,tipo:"validacion"}};s[n]&&await this.createInAppNotification(e,s[n].tipo,s[n].titulo,s[n].mensaje,{estado:n,observaciones:r,origen:"validacion_cliente"}),await this.sendEmailNotification(e,n,r)}static async notifyVehicleReminder(e,n,r,s){const i={permiso_circulacion:{titulo:"🚗 Renovar Permiso de Circulación",mensaje:`Tu ${n.marca} ${n.modelo} necesita renovar el permiso de circulación.`},revision_tecnica:{titulo:"🔧 Revisión Técnica Pendiente",mensaje:`Tu ${n.marca} ${n.modelo} debe hacer la revisión técnica.`},soap:{titulo:"📋 SOAP Vencido",mensaje:`Tu ${n.marca} ${n.modelo} tiene el SOAP vencido.`},seguro:{titulo:"🛡️ Renovar Seguro",mensaje:`Tu ${n.marca} ${n.modelo} necesita renovar el seguro.`}};i[r]&&await this.createInAppNotification(e,"recordatorio",i[r].titulo,i[r].mensaje,{vehiculoId:n.id,tipoRecordatorio:r,fechaVencimiento:s,patente:n.patente})}static async sendEmailNotification(e,n,r){try{console.log(`Email notification sent to user ${e}:`,{estado:n,observaciones:r}),await ze(Q($,"email_logs"),{userId:e,tipo:"validacion_cliente",estado:n,observaciones:r,fechaEnvio:new Date,proveedor:"sistema_interno"})}catch(s){console.error("Error sending email notification:",s)}}static async notifyPromotion(e,n,r,s=null){await this.createInAppNotification(e,"promocion",n,r,{tipoVehiculo:s,origen:"marketing",fechaVencimiento:new Date(Date.now()+7*24*60*60*1e3)})}static async notifySystemUpdate(e,n,r){await this.createInAppNotification(e,"sistema",n,r,{origen:"sistema"})}static async createMassiveReminders(e,n={}){try{const r=Q($,"vehiculos"),s=await ue(r);let i=0;for(const o of s.docs){const l={id:o.id,...o.data()};n.marca&&l.marca!==n.marca||n.año&&l.año!==n.año||(await this.notifyVehicleReminder(l.userId,l,e,n.fechaVencimiento),i++)}return i}catch(r){throw console.error("Error creating massive reminders:",r),r}}}function jz(){const{user:t}=Qe(),[e,n]=p.useState([]),[r,s]=p.useState(0),[i,o]=p.useState(!1),[l,c]=p.useState(!1);p.useEffect(()=>{if(t){u(),d();const E=setInterval(()=>{d()},3e4);return()=>clearInterval(E)}},[t]);const u=async()=>{try{c(!0);const E=await sa.getUserNotifications(t.uid,20);n(E)}catch(E){console.error("Error loading notifications:",E)}finally{c(!1)}},d=async()=>{try{const E=await sa.getUnreadCount(t.uid);s(E)}catch(E){console.error("Error loading unread count:",E)}},f=async E=>{try{await sa.markAsRead(E),await u(),await d()}catch(y){console.error("Error marking as read:",y)}},g=E=>{var y,h;switch(E.leida||f(E.id),E.tipo){case"validacion":((y=E.metadatos)==null?void 0:y.estado)==="activo"&&(window.location.href="/dashboard/cliente");break;case"recordatorio":(h=E.metadatos)!=null&&h.vehiculoId&&(window.location.href="/dashboard/cliente/vehiculos");break}},v=E=>({validacion:"✅",recordatorio:"⏰",promocion:"🎁",sistema:"🔧"})[E]||"📢",x=E=>{if(!E)return"";const y=E.toDate?E.toDate():new Date(E),C=new Date-y,T=Math.floor(C/6e4),k=Math.floor(C/36e5),_=Math.floor(C/864e5);return T<1?"Ahora":T<60?`${T}m`:k<24?`${k}h`:_<7?`${_}d`:y.toLocaleDateString("es-CL")};return a.createElement("div",{className:"relative"},a.createElement("button",{onClick:()=>o(!i),className:"relative p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors"},a.createElement("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})),r>0&&a.createElement("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium"},r>99?"99+":r)),i&&a.createElement("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border z-50 max-h-96 overflow-hidden"},a.createElement("div",{className:"p-3 border-b bg-gray-50"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("h3",{className:"font-semibold text-gray-800"},"Notificaciones"),a.createElement("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700"},a.createElement("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})))),r>0&&a.createElement("p",{className:"text-sm text-gray-600 mt-1"},r," notificación",r!==1?"es":""," sin leer")),a.createElement("div",{className:"max-h-64 overflow-y-auto"},l?a.createElement("div",{className:"p-4 text-center"},a.createElement("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"})):e.length===0?a.createElement("div",{className:"p-4 text-center text-gray-500"},a.createElement("svg",{className:"w-12 h-12 mx-auto mb-2 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})),a.createElement("p",{className:"text-sm"},"No hay notificaciones")):e.map(E=>a.createElement("div",{key:E.id,onClick:()=>g(E),className:`p-3 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition-colors ${E.leida?"":"bg-blue-50 border-l-4 border-l-blue-500"}`},a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("span",{className:"text-lg flex-shrink-0 mt-0.5"},v(E.tipo)),a.createElement("div",{className:"flex-1 min-w-0"},a.createElement("p",{className:`text-sm font-medium text-gray-900 ${E.leida?"":"font-semibold"}`},E.titulo),a.createElement("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2"},E.mensaje),a.createElement("p",{className:"text-xs text-gray-400 mt-2"},x(E.fechaCreacion))),!E.leida&&a.createElement("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-2"}))))),e.length>0&&a.createElement("div",{className:"p-3 border-t bg-gray-50"},a.createElement("button",{onClick:()=>{o(!1)},className:"w-full text-sm text-blue-600 hover:text-blue-800 font-medium"},"Ver todas las notificaciones"))),i&&a.createElement("div",{className:"fixed inset-0 z-40",onClick:()=>o(!1)}))}function Bg(){const t=ft(),e=lr(),{user:n,rol:r}=Qe(),[s,i]=p.useState(!1),[o,l]=p.useState(!1),c=async()=>{await Fn.signOut(),t("/login")},u=()=>{l(!1),i(!1)},d=v=>e.pathname===v?"underline font-bold":"hover:underline",f=e.pathname==="/proveedores"||e.pathname.startsWith("/proveedores/"),g=()=>{u(),t(r==="admin"?"/admin":r==="proveedor"?"/dashboard/proveedor":"/proveedores")};return a.createElement("nav",{className:"w-full bg-blue-800 text-white flex items-center px-6 py-3 shadow justify-between z-20"},a.createElement("div",{className:"flex items-center gap-4"},a.createElement("button",{className:d("/"),onClick:()=>{t("/"),u()}},"Inicio"),n&&r!=="admin"&&a.createElement("button",{className:d(r==="proveedor"?"/dashboard/proveedor":r==="mecanico"?"/dashboard/mecanico":"/dashboard/cliente"),onClick:()=>{u(),t(r==="proveedor"?"/dashboard/proveedor":r==="mecanico"?"/dashboard/mecanico":"/dashboard/cliente")}},"📊 Mi Dashboard"),n&&r==="admin"&&a.createElement("div",{className:"relative"},a.createElement("button",{className:"hover:underline flex items-center gap-1",onClick:()=>i(!s)},"📊 Mi Dashboard",a.createElement("span",{className:"text-xs"},"▼")),s&&a.createElement("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg py-2 min-w-48 z-50"},a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm font-semibold border-b border-gray-200",onClick:()=>{t("/admin"),i(!1)}},"🏠 Panel Principal"),a.createElement("div",{className:"border-b border-gray-200 pb-2 mb-2"},a.createElement("div",{className:"px-4 py-1 text-xs text-gray-500 font-semibold"},"SERVICIOS"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/servicios/seguros"),i(!1)}},"🛡️ Seguros"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/servicios/revision-tecnica"),i(!1)}},"🔧 Revisión Técnica"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/servicios/vulcanizaciones"),i(!1)}},"🏁 Vulcanizaciones"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/servicios/reciclaje"),i(!1)}},"♻️ Reciclaje"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/mis-recordatorios"),i(!1)}},"🔔 Mis Recordatorios")),a.createElement("div",{className:"border-b border-gray-200 pb-2 mb-2"},a.createElement("div",{className:"px-4 py-1 text-xs text-gray-500 font-semibold"},"ADMINISTRACIÓN"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/admin/marcas"),i(!1)}},"🏷️ Gestión de Marcas"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/admin/tipos-empresa"),i(!1)}},"🏢 Tipos de Empresa"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/admin/categorias"),i(!1)}},"📂 Gestión de Categorías"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/admin/proveedores"),i(!1)}},"🏪 Gestión de Proveedores"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/admin/solicitudes-cliente"),i(!1)}},"👥 Solicitudes de Clientes"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/admin/solicitudes-registro"),i(!1)}},"🏪 Solicitudes de Proveedores"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/admin/validacion-clientes"),i(!1)}},"✅ Validación de Clientes"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/admin/estadisticas"),i(!1)}},"📊 Panel de Estadísticas")),a.createElement("div",null,a.createElement("div",{className:"px-4 py-1 text-xs text-gray-500 font-semibold"},"CATASTRO"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/admin/catastro-masivo"),i(!1)}},"📊 Catastro Masivo"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/admin/panel-validacion"),i(!1)}},"🔍 Panel de Validación"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/admin/agentes-campo"),i(!1)}},"👥 Agentes de Campo")))),n&&!r||n&&r==="cliente"?a.createElement("button",{className:d("/status-cliente"),onClick:()=>{t("/status-cliente"),u()}},"👤 Mi Estado"):null,!n||n&&r!=="cliente"&&r!=="admin"?a.createElement(a.Fragment,null,a.createElement("button",{className:d("/proveedores"),onClick:g},"Proveedores"),a.createElement("button",{className:d("/proveedores-locales"),onClick:()=>{t("/proveedores-locales"),u()}},"🏪 Empresas")):null,a.createElement("button",{className:d("/recursos"),onClick:()=>{t("/recursos"),u()}},"Recursos"),a.createElement("button",{className:d("/faq"),onClick:()=>{t("/faq"),u()}},"FAQ"),a.createElement("button",{className:d("/contacto"),onClick:()=>{t("/contacto"),u()}},"Contacto"),!n||n&&r!=="admin"?a.createElement("div",{className:"relative"},a.createElement("button",{className:"hover:underline flex items-center gap-1",onClick:()=>l(!o)},"🚗 Servicios",a.createElement("span",{className:"text-xs"},"▼")),o&&a.createElement("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg py-2 min-w-48 z-50"},a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/servicios/seguros"),l(!1)}},"🛡️ Seguros"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/servicios/revision-tecnica"),l(!1)}},"🔧 Revisión Técnica"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/servicios/vulcanizaciones"),l(!1)}},"🏁 Vulcanizaciones"),a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/servicios/reciclaje"),l(!1)}},"♻️ Reciclaje"),n&&a.createElement("button",{className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm",onClick:()=>{t("/mis-recordatorios"),l(!1)}},"🔔 Mis Recordatorios"))):null,n&&r==="admin"&&f&&a.createElement(a.Fragment,null,a.createElement("button",{className:"hover:underline",onClick:()=>t("/admin/ingresar-empresa")},"Ingresar empresa"),a.createElement("button",{className:"hover:underline",onClick:()=>t("/admin/ingresar-campana")},"Ingresar campaña"),a.createElement("button",{className:"hover:underline",onClick:()=>t("/admin/ingresar-producto")},"Ingresar producto"))),a.createElement("div",{className:"flex items-center gap-4"},n&&a.createElement(jz,null),r==="admin"&&a.createElement(Vz,null),r==="admin"&&a.createElement("button",{className:"flex items-center gap-1 text-sm hover:underline",onClick:()=>t("/admin/validacion-clientes")},"✅ Validar Clientes"),n&&a.createElement("button",{className:"hover:underline text-sm",onClick:()=>t("/mis-consultas")},"Mis Consultas"),!n&&a.createElement("div",{className:"flex items-center gap-2"},a.createElement("div",{className:"flex gap-2"},a.createElement("button",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded text-sm hover:bg-blue-200 transition-colors",onClick:()=>t("/registro-cliente")},"🚗 Cliente"),a.createElement("button",{className:"bg-green-100 text-green-800 px-3 py-1 rounded text-sm hover:bg-green-200 transition-colors",onClick:()=>t("/registro-proveedor")},"🏪 Proveedor")),a.createElement("button",{className:"bg-white text-blue-800 rounded px-4 py-1 font-semibold hover:bg-gray-100 transition-colors",onClick:()=>t("/login")},"Iniciar sesión")),n&&a.createElement("div",{className:"flex items-center gap-3"},a.createElement(Fz,{user:n,rol:r,onLogout:c,navigate:t}))))}function Fz({user:t,rol:e,onLogout:n,navigate:r}){var u,d;const[s,i]=p.useState(!1),o=()=>{switch(e){case"admin":return"/admin";case"proveedor":return"/dashboard/proveedor";case"agente":return"/agente";case"mecanico":return"/dashboard/mecanico";case"cliente":return"/dashboard/cliente";default:return"/dashboard/cliente"}},l=()=>{switch(e){case"admin":return"Administrador";case"proveedor":return"Proveedor";case"agente":return"Agente de Campo";case"mecanico":return"Mecánico";case"cliente":return"Cliente";default:return"Usuario"}},c=()=>{switch(e){case"admin":return"👑";case"proveedor":return"🏪";case"agente":return"👨‍💼";case"mecanico":return"🔧";case"cliente":return"🚗";default:return"👤"}};return a.createElement("div",{className:"relative"},a.createElement("button",{onClick:()=>i(!s),className:"flex items-center gap-2 bg-blue-700 hover:bg-blue-600 px-3 py-2 rounded-lg transition-colors"},a.createElement("span",{className:"text-lg"},c()),a.createElement("div",{className:"text-left hidden md:block"},a.createElement("div",{className:"text-xs text-blue-200"},"Hola,"),a.createElement("div",{className:"text-sm font-medium truncate max-w-32",title:t.email},t.displayName||((u=t.email)==null?void 0:u.split("@")[0])||"Usuario")),a.createElement("span",{className:"text-xs"},"▼")),s&&a.createElement("div",{className:"absolute top-full right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg py-2 min-w-64 z-50"},a.createElement("div",{className:"px-4 py-3 border-b border-gray-200"},a.createElement("div",{className:"flex items-center gap-3"},a.createElement("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center text-lg"},c()),a.createElement("div",null,a.createElement("div",{className:"font-medium text-gray-900"},t.displayName||((d=t.email)==null?void 0:d.split("@")[0])||"Usuario"),a.createElement("div",{className:"text-sm text-gray-500"},l()),a.createElement("div",{className:"text-xs text-gray-400"},t.email)))),a.createElement("div",{className:"py-2"},a.createElement("button",{onClick:()=>{r(o()),i(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},a.createElement("span",null,"📊"),a.createElement("span",null,"Mi Dashboard")),a.createElement("button",{onClick:()=>{r("/"),i(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},a.createElement("span",null,"🏠"),a.createElement("span",null,"Ir al Inicio")),a.createElement("button",{onClick:()=>{r("/mis-consultas"),i(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},a.createElement("span",null,"💬"),a.createElement("span",null,"Mis Consultas")),e==="proveedor"&&a.createElement(a.Fragment,null,a.createElement("button",{onClick:()=>{r("/dashboard/proveedor/perfil"),i(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},a.createElement("span",null,"👤"),a.createElement("span",null,"Mi Perfil")),a.createElement("button",{onClick:()=>{r("/dashboard/proveedor/productos"),i(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},a.createElement("span",null,"📦"),a.createElement("span",null,"Mis Productos"))),e==="cliente"&&a.createElement(a.Fragment,null,a.createElement("button",{onClick:()=>{r("/dashboard/cliente/perfil"),i(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},a.createElement("span",null,"👤"),a.createElement("span",null,"Mi Perfil")),a.createElement("button",{onClick:()=>{r("/dashboard/cliente/vehiculos"),i(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},a.createElement("span",null,"🚗"),a.createElement("span",null,"Mis Vehículos"))),e==="agente"&&a.createElement("button",{onClick:()=>{r("/agente/empresas"),i(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center gap-3"},a.createElement("span",null,"🏢"),a.createElement("span",null,"Registrar Empresa"))),a.createElement("div",{className:"border-t border-gray-200 pt-2"},a.createElement("button",{onClick:()=>{n(),i(!1)},className:"w-full text-left px-4 py-2 text-red-600 hover:bg-red-50 flex items-center gap-3"},a.createElement("span",null,"🚪"),a.createElement("span",null,"Cerrar Sesión")))))}const zz=()=>{const t=ft();return a.createElement("div",{className:"relative bg-gradient-to-br from-blue-900 via-blue-800 to-blue-600 text-white overflow-hidden"},a.createElement(Bg,null),a.createElement("div",{className:"absolute inset-0 opacity-20"},a.createElement("svg",{width:"60",height:"60",viewBox:"0 0 60 60",xmlns:"http://www.w3.org/2000/svg",className:"w-full h-full"},a.createElement("g",{fill:"none",fillRule:"evenodd"},a.createElement("g",{fill:"#ffffff",fillOpacity:"0.05"},a.createElement("circle",{cx:"7",cy:"7",r:"7"}))))),a.createElement("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 lg:py-24"},a.createElement("div",{className:"grid lg:grid-cols-2 gap-12 items-center"},a.createElement("div",{className:"space-y-8"},a.createElement("div",{className:"space-y-4"},a.createElement("h1",{className:"text-4xl lg:text-6xl font-bold leading-tight"},a.createElement("span",{className:"bg-gradient-to-r from-yellow-400 to-orange-400 bg-clip-text text-transparent"},"200+")," ","Proveedores",a.createElement("br",null),a.createElement("span",{className:"text-3xl lg:text-5xl"},"del sector automotriz")),a.createElement("p",{className:"text-xl lg:text-2xl text-blue-100 max-w-lg"},"Descubre repuestos, servicios y las mejores ofertas en la",a.createElement("strong",{className:"text-yellow-400"}," Av. 10 de Julio"))),a.createElement("div",{className:"grid grid-cols-3 gap-4"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-2xl lg:text-3xl font-bold text-yellow-400"},"200+"),a.createElement("div",{className:"text-sm text-blue-200"},"Proveedores")),a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-2xl lg:text-3xl font-bold text-yellow-400"},"1000+"),a.createElement("div",{className:"text-sm text-blue-200"},"Productos")),a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-2xl lg:text-3xl font-bold text-yellow-400"},"50+"),a.createElement("div",{className:"text-sm text-blue-200"},"Campañas"))),a.createElement("div",{className:"space-y-4"},a.createElement("div",{className:"flex flex-col sm:flex-row gap-4"},a.createElement("button",{onClick:()=>t("/proveedores"),className:"bg-yellow-400 hover:bg-yellow-500 text-blue-900 px-8 py-3 rounded-lg font-semibold text-lg transition-all transform hover:scale-105 shadow-lg"},"Ver Proveedores"),a.createElement("button",{onClick:()=>t("/proveedores-locales"),className:"border-2 border-white text-white hover:bg-white hover:text-blue-900 px-8 py-3 rounded-lg font-semibold text-lg transition-all"},"🏪 PyMEs Locales")),a.createElement("div",{className:"flex flex-col sm:flex-row gap-3"},a.createElement("button",{onClick:()=>t("/login?tipo=cliente"),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium text-sm transition-all shadow-md flex items-center justify-center gap-2"},"🔑 ",a.createElement("span",null,"Acceso Clientes")),a.createElement("button",{onClick:()=>t("/login?tipo=empresa"),className:"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-medium text-sm transition-all shadow-md flex items-center justify-center gap-2"},"🏢 ",a.createElement("span",null,"Acceso Empresas")),a.createElement("button",{onClick:()=>t("/registro-cliente"),className:"bg-white/20 hover:bg-white/30 text-white border border-white/30 px-6 py-2 rounded-lg font-medium text-sm transition-all flex items-center justify-center gap-2"},"➕ ",a.createElement("span",null,"Registrarse"))))),a.createElement("div",{className:"relative"},a.createElement("div",{className:"relative z-10 bg-white/10 backdrop-blur-sm rounded-2xl p-8 border border-white/20"},a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"flex items-center space-x-3"},a.createElement("div",{className:"w-12 h-12 bg-yellow-400 rounded-lg flex items-center justify-center"},a.createElement("span",{className:"text-blue-900 text-2xl"},"🚗")),a.createElement("div",null,a.createElement("h3",{className:"font-semibold"},"Repuestos Originales y Alternativos"),a.createElement("p",{className:"text-blue-200 text-sm"},"Calidad garantizada"))),a.createElement("div",{className:"flex items-center space-x-3"},a.createElement("div",{className:"w-12 h-12 bg-green-400 rounded-lg flex items-center justify-center"},a.createElement("span",{className:"text-white text-2xl"},"🛠️")),a.createElement("div",null,a.createElement("h3",{className:"font-semibold"},"Servicios Especializados"),a.createElement("p",{className:"text-blue-200 text-sm"},"Técnicos expertos"))),a.createElement("div",{className:"flex items-center space-x-3"},a.createElement("div",{className:"w-12 h-12 bg-orange-400 rounded-lg flex items-center justify-center"},a.createElement("span",{className:"text-white text-2xl"},"💰")),a.createElement("div",null,a.createElement("h3",{className:"font-semibold"},"Mejores Precios"),a.createElement("p",{className:"text-blue-200 text-sm"},"Ofertas exclusivas"))))),a.createElement("div",{className:"absolute -top-4 -right-4 w-24 h-24 bg-yellow-400/20 rounded-full blur-xl"}),a.createElement("div",{className:"absolute -bottom-8 -left-8 w-32 h-32 bg-orange-400/20 rounded-full blur-xl"})))),a.createElement("div",{className:"bg-white text-gray-800"},a.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16"},a.createElement("div",{className:"text-center mb-12"},a.createElement("h2",{className:"text-3xl lg:text-4xl font-bold text-gray-900 mb-4"},"Únete a Nuestra ",a.createElement("span",{className:"text-blue-600"},"Comunidad")),a.createElement("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto"},"Tanto si eres dueño de vehículo como emprendedor automotriz, tenemos beneficios especiales para ti en la Av. 10 de Julio")),a.createElement("div",{className:"grid lg:grid-cols-2 gap-12"},a.createElement("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-100 rounded-2xl p-8 border border-blue-200"},a.createElement("div",{className:"text-center mb-6"},a.createElement("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4"},a.createElement("span",{className:"text-white text-3xl"},"👤")),a.createElement("h3",{className:"text-2xl font-bold text-blue-900"},"Para Clientes"),a.createElement("p",{className:"text-blue-700"},"Registra tu vehículo y obtén beneficios únicos")),a.createElement("div",{className:"space-y-4 mb-8"},a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},a.createElement("span",{className:"text-white text-xs"},"✓")),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900"},"Recordatorios Inteligentes"),a.createElement("p",{className:"text-gray-600 text-sm"},"Permiso de circulación, revisión técnica, seguros y mantenciones"))),a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},a.createElement("span",{className:"text-white text-xs"},"✓")),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900"},"Ofertas Personalizadas"),a.createElement("p",{className:"text-gray-600 text-sm"},"Promociones según tu marca y modelo de vehículo"))),a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},a.createElement("span",{className:"text-white text-xs"},"✓")),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900"},"Historial de Gastos"),a.createElement("p",{className:"text-gray-600 text-sm"},"Controla y planifica los gastos de tu vehículo"))),a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},a.createElement("span",{className:"text-white text-xs"},"✓")),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900"},"Red de Proveedores Locales"),a.createElement("p",{className:"text-gray-600 text-sm"},"Acceso directo a talleres y repuestos cerca de ti")))),a.createElement("div",{className:"space-y-3"},a.createElement("button",{onClick:()=>t("/registro-cliente"),className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-6 rounded-lg font-semibold transition-all transform hover:scale-105"},"🚗 Registrar Mi Vehículo"),a.createElement("button",{onClick:()=>t("/login?tipo=cliente"),className:"w-full bg-white border-2 border-blue-600 text-blue-600 py-3 px-6 rounded-lg font-semibold transition-all hover:bg-blue-50"},"🔑 Ya Tengo Cuenta - Ingresar"))),a.createElement("div",{className:"bg-gradient-to-br from-orange-50 to-red-100 rounded-2xl p-8 border border-orange-200"},a.createElement("div",{className:"text-center mb-6"},a.createElement("div",{className:"w-16 h-16 bg-orange-600 rounded-full flex items-center justify-center mx-auto mb-4"},a.createElement("span",{className:"text-white text-3xl"},"�")),a.createElement("h3",{className:"text-2xl font-bold text-orange-900"},"Para Proveedores y Empresas"),a.createElement("p",{className:"text-orange-700"},"Únete a los 200+ proveedores de nuestra comunidad")),a.createElement("div",{className:"space-y-4 mb-8"},a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},a.createElement("span",{className:"text-white text-xs"},"✓")),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900"},"Acceso a Miles de Clientes"),a.createElement("p",{className:"text-gray-600 text-sm"},"Conecta con propietarios de vehículos que buscan servicios confiables"))),a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},a.createElement("span",{className:"text-white text-xs"},"✓")),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900"},"Presencia Digital Profesional"),a.createElement("p",{className:"text-gray-600 text-sm"},"Tu empresa visible en la mayor plataforma automotriz de la zona"))),a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},a.createElement("span",{className:"text-white text-xs"},"✓")),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900"},"Herramientas de Promoción"),a.createElement("p",{className:"text-gray-600 text-sm"},"Gestiona campañas y ofertas para aumentar tus ventas"))),a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},a.createElement("span",{className:"text-white text-xs"},"✓")),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900"},"Validación y Credibilidad"),a.createElement("p",{className:"text-gray-600 text-sm"},"Forma parte de proveedores verificados y de confianza"))),a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},a.createElement("span",{className:"text-white text-xs"},"✓")),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900"},"Red de Colaboración"),a.createElement("p",{className:"text-gray-600 text-sm"},"Conecta con otros proveedores y amplía tu red de negocios")))),a.createElement("div",{className:"space-y-3"},a.createElement("button",{onClick:()=>t("/registro-pyme"),className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-3 px-6 rounded-lg font-semibold transition-all transform hover:scale-105"},"� Registrar Mi Empresa"),a.createElement("button",{onClick:()=>t("/login?tipo=empresa"),className:"w-full bg-white border-2 border-orange-600 text-orange-600 py-3 px-6 rounded-lg font-semibold transition-all hover:bg-orange-50"},"🔑 Ya Tengo Cuenta - Ingresar"),a.createElement("button",{onClick:()=>t("/solicitud-comunidad"),className:"w-full bg-green-600 hover:bg-green-700 text-white py-3 px-6 rounded-lg font-semibold transition-all transform hover:scale-105"},"🤝 Unirse a la Comunidad"),a.createElement("button",{onClick:()=>t("/proveedores"),className:"w-full border-2 border-orange-600 text-orange-600 hover:bg-orange-600 hover:text-white py-3 px-6 rounded-lg font-semibold transition-all"},"� Ver Todos los Proveedores")))),a.createElement("div",{className:"mt-16 bg-gray-50 rounded-2xl p-8"},a.createElement("div",{className:"text-center mb-8"},a.createElement("h3",{className:"text-2xl font-bold text-gray-900 mb-2"},"Nuestra Red de Proveedores en Números"),a.createElement("p",{className:"text-gray-600"},"Únete a la mayor comunidad automotriz de la Av. 10 de Julio")),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-3xl font-bold text-blue-600 mb-2"},"2,500+"),a.createElement("div",{className:"text-gray-600 text-sm"},"Vehículos Registrados")),a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-3xl font-bold text-orange-600 mb-2"},"200+"),a.createElement("div",{className:"text-gray-600 text-sm"},"Proveedores Verificados")),a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-3xl font-bold text-green-600 mb-2"},"8,500+"),a.createElement("div",{className:"text-gray-600 text-sm"},"Conexiones Realizadas")),a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-3xl font-bold text-purple-600 mb-2"},"98%"),a.createElement("div",{className:"text-gray-600 text-sm"},"Satisfacción Cliente")))))))},Uz=({onResultsChange:t,placeholder:e="Buscar empresas, productos, campañas...",showFilters:n=!0})=>{const[r,s]=p.useState(""),[i,o]=p.useState(!1),[l,c]=p.useState({tipo:"todos",tipoEmpresa:"todos",categoria:"",marca:"",region:"",verificado:"todos"}),[u,d]=p.useState([]),[f,g]=p.useState([]),[v,x]=p.useState([]),[E,y]=p.useState([]),[h,C]=p.useState([]),[T,k]=p.useState([]);p.useEffect(()=>{const D=Dt(Q($,"empresas"),j=>{const V=j.docs.map(z=>({id:z.id,...z.data(),tipo:"empresa",origen:"legacy"}));d(V)});return()=>D()},[]),p.useEffect(()=>{const D=Dt(Q($,"productos"),j=>{const V=j.docs.map(z=>({id:z.id,...z.data(),tipo:"producto"}));g(V)});return()=>D()},[]),p.useEffect(()=>{const D=Dt(Q($,"campañas"),j=>{const V=j.docs.map(z=>({id:z.id,...z.data(),tipo:"campaña"}));x(V)});return()=>D()},[]),p.useEffect(()=>{const D=pe(Q($,"solicitudes_proveedor"),fe("estado","==","aprobada")),j=pe(Q($,"solicitudes_empresa"),fe("estado","==","aprobada")),V=Dt(D,G=>{const Y=G.docs.map(Z=>({id:Z.id,...Z.data(),tipo:"empresa",origen:"nuevo",tipoEmpresa:"proveedor"}));y(Z=>[...Z.filter(H=>H.origen!=="nuevo"||H.tipoEmpresa!=="proveedor"),...Y])}),z=Dt(j,G=>{const Y=G.docs.map(Z=>({id:Z.id,...Z.data(),tipo:"empresa",origen:"nuevo"}));y(Z=>[...Z.filter(H=>H.origen!=="nuevo"||H.tipoEmpresa==="proveedor"),...Y])});return()=>{V(),z()}},[]),p.useEffect(()=>{const D=new Set,j=new Set;u.forEach(V=>{V.categorias&&V.categorias.forEach(z=>D.add(z)),V.marcas&&V.marcas.forEach(z=>j.add(z))}),f.forEach(V=>{V.categoria&&D.add(V.categoria),V.marca&&j.add(V.marca)}),E.forEach(V=>{V.sectorAutomotriz&&D.add(V.sectorAutomotriz),V.marcasQueManeja&&V.marcasQueManeja.forEach(z=>j.add(z))}),C(Array.from(D).sort()),k(Array.from(j).sort())},[u,f,E]),p.useEffect(()=>{const D=_();t&&t(D)},[r,l,u,f,v,E]);const _=()=>{let D=[];const j=u.filter(G=>G.estado==="Activa").map(G=>S(G,"legacy")),V=E.map(G=>S(G,"nuevo")),z=[...j,...V];return(l.tipo==="todos"||l.tipo==="empresas")&&D.push(...z),(l.tipo==="todos"||l.tipo==="productos")&&D.push(...f.map(N)),(l.tipo==="todos"||l.tipo==="campañas")&&D.push(...v.map(b)),D=A(D),D},S=(D,j)=>({id:`empresa-${j}-${D.id}`,tipo:"empresa",titulo:D.nombre||D.nombreEmpresa,subtitulo:D.descripcion||D.giroComercial,descripcion:`${D.direccion||""}, ${D.comuna||""}`.trim().replace(/^,/,""),imagen:D.imagen||D.logo,tipoEmpresa:D.tipoEmpresa||w(D),verificado:D.verificado||j==="nuevo",premium:D.esPremium||!1,categorias:D.categorias||[D.sectorAutomotriz].filter(Boolean),marcas:D.marcas||D.marcasQueManeja||[],region:D.region,comuna:D.comuna,telefono:D.telefono,email:D.email,sitioWeb:D.sitioWeb,origen:j,fechaRegistro:D.fechaRegistro||D.fechaSolicitud,rating:D.rating||0,url:`/empresa/${D.id}`,searchText:`${D.nombre||D.nombreEmpresa} ${D.descripcion||D.giroComercial} ${D.direccion||""} ${(D.categorias||[]).join(" ")} ${(D.marcas||[]).join(" ")}`}),N=D=>({id:`producto-${D.id}`,tipo:"producto",titulo:D.nombre,subtitulo:D.marca,descripcion:D.descripcion,imagen:D.imagen,precio:D.precio,categoria:D.categoria,marca:D.marca,empresa:D.empresa,disponible:D.disponible,url:`/producto/${D.id}`,searchText:`${D.nombre} ${D.marca} ${D.descripcion} ${D.categoria} ${D.empresa}`}),b=D=>({id:`campaña-${D.id}`,tipo:"campaña",titulo:D.titulo,subtitulo:D.empresa,descripcion:D.descripcion,imagen:D.imagen,descuento:D.descuento,fechaInicio:D.fechaInicio,fechaFin:D.fechaFin,empresa:D.empresa,activa:new Date>=new Date(D.fechaInicio)&&new Date<=new Date(D.fechaFin),url:`/campaña/${D.id}`,searchText:`${D.titulo} ${D.descripcion} ${D.empresa}`}),w=D=>D.esPyme?"pyme":D.esEmprendimiento?"emprendimiento":D.esTaller?"taller":D.esDistribuidor?"distribuidor":"proveedor",A=D=>{let j=[...D];if(r.trim()){const V=r.toLowerCase().trim().split(" ");j=j.filter(z=>V.every(G=>z.searchText.toLowerCase().includes(G)))}return l.tipoEmpresa!=="todos"&&(j=j.filter(V=>V.tipo!=="empresa"||V.tipoEmpresa===l.tipoEmpresa)),l.categoria&&(j=j.filter(V=>V.tipo==="empresa"?V.categorias&&V.categorias.includes(l.categoria):V.tipo==="producto"?V.categoria===l.categoria:!0)),l.marca&&(j=j.filter(V=>V.tipo==="empresa"?V.marcas&&V.marcas.includes(l.marca):V.tipo==="producto"?V.marca===l.marca:!0)),l.region&&(j=j.filter(V=>V.tipo!=="empresa"||V.region===l.region)),l.verificado!=="todos"&&(j=j.filter(V=>V.tipo!=="empresa"?!0:l.verificado==="verificado"?V.verificado:l.verificado==="premium"?V.premium:!0)),j},R=D=>{s(D.target.value)},L=(D,j)=>{c(V=>({...V,[D]:j}))},M=()=>{s(""),c({tipo:"todos",tipoEmpresa:"todos",categoria:"",marca:"",region:"",verificado:"todos"}),o(!1)},F=[r,l.tipo!=="todos"?l.tipo:null,l.tipoEmpresa!=="todos"?l.tipoEmpresa:null,l.categoria,l.marca,l.region,l.verificado!=="todos"?l.verificado:null].filter(Boolean).length,U=[{label:"Frenos",tipo:"categoria"},{label:"Toyota",tipo:"marca"},{label:"Aceite",tipo:"categoria"},{label:"Baterías",tipo:"categoria"},{label:"Talleres",tipo:"tipoEmpresa",valor:"taller"},{label:"PyMEs",tipo:"tipoEmpresa",valor:"pyme"}];return a.createElement("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6 mb-8"},a.createElement("div",{className:"relative"},a.createElement("div",{className:"relative"},a.createElement(Dz,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),a.createElement("input",{type:"text",value:r,onChange:R,placeholder:e,className:"w-full pl-12 pr-24 py-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg"}),a.createElement("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center space-x-2"},F>0&&a.createElement("button",{onClick:M,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Limpiar filtros"},a.createElement(aT,{className:"h-5 w-5"})),n&&a.createElement("button",{onClick:()=>o(!i),className:`relative p-2 rounded-lg transition-colors ${i||F>0?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600"}`,title:"Filtros avanzados"},a.createElement(Iz,{className:"h-5 w-5"}),F>0&&a.createElement("span",{className:"absolute -top-1 -right-1 bg-blue-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},F)))),a.createElement("div",{className:"mt-4 flex flex-wrap gap-2 items-center"},a.createElement("span",{className:"text-sm text-gray-500"},"Búsquedas populares:"),U.map((D,j)=>a.createElement("button",{key:j,onClick:()=>{D.tipo==="categoria"||D.tipo==="marca"?s(D.label):D.tipo==="tipoEmpresa"&&L("tipoEmpresa",D.valor)},className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm rounded-full transition-colors"},D.label)))),i&&a.createElement("div",{className:"mt-6 pt-6 border-t border-gray-200"},a.createElement("div",{className:"grid md:grid-cols-3 lg:grid-cols-4 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tipo de contenido"),a.createElement("select",{value:l.tipo,onChange:D=>L("tipo",D.target.value),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},a.createElement("option",{value:"todos"},"Todo"),a.createElement("option",{value:"empresas"},"Empresas"),a.createElement("option",{value:"productos"},"Productos"),a.createElement("option",{value:"campañas"},"Campañas"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tipo de empresa"),a.createElement("select",{value:l.tipoEmpresa,onChange:D=>L("tipoEmpresa",D.target.value),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},a.createElement("option",{value:"todos"},"Todas"),a.createElement("option",{value:"proveedor"},"Proveedores"),a.createElement("option",{value:"pyme"},"PyMEs"),a.createElement("option",{value:"emprendimiento"},"Emprendimientos"),a.createElement("option",{value:"taller"},"Talleres"),a.createElement("option",{value:"distribuidor"},"Distribuidores"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Categoría"),a.createElement("select",{value:l.categoria,onChange:D=>L("categoria",D.target.value),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},a.createElement("option",{value:""},"Todas las categorías"),h.map(D=>a.createElement("option",{key:D,value:D},D)))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Marca"),a.createElement("select",{value:l.marca,onChange:D=>L("marca",D.target.value),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},a.createElement("option",{value:""},"Todas las marcas"),T.map(D=>a.createElement("option",{key:D,value:D},D)))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Verificación"),a.createElement("select",{value:l.verificado,onChange:D=>L("verificado",D.target.value),className:"w-full p-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},a.createElement("option",{value:"todos"},"Todas"),a.createElement("option",{value:"verificado"},"Solo verificadas"),a.createElement("option",{value:"premium"},"Solo premium"))))))};function $z(){const[t,e]=p.useState([]),[n,r]=p.useState(0);if(p.useEffect(()=>{const i=new Date,o=pe(Q($,"campanas"),fe("fechaInicio","<=",i),fe("fechaFin",">=",i));return Dt(o,c=>{e(c.docs.map(u=>({id:u.id,...u.data()})))})},[]),p.useEffect(()=>{if(t.length<=1)return;const i=setInterval(()=>r(o=>(o+1)%t.length),1e4);return()=>clearInterval(i)},[t]),t.length===0)return null;const s=t[n];return a.createElement("div",{className:"bg-yellow-100 border border-yellow-300 p-3 mb-6 rounded flex items-center justify-between shadow"},a.createElement("a",{href:s.link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-4 w-full"},a.createElement("img",{src:s.imagenURL,alt:s.titulo,className:"h-16 w-32 object-contain rounded"}),a.createElement("div",null,a.createElement("h3",{className:"font-bold"},s.titulo),a.createElement("p",{className:"text-sm"},s.descripcion))))}const Fw=()=>a.createElement("div",{className:"min-h-screen bg-gray-50"},a.createElement(zz,null),a.createElement("div",{className:"bg-white shadow-sm border-b border-gray-200"},a.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},a.createElement(Uz,null))),a.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"},a.createElement("div",{className:"text-center mb-12"},a.createElement("h2",{className:"text-3xl font-bold text-gray-900 mb-4"},"Servicios Automotrices"),a.createElement("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto"},"Encuentra todo lo que necesitas para tu vehículo en un solo lugar")),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8"},a.createElement("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow"},a.createElement("div",{className:"flex items-center justify-center w-12 h-12 bg-blue-100 rounded-lg mb-4"},a.createElement("span",{className:"text-2xl"},"🛡️")),a.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-2"},"Seguros"),a.createElement("p",{className:"text-gray-600 mb-4"},"Protege tu vehículo con los mejores seguros"),a.createElement("a",{href:"/servicios/seguros",className:"text-blue-600 hover:text-blue-800 font-medium"},"Ver más →")),a.createElement("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow"},a.createElement("div",{className:"flex items-center justify-center w-12 h-12 bg-green-100 rounded-lg mb-4"},a.createElement("span",{className:"text-2xl"},"🔧")),a.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-2"},"Revisión Técnica"),a.createElement("p",{className:"text-gray-600 mb-4"},"Agenda tu revisión técnica fácil y rápido"),a.createElement("a",{href:"/servicios/revision-tecnica",className:"text-blue-600 hover:text-blue-800 font-medium"},"Ver más →")),a.createElement("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow"},a.createElement("div",{className:"flex items-center justify-center w-12 h-12 bg-orange-100 rounded-lg mb-4"},a.createElement("span",{className:"text-2xl"},"🏁")),a.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-2"},"Vulcanizaciones"),a.createElement("p",{className:"text-gray-600 mb-4"},"Servicio de neumáticos y reparaciones"),a.createElement("a",{href:"/servicios/vulcanizaciones",className:"text-blue-600 hover:text-blue-800 font-medium"},"Ver más →")),a.createElement("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow"},a.createElement("div",{className:"flex items-center justify-center w-12 h-12 bg-green-100 rounded-lg mb-4"},a.createElement("span",{className:"text-2xl"},"♻️")),a.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-2"},"Reciclaje"),a.createElement("p",{className:"text-gray-600 mb-4"},"Programa de reciclaje automotriz"),a.createElement("a",{href:"/servicios/reciclaje",className:"text-blue-600 hover:text-blue-800 font-medium"},"Ver más →")))),a.createElement("div",{className:"bg-gray-100 py-8"},a.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},a.createElement($z,null))),a.createElement("div",{className:"bg-blue-600 py-16"},a.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center"},a.createElement("h2",{className:"text-3xl font-bold text-white mb-4"},"¿Eres una empresa automotriz?"),a.createElement("p",{className:"text-xl text-blue-100 mb-8 max-w-2xl mx-auto"},"Únete a nuestra comunidad y conecta con miles de clientes"),a.createElement("div",{className:"space-x-4"},a.createElement("a",{href:"/solicitud-comunidad",className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-blue-600 bg-white hover:bg-gray-50"},"Unirse a la Comunidad"),a.createElement("a",{href:"/registro-proveedor",className:"inline-flex items-center px-6 py-3 border border-white text-base font-medium rounded-md text-white hover:bg-blue-700"},"Registrar Empresa")))),a.createElement("footer",{className:"bg-gray-800 text-white py-8"},a.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8"},a.createElement("div",null,a.createElement("h3",{className:"text-lg font-semibold mb-4"},"AV10 de Julio"),a.createElement("p",{className:"text-gray-300"},"La plataforma automotriz más completa de Chile")),a.createElement("div",null,a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Enlaces"),a.createElement("ul",{className:"space-y-2 text-gray-300"},a.createElement("li",null,a.createElement("a",{href:"/contacto",className:"hover:text-white"},"Contacto")),a.createElement("li",null,a.createElement("a",{href:"/recursos-educativos",className:"hover:text-white"},"Recursos")),a.createElement("li",null,a.createElement("a",{href:"/faq",className:"hover:text-white"},"FAQ")))),a.createElement("div",null,a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Para Empresas"),a.createElement("ul",{className:"space-y-2 text-gray-300"},a.createElement("li",null,a.createElement("a",{href:"/proveedores-locales",className:"hover:text-white"},"Proveedores")),a.createElement("li",null,a.createElement("a",{href:"/registro-proveedor",className:"hover:text-white"},"Registro")),a.createElement("li",null,a.createElement("a",{href:"/login",className:"hover:text-white"},"Acceso"))))),a.createElement("div",{className:"border-t border-gray-700 mt-8 pt-8 text-center text-gray-300"},a.createElement("p",null,"© 2025 AV10 de Julio. Todos los derechos reservados.")))));/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Bz(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(f){o(f)}}function c(d){try{u(r.throw(d))}catch(f){o(f)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})}function qz(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(d){u=[6,d],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ro=function(){return ro=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ro.apply(this,arguments)},sT=function(t){return{loading:t==null,value:t}},Wz=function(){return function(t,e){switch(e.type){case"error":return ro(ro({},t),{error:e.error,loading:!1,value:void 0});case"reset":return sT(e.defaultValue);case"value":return ro(ro({},t),{error:void 0,loading:!1,value:e.value});default:return t}}},Hz=function(t){var e=t?t():void 0,n=p.useReducer(Wz(),sT(e)),r=n[0],s=n[1],i=p.useCallback(function(){var c=t?t():void 0;s({type:"reset",defaultValue:c})},[t]),o=p.useCallback(function(c){s({type:"error",error:c})},[]),l=p.useCallback(function(c){s({type:"value",value:c})},[]);return p.useMemo(function(){return{error:r.error,loading:r.loading,reset:i,setError:o,setValue:l,value:r.value}},[r.error,r.loading,i,o,l,r.value])},Gz=function(t,e){var n=Hz(function(){return t.currentUser}),r=n.error,s=n.loading,i=n.setError,o=n.setValue,l=n.value;return p.useEffect(function(){var c=ab(t,function(u){return Bz(void 0,void 0,void 0,function(){var d;return qz(this,function(f){switch(f.label){case 0:if(!(e!=null&&e.onUserChanged))return[3,4];f.label=1;case 1:return f.trys.push([1,3,,4]),[4,e.onUserChanged(u)];case 2:return f.sent(),[3,4];case 3:return d=f.sent(),i(d),[3,4];case 4:return o(u),[2]}})})},i);return function(){c()}},[t]),[l,s,r]};function Kz(){const[t,e]=p.useState(""),[n,r]=p.useState(""),[s,i]=p.useState(""),[o,l]=p.useState(""),c=ft(),u=lr(),[d,f]=Gz(Fn),v=new URLSearchParams(u.search).get("tipo"),x=async C=>{try{const T=pe(Q($,"agentes"),fe("email","==",C),fe("requiere_registro","==",!0));return!(await ue(T)).empty}catch(T){return console.error("Error verificando agente:",T),!1}},E=async C=>{try{const T=pe(Q($,"agentes"),fe("email","==",C),fe("requiere_registro","==",!1));return!(await ue(T)).empty}catch(T){return console.error("Error verificando agente registrado:",T),!1}};async function y(C){C.preventDefault(),i("");try{const T=await zk(Fn,t,n),k=await di(we($,"usuarios",T.user.uid));let _="";k.exists()&&(_=k.data().rol),c(_==="admin"?"/admin":_==="agente"?"/agente":_==="proveedor"||v==="proveedor"||o==="proveedor"?"/dashboard/proveedor":_==="cliente"||v==="cliente"||o==="cliente"?"/dashboard/cliente":"/")}catch(T){if(console.error("Error en login:",T),T.code==="auth/user-not-found"||T.code==="auth/invalid-email"||T.code==="auth/wrong-password"||T.code==="auth/invalid-credential"){const k=await x(t),_=await E(t);i(k?a.createElement("div",{className:"text-left"},a.createElement("p",{className:"font-semibold text-blue-600 mb-2"},"🔑 ¿Eres un agente nuevo?"),a.createElement("p",{className:"text-sm mb-3"},"Tienes credenciales de agente pero no has completado el registro inicial."),a.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Usa las credenciales que te proporcionó el administrador."),a.createElement("button",{onClick:()=>c("/registro-agente"),className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Completar Registro de Agente")):_?a.createElement("div",{className:"text-left"},a.createElement("p",{className:"font-semibold text-orange-600 mb-2"},"🔐 Agente registrado"),a.createElement("p",{className:"text-sm mb-3"},"Eres un agente del sistema pero la contraseña es incorrecta."),a.createElement("p",{className:"text-sm text-gray-600"},"Verifica tu contraseña o contacta al administrador.")):"Credenciales incorrectas. Verifica tu email y contraseña.")}else i("Error de conexión. Intenta nuevamente.")}}async function h(){await FM(Fn),i(""),e(""),r("")}return f?a.createElement("div",{className:"flex items-center justify-center min-h-screen"},"Cargando..."):d?a.createElement("div",{className:"flex flex-col items-center justify-center min-h-screen"},a.createElement("div",{className:"bg-white p-6 rounded shadow w-80 text-center"},a.createElement("h2",{className:"text-xl font-bold mb-4"},"Ya has iniciado sesión"),a.createElement("p",{className:"mb-4"},"Usuario actual: ",a.createElement("b",null,d.email)),a.createElement("button",{onClick:h,className:"w-full bg-red-600 text-white py-2 rounded mb-2"},"Cerrar sesión"),a.createElement("button",{type:"button",onClick:()=>c("/"),className:"w-full text-blue-700 underline"},"Ir al inicio"))):a.createElement("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50"},a.createElement("div",{className:"w-full max-w-md"},!v&&a.createElement("div",{className:"bg-white p-6 rounded-lg shadow-lg mb-6"},a.createElement("h3",{className:"text-lg font-semibold text-center mb-4"},"¿Qué tipo de usuario eres?"),a.createElement("div",{className:"grid grid-cols-2 gap-4"},a.createElement("button",{onClick:()=>l("cliente"),className:`p-4 rounded-lg border-2 transition-colors ${o==="cliente"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-blue-300"}`},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-3xl mb-2"},"🚗"),a.createElement("div",{className:"font-medium"},"Cliente"),a.createElement("div",{className:"text-sm text-gray-600"},"Tengo un vehículo"))),a.createElement("button",{onClick:()=>l("proveedor"),className:`p-4 rounded-lg border-2 transition-colors ${o==="proveedor"?"border-green-500 bg-green-50 text-green-700":"border-gray-200 hover:border-green-300"}`},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-3xl mb-2"},"🏪"),a.createElement("div",{className:"font-medium"},"Proveedor"),a.createElement("div",{className:"text-sm text-gray-600"},"Tengo un negocio"))))),a.createElement("form",{onSubmit:y,className:"bg-white p-6 rounded-lg shadow-lg"},a.createElement("div",{className:"text-center mb-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"Iniciar sesión",(v||o)&&a.createElement("span",{className:"block text-sm font-normal text-gray-600 mt-1"},"como ",v||o))),s&&a.createElement("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4"},s),a.createElement("div",{className:"space-y-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Correo electrónico"),a.createElement("input",{type:"email",required:!0,placeholder:"tu@email.com",value:t,onChange:C=>e(C.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña"),a.createElement("input",{type:"password",required:!0,placeholder:"••••••••",value:n,onChange:C=>r(C.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}))),a.createElement("button",{type:"submit",className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors mt-6"},"Iniciar sesión"),a.createElement("div",{className:"mt-6 text-center space-y-3"},a.createElement("div",{className:"text-sm text-gray-600"},"¿No tienes cuenta?"),a.createElement("div",{className:"flex space-x-4"},a.createElement("button",{type:"button",onClick:()=>c("/registro-cliente"),className:"flex-1 bg-blue-100 text-blue-700 py-2 px-4 rounded-lg hover:bg-blue-200 transition-colors text-sm"},"🚗 Registro Cliente"),a.createElement("button",{type:"button",onClick:()=>c("/registro-proveedor"),className:"flex-1 bg-green-100 text-green-700 py-2 px-4 rounded-lg hover:bg-green-200 transition-colors text-sm"},"🏪 Registro Proveedor")),a.createElement("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg"},a.createElement("div",{className:"text-sm text-yellow-700 mb-2"},a.createElement("strong",null,"¿Eres un agente de la empresa?")),a.createElement("div",{className:"flex space-x-2"},a.createElement("button",{type:"button",onClick:()=>c("/registro-agente"),className:"flex-1 bg-yellow-600 text-white py-2 px-4 rounded-lg hover:bg-yellow-700 transition-colors text-sm"},"👤 Registro de Agente"),a.createElement("button",{type:"button",onClick:()=>c("/ayuda-agentes"),className:"bg-yellow-100 text-yellow-700 py-2 px-4 rounded-lg hover:bg-yellow-200 transition-colors text-sm"},"🆘 Ayuda")),a.createElement("div",{className:"text-xs text-yellow-600 mt-1"},"Usa las credenciales proporcionadas por el administrador")),a.createElement("button",{type:"button",onClick:()=>c("/"),className:"text-gray-500 hover:text-gray-700 underline text-sm"},"Volver al inicio")))))}const zw=[{to:"",label:"🏠 Panel Principal",icon:"🏠",section:"main"},{to:"servicios/seguros",label:"🛡️ Seguros",icon:"🛡️",section:"servicios"},{to:"servicios/revision-tecnica",label:"🔧 Revisión Técnica",icon:"🔧",section:"servicios"},{to:"servicios/vulcanizaciones",label:"🏁 Vulcanizaciones",icon:"🏁",section:"servicios"},{to:"servicios/reciclaje",label:"♻️ Reciclaje",icon:"♻️",section:"servicios"},{to:"recordatorios",label:"🔔 Mis Recordatorios",icon:"🔔",section:"servicios"},{to:"solicitudes-registro",label:"📋 Solicitudes de Registro",icon:"📋",section:"admin"},{to:"empresas",label:"🏢 Empresas Registradas",icon:"🏢",section:"admin"},{to:"solicitudes-cliente",label:"� Solicitudes de Clientes",icon:"�",section:"admin"},{to:"validacion-clientes",label:"✅ Validación de Clientes",icon:"✅",section:"admin"},{to:"solicitudes-comunidad",label:"🤝 Solicitudes de Comunidad",icon:"🤝",section:"admin"},{to:"marcas",label:"🏷️ Gestión de Marcas",icon:"🏷️",section:"admin"},{to:"tipos-empresa",label:"🏢 Tipos de Empresa",icon:"🏢",section:"admin"},{to:"categorias",label:"� Gestión de Categorías",icon:"�",section:"admin"},{to:"moderacion-reseñas",label:"⭐ Moderación Reseñas",icon:"⭐",section:"admin"},{to:"gestion-tickets",label:"🎫 Gestión de Tickets",icon:"🎫",section:"admin"},{to:"notificaciones",label:"📱 Notificaciones Push",icon:"📱",section:"admin"},{to:"estadisticas",label:"� Panel de Estadísticas",icon:"�",section:"admin"},{to:"recursos-educativos",label:"� Recursos Educativos",icon:"�",section:"admin"},{to:"configuracion-sistema",label:"⚙️ Configuración Sistema",icon:"⚙️",section:"admin"},{to:"catastro-masivo",label:"📊 Catastro Masivo",icon:"📊",section:"catastro"},{to:"panel-validacion",label:"🔍 Panel de Validación",icon:"🔍",section:"catastro"},{to:"agentes-campo",label:"👥 Agentes de Campo",icon:"👥",section:"catastro"},{to:"gestion-agentes",label:"🔑 Gestión de Agentes",icon:"🔑",section:"catastro"}],Qz=[{to:"/proveedor",label:"Panel",icon:"📊"},{to:"/proveedor/mi-empresa",label:"Mi Empresa",icon:"🏢"},{to:"/proveedor/solicitar-campana",label:"Solicitar Campaña",icon:"📢"},{to:"/proveedor/solicitar-producto",label:"Solicitar Producto",icon:"📦"}];function Jz({rol:t}){const e=lr(),n=ft(),[r,s]=p.useState(!1),i=t==="admin"?zw:Qz,o=e.pathname.startsWith("/admin"),l=f=>{const g={};return f.forEach(v=>{const x=v.section||"default";g[x]||(g[x]=[]),g[x].push(v)}),g},c={main:"PANEL PRINCIPAL",servicios:"SERVICIOS",admin:"ADMINISTRACIÓN",catastro:"CATASTRO"},u=()=>{s(!r)},d=f=>{n(t==="admin"&&o?f===""?"/admin":`/admin/${f}`:f)};return a.createElement("aside",{className:`bg-blue-900 text-white min-h-screen flex-shrink-0 overflow-y-auto transition-all duration-300 ${r?"w-16":"w-64"}`},a.createElement("div",{className:`p-4 border-b border-blue-800 flex items-center justify-between ${r?"px-2":""}`},!r&&a.createElement("div",{className:"text-xl font-bold tracking-wider"},"🚗 AV10 de Julio",a.createElement("div",{className:"text-xs font-normal text-blue-200 mt-1"},"Panel de Administración")),a.createElement("button",{onClick:u,className:"text-white hover:bg-blue-800 p-2 rounded-lg transition-colors",title:r?"Expandir menú":"Contraer menú"},r?"☰":"◀")),a.createElement("nav",{className:"mt-4"},t==="admin"?Object.entries(l(zw)).map(([f,g])=>a.createElement("div",{key:f,className:"mb-4"},f!=="main"&&!r&&a.createElement("div",{className:"px-4 py-2 text-xs font-semibold text-blue-200 uppercase tracking-wider border-t border-blue-800 mt-4 pt-4"},c[f]),a.createElement("div",{className:"flex flex-col gap-1"},g.map(v=>{const x=o?v.to===""?"/admin":`/admin/${v.to}`:v.to,E=e.pathname===x;return a.createElement("button",{key:v.to,onClick:()=>d(v.to),className:`w-full px-4 py-2 mx-2 hover:bg-blue-800 rounded-lg transition-all text-sm flex items-center gap-3 ${E?"bg-blue-800 font-semibold border-l-4 border-blue-300":"hover:border-l-4 hover:border-blue-400"} ${r?"justify-center px-2":""}`,title:r?v.label:""},a.createElement("span",{className:"text-lg"},v.icon),!r&&a.createElement("span",{className:"text-left"},v.label.replace(v.icon,"").trim()))})))):a.createElement("div",{className:"flex flex-col gap-1 mt-4"},i.map(f=>{const g=e.pathname===f.to;return a.createElement("button",{key:f.to,onClick:()=>n(f.to),className:`w-full px-4 py-2 mx-2 hover:bg-blue-800 rounded-lg transition-all flex items-center gap-3 ${g?"bg-blue-800 font-semibold":""} ${r?"justify-center px-2":""}`,title:r?f.label:""},a.createElement("span",{className:"text-lg"},f.icon),!r&&a.createElement("span",{className:"text-left"},f.label))}))))}function Yz(){const{user:t,rol:e}=Qe();return ft(),a.createElement("header",{className:"flex items-center justify-between bg-blue-50 border-b px-8 h-16"},a.createElement("div",{className:"font-bold text-blue-900 text-lg"},"Panel ",e==="admin"?"Administrador":"Proveedor"),a.createElement("div",{className:"flex items-center gap-4"},a.createElement("span",{className:"text-blue-800"},t==null?void 0:t.email)))}function Zz(){var x,E;const{user:t,rol:e,logout:n}=Qe(),r=ft(),s=lr(),[i,o]=p.useState(!1),[l,c]=p.useState([]);p.useEffect(()=>{o(!1)},[s.pathname]);const u=()=>{o(!i)},d=async()=>{try{await n(),r("/login")}catch(y){console.error("Error al cerrar sesión:",y)}},f=()=>{const y=[{path:"/",label:"Inicio",icon:"home"},{path:"/productos",label:"Productos",icon:"shopping-bag"},{path:"/contacto",label:"Contacto",icon:"phone"}];if(!t)return[...y,{path:"/login",label:"Iniciar Sesión",icon:"log-in"},{path:"/registro-cliente",label:"Registro Cliente",icon:"user-plus"},{path:"/registro-proveedor",label:"Registro Proveedor",icon:"building"}];const h={admin:[{path:"/admin",label:"Panel Admin",icon:"settings"},{path:"/admin/empresas",label:"Empresas",icon:"building"},{path:"/admin/solicitudes-cliente",label:"Solicitudes Cliente",icon:"users"},{path:"/admin/agentes-campo",label:"Agentes",icon:"map-pin"}],cliente:[{path:"/dashboard/cliente",label:"Mi Dashboard",icon:"home"},{path:"/vehiculos/gestionar",label:"Mis Vehículos",icon:"truck"},{path:"/status-cliente",label:"Mi Estado",icon:"check-circle"}],proveedor:[{path:"/dashboard/proveedor",label:"Mi Dashboard",icon:"home"},{path:"/proveedores/mi-empresa",label:"Mi Empresa",icon:"building"},{path:"/clientes-area",label:"Clientes del Área",icon:"users"},{path:"/proveedores/solicitar-campana",label:"Nueva Campaña",icon:"megaphone"}],agente:[{path:"/dashboard/agente",label:"Panel Agente",icon:"map-pin"},{path:"/dashboard/agente",label:"Empresas Asignadas",icon:"building"}]};return[...y,...h[e]||[]]},g=()=>({"/":"AV10 de Julio","/admin":"Panel Administrativo","/dashboard/cliente":"Dashboard Cliente","/dashboard/proveedor":"Dashboard Proveedor","/dashboard/agente":"Panel Agente","/vehiculos/gestionar":"Mis Vehículos","/productos":"Productos","/contacto":"Contacto"})[s.pathname]||"AV10 de Julio",v=(y,h="w-5 h-5")=>{const C={home:a.createElement("svg",{className:h,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})),users:a.createElement("svg",{className:h,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})),building:a.createElement("svg",{className:h,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})),truck:a.createElement("svg",{className:h,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})),"map-pin":a.createElement("svg",{className:h,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})),settings:a.createElement("svg",{className:h,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})),"shopping-bag":a.createElement("svg",{className:h,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l-1 12H6L5 9z"})),phone:a.createElement("svg",{className:h,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})),"log-in":a.createElement("svg",{className:h,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})),"user-plus":a.createElement("svg",{className:h,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})),"check-circle":a.createElement("svg",{className:h,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})),megaphone:a.createElement("svg",{className:h,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"})),"log-out":a.createElement("svg",{className:h,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})),bell:a.createElement("svg",{className:h,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-5 5v-5zM9.586 17H3l6.586-6.586a2 2 0 010-2.828l6.414-6.414a2 2 0 012.828 0l2.586 2.586a2 2 0 010 2.828L15 13.414V17z"}))};return C[y]||C.home};return a.createElement(a.Fragment,null,a.createElement("header",{className:"header-mobile bg-white border-b border-gray-200 fixed top-0 left-0 right-0 z-50"},a.createElement("div",{className:"flex items-center justify-between h-full"},a.createElement("button",{onClick:u,className:`hamburger ${i?"open":""}`,"aria-label":"Abrir menú"},a.createElement("span",null),a.createElement("span",null),a.createElement("span",null)),a.createElement("div",{className:"flex items-center space-x-3"},a.createElement("img",{src:"/logo192.png",alt:"AV10 de Julio",className:"h-8 w-8"}),a.createElement("h1",{className:"text-lg font-semibold text-gray-900 truncate"},g())),a.createElement("div",{className:"flex items-center space-x-2"},t&&a.createElement(a.Fragment,null,a.createElement("button",{className:"p-2 text-gray-600 hover:text-gray-900 relative"},v("bell","w-5 h-5"),l.length>0&&a.createElement("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center"},l.length>9?"9+":l.length)),a.createElement("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center text-sm font-medium"},(x=t.email)==null?void 0:x.charAt(0).toUpperCase()))))),a.createElement("div",{className:`sidebar-overlay ${i?"visible":""}`,onClick:()=>o(!1)}),a.createElement("nav",{className:`sidebar-mobile ${i?"open":""}`},a.createElement("div",{className:"p-4"},a.createElement("div",{className:"flex items-center justify-between mb-6"},a.createElement("div",{className:"flex items-center space-x-3"},a.createElement("img",{src:"/logo192.png",alt:"AV10 de Julio",className:"h-8 w-8"}),a.createElement("span",{className:"text-lg font-bold text-gray-900"},"AV10 de Julio")),a.createElement("button",{onClick:()=>o(!1),className:"p-1 text-gray-500 hover:text-gray-700"},a.createElement("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})))),t&&a.createElement("div",{className:"bg-gray-50 rounded-lg p-4 mb-6"},a.createElement("div",{className:"flex items-center space-x-3"},a.createElement("div",{className:"w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center text-sm font-medium"},(E=t.email)==null?void 0:E.charAt(0).toUpperCase()),a.createElement("div",{className:"flex-1 min-w-0"},a.createElement("p",{className:"text-sm font-medium text-gray-900 truncate"},t.email),a.createElement("p",{className:"text-xs text-gray-500 capitalize"},e)))),a.createElement("div",{className:"space-y-2"},f().map((y,h)=>a.createElement("button",{key:h,onClick:()=>{r(y.path),o(!1)},className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors ${s.pathname===y.path?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100"}`},v(y.icon),a.createElement("span",{className:"font-medium"},y.label)))),t&&a.createElement("div",{className:"mt-6 pt-6 border-t border-gray-200"},a.createElement("button",{onClick:d,className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left text-red-600 hover:bg-red-50 transition-colors"},v("log-out"),a.createElement("span",{className:"font-medium"},"Cerrar Sesión"))))),a.createElement("div",{className:"h-16 md:hidden"}))}function xu({children:t}){const{rol:e}=Qe();return a.createElement(a.Fragment,null,a.createElement("div",{className:"md:hidden"},a.createElement(Zz,null)),a.createElement("div",{className:"flex min-h-screen"},a.createElement("div",{className:"hidden md:block"},a.createElement(Jz,{rol:e})),a.createElement("div",{className:"flex-1 flex flex-col bg-blue-50"},a.createElement("div",{className:"hidden md:block"},a.createElement(Yz,null)),a.createElement("main",{className:"flex-1 p-4 md:p-8 pt-4 md:pt-8"},t))))}var iT={exports:{}},Qp={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xz=p,eU=Symbol.for("react.element"),tU=Symbol.for("react.fragment"),nU=Object.prototype.hasOwnProperty,rU=Xz.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,aU={key:!0,ref:!0,__self:!0,__source:!0};function oT(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)nU.call(e,r)&&!aU.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:eU,type:t,key:i,ref:o,props:s,_owner:rU.current}}Qp.Fragment=tU;Qp.jsx=oT;Qp.jsxs=oT;iT.exports=Qp;var Nn=iT.exports;function Gc(t){"@babel/helpers - typeof";return Gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gc(t)}function sU(t,e){if(Gc(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Gc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iU(t){var e=sU(t,"string");return Gc(e)=="symbol"?e:e+""}function X(t,e,n){return(e=iU(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ah,Uw;function oU(){if(Uw)return ah;Uw=1;var t=function(n,r,s,i,o,l,c,u){if(!n){var d;if(r===void 0)d=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var f=[s,i,o,l,c,u],g=0;d=new Error(r.replace(/%s/g,function(){return f[g++]})),d.name="Invariant Violation"}throw d.framesToPop=1,d}};return ah=t,ah}var lU=oU(),Ht=lT(lU),Ve=p.createContext(null);function cU(){Ht(!!p.useContext,"useGoogleMap is React hook and requires React version 16.8+");var t=p.useContext(Ve);return Ht(!!t,"useGoogleMap needs a GoogleMap available up in the tree"),t}function uU(t,e,n){return Object.keys(t).reduce(function(s,i){return e(s,t[i],i)},n)}function dU(t,e){Object.keys(t).forEach(n=>e(t[n],n))}function mU(t,e,n,r){var s={},i=(o,l)=>{var c=n[l];c!==e[l]&&(s[l]=c,o(r,c))};return dU(t,i),s}function pU(t,e,n){var r=uU(n,function(i,o,l){return typeof t[l]=="function"&&i.push(google.maps.event.addListener(e,o,t[l])),i},[]);return r}function fU(t){google.maps.event.removeListener(t)}function $e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];t.forEach(fU)}function Fe(t){var{updaterMap:e,eventMap:n,prevProps:r,nextProps:s,instance:i}=t,o=pU(s,i,n);return mU(e,r,s,i),o}var $w={onDblClick:"dblclick",onDragEnd:"dragend",onDragStart:"dragstart",onMapTypeIdChanged:"maptypeid_changed",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseDown:"mousedown",onMouseUp:"mouseup",onRightClick:"rightclick",onTilesLoaded:"tilesloaded",onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onDrag:"drag",onHeadingChanged:"heading_changed",onIdle:"idle",onProjectionChanged:"projection_changed",onResize:"resize",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed"},Bw={extraMapTypes(t,e){e.forEach(function(r,s){t.mapTypes.set(String(s),r)})},center(t,e){t.setCenter(e)},clickableIcons(t,e){t.setClickableIcons(e)},heading(t,e){t.setHeading(e)},mapTypeId(t,e){t.setMapTypeId(e)},options(t,e){t.setOptions(e)},streetView(t,e){t.setStreetView(e)},tilt(t,e){t.setTilt(e)},zoom(t,e){t.setZoom(e)}};function hU(t){var{children:e,options:n,id:r,mapContainerStyle:s,mapContainerClassName:i,center:o,onClick:l,onDblClick:c,onDrag:u,onDragEnd:d,onDragStart:f,onMouseMove:g,onMouseOut:v,onMouseOver:x,onMouseDown:E,onMouseUp:y,onRightClick:h,onCenterChanged:C,onLoad:T,onUnmount:k}=t,[_,S]=p.useState(null),N=p.useRef(null),[b,w]=p.useState(null),[A,R]=p.useState(null),[L,M]=p.useState(null),[F,U]=p.useState(null),[D,j]=p.useState(null),[V,z]=p.useState(null),[G,Y]=p.useState(null),[Z,H]=p.useState(null),[oe,W]=p.useState(null),[he,xe]=p.useState(null),[ie,be]=p.useState(null),[ne,re]=p.useState(null);return p.useEffect(()=>{n&&_!==null&&_.setOptions(n)},[_,n]),p.useEffect(()=>{_!==null&&typeof o<"u"&&_.setCenter(o)},[_,o]),p.useEffect(()=>{_&&c&&(A!==null&&google.maps.event.removeListener(A),R(google.maps.event.addListener(_,"dblclick",c)))},[c]),p.useEffect(()=>{_&&d&&(L!==null&&google.maps.event.removeListener(L),M(google.maps.event.addListener(_,"dragend",d)))},[d]),p.useEffect(()=>{_&&f&&(F!==null&&google.maps.event.removeListener(F),U(google.maps.event.addListener(_,"dragstart",f)))},[f]),p.useEffect(()=>{_&&E&&(D!==null&&google.maps.event.removeListener(D),j(google.maps.event.addListener(_,"mousedown",E)))},[E]),p.useEffect(()=>{_&&g&&(V!==null&&google.maps.event.removeListener(V),z(google.maps.event.addListener(_,"mousemove",g)))},[g]),p.useEffect(()=>{_&&v&&(G!==null&&google.maps.event.removeListener(G),Y(google.maps.event.addListener(_,"mouseout",v)))},[v]),p.useEffect(()=>{_&&x&&(Z!==null&&google.maps.event.removeListener(Z),H(google.maps.event.addListener(_,"mouseover",x)))},[x]),p.useEffect(()=>{_&&y&&(oe!==null&&google.maps.event.removeListener(oe),W(google.maps.event.addListener(_,"mouseup",y)))},[y]),p.useEffect(()=>{_&&h&&(he!==null&&google.maps.event.removeListener(he),xe(google.maps.event.addListener(_,"rightclick",h)))},[h]),p.useEffect(()=>{_&&l&&(ie!==null&&google.maps.event.removeListener(ie),be(google.maps.event.addListener(_,"click",l)))},[l]),p.useEffect(()=>{_&&u&&(ne!==null&&google.maps.event.removeListener(ne),re(google.maps.event.addListener(_,"drag",u)))},[u]),p.useEffect(()=>{_&&C&&(b!==null&&google.maps.event.removeListener(b),w(google.maps.event.addListener(_,"center_changed",C)))},[l]),p.useEffect(()=>{var Se=N.current===null?null:new google.maps.Map(N.current,n);return S(Se),Se!==null&&T&&T(Se),()=>{Se!==null&&k&&k(Se)}},[]),Nn.jsx("div",{id:r,ref:N,style:s,className:i,children:Nn.jsx(Ve.Provider,{value:_,children:_!==null?e:null})})}p.memo(hU);class gU extends p.PureComponent{constructor(){super(...arguments),X(this,"state",{map:null}),X(this,"registeredEvents",[]),X(this,"mapRef",null),X(this,"getInstance",()=>this.mapRef===null?null:new google.maps.Map(this.mapRef,this.props.options)),X(this,"panTo",e=>{var n=this.getInstance();n&&n.panTo(e)}),X(this,"setMapCallback",()=>{this.state.map!==null&&this.props.onLoad&&this.props.onLoad(this.state.map)}),X(this,"getRef",e=>{this.mapRef=e})}componentDidMount(){var e=this.getInstance();this.registeredEvents=Fe({updaterMap:Bw,eventMap:$w,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{map:e}},this.setMapCallback)}componentDidUpdate(e){this.state.map!==null&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:Bw,eventMap:$w,prevProps:e,nextProps:this.props,instance:this.state.map}))}componentWillUnmount(){this.state.map!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.map),$e(this.registeredEvents))}render(){return Nn.jsx("div",{id:this.props.id,ref:this.getRef,style:this.props.mapContainerStyle,className:this.props.mapContainerClassName,children:Nn.jsx(Ve.Provider,{value:this.state.map,children:this.state.map!==null?this.props.children:null})})}}function qw(t,e,n,r,s,i,o){try{var l=t[i](o),c=l.value}catch(u){return void n(u)}l.done?e(c):Promise.resolve(c).then(r,s)}function cT(t){return function(){var e=this,n=arguments;return new Promise(function(r,s){var i=t.apply(e,n);function o(c){qw(i,r,s,o,l,"next",c)}function l(c){qw(i,r,s,o,l,"throw",c)}o(void 0)})}}function uT(t){var{googleMapsApiKey:e,googleMapsClientId:n,version:r="weekly",language:s,region:i,libraries:o,channel:l,mapIds:c,authReferrerPolicy:u,apiUrl:d="https://maps.googleapis.com"}=t,f=[];return Ht(e&&n||!(e&&n),"You need to specify either googleMapsApiKey or googleMapsClientId for @react-google-maps/api load script to work. You cannot use both at the same time."),e?f.push("key=".concat(e)):n&&f.push("client=".concat(n)),r&&f.push("v=".concat(r)),s&&f.push("language=".concat(s)),i&&f.push("region=".concat(i)),o&&o.length&&f.push("libraries=".concat(o.sort().join(","))),l&&f.push("channel=".concat(l)),c&&c.length&&f.push("map_ids=".concat(c.join(","))),u&&f.push("auth_referrer_policy=".concat(u)),f.push("loading=async"),f.push("callback=initMap"),"".concat(d,"/maps/api/js?").concat(f.join("&"))}var Ws=typeof document<"u";function dT(t){var{url:e,id:n,nonce:r}=t;return Ws?new Promise(function(i,o){var l=document.getElementById(n),c=window;if(l){var u=l.getAttribute("data-state");if(l.src===e&&u!=="error"){if(u==="ready")return i(n);var d=c.initMap,f=l.onerror;c.initMap=function(){d&&d(),i(n)},l.onerror=function(v){f&&f(v),o(v)};return}else l.remove()}var g=document.createElement("script");g.type="text/javascript",g.src=e,g.id=n,g.async=!0,g.nonce=r||"",g.onerror=function(x){g.setAttribute("data-state","error"),o(x)},c.initMap=function(){g.setAttribute("data-state","ready"),i(n)},document.head.appendChild(g)}).catch(s=>{throw console.error("injectScript error: ",s),s}):Promise.reject(new Error("document is undefined"))}function Ww(t){var e=t.href;return e&&(e.indexOf("https://fonts.googleapis.com/css?family=Roboto")===0||e.indexOf("https://fonts.googleapis.com/css?family=Google+Sans+Text")===0)?!0:t.tagName.toLowerCase()==="style"&&t.styleSheet&&t.styleSheet.cssText&&t.styleSheet.cssText.replace(`\r
`,"").indexOf(".gm-style")===0?(t.styleSheet.cssText="",!0):t.tagName.toLowerCase()==="style"&&t.innerHTML&&t.innerHTML.replace(`\r
`,"").indexOf(".gm-style")===0?(t.innerHTML="",!0):t.tagName.toLowerCase()==="style"&&!t.styleSheet&&!t.innerHTML}function mT(){var t=document.getElementsByTagName("head")[0];if(t){var e=t.insertBefore.bind(t);t.insertBefore=function(s,i){return Ww(s)||Reflect.apply(e,t,[s,i]),s};var n=t.appendChild.bind(t);t.appendChild=function(s){return Ww(s)||Reflect.apply(n,t,[s]),s}}}var Ml=!1;function pT(){return Nn.jsx("div",{children:"Loading..."})}var qg={id:"script-loader",version:"weekly"};class vU extends p.PureComponent{constructor(){super(...arguments),X(this,"check",null),X(this,"state",{loaded:!1}),X(this,"cleanupCallback",()=>{delete window.google.maps,this.injectScript()}),X(this,"isCleaningUp",cT(function*(){function e(n){if(!Ml)n();else if(Ws)var r=window.setInterval(function(){Ml||(window.clearInterval(r),n())},1)}return new Promise(e)})),X(this,"cleanup",()=>{Ml=!0;var e=document.getElementById(this.props.id);e&&e.parentNode&&e.parentNode.removeChild(e),Array.prototype.slice.call(document.getElementsByTagName("script")).filter(function(r){return typeof r.src=="string"&&r.src.includes("maps.googleapis")}).forEach(function(r){r.parentNode&&r.parentNode.removeChild(r)}),Array.prototype.slice.call(document.getElementsByTagName("link")).filter(function(r){return r.href==="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Google+Sans"}).forEach(function(r){r.parentNode&&r.parentNode.removeChild(r)}),Array.prototype.slice.call(document.getElementsByTagName("style")).filter(function(r){return r.innerText!==void 0&&r.innerText.length>0&&r.innerText.includes(".gm-")}).forEach(function(r){r.parentNode&&r.parentNode.removeChild(r)})}),X(this,"injectScript",()=>{this.props.preventGoogleFontsLoading&&mT(),Ht(!!this.props.id,'LoadScript requires "id" prop to be a string: %s',this.props.id);var e={id:this.props.id,nonce:this.props.nonce,url:uT(this.props)};dT(e).then(()=>{this.props.onLoad&&this.props.onLoad(),this.setState(function(){return{loaded:!0}})}).catch(n=>{this.props.onError&&this.props.onError(n),console.error(`
          There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(this.props.googleMapsApiKey||"-",") or Client ID (").concat(this.props.googleMapsClientId||"-",`) to <LoadScript />
          Otherwise it is a Network issue.
        `))})}),X(this,"getRef",e=>{this.check=e})}componentDidMount(){if(Ws){if(window.google&&window.google.maps&&!Ml){console.error("google api is already presented");return}this.isCleaningUp().then(this.injectScript).catch(function(n){console.error("Error at injecting script after cleaning up: ",n)})}}componentDidUpdate(e){this.props.libraries!==e.libraries&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),Ws&&e.language!==this.props.language&&(this.cleanup(),this.setState(function(){return{loaded:!1}},this.cleanupCallback))}componentWillUnmount(){if(Ws){this.cleanup();var e=()=>{this.check||(delete window.google,Ml=!1)};window.setTimeout(e,1),this.props.onUnmount&&this.props.onUnmount()}}render(){return Nn.jsxs(Nn.Fragment,{children:[Nn.jsx("div",{ref:this.getRef}),this.state.loaded?this.props.children:this.props.loadingElement||Nn.jsx(pT,{})]})}}X(vU,"defaultProps",qg);function bU(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.includes(r))continue;n[r]=t[r]}return n}function Tb(t,e){if(t==null)return{};var n,r,s=bU(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.includes(n)||{}.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}var Hw;function fT(t){var{id:e=qg.id,version:n=qg.version,nonce:r,googleMapsApiKey:s,googleMapsClientId:i,language:o,region:l,libraries:c,preventGoogleFontsLoading:u,channel:d,mapIds:f,authReferrerPolicy:g,apiUrl:v="https://maps.googleapis.com"}=t,x=p.useRef(!1),[E,y]=p.useState(!1),[h,C]=p.useState(void 0);p.useEffect(function(){return x.current=!0,()=>{x.current=!1}},[]),p.useEffect(function(){Ws&&u&&mT()},[u]),p.useEffect(function(){E&&Ht(!!window.google,"useLoadScript was marked as loaded, but window.google is not present. Something went wrong.")},[E]);var T=uT({version:n,googleMapsApiKey:s,googleMapsClientId:i,language:o,region:l,libraries:c,channel:d,mapIds:f,authReferrerPolicy:g,apiUrl:v});p.useEffect(function(){if(!Ws)return;function S(){x.current&&(y(!0),Hw=T)}if(window.google&&window.google.maps&&Hw===T){S();return}dT({id:e,url:T,nonce:r}).then(S).catch(function(b){x.current&&C(b),console.warn(`
        There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(s||"-",") or Client ID (").concat(i||"-",`)
        Otherwise it is a Network issue.
      `)),console.error(b)})},[e,T,r]);var k=p.useRef(void 0);return p.useEffect(function(){k.current&&c!==k.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),k.current=c},[c]),{isLoaded:E,loadError:h,url:T}}var yU=["loadingElement","onLoad","onError","onUnmount","children"],EU=Nn.jsx(pT,{});function xU(t){var{loadingElement:e,onLoad:n,onError:r,onUnmount:s,children:i}=t,o=Tb(t,yU),{isLoaded:l,loadError:c}=fT(o);return p.useEffect(function(){l&&typeof n=="function"&&n()},[l,n]),p.useEffect(function(){c&&typeof r=="function"&&r(c)},[c,r]),p.useEffect(function(){return()=>{s&&s()}},[s]),l?i:e||EU}p.memo(xU);var Gw;(function(t){t[t.INITIALIZED=0]="INITIALIZED",t[t.LOADING=1]="LOADING",t[t.SUCCESS=2]="SUCCESS",t[t.FAILURE=3]="FAILURE"})(Gw||(Gw={}));function Kw(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Fm(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Kw(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Kw(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Qw={},Jw={options(t,e){t.setOptions(e)}};function wU(t){var{options:e,onLoad:n,onUnmount:r}=t,s=p.useContext(Ve),[i,o]=p.useState(null);return p.useEffect(()=>{i!==null&&i.setMap(s)},[s]),p.useEffect(()=>{e&&i!==null&&i.setOptions(e)},[i,e]),p.useEffect(()=>{var l=new google.maps.TrafficLayer(Fm(Fm({},e),{},{map:s}));return o(l),n&&n(l),()=>{i!==null&&(r&&r(i),i.setMap(null))}},[]),null}p.memo(wU);class _U extends p.PureComponent{constructor(){super(...arguments),X(this,"state",{trafficLayer:null}),X(this,"setTrafficLayerCallback",()=>{this.state.trafficLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.trafficLayer)}),X(this,"registeredEvents",[])}componentDidMount(){var e=new google.maps.TrafficLayer(Fm(Fm({},this.props.options),{},{map:this.context}));this.registeredEvents=Fe({updaterMap:Jw,eventMap:Qw,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{trafficLayer:e}},this.setTrafficLayerCallback)}componentDidUpdate(e){this.state.trafficLayer!==null&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:Jw,eventMap:Qw,prevProps:e,nextProps:this.props,instance:this.state.trafficLayer}))}componentWillUnmount(){this.state.trafficLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.trafficLayer),$e(this.registeredEvents),this.state.trafficLayer.setMap(null))}render(){return null}}X(_U,"contextType",Ve);function NU(t){var{onLoad:e,onUnmount:n}=t,r=p.useContext(Ve),[s,i]=p.useState(null);return p.useEffect(()=>{s!==null&&s.setMap(r)},[r]),p.useEffect(()=>{var o=new google.maps.BicyclingLayer;return i(o),o.setMap(r),e&&e(o),()=>{o!==null&&(n&&n(o),o.setMap(null))}},[]),null}p.memo(NU);class CU extends p.PureComponent{constructor(){super(...arguments),X(this,"state",{bicyclingLayer:null}),X(this,"setBicyclingLayerCallback",()=>{this.state.bicyclingLayer!==null&&(this.state.bicyclingLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.bicyclingLayer))})}componentDidMount(){var e=new google.maps.BicyclingLayer;this.setState(()=>({bicyclingLayer:e}),this.setBicyclingLayerCallback)}componentWillUnmount(){this.state.bicyclingLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.bicyclingLayer),this.state.bicyclingLayer.setMap(null))}render(){return null}}X(CU,"contextType",Ve);function SU(t){var{onLoad:e,onUnmount:n}=t,r=p.useContext(Ve),[s,i]=p.useState(null);return p.useEffect(()=>{s!==null&&s.setMap(r)},[r]),p.useEffect(()=>{var o=new google.maps.TransitLayer;return i(o),o.setMap(r),e&&e(o),()=>{s!==null&&(n&&n(s),s.setMap(null))}},[]),null}p.memo(SU);class kU extends p.PureComponent{constructor(){super(...arguments),X(this,"state",{transitLayer:null}),X(this,"setTransitLayerCallback",()=>{this.state.transitLayer!==null&&(this.state.transitLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.transitLayer))})}componentDidMount(){var e=new google.maps.TransitLayer;this.setState(function(){return{transitLayer:e}},this.setTransitLayerCallback)}componentWillUnmount(){this.state.transitLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.transitLayer),this.state.transitLayer.setMap(null))}render(){return null}}X(kU,"contextType",Ve);function Yw(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function zm(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Yw(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yw(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Zw={onCircleComplete:"circlecomplete",onMarkerComplete:"markercomplete",onOverlayComplete:"overlaycomplete",onPolygonComplete:"polygoncomplete",onPolylineComplete:"polylinecomplete",onRectangleComplete:"rectanglecomplete"},Xw={drawingMode(t,e){t.setDrawingMode(e)},options(t,e){t.setOptions(e)}};function IU(t){var{options:e,drawingMode:n,onCircleComplete:r,onMarkerComplete:s,onOverlayComplete:i,onPolygonComplete:o,onPolylineComplete:l,onRectangleComplete:c,onLoad:u,onUnmount:d}=t,f=p.useContext(Ve),[g,v]=p.useState(null),[x,E]=p.useState(null),[y,h]=p.useState(null),[C,T]=p.useState(null),[k,_]=p.useState(null),[S,N]=p.useState(null),[b,w]=p.useState(null);return p.useEffect(()=>{g!==null&&g.setMap(f)},[f]),p.useEffect(()=>{e&&g!==null&&g.setOptions(e)},[g,e]),p.useEffect(()=>{g!==null&&g.setDrawingMode(n??null)},[g,n]),p.useEffect(()=>{g&&r&&(x!==null&&google.maps.event.removeListener(x),E(google.maps.event.addListener(g,"circlecomplete",r)))},[g,r]),p.useEffect(()=>{g&&s&&(y!==null&&google.maps.event.removeListener(y),h(google.maps.event.addListener(g,"markercomplete",s)))},[g,s]),p.useEffect(()=>{g&&i&&(C!==null&&google.maps.event.removeListener(C),T(google.maps.event.addListener(g,"overlaycomplete",i)))},[g,i]),p.useEffect(()=>{g&&o&&(k!==null&&google.maps.event.removeListener(k),_(google.maps.event.addListener(g,"polygoncomplete",o)))},[g,o]),p.useEffect(()=>{g&&l&&(S!==null&&google.maps.event.removeListener(S),N(google.maps.event.addListener(g,"polylinecomplete",l)))},[g,l]),p.useEffect(()=>{g&&c&&(b!==null&&google.maps.event.removeListener(b),w(google.maps.event.addListener(g,"rectanglecomplete",c)))},[g,c]),p.useEffect(()=>{Ht(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing);var A=new google.maps.drawing.DrawingManager(zm(zm({},e),{},{map:f}));return n&&A.setDrawingMode(n),r&&E(google.maps.event.addListener(A,"circlecomplete",r)),s&&h(google.maps.event.addListener(A,"markercomplete",s)),i&&T(google.maps.event.addListener(A,"overlaycomplete",i)),o&&_(google.maps.event.addListener(A,"polygoncomplete",o)),l&&N(google.maps.event.addListener(A,"polylinecomplete",l)),c&&w(google.maps.event.addListener(A,"rectanglecomplete",c)),v(A),u&&u(A),()=>{g!==null&&(x&&google.maps.event.removeListener(x),y&&google.maps.event.removeListener(y),C&&google.maps.event.removeListener(C),k&&google.maps.event.removeListener(k),S&&google.maps.event.removeListener(S),b&&google.maps.event.removeListener(b),d&&d(g),g.setMap(null))}},[]),null}p.memo(IU);class TU extends p.PureComponent{constructor(e){super(e),X(this,"registeredEvents",[]),X(this,"state",{drawingManager:null}),X(this,"setDrawingManagerCallback",()=>{this.state.drawingManager!==null&&this.props.onLoad&&this.props.onLoad(this.state.drawingManager)}),Ht(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing)}componentDidMount(){var e=new google.maps.drawing.DrawingManager(zm(zm({},this.props.options),{},{map:this.context}));this.registeredEvents=Fe({updaterMap:Xw,eventMap:Zw,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{drawingManager:e}},this.setDrawingManagerCallback)}componentDidUpdate(e){this.state.drawingManager!==null&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:Xw,eventMap:Zw,prevProps:e,nextProps:this.props,instance:this.state.drawingManager}))}componentWillUnmount(){this.state.drawingManager!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.drawingManager),$e(this.registeredEvents),this.state.drawingManager.setMap(null))}render(){return null}}X(TU,"contextType",Ve);function e_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function go(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?e_(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var t_={onAnimationChanged:"animation_changed",onClick:"click",onClickableChanged:"clickable_changed",onCursorChanged:"cursor_changed",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDraggableChanged:"draggable_changed",onDragStart:"dragstart",onFlatChanged:"flat_changed",onIconChanged:"icon_changed",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPositionChanged:"position_changed",onRightClick:"rightclick",onShapeChanged:"shape_changed",onTitleChanged:"title_changed",onVisibleChanged:"visible_changed",onZindexChanged:"zindex_changed"},n_={animation(t,e){t.setAnimation(e)},clickable(t,e){t.setClickable(e)},cursor(t,e){t.setCursor(e)},draggable(t,e){t.setDraggable(e)},icon(t,e){t.setIcon(e)},label(t,e){t.setLabel(e)},map(t,e){t.setMap(e)},opacity(t,e){t.setOpacity(e)},options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},shape(t,e){t.setShape(e)},title(t,e){t.setTitle(e)},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},Um={};function AU(t){var{position:e,options:n,clusterer:r,noClustererRedraw:s,children:i,draggable:o,visible:l,animation:c,clickable:u,cursor:d,icon:f,label:g,opacity:v,shape:x,title:E,zIndex:y,onClick:h,onDblClick:C,onDrag:T,onDragEnd:k,onDragStart:_,onMouseOut:S,onMouseOver:N,onMouseUp:b,onMouseDown:w,onRightClick:A,onClickableChanged:R,onCursorChanged:L,onAnimationChanged:M,onDraggableChanged:F,onFlatChanged:U,onIconChanged:D,onPositionChanged:j,onShapeChanged:V,onTitleChanged:z,onVisibleChanged:G,onZindexChanged:Y,onLoad:Z,onUnmount:H}=t,oe=p.useContext(Ve),[W,he]=p.useState(null),[xe,ie]=p.useState(null),[be,ne]=p.useState(null),[re,Se]=p.useState(null),[Oe,je]=p.useState(null),[Ee,Re]=p.useState(null),[ot,ke]=p.useState(null),[qe,zt]=p.useState(null),[tn,Kt]=p.useState(null),[In,ae]=p.useState(null),[ge,Pe]=p.useState(null),[Ce,Le]=p.useState(null),[Ut,xn]=p.useState(null),[Qt,$t]=p.useState(null),[Vt,zn]=p.useState(null),[cr,Nr]=p.useState(null),[Cr,xa]=p.useState(null),[Sr,il]=p.useState(null),[ol,wa]=p.useState(null),[_a,Ii]=p.useState(null),[Zn,ll]=p.useState(null),[Br,cl]=p.useState(null);p.useEffect(()=>{W!==null&&W.setMap(oe)},[oe]),p.useEffect(()=>{typeof n<"u"&&W!==null&&W.setOptions(n)},[W,n]),p.useEffect(()=>{typeof o<"u"&&W!==null&&W.setDraggable(o)},[W,o]),p.useEffect(()=>{e&&W!==null&&W.setPosition(e)},[W,e]),p.useEffect(()=>{typeof l<"u"&&W!==null&&W.setVisible(l)},[W,l]),p.useEffect(()=>{W==null||W.setAnimation(c)},[W,c]),p.useEffect(()=>{W&&u!==void 0&&W.setClickable(u)},[W,u]),p.useEffect(()=>{W&&d!==void 0&&W.setCursor(d)},[W,d]),p.useEffect(()=>{W&&f!==void 0&&W.setIcon(f)},[W,f]),p.useEffect(()=>{W&&g!==void 0&&W.setLabel(g)},[W,g]),p.useEffect(()=>{W&&v!==void 0&&W.setOpacity(v)},[W,v]),p.useEffect(()=>{W&&x!==void 0&&W.setShape(x)},[W,x]),p.useEffect(()=>{W&&E!==void 0&&W.setTitle(E)},[W,E]),p.useEffect(()=>{W&&y!==void 0&&W.setZIndex(y)},[W,y]),p.useEffect(()=>{W&&C&&(xe!==null&&google.maps.event.removeListener(xe),ie(google.maps.event.addListener(W,"dblclick",C)))},[C]),p.useEffect(()=>{W&&k&&(be!==null&&google.maps.event.removeListener(be),ne(google.maps.event.addListener(W,"dragend",k)))},[k]),p.useEffect(()=>{W&&_&&(re!==null&&google.maps.event.removeListener(re),Se(google.maps.event.addListener(W,"dragstart",_)))},[_]),p.useEffect(()=>{W&&w&&(Oe!==null&&google.maps.event.removeListener(Oe),je(google.maps.event.addListener(W,"mousedown",w)))},[w]),p.useEffect(()=>{W&&S&&(Ee!==null&&google.maps.event.removeListener(Ee),Re(google.maps.event.addListener(W,"mouseout",S)))},[S]),p.useEffect(()=>{W&&N&&(ot!==null&&google.maps.event.removeListener(ot),ke(google.maps.event.addListener(W,"mouseover",N)))},[N]),p.useEffect(()=>{W&&b&&(qe!==null&&google.maps.event.removeListener(qe),zt(google.maps.event.addListener(W,"mouseup",b)))},[b]),p.useEffect(()=>{W&&A&&(tn!==null&&google.maps.event.removeListener(tn),Kt(google.maps.event.addListener(W,"rightclick",A)))},[A]),p.useEffect(()=>{W&&h&&(In!==null&&google.maps.event.removeListener(In),ae(google.maps.event.addListener(W,"click",h)))},[h]),p.useEffect(()=>{W&&T&&(ge!==null&&google.maps.event.removeListener(ge),Pe(google.maps.event.addListener(W,"drag",T)))},[T]),p.useEffect(()=>{W&&R&&(Ce!==null&&google.maps.event.removeListener(Ce),Le(google.maps.event.addListener(W,"clickable_changed",R)))},[R]),p.useEffect(()=>{W&&L&&(Ut!==null&&google.maps.event.removeListener(Ut),xn(google.maps.event.addListener(W,"cursor_changed",L)))},[L]),p.useEffect(()=>{W&&M&&(Qt!==null&&google.maps.event.removeListener(Qt),$t(google.maps.event.addListener(W,"animation_changed",M)))},[M]),p.useEffect(()=>{W&&F&&(Vt!==null&&google.maps.event.removeListener(Vt),zn(google.maps.event.addListener(W,"draggable_changed",F)))},[F]),p.useEffect(()=>{W&&U&&(cr!==null&&google.maps.event.removeListener(cr),Nr(google.maps.event.addListener(W,"flat_changed",U)))},[U]),p.useEffect(()=>{W&&D&&(Cr!==null&&google.maps.event.removeListener(Cr),xa(google.maps.event.addListener(W,"icon_changed",D)))},[D]),p.useEffect(()=>{W&&j&&(Sr!==null&&google.maps.event.removeListener(Sr),il(google.maps.event.addListener(W,"position_changed",j)))},[j]),p.useEffect(()=>{W&&V&&(ol!==null&&google.maps.event.removeListener(ol),wa(google.maps.event.addListener(W,"shape_changed",V)))},[V]),p.useEffect(()=>{W&&z&&(_a!==null&&google.maps.event.removeListener(_a),Ii(google.maps.event.addListener(W,"title_changed",z)))},[z]),p.useEffect(()=>{W&&G&&(Zn!==null&&google.maps.event.removeListener(Zn),ll(google.maps.event.addListener(W,"visible_changed",G)))},[G]),p.useEffect(()=>{W&&Y&&(Br!==null&&google.maps.event.removeListener(Br),cl(google.maps.event.addListener(W,"zindex_changed",Y)))},[Y]),p.useEffect(()=>{var Na=go(go(go({},n||Um),r?Um:{map:oe}),{},{position:e}),Ne=new google.maps.Marker(Na);return r?r.addMarker(Ne,!!s):Ne.setMap(oe),e&&Ne.setPosition(e),typeof l<"u"&&Ne.setVisible(l),typeof o<"u"&&Ne.setDraggable(o),typeof u<"u"&&Ne.setClickable(u),typeof d=="string"&&Ne.setCursor(d),f&&Ne.setIcon(f),typeof g<"u"&&Ne.setLabel(g),typeof v<"u"&&Ne.setOpacity(v),x&&Ne.setShape(x),typeof E=="string"&&Ne.setTitle(E),typeof y=="number"&&Ne.setZIndex(y),C&&ie(google.maps.event.addListener(Ne,"dblclick",C)),k&&ne(google.maps.event.addListener(Ne,"dragend",k)),_&&Se(google.maps.event.addListener(Ne,"dragstart",_)),w&&je(google.maps.event.addListener(Ne,"mousedown",w)),S&&Re(google.maps.event.addListener(Ne,"mouseout",S)),N&&ke(google.maps.event.addListener(Ne,"mouseover",N)),b&&zt(google.maps.event.addListener(Ne,"mouseup",b)),A&&Kt(google.maps.event.addListener(Ne,"rightclick",A)),h&&ae(google.maps.event.addListener(Ne,"click",h)),T&&Pe(google.maps.event.addListener(Ne,"drag",T)),R&&Le(google.maps.event.addListener(Ne,"clickable_changed",R)),L&&xn(google.maps.event.addListener(Ne,"cursor_changed",L)),M&&$t(google.maps.event.addListener(Ne,"animation_changed",M)),F&&zn(google.maps.event.addListener(Ne,"draggable_changed",F)),U&&Nr(google.maps.event.addListener(Ne,"flat_changed",U)),D&&xa(google.maps.event.addListener(Ne,"icon_changed",D)),j&&il(google.maps.event.addListener(Ne,"position_changed",j)),V&&wa(google.maps.event.addListener(Ne,"shape_changed",V)),z&&Ii(google.maps.event.addListener(Ne,"title_changed",z)),G&&ll(google.maps.event.addListener(Ne,"visible_changed",G)),Y&&cl(google.maps.event.addListener(Ne,"zindex_changed",Y)),he(Ne),Z&&Z(Ne),()=>{xe!==null&&google.maps.event.removeListener(xe),be!==null&&google.maps.event.removeListener(be),re!==null&&google.maps.event.removeListener(re),Oe!==null&&google.maps.event.removeListener(Oe),Ee!==null&&google.maps.event.removeListener(Ee),ot!==null&&google.maps.event.removeListener(ot),qe!==null&&google.maps.event.removeListener(qe),tn!==null&&google.maps.event.removeListener(tn),In!==null&&google.maps.event.removeListener(In),Ce!==null&&google.maps.event.removeListener(Ce),Ut!==null&&google.maps.event.removeListener(Ut),Qt!==null&&google.maps.event.removeListener(Qt),Vt!==null&&google.maps.event.removeListener(Vt),cr!==null&&google.maps.event.removeListener(cr),Cr!==null&&google.maps.event.removeListener(Cr),Sr!==null&&google.maps.event.removeListener(Sr),_a!==null&&google.maps.event.removeListener(_a),Zn!==null&&google.maps.event.removeListener(Zn),Br!==null&&google.maps.event.removeListener(Br),H&&H(Ne),r?r.removeMarker(Ne,!!s):Ne&&Ne.setMap(null)}},[]);var Cs=p.useMemo(()=>i?p.Children.map(i,Na=>{if(!p.isValidElement(Na))return Na;var Ne=Na;return p.cloneElement(Ne,{anchor:W})}):null,[i,W]);return Nn.jsx(Nn.Fragment,{children:Cs})||null}p.memo(AU);class hT extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[])}componentDidMount(){var e=this;return cT(function*(){var n=go(go(go({},e.props.options||Um),e.props.clusterer?Um:{map:e.context}),{},{position:e.props.position});e.marker=new google.maps.Marker(n),e.props.clusterer?e.props.clusterer.addMarker(e.marker,!!e.props.noClustererRedraw):e.marker.setMap(e.context),e.registeredEvents=Fe({updaterMap:n_,eventMap:t_,prevProps:{},nextProps:e.props,instance:e.marker}),e.props.onLoad&&e.props.onLoad(e.marker)})()}componentDidUpdate(e){this.marker&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:n_,eventMap:t_,prevProps:e,nextProps:this.props,instance:this.marker}))}componentWillUnmount(){this.marker&&(this.props.onUnmount&&this.props.onUnmount(this.marker),$e(this.registeredEvents),this.props.clusterer?this.props.clusterer.removeMarker(this.marker,!!this.props.noClustererRedraw):this.marker&&this.marker.setMap(null))}render(){var e=this.props.children?p.Children.map(this.props.children,n=>{if(!p.isValidElement(n))return n;var r=n;return p.cloneElement(r,{anchor:this.marker})}):null;return e||null}}X(hT,"contextType",Ve);var PU=function(){function t(e,n){e.getClusterer().extend(t,google.maps.OverlayView),this.cluster=e,this.clusterClassName=this.cluster.getClusterer().getClusterClass(),this.className=this.clusterClassName,this.styles=n,this.center=void 0,this.div=null,this.sums=null,this.visible=!1,this.boundsChangedListener=null,this.url="",this.height=0,this.width=0,this.anchorText=[0,0],this.anchorIcon=[0,0],this.textColor="black",this.textSize=11,this.textDecoration="none",this.fontWeight="bold",this.fontStyle="normal",this.fontFamily="Arial,sans-serif",this.backgroundPosition="0 0",this.cMouseDownInCluster=null,this.cDraggingMapByCluster=null,this.timeOut=null,this.setMap(e.getMap()),this.onBoundsChanged=this.onBoundsChanged.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onAdd=this.onAdd.bind(this),this.onRemove=this.onRemove.bind(this),this.draw=this.draw.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.useStyle=this.useStyle.bind(this),this.setCenter=this.setCenter.bind(this),this.getPosFromLatLng=this.getPosFromLatLng.bind(this)}return t.prototype.onBoundsChanged=function(){this.cDraggingMapByCluster=this.cMouseDownInCluster},t.prototype.onMouseDown=function(){this.cMouseDownInCluster=!0,this.cDraggingMapByCluster=!1},t.prototype.onClick=function(e){if(this.cMouseDownInCluster=!1,!this.cDraggingMapByCluster){var n=this.cluster.getClusterer();if(google.maps.event.trigger(n,"click",this.cluster),google.maps.event.trigger(n,"clusterclick",this.cluster),n.getZoomOnClick()){var r=n.getMaxZoom(),s=this.cluster.getBounds(),i=n.getMap();i!==null&&"fitBounds"in i&&i.fitBounds(s),this.timeOut=window.setTimeout(function(){var o=n.getMap();if(o!==null){"fitBounds"in o&&o.fitBounds(s);var l=o.getZoom()||0;r!==null&&l>r&&o.setZoom(r+1)}},100)}e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}},t.prototype.onMouseOver=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseover",this.cluster)},t.prototype.onMouseOut=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseout",this.cluster)},t.prototype.onAdd=function(){var e;this.div=document.createElement("div"),this.div.className=this.className,this.visible&&this.show(),(e=this.getPanes())===null||e===void 0||e.overlayMouseTarget.appendChild(this.div);var n=this.getMap();n!==null&&(this.boundsChangedListener=google.maps.event.addListener(n,"bounds_changed",this.onBoundsChanged),this.div.addEventListener("mousedown",this.onMouseDown),this.div.addEventListener("click",this.onClick),this.div.addEventListener("mouseover",this.onMouseOver),this.div.addEventListener("mouseout",this.onMouseOut))},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.hide(),this.boundsChangedListener!==null&&google.maps.event.removeListener(this.boundsChangedListener),this.div.removeEventListener("mousedown",this.onMouseDown),this.div.removeEventListener("click",this.onClick),this.div.removeEventListener("mouseover",this.onMouseOver),this.div.removeEventListener("mouseout",this.onMouseOut),this.div.parentNode.removeChild(this.div),this.timeOut!==null&&(window.clearTimeout(this.timeOut),this.timeOut=null),this.div=null)},t.prototype.draw=function(){if(this.visible&&this.div!==null&&this.center){var e=this.getPosFromLatLng(this.center);this.div.style.top=e!==null?"".concat(e.y,"px"):"0",this.div.style.left=e!==null?"".concat(e.x,"px"):"0"}},t.prototype.hide=function(){this.div&&(this.div.style.display="none"),this.visible=!1},t.prototype.show=function(){var e,n,r,s,i,o;if(this.div&&this.center){var l=this.sums===null||typeof this.sums.title>"u"||this.sums.title===""?this.cluster.getClusterer().getTitle():this.sums.title,c=this.backgroundPosition.split(" "),u=parseInt(((e=c[0])===null||e===void 0?void 0:e.replace(/^\s+|\s+$/g,""))||"0",10),d=parseInt(((n=c[1])===null||n===void 0?void 0:n.replace(/^\s+|\s+$/g,""))||"0",10),f=this.getPosFromLatLng(this.center);this.div.className=this.className,this.div.setAttribute("style","cursor: pointer; position: absolute; top: ".concat(f!==null?"".concat(f.y,"px"):"0","; left: ").concat(f!==null?"".concat(f.x,"px"):"0","; width: ").concat(this.width,"px; height: ").concat(this.height,"px; "));var g=document.createElement("img");g.alt=l,g.src=this.url,g.width=this.width,g.height=this.height,g.setAttribute("style","position: absolute; top: ".concat(d,"px; left: ").concat(u,"px")),this.cluster.getClusterer().enableRetinaIcons||(g.style.clip="rect(-".concat(d,"px, -").concat(u+this.width,"px, -").concat(d+this.height,", -").concat(u,")"));var v=document.createElement("div");v.setAttribute("style","position: absolute; top: ".concat(this.anchorText[0],"px; left: ").concat(this.anchorText[1],"px; color: ").concat(this.textColor,"; font-size: ").concat(this.textSize,"px; font-family: ").concat(this.fontFamily,"; font-weight: ").concat(this.fontWeight,"; fontStyle: ").concat(this.fontStyle,"; text-decoration: ").concat(this.textDecoration,"; text-align: center; width: ").concat(this.width,"px; line-height: ").concat(this.height,"px")),!((r=this.sums)===null||r===void 0)&&r.text&&(v.innerText="".concat((s=this.sums)===null||s===void 0?void 0:s.text)),!((i=this.sums)===null||i===void 0)&&i.html&&(v.innerHTML="".concat((o=this.sums)===null||o===void 0?void 0:o.html)),this.div.innerHTML="",this.div.appendChild(g),this.div.appendChild(v),this.div.title=l,this.div.style.display=""}this.visible=!0},t.prototype.useStyle=function(e){this.sums=e;var n=this.cluster.getClusterer().getStyles(),r=n[Math.min(n.length-1,Math.max(0,e.index-1))];r&&(this.url=r.url,this.height=r.height,this.width=r.width,r.className&&(this.className="".concat(this.clusterClassName," ").concat(r.className)),this.anchorText=r.anchorText||[0,0],this.anchorIcon=r.anchorIcon||[this.height/2,this.width/2],this.textColor=r.textColor||"black",this.textSize=r.textSize||11,this.textDecoration=r.textDecoration||"none",this.fontWeight=r.fontWeight||"bold",this.fontStyle=r.fontStyle||"normal",this.fontFamily=r.fontFamily||"Arial,sans-serif",this.backgroundPosition=r.backgroundPosition||"0 0")},t.prototype.setCenter=function(e){this.center=e},t.prototype.getPosFromLatLng=function(e){var n=this.getProjection().fromLatLngToDivPixel(e);return n!==null&&(n.x-=this.anchorIcon[1],n.y-=this.anchorIcon[0]),n},t}(),RU=function(){function t(e){this.markerClusterer=e,this.map=this.markerClusterer.getMap(),this.gridSize=this.markerClusterer.getGridSize(),this.minClusterSize=this.markerClusterer.getMinimumClusterSize(),this.averageCenter=this.markerClusterer.getAverageCenter(),this.markers=[],this.center=void 0,this.bounds=null,this.clusterIcon=new PU(this,this.markerClusterer.getStyles()),this.getSize=this.getSize.bind(this),this.getMarkers=this.getMarkers.bind(this),this.getCenter=this.getCenter.bind(this),this.getMap=this.getMap.bind(this),this.getClusterer=this.getClusterer.bind(this),this.getBounds=this.getBounds.bind(this),this.remove=this.remove.bind(this),this.addMarker=this.addMarker.bind(this),this.isMarkerInClusterBounds=this.isMarkerInClusterBounds.bind(this),this.calculateBounds=this.calculateBounds.bind(this),this.updateIcon=this.updateIcon.bind(this),this.isMarkerAlreadyAdded=this.isMarkerAlreadyAdded.bind(this)}return t.prototype.getSize=function(){return this.markers.length},t.prototype.getMarkers=function(){return this.markers},t.prototype.getCenter=function(){return this.center},t.prototype.getMap=function(){return this.map},t.prototype.getClusterer=function(){return this.markerClusterer},t.prototype.getBounds=function(){for(var e=new google.maps.LatLngBounds(this.center,this.center),n=this.getMarkers(),r=0,s=n;r<s.length;r++){var i=s[r],o=i.getPosition();o&&e.extend(o)}return e},t.prototype.remove=function(){this.clusterIcon.setMap(null),this.markers=[],delete this.markers},t.prototype.addMarker=function(e){var n;if(this.isMarkerAlreadyAdded(e))return!1;if(this.center){if(this.averageCenter){var r=e.getPosition();if(r){var s=this.markers.length+1;this.center=new google.maps.LatLng((this.center.lat()*(s-1)+r.lat())/s,(this.center.lng()*(s-1)+r.lng())/s),this.calculateBounds()}}}else{var r=e.getPosition();r&&(this.center=r,this.calculateBounds())}e.isAdded=!0,this.markers.push(e);var i=this.markers.length,o=this.markerClusterer.getMaxZoom(),l=(n=this.map)===null||n===void 0?void 0:n.getZoom();if(o!==null&&typeof l<"u"&&l>o)e.getMap()!==this.map&&e.setMap(this.map);else if(i<this.minClusterSize)e.getMap()!==this.map&&e.setMap(this.map);else if(i===this.minClusterSize)for(var c=0,u=this.markers;c<u.length;c++){var d=u[c];d.setMap(null)}else e.setMap(null);return!0},t.prototype.isMarkerInClusterBounds=function(e){if(this.bounds!==null){var n=e.getPosition();if(n)return this.bounds.contains(n)}return!1},t.prototype.calculateBounds=function(){this.bounds=this.markerClusterer.getExtendedBounds(new google.maps.LatLngBounds(this.center,this.center))},t.prototype.updateIcon=function(){var e,n=this.markers.length,r=this.markerClusterer.getMaxZoom(),s=(e=this.map)===null||e===void 0?void 0:e.getZoom();if(r!==null&&typeof s<"u"&&s>r){this.clusterIcon.hide();return}if(n<this.minClusterSize){this.clusterIcon.hide();return}this.center&&this.clusterIcon.setCenter(this.center),this.clusterIcon.useStyle(this.markerClusterer.getCalculator()(this.markers,this.markerClusterer.getStyles().length)),this.clusterIcon.show()},t.prototype.isMarkerAlreadyAdded=function(e){if(this.markers.includes)return this.markers.includes(e);for(var n=0;n<this.markers.length;n++)if(e===this.markers[n])return!0;return!1},t}();function LU(t,e){var n=t.length,r=n.toString().length,s=Math.min(r,e);return{text:n.toString(),index:s,title:""}}var DU=2e3,MU=500,OU="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",VU="png",jU=[53,56,66,78,90],FU="cluster",gT=function(){function t(e,n,r){n===void 0&&(n=[]),r===void 0&&(r={}),this.getMinimumClusterSize=this.getMinimumClusterSize.bind(this),this.setMinimumClusterSize=this.setMinimumClusterSize.bind(this),this.getEnableRetinaIcons=this.getEnableRetinaIcons.bind(this),this.setEnableRetinaIcons=this.setEnableRetinaIcons.bind(this),this.addToClosestCluster=this.addToClosestCluster.bind(this),this.getImageExtension=this.getImageExtension.bind(this),this.setImageExtension=this.setImageExtension.bind(this),this.getExtendedBounds=this.getExtendedBounds.bind(this),this.getAverageCenter=this.getAverageCenter.bind(this),this.setAverageCenter=this.setAverageCenter.bind(this),this.getTotalClusters=this.getTotalClusters.bind(this),this.fitMapToMarkers=this.fitMapToMarkers.bind(this),this.getIgnoreHidden=this.getIgnoreHidden.bind(this),this.setIgnoreHidden=this.setIgnoreHidden.bind(this),this.getClusterClass=this.getClusterClass.bind(this),this.setClusterClass=this.setClusterClass.bind(this),this.getTotalMarkers=this.getTotalMarkers.bind(this),this.getZoomOnClick=this.getZoomOnClick.bind(this),this.setZoomOnClick=this.setZoomOnClick.bind(this),this.getBatchSizeIE=this.getBatchSizeIE.bind(this),this.setBatchSizeIE=this.setBatchSizeIE.bind(this),this.createClusters=this.createClusters.bind(this),this.onZoomChanged=this.onZoomChanged.bind(this),this.getImageSizes=this.getImageSizes.bind(this),this.setImageSizes=this.setImageSizes.bind(this),this.getCalculator=this.getCalculator.bind(this),this.setCalculator=this.setCalculator.bind(this),this.removeMarkers=this.removeMarkers.bind(this),this.resetViewport=this.resetViewport.bind(this),this.getImagePath=this.getImagePath.bind(this),this.setImagePath=this.setImagePath.bind(this),this.pushMarkerTo=this.pushMarkerTo.bind(this),this.removeMarker=this.removeMarker.bind(this),this.clearMarkers=this.clearMarkers.bind(this),this.setupStyles=this.setupStyles.bind(this),this.getGridSize=this.getGridSize.bind(this),this.setGridSize=this.setGridSize.bind(this),this.getClusters=this.getClusters.bind(this),this.getMaxZoom=this.getMaxZoom.bind(this),this.setMaxZoom=this.setMaxZoom.bind(this),this.getMarkers=this.getMarkers.bind(this),this.addMarkers=this.addMarkers.bind(this),this.getStyles=this.getStyles.bind(this),this.setStyles=this.setStyles.bind(this),this.addMarker=this.addMarker.bind(this),this.onRemove=this.onRemove.bind(this),this.getTitle=this.getTitle.bind(this),this.setTitle=this.setTitle.bind(this),this.repaint=this.repaint.bind(this),this.onIdle=this.onIdle.bind(this),this.redraw=this.redraw.bind(this),this.onAdd=this.onAdd.bind(this),this.draw=this.draw.bind(this),this.extend=this.extend.bind(this),this.extend(t,google.maps.OverlayView),this.markers=[],this.clusters=[],this.listeners=[],this.activeMap=null,this.ready=!1,this.gridSize=r.gridSize||60,this.minClusterSize=r.minimumClusterSize||2,this.maxZoom=r.maxZoom||null,this.styles=r.styles||[],this.title=r.title||"",this.zoomOnClick=!0,r.zoomOnClick!==void 0&&(this.zoomOnClick=r.zoomOnClick),this.averageCenter=!1,r.averageCenter!==void 0&&(this.averageCenter=r.averageCenter),this.ignoreHidden=!1,r.ignoreHidden!==void 0&&(this.ignoreHidden=r.ignoreHidden),this.enableRetinaIcons=!1,r.enableRetinaIcons!==void 0&&(this.enableRetinaIcons=r.enableRetinaIcons),this.imagePath=r.imagePath||OU,this.imageExtension=r.imageExtension||VU,this.imageSizes=r.imageSizes||jU,this.calculator=r.calculator||LU,this.batchSize=r.batchSize||DU,this.batchSizeIE=r.batchSizeIE||MU,this.clusterClass=r.clusterClass||FU,navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize=this.batchSizeIE),this.timerRefStatic=null,this.setupStyles(),this.addMarkers(n,!0),this.setMap(e)}return t.prototype.onZoomChanged=function(){var e,n;this.resetViewport(!1),(((e=this.getMap())===null||e===void 0?void 0:e.getZoom())===(this.get("minZoom")||0)||((n=this.getMap())===null||n===void 0?void 0:n.getZoom())===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")},t.prototype.onIdle=function(){this.redraw()},t.prototype.onAdd=function(){var e=this.getMap();this.activeMap=e,this.ready=!0,this.repaint(),e!==null&&(this.listeners=[google.maps.event.addListener(e,"zoom_changed",this.onZoomChanged),google.maps.event.addListener(e,"idle",this.onIdle)])},t.prototype.onRemove=function(){for(var e=0,n=this.markers;e<n.length;e++){var r=n[e];r.getMap()!==this.activeMap&&r.setMap(this.activeMap)}for(var s=0,i=this.clusters;s<i.length;s++){var o=i[s];o.remove()}this.clusters=[];for(var l=0,c=this.listeners;l<c.length;l++){var u=c[l];google.maps.event.removeListener(u)}this.listeners=[],this.activeMap=null,this.ready=!1},t.prototype.draw=function(){},t.prototype.getMap=function(){return null},t.prototype.getPanes=function(){return null},t.prototype.getProjection=function(){return{fromContainerPixelToLatLng:function(){return null},fromDivPixelToLatLng:function(){return null},fromLatLngToContainerPixel:function(){return null},fromLatLngToDivPixel:function(){return null},getVisibleRegion:function(){return null},getWorldWidth:function(){return 0}}},t.prototype.setMap=function(){},t.prototype.addListener=function(){return{remove:function(){}}},t.prototype.bindTo=function(){},t.prototype.get=function(){},t.prototype.notify=function(){},t.prototype.set=function(){},t.prototype.setValues=function(){},t.prototype.unbind=function(){},t.prototype.unbindAll=function(){},t.prototype.setupStyles=function(){if(!(this.styles.length>0))for(var e=0;e<this.imageSizes.length;e++)this.styles.push({url:"".concat(this.imagePath+(e+1),".").concat(this.imageExtension),height:this.imageSizes[e]||0,width:this.imageSizes[e]||0})},t.prototype.fitMapToMarkers=function(){for(var e=this.getMarkers(),n=new google.maps.LatLngBounds,r=0,s=e;r<s.length;r++){var i=s[r],o=i.getPosition();o&&n.extend(o)}var l=this.getMap();l!==null&&"fitBounds"in l&&l.fitBounds(n)},t.prototype.getGridSize=function(){return this.gridSize},t.prototype.setGridSize=function(e){this.gridSize=e},t.prototype.getMinimumClusterSize=function(){return this.minClusterSize},t.prototype.setMinimumClusterSize=function(e){this.minClusterSize=e},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.setMaxZoom=function(e){this.maxZoom=e},t.prototype.getStyles=function(){return this.styles},t.prototype.setStyles=function(e){this.styles=e},t.prototype.getTitle=function(){return this.title},t.prototype.setTitle=function(e){this.title=e},t.prototype.getZoomOnClick=function(){return this.zoomOnClick},t.prototype.setZoomOnClick=function(e){this.zoomOnClick=e},t.prototype.getAverageCenter=function(){return this.averageCenter},t.prototype.setAverageCenter=function(e){this.averageCenter=e},t.prototype.getIgnoreHidden=function(){return this.ignoreHidden},t.prototype.setIgnoreHidden=function(e){this.ignoreHidden=e},t.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons},t.prototype.setEnableRetinaIcons=function(e){this.enableRetinaIcons=e},t.prototype.getImageExtension=function(){return this.imageExtension},t.prototype.setImageExtension=function(e){this.imageExtension=e},t.prototype.getImagePath=function(){return this.imagePath},t.prototype.setImagePath=function(e){this.imagePath=e},t.prototype.getImageSizes=function(){return this.imageSizes},t.prototype.setImageSizes=function(e){this.imageSizes=e},t.prototype.getCalculator=function(){return this.calculator},t.prototype.setCalculator=function(e){this.calculator=e},t.prototype.getBatchSizeIE=function(){return this.batchSizeIE},t.prototype.setBatchSizeIE=function(e){this.batchSizeIE=e},t.prototype.getClusterClass=function(){return this.clusterClass},t.prototype.setClusterClass=function(e){this.clusterClass=e},t.prototype.getMarkers=function(){return this.markers},t.prototype.getTotalMarkers=function(){return this.markers.length},t.prototype.getClusters=function(){return this.clusters},t.prototype.getTotalClusters=function(){return this.clusters.length},t.prototype.addMarker=function(e,n){this.pushMarkerTo(e),n||this.redraw()},t.prototype.addMarkers=function(e,n){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var s=e[r];s&&this.pushMarkerTo(s)}n||this.redraw()},t.prototype.pushMarkerTo=function(e){var n=this;e.getDraggable()&&google.maps.event.addListener(e,"dragend",function(){n.ready&&(e.isAdded=!1,n.repaint())}),e.isAdded=!1,this.markers.push(e)},t.prototype.removeMarker_=function(e){var n=-1;if(this.markers.indexOf)n=this.markers.indexOf(e);else for(var r=0;r<this.markers.length;r++)if(e===this.markers[r]){n=r;break}return n===-1?!1:(e.setMap(null),this.markers.splice(n,1),!0)},t.prototype.removeMarker=function(e,n){var r=this.removeMarker_(e);return!n&&r&&this.repaint(),r},t.prototype.removeMarkers=function(e,n){for(var r=!1,s=0,i=e;s<i.length;s++){var o=i[s];r=r||this.removeMarker_(o)}return!n&&r&&this.repaint(),r},t.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers=[]},t.prototype.repaint=function(){var e=this.clusters.slice();this.clusters=[],this.resetViewport(!1),this.redraw(),setTimeout(function(){for(var r=0,s=e;r<s.length;r++){var i=s[r];i.remove()}},0)},t.prototype.getExtendedBounds=function(e){var n=this.getProjection(),r=n.fromLatLngToDivPixel(new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()));r!==null&&(r.x+=this.gridSize,r.y-=this.gridSize);var s=n.fromLatLngToDivPixel(new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()));if(s!==null&&(s.x-=this.gridSize,s.y+=this.gridSize),r!==null){var i=n.fromDivPixelToLatLng(r);i!==null&&e.extend(i)}if(s!==null){var o=n.fromDivPixelToLatLng(s);o!==null&&e.extend(o)}return e},t.prototype.redraw=function(){this.createClusters(0)},t.prototype.resetViewport=function(e){for(var n=0,r=this.clusters;n<r.length;n++){var s=r[n];s.remove()}this.clusters=[];for(var i=0,o=this.markers;i<o.length;i++){var l=o[i];l.isAdded=!1,e&&l.setMap(null)}},t.prototype.distanceBetweenPoints=function(e,n){var r=6371,s=(n.lat()-e.lat())*Math.PI/180,i=(n.lng()-e.lng())*Math.PI/180,o=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(n.lat()*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return r*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))},t.prototype.isMarkerInBounds=function(e,n){var r=e.getPosition();return r?n.contains(r):!1},t.prototype.addToClosestCluster=function(e){for(var n,r=4e4,s=null,i=0,o=this.clusters;i<o.length;i++){var l=o[i];n=l;var c=n.getCenter(),u=e.getPosition();if(c&&u){var d=this.distanceBetweenPoints(c,u);d<r&&(r=d,s=n)}}s&&s.isMarkerInClusterBounds(e)?s.addMarker(e):(n=new RU(this),n.addMarker(e),this.clusters.push(n))},t.prototype.createClusters=function(e){var n=this;if(this.ready){e===0&&(google.maps.event.trigger(this,"clusteringbegin",this),this.timerRefStatic!==null&&(window.clearTimeout(this.timerRefStatic),delete this.timerRefStatic));for(var r=this.getMap(),s=r!==null&&("getBounds"in r)?r.getBounds():null,i=(r==null?void 0:r.getZoom())||0,o=i>3?new google.maps.LatLngBounds(s==null?void 0:s.getSouthWest(),s==null?void 0:s.getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625)),l=this.getExtendedBounds(o),c=Math.min(e+this.batchSize,this.markers.length),u=e;u<c;u++){var d=this.markers[u];d&&!d.isAdded&&this.isMarkerInBounds(d,l)&&(!this.ignoreHidden||this.ignoreHidden&&d.getVisible())&&this.addToClosestCluster(d)}if(c<this.markers.length)this.timerRefStatic=window.setTimeout(function(){n.createClusters(c)},0);else{this.timerRefStatic=null,google.maps.event.trigger(this,"clusteringend",this);for(var f=0,g=this.clusters;f<g.length;f++){var v=g[f];v.updateIcon()}}}},t.prototype.extend=function(e,n){return(function(s){for(var i in s.prototype){var o=i;this.prototype[o]=s.prototype[o]}return this}).apply(e,[n])},t}();function r_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function zU(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?r_(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Xn={onClick:"click",onClusteringBegin:"clusteringbegin",onClusteringEnd:"clusteringend",onMouseOut:"mouseout",onMouseOver:"mouseover"},Xe={averageCenter(t,e){t.setAverageCenter(e)},batchSizeIE(t,e){t.setBatchSizeIE(e)},calculator(t,e){t.setCalculator(e)},clusterClass(t,e){t.setClusterClass(e)},enableRetinaIcons(t,e){t.setEnableRetinaIcons(e)},gridSize(t,e){t.setGridSize(e)},ignoreHidden(t,e){t.setIgnoreHidden(e)},imageExtension(t,e){t.setImageExtension(e)},imagePath(t,e){t.setImagePath(e)},imageSizes(t,e){t.setImageSizes(e)},maxZoom(t,e){t.setMaxZoom(e)},minimumClusterSize(t,e){t.setMinimumClusterSize(e)},styles(t,e){t.setStyles(e)},title(t,e){t.setTitle(e)},zoomOnClick(t,e){t.setZoomOnClick(e)}},UU={};function $U(t){var{children:e,options:n,averageCenter:r,batchSizeIE:s,calculator:i,clusterClass:o,enableRetinaIcons:l,gridSize:c,ignoreHidden:u,imageExtension:d,imagePath:f,imageSizes:g,maxZoom:v,minimumClusterSize:x,styles:E,title:y,zoomOnClick:h,onClick:C,onClusteringBegin:T,onClusteringEnd:k,onMouseOver:_,onMouseOut:S,onLoad:N,onUnmount:b}=t,[w,A]=p.useState(null),R=p.useContext(Ve),[L,M]=p.useState(null),[F,U]=p.useState(null),[D,j]=p.useState(null),[V,z]=p.useState(null),[G,Y]=p.useState(null);return p.useEffect(()=>{w&&S&&(V!==null&&google.maps.event.removeListener(V),z(google.maps.event.addListener(w,Xn.onMouseOut,S)))},[S]),p.useEffect(()=>{w&&_&&(G!==null&&google.maps.event.removeListener(G),Y(google.maps.event.addListener(w,Xn.onMouseOver,_)))},[_]),p.useEffect(()=>{w&&C&&(L!==null&&google.maps.event.removeListener(L),M(google.maps.event.addListener(w,Xn.onClick,C)))},[C]),p.useEffect(()=>{w&&T&&(F!==null&&google.maps.event.removeListener(F),U(google.maps.event.addListener(w,Xn.onClusteringBegin,T)))},[T]),p.useEffect(()=>{w&&k&&(D!==null&&google.maps.event.removeListener(D),U(google.maps.event.addListener(w,Xn.onClusteringEnd,k)))},[k]),p.useEffect(()=>{typeof r<"u"&&w!==null&&Xe.averageCenter(w,r)},[w,r]),p.useEffect(()=>{typeof s<"u"&&w!==null&&Xe.batchSizeIE(w,s)},[w,s]),p.useEffect(()=>{typeof i<"u"&&w!==null&&Xe.calculator(w,i)},[w,i]),p.useEffect(()=>{typeof o<"u"&&w!==null&&Xe.clusterClass(w,o)},[w,o]),p.useEffect(()=>{typeof l<"u"&&w!==null&&Xe.enableRetinaIcons(w,l)},[w,l]),p.useEffect(()=>{typeof c<"u"&&w!==null&&Xe.gridSize(w,c)},[w,c]),p.useEffect(()=>{typeof u<"u"&&w!==null&&Xe.ignoreHidden(w,u)},[w,u]),p.useEffect(()=>{typeof d<"u"&&w!==null&&Xe.imageExtension(w,d)},[w,d]),p.useEffect(()=>{typeof f<"u"&&w!==null&&Xe.imagePath(w,f)},[w,f]),p.useEffect(()=>{typeof g<"u"&&w!==null&&Xe.imageSizes(w,g)},[w,g]),p.useEffect(()=>{typeof v<"u"&&w!==null&&Xe.maxZoom(w,v)},[w,v]),p.useEffect(()=>{typeof x<"u"&&w!==null&&Xe.minimumClusterSize(w,x)},[w,x]),p.useEffect(()=>{typeof E<"u"&&w!==null&&Xe.styles(w,E)},[w,E]),p.useEffect(()=>{typeof y<"u"&&w!==null&&Xe.title(w,y)},[w,y]),p.useEffect(()=>{typeof h<"u"&&w!==null&&Xe.zoomOnClick(w,h)},[w,h]),p.useEffect(()=>{if(R){var Z=zU({},n||UU),H=new gT(R,[],Z);return r&&Xe.averageCenter(H,r),s&&Xe.batchSizeIE(H,s),i&&Xe.calculator(H,i),o&&Xe.clusterClass(H,o),l&&Xe.enableRetinaIcons(H,l),c&&Xe.gridSize(H,c),u&&Xe.ignoreHidden(H,u),d&&Xe.imageExtension(H,d),f&&Xe.imagePath(H,f),g&&Xe.imageSizes(H,g),v&&Xe.maxZoom(H,v),x&&Xe.minimumClusterSize(H,x),E&&Xe.styles(H,E),y&&Xe.title(H,y),h&&Xe.zoomOnClick(H,h),S&&z(google.maps.event.addListener(H,Xn.onMouseOut,S)),_&&Y(google.maps.event.addListener(H,Xn.onMouseOver,_)),C&&M(google.maps.event.addListener(H,Xn.onClick,C)),T&&U(google.maps.event.addListener(H,Xn.onClusteringBegin,T)),k&&j(google.maps.event.addListener(H,Xn.onClusteringEnd,k)),A(H),N&&N(H),()=>{V!==null&&google.maps.event.removeListener(V),G!==null&&google.maps.event.removeListener(G),L!==null&&google.maps.event.removeListener(L),F!==null&&google.maps.event.removeListener(F),D!==null&&google.maps.event.removeListener(D),b&&b(H)}}},[]),w!==null&&e(w)||null}p.memo($U);class BU extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[]),X(this,"state",{markerClusterer:null}),X(this,"setClustererCallback",()=>{this.state.markerClusterer!==null&&this.props.onLoad&&this.props.onLoad(this.state.markerClusterer)})}componentDidMount(){if(this.context){var e=new gT(this.context,[],this.props.options);this.registeredEvents=Fe({updaterMap:Xe,eventMap:Xn,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({markerClusterer:e}),this.setClustererCallback)}}componentDidUpdate(e){this.state.markerClusterer&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:Xe,eventMap:Xn,prevProps:e,nextProps:this.props,instance:this.state.markerClusterer}))}componentWillUnmount(){this.state.markerClusterer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.markerClusterer),$e(this.registeredEvents),this.state.markerClusterer.setMap(null))}render(){return this.state.markerClusterer!==null?this.props.children(this.state.markerClusterer):null}}X(BU,"contextType",Ve);function a_(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}var vT=function(){function t(e){e===void 0&&(e={}),this.getCloseClickHandler=this.getCloseClickHandler.bind(this),this.closeClickHandler=this.closeClickHandler.bind(this),this.createInfoBoxDiv=this.createInfoBoxDiv.bind(this),this.addClickHandler=this.addClickHandler.bind(this),this.getCloseBoxImg=this.getCloseBoxImg.bind(this),this.getBoxWidths=this.getBoxWidths.bind(this),this.setBoxStyle=this.setBoxStyle.bind(this),this.setPosition=this.setPosition.bind(this),this.getPosition=this.getPosition.bind(this),this.setOptions=this.setOptions.bind(this),this.setContent=this.setContent.bind(this),this.setVisible=this.setVisible.bind(this),this.getContent=this.getContent.bind(this),this.getVisible=this.getVisible.bind(this),this.setZIndex=this.setZIndex.bind(this),this.getZIndex=this.getZIndex.bind(this),this.onRemove=this.onRemove.bind(this),this.panBox=this.panBox.bind(this),this.extend=this.extend.bind(this),this.close=this.close.bind(this),this.draw=this.draw.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.open=this.open.bind(this),this.extend(t,google.maps.OverlayView),this.content=e.content||"",this.disableAutoPan=e.disableAutoPan||!1,this.maxWidth=e.maxWidth||0,this.pixelOffset=e.pixelOffset||new google.maps.Size(0,0),this.position=e.position||new google.maps.LatLng(0,0),this.zIndex=e.zIndex||null,this.boxClass=e.boxClass||"infoBox",this.boxStyle=e.boxStyle||{},this.closeBoxMargin=e.closeBoxMargin||"2px",this.closeBoxURL=e.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",e.closeBoxURL===""&&(this.closeBoxURL=""),this.infoBoxClearance=e.infoBoxClearance||new google.maps.Size(1,1),typeof e.visible>"u"&&(typeof e.isHidden>"u"?e.visible=!0:e.visible=!e.isHidden),this.isHidden=!e.visible,this.alignBottom=e.alignBottom||!1,this.pane=e.pane||"floatPane",this.enableEventPropagation=e.enableEventPropagation||!1,this.div=null,this.closeListener=null,this.moveListener=null,this.mapListener=null,this.contextListener=null,this.eventListeners=null,this.fixedWidthSet=null}return t.prototype.createInfoBoxDiv=function(){var e=this,n=function(d){d.returnValue=!1,d.preventDefault&&d.preventDefault(),e.enableEventPropagation||a_(d)};if(!this.div){this.div=document.createElement("div"),this.setBoxStyle(),typeof this.content=="string"?this.div.innerHTML=this.getCloseBoxImg()+this.content:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(this.content));var r=this.getPanes();if(r!==null&&r[this.pane].appendChild(this.div),this.addClickHandler(),this.div.style.width)this.fixedWidthSet=!0;else if(this.maxWidth!==0&&this.div.offsetWidth>this.maxWidth)this.div.style.width=this.maxWidth+"px",this.fixedWidthSet=!0;else{var s=this.getBoxWidths();this.div.style.width=this.div.offsetWidth-s.left-s.right+"px",this.fixedWidthSet=!1}if(this.panBox(this.disableAutoPan),!this.enableEventPropagation){this.eventListeners=[];for(var i=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],o=0,l=i;o<l.length;o++){var c=l[o];this.eventListeners.push(google.maps.event.addListener(this.div,c,a_))}this.eventListeners.push(google.maps.event.addListener(this.div,"mouseover",function(){e.div&&(e.div.style.cursor="default")}))}this.contextListener=google.maps.event.addListener(this.div,"contextmenu",n),google.maps.event.trigger(this,"domready")}},t.prototype.getCloseBoxImg=function(){var e="";return this.closeBoxURL!==""&&(e='<img alt=""',e+=' aria-hidden="true"',e+=" src='"+this.closeBoxURL+"'",e+=" align=right",e+=" style='",e+=" position: relative;",e+=" cursor: pointer;",e+=" margin: "+this.closeBoxMargin+";",e+="'>"),e},t.prototype.addClickHandler=function(){this.closeListener=this.div&&this.div.firstChild&&this.closeBoxURL!==""?google.maps.event.addListener(this.div.firstChild,"click",this.getCloseClickHandler()):null},t.prototype.closeClickHandler=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(this,"closeclick"),this.close()},t.prototype.getCloseClickHandler=function(){return this.closeClickHandler},t.prototype.panBox=function(e){if(this.div&&!e){var n=this.getMap();if(n instanceof google.maps.Map){var r=0,s=0,i=n.getBounds();i&&!i.contains(this.position)&&n.setCenter(this.position);var o=n.getDiv(),l=o.offsetWidth,c=o.offsetHeight,u=this.pixelOffset.width,d=this.pixelOffset.height,f=this.div.offsetWidth,g=this.div.offsetHeight,v=this.infoBoxClearance.width,x=this.infoBoxClearance.height,E=this.getProjection(),y=E.fromLatLngToContainerPixel(this.position);y!==null&&(y.x<-u+v?r=y.x+u-v:y.x+f+u+v>l&&(r=y.x+f+u+v-l),this.alignBottom?y.y<-d+x+g?s=y.y+d-x-g:y.y+d+x>c&&(s=y.y+d+x-c):y.y<-d+x?s=y.y+d-x:y.y+g+d+x>c&&(s=y.y+g+d+x-c)),r===0&&s===0||n.panBy(r,s)}}},t.prototype.setBoxStyle=function(){if(this.div){this.div.className=this.boxClass,this.div.style.cssText="";var e=this.boxStyle;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(this.div.style[n]=e[n]);if(this.div.style.webkitTransform="translateZ(0)",typeof this.div.style.opacity<"u"&&this.div.style.opacity!==""){var r=parseFloat(this.div.style.opacity||"");this.div.style.msFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+r*100+')"',this.div.style.filter="alpha(opacity="+r*100+")"}this.div.style.position="absolute",this.div.style.visibility="hidden",this.zIndex!==null&&(this.div.style.zIndex=this.zIndex+""),this.div.style.overflow||(this.div.style.overflow="auto")}},t.prototype.getBoxWidths=function(){var e={top:0,bottom:0,left:0,right:0};if(!this.div)return e;if(document.defaultView){var n=this.div.ownerDocument,r=n&&n.defaultView?n.defaultView.getComputedStyle(this.div,""):null;r&&(e.top=parseInt(r.borderTopWidth||"",10)||0,e.bottom=parseInt(r.borderBottomWidth||"",10)||0,e.left=parseInt(r.borderLeftWidth||"",10)||0,e.right=parseInt(r.borderRightWidth||"",10)||0)}else if(document.documentElement.currentStyle){var s=this.div.currentStyle;s&&(e.top=parseInt(s.borderTopWidth||"",10)||0,e.bottom=parseInt(s.borderBottomWidth||"",10)||0,e.left=parseInt(s.borderLeftWidth||"",10)||0,e.right=parseInt(s.borderRightWidth||"",10)||0)}return e},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.div.parentNode.removeChild(this.div),this.div=null)},t.prototype.draw=function(){if(this.createInfoBoxDiv(),this.div){var e=this.getProjection(),n=e.fromLatLngToDivPixel(this.position);n!==null&&(this.div.style.left=n.x+this.pixelOffset.width+"px",this.alignBottom?this.div.style.bottom=-(n.y+this.pixelOffset.height)+"px":this.div.style.top=n.y+this.pixelOffset.height+"px"),this.isHidden?this.div.style.visibility="hidden":this.div.style.visibility="visible"}},t.prototype.setOptions=function(e){e===void 0&&(e={}),typeof e.boxClass<"u"&&(this.boxClass=e.boxClass,this.setBoxStyle()),typeof e.boxStyle<"u"&&(this.boxStyle=e.boxStyle,this.setBoxStyle()),typeof e.content<"u"&&this.setContent(e.content),typeof e.disableAutoPan<"u"&&(this.disableAutoPan=e.disableAutoPan),typeof e.maxWidth<"u"&&(this.maxWidth=e.maxWidth),typeof e.pixelOffset<"u"&&(this.pixelOffset=e.pixelOffset),typeof e.alignBottom<"u"&&(this.alignBottom=e.alignBottom),typeof e.position<"u"&&this.setPosition(e.position),typeof e.zIndex<"u"&&this.setZIndex(e.zIndex),typeof e.closeBoxMargin<"u"&&(this.closeBoxMargin=e.closeBoxMargin),typeof e.closeBoxURL<"u"&&(this.closeBoxURL=e.closeBoxURL),typeof e.infoBoxClearance<"u"&&(this.infoBoxClearance=e.infoBoxClearance),typeof e.isHidden<"u"&&(this.isHidden=e.isHidden),typeof e.visible<"u"&&(this.isHidden=!e.visible),typeof e.enableEventPropagation<"u"&&(this.enableEventPropagation=e.enableEventPropagation),this.div&&this.draw()},t.prototype.setContent=function(e){this.content=e,this.div&&(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.fixedWidthSet||(this.div.style.width=""),typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e)),this.fixedWidthSet||(this.div.style.width=this.div.offsetWidth+"px",typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e))),this.addClickHandler()),google.maps.event.trigger(this,"content_changed")},t.prototype.setPosition=function(e){this.position=e,this.div&&this.draw(),google.maps.event.trigger(this,"position_changed")},t.prototype.setVisible=function(e){this.isHidden=!e,this.div&&(this.div.style.visibility=this.isHidden?"hidden":"visible")},t.prototype.setZIndex=function(e){this.zIndex=e,this.div&&(this.div.style.zIndex=e+""),google.maps.event.trigger(this,"zindex_changed")},t.prototype.getContent=function(){return this.content},t.prototype.getPosition=function(){return this.position},t.prototype.getZIndex=function(){return this.zIndex},t.prototype.getVisible=function(){var e=this.getMap();return typeof e>"u"||e===null?!1:!this.isHidden},t.prototype.show=function(){this.isHidden=!1,this.div&&(this.div.style.visibility="visible")},t.prototype.hide=function(){this.isHidden=!0,this.div&&(this.div.style.visibility="hidden")},t.prototype.open=function(e,n){var r=this;n&&(this.position=n.getPosition(),this.moveListener=google.maps.event.addListener(n,"position_changed",function(){var s=n.getPosition();r.setPosition(s)}),this.mapListener=google.maps.event.addListener(n,"map_changed",function(){r.setMap(n.map)})),this.setMap(e),this.div&&this.panBox()},t.prototype.close=function(){if(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.eventListeners){for(var e=0,n=this.eventListeners;e<n.length;e++){var r=n[e];google.maps.event.removeListener(r)}this.eventListeners=null}this.moveListener&&(google.maps.event.removeListener(this.moveListener),this.moveListener=null),this.mapListener&&(google.maps.event.removeListener(this.mapListener),this.mapListener=null),this.contextListener&&(google.maps.event.removeListener(this.contextListener),this.contextListener=null),this.setMap(null)},t.prototype.extend=function(e,n){return(function(s){for(var i in s.prototype)Object.prototype.hasOwnProperty.call(this,i)||(this.prototype[i]=s.prototype[i]);return this}).apply(e,[n])},t}(),qU=["position"],WU=["position"];function s_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function $m(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?s_(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var i_={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},o_={options(t,e){t.setOptions(e)},position(t,e){e instanceof google.maps.LatLng?t.setPosition(e):t.setPosition(new google.maps.LatLng(e.lat,e.lng))},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},HU={};function GU(t){var{children:e,anchor:n,options:r,position:s,zIndex:i,onCloseClick:o,onDomReady:l,onContentChanged:c,onPositionChanged:u,onZindexChanged:d,onLoad:f,onUnmount:g}=t,v=p.useContext(Ve),[x,E]=p.useState(null),[y,h]=p.useState(null),[C,T]=p.useState(null),[k,_]=p.useState(null),[S,N]=p.useState(null),[b,w]=p.useState(null),A=p.useRef(null);return p.useEffect(()=>{v&&x!==null&&(x.close(),n?x.open(v,n):x.getPosition()&&x.open(v))},[v,x,n]),p.useEffect(()=>{r&&x!==null&&x.setOptions(r)},[x,r]),p.useEffect(()=>{if(s&&x!==null){var R=s instanceof google.maps.LatLng?s:new google.maps.LatLng(s.lat,s.lng);x.setPosition(R)}},[s]),p.useEffect(()=>{typeof i=="number"&&x!==null&&x.setZIndex(i)},[i]),p.useEffect(()=>{x&&o&&(y!==null&&google.maps.event.removeListener(y),h(google.maps.event.addListener(x,"closeclick",o)))},[o]),p.useEffect(()=>{x&&l&&(C!==null&&google.maps.event.removeListener(C),T(google.maps.event.addListener(x,"domready",l)))},[l]),p.useEffect(()=>{x&&c&&(k!==null&&google.maps.event.removeListener(k),_(google.maps.event.addListener(x,"content_changed",c)))},[c]),p.useEffect(()=>{x&&u&&(S!==null&&google.maps.event.removeListener(S),N(google.maps.event.addListener(x,"position_changed",u)))},[u]),p.useEffect(()=>{x&&d&&(b!==null&&google.maps.event.removeListener(b),w(google.maps.event.addListener(x,"zindex_changed",d)))},[d]),p.useEffect(()=>{if(v){var R=r||HU,{position:L}=R,M=Tb(R,qU),F;L&&!(L instanceof google.maps.LatLng)&&(F=new google.maps.LatLng(L.lat,L.lng));var U=new vT($m($m({},M),F?{position:F}:{}));A.current=document.createElement("div"),E(U),o&&h(google.maps.event.addListener(U,"closeclick",o)),l&&T(google.maps.event.addListener(U,"domready",l)),c&&_(google.maps.event.addListener(U,"content_changed",c)),u&&N(google.maps.event.addListener(U,"position_changed",u)),d&&w(google.maps.event.addListener(U,"zindex_changed",d)),U.setContent(A.current),n?U.open(v,n):U.getPosition()?U.open(v):Ht(!1,"You must provide either an anchor or a position prop for <InfoBox>."),f&&f(U)}return()=>{x!==null&&(y&&google.maps.event.removeListener(y),k&&google.maps.event.removeListener(k),C&&google.maps.event.removeListener(C),S&&google.maps.event.removeListener(S),b&&google.maps.event.removeListener(b),g&&g(x),x.close())}},[]),A.current?yi.createPortal(p.Children.only(e),A.current):null}p.memo(GU);class KU extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[]),X(this,"containerElement",null),X(this,"state",{infoBox:null}),X(this,"open",(e,n)=>{n?this.context!==null&&e.open(this.context,n):e.getPosition()?this.context!==null&&e.open(this.context):Ht(!1,"You must provide either an anchor or a position prop for <InfoBox>.")}),X(this,"setInfoBoxCallback",()=>{this.state.infoBox!==null&&this.containerElement!==null&&(this.state.infoBox.setContent(this.containerElement),this.open(this.state.infoBox,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoBox))})}componentDidMount(){var e=this.props.options||{},{position:n}=e,r=Tb(e,WU),s;n&&!(n instanceof google.maps.LatLng)&&(s=new google.maps.LatLng(n.lat,n.lng));var i=new vT($m($m({},r),s?{position:s}:{}));this.containerElement=document.createElement("div"),this.registeredEvents=Fe({updaterMap:o_,eventMap:i_,prevProps:{},nextProps:this.props,instance:i}),this.setState({infoBox:i},this.setInfoBoxCallback)}componentDidUpdate(e){var{infoBox:n}=this.state;n!==null&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:o_,eventMap:i_,prevProps:e,nextProps:this.props,instance:n}))}componentWillUnmount(){var{onUnmount:e}=this.props,{infoBox:n}=this.state;n!==null&&(e&&e(n),$e(this.registeredEvents),n.close())}render(){return this.containerElement?yi.createPortal(p.Children.only(this.props.children),this.containerElement):null}}X(KU,"contextType",Ve);var sh,l_;function QU(){return l_||(l_=1,sh=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,s,i;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(s=r;s--!==0;)if(!t(e[s],n[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(i=Object.keys(e),r=i.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[s]))return!1;for(s=r;s--!==0;){var o=i[s];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}),sh}var JU=QU(),c_=lT(JU),u_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],ih=1,Ol=8;class Ab{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var[n,r]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");var s=r>>4;if(s!==ih)throw new Error("Got v".concat(s," data when expected v").concat(ih,"."));var i=u_[r&15];if(!i)throw new Error("Unrecognized array type.");var[o]=new Uint16Array(e,2,1),[l]=new Uint32Array(e,4,1);return new Ab(l,o,i,e)}constructor(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,s=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;var i=u_.indexOf(this.ArrayType),o=e*2*this.ArrayType.BYTES_PER_ELEMENT,l=e*this.IndexArrayType.BYTES_PER_ELEMENT,c=(8-l%8)%8;if(i<0)throw new Error("Unexpected typed array class: ".concat(r,"."));s&&s instanceof ArrayBuffer?(this.data=s,this.ids=new this.IndexArrayType(this.data,Ol,e),this.coords=new this.ArrayType(this.data,Ol+l+c,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(Ol+o+l+c),this.ids=new this.IndexArrayType(this.data,Ol,e),this.coords=new this.ArrayType(this.data,Ol+l+c,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(ih<<4)+i]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){var r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=n,r}finish(){var e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return Wg(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:i,coords:o,nodeSize:l}=this,c=[0,i.length-1,0],u=[];c.length;){var d=c.pop()||0,f=c.pop()||0,g=c.pop()||0;if(f-g<=l){for(var v=g;v<=f;v++){var x=o[2*v],E=o[2*v+1];x>=e&&x<=r&&E>=n&&E<=s&&u.push(i[v])}continue}var y=g+f>>1,h=o[2*y],C=o[2*y+1];h>=e&&h<=r&&C>=n&&C<=s&&u.push(i[y]),(d===0?e<=h:n<=C)&&(c.push(g),c.push(y-1),c.push(1-d)),(d===0?r>=h:s>=C)&&(c.push(y+1),c.push(f),c.push(1-d))}return u}within(e,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:s,coords:i,nodeSize:o}=this,l=[0,s.length-1,0],c=[],u=r*r;l.length;){var d=l.pop()||0,f=l.pop()||0,g=l.pop()||0;if(f-g<=o){for(var v=g;v<=f;v++)d_(i[2*v],i[2*v+1],e,n)<=u&&c.push(s[v]);continue}var x=g+f>>1,E=i[2*x],y=i[2*x+1];d_(E,y,e,n)<=u&&c.push(s[x]),(d===0?e-r<=E:n-r<=y)&&(l.push(g),l.push(x-1),l.push(1-d)),(d===0?e+r>=E:n+r>=y)&&(l.push(x+1),l.push(f),l.push(1-d))}return c}}function Wg(t,e,n,r,s,i){if(!(s-r<=n)){var o=r+s>>1;bT(t,e,o,r,s,i),Wg(t,e,n,r,o-1,1-i),Wg(t,e,n,o+1,s,1-i)}}function bT(t,e,n,r,s,i){for(;s>r;){if(s-r>600){var o=s-r+1,l=n-r+1,c=Math.log(o),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(o-u)/o)*(l-o/2<0?-1:1),f=Math.max(r,Math.floor(n-l*u/o+d)),g=Math.min(s,Math.floor(n+(o-l)*u/o+d));bT(t,e,n,f,g,i)}var v=e[2*n+i],x=r,E=s;for(Vl(t,e,r,n),e[2*s+i]>v&&Vl(t,e,r,s);x<E;){for(Vl(t,e,x,E),x++,E--;e[2*x+i]<v;)x++;for(;e[2*E+i]>v;)E--}e[2*r+i]===v?Vl(t,e,r,E):(E++,Vl(t,e,E,s)),E<=n&&(r=E+1),n<=E&&(s=E-1)}}function Vl(t,e,n,r){oh(t,n,r),oh(e,2*n,2*r),oh(e,2*n+1,2*r+1)}function oh(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function d_(t,e,n,r){var s=t-n,i=e-r;return s*s+i*i}var YU={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},m_=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),As=2,Ma=3,lh=4,Ra=5,yT=6;class ZU{constructor(e){this.options=Object.assign(Object.create(YU),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){var{log:n,minZoom:r,maxZoom:s}=this.options;n&&console.time("total time");var i="prepare ".concat(e.length," points");n&&console.time(i),this.points=e;for(var o=[],l=0;l<e.length;l++){var c=e[l];if(c.geometry){var[u,d]=c.geometry.coordinates,f=m_(dd(u)),g=m_(md(d));o.push(f,g,1/0,l,-1,1),this.options.reduce&&o.push(0)}}var v=this.trees[s+1]=this._createTree(o);n&&console.timeEnd(i);for(var x=s;x>=r;x--){var E=+Date.now();v=this.trees[x]=this._createTree(this._cluster(v,x)),n&&console.log("z%d: %d clusters in %dms",x,v.numItems,+Date.now()-E)}return n&&console.timeEnd("total time"),this}getClusters(e,n){var r=((e[0]+180)%360+360)%360-180,s=Math.max(-90,Math.min(90,e[1])),i=e[2]===180?180:((e[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,i=180;else if(r>i){var l=this.getClusters([r,s,180,o],n),c=this.getClusters([-180,s,i,o],n);return l.concat(c)}var u=this.trees[this._limitZoom(n)],d=u.range(dd(r),md(o),dd(i),md(s)),f=u.data,g=[];for(var v of d){var x=this.stride*v;g.push(f[x+Ra]>1?p_(f,x,this.clusterProps):this.points[f[x+Ma]])}return g}getChildren(e){var n=this._getOriginId(e),r=this._getOriginZoom(e),s="No cluster with the specified id.",i=this.trees[r];if(!i)throw new Error(s);var o=i.data;if(n*this.stride>=o.length)throw new Error(s);var l=this.options.radius/(this.options.extent*Math.pow(2,r-1)),c=o[n*this.stride],u=o[n*this.stride+1],d=i.within(c,u,l),f=[];for(var g of d){var v=g*this.stride;o[v+lh]===e&&f.push(o[v+Ra]>1?p_(o,v,this.clusterProps):this.points[o[v+Ma]])}if(f.length===0)throw new Error(s);return f}getLeaves(e,n,r){n=n||10,r=r||0;var s=[];return this._appendLeaves(s,e,n,r,0),s}getTile(e,n,r){var s=this.trees[this._limitZoom(e)],i=Math.pow(2,e),{extent:o,radius:l}=this.options,c=l/o,u=(r-c)/i,d=(r+1+c)/i,f={features:[]};return this._addTileFeatures(s.range((n-c)/i,u,(n+1+c)/i,d),s.data,n,r,i,f),n===0&&this._addTileFeatures(s.range(1-c/i,u,1,d),s.data,i,r,i,f),n===i-1&&this._addTileFeatures(s.range(0,u,c/i,d),s.data,-1,r,i,f),f.features.length?f:null}getClusterExpansionZoom(e){for(var n=this._getOriginZoom(e)-1;n<=this.options.maxZoom;){var r=this.getChildren(e);if(n++,r.length!==1)break;e=r[0].properties.cluster_id}return n}_appendLeaves(e,n,r,s,i){var o=this.getChildren(n);for(var l of o){var c=l.properties;if(c&&c.cluster?i+c.point_count<=s?i+=c.point_count:i=this._appendLeaves(e,c.cluster_id,r,s,i):i<s?i++:e.push(l),e.length===r)break}return i}_createTree(e){for(var n=new Ab(e.length/this.stride|0,this.options.nodeSize,Float32Array),r=0;r<e.length;r+=this.stride)n.add(e[r],e[r+1]);return n.finish(),n.data=e,n}_addTileFeatures(e,n,r,s,i,o){for(var l of e){var c=l*this.stride,u=n[c+Ra]>1,d=void 0,f=void 0,g=void 0;if(u)d=ET(n,c,this.clusterProps),f=n[c],g=n[c+1];else{var v=this.points[n[c+Ma]];d=v.properties;var[x,E]=v.geometry.coordinates;f=dd(x),g=md(E)}var y={type:1,geometry:[[Math.round(this.options.extent*(f*i-r)),Math.round(this.options.extent*(g*i-s))]],tags:d},h=void 0;u||this.options.generateId?h=n[c+Ma]:h=this.points[n[c+Ma]].id,h!==void 0&&(y.id=h),o.features.push(y)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,n){for(var{radius:r,extent:s,reduce:i,minPoints:o}=this.options,l=r/(s*Math.pow(2,n)),c=e.data,u=[],d=this.stride,f=0;f<c.length;f+=d)if(!(c[f+As]<=n)){c[f+As]=n;var g=c[f],v=c[f+1],x=e.within(c[f],c[f+1],l),E=c[f+Ra],y=E;for(var h of x){var C=h*d;c[C+As]>n&&(y+=c[C+Ra])}if(y>E&&y>=o){var T=g*E,k=v*E,_=void 0,S=-1,N=((f/d|0)<<5)+(n+1)+this.points.length;for(var b of x){var w=b*d;if(!(c[w+As]<=n)){c[w+As]=n;var A=c[w+Ra];T+=c[w]*A,k+=c[w+1]*A,c[w+lh]=N,i&&(_||(_=this._map(c,f,!0),S=this.clusterProps.length,this.clusterProps.push(_)),i(_,this._map(c,w)))}}c[f+lh]=N,u.push(T/y,k/y,1/0,N,-1,y),i&&u.push(S)}else{for(var R=0;R<d;R++)u.push(c[f+R]);if(y>1)for(var L of x){var M=L*d;if(!(c[M+As]<=n)){c[M+As]=n;for(var F=0;F<d;F++)u.push(c[M+F])}}}}return u}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,n,r){if(e[n+Ra]>1){var s=this.clusterProps[e[n+yT]];return r?Object.assign({},s):s}var i=this.points[e[n+Ma]].properties,o=this.options.map(i);return r&&o===i?Object.assign({},o):o}}function p_(t,e,n){return{type:"Feature",id:t[e+Ma],properties:ET(t,e,n),geometry:{type:"Point",coordinates:[XU(t[e]),e8(t[e+1])]}}}function ET(t,e,n){var r=t[e+Ra],s=r>=1e4?"".concat(Math.round(r/1e3),"k"):r>=1e3?"".concat(Math.round(r/100)/10,"k"):r,i=t[e+yT],o=i===-1?{}:Object.assign({},n[i]);return Object.assign(o,{cluster:!0,cluster_id:t[e+Ma],point_count:r,point_count_abbreviated:s})}function dd(t){return t/360+.5}function md(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function XU(t){return(t-.5)*360}function e8(t){var e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function t8(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}class Bn{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,n){this.isAdvancedMarker(e)?e.map=n:e.setMap(n)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class Hg{constructor(e){var{markers:n,position:r}=e;this.markers=n,r&&(r instanceof google.maps.LatLng?this._position=r:this._position=new google.maps.LatLng(r))}get bounds(){if(!(this.markers.length===0&&!this._position)){var e=new google.maps.LatLngBounds(this._position,this._position);for(var n of this.markers)e.extend(Bn.getPosition(n));return e}}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>Bn.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(Bn.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class n8{constructor(e){var{maxZoom:n=16}=e;this.maxZoom=n}noop(e){var{markers:n}=e;return r8(n)}}var r8=t=>{var e=t.map(n=>new Hg({position:Bn.getPosition(n),markers:[n]}));return e};class a8 extends n8{constructor(e){var{maxZoom:n,radius:r=60}=e,s=t8(e,["maxZoom","radius"]);super({maxZoom:n}),this.state={zoom:-1},this.superCluster=new ZU(Object.assign({maxZoom:this.maxZoom,radius:r},s))}calculate(e){var n=!1,r={zoom:e.map.getZoom()};if(!c_(e.markers,this.markers)){n=!0,this.markers=[...e.markers];var s=this.markers.map(i=>{var o=Bn.getPosition(i),l=[o.lng(),o.lat()];return{type:"Feature",geometry:{type:"Point",coordinates:l},properties:{marker:i}}});this.superCluster.load(s)}return n||(this.state.zoom<=this.maxZoom||r.zoom<=this.maxZoom)&&(n=!c_(this.state,r)),this.state=r,n&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:n}}cluster(e){var{map:n}=e;return this.superCluster.getClusters([-180,-90,180,90],Math.round(n.getZoom())).map(r=>this.transformCluster(r))}transformCluster(e){var{geometry:{coordinates:[n,r]},properties:s}=e;if(s.cluster)return new Hg({markers:this.superCluster.getLeaves(s.cluster_id,1/0).map(o=>o.properties.marker),position:{lat:r,lng:n}});var i=s.marker;return new Hg({markers:[i],position:Bn.getPosition(i)})}}class s8{constructor(e,n){this.markers={sum:e.length};var r=n.map(i=>i.count),s=r.reduce((i,o)=>i+o,0);this.clusters={count:n.length,markers:{mean:s/n.length,sum:s,min:Math.min(...r),max:Math.max(...r)}}}}class i8{render(e,n,r){var{count:s,position:i}=e,o=s>Math.max(10,n.clusters.markers.mean)?"#ff0000":"#0000ff",l='<svg fill="'.concat(o,`" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">`).concat(s,`</text>
</svg>`),c="Cluster of ".concat(s," markers"),u=Number(google.maps.Marker.MAX_ZINDEX)+s;if(Bn.isAdvancedMarkerAvailable(r)){var d=new DOMParser,f=d.parseFromString(l,"image/svg+xml").documentElement;f.setAttribute("transform","translate(0 25)");var g={map:r,position:i,zIndex:u,title:c,content:f};return new google.maps.marker.AdvancedMarkerElement(g)}var v={position:i,zIndex:u,title:c,icon:{url:"data:image/svg+xml;base64,".concat(btoa(l)),anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(v)}}function o8(t,e){for(var n in e.prototype)t.prototype[n]=e.prototype[n]}class Pb{constructor(){o8(Pb,google.maps.OverlayView)}}var uc;(function(t){t.CLUSTERING_BEGIN="clusteringbegin",t.CLUSTERING_END="clusteringend",t.CLUSTER_CLICK="click"})(uc||(uc={}));var l8=(t,e,n)=>{n.fitBounds(e.bounds)};class c8 extends Pb{constructor(e){var{map:n,markers:r=[],algorithmOptions:s={},algorithm:i=new a8(s),renderer:o=new i8,onClusterClick:l=l8}=e;super(),this.markers=[...r],this.clusters=[],this.algorithm=i,this.renderer=o,this.onClusterClick=l,n&&this.setMap(n)}addMarker(e,n){this.markers.includes(e)||(this.markers.push(e),n||this.render())}addMarkers(e,n){e.forEach(r=>{this.addMarker(r,!0)}),n||this.render()}removeMarker(e,n){var r=this.markers.indexOf(e);return r===-1?!1:(Bn.setMap(e,null),this.markers.splice(r,1),n||this.render(),!0)}removeMarkers(e,n){var r=!1;return e.forEach(s=>{r=this.removeMarker(s,!0)||r}),r&&!n&&this.render(),r}clearMarkers(e){this.markers.length=0,e||this.render()}render(){var e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,uc.CLUSTERING_BEGIN,this);var{clusters:n,changed:r}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(r||r==null){var s=new Set;for(var i of n)i.markers.length==1&&s.add(i.markers[0]);var o=[];for(var l of this.clusters)l.marker!=null&&(l.markers.length==1?s.has(l.marker)||Bn.setMap(l.marker,null):o.push(l.marker));this.clusters=n,this.renderClusters(),requestAnimationFrame(()=>o.forEach(c=>Bn.setMap(c,null)))}google.maps.event.trigger(this,uc.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>Bn.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){var e=new s8(this.markers,this.clusters),n=this.getMap();this.clusters.forEach(r=>{r.markers.length===1?r.marker=r.markers[0]:(r.marker=this.renderer.render(r,e,n),r.markers.forEach(s=>Bn.setMap(s,null)),this.onClusterClick&&r.marker.addListener("click",s=>{google.maps.event.trigger(this,uc.CLUSTER_CLICK,r),this.onClusterClick(s,r,n)})),Bn.setMap(r.marker,n)})}}function f_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function h_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?f_(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function u8(t){var e=cU(),[n,r]=p.useState(null);return p.useEffect(()=>{if(e&&n===null){var s=new c8(h_(h_({},t),{},{map:e}));r(s)}},[e]),n}function d8(t){var{children:e,options:n}=t,r=u8(n);return r!==null?e(r):null}p.memo(d8);var g_={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},v_={options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},zIndex(t,e){t.setZIndex(e)}};function m8(t){var{children:e,anchor:n,options:r,position:s,zIndex:i,onCloseClick:o,onDomReady:l,onContentChanged:c,onPositionChanged:u,onZindexChanged:d,onLoad:f,onUnmount:g}=t,v=p.useContext(Ve),[x,E]=p.useState(null),[y,h]=p.useState(null),[C,T]=p.useState(null),[k,_]=p.useState(null),[S,N]=p.useState(null),[b,w]=p.useState(null),A=p.useRef(null);return p.useEffect(()=>{x!==null&&(x.close(),n?x.open(v,n):x.getPosition()&&x.open(v))},[v,x,n]),p.useEffect(()=>{r&&x!==null&&x.setOptions(r)},[x,r]),p.useEffect(()=>{s&&x!==null&&x.setPosition(s)},[s]),p.useEffect(()=>{typeof i=="number"&&x!==null&&x.setZIndex(i)},[i]),p.useEffect(()=>{x&&o&&(y!==null&&google.maps.event.removeListener(y),h(google.maps.event.addListener(x,"closeclick",o)))},[o]),p.useEffect(()=>{x&&l&&(C!==null&&google.maps.event.removeListener(C),T(google.maps.event.addListener(x,"domready",l)))},[l]),p.useEffect(()=>{x&&c&&(k!==null&&google.maps.event.removeListener(k),_(google.maps.event.addListener(x,"content_changed",c)))},[c]),p.useEffect(()=>{x&&u&&(S!==null&&google.maps.event.removeListener(S),N(google.maps.event.addListener(x,"position_changed",u)))},[u]),p.useEffect(()=>{x&&d&&(b!==null&&google.maps.event.removeListener(b),w(google.maps.event.addListener(x,"zindex_changed",d)))},[d]),p.useEffect(()=>{var R=new google.maps.InfoWindow(r);return E(R),A.current=document.createElement("div"),o&&h(google.maps.event.addListener(R,"closeclick",o)),l&&T(google.maps.event.addListener(R,"domready",l)),c&&_(google.maps.event.addListener(R,"content_changed",c)),u&&N(google.maps.event.addListener(R,"position_changed",u)),d&&w(google.maps.event.addListener(R,"zindex_changed",d)),R.setContent(A.current),s&&R.setPosition(s),i&&R.setZIndex(i),n?R.open(v,n):R.getPosition()?R.open(v):Ht(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>."),f&&f(R),()=>{y&&google.maps.event.removeListener(y),k&&google.maps.event.removeListener(k),C&&google.maps.event.removeListener(C),S&&google.maps.event.removeListener(S),b&&google.maps.event.removeListener(b),g&&g(R),R.close()}},[]),A.current?yi.createPortal(p.Children.only(e),A.current):null}p.memo(m8);class p8 extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[]),X(this,"containerElement",null),X(this,"state",{infoWindow:null}),X(this,"open",(e,n)=>{n?e.open(this.context,n):e.getPosition()?e.open(this.context):Ht(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>.")}),X(this,"setInfoWindowCallback",()=>{this.state.infoWindow!==null&&this.containerElement!==null&&(this.state.infoWindow.setContent(this.containerElement),this.open(this.state.infoWindow,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoWindow))})}componentDidMount(){var e=new google.maps.InfoWindow(this.props.options);this.containerElement=document.createElement("div"),this.registeredEvents=Fe({updaterMap:v_,eventMap:g_,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({infoWindow:e}),this.setInfoWindowCallback)}componentDidUpdate(e){this.state.infoWindow!==null&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:v_,eventMap:g_,prevProps:e,nextProps:this.props,instance:this.state.infoWindow}))}componentWillUnmount(){this.state.infoWindow!==null&&($e(this.registeredEvents),this.props.onUnmount&&this.props.onUnmount(this.state.infoWindow),this.state.infoWindow.close())}render(){return this.containerElement?yi.createPortal(p.Children.only(this.props.children),this.containerElement):null}}X(p8,"contextType",Ve);function b_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Bm(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?b_(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var y_={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},E_={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},visible(t,e){t.setVisible(e)}},f8={};function h8(t){var{options:e,draggable:n,editable:r,visible:s,path:i,onDblClick:o,onDragEnd:l,onDragStart:c,onMouseDown:u,onMouseMove:d,onMouseOut:f,onMouseOver:g,onMouseUp:v,onRightClick:x,onClick:E,onDrag:y,onLoad:h,onUnmount:C}=t,T=p.useContext(Ve),[k,_]=p.useState(null),[S,N]=p.useState(null),[b,w]=p.useState(null),[A,R]=p.useState(null),[L,M]=p.useState(null),[F,U]=p.useState(null),[D,j]=p.useState(null),[V,z]=p.useState(null),[G,Y]=p.useState(null),[Z,H]=p.useState(null),[oe,W]=p.useState(null),[he,xe]=p.useState(null);return p.useEffect(()=>{k!==null&&k.setMap(T)},[T]),p.useEffect(()=>{typeof e<"u"&&k!==null&&k.setOptions(e)},[k,e]),p.useEffect(()=>{typeof n<"u"&&k!==null&&k.setDraggable(n)},[k,n]),p.useEffect(()=>{typeof r<"u"&&k!==null&&k.setEditable(r)},[k,r]),p.useEffect(()=>{typeof s<"u"&&k!==null&&k.setVisible(s)},[k,s]),p.useEffect(()=>{typeof i<"u"&&k!==null&&k.setPath(i)},[k,i]),p.useEffect(()=>{k&&o&&(S!==null&&google.maps.event.removeListener(S),N(google.maps.event.addListener(k,"dblclick",o)))},[o]),p.useEffect(()=>{k&&l&&(b!==null&&google.maps.event.removeListener(b),w(google.maps.event.addListener(k,"dragend",l)))},[l]),p.useEffect(()=>{k&&c&&(A!==null&&google.maps.event.removeListener(A),R(google.maps.event.addListener(k,"dragstart",c)))},[c]),p.useEffect(()=>{k&&u&&(L!==null&&google.maps.event.removeListener(L),M(google.maps.event.addListener(k,"mousedown",u)))},[u]),p.useEffect(()=>{k&&d&&(F!==null&&google.maps.event.removeListener(F),U(google.maps.event.addListener(k,"mousemove",d)))},[d]),p.useEffect(()=>{k&&f&&(D!==null&&google.maps.event.removeListener(D),j(google.maps.event.addListener(k,"mouseout",f)))},[f]),p.useEffect(()=>{k&&g&&(V!==null&&google.maps.event.removeListener(V),z(google.maps.event.addListener(k,"mouseover",g)))},[g]),p.useEffect(()=>{k&&v&&(G!==null&&google.maps.event.removeListener(G),Y(google.maps.event.addListener(k,"mouseup",v)))},[v]),p.useEffect(()=>{k&&x&&(Z!==null&&google.maps.event.removeListener(Z),H(google.maps.event.addListener(k,"rightclick",x)))},[x]),p.useEffect(()=>{k&&E&&(oe!==null&&google.maps.event.removeListener(oe),W(google.maps.event.addListener(k,"click",E)))},[E]),p.useEffect(()=>{k&&y&&(he!==null&&google.maps.event.removeListener(he),xe(google.maps.event.addListener(k,"drag",y)))},[y]),p.useEffect(()=>{var ie=new google.maps.Polyline(Bm(Bm({},e||f8),{},{map:T}));return i&&ie.setPath(i),typeof s<"u"&&ie.setVisible(s),typeof r<"u"&&ie.setEditable(r),typeof n<"u"&&ie.setDraggable(n),o&&N(google.maps.event.addListener(ie,"dblclick",o)),l&&w(google.maps.event.addListener(ie,"dragend",l)),c&&R(google.maps.event.addListener(ie,"dragstart",c)),u&&M(google.maps.event.addListener(ie,"mousedown",u)),d&&U(google.maps.event.addListener(ie,"mousemove",d)),f&&j(google.maps.event.addListener(ie,"mouseout",f)),g&&z(google.maps.event.addListener(ie,"mouseover",g)),v&&Y(google.maps.event.addListener(ie,"mouseup",v)),x&&H(google.maps.event.addListener(ie,"rightclick",x)),E&&W(google.maps.event.addListener(ie,"click",E)),y&&xe(google.maps.event.addListener(ie,"drag",y)),_(ie),h&&h(ie),()=>{S!==null&&google.maps.event.removeListener(S),b!==null&&google.maps.event.removeListener(b),A!==null&&google.maps.event.removeListener(A),L!==null&&google.maps.event.removeListener(L),F!==null&&google.maps.event.removeListener(F),D!==null&&google.maps.event.removeListener(D),V!==null&&google.maps.event.removeListener(V),G!==null&&google.maps.event.removeListener(G),Z!==null&&google.maps.event.removeListener(Z),oe!==null&&google.maps.event.removeListener(oe),C&&C(ie),ie.setMap(null)}},[]),null}p.memo(h8);class g8 extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[]),X(this,"state",{polyline:null}),X(this,"setPolylineCallback",()=>{this.state.polyline!==null&&this.props.onLoad&&this.props.onLoad(this.state.polyline)})}componentDidMount(){var e=new google.maps.Polyline(Bm(Bm({},this.props.options),{},{map:this.context}));this.registeredEvents=Fe({updaterMap:E_,eventMap:y_,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{polyline:e}},this.setPolylineCallback)}componentDidUpdate(e){this.state.polyline!==null&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:E_,eventMap:y_,prevProps:e,nextProps:this.props,instance:this.state.polyline}))}componentWillUnmount(){this.state.polyline!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.polyline),$e(this.registeredEvents),this.state.polyline.setMap(null))}render(){return null}}X(g8,"contextType",Ve);function x_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function w_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?x_(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var __={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},N_={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},paths(t,e){t.setPaths(e)},visible(t,e){t.setVisible(e)}};function v8(t){var{options:e,draggable:n,editable:r,visible:s,path:i,paths:o,onDblClick:l,onDragEnd:c,onDragStart:u,onMouseDown:d,onMouseMove:f,onMouseOut:g,onMouseOver:v,onMouseUp:x,onRightClick:E,onClick:y,onDrag:h,onLoad:C,onUnmount:T,onEdit:k}=t,_=p.useContext(Ve),[S,N]=p.useState(null),[b,w]=p.useState(null),[A,R]=p.useState(null),[L,M]=p.useState(null),[F,U]=p.useState(null),[D,j]=p.useState(null),[V,z]=p.useState(null),[G,Y]=p.useState(null),[Z,H]=p.useState(null),[oe,W]=p.useState(null),[he,xe]=p.useState(null),[ie,be]=p.useState(null);return p.useEffect(()=>{S!==null&&S.setMap(_)},[_]),p.useEffect(()=>{typeof e<"u"&&S!==null&&S.setOptions(e)},[S,e]),p.useEffect(()=>{typeof n<"u"&&S!==null&&S.setDraggable(n)},[S,n]),p.useEffect(()=>{typeof r<"u"&&S!==null&&S.setEditable(r)},[S,r]),p.useEffect(()=>{typeof s<"u"&&S!==null&&S.setVisible(s)},[S,s]),p.useEffect(()=>{typeof i<"u"&&S!==null&&S.setPath(i)},[S,i]),p.useEffect(()=>{typeof o<"u"&&S!==null&&S.setPaths(o)},[S,o]),p.useEffect(()=>{S&&typeof l=="function"&&(b!==null&&google.maps.event.removeListener(b),w(google.maps.event.addListener(S,"dblclick",l)))},[l]),p.useEffect(()=>{S&&(google.maps.event.addListener(S.getPath(),"insert_at",()=>{k==null||k(S)}),google.maps.event.addListener(S.getPath(),"set_at",()=>{k==null||k(S)}),google.maps.event.addListener(S.getPath(),"remove_at",()=>{k==null||k(S)}))},[S,k]),p.useEffect(()=>{S&&typeof c=="function"&&(A!==null&&google.maps.event.removeListener(A),R(google.maps.event.addListener(S,"dragend",c)))},[c]),p.useEffect(()=>{S&&typeof u=="function"&&(L!==null&&google.maps.event.removeListener(L),M(google.maps.event.addListener(S,"dragstart",u)))},[u]),p.useEffect(()=>{S&&typeof d=="function"&&(F!==null&&google.maps.event.removeListener(F),U(google.maps.event.addListener(S,"mousedown",d)))},[d]),p.useEffect(()=>{S&&typeof f=="function"&&(D!==null&&google.maps.event.removeListener(D),j(google.maps.event.addListener(S,"mousemove",f)))},[f]),p.useEffect(()=>{S&&typeof g=="function"&&(V!==null&&google.maps.event.removeListener(V),z(google.maps.event.addListener(S,"mouseout",g)))},[g]),p.useEffect(()=>{S&&typeof v=="function"&&(G!==null&&google.maps.event.removeListener(G),Y(google.maps.event.addListener(S,"mouseover",v)))},[v]),p.useEffect(()=>{S&&typeof x=="function"&&(Z!==null&&google.maps.event.removeListener(Z),H(google.maps.event.addListener(S,"mouseup",x)))},[x]),p.useEffect(()=>{S&&typeof E=="function"&&(oe!==null&&google.maps.event.removeListener(oe),W(google.maps.event.addListener(S,"rightclick",E)))},[E]),p.useEffect(()=>{S&&typeof y=="function"&&(he!==null&&google.maps.event.removeListener(he),xe(google.maps.event.addListener(S,"click",y)))},[y]),p.useEffect(()=>{S&&typeof h=="function"&&(ie!==null&&google.maps.event.removeListener(ie),be(google.maps.event.addListener(S,"drag",h)))},[h]),p.useEffect(()=>{var ne=new google.maps.Polygon(w_(w_({},e),{},{map:_}));return i&&ne.setPath(i),o&&ne.setPaths(o),typeof s<"u"&&ne.setVisible(s),typeof r<"u"&&ne.setEditable(r),typeof n<"u"&&ne.setDraggable(n),l&&w(google.maps.event.addListener(ne,"dblclick",l)),c&&R(google.maps.event.addListener(ne,"dragend",c)),u&&M(google.maps.event.addListener(ne,"dragstart",u)),d&&U(google.maps.event.addListener(ne,"mousedown",d)),f&&j(google.maps.event.addListener(ne,"mousemove",f)),g&&z(google.maps.event.addListener(ne,"mouseout",g)),v&&Y(google.maps.event.addListener(ne,"mouseover",v)),x&&H(google.maps.event.addListener(ne,"mouseup",x)),E&&W(google.maps.event.addListener(ne,"rightclick",E)),y&&xe(google.maps.event.addListener(ne,"click",y)),h&&be(google.maps.event.addListener(ne,"drag",h)),N(ne),C&&C(ne),()=>{b!==null&&google.maps.event.removeListener(b),A!==null&&google.maps.event.removeListener(A),L!==null&&google.maps.event.removeListener(L),F!==null&&google.maps.event.removeListener(F),D!==null&&google.maps.event.removeListener(D),V!==null&&google.maps.event.removeListener(V),G!==null&&google.maps.event.removeListener(G),Z!==null&&google.maps.event.removeListener(Z),oe!==null&&google.maps.event.removeListener(oe),he!==null&&google.maps.event.removeListener(he),T&&T(ne),ne.setMap(null)}},[]),null}p.memo(v8);class b8 extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[])}componentDidMount(){var e=this.props.options||{};this.polygon=new google.maps.Polygon(e),this.polygon.setMap(this.context),this.registeredEvents=Fe({updaterMap:N_,eventMap:__,prevProps:{},nextProps:this.props,instance:this.polygon}),this.props.onLoad&&this.props.onLoad(this.polygon)}componentDidUpdate(e){this.polygon&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:N_,eventMap:__,prevProps:e,nextProps:this.props,instance:this.polygon}))}componentWillUnmount(){this.polygon&&(this.props.onUnmount&&this.props.onUnmount(this.polygon),$e(this.registeredEvents),this.polygon&&this.polygon.setMap(null))}render(){return null}}X(b8,"contextType",Ve);function C_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function qm(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?C_(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var S_={onBoundsChanged:"bounds_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},k_={bounds(t,e){t.setBounds(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},visible(t,e){t.setVisible(e)}};function y8(t){var{options:e,bounds:n,draggable:r,editable:s,visible:i,onDblClick:o,onDragEnd:l,onDragStart:c,onMouseDown:u,onMouseMove:d,onMouseOut:f,onMouseOver:g,onMouseUp:v,onRightClick:x,onClick:E,onDrag:y,onBoundsChanged:h,onLoad:C,onUnmount:T}=t,k=p.useContext(Ve),[_,S]=p.useState(null),[N,b]=p.useState(null),[w,A]=p.useState(null),[R,L]=p.useState(null),[M,F]=p.useState(null),[U,D]=p.useState(null),[j,V]=p.useState(null),[z,G]=p.useState(null),[Y,Z]=p.useState(null),[H,oe]=p.useState(null),[W,he]=p.useState(null),[xe,ie]=p.useState(null),[be,ne]=p.useState(null);return p.useEffect(()=>{_!==null&&_.setMap(k)},[k]),p.useEffect(()=>{typeof e<"u"&&_!==null&&_.setOptions(e)},[_,e]),p.useEffect(()=>{typeof r<"u"&&_!==null&&_.setDraggable(r)},[_,r]),p.useEffect(()=>{typeof s<"u"&&_!==null&&_.setEditable(s)},[_,s]),p.useEffect(()=>{typeof i<"u"&&_!==null&&_.setVisible(i)},[_,i]),p.useEffect(()=>{typeof n<"u"&&_!==null&&_.setBounds(n)},[_,n]),p.useEffect(()=>{_&&o&&(N!==null&&google.maps.event.removeListener(N),b(google.maps.event.addListener(_,"dblclick",o)))},[o]),p.useEffect(()=>{_&&l&&(w!==null&&google.maps.event.removeListener(w),A(google.maps.event.addListener(_,"dragend",l)))},[l]),p.useEffect(()=>{_&&c&&(R!==null&&google.maps.event.removeListener(R),L(google.maps.event.addListener(_,"dragstart",c)))},[c]),p.useEffect(()=>{_&&u&&(M!==null&&google.maps.event.removeListener(M),F(google.maps.event.addListener(_,"mousedown",u)))},[u]),p.useEffect(()=>{_&&d&&(U!==null&&google.maps.event.removeListener(U),D(google.maps.event.addListener(_,"mousemove",d)))},[d]),p.useEffect(()=>{_&&f&&(j!==null&&google.maps.event.removeListener(j),V(google.maps.event.addListener(_,"mouseout",f)))},[f]),p.useEffect(()=>{_&&g&&(z!==null&&google.maps.event.removeListener(z),G(google.maps.event.addListener(_,"mouseover",g)))},[g]),p.useEffect(()=>{_&&v&&(Y!==null&&google.maps.event.removeListener(Y),Z(google.maps.event.addListener(_,"mouseup",v)))},[v]),p.useEffect(()=>{_&&x&&(H!==null&&google.maps.event.removeListener(H),oe(google.maps.event.addListener(_,"rightclick",x)))},[x]),p.useEffect(()=>{_&&E&&(W!==null&&google.maps.event.removeListener(W),he(google.maps.event.addListener(_,"click",E)))},[E]),p.useEffect(()=>{_&&y&&(xe!==null&&google.maps.event.removeListener(xe),ie(google.maps.event.addListener(_,"drag",y)))},[y]),p.useEffect(()=>{_&&h&&(be!==null&&google.maps.event.removeListener(be),ne(google.maps.event.addListener(_,"bounds_changed",h)))},[h]),p.useEffect(()=>{var re=new google.maps.Rectangle(qm(qm({},e),{},{map:k}));return typeof i<"u"&&re.setVisible(i),typeof s<"u"&&re.setEditable(s),typeof r<"u"&&re.setDraggable(r),typeof n<"u"&&re.setBounds(n),o&&b(google.maps.event.addListener(re,"dblclick",o)),l&&A(google.maps.event.addListener(re,"dragend",l)),c&&L(google.maps.event.addListener(re,"dragstart",c)),u&&F(google.maps.event.addListener(re,"mousedown",u)),d&&D(google.maps.event.addListener(re,"mousemove",d)),f&&V(google.maps.event.addListener(re,"mouseout",f)),g&&G(google.maps.event.addListener(re,"mouseover",g)),v&&Z(google.maps.event.addListener(re,"mouseup",v)),x&&oe(google.maps.event.addListener(re,"rightclick",x)),E&&he(google.maps.event.addListener(re,"click",E)),y&&ie(google.maps.event.addListener(re,"drag",y)),h&&ne(google.maps.event.addListener(re,"bounds_changed",h)),S(re),C&&C(re),()=>{N!==null&&google.maps.event.removeListener(N),w!==null&&google.maps.event.removeListener(w),R!==null&&google.maps.event.removeListener(R),M!==null&&google.maps.event.removeListener(M),U!==null&&google.maps.event.removeListener(U),j!==null&&google.maps.event.removeListener(j),z!==null&&google.maps.event.removeListener(z),Y!==null&&google.maps.event.removeListener(Y),H!==null&&google.maps.event.removeListener(H),W!==null&&google.maps.event.removeListener(W),xe!==null&&google.maps.event.removeListener(xe),be!==null&&google.maps.event.removeListener(be),T&&T(re),re.setMap(null)}},[]),null}p.memo(y8);class E8 extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[]),X(this,"state",{rectangle:null}),X(this,"setRectangleCallback",()=>{this.state.rectangle!==null&&this.props.onLoad&&this.props.onLoad(this.state.rectangle)})}componentDidMount(){var e=new google.maps.Rectangle(qm(qm({},this.props.options),{},{map:this.context}));this.registeredEvents=Fe({updaterMap:k_,eventMap:S_,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{rectangle:e}},this.setRectangleCallback)}componentDidUpdate(e){this.state.rectangle!==null&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:k_,eventMap:S_,prevProps:e,nextProps:this.props,instance:this.state.rectangle}))}componentWillUnmount(){this.state.rectangle!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.rectangle),$e(this.registeredEvents),this.state.rectangle.setMap(null))}render(){return null}}X(E8,"contextType",Ve);function I_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Wm(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?I_(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var T_={onCenterChanged:"center_changed",onRadiusChanged:"radius_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},A_={center(t,e){t.setCenter(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},radius(t,e){t.setRadius(e)},visible(t,e){t.setVisible(e)}},x8={};function w8(t){var{options:e,center:n,radius:r,draggable:s,editable:i,visible:o,onDblClick:l,onDragEnd:c,onDragStart:u,onMouseDown:d,onMouseMove:f,onMouseOut:g,onMouseOver:v,onMouseUp:x,onRightClick:E,onClick:y,onDrag:h,onCenterChanged:C,onRadiusChanged:T,onLoad:k,onUnmount:_}=t,S=p.useContext(Ve),[N,b]=p.useState(null),[w,A]=p.useState(null),[R,L]=p.useState(null),[M,F]=p.useState(null),[U,D]=p.useState(null),[j,V]=p.useState(null),[z,G]=p.useState(null),[Y,Z]=p.useState(null),[H,oe]=p.useState(null),[W,he]=p.useState(null),[xe,ie]=p.useState(null),[be,ne]=p.useState(null),[re,Se]=p.useState(null),[Oe,je]=p.useState(null);return p.useEffect(()=>{N!==null&&N.setMap(S)},[S]),p.useEffect(()=>{typeof e<"u"&&N!==null&&N.setOptions(e)},[N,e]),p.useEffect(()=>{typeof s<"u"&&N!==null&&N.setDraggable(s)},[N,s]),p.useEffect(()=>{typeof i<"u"&&N!==null&&N.setEditable(i)},[N,i]),p.useEffect(()=>{typeof o<"u"&&N!==null&&N.setVisible(o)},[N,o]),p.useEffect(()=>{typeof r=="number"&&N!==null&&N.setRadius(r)},[N,r]),p.useEffect(()=>{typeof n<"u"&&N!==null&&N.setCenter(n)},[N,n]),p.useEffect(()=>{N&&l&&(w!==null&&google.maps.event.removeListener(w),A(google.maps.event.addListener(N,"dblclick",l)))},[l]),p.useEffect(()=>{N&&c&&(R!==null&&google.maps.event.removeListener(R),L(google.maps.event.addListener(N,"dragend",c)))},[c]),p.useEffect(()=>{N&&u&&(M!==null&&google.maps.event.removeListener(M),F(google.maps.event.addListener(N,"dragstart",u)))},[u]),p.useEffect(()=>{N&&d&&(U!==null&&google.maps.event.removeListener(U),D(google.maps.event.addListener(N,"mousedown",d)))},[d]),p.useEffect(()=>{N&&f&&(j!==null&&google.maps.event.removeListener(j),V(google.maps.event.addListener(N,"mousemove",f)))},[f]),p.useEffect(()=>{N&&g&&(z!==null&&google.maps.event.removeListener(z),G(google.maps.event.addListener(N,"mouseout",g)))},[g]),p.useEffect(()=>{N&&v&&(Y!==null&&google.maps.event.removeListener(Y),Z(google.maps.event.addListener(N,"mouseover",v)))},[v]),p.useEffect(()=>{N&&x&&(H!==null&&google.maps.event.removeListener(H),oe(google.maps.event.addListener(N,"mouseup",x)))},[x]),p.useEffect(()=>{N&&E&&(W!==null&&google.maps.event.removeListener(W),he(google.maps.event.addListener(N,"rightclick",E)))},[E]),p.useEffect(()=>{N&&y&&(xe!==null&&google.maps.event.removeListener(xe),ie(google.maps.event.addListener(N,"click",y)))},[y]),p.useEffect(()=>{N&&h&&(be!==null&&google.maps.event.removeListener(be),ne(google.maps.event.addListener(N,"drag",h)))},[h]),p.useEffect(()=>{N&&C&&(re!==null&&google.maps.event.removeListener(re),Se(google.maps.event.addListener(N,"center_changed",C)))},[y]),p.useEffect(()=>{N&&T&&(Oe!==null&&google.maps.event.removeListener(Oe),je(google.maps.event.addListener(N,"radius_changed",T)))},[T]),p.useEffect(()=>{var Ee=new google.maps.Circle(Wm(Wm({},e||x8),{},{map:S}));return typeof r=="number"&&Ee.setRadius(r),typeof n<"u"&&Ee.setCenter(n),typeof r=="number"&&Ee.setRadius(r),typeof o<"u"&&Ee.setVisible(o),typeof i<"u"&&Ee.setEditable(i),typeof s<"u"&&Ee.setDraggable(s),l&&A(google.maps.event.addListener(Ee,"dblclick",l)),c&&L(google.maps.event.addListener(Ee,"dragend",c)),u&&F(google.maps.event.addListener(Ee,"dragstart",u)),d&&D(google.maps.event.addListener(Ee,"mousedown",d)),f&&V(google.maps.event.addListener(Ee,"mousemove",f)),g&&G(google.maps.event.addListener(Ee,"mouseout",g)),v&&Z(google.maps.event.addListener(Ee,"mouseover",v)),x&&oe(google.maps.event.addListener(Ee,"mouseup",x)),E&&he(google.maps.event.addListener(Ee,"rightclick",E)),y&&ie(google.maps.event.addListener(Ee,"click",y)),h&&ne(google.maps.event.addListener(Ee,"drag",h)),C&&Se(google.maps.event.addListener(Ee,"center_changed",C)),T&&je(google.maps.event.addListener(Ee,"radius_changed",T)),b(Ee),k&&k(Ee),()=>{w!==null&&google.maps.event.removeListener(w),R!==null&&google.maps.event.removeListener(R),M!==null&&google.maps.event.removeListener(M),U!==null&&google.maps.event.removeListener(U),j!==null&&google.maps.event.removeListener(j),z!==null&&google.maps.event.removeListener(z),Y!==null&&google.maps.event.removeListener(Y),H!==null&&google.maps.event.removeListener(H),W!==null&&google.maps.event.removeListener(W),xe!==null&&google.maps.event.removeListener(xe),re!==null&&google.maps.event.removeListener(re),Oe!==null&&google.maps.event.removeListener(Oe),_&&_(Ee),Ee.setMap(null)}},[]),null}p.memo(w8);class _8 extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[]),X(this,"state",{circle:null}),X(this,"setCircleCallback",()=>{this.state.circle!==null&&this.props.onLoad&&this.props.onLoad(this.state.circle)})}componentDidMount(){var e=new google.maps.Circle(Wm(Wm({},this.props.options),{},{map:this.context}));this.registeredEvents=Fe({updaterMap:A_,eventMap:T_,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{circle:e}},this.setCircleCallback)}componentDidUpdate(e){this.state.circle!==null&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:A_,eventMap:T_,prevProps:e,nextProps:this.props,instance:this.state.circle}))}componentWillUnmount(){if(this.state.circle!==null){var e;this.props.onUnmount&&this.props.onUnmount(this.state.circle),$e(this.registeredEvents),(e=this.state.circle)===null||e===void 0||e.setMap(null)}}render(){return null}}X(_8,"contextType",Ve);function P_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Hm(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?P_(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var R_={onClick:"click",onDblClick:"dblclick",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick",onAddFeature:"addfeature",onRemoveFeature:"removefeature",onRemoveProperty:"removeproperty",onSetGeometry:"setgeometry",onSetProperty:"setproperty"},L_={add(t,e){t.add(e)},addgeojson(t,e,n){t.addGeoJson(e,n)},contains(t,e){t.contains(e)},foreach(t,e){t.forEach(e)},loadgeojson(t,e,n,r){t.loadGeoJson(e,n,r)},overridestyle(t,e,n){t.overrideStyle(e,n)},remove(t,e){t.remove(e)},revertstyle(t,e){t.revertStyle(e)},controlposition(t,e){t.setControlPosition(e)},controls(t,e){t.setControls(e)},drawingmode(t,e){t.setDrawingMode(e)},map(t,e){t.setMap(e)},style(t,e){t.setStyle(e)},togeojson(t,e){t.toGeoJson(e)}};function N8(t){var{options:e,onClick:n,onDblClick:r,onMouseDown:s,onMouseMove:i,onMouseOut:o,onMouseOver:l,onMouseUp:c,onRightClick:u,onAddFeature:d,onRemoveFeature:f,onRemoveProperty:g,onSetGeometry:v,onSetProperty:x,onLoad:E,onUnmount:y}=t,h=p.useContext(Ve),[C,T]=p.useState(null),[k,_]=p.useState(null),[S,N]=p.useState(null),[b,w]=p.useState(null),[A,R]=p.useState(null),[L,M]=p.useState(null),[F,U]=p.useState(null),[D,j]=p.useState(null),[V,z]=p.useState(null),[G,Y]=p.useState(null),[Z,H]=p.useState(null),[oe,W]=p.useState(null),[he,xe]=p.useState(null),[ie,be]=p.useState(null);return p.useEffect(()=>{C!==null&&C.setMap(h)},[h]),p.useEffect(()=>{C&&r&&(k!==null&&google.maps.event.removeListener(k),_(google.maps.event.addListener(C,"dblclick",r)))},[r]),p.useEffect(()=>{C&&s&&(S!==null&&google.maps.event.removeListener(S),N(google.maps.event.addListener(C,"mousedown",s)))},[s]),p.useEffect(()=>{C&&i&&(b!==null&&google.maps.event.removeListener(b),w(google.maps.event.addListener(C,"mousemove",i)))},[i]),p.useEffect(()=>{C&&o&&(A!==null&&google.maps.event.removeListener(A),R(google.maps.event.addListener(C,"mouseout",o)))},[o]),p.useEffect(()=>{C&&l&&(L!==null&&google.maps.event.removeListener(L),M(google.maps.event.addListener(C,"mouseover",l)))},[l]),p.useEffect(()=>{C&&c&&(F!==null&&google.maps.event.removeListener(F),U(google.maps.event.addListener(C,"mouseup",c)))},[c]),p.useEffect(()=>{C&&u&&(D!==null&&google.maps.event.removeListener(D),j(google.maps.event.addListener(C,"rightclick",u)))},[u]),p.useEffect(()=>{C&&n&&(V!==null&&google.maps.event.removeListener(V),z(google.maps.event.addListener(C,"click",n)))},[n]),p.useEffect(()=>{C&&d&&(G!==null&&google.maps.event.removeListener(G),Y(google.maps.event.addListener(C,"addfeature",d)))},[d]),p.useEffect(()=>{C&&f&&(Z!==null&&google.maps.event.removeListener(Z),H(google.maps.event.addListener(C,"removefeature",f)))},[f]),p.useEffect(()=>{C&&g&&(oe!==null&&google.maps.event.removeListener(oe),W(google.maps.event.addListener(C,"removeproperty",g)))},[g]),p.useEffect(()=>{C&&v&&(he!==null&&google.maps.event.removeListener(he),xe(google.maps.event.addListener(C,"setgeometry",v)))},[v]),p.useEffect(()=>{C&&x&&(ie!==null&&google.maps.event.removeListener(ie),be(google.maps.event.addListener(C,"setproperty",x)))},[x]),p.useEffect(()=>{if(h!==null){var ne=new google.maps.Data(Hm(Hm({},e),{},{map:h}));r&&_(google.maps.event.addListener(ne,"dblclick",r)),s&&N(google.maps.event.addListener(ne,"mousedown",s)),i&&w(google.maps.event.addListener(ne,"mousemove",i)),o&&R(google.maps.event.addListener(ne,"mouseout",o)),l&&M(google.maps.event.addListener(ne,"mouseover",l)),c&&U(google.maps.event.addListener(ne,"mouseup",c)),u&&j(google.maps.event.addListener(ne,"rightclick",u)),n&&z(google.maps.event.addListener(ne,"click",n)),d&&Y(google.maps.event.addListener(ne,"addfeature",d)),f&&H(google.maps.event.addListener(ne,"removefeature",f)),g&&W(google.maps.event.addListener(ne,"removeproperty",g)),v&&xe(google.maps.event.addListener(ne,"setgeometry",v)),x&&be(google.maps.event.addListener(ne,"setproperty",x)),T(ne),E&&E(ne)}return()=>{C&&(k!==null&&google.maps.event.removeListener(k),S!==null&&google.maps.event.removeListener(S),b!==null&&google.maps.event.removeListener(b),A!==null&&google.maps.event.removeListener(A),L!==null&&google.maps.event.removeListener(L),F!==null&&google.maps.event.removeListener(F),D!==null&&google.maps.event.removeListener(D),V!==null&&google.maps.event.removeListener(V),G!==null&&google.maps.event.removeListener(G),Z!==null&&google.maps.event.removeListener(Z),oe!==null&&google.maps.event.removeListener(oe),he!==null&&google.maps.event.removeListener(he),ie!==null&&google.maps.event.removeListener(ie),y&&y(C),C.setMap(null))}},[]),null}p.memo(N8);class C8 extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[]),X(this,"state",{data:null}),X(this,"setDataCallback",()=>{this.state.data!==null&&this.props.onLoad&&this.props.onLoad(this.state.data)})}componentDidMount(){if(this.context!==null){var e=new google.maps.Data(Hm(Hm({},this.props.options),{},{map:this.context}));this.registeredEvents=Fe({updaterMap:L_,eventMap:R_,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({data:e}),this.setDataCallback)}}componentDidUpdate(e){this.state.data!==null&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:L_,eventMap:R_,prevProps:e,nextProps:this.props,instance:this.state.data}))}componentWillUnmount(){this.state.data!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.data),$e(this.registeredEvents),this.state.data&&this.state.data.setMap(null))}render(){return null}}X(C8,"contextType",Ve);function D_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function M_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?D_(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var O_={onClick:"click",onDefaultViewportChanged:"defaultviewport_changed",onStatusChanged:"status_changed"},V_={options(t,e){t.setOptions(e)},url(t,e){t.setUrl(e)},zIndex(t,e){t.setZIndex(e)}};class S8 extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[]),X(this,"state",{kmlLayer:null}),X(this,"setKmlLayerCallback",()=>{this.state.kmlLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.kmlLayer)})}componentDidMount(){var e=new google.maps.KmlLayer(M_(M_({},this.props.options),{},{map:this.context}));this.registeredEvents=Fe({updaterMap:V_,eventMap:O_,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{kmlLayer:e}},this.setKmlLayerCallback)}componentDidUpdate(e){this.state.kmlLayer!==null&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:V_,eventMap:O_,prevProps:e,nextProps:this.props,instance:this.state.kmlLayer}))}componentWillUnmount(){this.state.kmlLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.kmlLayer),$e(this.registeredEvents),this.state.kmlLayer.setMap(null))}render(){return null}}X(S8,"contextType",Ve);function xT(t,e){return typeof e=="function"?e(t.offsetWidth,t.offsetHeight):{x:0,y:0}}function k8(t,e){return new e(t.lat,t.lng)}function I8(t,e){return new e(new google.maps.LatLng(t.ne.lat,t.ne.lng),new google.maps.LatLng(t.sw.lat,t.sw.lng))}function T8(t,e,n){return t instanceof e?t:n(t,e)}function A8(t,e,n){return t instanceof e?t:n(t,e)}function P8(t,e,n){var r=t&&t.fromLatLngToDivPixel(n.getNorthEast()),s=t&&t.fromLatLngToDivPixel(n.getSouthWest());return r&&s?{left:"".concat(s.x+e.x,"px"),top:"".concat(r.y+e.y,"px"),width:"".concat(r.x-s.x-e.x,"px"),height:"".concat(s.y-r.y-e.y,"px")}:{left:"-9999px",top:"-9999px"}}function R8(t,e,n){var r=t&&t.fromLatLngToDivPixel(n);if(r){var{x:s,y:i}=r;return{left:"".concat(s+e.x,"px"),top:"".concat(i+e.y,"px")}}return{left:"-9999px",top:"-9999px"}}function wT(t,e,n,r){return n!==void 0?P8(t,e,A8(n,google.maps.LatLngBounds,I8)):R8(t,e,T8(r,google.maps.LatLng,k8))}function L8(t,e){return t.left===e.left&&t.top===e.top&&t.width===e.height&&t.height===e.height}function j_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function D8(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?j_(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function M8(t,e,n,r,s){class i extends google.maps.OverlayView{constructor(l,c,u,d){super(),this.container=l,this.pane=c,this.position=u,this.bounds=d}onAdd(){var l,c=(l=this.getPanes())===null||l===void 0?void 0:l[this.pane];c==null||c.appendChild(this.container)}draw(){var l=this.getProjection(),c=D8({},this.container?xT(this.container,s):{x:0,y:0}),u=wT(l,c,this.bounds,this.position);for(var[d,f]of Object.entries(u))this.container.style[d]=f}onRemove(){this.container.parentNode!==null&&this.container.parentNode.removeChild(this.container)}}return new i(t,e,n,r)}function F_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function O8(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?F_(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function z_(t){if(!t)return"";var e=t instanceof google.maps.LatLng?t:new google.maps.LatLng(t.lat,t.lng);return e+""}function U_(t){if(!t)return"";var e=t instanceof google.maps.LatLngBounds?t:new google.maps.LatLngBounds(new google.maps.LatLng(t.south,t.east),new google.maps.LatLng(t.north,t.west));return e+""}function V8(t){var{position:e,bounds:n,mapPaneName:r,zIndex:s,onLoad:i,onUnmount:o,getPixelPositionOffset:l,children:c}=t,u=p.useContext(Ve),d=p.useMemo(()=>{var g=document.createElement("div");return g.style.position="absolute",g},[]),f=p.useMemo(()=>M8(d,r,e,n,l),[d,r,e,n]);return p.useEffect(()=>(i==null||i(f),f==null||f.setMap(u),()=>{o==null||o(f),f==null||f.setMap(null)}),[u,f]),p.useEffect(()=>{d.style.zIndex="".concat(s)},[s,d]),yi.createPortal(c,d)}p.memo(V8);class sl extends p.PureComponent{constructor(e){super(e),X(this,"state",{paneEl:null,containerStyle:{position:"absolute"}}),X(this,"updatePane",()=>{var r=this.props.mapPaneName,s=this.overlayView.getPanes();Ht(!!r,"OverlayView requires props.mapPaneName but got %s",r),s?this.setState({paneEl:s[r]}):this.setState({paneEl:null})}),X(this,"onAdd",()=>{var r,s;this.updatePane(),(r=(s=this.props).onLoad)===null||r===void 0||r.call(s,this.overlayView)}),X(this,"onPositionElement",()=>{var r=this.overlayView.getProjection(),s=O8({x:0,y:0},this.containerRef.current?xT(this.containerRef.current,this.props.getPixelPositionOffset):{}),i=wT(r,s,this.props.bounds,this.props.position);if(!L8(i,{left:this.state.containerStyle.left,top:this.state.containerStyle.top,width:this.state.containerStyle.width,height:this.state.containerStyle.height})){var o,l,c,u;this.setState({containerStyle:{top:(o=i.top)!==null&&o!==void 0?o:0,left:(l=i.left)!==null&&l!==void 0?l:0,width:(c=i.width)!==null&&c!==void 0?c:0,height:(u=i.height)!==null&&u!==void 0?u:0,position:"absolute"}})}}),X(this,"draw",()=>{this.onPositionElement()}),X(this,"onRemove",()=>{var r,s;this.setState(()=>({paneEl:null})),(r=(s=this.props).onUnmount)===null||r===void 0||r.call(s,this.overlayView)}),this.containerRef=p.createRef();var n=new google.maps.OverlayView;n.onAdd=this.onAdd,n.draw=this.draw,n.onRemove=this.onRemove,this.overlayView=n}componentDidMount(){this.overlayView.setMap(this.context)}componentDidUpdate(e){var n=z_(e.position),r=z_(this.props.position),s=U_(e.bounds),i=U_(this.props.bounds);(n!==r||s!==i)&&this.overlayView.draw(),e.mapPaneName!==this.props.mapPaneName&&this.updatePane()}componentWillUnmount(){this.overlayView.setMap(null)}render(){var e=this.state.paneEl;return e?yi.createPortal(Nn.jsx("div",{ref:this.containerRef,style:this.state.containerStyle,children:p.Children.only(this.props.children)}),e):null}}X(sl,"FLOAT_PANE","floatPane");X(sl,"MAP_PANE","mapPane");X(sl,"MARKER_LAYER","markerLayer");X(sl,"OVERLAY_LAYER","overlayLayer");X(sl,"OVERLAY_MOUSE_TARGET","overlayMouseTarget");X(sl,"contextType",Ve);function j8(){}function $_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function B_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?$_(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var q_={onDblClick:"dblclick",onClick:"click"},W_={opacity(t,e){t.setOpacity(e)}};function F8(t){var{url:e,bounds:n,options:r,visible:s}=t,i=p.useContext(Ve),o=new google.maps.LatLngBounds(new google.maps.LatLng(n.south,n.west),new google.maps.LatLng(n.north,n.east)),l=p.useMemo(()=>new google.maps.GroundOverlay(e,o,r),[]);return p.useEffect(()=>{l!==null&&l.setMap(i)},[i]),p.useEffect(()=>{typeof e<"u"&&l!==null&&(l.set("url",e),l.setMap(i))},[l,e]),p.useEffect(()=>{typeof s<"u"&&l!==null&&l.setOpacity(s?1:0)},[l,s]),p.useEffect(()=>{var c=new google.maps.LatLngBounds(new google.maps.LatLng(n.south,n.west),new google.maps.LatLng(n.north,n.east));typeof n<"u"&&l!==null&&(l.set("bounds",c),l.setMap(i))},[l,n]),null}p.memo(F8);class _T extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[]),X(this,"state",{groundOverlay:null}),X(this,"setGroundOverlayCallback",()=>{this.state.groundOverlay!==null&&this.props.onLoad&&this.props.onLoad(this.state.groundOverlay)})}componentDidMount(){Ht(!!this.props.url||!!this.props.bounds,"For GroundOverlay, url and bounds are passed in to constructor and are immutable after instantiated. This is the behavior of Google Maps JavaScript API v3 ( See https://developers.google.com/maps/documentation/javascript/reference#GroundOverlay) Hence, use the corresponding two props provided by `react-google-maps-api`, url and bounds. In some cases, you'll need the GroundOverlay component to reflect the changes of url and bounds. You can leverage the React's key property to remount the component. Typically, just `key={url}` would serve your need. See https://github.com/tomchentw/react-google-maps/issues/655");var e=new google.maps.GroundOverlay(this.props.url,this.props.bounds,B_(B_({},this.props.options),{},{map:this.context}));this.registeredEvents=Fe({updaterMap:W_,eventMap:q_,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{groundOverlay:e}},this.setGroundOverlayCallback)}componentDidUpdate(e){this.state.groundOverlay!==null&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:W_,eventMap:q_,prevProps:e,nextProps:this.props,instance:this.state.groundOverlay}))}componentWillUnmount(){this.state.groundOverlay&&(this.props.onUnmount&&this.props.onUnmount(this.state.groundOverlay),this.state.groundOverlay.setMap(null))}render(){return null}}X(_T,"defaultProps",{onLoad:j8});X(_T,"contextType",Ve);function H_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Gm(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?H_(Object(n),!0).forEach(function(r){X(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var G_={},K_={data(t,e){t.setData(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)}};function z8(t){var{data:e,onLoad:n,onUnmount:r,options:s}=t,i=p.useContext(Ve),[o,l]=p.useState(null);return p.useEffect(()=>{google.maps.visualization||Ht(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} in useJsApiScript? %s',google.maps.visualization)},[]),p.useEffect(()=>{Ht(!!e,"data property is required in HeatmapLayer %s",e)},[e]),p.useEffect(()=>{o!==null&&o.setMap(i)},[i]),p.useEffect(()=>{s&&o!==null&&o.setOptions(s)},[o,s]),p.useEffect(()=>{var c=new google.maps.visualization.HeatmapLayer(Gm(Gm({},s),{},{data:e,map:i}));return l(c),n&&n(c),()=>{o!==null&&(r&&r(o),o.setMap(null))}},[]),null}p.memo(z8);class U8 extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[]),X(this,"state",{heatmapLayer:null}),X(this,"setHeatmapLayerCallback",()=>{this.state.heatmapLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.heatmapLayer)})}componentDidMount(){Ht(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} to <LoadScript />? %s',google.maps.visualization),Ht(!!this.props.data,"data property is required in HeatmapLayer %s",this.props.data);var e=new google.maps.visualization.HeatmapLayer(Gm(Gm({},this.props.options),{},{data:this.props.data,map:this.context}));this.registeredEvents=Fe({updaterMap:K_,eventMap:G_,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{heatmapLayer:e}},this.setHeatmapLayerCallback)}componentDidUpdate(e){$e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:K_,eventMap:G_,prevProps:e,nextProps:this.props,instance:this.state.heatmapLayer})}componentWillUnmount(){this.state.heatmapLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.heatmapLayer),$e(this.registeredEvents),this.state.heatmapLayer.setMap(null))}render(){return null}}X(U8,"contextType",Ve);var Q_={onCloseClick:"closeclick",onPanoChanged:"pano_changed",onPositionChanged:"position_changed",onPovChanged:"pov_changed",onResize:"resize",onStatusChanged:"status_changed",onVisibleChanged:"visible_changed",onZoomChanged:"zoom_changed"},J_={register(t,e,n){t.registerPanoProvider(e,n)},links(t,e){t.setLinks(e)},motionTracking(t,e){t.setMotionTracking(e)},options(t,e){t.setOptions(e)},pano(t,e){t.setPano(e)},position(t,e){t.setPosition(e)},pov(t,e){t.setPov(e)},visible(t,e){t.setVisible(e)},zoom(t,e){t.setZoom(e)}};class $8 extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[]),X(this,"state",{streetViewPanorama:null}),X(this,"setStreetViewPanoramaCallback",()=>{this.state.streetViewPanorama!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewPanorama)})}componentDidMount(){var e,n,r=(e=(n=this.context)===null||n===void 0?void 0:n.getStreetView())!==null&&e!==void 0?e:null;this.registeredEvents=Fe({updaterMap:J_,eventMap:Q_,prevProps:{},nextProps:this.props,instance:r}),this.setState(()=>({streetViewPanorama:r}),this.setStreetViewPanoramaCallback)}componentDidUpdate(e){this.state.streetViewPanorama!==null&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:J_,eventMap:Q_,prevProps:e,nextProps:this.props,instance:this.state.streetViewPanorama}))}componentWillUnmount(){this.state.streetViewPanorama!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.streetViewPanorama),$e(this.registeredEvents),this.state.streetViewPanorama.setVisible(!1))}render(){return null}}X($8,"contextType",Ve);class B8 extends p.PureComponent{constructor(){super(...arguments),X(this,"state",{streetViewService:null}),X(this,"setStreetViewServiceCallback",()=>{this.state.streetViewService!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewService)})}componentDidMount(){var e=new google.maps.StreetViewService;this.setState(function(){return{streetViewService:e}},this.setStreetViewServiceCallback)}componentWillUnmount(){this.state.streetViewService!==null&&this.props.onUnmount&&this.props.onUnmount(this.state.streetViewService)}render(){return null}}X(B8,"contextType",Ve);var Y_={onDirectionsChanged:"directions_changed"},Z_={directions(t,e){t.setDirections(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},panel(t,e){t.setPanel(e)},routeIndex(t,e){t.setRouteIndex(e)}};class q8 extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[]),X(this,"state",{directionsRenderer:null}),X(this,"setDirectionsRendererCallback",()=>{this.state.directionsRenderer!==null&&(this.state.directionsRenderer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.directionsRenderer))})}componentDidMount(){var e=new google.maps.DirectionsRenderer(this.props.options);this.registeredEvents=Fe({updaterMap:Z_,eventMap:Y_,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{directionsRenderer:e}},this.setDirectionsRendererCallback)}componentDidUpdate(e){this.state.directionsRenderer!==null&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:Z_,eventMap:Y_,prevProps:e,nextProps:this.props,instance:this.state.directionsRenderer}))}componentWillUnmount(){this.state.directionsRenderer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.directionsRenderer),$e(this.registeredEvents),this.state.directionsRenderer&&this.state.directionsRenderer.setMap(null))}render(){return null}}X(q8,"contextType",Ve);var X_={onPlacesChanged:"places_changed"},eN={bounds(t,e){t.setBounds(e)}};class W8 extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[]),X(this,"containerElement",p.createRef()),X(this,"state",{searchBox:null}),X(this,"setSearchBoxCallback",()=>{this.state.searchBox!==null&&this.props.onLoad&&this.props.onLoad(this.state.searchBox)})}componentDidMount(){if(Ht(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places),this.containerElement!==null&&this.containerElement.current!==null){var e=this.containerElement.current.querySelector("input");if(e!==null){var n=new google.maps.places.SearchBox(e,this.props.options);this.registeredEvents=Fe({updaterMap:eN,eventMap:X_,prevProps:{},nextProps:this.props,instance:n}),this.setState(function(){return{searchBox:n}},this.setSearchBoxCallback)}}}componentDidUpdate(e){this.state.searchBox!==null&&($e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:eN,eventMap:X_,prevProps:e,nextProps:this.props,instance:this.state.searchBox}))}componentWillUnmount(){this.state.searchBox!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.searchBox),$e(this.registeredEvents))}render(){return Nn.jsx("div",{ref:this.containerElement,children:p.Children.only(this.props.children)})}}X(W8,"contextType",Ve);var tN={onPlaceChanged:"place_changed"},nN={bounds(t,e){t.setBounds(e)},restrictions(t,e){t.setComponentRestrictions(e)},fields(t,e){t.setFields(e)},options(t,e){t.setOptions(e)},types(t,e){t.setTypes(e)}};class NT extends p.PureComponent{constructor(){super(...arguments),X(this,"registeredEvents",[]),X(this,"containerElement",p.createRef()),X(this,"state",{autocomplete:null}),X(this,"setAutocompleteCallback",()=>{this.state.autocomplete!==null&&this.props.onLoad&&this.props.onLoad(this.state.autocomplete)})}componentDidMount(){var e;Ht(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places);var n=(e=this.containerElement.current)===null||e===void 0?void 0:e.querySelector("input");if(n){var r=new google.maps.places.Autocomplete(n,this.props.options);this.registeredEvents=Fe({updaterMap:nN,eventMap:tN,prevProps:{},nextProps:this.props,instance:r}),this.setState(()=>({autocomplete:r}),this.setAutocompleteCallback)}}componentDidUpdate(e){$e(this.registeredEvents),this.registeredEvents=Fe({updaterMap:nN,eventMap:tN,prevProps:e,nextProps:this.props,instance:this.state.autocomplete})}componentWillUnmount(){this.state.autocomplete!==null&&$e(this.registeredEvents)}render(){return Nn.jsx("div",{ref:this.containerElement,className:this.props.className,children:p.Children.only(this.props.children)})}}X(NT,"defaultProps",{className:""});X(NT,"contextType",Ve);function rN({lat:t,lng:e,onLocationChange:n}){const{isLoaded:r}=fT({googleMapsApiKey:"TU_GOOGLE_MAPS_API_KEY"}),s={lat:t||-33.45694,lng:e||-70.64827},i=p.useCallback(o=>{n&&n({lat:o.latLng.lat(),lng:o.latLng.lng()})},[n]);return r?a.createElement(gU,{mapContainerStyle:{width:"100%",height:"200px"},center:s,zoom:16,onClick:i},t&&e&&a.createElement(hT,{position:{lat:t,lng:e}})):a.createElement("div",null,"Cargando mapa...")}function H8({onClose:t,onSuccess:e}){const[n,r]=p.useState({nombre:"",direccion:"",telefono:"",email:"",sitio_web:"",horario_atencion:"",categoria:"",marcas:[],logo_url:"",descripcion:"",lat:"",lng:""}),[s,i]=p.useState([]),[o,l]=p.useState([]),[c,u]=p.useState(!1);p.useEffect(()=>{d(),f()},[]);const d=async()=>{try{const y=(await ue(Q($,"categorias"))).docs.map(h=>({id:h.id,...h.data()}));i(y)}catch(E){console.error("Error cargando categorías:",E)}},f=async()=>{try{const y=(await ue(Q($,"marcas"))).docs.map(h=>({id:h.id,...h.data()}));l(y)}catch(E){console.error("Error cargando marcas:",E)}},g=E=>{const{name:y,value:h}=E.target;r(C=>({...C,[y]:h}))},v=E=>{r(y=>({...y,marcas:y.marcas.includes(E)?y.marcas.filter(h=>h!==E):[...y.marcas,E]}))},x=async E=>{E.preventDefault(),u(!0);try{if(!n.nombre||!n.direccion||!n.categoria||!n.sitio_web||!n.logo_url){alert("Por favor complete todos los campos obligatorios (nombre, dirección, categoría, sitio web, logo)"),u(!1);return}const y={...n,estado:"activa",tipo_empresa:"publica",es_comunidad:!1,fecha_creacion:new Date,fecha_actualizacion:new Date,creado_por:"admin"};await ze(Q($,"empresas"),y),alert("¡Empresa pública creada exitosamente!"),e==null||e(),t==null||t()}catch(y){console.error("Error creando empresa:",y),alert("Error al crear la empresa. Intente nuevamente.")}finally{u(!1)}};return a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto"},a.createElement("div",{className:"flex justify-between items-center mb-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-800"},"Crear Empresa Pública"),a.createElement("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold"},"×")),a.createElement("form",{onSubmit:x,className:"space-y-6"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},a.createElement("div",{className:"space-y-4"},a.createElement("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2"},"Información Básica"),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Nombre de la Empresa *"),a.createElement("input",{type:"text",name:"nombre",value:n.nombre,onChange:g,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Dirección *"),a.createElement("input",{type:"text",name:"direccion",value:n.direccion,onChange:g,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Teléfono"),a.createElement("input",{type:"tel",name:"telefono",value:n.telefono,onChange:g,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Email"),a.createElement("input",{type:"email",name:"email",value:n.email,onChange:g,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}))),a.createElement("div",{className:"space-y-4"},a.createElement("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2"},"Información de Negocio"),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Sitio Web *"),a.createElement("input",{type:"url",name:"sitio_web",value:n.sitio_web,onChange:g,placeholder:"https://ejemplo.com",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"URL del Logo *"),a.createElement("input",{type:"url",name:"logo_url",value:n.logo_url,onChange:g,placeholder:"https://ejemplo.com/logo.png",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Horario de Atención *"),a.createElement("input",{type:"text",name:"horario_atencion",value:n.horario_atencion,onChange:g,placeholder:"Lun-Vie 9:00-18:00, Sáb 9:00-14:00",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Categoría *"),a.createElement("select",{name:"categoria",value:n.categoria,onChange:g,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0},a.createElement("option",{value:""},"Seleccionar categoría"),s.map(E=>a.createElement("option",{key:E.id,value:E.nombre},E.nombre)))))),a.createElement("div",null,a.createElement("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2 mb-4"},"Marcas que Atiende *"),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3"},o.map(E=>a.createElement("label",{key:E.id,className:"flex items-center space-x-2 cursor-pointer"},a.createElement("input",{type:"checkbox",checked:n.marcas.includes(E.id),onChange:()=>v(E.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("span",{className:"text-sm text-gray-700"},E.nombre))))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Descripción"),a.createElement("textarea",{name:"descripcion",value:n.descripcion,onChange:g,rows:"3",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Descripción breve de la empresa y sus servicios..."})),a.createElement("div",{className:"grid grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Latitud (Opcional)"),a.createElement("input",{type:"number",name:"lat",value:n.lat,onChange:g,step:"any",placeholder:"-33.4489",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Longitud (Opcional)"),a.createElement("input",{type:"number",name:"lng",value:n.lng,onChange:g,step:"any",placeholder:"-70.6693",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}))),a.createElement("div",{className:"flex justify-end space-x-4 pt-6 border-t"},a.createElement("button",{type:"button",onClick:t,className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500"},"Cancelar"),a.createElement("button",{type:"submit",disabled:c,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50"},c?"Creando...":"Crear Empresa")))))}function G8(){const[t,e]=p.useState([]),[n,r]=p.useState(null),[s,i]=p.useState({}),[o,l]=p.useState(!0),[c,u]=p.useState({busqueda:"",estado:"",categoria:""}),[d,f]=p.useState("grid"),[g,v]=p.useState(!1);p.useEffect(()=>{const S=pe(Q($,"empresas"),Et("nombre"));return Dt(S,b=>{e(b.docs.map(w=>({id:w.id,...w.data()}))),l(!1)})},[]);const x=S=>{r(S.id),i(S)},E=S=>{i({...s,[S.target.name]:S.target.value})},y=({lat:S,lng:N})=>{i({...s,lat:S,lng:N})},h=async()=>{try{const{id:S,...N}=s;await Me(we($,"empresas",n),{...N,fecha_actualizacion:new Date}),r(null),alert("Empresa actualizada exitosamente")}catch(S){console.error("Error actualizando empresa:",S),alert("Error al actualizar la empresa")}},C=async S=>{if(window.confirm("¿Seguro que deseas eliminar esta empresa?"))try{await ws(we($,"empresas",S)),alert("Empresa eliminada exitosamente")}catch(N){console.error("Error eliminando empresa:",N),alert("Error al eliminar la empresa")}},T=async S=>{try{const N=S.estado==="Activa"?"Inactiva":"Activa";await Me(we($,"empresas",S.id),{estado:N,fecha_actualizacion:new Date}),alert(`Empresa ${N.toLowerCase()} exitosamente`)}catch(N){console.error("Error cambiando estado:",N),alert("Error al cambiar el estado")}},k=t.filter(S=>{var A,R;const N=!c.busqueda||S.nombre.toLowerCase().includes(c.busqueda.toLowerCase())||((A=S.direccion)==null?void 0:A.toLowerCase().includes(c.busqueda.toLowerCase()))||((R=S.categoria)==null?void 0:R.toLowerCase().includes(c.busqueda.toLowerCase())),b=!c.estado||S.estado===c.estado,w=!c.categoria||S.categoria===c.categoria;return N&&b&&w}),_=[...new Set(t.map(S=>S.categoria).filter(Boolean))];return o?a.createElement("div",{className:"flex items-center justify-center p-8"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.createElement("p",{className:"text-gray-600"},"Cargando empresas..."))):a.createElement("section",{className:"p-6"},a.createElement("div",{className:"mb-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Gestión de Empresas"),a.createElement("p",{className:"text-gray-600"},"Administra y supervisa todas las empresas registradas en el sistema")),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},a.createElement("div",{className:"text-2xl font-bold text-blue-800"},t.length),a.createElement("div",{className:"text-blue-600 text-sm"},"Total Empresas")),a.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},a.createElement("div",{className:"text-2xl font-bold text-green-800"},t.filter(S=>S.estado==="Activa").length),a.createElement("div",{className:"text-green-600 text-sm"},"Empresas Activas")),a.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4"},a.createElement("div",{className:"text-2xl font-bold text-red-800"},t.filter(S=>S.estado==="Inactiva").length),a.createElement("div",{className:"text-red-600 text-sm"},"Empresas Inactivas")),a.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4"},a.createElement("div",{className:"text-2xl font-bold text-purple-800"},_.length),a.createElement("div",{className:"text-purple-600 text-sm"},"Categorías"))),a.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},a.createElement("div",{className:"flex flex-wrap items-center justify-between gap-4"},a.createElement("div",{className:"flex flex-wrap gap-4 flex-1"},a.createElement("div",{className:"flex-1 min-w-64"},a.createElement("input",{type:"text",placeholder:"Buscar por nombre, dirección o categoría...",value:c.busqueda,onChange:S=>u({...c,busqueda:S.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("select",{value:c.estado,onChange:S=>u({...c,estado:S.target.value}),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},a.createElement("option",{value:""},"Todos los estados"),a.createElement("option",{value:"Activa"},"Activa"),a.createElement("option",{value:"Inactiva"},"Inactiva")),a.createElement("select",{value:c.categoria,onChange:S=>u({...c,categoria:S.target.value}),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},a.createElement("option",{value:""},"Todas las categorías"),_.map(S=>a.createElement("option",{key:S,value:S},S)))),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("button",{onClick:()=>f("grid"),className:`p-2 rounded-lg ${d==="grid"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`},"📱 Grid"),a.createElement("button",{onClick:()=>f("table"),className:`p-2 rounded-lg ${d==="table"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`},"📋 Tabla")))),a.createElement("div",{className:"mb-6"},a.createElement("button",{onClick:()=>v(!0),className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors"},"➕ Crear Empresa Pública")),a.createElement("div",{className:"mb-4"},a.createElement("p",{className:"text-gray-600"},"Mostrando ",k.length," de ",t.length," empresas")),d==="grid"&&a.createElement("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6"},k.map(S=>a.createElement("div",{key:S.id,className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},n===S.id?a.createElement("div",{className:"p-6"},a.createElement("h3",{className:"font-semibold text-lg mb-4"},"Editando: ",S.nombre),a.createElement("div",{className:"space-y-3"},a.createElement("input",{className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",name:"nombre",placeholder:"Nombre de la empresa",value:s.nombre||"",onChange:E}),a.createElement("input",{className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",name:"direccion",placeholder:"Dirección",value:s.direccion||"",onChange:E}),a.createElement("input",{className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",name:"categoria",placeholder:"Categoría",value:s.categoria||"",onChange:E}),a.createElement("input",{className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",name:"telefono",placeholder:"Teléfono",value:s.telefono||"",onChange:E}),a.createElement("input",{className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",name:"email",placeholder:"Email",value:s.email||"",onChange:E}),a.createElement("input",{className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",name:"web",placeholder:"Sitio web",value:s.web||"",onChange:E}),a.createElement("select",{className:"w-full border border-gray-300 p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",name:"estado",value:s.estado||"",onChange:E},a.createElement("option",{value:""},"Seleccionar estado"),a.createElement("option",{value:"Activa"},"Activa"),a.createElement("option",{value:"Inactiva"},"Inactiva"))),s.lat&&s.lng&&a.createElement("div",{className:"mt-4"},a.createElement(rN,{lat:s.lat,lng:s.lng,onLocationChange:y})),a.createElement("div",{className:"mt-6 flex gap-3"},a.createElement("button",{className:"flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors",onClick:h},"💾 Guardar"),a.createElement("button",{className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors",onClick:()=>r(null)},"❌ Cancelar"))):a.createElement(a.Fragment,null,a.createElement("div",{className:"p-6"},a.createElement("div",{className:"flex items-start justify-between mb-3"},a.createElement("h3",{className:"font-bold text-lg text-gray-900"},S.nombre),a.createElement("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${S.estado==="Activa"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},S.estado||"Sin estado")),a.createElement("div",{className:"space-y-2 text-sm text-gray-600"},a.createElement("p",{className:"flex items-center gap-2"},a.createElement("span",null,"📍")," ",S.direccion||"Sin dirección"),a.createElement("p",{className:"flex items-center gap-2"},a.createElement("span",null,"🏷️")," ",S.categoria||"Sin categoría"),a.createElement("p",{className:"flex items-center gap-2"},a.createElement("span",null,"📞")," ",S.telefono||"Sin teléfono"),S.email&&a.createElement("p",{className:"flex items-center gap-2"},a.createElement("span",null,"📧")," ",S.email),S.web&&a.createElement("p",{className:"flex items-center gap-2"},a.createElement("span",null,"🌐"),a.createElement("a",{href:S.web,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},S.web))),S.lat&&S.lng&&a.createElement("div",{className:"mt-4"},a.createElement(rN,{lat:S.lat,lng:S.lng}))),a.createElement("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex gap-2"},a.createElement("button",{className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-sm transition-colors",onClick:()=>x(S)},"✏️ Editar"),a.createElement("button",{className:`flex-1 px-3 py-2 rounded-lg text-sm transition-colors ${S.estado==="Activa"?"bg-red-100 hover:bg-red-200 text-red-700":"bg-green-100 hover:bg-green-200 text-green-700"}`,onClick:()=>T(S)},S.estado==="Activa"?"⏸️ Desactivar":"▶️ Activar"),a.createElement("button",{className:"bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-lg text-sm transition-colors",onClick:()=>C(S.id)},"🗑️")))))),d==="table"&&a.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},a.createElement("div",{className:"overflow-x-auto"},a.createElement("table",{className:"w-full"},a.createElement("thead",{className:"bg-gray-50"},a.createElement("tr",null,a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Empresa"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Categoría"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Contacto"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),a.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},k.map(S=>a.createElement("tr",{key:S.id,className:"hover:bg-gray-50"},a.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},a.createElement("div",null,a.createElement("div",{className:"text-sm font-medium text-gray-900"},S.nombre),a.createElement("div",{className:"text-sm text-gray-500"},S.direccion))),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},S.categoria||"Sin categoría"),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},a.createElement("div",{className:"text-sm text-gray-900"},S.telefono),a.createElement("div",{className:"text-sm text-gray-500"},S.email)),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},a.createElement("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${S.estado==="Activa"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},S.estado||"Sin estado")),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2"},a.createElement("button",{className:"text-blue-600 hover:text-blue-900",onClick:()=>x(S)},"Editar"),a.createElement("button",{className:S.estado==="Activa"?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900",onClick:()=>T(S)},S.estado==="Activa"?"Desactivar":"Activar"),a.createElement("button",{className:"text-red-600 hover:text-red-900",onClick:()=>C(S.id)},"Eliminar")))))))),k.length===0&&a.createElement("div",{className:"text-center py-12"},a.createElement("div",{className:"text-gray-400"},a.createElement("div",{className:"text-4xl mb-4"},"🏪"),a.createElement("div",{className:"text-lg font-medium mb-2"},"No se encontraron empresas"),a.createElement("div",{className:"text-sm"},c.busqueda||c.estado||c.categoria?"No hay empresas que coincidan con los filtros aplicados":"Aún no hay empresas registradas en el sistema"),(c.busqueda||c.estado||c.categoria)&&a.createElement("button",{onClick:()=>u({busqueda:"",estado:"",categoria:""}),className:"mt-3 text-blue-600 hover:text-blue-800 text-sm"},"Limpiar filtros"))),g&&a.createElement(H8,{onClose:()=>v(!1),onSuccess:()=>{v(!1)}}))}function K8(){const[t,e]=p.useState([]),[n,r]=p.useState(null),[s,i]=p.useState({});p.useEffect(()=>Dt(Q($,"campanas"),f=>{e(f.docs.map(g=>({id:g.id,...g.data()})))}),[]);const o=d=>{var f,g;r(d.id),i({...d,fechaInicio:(f=d.fechaInicio)!=null&&f.toDate?d.fechaInicio.toDate().toISOString().slice(0,16):d.fechaInicio,fechaFin:(g=d.fechaFin)!=null&&g.toDate?d.fechaFin.toDate().toISOString().slice(0,16):d.fechaFin})},l=d=>{i({...s,[d.target.name]:d.target.value})},c=async()=>{const{id:d,...f}=s;await Me(we($,"campanas",n),{...f,fechaInicio:new Date(s.fechaInicio),fechaFin:new Date(s.fechaFin)}),r(null)},u=async d=>{window.confirm("¿Eliminar campaña?")&&await ws(we($,"campanas",d))};return a.createElement("div",{className:"mt-6"},a.createElement("h2",{className:"font-semibold mb-2"},"Campañas activas"),t.map(d=>a.createElement("div",{key:d.id,className:"bg-white rounded shadow p-4 mb-2 flex flex-col md:flex-row justify-between"},n===d.id?a.createElement("div",{className:"flex-1"},a.createElement("input",{className:"border p-1 mb-1 w-full",name:"titulo",value:s.titulo,onChange:l}),a.createElement("input",{className:"border p-1 mb-1 w-full",name:"descripcion",value:s.descripcion,onChange:l}),a.createElement("input",{className:"border p-1 mb-1 w-full",name:"imagenURL",value:s.imagenURL,onChange:l}),a.createElement("input",{className:"border p-1 mb-1 w-full",name:"link",value:s.link,onChange:l}),a.createElement("input",{className:"border p-1 mb-1 w-full",type:"datetime-local",name:"fechaInicio",value:s.fechaInicio,onChange:l}),a.createElement("input",{className:"border p-1 mb-1 w-full",type:"datetime-local",name:"fechaFin",value:s.fechaFin,onChange:l}),a.createElement("div",null,a.createElement("button",{className:"bg-green-600 text-white px-2 py-1 rounded mr-2",onClick:c},"Guardar"),a.createElement("button",{className:"bg-gray-400 text-white px-2 py-1 rounded",onClick:()=>r(null)},"Cancelar"))):a.createElement(a.Fragment,null,a.createElement("div",{className:"flex-1"},a.createElement("strong",null,d.titulo)," — ",d.descripcion," ",a.createElement("br",null),a.createElement("a",{href:d.link,className:"text-blue-500",target:"_blank",rel:"noopener noreferrer"},d.link),a.createElement("div",{className:"text-xs text-gray-500"},d.fechaInicio&&new Date(d.fechaInicio.seconds?d.fechaInicio.seconds*1e3:d.fechaInicio).toLocaleString()," -",d.fechaFin&&new Date(d.fechaFin.seconds?d.fechaFin.seconds*1e3:d.fechaFin).toLocaleString())),a.createElement("div",{className:"flex flex-col items-end mt-2 md:mt-0"},a.createElement("button",{className:"bg-blue-500 text-white px-2 py-1 rounded mb-1",onClick:()=>o(d)},"Editar"),a.createElement("button",{className:"bg-red-500 text-white px-2 py-1 rounded",onClick:()=>u(d.id)},"Eliminar"))))))}function Q8(){const[t,e]=p.useState({titulo:"",descripcion:"",imagenURL:"",link:"",fechaInicio:"",fechaFin:""}),n=s=>{e({...t,[s.target.name]:s.target.value})},r=async s=>{if(s.preventDefault(),!t.titulo||!t.imagenURL||!t.fechaInicio||!t.fechaFin){alert("Completa los campos obligatorios.");return}await ze(Q($,"campanas"),{...t,fechaInicio:new Date(t.fechaInicio),fechaFin:new Date(t.fechaFin)}),e({titulo:"",descripcion:"",imagenURL:"",link:"",fechaInicio:"",fechaFin:""}),alert("¡Campaña creada!")};return a.createElement("form",{onSubmit:r,className:"bg-white p-4 rounded shadow max-w-md mx-auto mb-8"},a.createElement("h2",{className:"font-semibold mb-2"},"Crear nueva campaña"),a.createElement("input",{className:"border p-2 mb-2 w-full",name:"titulo",value:t.titulo,onChange:n,placeholder:"Título",required:!0}),a.createElement("input",{className:"border p-2 mb-2 w-full",name:"descripcion",value:t.descripcion,onChange:n,placeholder:"Descripción"}),a.createElement("input",{className:"border p-2 mb-2 w-full",name:"imagenURL",value:t.imagenURL,onChange:n,placeholder:"URL de imagen",required:!0}),a.createElement("input",{className:"border p-2 mb-2 w-full",name:"link",value:t.link,onChange:n,placeholder:"Enlace de destino"}),a.createElement("label",{className:"block text-sm mb-1"},"Fecha inicio:"),a.createElement("input",{className:"border p-2 mb-2 w-full",type:"datetime-local",name:"fechaInicio",value:t.fechaInicio,onChange:n,required:!0}),a.createElement("label",{className:"block text-sm mb-1"},"Fecha fin:"),a.createElement("input",{className:"border p-2 mb-2 w-full",type:"datetime-local",name:"fechaFin",value:t.fechaFin,onChange:n,required:!0}),a.createElement("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded mt-2"},"Guardar campaña"))}function J8({user:t}){const[e,n]=p.useState("overview"),[r,s]=p.useState({totalEmpresas:0,empresasActivas:0,solicitudesPendientes:0,clientesPendientes:0,totalCampañas:0}),[i,o]=p.useState(!0);p.useEffect(()=>{(async()=>{try{console.log("📊 Cargando estadísticas del dashboard...");const u=await ue(Q($,"empresas")),d=u.docs.filter(k=>{const _=k.data().estado;return _==="activa"||_==="Activa"});console.log("🏢 Empresas encontradas:",u.size,"Activas:",d.length);const f=pe(Q($,"solicitudes_empresa"),fe("estado","in",["pendiente","en_revision"])),g=await ue(f);console.log("📋 Solicitudes empresa pendientes:",g.size);const v=pe(Q($,"solicitudes_proveedor"),fe("estado_general","in",["enviada","en_revision"])),x=await ue(v);console.log("📋 Solicitudes proveedor pendientes:",x.size);const E=g.size+x.size,y=pe(Q($,"solicitudes_cliente"),fe("estado","==","pendiente")),h=await ue(y);console.log("👥 Solicitudes cliente pendientes:",h.size);const C=await ue(Q($,"campañas"));console.log("📢 Campañas totales:",C.size);const T={totalEmpresas:u.size,empresasActivas:d.length,solicitudesPendientes:E,clientesPendientes:h.size,totalCampañas:C.size};console.log("✅ Estadísticas actualizadas:",T),s(T)}catch(u){console.error("❌ Error cargando estadísticas:",u)}finally{o(!1)}})()},[]);const l=async()=>{o(!0),console.log("🔄 Recargando estadísticas manualmente...");try{const c=await ue(Q($,"empresas")),u=c.docs.filter(T=>{const k=T.data().estado;return k==="activa"||k==="Activa"});console.log("🏢 Empresas encontradas:",c.size,"Activas:",u.length);const d=pe(Q($,"solicitudes_empresa"),fe("estado","in",["pendiente","en_revision"])),f=await ue(d);console.log("📋 Solicitudes empresa pendientes:",f.size);const g=pe(Q($,"solicitudes_proveedor"),fe("estado_general","in",["enviada","en_revision"])),v=await ue(g);console.log("📋 Solicitudes proveedor pendientes:",v.size);const x=f.size+v.size,E=pe(Q($,"solicitudes_cliente"),fe("estado","==","pendiente")),y=await ue(E);console.log("👥 Solicitudes cliente pendientes:",y.size);const h=await ue(Q($,"campañas"));console.log("📢 Campañas totales:",h.size);const C={totalEmpresas:c.size,empresasActivas:u.length,solicitudesPendientes:x,clientesPendientes:y.size,totalCampañas:h.size};console.log("✅ Estadísticas recargadas:",C),s(C)}catch(c){console.error("❌ Error recargando estadísticas:",c)}finally{o(!1)}};return a.createElement("div",{className:"p-6 max-w-7xl mx-auto"},a.createElement("div",{className:"mb-8 flex items-center justify-between"},a.createElement("div",null,a.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Panel de Administración"),a.createElement("p",{className:"text-gray-600"},"Bienvenido, ",t==null?void 0:t.email,". Gestiona todo el sistema desde aquí.")),a.createElement("button",{onClick:l,disabled:i,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-300 text-white px-4 py-2 rounded-lg transition-colors flex items-center gap-2"},i?a.createElement(a.Fragment,null,a.createElement("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Cargando..."):a.createElement(a.Fragment,null,"🔄 Actualizar Estadísticas"))),a.createElement("div",{className:"flex gap-4 mb-6 border-b border-gray-200"},a.createElement("button",{className:`px-4 py-2 font-medium ${e==="overview"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>n("overview")},"📊 Resumen"),a.createElement("button",{className:`px-4 py-2 font-medium ${e==="empresas"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>n("empresas")},"🏪 Empresas"),a.createElement("button",{className:`px-4 py-2 font-medium ${e==="campañas"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>n("campañas")},"📢 Campañas")),e==="overview"&&a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4"},a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},a.createElement("div",{className:"text-2xl font-bold text-blue-800"},i?"...":r.totalEmpresas),a.createElement("div",{className:"text-blue-600 text-sm"},"Total Empresas")),a.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},a.createElement("div",{className:"text-2xl font-bold text-green-800"},i?"...":r.empresasActivas),a.createElement("div",{className:"text-green-600 text-sm"},"Empresas Activas")),a.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},a.createElement("div",{className:"text-2xl font-bold text-yellow-800"},i?"...":r.solicitudesPendientes),a.createElement("div",{className:"text-yellow-600 text-sm"},"Solicitudes Proveedores")),a.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4"},a.createElement("div",{className:"text-2xl font-bold text-purple-800"},i?"...":r.clientesPendientes),a.createElement("div",{className:"text-purple-600 text-sm"},"Clientes Pendientes")),a.createElement("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4"},a.createElement("div",{className:"text-2xl font-bold text-indigo-800"},i?"...":r.totalCampañas),a.createElement("div",{className:"text-indigo-600 text-sm"},"Campañas Activas"))),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},a.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},a.createElement("h3",{className:"font-semibold text-lg text-gray-900 mb-4"},"🏪 Gestión de Proveedores"),a.createElement("div",{className:"space-y-3"},a.createElement(Tn,{to:"/admin/solicitudes-registro",className:"block w-full text-left px-4 py-2 bg-blue-50 hover:bg-blue-100 rounded-lg text-sm text-blue-700 transition-colors"},"📋 Solicitudes Pendientes (",r.solicitudesPendientes,")"),a.createElement(Tn,{to:"/admin/proveedores",className:"block w-full text-left px-4 py-2 bg-gray-50 hover:bg-gray-100 rounded-lg text-sm text-gray-700 transition-colors"},"🏪 Ver Todos los Proveedores"))),a.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},a.createElement("h3",{className:"font-semibold text-lg text-gray-900 mb-4"},"👥 Gestión de Clientes"),a.createElement("div",{className:"space-y-3"},a.createElement(Tn,{to:"/admin/solicitudes-cliente",className:"block w-full text-left px-4 py-2 bg-purple-50 hover:bg-purple-100 rounded-lg text-sm text-purple-700 transition-colors"},"📋 Solicitudes Pendientes (",r.clientesPendientes,")"),a.createElement(Tn,{to:"/admin/validacion-clientes",className:"block w-full text-left px-4 py-2 bg-gray-50 hover:bg-gray-100 rounded-lg text-sm text-gray-700 transition-colors"},"✅ Validar Clientes"))),a.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},a.createElement("h3",{className:"font-semibold text-lg text-gray-900 mb-4"},"📊 Catastro y Datos"),a.createElement("div",{className:"space-y-3"},a.createElement(Tn,{to:"/admin/catastro-masivo",className:"block w-full text-left px-4 py-2 bg-green-50 hover:bg-green-100 rounded-lg text-sm text-green-700 transition-colors"},"📊 Catastro Masivo"),a.createElement(Tn,{to:"/admin/panel-validacion",className:"block w-full text-left px-4 py-2 bg-gray-50 hover:bg-gray-100 rounded-lg text-sm text-gray-700 transition-colors"},"🔍 Panel de Validación"))),a.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},a.createElement("h3",{className:"font-semibold text-lg text-gray-900 mb-4"},"⚙️ Configuración"),a.createElement("div",{className:"space-y-3"},a.createElement(Tn,{to:"/admin/marcas",className:"block w-full text-left px-4 py-2 bg-yellow-50 hover:bg-yellow-100 rounded-lg text-sm text-yellow-700 transition-colors"},"🏷️ Gestión de Marcas"),a.createElement(Tn,{to:"/admin/categorias",className:"block w-full text-left px-4 py-2 bg-gray-50 hover:bg-gray-100 rounded-lg text-sm text-gray-700 transition-colors"},"📂 Gestión de Categorías"))),a.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},a.createElement("h3",{className:"font-semibold text-lg text-gray-900 mb-4"},"📈 Reportes y Stats"),a.createElement("div",{className:"space-y-3"},a.createElement(Tn,{to:"/admin/estadisticas",className:"block w-full text-left px-4 py-2 bg-indigo-50 hover:bg-indigo-100 rounded-lg text-sm text-indigo-700 transition-colors"},"📊 Panel de Estadísticas"),a.createElement(Tn,{to:"/admin/gestion-tickets",className:"block w-full text-left px-4 py-2 bg-gray-50 hover:bg-gray-100 rounded-lg text-sm text-gray-700 transition-colors"},"🎫 Gestión de Tickets"))),a.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},a.createElement("h3",{className:"font-semibold text-lg text-gray-900 mb-4"},"🚗 Servicios"),a.createElement("div",{className:"space-y-3"},a.createElement(Tn,{to:"/servicios/seguros",className:"block w-full text-left px-4 py-2 bg-blue-50 hover:bg-blue-100 rounded-lg text-sm text-blue-700 transition-colors"},"🛡️ Gestión de Seguros"),a.createElement(Tn,{to:"/mis-recordatorios",className:"block w-full text-left px-4 py-2 bg-gray-50 hover:bg-gray-100 rounded-lg text-sm text-gray-700 transition-colors"},"🔔 Mis Recordatorios"))))),e==="empresas"&&a.createElement(G8,null),e==="campañas"&&a.createElement("div",{className:"space-y-6"},a.createElement(Q8,null),a.createElement(K8,null)))}var CT={exports:{}},Y8="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Z8=Y8,X8=Z8;function ST(){}function kT(){}kT.resetWarningCache=ST;var e$=function(){function t(r,s,i,o,l,c){if(c!==X8){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:kT,resetWarningCache:ST};return n.PropTypes=n,n};CT.exports=e$();var t$=CT.exports;const st=e0(t$),n$=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function Uo(t,e,n){const r=r$(t),{webkitRelativePath:s}=t,i=typeof e=="string"?e:typeof s=="string"&&s.length>0?s:`./${t.name}`;return typeof r.path!="string"&&aN(r,"path",i),n!==void 0&&Object.defineProperty(r,"handle",{value:n,writable:!1,configurable:!1,enumerable:!0}),aN(r,"relativePath",i),r}function r$(t){const{name:e}=t;if(e&&e.lastIndexOf(".")!==-1&&!t.type){const r=e.split(".").pop().toLowerCase(),s=n$.get(r);s&&Object.defineProperty(t,"type",{value:s,writable:!1,configurable:!1,enumerable:!0})}return t}function aN(t,e,n){Object.defineProperty(t,e,{value:n,writable:!1,configurable:!1,enumerable:!0})}const a$=[".DS_Store","Thumbs.db"];function s$(t){return Si(this,void 0,void 0,function*(){return Km(t)&&i$(t.dataTransfer)?u$(t.dataTransfer,t.type):o$(t)?l$(t):Array.isArray(t)&&t.every(e=>"getFile"in e&&typeof e.getFile=="function")?c$(t):[]})}function i$(t){return Km(t)}function o$(t){return Km(t)&&Km(t.target)}function Km(t){return typeof t=="object"&&t!==null}function l$(t){return Gg(t.target.files).map(e=>Uo(e))}function c$(t){return Si(this,void 0,void 0,function*(){return(yield Promise.all(t.map(n=>n.getFile()))).map(n=>Uo(n))})}function u$(t,e){return Si(this,void 0,void 0,function*(){if(t.items){const n=Gg(t.items).filter(s=>s.kind==="file");if(e!=="drop")return n;const r=yield Promise.all(n.map(d$));return sN(IT(r))}return sN(Gg(t.files).map(n=>Uo(n)))})}function sN(t){return t.filter(e=>a$.indexOf(e.name)===-1)}function Gg(t){if(t===null)return[];const e=[];for(let n=0;n<t.length;n++){const r=t[n];e.push(r)}return e}function d$(t){if(typeof t.webkitGetAsEntry!="function")return iN(t);const e=t.webkitGetAsEntry();return e&&e.isDirectory?TT(e):iN(t,e)}function IT(t){return t.reduce((e,n)=>[...e,...Array.isArray(n)?IT(n):[n]],[])}function iN(t,e){return Si(this,void 0,void 0,function*(){var n;if(globalThis.isSecureContext&&typeof t.getAsFileSystemHandle=="function"){const i=yield t.getAsFileSystemHandle();if(i===null)throw new Error(`${t} is not a File`);if(i!==void 0){const o=yield i.getFile();return o.handle=i,Uo(o)}}const r=t.getAsFile();if(!r)throw new Error(`${t} is not a File`);return Uo(r,(n=e==null?void 0:e.fullPath)!==null&&n!==void 0?n:void 0)})}function m$(t){return Si(this,void 0,void 0,function*(){return t.isDirectory?TT(t):p$(t)})}function TT(t){const e=t.createReader();return new Promise((n,r)=>{const s=[];function i(){e.readEntries(o=>Si(this,void 0,void 0,function*(){if(o.length){const l=Promise.all(o.map(m$));s.push(l),i()}else try{const l=yield Promise.all(s);n(l)}catch(l){r(l)}}),o=>{r(o)})}i()})}function p$(t){return Si(this,void 0,void 0,function*(){return new Promise((e,n)=>{t.file(r=>{const s=Uo(r,t.fullPath);e(s)},r=>{n(r)})})})}var ch=function(t,e){if(t&&e){var n=Array.isArray(e)?e:e.split(",");if(n.length===0)return!0;var r=t.name||"",s=(t.type||"").toLowerCase(),i=s.replace(/\/.*$/,"");return n.some(function(o){var l=o.trim().toLowerCase();return l.charAt(0)==="."?r.toLowerCase().endsWith(l):l.endsWith("/*")?i===l.replace(/\/.*$/,""):s===l})}return!0};function oN(t){return g$(t)||h$(t)||PT(t)||f$()}function f$(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h$(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function g$(t){if(Array.isArray(t))return Kg(t)}function lN(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function cN(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?lN(Object(n),!0).forEach(function(r){AT(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lN(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function AT(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kc(t,e){return y$(t)||b$(t,e)||PT(t,e)||v$()}function v$(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PT(t,e){if(t){if(typeof t=="string")return Kg(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kg(t,e)}}function Kg(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function b$(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r=[],s=!0,i=!1,o,l;try{for(n=n.call(t);!(s=(o=n.next()).done)&&(r.push(o.value),!(e&&r.length===e));s=!0);}catch(c){i=!0,l=c}finally{try{!s&&n.return!=null&&n.return()}finally{if(i)throw l}}return r}}function y$(t){if(Array.isArray(t))return t}var E$=typeof ch=="function"?ch:ch.default,x$="file-invalid-type",w$="file-too-large",_$="file-too-small",N$="too-many-files",C$=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=e.split(","),r=n.length>1?"one of ".concat(n.join(", ")):n[0];return{code:x$,message:"File type must be ".concat(r)}},uN=function(e){return{code:w$,message:"File is larger than ".concat(e," ").concat(e===1?"byte":"bytes")}},dN=function(e){return{code:_$,message:"File is smaller than ".concat(e," ").concat(e===1?"byte":"bytes")}},S$={code:N$,message:"Too many files"};function RT(t,e){var n=t.type==="application/x-moz-file"||E$(t,e);return[n,n?null:C$(e)]}function LT(t,e,n){if(Fs(t.size))if(Fs(e)&&Fs(n)){if(t.size>n)return[!1,uN(n)];if(t.size<e)return[!1,dN(e)]}else{if(Fs(e)&&t.size<e)return[!1,dN(e)];if(Fs(n)&&t.size>n)return[!1,uN(n)]}return[!0,null]}function Fs(t){return t!=null}function k$(t){var e=t.files,n=t.accept,r=t.minSize,s=t.maxSize,i=t.multiple,o=t.maxFiles,l=t.validator;return!i&&e.length>1||i&&o>=1&&e.length>o?!1:e.every(function(c){var u=RT(c,n),d=Kc(u,1),f=d[0],g=LT(c,r,s),v=Kc(g,1),x=v[0],E=l?l(c):null;return f&&x&&!E})}function Qm(t){return typeof t.isPropagationStopped=="function"?t.isPropagationStopped():typeof t.cancelBubble<"u"?t.cancelBubble:!1}function pd(t){return t.dataTransfer?Array.prototype.some.call(t.dataTransfer.types,function(e){return e==="Files"||e==="application/x-moz-file"}):!!t.target&&!!t.target.files}function mN(t){t.preventDefault()}function I$(t){return t.indexOf("MSIE")!==-1||t.indexOf("Trident/")!==-1}function T$(t){return t.indexOf("Edge/")!==-1}function A$(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return I$(t)||T$(t)}function Ir(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){for(var s=arguments.length,i=new Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];return e.some(function(l){return!Qm(r)&&l&&l.apply(void 0,[r].concat(i)),Qm(r)})}}function P$(){return"showOpenFilePicker"in window}function R$(t){if(Fs(t)){var e=Object.entries(t).filter(function(n){var r=Kc(n,2),s=r[0],i=r[1],o=!0;return DT(s)||(console.warn('Skipped "'.concat(s,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),o=!1),(!Array.isArray(i)||!i.every(MT))&&(console.warn('Skipped "'.concat(s,'" because an invalid file extension was provided.')),o=!1),o}).reduce(function(n,r){var s=Kc(r,2),i=s[0],o=s[1];return cN(cN({},n),{},AT({},i,o))},{});return[{description:"Files",accept:e}]}return t}function L$(t){if(Fs(t))return Object.entries(t).reduce(function(e,n){var r=Kc(n,2),s=r[0],i=r[1];return[].concat(oN(e),[s],oN(i))},[]).filter(function(e){return DT(e)||MT(e)}).join(",")}function D$(t){return t instanceof DOMException&&(t.name==="AbortError"||t.code===t.ABORT_ERR)}function M$(t){return t instanceof DOMException&&(t.name==="SecurityError"||t.code===t.SECURITY_ERR)}function DT(t){return t==="audio/*"||t==="video/*"||t==="image/*"||t==="text/*"||t==="application/*"||/\w+\/[-+.\w]+/g.test(t)}function MT(t){return/^.*\.[\w]+$/.test(t)}var O$=["children"],V$=["open"],j$=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],F$=["refKey","onChange","onClick"];function z$(t){return B$(t)||$$(t)||OT(t)||U$()}function U$(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $$(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function B$(t){if(Array.isArray(t))return Qg(t)}function uh(t,e){return H$(t)||W$(t,e)||OT(t,e)||q$()}function q$(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OT(t,e){if(t){if(typeof t=="string")return Qg(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qg(t,e)}}function Qg(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function W$(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r=[],s=!0,i=!1,o,l;try{for(n=n.call(t);!(s=(o=n.next()).done)&&(r.push(o.value),!(e&&r.length===e));s=!0);}catch(c){i=!0,l=c}finally{try{!s&&n.return!=null&&n.return()}finally{if(i)throw l}}return r}}function H$(t){if(Array.isArray(t))return t}function pN(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function xt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?pN(Object(n),!0).forEach(function(r){Jg(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pN(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Jg(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jm(t,e){if(t==null)return{};var n=G$(t,e),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function G$(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var Rb=p.forwardRef(function(t,e){var n=t.children,r=Jm(t,O$),s=Lb(r),i=s.open,o=Jm(s,V$);return p.useImperativeHandle(e,function(){return{open:i}},[i]),a.createElement(p.Fragment,null,n(xt(xt({},o),{},{open:i})))});Rb.displayName="Dropzone";var VT={disabled:!1,getFilesFromEvent:s$,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};Rb.defaultProps=VT;Rb.propTypes={children:st.func,accept:st.objectOf(st.arrayOf(st.string)),multiple:st.bool,preventDropOnDocument:st.bool,noClick:st.bool,noKeyboard:st.bool,noDrag:st.bool,noDragEventsBubbling:st.bool,minSize:st.number,maxSize:st.number,maxFiles:st.number,disabled:st.bool,getFilesFromEvent:st.func,onFileDialogCancel:st.func,onFileDialogOpen:st.func,useFsAccessApi:st.bool,autoFocus:st.bool,onDragEnter:st.func,onDragLeave:st.func,onDragOver:st.func,onDrop:st.func,onDropAccepted:st.func,onDropRejected:st.func,onError:st.func,validator:st.func};var Yg={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function Lb(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=xt(xt({},VT),t),n=e.accept,r=e.disabled,s=e.getFilesFromEvent,i=e.maxSize,o=e.minSize,l=e.multiple,c=e.maxFiles,u=e.onDragEnter,d=e.onDragLeave,f=e.onDragOver,g=e.onDrop,v=e.onDropAccepted,x=e.onDropRejected,E=e.onFileDialogCancel,y=e.onFileDialogOpen,h=e.useFsAccessApi,C=e.autoFocus,T=e.preventDropOnDocument,k=e.noClick,_=e.noKeyboard,S=e.noDrag,N=e.noDragEventsBubbling,b=e.onError,w=e.validator,A=p.useMemo(function(){return L$(n)},[n]),R=p.useMemo(function(){return R$(n)},[n]),L=p.useMemo(function(){return typeof y=="function"?y:fN},[y]),M=p.useMemo(function(){return typeof E=="function"?E:fN},[E]),F=p.useRef(null),U=p.useRef(null),D=p.useReducer(K$,Yg),j=uh(D,2),V=j[0],z=j[1],G=V.isFocused,Y=V.isFileDialogActive,Z=p.useRef(typeof window<"u"&&window.isSecureContext&&h&&P$()),H=function(){!Z.current&&Y&&setTimeout(function(){if(U.current){var ge=U.current.files;ge.length||(z({type:"closeDialog"}),M())}},300)};p.useEffect(function(){return window.addEventListener("focus",H,!1),function(){window.removeEventListener("focus",H,!1)}},[U,Y,M,Z]);var oe=p.useRef([]),W=function(ge){F.current&&F.current.contains(ge.target)||(ge.preventDefault(),oe.current=[])};p.useEffect(function(){return T&&(document.addEventListener("dragover",mN,!1),document.addEventListener("drop",W,!1)),function(){T&&(document.removeEventListener("dragover",mN),document.removeEventListener("drop",W))}},[F,T]),p.useEffect(function(){return!r&&C&&F.current&&F.current.focus(),function(){}},[F,C,r]);var he=p.useCallback(function(ae){b?b(ae):console.error(ae)},[b]),xe=p.useCallback(function(ae){ae.preventDefault(),ae.persist(),zt(ae),oe.current=[].concat(z$(oe.current),[ae.target]),pd(ae)&&Promise.resolve(s(ae)).then(function(ge){if(!(Qm(ae)&&!N)){var Pe=ge.length,Ce=Pe>0&&k$({files:ge,accept:A,minSize:o,maxSize:i,multiple:l,maxFiles:c,validator:w}),Le=Pe>0&&!Ce;z({isDragAccept:Ce,isDragReject:Le,isDragActive:!0,type:"setDraggedFiles"}),u&&u(ae)}}).catch(function(ge){return he(ge)})},[s,u,he,N,A,o,i,l,c,w]),ie=p.useCallback(function(ae){ae.preventDefault(),ae.persist(),zt(ae);var ge=pd(ae);if(ge&&ae.dataTransfer)try{ae.dataTransfer.dropEffect="copy"}catch{}return ge&&f&&f(ae),!1},[f,N]),be=p.useCallback(function(ae){ae.preventDefault(),ae.persist(),zt(ae);var ge=oe.current.filter(function(Ce){return F.current&&F.current.contains(Ce)}),Pe=ge.indexOf(ae.target);Pe!==-1&&ge.splice(Pe,1),oe.current=ge,!(ge.length>0)&&(z({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),pd(ae)&&d&&d(ae))},[F,d,N]),ne=p.useCallback(function(ae,ge){var Pe=[],Ce=[];ae.forEach(function(Le){var Ut=RT(Le,A),xn=uh(Ut,2),Qt=xn[0],$t=xn[1],Vt=LT(Le,o,i),zn=uh(Vt,2),cr=zn[0],Nr=zn[1],Cr=w?w(Le):null;if(Qt&&cr&&!Cr)Pe.push(Le);else{var xa=[$t,Nr];Cr&&(xa=xa.concat(Cr)),Ce.push({file:Le,errors:xa.filter(function(Sr){return Sr})})}}),(!l&&Pe.length>1||l&&c>=1&&Pe.length>c)&&(Pe.forEach(function(Le){Ce.push({file:Le,errors:[S$]})}),Pe.splice(0)),z({acceptedFiles:Pe,fileRejections:Ce,isDragReject:Ce.length>0,type:"setFiles"}),g&&g(Pe,Ce,ge),Ce.length>0&&x&&x(Ce,ge),Pe.length>0&&v&&v(Pe,ge)},[z,l,A,o,i,c,g,v,x,w]),re=p.useCallback(function(ae){ae.preventDefault(),ae.persist(),zt(ae),oe.current=[],pd(ae)&&Promise.resolve(s(ae)).then(function(ge){Qm(ae)&&!N||ne(ge,ae)}).catch(function(ge){return he(ge)}),z({type:"reset"})},[s,ne,he,N]),Se=p.useCallback(function(){if(Z.current){z({type:"openDialog"}),L();var ae={multiple:l,types:R};window.showOpenFilePicker(ae).then(function(ge){return s(ge)}).then(function(ge){ne(ge,null),z({type:"closeDialog"})}).catch(function(ge){D$(ge)?(M(ge),z({type:"closeDialog"})):M$(ge)?(Z.current=!1,U.current?(U.current.value=null,U.current.click()):he(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):he(ge)});return}U.current&&(z({type:"openDialog"}),L(),U.current.value=null,U.current.click())},[z,L,M,h,ne,he,R,l]),Oe=p.useCallback(function(ae){!F.current||!F.current.isEqualNode(ae.target)||(ae.key===" "||ae.key==="Enter"||ae.keyCode===32||ae.keyCode===13)&&(ae.preventDefault(),Se())},[F,Se]),je=p.useCallback(function(){z({type:"focus"})},[]),Ee=p.useCallback(function(){z({type:"blur"})},[]),Re=p.useCallback(function(){k||(A$()?setTimeout(Se,0):Se())},[k,Se]),ot=function(ge){return r?null:ge},ke=function(ge){return _?null:ot(ge)},qe=function(ge){return S?null:ot(ge)},zt=function(ge){N&&ge.stopPropagation()},tn=p.useMemo(function(){return function(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ge=ae.refKey,Pe=ge===void 0?"ref":ge,Ce=ae.role,Le=ae.onKeyDown,Ut=ae.onFocus,xn=ae.onBlur,Qt=ae.onClick,$t=ae.onDragEnter,Vt=ae.onDragOver,zn=ae.onDragLeave,cr=ae.onDrop,Nr=Jm(ae,j$);return xt(xt(Jg({onKeyDown:ke(Ir(Le,Oe)),onFocus:ke(Ir(Ut,je)),onBlur:ke(Ir(xn,Ee)),onClick:ot(Ir(Qt,Re)),onDragEnter:qe(Ir($t,xe)),onDragOver:qe(Ir(Vt,ie)),onDragLeave:qe(Ir(zn,be)),onDrop:qe(Ir(cr,re)),role:typeof Ce=="string"&&Ce!==""?Ce:"presentation"},Pe,F),!r&&!_?{tabIndex:0}:{}),Nr)}},[F,Oe,je,Ee,Re,xe,ie,be,re,_,S,r]),Kt=p.useCallback(function(ae){ae.stopPropagation()},[]),In=p.useMemo(function(){return function(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ge=ae.refKey,Pe=ge===void 0?"ref":ge,Ce=ae.onChange,Le=ae.onClick,Ut=Jm(ae,F$),xn=Jg({accept:A,multiple:l,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:ot(Ir(Ce,re)),onClick:ot(Ir(Le,Kt)),tabIndex:-1},Pe,U);return xt(xt({},xn),Ut)}},[U,n,l,re,r]);return xt(xt({},V),{},{isFocused:G&&!r,getRootProps:tn,getInputProps:In,rootRef:F,inputRef:U,open:ot(Se)})}function K$(t,e){switch(e.type){case"focus":return xt(xt({},t),{},{isFocused:!0});case"blur":return xt(xt({},t),{},{isFocused:!1});case"openDialog":return xt(xt({},Yg),{},{isFileDialogActive:!0});case"closeDialog":return xt(xt({},t),{},{isFileDialogActive:!1});case"setDraggedFiles":return xt(xt({},t),{},{isDragActive:e.isDragActive,isDragAccept:e.isDragAccept,isDragReject:e.isDragReject});case"setFiles":return xt(xt({},t),{},{acceptedFiles:e.acceptedFiles,fileRejections:e.fileRejections,isDragReject:e.isDragReject});case"reset":return xt({},Yg);default:return t}}function fN(){}const Q$=()=>{const[t,e]=p.useState(!1),[n,r]=p.useState(0),[s,i]=p.useState(null),o=async(u,d,f={})=>{try{if(e(!0),r(0),i(null),!u)throw new Error("No se proporcionó archivo");if(f.allowedTypes&&!f.allowedTypes.includes(u.type))throw new Error(`Tipo de archivo no permitido. Permitidos: ${f.allowedTypes.join(", ")}`);if(f.maxSize&&u.size>f.maxSize)throw new Error(`Archivo muy grande. Máximo permitido: ${f.maxSize/1024/1024}MB`);const g=f.fileName||`${Date.now()}_${u.name}`,v=`${d}/${g}`,x=$c(Wc,v);r(25);const E=await Dm(x,u);r(75);const y=await Mm(E.ref);return r(100),{downloadURL:y,path:v,fileName:g,size:u.size,type:u.type}}catch(g){throw i(g.message),g}finally{e(!1),setTimeout(()=>r(0),2e3)}};return{uploading:t,uploadProgress:n,error:s,uploadFile:o,uploadImage:async(u,d,f={})=>{const g={allowedTypes:["image/jpeg","image/jpg","image/png","image/gif","image/webp"],maxSize:5242880,...f};return o(u,d,g)},deleteFile:async u=>{try{i(null);const d=$c(Wc,u);return await iV(d),!0}catch(d){throw i(d.message),d}}}},J$=()=>{const{rol:t}=Qe(),[e,n]=p.useState([]),[r,s]=p.useState(!1),[i,o]=p.useState(null),[l,c]=p.useState(!1),{uploadImage:u,deleteFile:d,uploading:f,uploadProgress:g,error:v}=Q$(),[x,E]=p.useState({nombre:"",descripcion:"",sitioWeb:"",activa:!0});p.useEffect(()=>{const N=Dt(Q($,"marcas"),b=>{const w=b.docs.map(A=>({id:A.id,...A.data()}));n(w.sort((A,R)=>{var L;return((L=A.nombre)==null?void 0:L.localeCompare(R.nombre))||0}))});return()=>N()},[]);const y=async(N,b)=>{try{const w=await u(N,"logos/marcas",{fileName:`${b}_${Date.now()}.${N.name.split(".").pop()}`});return await Me(we($,"marcas",b),{logoUrl:w.downloadURL,logoPath:w.path,fechaActualizacion:qn()}),w.downloadURL}catch(w){throw console.error("Error subiendo logo:",w),alert(`Error al subir logo: ${w.message}`),w}},h=async N=>{try{N.logoPath&&await d(N.logoPath),await Me(we($,"marcas",N.id),{logoUrl:null,logoPath:null,fechaActualizacion:qn()})}catch(b){console.error("Error eliminando logo:",b),alert(`Error al eliminar logo: ${b.message}`)}},C=async()=>{try{s(!0),await ze(Q($,"marcas"),{...x,fechaCreacion:qn(),fechaActualizacion:qn()}),E({nombre:"",descripcion:"",sitioWeb:"",activa:!0}),c(!1)}catch(N){console.error("Error creando marca:",N),alert("Error al crear la marca")}finally{s(!1)}},T=async()=>{try{s(!0),await Me(we($,"marcas",i.id),{...x,fechaActualizacion:qn()}),o(null),E({nombre:"",descripcion:"",sitioWeb:"",activa:!0})}catch(N){console.error("Error actualizando marca:",N),alert("Error al actualizar la marca")}finally{s(!1)}},k=async N=>{if(confirm(`¿Estás seguro de eliminar la marca "${N.nombre}"?`))try{N.logoPath&&await h(N),await ws(we($,"marcas",N.id))}catch(b){console.error("Error eliminando marca:",b),alert("Error al eliminar la marca")}},_=({marca:N})=>{const{getRootProps:b,getInputProps:w,isDragActive:A}=Lb({accept:{"image/*":[".png",".jpg",".jpeg",".gif",".webp"]},maxFiles:1,onDrop:async R=>{if(R.length>0)try{await y(R[0],N.id)}catch{}}});return a.createElement("div",{className:"flex items-center space-x-3"},a.createElement("div",{className:"flex-shrink-0"},N.logoUrl?a.createElement("div",{className:"relative group"},a.createElement("img",{src:N.logoUrl,alt:`Logo ${N.nombre}`,className:"w-16 h-16 object-contain rounded border bg-white shadow"}),a.createElement("button",{onClick:()=>h(N),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 text-xs opacity-0 group-hover:opacity-100 transition-opacity"},"×")):a.createElement("div",{className:"w-16 h-16 bg-gray-100 rounded border flex items-center justify-center text-gray-400"},"🏷️")),a.createElement("div",{className:"flex-1"},a.createElement("div",{...b(),className:`border-2 border-dashed rounded-lg p-3 text-center cursor-pointer transition-colors ${A?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-400 hover:bg-gray-50"}`},a.createElement("input",{...w()}),f?a.createElement("div",null,a.createElement("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-1"},a.createElement("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${g}%`}})),a.createElement("p",{className:"text-xs text-gray-600"},"Subiendo... ",g,"%")):a.createElement("div",null,a.createElement("p",{className:"text-sm text-gray-600"},A?"Suelta el logo aquí":"Clic o arrastra logo"),a.createElement("p",{className:"text-xs text-gray-500"},"PNG, JPG, JPEG, GIF, WEBP (máx. 5MB)"))),v&&a.createElement("p",{className:"text-red-500 text-xs mt-1"},v)))},S=({isEdit:N=!1})=>a.createElement("div",{className:"bg-gray-50 p-4 rounded-lg border"},a.createElement("h3",{className:"font-semibold mb-3"},N?"Editar Marca":"Nueva Marca"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Nombre *"),a.createElement("input",{type:"text",value:x.nombre,onChange:b=>E(w=>({...w,nombre:b.target.value})),className:"w-full border border-gray-300 rounded px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nombre de la marca",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Sitio Web"),a.createElement("input",{type:"url",value:x.sitioWeb,onChange:b=>E(w=>({...w,sitioWeb:b.target.value})),className:"w-full border border-gray-300 rounded px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://www.marca.com"})),a.createElement("div",{className:"md:col-span-2"},a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Descripción"),a.createElement("textarea",{value:x.descripcion,onChange:b=>E(w=>({...w,descripcion:b.target.value})),rows:2,className:"w-full border border-gray-300 rounded px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Descripción de la marca"})),a.createElement("div",{className:"flex items-center"},a.createElement("input",{type:"checkbox",id:"activa",checked:x.activa,onChange:b=>E(w=>({...w,activa:b.target.checked})),className:"mr-2"}),a.createElement("label",{htmlFor:"activa",className:"text-sm text-gray-700"},"Marca activa"))),a.createElement("div",{className:"flex space-x-2 mt-4"},a.createElement("button",{onClick:N?T:C,disabled:r||!x.nombre.trim(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50 text-sm"},r?"Guardando...":N?"Actualizar":"Crear"),a.createElement("button",{onClick:()=>{o(null),c(!1),E({nombre:"",descripcion:"",sitioWeb:"",activa:!0})},className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 text-sm"},"Cancelar")));return t!=="admin"?a.createElement("div",{className:"text-center p-8"},a.createElement("p",{className:"text-red-600"},"Solo administradores pueden gestionar marcas")):a.createElement("div",{className:"max-w-7xl mx-auto p-6"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg"},a.createElement("div",{className:"p-6 border-b"},a.createElement("div",{className:"flex justify-between items-center"},a.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"🏷️ Administración de Marcas"),a.createElement("button",{onClick:()=>c(!0),className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 text-sm"},"+ Nueva Marca"))),l&&a.createElement("div",{className:"p-6 border-b"},a.createElement(S,null)),a.createElement("div",{className:"p-6"},a.createElement("div",{className:"space-y-4"},e.map(N=>a.createElement("div",{key:N.id,className:"border border-gray-200 rounded-lg p-4"},(i==null?void 0:i.id)===N.id?a.createElement(S,{isEdit:!0}):a.createElement("div",null,a.createElement("div",{className:"flex justify-between items-start mb-4"},a.createElement("div",{className:"flex-1"},a.createElement("div",{className:"flex items-center space-x-3 mb-2"},a.createElement("h3",{className:"text-lg font-semibold text-gray-900"},N.nombre),a.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${N.activa?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},N.activa?"Activa":"Inactiva")),N.descripcion&&a.createElement("p",{className:"text-gray-600 text-sm mb-2"},N.descripcion),N.sitioWeb&&a.createElement("a",{href:N.sitioWeb,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm underline"},"🌐 ",N.sitioWeb)),a.createElement("div",{className:"flex space-x-2"},a.createElement("button",{onClick:()=>{o(N),E({nombre:N.nombre||"",descripcion:N.descripcion||"",sitioWeb:N.sitioWeb||"",activa:N.activa!==!1})},className:"bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600 text-sm"},"✏️ Editar"),a.createElement("button",{onClick:()=>k(N),className:"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm"},"🗑️ Eliminar"))),a.createElement(_,{marca:N})))),e.length===0&&a.createElement("div",{className:"text-center py-8"},a.createElement("p",{className:"text-gray-500"},"No hay marcas registradas"))))))},dh=[{nombre:"Ferretería El Tornillo",direccion:"Av. 10 de Julio #123, Santiago",telefono:"+56 9 1234 5678",email:"contacto@eltornillo.cl",categoria:"Ferretería",rubro:"Ferretería",descripcion:"Todo en herramientas y materiales para la construcción.",descripcionCompleta:"Somos una ferretería familiar con más de 20 años de experiencia en el rubro. Ofrecemos una amplia gama de herramientas, materiales de construcción y artículos para el hogar. Nuestro compromiso es brindar productos de calidad y un servicio personalizado a cada cliente.",web:"",logo:"Ferreteria_ElTornillo.png",imagenLocal:"ferreteria_local.jpg",logoAsignado:!0,estado:"activa",fechaRegistro:new Date,destacado:!0,servicios:["Venta de herramientas","Materiales de construcción","Asesoría técnica","Delivery"],horarios:{lunes:{activo:!0,inicio:"08:00",fin:"18:00"},martes:{activo:!0,inicio:"08:00",fin:"18:00"},miercoles:{activo:!0,inicio:"08:00",fin:"18:00"},jueves:{activo:!0,inicio:"08:00",fin:"18:00"},viernes:{activo:!0,inicio:"08:00",fin:"18:00"},sabado:{activo:!0,inicio:"09:00",fin:"14:00"},domingo:{activo:!1}},contactoAdicional:{whatsapp:"+56 9 1234 5678",facebook:"FerreteriaElTornillo",instagram:"ferreteria_eltornillo"},galeria:["herramientas1.jpg","local_ferreteria.jpg","materiales.jpg"]},{nombre:"Automotora Los Andes",direccion:"Calle Principal #456, Las Condes",telefono:"+56 9 2345 6789",email:"ventas@losandes.cl",categoria:"Automotora",rubro:"Automotora",descripcion:"Venta de vehículos nuevos y usados con garantía.",descripcionCompleta:"Automotora con más de 15 años en el mercado, especializada en la venta de vehículos nuevos y usados. Ofrecemos las mejores marcas del mercado con garantía extendida y planes de financiamiento flexibles. Nuestro equipo de profesionales está capacitado para asesorarte en la compra de tu próximo vehículo.",web:"https://www.losandes.cl",logo:"Automotora_LosAndes.png",imagenLocal:"automotora_showroom.jpg",logoAsignado:!0,estado:"activa",fechaRegistro:new Date,destacado:!1,servicios:["Venta de autos nuevos","Venta de autos usados","Financiamiento","Garantía extendida","Test drive"],horarios:{lunes:{activo:!0,inicio:"09:00",fin:"19:00"},martes:{activo:!0,inicio:"09:00",fin:"19:00"},miercoles:{activo:!0,inicio:"09:00",fin:"19:00"},jueves:{activo:!0,inicio:"09:00",fin:"19:00"},viernes:{activo:!0,inicio:"09:00",fin:"19:00"},sabado:{activo:!0,inicio:"10:00",fin:"16:00"},domingo:{activo:!0,inicio:"10:00",fin:"14:00"}},contactoAdicional:{whatsapp:"+56 9 2345 6789",facebook:"AutomotraLosAndes",instagram:"losandes_autos"},galeria:["showroom1.jpg","autos_nuevos.jpg","equipo_ventas.jpg"]},{nombre:"Repuestos Chile Central",direccion:"Av. Libertador #789, Santiago Centro",telefono:"+56 9 3456 7890",email:"info@chilecentral.cl",categoria:"Repuestos",rubro:"Repuestos",descripcion:"Repuestos originales y alternativos para todo tipo de vehículos.",descripcionCompleta:"Especialistas en repuestos automotrices con más de 25 años de experiencia. Contamos con un amplio stock de repuestos originales y alternativos para todas las marcas y modelos. Ofrecemos asesoría técnica especializada y garantía en todos nuestros productos.",web:"",logo:"",imagenLocal:"repuestos_bodega.jpg",logoAsignado:!1,estado:"inactiva",fechaRegistro:new Date,destacado:!1,servicios:["Repuestos originales","Repuestos alternativos","Asesoría técnica","Instalación","Garantía"],horarios:{lunes:{activo:!0,inicio:"08:30",fin:"17:30"},martes:{activo:!0,inicio:"08:30",fin:"17:30"},miercoles:{activo:!0,inicio:"08:30",fin:"17:30"},jueves:{activo:!0,inicio:"08:30",fin:"17:30"},viernes:{activo:!0,inicio:"08:30",fin:"17:30"},sabado:{activo:!0,inicio:"09:00",fin:"13:00"},domingo:{activo:!1}},galeria:["repuestos_motor.jpg","filtros.jpg","bodega_repuestos.jpg"]},{nombre:"Taller Mecánico Express",direccion:"Calle Reparaciones #321, Ñuñoa",telefono:"+56 9 4567 8901",email:"contacto@express.cl",categoria:"Taller",rubro:"Mecánica",descripcion:"Reparaciones rápidas y garantizadas para tu vehículo.",descripcionCompleta:"Taller mecánico especializado en reparaciones rápidas y mantenciones preventivas. Contamos con tecnología de punta y mecánicos certificados. Ofrecemos diagnóstico computarizado, cambio de aceite express, reparaciones de motor, frenos y transmisión con garantía de 6 meses.",web:"https://www.express.cl",logo:"Taller_Express.png",imagenLocal:"taller_bahias.jpg",logoAsignado:!0,estado:"suspendida",fechaRegistro:new Date,destacado:!1,servicios:["Mantención preventiva","Reparación de motores","Sistema de frenos","Transmisión","Diagnóstico computarizado"],horarios:{lunes:{activo:!0,inicio:"08:00",fin:"18:00"},martes:{activo:!0,inicio:"08:00",fin:"18:00"},miercoles:{activo:!0,inicio:"08:00",fin:"18:00"},jueves:{activo:!0,inicio:"08:00",fin:"18:00"},viernes:{activo:!0,inicio:"08:00",fin:"18:00"},sabado:{activo:!0,inicio:"08:00",fin:"12:00"},domingo:{activo:!1}},contactoAdicional:{whatsapp:"+56 9 4567 8901"},galeria:["taller_equipos.jpg","mecanicos.jpg","bahia_trabajo.jpg"]},{nombre:"Lubricantes del Norte",direccion:"Av. Industrial #654, Quilicura",telefono:"+56 9 5678 9012",email:"ventas@lubrinorte.cl",categoria:"Lubricantes",rubro:"Lubricantes",descripcion:"Aceites y lubricantes profesionales para todo tipo de motores.",descripcionCompleta:"Empresa especializada en la distribución de aceites y lubricantes de las mejores marcas internacionales. Atendemos tanto a talleres como a usuarios finales. Contamos con asesoría técnica especializada para la selección del lubricante adecuado según las especificaciones de cada motor.",web:"",logo:"",imagenLocal:"bodega_lubricantes.jpg",logoAsignado:!1,estado:"activa",fechaRegistro:new Date,destacado:!0,servicios:["Aceites para motor","Lubricantes industriales","Filtros","Asesoría técnica","Delivery"],horarios:{lunes:{activo:!0,inicio:"07:30",fin:"17:00"},martes:{activo:!0,inicio:"07:30",fin:"17:00"},miercoles:{activo:!0,inicio:"07:30",fin:"17:00"},jueves:{activo:!0,inicio:"07:30",fin:"17:00"},viernes:{activo:!0,inicio:"07:30",fin:"17:00"},sabado:{activo:!1},domingo:{activo:!1}},contactoAdicional:{whatsapp:"+56 9 5678 9012",instagram:"lubricantes_norte"},galeria:["aceites_motor.jpg","bodega_productos.jpg","equipo_ventas.jpg"]}];async function Y$(){console.log("🏗️ Creando empresas de ejemplo...");for(let t=0;t<dh.length;t++)try{const e=await ze(Q($,"empresas"),dh[t]);console.log(`✅ Empresa ${t+1}/5 creada:`,dh[t].nombre,"ID:",e.id)}catch(e){console.error(`❌ Error creando empresa ${t+1}:`,e)}console.log("🎉 Proceso completado")}async function Z$(){console.log("📋 Creando solicitudes de ejemplo...");const t=[{nombre_empresa:"Taller Auto Servicio",email_empresa:"contacto@autoservicio.cl",telefono_empresa:"+56 9 8765 4321",direccion_empresa:"Av. Reparaciones #999, Maipú",categoria:"Taller",representante_nombre:"Carlos Méndez",representante_email:"carlos@autoservicio.cl",representante_telefono:"+56 9 8765 4321",descripcion:"Taller especializado en mantención y reparación de vehículos",estado:"pendiente",fecha_solicitud:new Date,origen:"formulario_web"},{nombre_empresa:"Repuestos Motor Chile",email_empresa:"ventas@motorchile.cl",telefono_empresa:"+56 9 5555 1234",direccion_empresa:"Calle Mecánica #456, Santiago",categoria:"Repuestos",representante_nombre:"Ana Torres",representante_email:"ana@motorchile.cl",representante_telefono:"+56 9 5555 1234",descripcion:"Distribuidora de repuestos para todo tipo de vehículos",estado:"en_revision",fecha_solicitud:new Date(Date.now()-864e5),origen:"agente_campo"},{nombre_empresa:"Lubricantes Express",email_empresa:"info@lubexpress.cl",telefono_empresa:"+56 9 7777 8888",direccion_empresa:"Av. Industrial #888, Quilicura",categoria:"Lubricantes",representante_nombre:"Roberto Silva",representante_email:"roberto@lubexpress.cl",representante_telefono:"+56 9 7777 8888",descripcion:"Venta de aceites y lubricantes para vehículos e industria",estado:"pendiente",fecha_solicitud:new Date(Date.now()-1728e5),origen:"formulario_web"}];for(let e=0;e<t.length;e++)try{const n=await ze(Q($,"solicitudes_empresa"),t[e]);console.log(`✅ Solicitud ${e+1}/3 creada:`,t[e].nombre_empresa,"ID:",n.id)}catch(n){console.error(`❌ Error creando solicitud ${e+1}:`,n)}console.log("🎉 Solicitudes de ejemplo creadas")}async function X$(){console.log("👥 Creando solicitudes de clientes de ejemplo...");const t=[{nombre:"Juan Pérez",email:"juan.perez@email.com",telefono:"+56 9 1111 2222",empresa:"Constructora Los Pinos",cargo:"Gerente de Operaciones",tipo_cliente:"empresa",estado:"pendiente",fecha_solicitud:new Date,comentarios:"Interesado en servicios de mantención de flota"},{nombre:"María González",email:"maria.gonzalez@email.com",telefono:"+56 9 3333 4444",empresa:"",cargo:"",tipo_cliente:"particular",estado:"pendiente",fecha_solicitud:new Date(Date.now()-864e5),comentarios:"Busca talleres de confianza para su vehículo particular"}];for(let e=0;e<t.length;e++)try{const n=await ze(Q($,"solicitudes_cliente"),t[e]);console.log(`✅ Solicitud cliente ${e+1}/2 creada:`,t[e].nombre,"ID:",n.id)}catch(n){console.error(`❌ Error creando solicitud cliente ${e+1}:`,n)}console.log("🎉 Solicitudes de clientes creadas")}function hN(t){return t?t.startsWith("http")?t:`/images/${t}`:""}function gN(t){if(!t)return"bg-gray-200 text-gray-700";switch(t.toLowerCase()){case"activa":case"activo":return"bg-green-100 text-green-700";case"inactiva":case"inactivo":return"bg-red-200 text-red-800";case"suspendida":case"suspendido":return"bg-orange-200 text-orange-800";default:return"bg-gray-100 text-gray-700"}}const e7=[{label:"Todos",value:"todos"},{label:"Activa",value:"activa"},{label:"Inactiva",value:"inactiva"},{label:"Suspendida",value:"suspendida"}];function t7(){const[t,e]=p.useState([]),[n,r]=p.useState({estado:"todos",busqueda:"",categoria:"",tieneWeb:"",tieneLogoAssignado:""}),[s,i]=p.useState(!0),[o,l]=p.useState("table"),c=ft();p.useEffect(()=>{console.log("🔍 Iniciando carga de empresas..."),console.log("🔥 Firebase config:",$),i(!0);try{const h=pe(Q($,"empresas"));return console.log("📡 Configurando listener..."),Dt(h,T=>{console.log("✅ Snapshot recibido"),console.log("📊 Número de documentos:",T.docs.length),console.log("📄 Metadata:",T.metadata),T.empty&&console.log("⚠️ La colección está vacía");const k=T.docs.map(_=>{const S=_.data();return console.log("� Procesando empresa:",_.id,S),{id:_.id,...S,nombre:S.nombre||"Sin nombre",estado:S.estado||"inactiva",categoria:S.categoria||"Sin categoría"}});console.log("✨ Empresas procesadas:",k),e(k),i(!1)},T=>{console.error("❌ Error en snapshot listener:",T),console.error("📝 Detalles del error:",T.code,T.message),i(!1),T.code==="permission-denied"?console.error("🚫 Sin permisos para leer la colección empresas"):T.code==="unavailable"&&console.error("🌐 Firebase no disponible - problema de conexión")})}catch(h){console.error("💥 Error configurando listener:",h),i(!1)}},[]);const u=async h=>{try{const C=h.estado==="activa"?"inactiva":"activa";await Me(we($,"empresas",h.id),{estado:C,fecha_actualizacion:new Date}),alert(`Empresa ${C} exitosamente`)}catch(C){console.error("Error cambiando estado:",C),alert("Error al cambiar el estado")}},d=async h=>{if(window.confirm(`¿Estás seguro de suspender a ${h.nombre}?`))try{await Me(we($,"empresas",h.id),{estado:"suspendida",fecha_suspension:new Date,fecha_actualizacion:new Date}),alert("Empresa suspendida exitosamente")}catch(C){console.error("Error suspendiendo empresa:",C),alert("Error al suspender la empresa")}},f=async h=>{if(window.confirm(`¿Estás seguro de eliminar a ${h.nombre}? Esta acción no se puede deshacer.`))try{await ws(we($,"empresas",h.id)),alert("Empresa eliminada exitosamente")}catch(C){console.error("Error eliminando empresa:",C),alert("Error al eliminar la empresa")}},g=async()=>{if(window.confirm("¿Quieres crear 5 empresas de ejemplo para testing? Esto te ayudará a probar la funcionalidad."))try{await Y$(),alert("✅ Empresas de ejemplo creadas exitosamente")}catch(h){console.error("Error creando empresas de ejemplo:",h),alert("❌ Error creando empresas de ejemplo")}},v=async()=>{if(window.confirm("¿Quieres crear solicitudes de empresas y clientes de ejemplo? Esto ayudará a probar el dashboard."))try{await Z$(),await X$(),alert("✅ Solicitudes de ejemplo creadas exitosamente")}catch(h){console.error("Error creando solicitudes de ejemplo:",h),alert("❌ Error creando solicitudes de ejemplo")}},x=t.filter(h=>{var N,b,w,A;const C=n.estado==="todos"||h.estado===n.estado,T=!n.busqueda||((N=h.nombre)==null?void 0:N.toLowerCase().includes(n.busqueda.toLowerCase()))||((b=h.email)==null?void 0:b.toLowerCase().includes(n.busqueda.toLowerCase()))||((w=h.direccion)==null?void 0:w.toLowerCase().includes(n.busqueda.toLowerCase()))||((A=h.categoria)==null?void 0:A.toLowerCase().includes(n.busqueda.toLowerCase())),k=!n.categoria||h.categoria===n.categoria,_=n.tieneWeb===""||n.tieneWeb==="si"&&h.web||n.tieneWeb==="no"&&!h.web,S=n.tieneLogoAssignado===""||n.tieneLogoAssignado==="si"&&h.logoAsignado||n.tieneLogoAssignado==="no"&&!h.logoAsignado;return C&&T&&k&&_&&S}),E=[...new Set(t.map(h=>h.categoria).filter(Boolean))],y={total:t.length,activas:t.filter(h=>h.estado==="activa").length,inactivas:t.filter(h=>h.estado==="inactiva").length,suspendidas:t.filter(h=>h.estado==="suspendida").length,sinWeb:t.filter(h=>!h.web).length,sinLogo:t.filter(h=>!h.logoAsignado).length};return s?a.createElement("div",{className:"flex items-center justify-center p-8"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.createElement("p",{className:"text-gray-600"},"Cargando empresas..."),a.createElement("p",{className:"text-gray-400 text-sm mt-2"},"Conectando con Firebase..."))):!s&&t.length===0?a.createElement("section",{className:"p-6"},a.createElement("div",{className:"mb-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Gestión de Empresas Registradas"),a.createElement("p",{className:"text-gray-600"},"Administra empresas y proveedores que ya están registrados en el sistema")),a.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-8 text-center"},a.createElement("span",{className:"text-6xl mb-4 block"},"🏢"),a.createElement("h3",{className:"text-lg font-medium text-yellow-900 mb-2"},"No hay empresas registradas"),a.createElement("p",{className:"text-yellow-700 mb-4"},"Parece que aún no se han registrado empresas en el sistema, o hay un problema de conexión con Firebase."),a.createElement("div",{className:"bg-yellow-100 border border-yellow-300 rounded-lg p-4 mb-6 text-left"},a.createElement("h4",{className:"font-medium text-yellow-900 mb-2"},"💡 Posibles causas:"),a.createElement("ul",{className:"text-yellow-800 text-sm space-y-1"},a.createElement("li",null,'• La colección "empresas" está vacía en Firebase'),a.createElement("li",null,"• Problemas de permisos de lectura en Firebase"),a.createElement("li",null,"• Problemas de conexión a internet"),a.createElement("li",null,"• Las empresas están en una colección diferente"))),a.createElement("div",{className:"space-x-4"},a.createElement("button",{onClick:()=>c("/admin/solicitudes-registro"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"},"📋 Ver Solicitudes"),a.createElement("button",{onClick:()=>c("/admin/proveedores"),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors"},"🏪 Vista Unificada"),a.createElement("button",{onClick:g,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors"},"🏗️ Crear Empresas"),a.createElement("button",{onClick:v,className:"bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors"},"📋 Crear Solicitudes"),a.createElement("button",{onClick:()=>window.location.reload(),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors"},"🔄 Recargar Página")),a.createElement("div",{className:"mt-6 text-xs text-yellow-600"},"💡 Tip: Revisa la consola del navegador (F12) para más detalles del error"))):a.createElement("section",{className:"p-6"},a.createElement("div",{className:"mb-6 flex items-center justify-between"},a.createElement("div",null,a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Gestión de Empresas Registradas"),a.createElement("p",{className:"text-gray-600"},"Administra empresas y proveedores que ya están registrados en el sistema")),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("button",{onClick:g,className:"bg-green-100 text-green-700 px-3 py-1 rounded text-sm hover:bg-green-200 transition-colors",title:"Crear empresas de ejemplo para testing"},"🧪 Crear Empresas"),a.createElement("button",{onClick:v,className:"bg-orange-100 text-orange-700 px-3 py-1 rounded text-sm hover:bg-orange-200 transition-colors",title:"Crear solicitudes de ejemplo para testing"},"📋 Crear Solicitudes"),a.createElement("button",{onClick:()=>{console.log("🔍 Estado actual:",{empresas:t,loading:s}),console.log("📊 Empresas filtradas:",x)},className:"bg-blue-100 text-blue-700 px-3 py-1 rounded text-sm hover:bg-blue-200 transition-colors",title:"Ver estado en consola"},"🔍 Debug Log"))),a.createElement("div",{className:"mb-6 bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",{className:"flex items-center"},a.createElement("div",{className:"flex-shrink-0"},a.createElement("span",{className:"text-2xl"},"📋")),a.createElement("div",{className:"ml-3"},a.createElement("h3",{className:"text-sm font-medium text-blue-900"},"¿Buscas solicitudes de agentes y nuevas empresas?"),a.createElement("p",{className:"text-sm text-blue-700"},"Gestiona solicitudes pendientes, incluyendo las enviadas por agentes de campo"))),a.createElement("div",{className:"flex space-x-3"},a.createElement("button",{onClick:()=>c("/admin/solicitudes-registro"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm"},"📋 Ver Solicitudes"),a.createElement("button",{onClick:()=>c("/admin/proveedores"),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors text-sm"},"🏪 Vista Unificada")))),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6"},a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center"},a.createElement("div",{className:"text-2xl font-bold text-blue-800"},y.total),a.createElement("div",{className:"text-blue-600 text-sm"},"Total")),a.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center"},a.createElement("div",{className:"text-2xl font-bold text-green-800"},y.activas),a.createElement("div",{className:"text-green-600 text-sm"},"Activas")),a.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center"},a.createElement("div",{className:"text-2xl font-bold text-red-800"},y.inactivas),a.createElement("div",{className:"text-red-600 text-sm"},"Inactivas")),a.createElement("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 text-center"},a.createElement("div",{className:"text-2xl font-bold text-orange-800"},y.suspendidas),a.createElement("div",{className:"text-orange-600 text-sm"},"Suspendidas")),a.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center"},a.createElement("div",{className:"text-2xl font-bold text-yellow-800"},y.sinWeb),a.createElement("div",{className:"text-yellow-600 text-sm"},"Sin Web")),a.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 text-center"},a.createElement("div",{className:"text-2xl font-bold text-purple-800"},y.sinLogo),a.createElement("div",{className:"text-purple-600 text-sm"},"Sin Logo"))),a.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Estado"),a.createElement("select",{value:n.estado,onChange:h=>r({...n,estado:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},e7.map(h=>a.createElement("option",{key:h.value,value:h.value},h.label)))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Categoría"),a.createElement("select",{value:n.categoria,onChange:h=>r({...n,categoria:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},a.createElement("option",{value:""},"Todas"),E.map(h=>a.createElement("option",{key:h,value:h},h)))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tiene Web"),a.createElement("select",{value:n.tieneWeb,onChange:h=>r({...n,tieneWeb:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},a.createElement("option",{value:""},"Todos"),a.createElement("option",{value:"si"},"Con Web"),a.createElement("option",{value:"no"},"Sin Web"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tiene Logo"),a.createElement("select",{value:n.tieneLogoAssignado,onChange:h=>r({...n,tieneLogoAssignado:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},a.createElement("option",{value:""},"Todos"),a.createElement("option",{value:"si"},"Con Logo"),a.createElement("option",{value:"no"},"Sin Logo"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Buscar"),a.createElement("input",{type:"text",placeholder:"Nombre, email, dirección...",value:n.busqueda,onChange:h=>r({...n,busqueda:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",{className:"flex items-end"},a.createElement("button",{onClick:()=>r({estado:"todos",busqueda:"",categoria:"",tieneWeb:"",tieneLogoAssignado:""}),className:"w-full px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors"},"Limpiar")))),a.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},a.createElement("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between"},a.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Empresas (",x.length,")"),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("button",{onClick:()=>l("table"),className:`p-2 rounded ${o==="table"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`},"📋 Tabla"),a.createElement("button",{onClick:()=>l("grid"),className:`p-2 rounded ${o==="grid"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`},"📱 Tarjetas"))),o==="table"?a.createElement("div",{className:"overflow-x-auto"},a.createElement("table",{className:"min-w-full"},a.createElement("thead",{className:"bg-gray-50"},a.createElement("tr",null,a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Logo"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Empresa"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Contacto"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Web/Perfil"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Estado"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Acciones"))),a.createElement("tbody",{className:"divide-y divide-gray-200"},x.map(h=>a.createElement("tr",{key:h.id,className:"hover:bg-gray-50"},a.createElement("td",{className:"px-6 py-4"},h.logo?a.createElement("img",{src:hN(h.logo),alt:"Logo",className:"w-12 h-12 object-contain rounded border"}):a.createElement("div",{className:"w-12 h-12 bg-gray-200 rounded flex items-center justify-center text-gray-400 text-xs"},"Sin Logo")),a.createElement("td",{className:"px-6 py-4"},a.createElement("div",null,a.createElement("div",{className:"font-medium text-gray-900"},h.nombre),a.createElement("div",{className:"text-sm text-gray-500"},h.categoria),a.createElement("div",{className:"text-sm text-gray-500"},h.direccion))),a.createElement("td",{className:"px-6 py-4"},a.createElement("div",{className:"text-sm"},a.createElement("div",null,h.email),a.createElement("div",{className:"text-gray-500"},h.telefono))),a.createElement("td",{className:"px-6 py-4"},h.web?a.createElement("a",{href:h.web.startsWith("http")?h.web:`https://${h.web}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm underline"},"🌐 Sitio Web"):a.createElement("a",{href:`/empresa/${h.id}`,target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:text-green-800 text-sm underline"},"👤 Ver Perfil")),a.createElement("td",{className:"px-6 py-4"},a.createElement("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${gN(h.estado)}`},h.estado||"Sin estado")),a.createElement("td",{className:"px-6 py-4"},a.createElement("div",{className:"flex items-center space-x-2"},a.createElement("button",{onClick:()=>c(`/admin/editar-empresa/${h.id}`),className:"text-blue-600 hover:text-blue-800 text-sm underline"},"Editar"),a.createElement("button",{onClick:()=>u(h),className:`text-sm underline ${h.estado==="activa"?"text-red-600 hover:text-red-800":"text-green-600 hover:text-green-800"}`},h.estado==="activa"?"Desactivar":"Activar"),h.estado!=="suspendida"&&a.createElement("button",{onClick:()=>d(h),className:"text-orange-600 hover:text-orange-800 text-sm underline"},"Suspender"),a.createElement("button",{onClick:()=>f(h),className:"text-red-600 hover:text-red-800 text-sm underline"},"Eliminar")))))))):a.createElement("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},x.map(h=>a.createElement("div",{key:h.id,className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow"},a.createElement("div",{className:"flex items-center gap-4 mb-3"},h.logo?a.createElement("img",{src:hN(h.logo),alt:"Logo",className:"w-16 h-16 object-contain rounded border"}):a.createElement("div",{className:"w-16 h-16 bg-gray-200 rounded flex items-center justify-center text-gray-400"},"Sin Logo"),a.createElement("div",{className:"flex-1"},a.createElement("h3",{className:"font-medium text-gray-900"},h.nombre),a.createElement("p",{className:"text-sm text-gray-500"},h.categoria),a.createElement("span",{className:`inline-block px-2 py-1 text-xs font-semibold rounded-full mt-1 ${gN(h.estado)}`},h.estado||"Sin estado"))),a.createElement("div",{className:"space-y-1 text-sm text-gray-600 mb-4"},a.createElement("p",null,"📧 ",h.email),a.createElement("p",null,"📞 ",h.telefono),a.createElement("p",null,"📍 ",h.direccion)),a.createElement("div",{className:"flex items-center justify-between"},h.web?a.createElement("a",{href:h.web.startsWith("http")?h.web:`https://${h.web}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm underline"},"🌐 Web"):a.createElement("a",{href:`/empresa/${h.id}`,target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:text-green-800 text-sm underline"},"👤 Perfil"),a.createElement("button",{onClick:()=>c(`/admin/editar-empresa/${h.id}`),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700"},"Editar"))))),x.length===0&&a.createElement("div",{className:"text-center py-8"},a.createElement("p",{className:"text-gray-500"},"No hay empresas que coincidan con los filtros"))))}const mh=[{value:"",label:"Todos los estados",color:"gray"},{value:"pendiente",label:"Pendiente",color:"yellow"},{value:"en_revision",label:"En Revisión",color:"blue"},{value:"activada",label:"Activada (Visible en Home)",color:"green"},{value:"credenciales_asignadas",label:"Credenciales Asignadas",color:"purple"},{value:"rechazada",label:"Rechazada",color:"red"}];function n7(){const{user:t}=Qe(),[e,n]=p.useState([]),[r,s]=p.useState(!0),[i,o]=p.useState({estado:"",busqueda:"",fechaDesde:"",fechaHasta:""}),[l,c]=p.useState(null),[u,d]=p.useState(!1),[f,g]=p.useState(!1),[v,x]=p.useState(!1),[E,y]=p.useState(!1),[h,C]=p.useState(!1),[T,k]=p.useState({email:"",password:"",confirmPassword:""});p.useEffect(()=>{S(),_()},[]);const _=async()=>{try{const F=pe(Q($,"agentes"),fe("email","==",t==null?void 0:t.email)),U=await ue(F);y(!U.empty)}catch(F){console.error("Error verificando rol:",F)}};p.useEffect(()=>{S()},[]);const S=async()=>{try{s(!0);const F=pe(Q($,"solicitudes_empresa"),Et("fecha_solicitud","desc")),D=(await ue(F)).docs.map(j=>({id:j.id,...j.data()}));n(D)}catch(F){console.error("Error cargando solicitudes:",F)}finally{s(!1)}},N=e.filter(F=>{var j,V,z;const U=!i.estado||F.estado===i.estado,D=!i.busqueda||((j=F.nombre_empresa)==null?void 0:j.toLowerCase().includes(i.busqueda.toLowerCase()))||((V=F.email_empresa)==null?void 0:V.toLowerCase().includes(i.busqueda.toLowerCase()))||((z=F.representante_nombre)==null?void 0:z.toLowerCase().includes(i.busqueda.toLowerCase()));return U&&D}),b=async(F,U,D="")=>{try{x(!0),await Me(we($,"solicitudes_empresa",F),{estado:U,fecha_ultima_actualizacion:new Date,comentario_admin:D,admin_responsable:t==null?void 0:t.email}),U==="activada"&&await w(F),await S(),d(!1),c(null)}catch(j){console.error("Error actualizando solicitud:",j),alert("Error al actualizar la solicitud")}finally{x(!1)}},w=async F=>{const U=e.find(D=>D.id===F);if(U)try{const D={nombre:U.nombre_empresa,email:U.email_empresa,telefono:U.telefono_empresa,direccion:U.direccion_empresa,comuna:U.comuna,region:U.region,rut:U.rut_empresa,web:U.web_actual||"",representante:{nombre:U.representante_nombre,apellidos:U.representante_apellidos,cargo:U.cargo_representante,email:U.email_representante,telefono:U.telefono_representante},estado:"activa",etapa_proceso:"activada_sin_credenciales",categoria:U.categoria||"Sin categoría",fecha_registro:new Date,fecha_activacion:new Date,admin_activador:t==null?void 0:t.email,solicitud_origen_id:F,logoAsignado:!1,webValidada:!!U.web_actual,perfilCompleto:!1,tiene_credenciales_asignadas:!1,usuario_empresa:null,horarios:{lunes:{activo:!0,inicio:"09:00",fin:"18:00"},martes:{activo:!0,inicio:"09:00",fin:"18:00"},miercoles:{activo:!0,inicio:"09:00",fin:"18:00"},jueves:{activo:!0,inicio:"09:00",fin:"18:00"},viernes:{activo:!0,inicio:"09:00",fin:"18:00"},sabado:{activo:!1,inicio:"09:00",fin:"13:00"},domingo:{activo:!1,inicio:"10:00",fin:"14:00"}}};await ze(Q($,"empresas"),D),console.log("Empresa activada y visible en home (primera etapa completada)")}catch(D){throw console.error("Error creando empresa:",D),D}},A=async F=>{if(!T.email||!T.password){alert("Todos los campos son obligatorios");return}if(T.password!==T.confirmPassword){alert("Las contraseñas no coinciden");return}try{x(!0),await Me(we($,"solicitudes_empresa",F),{estado:"credenciales_asignadas",fecha_credenciales_asignadas:new Date,admin_credenciales:t==null?void 0:t.email,usuario_asignado:{email:T.email,fecha_asignacion:new Date}});const U=Q($,"empresas"),D=pe(U,fe("solicitud_origen_id","==",F)),j=await ue(D);if(!j.empty){const V=j.docs[0];await Me(V.ref,{etapa_proceso:"credenciales_asignadas",tiene_credenciales_asignadas:!0,usuario_empresa:{email:T.email,fecha_asignacion:new Date,admin_asignador:t==null?void 0:t.email},fecha_credenciales_asignadas:new Date})}alert("Credenciales asignadas exitosamente. La empresa ya puede gestionar su información."),await S(),C(!1),k({email:"",password:"",confirmPassword:""}),c(null)}catch(U){console.error("Error asignando credenciales:",U),alert("Error al asignar credenciales")}finally{x(!1)}},R=()=>{const F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#$%";let U="";for(let D=0;D<12;D++)U+=F.charAt(Math.floor(Math.random()*F.length));k(D=>({...D,password:U,confirmPassword:U}))},L=F=>{const U=mh.find(D=>D.value===F);return(U==null?void 0:U.color)||"gray"},M={total:e.length,pendientes:e.filter(F=>F.estado==="pendiente").length,en_revision:e.filter(F=>F.estado==="en_revision").length,activadas:e.filter(F=>F.estado==="activada").length,credenciales_asignadas:e.filter(F=>F.estado==="credenciales_asignadas").length,rechazadas:e.filter(F=>F.estado==="rechazada").length};return r?a.createElement("div",{className:"flex items-center justify-center p-8"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.createElement("p",{className:"text-gray-600"},"Cargando solicitudes..."))):a.createElement("div",{className:"p-6"},a.createElement("div",{className:"mb-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Solicitudes de Registro"),a.createElement("p",{className:"text-gray-600 mb-3"},"Gestiona las solicitudes de registro de nuevas empresas y proveedores en un flujo de dos etapas:"),a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},a.createElement("div",null,a.createElement("h4",{className:"font-medium text-blue-900 mb-2"},"🎯 Primera Etapa: Activación"),a.createElement("p",{className:"text-blue-700"},"Revisar y activar la solicitud para que la empresa sea visible en el home y los usuarios puedan encontrarla.")),a.createElement("div",null,a.createElement("h4",{className:"font-medium text-purple-900 mb-2"},"🔑 Segunda Etapa: Credenciales"),a.createElement("p",{className:"text-purple-700"},"Asignar email y contraseña para que la empresa pueda acceder a su panel y gestionar su información."))))),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6"},a.createElement("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center"},a.createElement("div",{className:"text-2xl font-bold text-gray-800"},M.total),a.createElement("div",{className:"text-gray-600 text-sm"},"Total")),a.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center"},a.createElement("div",{className:"text-2xl font-bold text-yellow-800"},M.pendientes),a.createElement("div",{className:"text-yellow-600 text-sm"},"Pendientes")),a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center"},a.createElement("div",{className:"text-2xl font-bold text-blue-800"},M.en_revision),a.createElement("div",{className:"text-blue-600 text-sm"},"En Revisión")),a.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center"},a.createElement("div",{className:"text-2xl font-bold text-green-800"},M.activadas),a.createElement("div",{className:"text-green-600 text-sm"},"Activadas")),a.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 text-center"},a.createElement("div",{className:"text-2xl font-bold text-purple-800"},M.credenciales_asignadas),a.createElement("div",{className:"text-purple-600 text-sm"},"Con Credenciales")),a.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center"},a.createElement("div",{className:"text-2xl font-bold text-red-800"},M.rechazadas),a.createElement("div",{className:"text-red-600 text-sm"},"Rechazadas"))),a.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Estado"),a.createElement("select",{value:i.estado,onChange:F=>o(U=>({...U,estado:F.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},mh.map(F=>a.createElement("option",{key:F.value,value:F.value},F.label)))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Buscar"),a.createElement("input",{type:"text",value:i.busqueda,onChange:F=>o(U=>({...U,busqueda:F.target.value})),placeholder:"Nombre empresa, email, representante...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",{className:"flex items-end"},a.createElement("button",{onClick:()=>o({estado:"",busqueda:"",fechaDesde:"",fechaHasta:""}),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors"},"Limpiar Filtros")))),E&&a.createElement("div",{className:"mb-6"},a.createElement("button",{onClick:()=>g(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"},"➕ Crear Nueva Solicitud (Agente de Campo)")),a.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},a.createElement("div",{className:"overflow-x-auto"},a.createElement("table",{className:"min-w-full"},a.createElement("thead",{className:"bg-gray-50"},a.createElement("tr",null,a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Empresa"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Representante"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Fecha"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),a.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},N.map(F=>{var U,D,j,V;return a.createElement("tr",{key:F.id,className:"hover:bg-gray-50"},a.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},a.createElement("div",null,a.createElement("div",{className:"text-sm font-medium text-gray-900"},F.nombre_empresa),a.createElement("div",{className:"text-sm text-gray-500"},F.email_empresa),F.web_actual&&a.createElement("div",{className:"text-sm text-blue-600"},"🌐 ",F.web_actual))),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},a.createElement("div",{className:"text-sm text-gray-900"},F.representante_nombre," ",F.representante_apellidos),a.createElement("div",{className:"text-sm text-gray-500"},F.cargo_representante),a.createElement("div",{className:"text-sm text-gray-500"},"📞 ",F.telefono_representante)),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},a.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full
                      ${L(F.estado)==="yellow"?"bg-yellow-100 text-yellow-800":""}
                      ${L(F.estado)==="blue"?"bg-blue-100 text-blue-800":""}
                      ${L(F.estado)==="green"?"bg-green-100 text-green-800":""}
                      ${L(F.estado)==="red"?"bg-red-100 text-red-800":""}
                      ${L(F.estado)==="gray"?"bg-gray-100 text-gray-800":""}
                    `},((U=mh.find(z=>z.value===F.estado))==null?void 0:U.label)||F.estado)),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},((V=(j=(D=F.fecha_solicitud)==null?void 0:D.toDate)==null?void 0:j.call(D))==null?void 0:V.toLocaleDateString())||"N/A"),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm space-x-2"},a.createElement("button",{onClick:()=>{c(F),d(!0)},className:"text-blue-600 hover:text-blue-800 underline"},"Ver Detalles")))})))),N.length===0&&a.createElement("div",{className:"text-center py-8"},a.createElement("p",{className:"text-gray-500"},"No hay solicitudes que coincidan con los filtros"))),u&&l&&a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-96 overflow-y-auto"},a.createElement("div",{className:"flex justify-between items-center mb-4"},a.createElement("h3",{className:"text-lg font-semibold"},"Detalles de Solicitud: ",l.nombre_empresa),a.createElement("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600"},"✕")),a.createElement("div",{className:"space-y-4 mb-6"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Información de la Empresa"),a.createElement("div",{className:"space-y-1 text-sm"},a.createElement("p",null,a.createElement("strong",null,"RUT:")," ",l.rut_empresa),a.createElement("p",null,a.createElement("strong",null,"Dirección:")," ",l.direccion_empresa),a.createElement("p",null,a.createElement("strong",null,"Comuna:")," ",l.comuna),a.createElement("p",null,a.createElement("strong",null,"Región:")," ",l.region),a.createElement("p",null,a.createElement("strong",null,"Teléfono:")," ",l.telefono_empresa))),a.createElement("div",null,a.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Representante Legal"),a.createElement("div",{className:"space-y-1 text-sm"},a.createElement("p",null,a.createElement("strong",null,"Nombre:")," ",l.representante_nombre," ",l.representante_apellidos),a.createElement("p",null,a.createElement("strong",null,"Cargo:")," ",l.cargo_representante),a.createElement("p",null,a.createElement("strong",null,"Email:")," ",l.email_representante),a.createElement("p",null,a.createElement("strong",null,"Teléfono:")," ",l.telefono_representante)))),l.comentario_admin&&a.createElement("div",null,a.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Comentarios del Administrador"),a.createElement("p",{className:"text-sm text-gray-700 bg-gray-50 p-3 rounded"},l.comentario_admin))),a.createElement("div",{className:"flex justify-end space-x-3"},l.estado==="pendiente"&&a.createElement(a.Fragment,null,a.createElement("button",{onClick:()=>b(l.id,"en_revision"),disabled:v,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"},"Pasar a Revisión"),a.createElement("button",{onClick:()=>b(l.id,"rechazada"),disabled:v,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50"},"Rechazar")),l.estado==="en_revision"&&a.createElement(a.Fragment,null,a.createElement("button",{onClick:()=>b(l.id,"activada"),disabled:v,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50"},"🎯 Activar Empresa (Visible en Home)"),a.createElement("button",{onClick:()=>b(l.id,"rechazada"),disabled:v,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50"},"Rechazar")),l.estado==="activada"&&a.createElement("div",{className:"flex flex-col space-y-2"},a.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 mb-3"},a.createElement("p",{className:"text-green-800 text-sm font-medium"},"✅ Empresa activada y visible en el home"),a.createElement("p",{className:"text-green-600 text-xs"},"Siguiente paso: Asignar credenciales para que la empresa pueda gestionar su información")),a.createElement("button",{onClick:()=>{d(!1),C(!0)},disabled:v,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:opacity-50"},"🔑 Asignar Credenciales de Acceso")),l.estado==="credenciales_asignadas"&&a.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3"},a.createElement("p",{className:"text-purple-800 text-sm font-medium"},"🎉 Proceso completado exitosamente"),a.createElement("p",{className:"text-purple-600 text-xs"},"La empresa está visible en el home y tiene credenciales para gestionar su información"),l.usuario_asignado&&a.createElement("p",{className:"text-purple-700 text-xs mt-1"},"Usuario asignado: ",l.usuario_asignado.email)),l.estado==="rechazada"&&a.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3"},a.createElement("p",{className:"text-red-800 text-sm font-medium"},"❌ Solicitud rechazada"),a.createElement("p",{className:"text-red-600 text-xs"},"Esta solicitud ha sido rechazada y no se procesará")),E&&(l.estado==="pendiente"||l.estado==="en_revision")&&a.createElement("button",{onClick:()=>b(l.id,"activada","Activada directamente por agente de campo"),disabled:v,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:opacity-50"},"⚡ Activar Directamente (Agente)"),a.createElement("button",{onClick:()=>d(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400"},"Cerrar")))),h&&l&&a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},a.createElement("div",{className:"flex justify-between items-center mb-4"},a.createElement("h3",{className:"text-lg font-semibold"},"Asignar Credenciales: ",l.nombre_empresa),a.createElement("button",{onClick:()=>{C(!1),k({email:"",password:"",confirmPassword:""})},className:"text-gray-400 hover:text-gray-600"},"✕")),a.createElement("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg"},a.createElement("p",{className:"text-blue-800 text-sm"},a.createElement("strong",null,"Segunda etapa del proceso:"),a.createElement("br",null),"Asigna un email y contraseña para que la empresa pueda acceder a su panel de administración y gestionar su información, campañas, horarios, etc.")),a.createElement("div",{className:"space-y-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email de acceso"),a.createElement("input",{type:"email",value:T.email,onChange:F=>k(U=>({...U,email:F.target.value})),placeholder:"email@empresa.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"}),a.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Recomendado: usar el email del representante legal")),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña"),a.createElement("div",{className:"flex space-x-2"},a.createElement("input",{type:"text",value:T.password,onChange:F=>k(U=>({...U,password:F.target.value})),placeholder:"Contraseña",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"}),a.createElement("button",{type:"button",onClick:R,className:"px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-sm"},"🎲 Generar"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirmar contraseña"),a.createElement("input",{type:"text",value:T.confirmPassword,onChange:F=>k(U=>({...U,confirmPassword:F.target.value})),placeholder:"Confirmar contraseña",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})),T.password&&T.password!==T.confirmPassword&&a.createElement("p",{className:"text-red-600 text-sm"},"Las contraseñas no coinciden")),a.createElement("div",{className:"flex justify-end space-x-3 mt-6"},a.createElement("button",{onClick:()=>{C(!1),k({email:"",password:"",confirmPassword:""})},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",disabled:v},"Cancelar"),a.createElement("button",{onClick:()=>A(l.id),disabled:v||!T.email||!T.password||T.password!==T.confirmPassword,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:opacity-50"},v?"Asignando...":"🔑 Asignar Credenciales")))),f&&a.createElement(r7,{onClose:()=>g(!1),onSuccess:()=>{g(!1),S()},esAgente:E,agenteEmail:t==null?void 0:t.email}))}function r7({onClose:t,onSuccess:e,esAgente:n,agenteEmail:r}){const[s,i]=p.useState({nombre_empresa:"",rut_empresa:"",direccion_empresa:"",comuna:"",region:"",telefono_empresa:"",email_empresa:"",web_actual:"",categoria:"",representante_nombre:"",representante_apellidos:"",cargo_representante:"",email_representante:"",telefono_representante:"",descripcion:"",necesita_pagina_web:!1,activacion_directa:!1}),[o,l]=p.useState(!1),c=f=>{const{name:g,value:v,type:x,checked:E}=f.target;i(y=>({...y,[g]:x==="checkbox"?E:v}))},u=async f=>{if(f.preventDefault(),!s.nombre_empresa||!s.email_empresa||!s.representante_nombre){alert("Por favor, completa al menos los campos obligatorios");return}try{l(!0);const g={...s,estado:n&&s.activacion_directa?"activada":"pendiente",fecha_solicitud:new Date,fecha_ultima_actualizacion:new Date,creado_por:r,es_agente_campo:n,origen:n?"agente_campo":"web"},v=await ze(Q($,"solicitudes_empresa"),g);n&&s.activacion_directa&&await d(v.id,g),alert(n&&s.activacion_directa?"Solicitud creada y empresa activada (visible en home). Pendiente asignar credenciales.":"Solicitud creada exitosamente"),e()}catch(g){console.error("Error creando solicitud:",g),alert("Error al crear la solicitud")}finally{l(!1)}},d=async(f,g)=>{try{const v={nombre:g.nombre_empresa,email:g.email_empresa,telefono:g.telefono_empresa,direccion:g.direccion_empresa,comuna:g.comuna,region:g.region,rut:g.rut_empresa,web:g.web_actual||"",representante:{nombre:g.representante_nombre,apellidos:g.representante_apellidos,cargo:g.cargo_representante,email:g.email_representante,telefono:g.telefono_representante},estado:"activa",etapa_proceso:"activada_sin_credenciales",categoria:g.categoria||"Sin categoría",fecha_registro:new Date,fecha_activacion:new Date,admin_activador:r,solicitud_origen_id:f,logoAsignado:!1,webValidada:!!g.web_actual,perfilCompleto:!1,tiene_credenciales_asignadas:!1,usuario_empresa:null,horarios:{lunes:{activo:!0,inicio:"09:00",fin:"18:00"},martes:{activo:!0,inicio:"09:00",fin:"18:00"},miercoles:{activo:!0,inicio:"09:00",fin:"18:00"},jueves:{activo:!0,inicio:"09:00",fin:"18:00"},viernes:{activo:!0,inicio:"09:00",fin:"18:00"},sabado:{activo:!1,inicio:"09:00",fin:"13:00"},domingo:{activo:!1,inicio:"10:00",fin:"14:00"}}};await ze(Q($,"empresas"),v),console.log("Empresa activada directamente por agente (primera etapa completada)")}catch(v){throw console.error("Error creando empresa desde activación directa:",v),v}};return a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},a.createElement("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-96 overflow-y-auto"},a.createElement("div",{className:"p-6"},a.createElement("div",{className:"flex justify-between items-center mb-6"},a.createElement("h3",{className:"text-xl font-semibold"},n?"Nueva Solicitud - Agente de Campo":"Nueva Solicitud de Empresa"),a.createElement("button",{onClick:t,className:"text-gray-400 hover:text-gray-600"},"✕")),a.createElement("form",{onSubmit:u,className:"space-y-6"},a.createElement("div",null,a.createElement("h4",{className:"text-lg font-medium text-gray-900 mb-4"},"Información de la Empresa"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombre de la empresa *"),a.createElement("input",{type:"text",name:"nombre_empresa",value:s.nombre_empresa,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"RUT de la empresa"),a.createElement("input",{type:"text",name:"rut_empresa",value:s.rut_empresa,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"12.345.678-9"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email de la empresa *"),a.createElement("input",{type:"email",name:"email_empresa",value:s.email_empresa,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono"),a.createElement("input",{type:"tel",name:"telefono_empresa",value:s.telefono_empresa,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Dirección"),a.createElement("input",{type:"text",name:"direccion_empresa",value:s.direccion_empresa,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Comuna"),a.createElement("input",{type:"text",name:"comuna",value:s.comuna,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Sitio web actual"),a.createElement("input",{type:"url",name:"web_actual",value:s.web_actual,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://ejemplo.com"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Categoría"),a.createElement("select",{name:"categoria",value:s.categoria,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},a.createElement("option",{value:""},"Seleccionar categoría"),a.createElement("option",{value:"Repuestos"},"Repuestos"),a.createElement("option",{value:"Servicios"},"Servicios"),a.createElement("option",{value:"Talleres"},"Talleres"),a.createElement("option",{value:"Seguros"},"Seguros"),a.createElement("option",{value:"Venta de Vehículos"},"Venta de Vehículos"),a.createElement("option",{value:"Otros"},"Otros"))))),a.createElement("div",null,a.createElement("h4",{className:"text-lg font-medium text-gray-900 mb-4"},"Representante Legal"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombres *"),a.createElement("input",{type:"text",name:"representante_nombre",value:s.representante_nombre,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Apellidos"),a.createElement("input",{type:"text",name:"representante_apellidos",value:s.representante_apellidos,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Cargo"),a.createElement("input",{type:"text",name:"cargo_representante",value:s.cargo_representante,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Gerente General, Propietario"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email del representante"),a.createElement("input",{type:"email",name:"email_representante",value:s.email_representante,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Descripción de la empresa"),a.createElement("textarea",{name:"descripcion",value:s.descripcion,onChange:c,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe brevemente la actividad de la empresa..."})),n&&a.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4"},a.createElement("h4",{className:"text-lg font-medium text-purple-900 mb-3"},"Opciones de Agente de Campo"),a.createElement("div",{className:"space-y-2"},a.createElement("div",{className:"flex items-center"},a.createElement("input",{type:"checkbox",id:"activacion_directa",name:"activacion_directa",checked:s.activacion_directa,onChange:c,className:"rounded"}),a.createElement("label",{htmlFor:"activacion_directa",className:"ml-2 text-sm text-purple-800"},a.createElement("strong",null,"Activar empresa inmediatamente")," (para empresas validadas en terreno)")),a.createElement("p",{className:"text-xs text-purple-700"},"⚠️ Solo marca esta opción si has verificado personalmente la empresa y sus datos"))),a.createElement("div",{className:"flex justify-end space-x-3 pt-4 border-t"},a.createElement("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",disabled:o},"Cancelar"),a.createElement("button",{type:"submit",disabled:o,className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"},o?"Creando...":s.activacion_directa?"Crear y Activar":"Crear Solicitud"))))))}const a7=()=>{const{rol:t}=Qe(),[e,n]=p.useState([]),[r,s]=p.useState("todos"),[i,o]=p.useState(!1),[l,c]=p.useState({}),u={proveedor:{nombre:"Proveedor",color:"blue",descripcion:"Empresa proveedora estándar",icon:"🏪"},local:{nombre:"Local",color:"green",descripcion:"Negocio local de la zona",icon:"🏪"},pyme:{nombre:"PyME",color:"yellow",descripcion:"Pequeña y Mediana Empresa",icon:"🏢"},emprendimiento:{nombre:"Emprendimiento",color:"purple",descripcion:"Nuevo emprendimiento",icon:"🚀"},premium:{nombre:"Premium",color:"orange",descripcion:"Proveedor premium verificado",icon:"⭐"}};p.useEffect(()=>{const x=Dt(pe(Q($,"empresas"),fe("estado","==","Activa")),E=>{const y=E.docs.map(h=>({id:h.id,...h.data()}));n(y),d(y)});return()=>x()},[]);const d=x=>{const E={};Object.keys(u).forEach(y=>{E[y]=x.filter(h=>h.tipoEmpresa===y||y==="local"&&h.esLocal||y==="pyme"&&h.esPyme||y==="emprendimiento"&&h.esEmprendimiento||y==="premium"&&h.esPremium).length}),E.total=x.length,E.sinTipo=x.filter(y=>!y.tipoEmpresa).length,c(E)},f=async(x,E)=>{try{o(!0);const y={tipoEmpresa:E,fechaActualizacion:new Date};switch(y.esLocal=!1,y.esPyme=!1,y.esEmprendimiento=!1,y.esPremium=!1,E){case"local":y.esLocal=!0;break;case"pyme":y.esPyme=!0;break;case"emprendimiento":y.esEmprendimiento=!0;break;case"premium":y.esPremium=!0;break}await Me(we($,"empresas",x),y)}catch(y){console.error("Error actualizando tipo de empresa:",y),alert("Error al actualizar el tipo de empresa")}finally{o(!1)}},g=e.filter(x=>r==="todos"?!0:r==="sinTipo"?!x.tipoEmpresa:x.tipoEmpresa===r||r==="local"&&x.esLocal||r==="pyme"&&x.esPyme||r==="emprendimiento"&&x.esEmprendimiento||r==="premium"&&x.esPremium),v=x=>({proveedor:"bg-blue-100 text-blue-800",local:"bg-green-100 text-green-800",pyme:"bg-yellow-100 text-yellow-800",emprendimiento:"bg-purple-100 text-purple-800",premium:"bg-orange-100 text-orange-800"})[x]||"bg-gray-100 text-gray-800";return t!=="admin"?a.createElement("div",{className:"text-center p-8"},a.createElement("p",{className:"text-red-600"},"Solo administradores pueden gestionar tipos de empresa")):a.createElement("div",{className:"max-w-7xl mx-auto p-6"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg"},a.createElement("div",{className:"p-6 border-b"},a.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"🏢 Gestión de Tipos de Empresa"),a.createElement("p",{className:"text-gray-600 mt-2"},"Administra y categoriza las empresas según su tipo")),a.createElement("div",{className:"p-6 border-b"},a.createElement("h2",{className:"text-lg font-semibold mb-4"},"📊 Estadísticas"),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4"},a.createElement("div",{className:"bg-gray-50 p-4 rounded-lg text-center"},a.createElement("div",{className:"text-2xl font-bold text-gray-700"},l.total),a.createElement("div",{className:"text-sm text-gray-600"},"Total")),Object.entries(u).map(([x,E])=>a.createElement("div",{key:x,className:"bg-gray-50 p-4 rounded-lg text-center"},a.createElement("div",{className:"text-xl mb-1"},E.icon),a.createElement("div",{className:"text-2xl font-bold text-gray-700"},l[x]||0),a.createElement("div",{className:"text-sm text-gray-600"},E.nombre))),a.createElement("div",{className:"bg-red-50 p-4 rounded-lg text-center"},a.createElement("div",{className:"text-2xl font-bold text-red-600"},l.sinTipo||0),a.createElement("div",{className:"text-sm text-red-600"},"Sin Tipo")))),a.createElement("div",{className:"p-6 border-b"},a.createElement("h2",{className:"text-lg font-semibold mb-4"},"🔍 Filtros"),a.createElement("div",{className:"flex flex-wrap gap-2"},a.createElement("button",{onClick:()=>s("todos"),className:`px-4 py-2 rounded text-sm font-medium ${r==="todos"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Todas (",l.total,")"),Object.entries(u).map(([x,E])=>a.createElement("button",{key:x,onClick:()=>s(x),className:`px-4 py-2 rounded text-sm font-medium ${r===x?`bg-${E.color}-600 text-white`:`bg-${E.color}-100 text-${E.color}-700 hover:bg-${E.color}-200`}`},E.icon," ",E.nombre," (",l[x]||0,")")),a.createElement("button",{onClick:()=>s("sinTipo"),className:`px-4 py-2 rounded text-sm font-medium ${r==="sinTipo"?"bg-red-600 text-white":"bg-red-100 text-red-700 hover:bg-red-200"}`},"Sin Tipo (",l.sinTipo||0,")"))),a.createElement("div",{className:"p-6"},a.createElement("h2",{className:"text-lg font-semibold mb-4"},"📋 Empresas Filtradas (",g.length,")"),a.createElement("div",{className:"space-y-4"},g.map(x=>{var E,y;return a.createElement("div",{key:x.id,className:"border border-gray-200 rounded-lg p-4"},a.createElement("div",{className:"flex justify-between items-start"},a.createElement("div",{className:"flex-1"},a.createElement("div",{className:"flex items-center space-x-3 mb-2"},a.createElement("h3",{className:"text-lg font-semibold text-gray-900"},x.nombre),x.tipoEmpresa&&a.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${v(x.tipoEmpresa)}`},(E=u[x.tipoEmpresa])==null?void 0:E.icon," ",(y=u[x.tipoEmpresa])==null?void 0:y.nombre),!x.tipoEmpresa&&a.createElement("span",{className:"px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800"},"Sin Tipo")),a.createElement("div",{className:"text-sm text-gray-600 space-y-1"},a.createElement("div",null,"📍 ",x.direccion,", ",x.ciudad),x.telefono&&a.createElement("div",null,"📞 ",x.telefono),x.email&&a.createElement("div",null,"📧 ",x.email))),a.createElement("div",{className:"ml-4"},a.createElement("select",{value:x.tipoEmpresa||"",onChange:h=>f(x.id,h.target.value),disabled:i,className:"text-sm border border-gray-300 rounded px-3 py-1 focus:ring-2 focus:ring-blue-500"},a.createElement("option",{value:""},"Seleccionar tipo"),Object.entries(u).map(([h,C])=>a.createElement("option",{key:h,value:h},C.icon," ",C.nombre))))))}),g.length===0&&a.createElement("div",{className:"text-center py-8"},a.createElement("p",{className:"text-gray-500"},"No hay empresas que coincidan con el filtro seleccionado"))))))};var jT={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(_N,function(){var n=1e3,r=6e4,s=36e5,i="millisecond",o="second",l="minute",c="hour",u="day",d="week",f="month",g="quarter",v="year",x="date",E="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,h=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,C={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(F){var U=["th","st","nd","rd"],D=F%100;return"["+F+(U[(D-20)%10]||U[D]||U[0])+"]"}},T=function(F,U,D){var j=String(F);return!j||j.length>=U?F:""+Array(U+1-j.length).join(D)+F},k={s:T,z:function(F){var U=-F.utcOffset(),D=Math.abs(U),j=Math.floor(D/60),V=D%60;return(U<=0?"+":"-")+T(j,2,"0")+":"+T(V,2,"0")},m:function F(U,D){if(U.date()<D.date())return-F(D,U);var j=12*(D.year()-U.year())+(D.month()-U.month()),V=U.clone().add(j,f),z=D-V<0,G=U.clone().add(j+(z?-1:1),f);return+(-(j+(D-V)/(z?V-G:G-V))||0)},a:function(F){return F<0?Math.ceil(F)||0:Math.floor(F)},p:function(F){return{M:f,y:v,w:d,d:u,D:x,h:c,m:l,s:o,ms:i,Q:g}[F]||String(F||"").toLowerCase().replace(/s$/,"")},u:function(F){return F===void 0}},_="en",S={};S[_]=C;var N="$isDayjsObject",b=function(F){return F instanceof L||!(!F||!F[N])},w=function F(U,D,j){var V;if(!U)return _;if(typeof U=="string"){var z=U.toLowerCase();S[z]&&(V=z),D&&(S[z]=D,V=z);var G=U.split("-");if(!V&&G.length>1)return F(G[0])}else{var Y=U.name;S[Y]=U,V=Y}return!j&&V&&(_=V),V||!j&&_},A=function(F,U){if(b(F))return F.clone();var D=typeof U=="object"?U:{};return D.date=F,D.args=arguments,new L(D)},R=k;R.l=w,R.i=b,R.w=function(F,U){return A(F,{locale:U.$L,utc:U.$u,x:U.$x,$offset:U.$offset})};var L=function(){function F(D){this.$L=w(D.locale,null,!0),this.parse(D),this.$x=this.$x||D.x||{},this[N]=!0}var U=F.prototype;return U.parse=function(D){this.$d=function(j){var V=j.date,z=j.utc;if(V===null)return new Date(NaN);if(R.u(V))return new Date;if(V instanceof Date)return new Date(V);if(typeof V=="string"&&!/Z$/i.test(V)){var G=V.match(y);if(G){var Y=G[2]-1||0,Z=(G[7]||"0").substring(0,3);return z?new Date(Date.UTC(G[1],Y,G[3]||1,G[4]||0,G[5]||0,G[6]||0,Z)):new Date(G[1],Y,G[3]||1,G[4]||0,G[5]||0,G[6]||0,Z)}}return new Date(V)}(D),this.init()},U.init=function(){var D=this.$d;this.$y=D.getFullYear(),this.$M=D.getMonth(),this.$D=D.getDate(),this.$W=D.getDay(),this.$H=D.getHours(),this.$m=D.getMinutes(),this.$s=D.getSeconds(),this.$ms=D.getMilliseconds()},U.$utils=function(){return R},U.isValid=function(){return this.$d.toString()!==E},U.isSame=function(D,j){var V=A(D);return this.startOf(j)<=V&&V<=this.endOf(j)},U.isAfter=function(D,j){return A(D)<this.startOf(j)},U.isBefore=function(D,j){return this.endOf(j)<A(D)},U.$g=function(D,j,V){return R.u(D)?this[j]:this.set(V,D)},U.unix=function(){return Math.floor(this.valueOf()/1e3)},U.valueOf=function(){return this.$d.getTime()},U.startOf=function(D,j){var V=this,z=!!R.u(j)||j,G=R.p(D),Y=function(be,ne){var re=R.w(V.$u?Date.UTC(V.$y,ne,be):new Date(V.$y,ne,be),V);return z?re:re.endOf(u)},Z=function(be,ne){return R.w(V.toDate()[be].apply(V.toDate("s"),(z?[0,0,0,0]:[23,59,59,999]).slice(ne)),V)},H=this.$W,oe=this.$M,W=this.$D,he="set"+(this.$u?"UTC":"");switch(G){case v:return z?Y(1,0):Y(31,11);case f:return z?Y(1,oe):Y(0,oe+1);case d:var xe=this.$locale().weekStart||0,ie=(H<xe?H+7:H)-xe;return Y(z?W-ie:W+(6-ie),oe);case u:case x:return Z(he+"Hours",0);case c:return Z(he+"Minutes",1);case l:return Z(he+"Seconds",2);case o:return Z(he+"Milliseconds",3);default:return this.clone()}},U.endOf=function(D){return this.startOf(D,!1)},U.$set=function(D,j){var V,z=R.p(D),G="set"+(this.$u?"UTC":""),Y=(V={},V[u]=G+"Date",V[x]=G+"Date",V[f]=G+"Month",V[v]=G+"FullYear",V[c]=G+"Hours",V[l]=G+"Minutes",V[o]=G+"Seconds",V[i]=G+"Milliseconds",V)[z],Z=z===u?this.$D+(j-this.$W):j;if(z===f||z===v){var H=this.clone().set(x,1);H.$d[Y](Z),H.init(),this.$d=H.set(x,Math.min(this.$D,H.daysInMonth())).$d}else Y&&this.$d[Y](Z);return this.init(),this},U.set=function(D,j){return this.clone().$set(D,j)},U.get=function(D){return this[R.p(D)]()},U.add=function(D,j){var V,z=this;D=Number(D);var G=R.p(j),Y=function(oe){var W=A(z);return R.w(W.date(W.date()+Math.round(oe*D)),z)};if(G===f)return this.set(f,this.$M+D);if(G===v)return this.set(v,this.$y+D);if(G===u)return Y(1);if(G===d)return Y(7);var Z=(V={},V[l]=r,V[c]=s,V[o]=n,V)[G]||1,H=this.$d.getTime()+D*Z;return R.w(H,this)},U.subtract=function(D,j){return this.add(-1*D,j)},U.format=function(D){var j=this,V=this.$locale();if(!this.isValid())return V.invalidDate||E;var z=D||"YYYY-MM-DDTHH:mm:ssZ",G=R.z(this),Y=this.$H,Z=this.$m,H=this.$M,oe=V.weekdays,W=V.months,he=V.meridiem,xe=function(ne,re,Se,Oe){return ne&&(ne[re]||ne(j,z))||Se[re].slice(0,Oe)},ie=function(ne){return R.s(Y%12||12,ne,"0")},be=he||function(ne,re,Se){var Oe=ne<12?"AM":"PM";return Se?Oe.toLowerCase():Oe};return z.replace(h,function(ne,re){return re||function(Se){switch(Se){case"YY":return String(j.$y).slice(-2);case"YYYY":return R.s(j.$y,4,"0");case"M":return H+1;case"MM":return R.s(H+1,2,"0");case"MMM":return xe(V.monthsShort,H,W,3);case"MMMM":return xe(W,H);case"D":return j.$D;case"DD":return R.s(j.$D,2,"0");case"d":return String(j.$W);case"dd":return xe(V.weekdaysMin,j.$W,oe,2);case"ddd":return xe(V.weekdaysShort,j.$W,oe,3);case"dddd":return oe[j.$W];case"H":return String(Y);case"HH":return R.s(Y,2,"0");case"h":return ie(1);case"hh":return ie(2);case"a":return be(Y,Z,!0);case"A":return be(Y,Z,!1);case"m":return String(Z);case"mm":return R.s(Z,2,"0");case"s":return String(j.$s);case"ss":return R.s(j.$s,2,"0");case"SSS":return R.s(j.$ms,3,"0");case"Z":return G}return null}(ne)||G.replace(":","")})},U.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},U.diff=function(D,j,V){var z,G=this,Y=R.p(j),Z=A(D),H=(Z.utcOffset()-this.utcOffset())*r,oe=this-Z,W=function(){return R.m(G,Z)};switch(Y){case v:z=W()/12;break;case f:z=W();break;case g:z=W()/3;break;case d:z=(oe-H)/6048e5;break;case u:z=(oe-H)/864e5;break;case c:z=oe/s;break;case l:z=oe/r;break;case o:z=oe/n;break;default:z=oe}return V?z:R.a(z)},U.daysInMonth=function(){return this.endOf(f).$D},U.$locale=function(){return S[this.$L]},U.locale=function(D,j){if(!D)return this.$L;var V=this.clone(),z=w(D,j,!0);return z&&(V.$L=z),V},U.clone=function(){return R.w(this.$d,this)},U.toDate=function(){return new Date(this.valueOf())},U.toJSON=function(){return this.isValid()?this.toISOString():null},U.toISOString=function(){return this.$d.toISOString()},U.toString=function(){return this.$d.toUTCString()},F}(),M=L.prototype;return A.prototype=M,[["$ms",i],["$s",o],["$m",l],["$H",c],["$W",u],["$M",f],["$y",v],["$D",x]].forEach(function(F){M[F[1]]=function(U){return this.$g(U,F[0],F[1])}}),A.extend=function(F,U){return F.$i||(F(U,L,A),F.$i=!0),A},A.locale=w,A.isDayjs=b,A.unix=function(F){return A(1e3*F)},A.en=S[_],A.Ls=S,A.p={},A})})(jT);var s7=jT.exports;const ji=e0(s7);function vN(t){return t?t.startsWith("http")?t:`/images/${t}`:""}const i7=[{label:"Todas",value:"todas",color:"bg-gray-100 text-gray-700 border-gray-300"},{label:"En revisión",value:"en revisión",color:"bg-orange-200 text-orange-800 border-orange-300"},{label:"Activa",value:"activa",color:"bg-green-200 text-green-800 border-green-400"},{label:"Finalizada",value:"finalizada",color:"bg-blue-200 text-blue-800 border-blue-400"},{label:"Terminada",value:"terminada",color:"bg-gray-300 text-gray-900 border-gray-400"},{label:"Pausada",value:"pausada",color:"bg-yellow-200 text-yellow-800 border-yellow-400"}];function o7(t){if(!t)return"bg-gray-200 text-gray-700";switch((t||"").toLowerCase()){case"en revisión":case"en revision":return"bg-orange-200 text-orange-800";case"activa":return"bg-green-200 text-green-800";case"finalizada":return"bg-blue-200 text-blue-800";case"terminada":return"bg-gray-300 text-gray-900";case"pausada":return"bg-yellow-200 text-yellow-800";case"cancelada":return"bg-red-200 text-red-800";default:return"bg-gray-200 text-gray-700"}}function l7(){const[t,e]=p.useState([]),[n,r]=p.useState("todas"),s=ft();p.useEffect(()=>{const l=Dt(Q($,"campanas"),async c=>{const u=ji(),d=[],f=c.docs.map(g=>{const v=g.data(),x=v.fechaInicio?ji(v.fechaInicio.toDate?v.fechaInicio.toDate():v.fechaInicio):null,E=v.fechaFin?ji(v.fechaFin.toDate?v.fechaFin.toDate():v.fechaFin):null;let y="-";x&&E&&(y=E.diff(x,"day")+1);let h=v.estado;return E&&u.isAfter(E,"day")&&h!=="Terminada"&&(h="Terminada",d.push(Me(we($,"campanas",g.id),{estado:h}))),{id:g.id,...v,fechaInicio:x,fechaFin:E,dias:y,estado:h}});d.length>0&&await Promise.allSettled(d),e(f)});return()=>l()},[]);function i(l){return l?ji(l).format("YYYY-MM-DD"):"-"}const o=t.filter(l=>n==="todas"?!0:(l.estado||"").toLowerCase()===n).sort((l,c)=>(l.estado||"").toLowerCase()==="activa"&&(c.estado||"").toLowerCase()!=="activa"?-1:(c.estado||"").toLowerCase()==="activa"&&(l.estado||"").toLowerCase()!=="activa"?1:l.fechaInicio&&c.fechaInicio?ji(c.fechaInicio).unix()-ji(l.fechaInicio).unix():0);return a.createElement("div",{className:"p-4"},a.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2"},a.createElement("h2",{className:"text-xl font-bold"},"Listado de Campañas"),a.createElement("button",{className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm",onClick:()=>s("/admin/campañas/nueva")},"Nueva Campaña")),a.createElement("div",{className:"flex gap-2 mb-4"},i7.map(l=>a.createElement("button",{key:l.value,onClick:()=>r(l.value),className:`
              px-3 py-1 rounded-full text-sm font-semibold border transition
              ${n===l.value?`${l.color} border-2`:`${l.color.replace("bg-","bg-opacity-50 bg-")} border`}
            `,style:n===l.value?{boxShadow:"0 0 0 2px #2563eb33"}:{}},l.label))),a.createElement("div",{className:"overflow-x-auto"},a.createElement("table",{className:"min-w-full border"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",{className:"border px-2 py-1"},"#"),a.createElement("th",{className:"border px-2 py-1"},"Título"),a.createElement("th",{className:"border px-2 py-1"},"Imagen"),a.createElement("th",{className:"border px-2 py-1"},"Logo"),a.createElement("th",{className:"border px-2 py-1"},"Nombre"),a.createElement("th",{className:"border px-2 py-1"},"Estado"),a.createElement("th",{className:"border px-2 py-1"},"Email proveedor"),a.createElement("th",{className:"border px-2 py-1"},"Fecha Ini"),a.createElement("th",{className:"border px-2 py-1"},"Fecha Fin"),a.createElement("th",{className:"border px-2 py-1"},"Días"),a.createElement("th",{className:"border px-2 py-1"},"Acciones"))),a.createElement("tbody",null,o.map((l,c)=>a.createElement("tr",{key:l.id},a.createElement("td",{className:"border px-2 py-1 text-center"},c+1),a.createElement("td",{className:"border px-2 py-1"},l.titulo??"-"),a.createElement("td",{className:"border px-2 py-1 text-center"},l.imagenURL?a.createElement("img",{src:vN(l.imagenURL),alt:"Imagen",className:"w-20 h-10 object-contain mx-auto border rounded bg-white"}):a.createElement("span",{className:"text-gray-400"},"-")),a.createElement("td",{className:"border px-2 py-1 text-center"},l.logoURL?a.createElement("img",{src:vN(l.logoURL),alt:"Logo",className:"w-10 h-10 object-contain mx-auto border rounded bg-white"}):a.createElement("span",{className:"text-gray-400"},"-")),a.createElement("td",{className:"border px-2 py-1"},l.nombre??"-"),a.createElement("td",{className:"border px-2 py-1"},a.createElement("span",{className:"px-2 py-1 rounded-full text-xs font-semibold "+o7(l.estado)},l.estado||"-")),a.createElement("td",{className:"border px-2 py-1"},l.email??"-"),a.createElement("td",{className:"border px-2 py-1"},i(l.fechaInicio)),a.createElement("td",{className:"border px-2 py-1"},i(l.fechaFin)),a.createElement("td",{className:"border px-2 py-1 text-center"},l.dias),a.createElement("td",{className:"border px-2 py-1"},a.createElement("button",{className:"bg-yellow-400 hover:bg-yellow-500 text-xs px-2 py-1 rounded",onClick:()=>s(`/admin/campañas/${l.id}/editar-campaña`)},"Editar")))),o.length===0&&a.createElement("tr",null,a.createElement("td",{colSpan:11,className:"text-center text-gray-500 py-4"},"No hay resultados."))))))}function c7(t){return t?t.startsWith("http")?t:`/images/${t}`:""}function u7(t){if(!t)return"bg-gray-200 text-gray-700";switch(t.toLowerCase()){case"activo":return"bg-green-200 text-green-800";case"inactivo":return"bg-red-200 text-red-800";case"pendiente":return"bg-yellow-200 text-yellow-800";case"agotado":return"bg-orange-200 text-orange-800";default:return"bg-gray-200 text-gray-700"}}function d7(){const[t,e]=p.useState([]),n=ft();return p.useEffect(()=>{const r=Dt(Q($,"productos"),s=>{e(s.docs.map(i=>({id:i.id,...i.data()})))});return()=>r()},[]),a.createElement("div",{className:"p-4"},a.createElement("div",{className:"flex justify-between items-center mb-4"},a.createElement("h2",{className:"text-xl font-bold"},"Listado de Productos"),a.createElement("button",{className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded shadow",onClick:()=>n("/admin/nuevo-producto")},"Ingresar producto")),a.createElement("table",{className:"min-w-full border"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",{className:"border px-2 py-1"},"Imagen"),a.createElement("th",{className:"border px-2 py-1"},"Título"),a.createElement("th",{className:"border px-2 py-1"},"Categoría"),a.createElement("th",{className:"border px-2 py-1"},"Precio"),a.createElement("th",{className:"border px-2 py-1"},"Estado"),a.createElement("th",{className:"border px-2 py-1"},"Acciones"))),a.createElement("tbody",null,t.map(r=>a.createElement("tr",{key:r.id},a.createElement("td",{className:"border px-2 py-1 text-center"},r.imagenURL?a.createElement("img",{src:c7(r.imagenURL),alt:"Imagen",className:"w-16 h-12 object-contain mx-auto border rounded bg-white"}):a.createElement("span",{className:"text-gray-400"},"-")),a.createElement("td",{className:"border px-2 py-1"},r.titulo??"-"),a.createElement("td",{className:"border px-2 py-1"},Array.isArray(r.categorias)?r.categorias.join(", "):r.categoria??"-"),a.createElement("td",{className:"border px-2 py-1"},r.precio!==void 0?`$${r.precio}`:"-"),a.createElement("td",{className:"border px-2 py-1"},a.createElement("span",{className:"px-2 py-1 rounded-full text-xs font-semibold "+u7(r.estado)},r.estado||"-")),a.createElement("td",{className:"border px-2 py-1"},a.createElement("button",{className:"bg-yellow-400 hover:bg-yellow-500 text-xs px-2 py-1 rounded",onClick:()=>n(`/admin/editar-producto/${r.id}`)},"Editar")))))))}class m7{static async createClientUser(e){try{const{nombres:n,apellidos:r,email:s,password_hash:i,telefono:o,direccion:l,comuna:c,region:u,rut:d,fecha_nacimiento:f,genero:g}=e,v=atob(i),E=(await Pm(Fn,s,v)).user,y={uid:E.uid,email:E.email,nombres:n,apellidos:r,telefono:o,direccion:l,comuna:c,region:u,rut:d,fecha_nacimiento:f?new Date(f):null,genero:g||"",userId:E.uid,fecha_registro:new Date,fechaRegistro:new Date,estado:"pendiente_validacion",tipo_usuario:"cliente",fecha_activacion:new Date,notificaciones_email:!0,notificaciones_push:!0,acepta_promociones:!0,vehiculos:[],total_solicitudes:0,total_servicios_completados:0,calificacion_promedio:null,creado_desde_solicitud:!0,solicitud_original_id:e.id||null,ip_registro:e.ip_registro||null,user_agent:e.user_agent||null},h=await ze(Q($,"perfiles_clientes"),y);return{success:!0,user:E,profileId:h.id,uid:E.uid,email:E.email}}catch(n){console.error("Error creating client user:",n);let r="Error al crear el usuario";return n.code==="auth/email-already-in-use"?r="El email ya está registrado en el sistema":n.code==="auth/weak-password"?r="La contraseña es muy débil":n.code==="auth/invalid-email"&&(r="El email no es válido"),{success:!1,error:r,code:n.code}}}static async createProviderUser(e){try{const{nombres_representante:n,apellidos_representante:r,email_empresa:s,password_hash:i,nombre_empresa:o,rut_empresa:l,telefono_empresa:c,direccion_empresa:u,comuna:d,region:f,categorias_servicios:g,marcas_vehiculos:v,descripcion_negocio:x,horario_atencion:E}=e,y=atob(i),C=(await Pm(Fn,s,y)).user,T={uid:C.uid,email:C.email,nombre:o,rut:l,telefono:c,direccion:u,comuna:d,region:f,descripcion:x,horario_atencion:E,representante:{nombres:n,apellidos:r,email:e.email_representante||s,telefono:e.telefono_representante||c,cargo:e.cargo_representante||"Propietario"},categorias:g||[],marcas_atendidas:v||[],fecha_registro:new Date,estado_validacion:"activo",tipo_usuario:"proveedor",fecha_activacion:new Date,verificado:!0,acepta_notificaciones:e.acepta_notificaciones!==!1,visible_en_busqueda:!0,acepta_servicios_emergencia:!1,total_servicios_completados:0,calificacion_promedio:null,total_clientes_atendidos:0,creado_desde_solicitud:!0,solicitud_original_id:e.id||null,ip_registro:e.ip_registro||null,user_agent:e.user_agent||null},k=await ze(Q($,"empresas"),T);return{success:!0,user:C,profileId:k.id,uid:C.uid,email:C.email}}catch(n){console.error("Error creating provider user:",n);let r="Error al crear el usuario proveedor";return n.code==="auth/email-already-in-use"?r="El email ya está registrado en el sistema":n.code==="auth/weak-password"?r="La contraseña es muy débil":n.code==="auth/invalid-email"&&(r="El email no es válido"),{success:!1,error:r,code:n.code}}}static async checkEmailExists(e){try{return(await fetchSignInMethodsForEmail(Fn,e)).length>0}catch(n){return console.error("Error checking email:",n),!1}}}function p7(){var E;const{user:t}=Qe(),[e,n]=p.useState([]),[r,s]=p.useState(!0),[i,o]=p.useState("all"),[l,c]=p.useState(null),[u,d]=p.useState(!1);p.useEffect(()=>{f()},[]);const f=async()=>{try{const y=pe(Q($,"solicitudes_cliente"),Et("fecha_solicitud","desc")),C=(await ue(y)).docs.map(T=>({id:T.id,...T.data()}));n(C)}catch(y){console.error("Error loading requests:",y)}finally{s(!1)}},g=async(y,h,C,T="")=>{d(!0);try{const k=e.find(A=>A.id===y),_={...k.etapas};_[h]={..._[h],estado:C,fecha_fin:C==="completada"?new Date:null,comentarios:T,responsable:t.email};const S=["validacion_datos","confirmacion_final"],N=S.filter(A=>{var R;return((R=_[A])==null?void 0:R.estado)==="completada"}).length,b=Math.round(N/S.length*100);let w="en_revision";if(C==="rechazada"?w="rechazada":h==="confirmacion_final"&&C==="completada"&&(w="aprobada"),h==="confirmacion_final"&&C==="completada"){const A=await m7.createClientUser({...k,id:y});if(A.success)await Me(we($,"solicitudes_cliente",y),{etapas:_,progreso_porcentaje:100,estado_general:"aprobada",etapa_actual:"confirmacion_final",usuario_creado:!0,uid_usuario:A.uid,fecha_activacion:new Date,perfil_id:A.profileId}),await sa.createInAppNotification(A.uid,"validacion","¡Cuenta activada! Bienvenido a AV10 de Julio","Tu cuenta de cliente ha sido creada exitosamente. Ya puedes iniciar sesión y gestionar tus vehículos.",{solicitudId:y,uid:A.uid,email:A.email,origen:"cuenta_activada"}),alert(`Usuario creado exitosamente para ${k.nombres} ${k.apellidos}`);else{alert(`Error al crear usuario: ${A.error}`);return}}else await Me(we($,"solicitudes_cliente",y),{etapas:_,progreso_porcentaje:b,estado_general:w,etapa_actual:h});await sa.createInAppNotification(k.uid||k.email,"validacion","Actualización en tu solicitud",`La etapa "${h}" ha sido ${C==="completada"?"completada":"actualizada"}`,{solicitudId:y,etapa:h,estado:C,origen:"admin_solicitudes_cliente"}),await f()}catch(k){console.error("Error updating stage:",k),alert("Error al actualizar la etapa: "+k.message)}finally{d(!1)}},v=e.filter(y=>i==="all"?!0:y.estado_general===i),x=y=>{switch(y){case"enviada":return"bg-blue-100 text-blue-800";case"en_revision":return"bg-yellow-100 text-yellow-800";case"aprobada":return"bg-green-100 text-green-800";case"rechazada":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return r?a.createElement("div",{className:"flex justify-center items-center h-64"},a.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})):a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"flex justify-between items-center"},a.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Solicitudes de Cliente"),a.createElement("div",{className:"flex space-x-2"},a.createElement("select",{value:i,onChange:y=>o(y.target.value),className:"border border-gray-300 rounded-lg px-3 py-2"},a.createElement("option",{value:"all"},"Todas las solicitudes"),a.createElement("option",{value:"enviada"},"Enviadas"),a.createElement("option",{value:"en_revision"},"En revisión"),a.createElement("option",{value:"aprobada"},"Aprobadas"),a.createElement("option",{value:"rechazada"},"Rechazadas")))),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4"},[{label:"Total",value:e.length,color:"bg-blue-500"},{label:"Pendientes",value:e.filter(y=>y.estado_general==="enviada").length,color:"bg-yellow-500"},{label:"En Revisión",value:e.filter(y=>y.estado_general==="en_revision").length,color:"bg-orange-500"},{label:"Aprobadas",value:e.filter(y=>y.estado_general==="aprobada").length,color:"bg-green-500"}].map(y=>a.createElement("div",{key:y.label,className:"bg-white rounded-lg shadow p-6"},a.createElement("div",{className:"flex items-center"},a.createElement("div",{className:`w-4 h-4 rounded-full ${y.color} mr-3`}),a.createElement("div",null,a.createElement("p",{className:"text-sm font-medium text-gray-600"},y.label),a.createElement("p",{className:"text-2xl font-bold text-gray-900"},y.value)))))),a.createElement("div",{className:"bg-white shadow rounded-lg overflow-hidden"},a.createElement("div",{className:"overflow-x-auto"},a.createElement("table",{className:"min-w-full divide-y divide-gray-200"},a.createElement("thead",{className:"bg-gray-50"},a.createElement("tr",null,a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Cliente"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Etapa Actual"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Progreso"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Fecha"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),a.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},v.map(y=>{var h,C;return a.createElement("tr",{key:y.id,className:"hover:bg-gray-50"},a.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},a.createElement("div",null,a.createElement("div",{className:"text-sm font-medium text-gray-900"},y.nombres," ",y.apellidos),a.createElement("div",{className:"text-sm text-gray-500"},y.email))),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},a.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${x(y.estado_general)}`},y.estado_general)),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},(h=y.etapa_actual)==null?void 0:h.replace("_"," ")),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},a.createElement("div",{className:"flex items-center"},a.createElement("div",{className:"w-full bg-gray-200 rounded-full h-2 mr-2"},a.createElement("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${y.progreso_porcentaje||0}%`}})),a.createElement("span",{className:"text-sm text-gray-600"},y.progreso_porcentaje||0,"%"))),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},(C=y.fecha_solicitud)!=null&&C.toDate?y.fecha_solicitud.toDate().toLocaleDateString():"N/A"),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},a.createElement("button",{onClick:()=>c(y),className:"text-blue-600 hover:text-blue-900 mr-3"},"Ver Detalles")))}))))),l&&a.createElement("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},a.createElement("div",{className:"relative top-20 mx-auto p-5 border w-11/12 max-w-4xl shadow-lg rounded-md bg-white"},a.createElement("div",{className:"flex justify-between items-center mb-4"},a.createElement("h3",{className:"text-lg font-bold text-gray-900"},"Detalle de Solicitud - ",l.nombres," ",l.apellidos),a.createElement("button",{onClick:()=>c(null),className:"text-gray-400 hover:text-gray-600"},"✕")),a.createElement("div",{className:"grid md:grid-cols-2 gap-6"},a.createElement("div",{className:"space-y-4"},a.createElement("h4",{className:"font-semibold text-gray-900"},"Información Personal"),a.createElement("div",{className:"space-y-2 text-sm"},a.createElement("p",null,a.createElement("span",{className:"font-medium"},"RUT:")," ",l.rut),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Email:")," ",l.email),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Teléfono:")," ",l.telefono),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Dirección:")," ",l.direccion),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Comuna:")," ",l.comuna),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Región:")," ",l.region),l.profesion&&a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Profesión:")," ",l.profesion),l.empresa&&a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Empresa:")," ",l.empresa)),((E=l.servicios_interes)==null?void 0:E.length)>0&&a.createElement("div",null,a.createElement("h5",{className:"font-medium text-gray-900 mb-2"},"Servicios de Interés"),a.createElement("div",{className:"flex flex-wrap gap-1"},l.servicios_interes.map(y=>a.createElement("span",{key:y,className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs"},y)))),l.motivo_registro&&a.createElement("div",null,a.createElement("h5",{className:"font-medium text-gray-900 mb-2"},"Motivo de Registro"),a.createElement("p",{className:"text-sm text-gray-600"},l.motivo_registro))),a.createElement("div",{className:"space-y-4"},a.createElement("h4",{className:"font-semibold text-gray-900"},"Gestión de Etapas"),["validacion_datos","confirmacion_final"].map(y=>{var T;const h=((T=l.etapas)==null?void 0:T[y])||{estado:"pendiente"},C={validacion_datos:"Validación de Datos",confirmacion_final:"Confirmación Final"};return a.createElement("div",{key:y,className:"border rounded-lg p-3"},a.createElement("div",{className:"flex justify-between items-center mb-2"},a.createElement("h5",{className:"font-medium text-gray-900"},C[y]),a.createElement("span",{className:`px-2 py-1 rounded text-xs ${h.estado==="completada"?"bg-green-100 text-green-800":h.estado==="en_proceso"?"bg-blue-100 text-blue-800":h.estado==="rechazada"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`},h.estado)),y==="validacion_datos"&&a.createElement("div",{className:"text-sm text-gray-600 mb-2"},"Revisar datos personales, documentos de identidad y dirección"),y==="confirmacion_final"&&a.createElement("div",{className:"text-sm text-gray-600 mb-2"},"Aprobar solicitud y crear cuenta de usuario en el sistema"),h.estado==="pendiente"&&a.createElement("div",{className:"flex space-x-2"},a.createElement("button",{onClick:()=>g(l.id,y,"completada"),disabled:u,className:"bg-green-600 text-white px-3 py-1 rounded text-xs hover:bg-green-700 disabled:opacity-50"},"Completar"),a.createElement("button",{onClick:()=>g(l.id,y,"rechazada","Rechazada por admin"),disabled:u,className:"bg-red-600 text-white px-3 py-1 rounded text-xs hover:bg-red-700 disabled:opacity-50"},"Rechazar")),h.comentarios&&a.createElement("p",{className:"text-xs text-gray-600 mt-2"},h.comentarios))}))))))}function f7(){const[t,e]=p.useState([]),[n,r]=p.useState(!0),[s,i]=p.useState(""),[o,l]=p.useState(null),[c,u]=p.useState(!1);p.useEffect(()=>{const y=pe(Q($,"solicitudes_comunidad"),Et("fecha_solicitud","desc"));return Dt(y,C=>{const T=C.docs.map(k=>({id:k.id,...k.data()}));e(T),r(!1)})},[]);const d=async(y,h,C=null)=>{try{const T={estado_general:h,fecha_actualizacion:new Date};switch(h){case"en_revision":T.progreso_porcentaje=50;break;case"documentos_aprobados":T.progreso_porcentaje=75,C&&(T[`etapas.${C}`]="completada");break;case"aprobada":T.progreso_porcentaje=100,T.etapas={documentos:"completada",validacion_comercial:"completada",visita_campo:"completada",decision_final:"completada"};break;case"rechazada":T.progreso_porcentaje=0;break;default:break}await Me(we($,"solicitudes_comunidad",y),T),h==="aprobada"&&await f(y),alert("Estado actualizado exitosamente")}catch(T){console.error("Error actualizando estado:",T),alert("Error al actualizar el estado")}},f=async y=>{try{const h=t.find(T=>T.id===y);if(!h)return;const C={nombre:h.nombre_empresa,rut:h.rut_empresa,direccion:h.direccion,telefono:h.telefono,email:h.email,sitio_web:h.sitio_web,categoria:h.categoria,marcas:h.marcas,descripcion:h.descripcion_servicios,horario_atencion:h.horario_atencion,logo_url:h.logo_url,representante_legal:{nombre:h.nombre_representante,rut:h.rut_representante,cargo:h.cargo_representante,telefono:h.telefono_representante,email:h.email_representante},estado:"activa",tipo_empresa:"comunidad",es_comunidad:!0,fecha_ingreso_comunidad:new Date,fecha_creacion:new Date,fecha_actualizacion:new Date,solicitud_origen_id:y,años_experiencia:h.años_experiencia,numero_empleados:h.numero_empleados,documentacion:{constitucion:h.documento_constitucion,vigencia:h.certificado_vigencia,autorizacion_sectorial:h.autorizacion_sectorial}};await ze(Q($,"empresas"),C),console.log("Empresa creada exitosamente en la comunidad")}catch(h){throw console.error("Error creando empresa en comunidad:",h),h}},g=async(y,h)=>{try{await Me(we($,"solicitudes_comunidad",y),{observaciones_admin:h,fecha_actualizacion:new Date}),alert("Observación agregada exitosamente"),u(!1)}catch(C){console.error("Error agregando observación:",C),alert("Error al agregar la observación")}},v=t.filter(y=>s?y.estado_general===s:!0),x=y=>{switch(y){case"pendiente_revision":return"bg-yellow-100 text-yellow-800";case"en_revision":return"bg-blue-100 text-blue-800";case"documentos_aprobados":return"bg-purple-100 text-purple-800";case"aprobada":return"bg-green-100 text-green-800";case"rechazada":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},E=y=>{switch(y){case"pendiente_revision":return"Pendiente Revisión";case"en_revision":return"En Revisión";case"documentos_aprobados":return"Documentos Aprobados";case"aprobada":return"Aprobada";case"rechazada":return"Rechazada";default:return y}};return n?a.createElement("div",{className:"flex items-center justify-center p-8"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.createElement("p",{className:"text-gray-600"},"Cargando solicitudes..."))):a.createElement("div",{className:"p-6"},a.createElement("div",{className:"mb-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-800 mb-2"},"Solicitudes para Unirse a la Comunidad"),a.createElement("p",{className:"text-gray-600"},"Gestiona las solicitudes de empresas que quieren formar parte de la comunidad AV10 de Julio.")),a.createElement("div",{className:"mb-6 flex flex-wrap gap-4"},a.createElement("select",{value:s,onChange:y=>i(y.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},a.createElement("option",{value:""},"Todos los estados"),a.createElement("option",{value:"pendiente_revision"},"Pendiente Revisión"),a.createElement("option",{value:"en_revision"},"En Revisión"),a.createElement("option",{value:"documentos_aprobados"},"Documentos Aprobados"),a.createElement("option",{value:"aprobada"},"Aprobadas"),a.createElement("option",{value:"rechazada"},"Rechazadas")),a.createElement("div",{className:"text-sm text-gray-600"},"Total: ",v.length," solicitudes")),a.createElement("div",{className:"grid gap-6"},v.map(y=>{var h,C,T;return a.createElement("div",{key:y.id,className:"bg-white border border-gray-200 rounded-lg shadow-sm p-6"},a.createElement("div",{className:"flex justify-between items-start mb-4"},a.createElement("div",null,a.createElement("h3",{className:"text-xl font-semibold text-gray-800 mb-1"},y.nombre_empresa),a.createElement("p",{className:"text-gray-600"},"RUT: ",y.rut_empresa),a.createElement("p",{className:"text-gray-600"},"Fecha: ",((T=(C=(h=y.fecha_solicitud)==null?void 0:h.toDate)==null?void 0:C.call(h))==null?void 0:T.toLocaleDateString())||"N/A")),a.createElement("div",{className:"flex flex-col items-end gap-2"},a.createElement("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${x(y.estado_general)}`},E(y.estado_general)),a.createElement("div",{className:"text-sm text-gray-600"},y.progreso_porcentaje,"% completado"))),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4"},a.createElement("div",null,a.createElement("p",{className:"text-sm font-medium text-gray-700"},"Categoría"),a.createElement("p",{className:"text-gray-600"},y.categoria)),a.createElement("div",null,a.createElement("p",{className:"text-sm font-medium text-gray-700"},"Dirección"),a.createElement("p",{className:"text-gray-600"},y.direccion)),a.createElement("div",null,a.createElement("p",{className:"text-sm font-medium text-gray-700"},"Representante"),a.createElement("p",{className:"text-gray-600"},y.nombre_representante)),a.createElement("div",null,a.createElement("p",{className:"text-sm font-medium text-gray-700"},"Email"),a.createElement("p",{className:"text-gray-600"},y.email)),a.createElement("div",null,a.createElement("p",{className:"text-sm font-medium text-gray-700"},"Teléfono"),a.createElement("p",{className:"text-gray-600"},y.telefono)),a.createElement("div",null,a.createElement("p",{className:"text-sm font-medium text-gray-700"},"Experiencia"),a.createElement("p",{className:"text-gray-600"},y.años_experiencia," años"))),a.createElement("div",{className:"mb-4"},a.createElement("p",{className:"text-sm font-medium text-gray-700 mb-2"},"Progreso de Validación"),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2"},Object.entries(y.etapas||{}).map(([k,_])=>a.createElement("div",{key:k,className:"text-center"},a.createElement("div",{className:`h-2 rounded-full mb-1 ${_==="completada"?"bg-green-500":_==="en_proceso"?"bg-yellow-500":"bg-gray-300"}`}),a.createElement("p",{className:"text-xs text-gray-600 capitalize"},k.replace("_"," ")))))),y.observaciones_admin&&a.createElement("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded"},a.createElement("p",{className:"text-sm font-medium text-yellow-800 mb-1"},"Observaciones:"),a.createElement("p",{className:"text-sm text-yellow-700"},y.observaciones_admin)),a.createElement("div",{className:"flex flex-wrap gap-2"},a.createElement("button",{onClick:()=>{l(y),u(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm"},"Ver Detalles"),y.estado_general==="pendiente_revision"&&a.createElement("button",{onClick:()=>d(y.id,"en_revision"),className:"px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 text-sm"},"Iniciar Revisión"),y.estado_general==="en_revision"&&a.createElement(a.Fragment,null,a.createElement("button",{onClick:()=>d(y.id,"documentos_aprobados","documentos"),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-sm"},"Aprobar Documentos"),a.createElement("button",{onClick:()=>d(y.id,"rechazada"),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm"},"Rechazar")),y.estado_general==="documentos_aprobados"&&a.createElement("button",{onClick:()=>d(y.id,"aprobada"),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm"},"Aprobar e Integrar a Comunidad")))})),v.length===0&&a.createElement("div",{className:"text-center py-8"},a.createElement("p",{className:"text-gray-600"},"No hay solicitudes que coincidan con los filtros seleccionados.")),c&&o&&a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto"},a.createElement("div",{className:"flex justify-between items-center mb-6"},a.createElement("h3",{className:"text-2xl font-bold text-gray-800"},"Detalles de ",o.nombre_empresa),a.createElement("button",{onClick:()=>u(!1),className:"text-gray-500 hover:text-gray-700 text-2xl font-bold"},"×")),a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-800 mb-2"},"Información de la Empresa"),a.createElement("div",{className:"space-y-2 text-sm"},a.createElement("p",null,a.createElement("strong",null,"Nombre:")," ",o.nombre_empresa),a.createElement("p",null,a.createElement("strong",null,"RUT:")," ",o.rut_empresa),a.createElement("p",null,a.createElement("strong",null,"Dirección:")," ",o.direccion),a.createElement("p",null,a.createElement("strong",null,"Teléfono:")," ",o.telefono),a.createElement("p",null,a.createElement("strong",null,"Email:")," ",o.email),a.createElement("p",null,a.createElement("strong",null,"Sitio Web:")," ",o.sitio_web))),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-800 mb-2"},"Representante Legal"),a.createElement("div",{className:"space-y-2 text-sm"},a.createElement("p",null,a.createElement("strong",null,"Nombre:")," ",o.nombre_representante),a.createElement("p",null,a.createElement("strong",null,"RUT:")," ",o.rut_representante),a.createElement("p",null,a.createElement("strong",null,"Cargo:")," ",o.cargo_representante),a.createElement("p",null,a.createElement("strong",null,"Teléfono:")," ",o.telefono_representante),a.createElement("p",null,a.createElement("strong",null,"Email:")," ",o.email_representante)))),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-800 mb-2"},"Descripción de Servicios"),a.createElement("p",{className:"text-sm text-gray-600"},o.descripcion_servicios)),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-800 mb-2"},"Motivación"),a.createElement("p",{className:"text-sm text-gray-600"},o.motivacion)),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-800 mb-2"},"Beneficios Esperados"),a.createElement("p",{className:"text-sm text-gray-600"},o.beneficios_esperados)),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-800 mb-2"},"Documentación"),a.createElement("div",{className:"space-y-2 text-sm"},o.logo_url&&a.createElement("p",null,a.createElement("strong",null,"Logo:")," ",a.createElement("a",{href:o.logo_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},"Ver logo")),o.documento_constitucion&&a.createElement("p",null,a.createElement("strong",null,"Constitución:")," ",a.createElement("a",{href:o.documento_constitucion,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},"Ver documento")),o.certificado_vigencia&&a.createElement("p",null,a.createElement("strong",null,"Vigencia:")," ",a.createElement("a",{href:o.certificado_vigencia,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},"Ver certificado")),o.autorizacion_sectorial&&a.createElement("p",null,a.createElement("strong",null,"Autorización:")," ",a.createElement("a",{href:o.autorizacion_sectorial,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},"Ver autorización")))),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-800 mb-2"},"Agregar Observación"),a.createElement("textarea",{placeholder:"Escriba una observación para la empresa...",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"3",onChange:y=>{document.getElementById("observacion-temp").value=y.target.value}}),a.createElement("button",{onClick:()=>{const y=document.getElementById("observacion-temp").value;y.trim()&&g(o.id,y)},className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"},"Agregar Observación"),a.createElement("input",{type:"hidden",id:"observacion-temp"}))),a.createElement("div",{className:"flex justify-end mt-6 pt-6 border-t"},a.createElement("button",{onClick:()=>u(!1),className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"},"Cerrar")))))}const h7="BEl62iUYgUivxIhf6Ydtwqr2oXIFOOcNVKqF8sD_ECGRt1Ue6kf0lKrKQK2BdHWnU_0XEU1LoXOQ",g7=t=>{const[e,n]=p.useState(Notification.permission),[r,s]=p.useState(null),[i,o]=p.useState(!1);p.useEffect(()=>{o("Notification"in window&&"serviceWorker"in navigator)},[]);const l=async()=>{if(!i)return console.log("Notificaciones no soportadas en este navegador"),!1;try{const g=await Notification.requestPermission();return n(g),g==="granted"?(await c(),!0):!1}catch(g){return console.error("Error al solicitar permisos de notificación:",g),!1}},c=async()=>{if(!cd||e!=="granted")return null;try{const g=await jI(cd,{vapidKey:h7});return g?(s(g),t&&await u(g,t.uid),g):(console.log("No se pudo obtener el token de notificación"),null)}catch(g){return console.error("Error al obtener token de notificación:",g),null}},u=async(g,v)=>{try{const x=we($,"usuarios",v);await Me(x,{notificationToken:g,notificationsEnabled:!0,lastTokenUpdate:new Date})}catch(x){console.error("Error al guardar token en base de datos:",x)}};p.useEffect(()=>{if(!cd)return;const g=FI(cd,v=>{console.log("Mensaje recibido en primer plano:",v),v.notification&&d(v.notification)});return()=>g()},[]);const d=g=>{console.log("Notificación en app:",g),document.visibilityState==="visible"&&`${g.title}${g.body}`};return{permission:e,token:r,isSupported:i,requestPermission:l,getNotificationToken:c,sendTestNotification:async()=>{if(!r){console.log("No hay token disponible");return}try{console.log("Enviando notificación de prueba con token:",r),alert("Token de notificación copiado al console. Úsalo en Firebase Console para enviar una prueba.")}catch(g){console.error("Error al enviar notificación de prueba:",g)}}}},v7=({user:t})=>{const[e,n]=p.useState([]),[r,s]=p.useState(!1),[i,o]=p.useState({titulo:"",cuerpo:"",tipo:"general",url:""}),{token:l,requestPermission:c,sendTestNotification:u}=g7(t);p.useEffect(()=>{d()},[]);const d=async()=>{try{const v=Q($,"usuarios"),x=pe(v,fe("notificationsEnabled","==",!0),Et("lastTokenUpdate","desc"),jo(100)),y=(await ue(x)).docs.map(h=>({id:h.id,...h.data()}));n(y)}catch(v){console.error("Error al cargar usuarios:",v)}},f=async v=>{v.preventDefault(),s(!0);try{const x={...i,fechaEnvio:new Date,enviadoPor:t.uid,estado:"enviada",destinatarios:e.length};await ze(Q($,"notificaciones"),x),console.log("Notificación guardada:",x),console.log("Tokens destinatarios:",e.map(E=>E.notificationToken)),alert(`Notificación enviada a ${e.length} usuarios`),o({titulo:"",cuerpo:"",tipo:"general",url:""})}catch(x){console.error("Error al enviar notificación:",x),alert("Error al enviar notificación")}finally{s(!1)}},g=async()=>{await c()?(alert("Notificaciones configuradas correctamente"),d()):alert("Permisos de notificación denegados")};return a.createElement("div",{className:"max-w-4xl mx-auto p-6"},a.createElement("div",{className:"bg-white rounded-lg shadow-md p-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-800 mb-6"},"Gestión de Notificaciones Push"),a.createElement("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg"},a.createElement("h3",{className:"font-semibold text-blue-800 mb-2"},"Estado de configuración"),a.createElement("div",{className:"space-y-2"},a.createElement("p",{className:"text-sm"},a.createElement("span",{className:"font-medium"},"Token personal:"),l?a.createElement("span",{className:"text-green-600 ml-2"},"✓ Configurado"):a.createElement("span",{className:"text-red-600 ml-2"},"✗ No configurado")),a.createElement("p",{className:"text-sm"},a.createElement("span",{className:"font-medium"},"Usuarios con notificaciones:"),a.createElement("span",{className:"ml-2 font-bold"},e.length))),!l&&a.createElement("button",{onClick:g,className:"mt-3 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"Configurar Notificaciones")),a.createElement("form",{onSubmit:f,className:"space-y-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Título de la notificación"),a.createElement("input",{type:"text",value:i.titulo,onChange:v=>o({...i,titulo:v.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Nueva campaña disponible",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Mensaje"),a.createElement("textarea",{value:i.cuerpo,onChange:v=>o({...i,cuerpo:v.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",placeholder:"Contenido de la notificación...",required:!0})),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Tipo de notificación"),a.createElement("select",{value:i.tipo,onChange:v=>o({...i,tipo:v.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},a.createElement("option",{value:"general"},"General"),a.createElement("option",{value:"admin"},"Solo Administradores"),a.createElement("option",{value:"proveedor"},"Solo Proveedores"),a.createElement("option",{value:"cliente"},"Solo Clientes"),a.createElement("option",{value:"agente"},"Solo Agentes"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"URL de destino (opcional)"),a.createElement("input",{type:"url",value:i.url,onChange:v=>o({...i,url:v.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://..."}))),a.createElement("div",{className:"flex space-x-4"},a.createElement("button",{type:"submit",disabled:r||e.length===0,className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 disabled:bg-gray-400"},r?"Enviando...":`Enviar a ${e.length} usuarios`),l&&a.createElement("button",{type:"button",onClick:u,className:"bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700"},"Enviar Prueba Personal"))),e.length>0&&a.createElement("div",{className:"mt-8"},a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Usuarios con notificaciones activas"),a.createElement("div",{className:"bg-gray-50 rounded-lg p-4 max-h-60 overflow-y-auto"},e.map(v=>{var x,E,y;return a.createElement("div",{key:v.id,className:"flex justify-between items-center py-2 border-b border-gray-200 last:border-b-0"},a.createElement("div",null,a.createElement("span",{className:"font-medium"},v.email),a.createElement("span",{className:"ml-2 text-sm text-gray-500"},"(",v.rol,")")),a.createElement("span",{className:"text-xs text-gray-400"},(y=(E=(x=v.lastTokenUpdate)==null?void 0:x.toDate)==null?void 0:E.call(x))==null?void 0:y.toLocaleDateString()))})))))};function b7(){const[t,e]=p.useState([]),n=ft();return p.useEffect(()=>{const r=Dt(Q($,"categorias"),s=>{e(s.docs.map(i=>({id:i.id,...i.data()})))});return()=>r()},[]),a.createElement("div",{className:"p-4"},a.createElement("h2",{className:"text-xl font-bold mb-4"},"Listado de Categorías"),a.createElement("table",{className:"min-w-full border"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",{className:"border px-2 py-1"},"Nombre"),a.createElement("th",{className:"border px-2 py-1"},"Acciones"))),a.createElement("tbody",null,t.map(r=>a.createElement("tr",{key:r.id},a.createElement("td",{className:"border px-2 py-1"},r.nombre??"-"),a.createElement("td",{className:"border px-2 py-1"},a.createElement("button",{className:"bg-yellow-400 hover:bg-yellow-500 text-xs px-2 py-1 rounded",onClick:()=>n(`/admin/categorias/${r.id}/editar`)},"Editar")))))))}function y7(){const{rol:t}=Qe(),[e,n]=p.useState([]),[r,s]=p.useState(!0),[i,o]=p.useState("pendiente_validacion"),[l,c]=p.useState(null),[u,d]=p.useState(!1),[f,g]=p.useState(""),[v,x]=p.useState({total:0,pendientes:0,activos:0,rechazados:0,suspendidos:0});p.useEffect(()=>{t==="admin"&&(E(),y())},[t,i]);const E=async()=>{try{s(!0);let _;i==="todas"?_=pe(Q($,"perfiles_clientes"),Et("fechaRegistro","desc")):_=pe(Q($,"perfiles_clientes"),fe("estado","==",i),Et("fechaRegistro","desc"));const N=(await ue(_)).docs.map(b=>({id:b.id,...b.data()}));n(N)}catch(_){console.error("Error loading solicitudes:",_)}finally{s(!1)}},y=async()=>{try{const _=pe(Q($,"perfiles_clientes")),N=(await ue(_)).docs.map(w=>({id:w.id,...w.data()})),b={total:N.length,pendientes:N.filter(w=>w.estado==="pendiente_validacion").length,activos:N.filter(w=>w.estado==="activo").length,rechazados:N.filter(w=>w.estado==="rechazado").length,suspendidos:N.filter(w=>w.estado==="suspendido").length};x(b)}catch(_){console.error("Error loading statistics:",_)}},h=async(_,S,N="")=>{try{const b=e.find(A=>A.id===_);await Me(we($,"perfiles_clientes",_),{estado:S,validadoPor:"admin",fechaValidacion:new Date,observaciones:N}),await sa.notifyClientValidationStatus(b.userId,S,N),await E(),await y(),d(!1),g(""),c(null),alert({activo:"Cliente validado exitosamente. Se ha enviado una notificación.",rechazado:"Cliente rechazado. Se ha enviado una notificación con el motivo.",suspendido:"Cliente suspendido. Se ha enviado una notificación."}[S]||"Estado actualizado")}catch(b){console.error("Error validating client:",b),alert("Error al validar cliente")}},C=(_,S)=>{c(_),S==="rechazado"?d(!0):h(_.id,S)},T=_=>{const S={pendiente_validacion:"bg-yellow-100 text-yellow-800",activo:"bg-green-100 text-green-800",rechazado:"bg-red-100 text-red-800",suspendido:"bg-gray-100 text-gray-800"},N={pendiente_validacion:"Pendiente",activo:"Activo",rechazado:"Rechazado",suspendido:"Suspendido"};return a.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${S[_]}`},N[_])},k=_=>{const S=new Date(_.seconds*1e3),b=new Date-S;return Math.floor(b/(1e3*60*60*24))};return t!=="admin"?a.createElement("div",{className:"container mx-auto px-4 py-8"},a.createElement("div",{className:"text-center"},a.createElement("h1",{className:"text-2xl font-bold text-red-600"},"Acceso Denegado"),a.createElement("p",{className:"text-gray-600"},"No tienes permisos para acceder a esta página."))):r?a.createElement("div",{className:"container mx-auto px-4 py-8"},a.createElement("div",{className:"animate-pulse"},a.createElement("div",{className:"h-8 bg-gray-300 rounded mb-6"}),a.createElement("div",{className:"space-y-4"},[1,2,3,4,5].map(_=>a.createElement("div",{key:_,className:"h-20 bg-gray-300 rounded"}))))):a.createElement("div",{className:"container mx-auto px-4 py-8"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg p-6"},a.createElement("div",{className:"flex justify-between items-center mb-6"},a.createElement("div",null,a.createElement("h1",{className:"text-3xl font-bold text-gray-800"},"Validación de Clientes"),a.createElement("p",{className:"text-gray-600"},"Gestiona las solicitudes de ingreso a la comunidad"))),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8"},a.createElement("div",{className:"bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",null,a.createElement("p",{className:"text-blue-600 text-sm font-medium"},"Total Clientes"),a.createElement("p",{className:"text-2xl font-bold text-blue-800"},v.total)),a.createElement("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})))),a.createElement("div",{className:"bg-yellow-50 p-4 rounded-lg border-l-4 border-yellow-500"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",null,a.createElement("p",{className:"text-yellow-600 text-sm font-medium"},"Pendientes"),a.createElement("p",{className:"text-2xl font-bold text-yellow-800"},v.pendientes)),a.createElement("svg",{className:"w-8 h-8 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})))),a.createElement("div",{className:"bg-green-50 p-4 rounded-lg border-l-4 border-green-500"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",null,a.createElement("p",{className:"text-green-600 text-sm font-medium"},"Activos"),a.createElement("p",{className:"text-2xl font-bold text-green-800"},v.activos)),a.createElement("svg",{className:"w-8 h-8 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})))),a.createElement("div",{className:"bg-red-50 p-4 rounded-lg border-l-4 border-red-500"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",null,a.createElement("p",{className:"text-red-600 text-sm font-medium"},"Rechazados"),a.createElement("p",{className:"text-2xl font-bold text-red-800"},v.rechazados)),a.createElement("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})))),a.createElement("div",{className:"bg-gray-50 p-4 rounded-lg border-l-4 border-gray-500"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",null,a.createElement("p",{className:"text-gray-600 text-sm font-medium"},"Suspendidos"),a.createElement("p",{className:"text-2xl font-bold text-gray-800"},v.suspendidos)),a.createElement("svg",{className:"w-8 h-8 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636M5.636 18.364l12.728-12.728"}))))),a.createElement("div",{className:"flex gap-2 mb-6"},a.createElement("select",{className:"border rounded px-3 py-2",value:i,onChange:_=>o(_.target.value)},a.createElement("option",{value:"pendiente_validacion"},"Pendientes"),a.createElement("option",{value:"activo"},"Activos"),a.createElement("option",{value:"rechazado"},"Rechazados"),a.createElement("option",{value:"suspendido"},"Suspendidos"),a.createElement("option",{value:"todas"},"Todas"))),a.createElement("div",{className:"space-y-4"},e.length===0?a.createElement("div",{className:"text-center py-8"},a.createElement("p",{className:"text-gray-500"},"No hay solicitudes con el filtro seleccionado.")):e.map(_=>a.createElement("div",{key:_.id,className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},a.createElement("div",{className:"flex justify-between items-start mb-3"},a.createElement("div",{className:"flex-1"},a.createElement("div",{className:"flex items-center gap-3 mb-2"},a.createElement("h3",{className:"font-semibold text-lg"},_.nombres," ",_.apellidos),T(_.estado),_.creado_desde_solicitud&&a.createElement("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full"},"📝 Desde solicitud"),_.estado==="pendiente_validacion"&&a.createElement("span",{className:"text-xs text-orange-600"},k(_.fechaRegistro)," días esperando")),a.createElement("div",{className:"grid md:grid-cols-3 gap-4 text-sm"},a.createElement("div",null,a.createElement("span",{className:"text-gray-600"},"RUT:"),a.createElement("p",{className:"font-medium"},_.rut)),a.createElement("div",null,a.createElement("span",{className:"text-gray-600"},"Email:"),a.createElement("p",{className:"font-medium"},_.email)),a.createElement("div",null,a.createElement("span",{className:"text-gray-600"},"Teléfono:"),a.createElement("p",{className:"font-medium"},_.telefono)),a.createElement("div",null,a.createElement("span",{className:"text-gray-600"},"Ubicación:"),a.createElement("p",{className:"font-medium"},_.comuna,", ",_.region)),a.createElement("div",null,a.createElement("span",{className:"text-gray-600"},"Tipo:"),a.createElement("p",{className:"font-medium"},_.tipoCliente)),a.createElement("div",null,a.createElement("span",{className:"text-gray-600"},"Fecha registro:"),a.createElement("p",{className:"font-medium"},new Date(_.fechaRegistro.seconds*1e3).toLocaleDateString()))),_.motivoRegistro&&a.createElement("div",{className:"mt-3 bg-gray-50 p-3 rounded"},a.createElement("span",{className:"text-sm font-medium text-gray-700"},"Motivo de registro:"),a.createElement("p",{className:"text-sm text-gray-600 mt-1"},_.motivoRegistro)),_.creado_desde_solicitud&&_.solicitud_original_id&&a.createElement("div",{className:"mt-3 bg-blue-50 p-3 rounded"},a.createElement("span",{className:"text-sm font-medium text-blue-700"},"Cliente creado desde solicitud:"),a.createElement("a",{href:`/admin/solicitudes-cliente?highlight=${_.solicitud_original_id}`,className:"text-sm text-blue-600 hover:text-blue-800 underline ml-2",target:"_blank"},"Ver solicitud original →")),_.observaciones&&a.createElement("div",{className:"mt-3 bg-red-50 p-3 rounded"},a.createElement("span",{className:"text-sm font-medium text-red-700"},"Observaciones:"),a.createElement("p",{className:"text-sm text-red-600 mt-1"},_.observaciones)))),_.estado==="pendiente_validacion"&&a.createElement("div",{className:"flex gap-2 pt-3 border-t"},a.createElement("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",onClick:()=>C(_,"activo")},"✅ Aprobar"),a.createElement("button",{className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",onClick:()=>C(_,"rechazado")},"❌ Rechazar"),a.createElement("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"📧 Contactar"),a.createElement("button",{className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700"},"📋 Ver Historial")),_.estado==="activo"&&a.createElement("div",{className:"flex gap-2 pt-3 border-t"},a.createElement("button",{className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700",onClick:()=>C(_,"suspendido")},"⏸️ Suspender"),a.createElement("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"👁️ Ver Actividad")),_.estado==="suspendido"&&a.createElement("div",{className:"flex gap-2 pt-3 border-t"},a.createElement("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",onClick:()=>C(_,"activo")},"▶️ Reactivar")))))),u&&a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-md"},a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Motivo del Rechazo"),a.createElement("div",{className:"mb-4"},a.createElement("label",{className:"block text-sm font-medium mb-2"},"Explica el motivo del rechazo:"),a.createElement("textarea",{rows:"4",className:"w-full border rounded px-3 py-2",placeholder:"Especifica las razones por las cuales no se puede aprobar esta solicitud...",value:f,onChange:_=>g(_.target.value),required:!0})),a.createElement("div",{className:"flex gap-2"},a.createElement("button",{className:"flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded hover:bg-gray-50",onClick:()=>{d(!1),g(""),c(null)}},"Cancelar"),a.createElement("button",{className:"flex-1 bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700",onClick:()=>{f.trim()?h(l.id,"rechazado",f):alert("Debes especificar el motivo del rechazo")}},"Confirmar Rechazo")))))}function E7(){const{rol:t}=Qe(),[e,n]=p.useState(!0),[r,s]=p.useState({clientes:{total:0,pendientes:0,activos:0,rechazados:0,suspendidos:0},vehiculos:{total:0,porMarca:{},porAño:{},promedioAño:0},notificaciones:{total:0,porTipo:{},noLeidas:0},actividad:{registrosHoy:0,registrosUltimaSemana:0,registrosUltimoMes:0}});p.useEffect(()=>{t==="admin"&&i()},[t]);const i=async()=>{try{n(!0);const g=(await ue(Q($,"perfiles_clientes"))).docs.map(w=>({id:w.id,...w.data()})),x=(await ue(Q($,"vehiculos"))).docs.map(w=>({id:w.id,...w.data()})),y=(await ue(Q($,"notificaciones"))).docs.map(w=>({id:w.id,...w.data()})),h=new Date,C=new Date(h);C.setDate(C.getDate()-1);const T=new Date(h);T.setDate(T.getDate()-7);const k=new Date(h);k.setDate(k.getDate()-30);const _=o(g),S=l(x),N=c(y),b=u(g,h,C,T,k);s({clientes:_,vehiculos:S,notificaciones:N,actividad:b})}catch(f){console.error("Error loading stats:",f)}finally{n(!1)}},o=f=>({total:f.length,pendientes:f.filter(g=>g.estado==="pendiente_validacion").length,activos:f.filter(g=>g.estado==="activo").length,rechazados:f.filter(g=>g.estado==="rechazado").length,suspendidos:f.filter(g=>g.estado==="suspendido").length}),l=f=>{const g={},v={};let x=0;return f.forEach(E=>{if(E.marca&&(g[E.marca]=(g[E.marca]||0)+1),E.año){const y=E.año.toString();v[y]=(v[y]||0)+1,x+=parseInt(E.año)}}),{total:f.length,porMarca:g,porAño:v,promedioAño:f.length>0?Math.round(x/f.length):0}},c=f=>{const g={};let v=0;return f.forEach(x=>{x.tipo&&(g[x.tipo]=(g[x.tipo]||0)+1),x.leida||v++}),{total:f.length,porTipo:g,noLeidas:v}},u=(f,g,v,x,E)=>({registrosHoy:f.filter(y=>y.fechaRegistro?(y.fechaRegistro.toDate?y.fechaRegistro.toDate():new Date(y.fechaRegistro)).toDateString()===g.toDateString():!1).length,registrosUltimaSemana:f.filter(y=>y.fechaRegistro?(y.fechaRegistro.toDate?y.fechaRegistro.toDate():new Date(y.fechaRegistro))>=x:!1).length,registrosUltimoMes:f.filter(y=>y.fechaRegistro?(y.fechaRegistro.toDate?y.fechaRegistro.toDate():new Date(y.fechaRegistro))>=E:!1).length}),d=(f,g=5)=>Object.entries(f).sort(([,v],[,x])=>x-v).slice(0,g);return t!=="admin"?a.createElement("div",{className:"text-center p-8"},a.createElement("h2",{className:"text-xl font-bold text-red-600"},"Acceso Denegado"),a.createElement("p",{className:"text-gray-600"},"Solo administradores pueden ver estas estadísticas.")):e?a.createElement("div",{className:"container mx-auto px-4 py-8"},a.createElement("div",{className:"animate-pulse"},a.createElement("div",{className:"h-8 bg-gray-300 rounded mb-6"}),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},[1,2,3,4].map(f=>a.createElement("div",{key:f,className:"h-32 bg-gray-300 rounded"}))))):a.createElement("div",{className:"container mx-auto px-4 py-8"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg p-6"},a.createElement("div",{className:"flex justify-between items-center mb-8"},a.createElement("div",null,a.createElement("h1",{className:"text-3xl font-bold text-gray-800"},"Dashboard Administrativo"),a.createElement("p",{className:"text-gray-600"},"Métricas y estadísticas del sistema")),a.createElement("button",{onClick:i,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex items-center gap-2"},a.createElement("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})),"Actualizar")),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},a.createElement("div",{className:"bg-blue-50 p-6 rounded-lg border-l-4 border-blue-500"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",null,a.createElement("p",{className:"text-blue-600 text-sm font-medium"},"Total Clientes"),a.createElement("p",{className:"text-3xl font-bold text-blue-800"},r.clientes.total),a.createElement("p",{className:"text-xs text-blue-600 mt-1"},r.clientes.pendientes," pendientes")),a.createElement("svg",{className:"w-12 h-12 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})))),a.createElement("div",{className:"bg-green-50 p-6 rounded-lg border-l-4 border-green-500"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",null,a.createElement("p",{className:"text-green-600 text-sm font-medium"},"Total Vehículos"),a.createElement("p",{className:"text-3xl font-bold text-green-800"},r.vehiculos.total),a.createElement("p",{className:"text-xs text-green-600 mt-1"},"Año promedio: ",r.vehiculos.promedioAño)),a.createElement("svg",{className:"w-12 h-12 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14l-1.2 4.8a2 2 0 01-1.9 1.2H8.1a2 2 0 01-1.9-1.2L5 8zm5-3V3a1 1 0 011-1h2a1 1 0 011 1v2m-4 0h4"})))),a.createElement("div",{className:"bg-yellow-50 p-6 rounded-lg border-l-4 border-yellow-500"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",null,a.createElement("p",{className:"text-yellow-600 text-sm font-medium"},"Notificaciones"),a.createElement("p",{className:"text-3xl font-bold text-yellow-800"},r.notificaciones.total),a.createElement("p",{className:"text-xs text-yellow-600 mt-1"},r.notificaciones.noLeidas," sin leer")),a.createElement("svg",{className:"w-12 h-12 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})))),a.createElement("div",{className:"bg-purple-50 p-6 rounded-lg border-l-4 border-purple-500"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",null,a.createElement("p",{className:"text-purple-600 text-sm font-medium"},"Registros Hoy"),a.createElement("p",{className:"text-3xl font-bold text-purple-800"},r.actividad.registrosHoy),a.createElement("p",{className:"text-xs text-purple-600 mt-1"},r.actividad.registrosUltimaSemana," esta semana")),a.createElement("svg",{className:"w-12 h-12 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"}))))),a.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8"},a.createElement("div",{className:"bg-gray-50 p-6 rounded-lg"},a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Top Marcas de Vehículos"),a.createElement("div",{className:"space-y-3"},d(r.vehiculos.porMarca).map(([f,g])=>a.createElement("div",{key:f,className:"flex justify-between items-center"},a.createElement("span",{className:"font-medium"},f),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("div",{className:"bg-blue-200 h-2 rounded",style:{width:`${g/Math.max(...Object.values(r.vehiculos.porMarca))*100}px`}}),a.createElement("span",{className:"text-sm text-gray-600"},g)))))),a.createElement("div",{className:"bg-gray-50 p-6 rounded-lg"},a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Estados de Clientes"),a.createElement("div",{className:"space-y-3"},a.createElement("div",{className:"flex justify-between items-center"},a.createElement("span",{className:"text-green-600"},"✅ Activos"),a.createElement("span",{className:"font-semibold"},r.clientes.activos)),a.createElement("div",{className:"flex justify-between items-center"},a.createElement("span",{className:"text-yellow-600"},"⏳ Pendientes"),a.createElement("span",{className:"font-semibold"},r.clientes.pendientes)),a.createElement("div",{className:"flex justify-between items-center"},a.createElement("span",{className:"text-red-600"},"❌ Rechazados"),a.createElement("span",{className:"font-semibold"},r.clientes.rechazados)),a.createElement("div",{className:"flex justify-between items-center"},a.createElement("span",{className:"text-gray-600"},"⚠️ Suspendidos"),a.createElement("span",{className:"font-semibold"},r.clientes.suspendidos)))),a.createElement("div",{className:"bg-gray-50 p-6 rounded-lg"},a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Tipos de Notificaciones"),a.createElement("div",{className:"space-y-3"},d(r.notificaciones.porTipo).map(([f,g])=>a.createElement("div",{key:f,className:"flex justify-between items-center"},a.createElement("span",{className:"font-medium capitalize"},f.replace("_"," ")),a.createElement("span",{className:"text-sm text-gray-600"},g))))),a.createElement("div",{className:"bg-gray-50 p-6 rounded-lg"},a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Actividad Reciente"),a.createElement("div",{className:"space-y-3"},a.createElement("div",{className:"flex justify-between items-center"},a.createElement("span",null,"📅 Registros hoy"),a.createElement("span",{className:"font-semibold"},r.actividad.registrosHoy)),a.createElement("div",{className:"flex justify-between items-center"},a.createElement("span",null,"📅 Esta semana"),a.createElement("span",{className:"font-semibold"},r.actividad.registrosUltimaSemana)),a.createElement("div",{className:"flex justify-between items-center"},a.createElement("span",null,"📅 Este mes"),a.createElement("span",{className:"font-semibold"},r.actividad.registrosUltimoMes))))),a.createElement("div",{className:"mt-8 flex flex-wrap gap-4"},a.createElement("button",{onClick:()=>window.location.href="/admin/validacion-clientes",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"Validar Clientes"),a.createElement("button",{onClick:()=>window.location.href="/admin/marcas",className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"},"Gestionar Marcas"),a.createElement("button",{onClick:()=>window.location.href="/admin/tipos-empresa",className:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700"},"Tipos de Empresa"))))}var FT={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){((n,r)=>{t.exports=r()})(_N,function n(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},s,i=!r.document&&!!r.postMessage,o=r.IS_PAPA_WORKER||!1,l={},c=0,u={};function d(b){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(w){var A=_(w);A.chunkSize=parseInt(A.chunkSize),w.step||w.chunk||(A.chunkSize=null),this._handle=new E(A),(this._handle.streamer=this)._config=A}).call(this,b),this.parseChunk=function(w,A){var R=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<R){let M=this._config.newline;M||(L=this._config.quoteChar||'"',M=this._handle.guessLineEndings(w,L)),w=[...w.split(M).slice(R)].join(M)}this.isFirstChunk&&N(this._config.beforeFirstChunk)&&(L=this._config.beforeFirstChunk(w))!==void 0&&(w=L),this.isFirstChunk=!1,this._halted=!1;var R=this._partialLine+w,L=(this._partialLine="",this._handle.parse(R,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(w=L.meta.cursor,R=(this._finished||(this._partialLine=R.substring(w-this._baseIndex),this._baseIndex=w),L&&L.data&&(this._rowCount+=L.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)r.postMessage({results:L,workerId:u.WORKER_ID,finished:R});else if(N(this._config.chunk)&&!A){if(this._config.chunk(L,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=L=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(L.data),this._completeResults.errors=this._completeResults.errors.concat(L.errors),this._completeResults.meta=L.meta),this._completed||!R||!N(this._config.complete)||L&&L.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),R||L&&L.meta.paused||this._nextChunk(),L}this._halted=!0},this._sendError=function(w){N(this._config.error)?this._config.error(w):o&&this._config.error&&r.postMessage({workerId:u.WORKER_ID,error:w,finished:!1})}}function f(b){var w;(b=b||{}).chunkSize||(b.chunkSize=u.RemoteChunkSize),d.call(this,b),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(A){this._input=A,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(w=new XMLHttpRequest,this._config.withCredentials&&(w.withCredentials=this._config.withCredentials),i||(w.onload=S(this._chunkLoaded,this),w.onerror=S(this._chunkError,this)),w.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var A,R=this._config.downloadRequestHeaders;for(A in R)w.setRequestHeader(A,R[A])}var L;this._config.chunkSize&&(L=this._start+this._config.chunkSize-1,w.setRequestHeader("Range","bytes="+this._start+"-"+L));try{w.send(this._config.downloadRequestBody)}catch(M){this._chunkError(M.message)}i&&w.status===0&&this._chunkError()}},this._chunkLoaded=function(){w.readyState===4&&(w.status<200||400<=w.status?this._chunkError():(this._start+=this._config.chunkSize||w.responseText.length,this._finished=!this._config.chunkSize||this._start>=(A=>(A=A.getResponseHeader("Content-Range"))!==null?parseInt(A.substring(A.lastIndexOf("/")+1)):-1)(w),this.parseChunk(w.responseText)))},this._chunkError=function(A){A=w.statusText||A,this._sendError(new Error(A))}}function g(b){(b=b||{}).chunkSize||(b.chunkSize=u.LocalChunkSize),d.call(this,b);var w,A,R=typeof FileReader<"u";this.stream=function(L){this._input=L,A=L.slice||L.webkitSlice||L.mozSlice,R?((w=new FileReader).onload=S(this._chunkLoaded,this),w.onerror=S(this._chunkError,this)):w=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var L=this._input,M=(this._config.chunkSize&&(M=Math.min(this._start+this._config.chunkSize,this._input.size),L=A.call(L,this._start,M)),w.readAsText(L,this._config.encoding));R||this._chunkLoaded({target:{result:M}})},this._chunkLoaded=function(L){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(L.target.result)},this._chunkError=function(){this._sendError(w.error)}}function v(b){var w;d.call(this,b=b||{}),this.stream=function(A){return w=A,this._nextChunk()},this._nextChunk=function(){var A,R;if(!this._finished)return A=this._config.chunkSize,w=A?(R=w.substring(0,A),w.substring(A)):(R=w,""),this._finished=!w,this.parseChunk(R)}}function x(b){d.call(this,b=b||{});var w=[],A=!0,R=!1;this.pause=function(){d.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){d.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(L){this._input=L,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){R&&w.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),w.length?this.parseChunk(w.shift()):A=!0},this._streamData=S(function(L){try{w.push(typeof L=="string"?L:L.toString(this._config.encoding)),A&&(A=!1,this._checkIsFinished(),this.parseChunk(w.shift()))}catch(M){this._streamError(M)}},this),this._streamError=S(function(L){this._streamCleanUp(),this._sendError(L)},this),this._streamEnd=S(function(){this._streamCleanUp(),R=!0,this._streamData("")},this),this._streamCleanUp=S(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function E(b){var w,A,R,L,M=Math.pow(2,53),F=-M,U=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,D=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,j=this,V=0,z=0,G=!1,Y=!1,Z=[],H={data:[],errors:[],meta:{}};function oe(ie){return b.skipEmptyLines==="greedy"?ie.join("").trim()==="":ie.length===1&&ie[0].length===0}function W(){if(H&&R&&(xe("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),R=!1),b.skipEmptyLines&&(H.data=H.data.filter(function(re){return!oe(re)})),he()){let re=function(Se,Oe){N(b.transformHeader)&&(Se=b.transformHeader(Se,Oe)),Z.push(Se)};if(H)if(Array.isArray(H.data[0])){for(var ie=0;he()&&ie<H.data.length;ie++)H.data[ie].forEach(re);H.data.splice(0,1)}else H.data.forEach(re)}function be(re,Se){for(var Oe=b.header?{}:[],je=0;je<re.length;je++){var Ee=je,Re=re[je],Re=((ot,ke)=>(qe=>(b.dynamicTypingFunction&&b.dynamicTyping[qe]===void 0&&(b.dynamicTyping[qe]=b.dynamicTypingFunction(qe)),(b.dynamicTyping[qe]||b.dynamicTyping)===!0))(ot)?ke==="true"||ke==="TRUE"||ke!=="false"&&ke!=="FALSE"&&((qe=>{if(U.test(qe)&&(qe=parseFloat(qe),F<qe&&qe<M))return 1})(ke)?parseFloat(ke):D.test(ke)?new Date(ke):ke===""?null:ke):ke)(Ee=b.header?je>=Z.length?"__parsed_extra":Z[je]:Ee,Re=b.transform?b.transform(Re,Ee):Re);Ee==="__parsed_extra"?(Oe[Ee]=Oe[Ee]||[],Oe[Ee].push(Re)):Oe[Ee]=Re}return b.header&&(je>Z.length?xe("FieldMismatch","TooManyFields","Too many fields: expected "+Z.length+" fields but parsed "+je,z+Se):je<Z.length&&xe("FieldMismatch","TooFewFields","Too few fields: expected "+Z.length+" fields but parsed "+je,z+Se)),Oe}var ne;H&&(b.header||b.dynamicTyping||b.transform)&&(ne=1,!H.data.length||Array.isArray(H.data[0])?(H.data=H.data.map(be),ne=H.data.length):H.data=be(H.data,0),b.header&&H.meta&&(H.meta.fields=Z),z+=ne)}function he(){return b.header&&Z.length===0}function xe(ie,be,ne,re){ie={type:ie,code:be,message:ne},re!==void 0&&(ie.row=re),H.errors.push(ie)}N(b.step)&&(L=b.step,b.step=function(ie){H=ie,he()?W():(W(),H.data.length!==0&&(V+=ie.data.length,b.preview&&V>b.preview?A.abort():(H.data=H.data[0],L(H,j))))}),this.parse=function(ie,be,ne){var re=b.quoteChar||'"',re=(b.newline||(b.newline=this.guessLineEndings(ie,re)),R=!1,b.delimiter?N(b.delimiter)&&(b.delimiter=b.delimiter(ie),H.meta.delimiter=b.delimiter):((re=((Se,Oe,je,Ee,Re)=>{var ot,ke,qe,zt;Re=Re||[",","	","|",";",u.RECORD_SEP,u.UNIT_SEP];for(var tn=0;tn<Re.length;tn++){for(var Kt,In=Re[tn],ae=0,ge=0,Pe=0,Ce=(qe=void 0,new h({comments:Ee,delimiter:In,newline:Oe,preview:10}).parse(Se)),Le=0;Le<Ce.data.length;Le++)je&&oe(Ce.data[Le])?Pe++:(Kt=Ce.data[Le].length,ge+=Kt,qe===void 0?qe=Kt:0<Kt&&(ae+=Math.abs(Kt-qe),qe=Kt));0<Ce.data.length&&(ge/=Ce.data.length-Pe),(ke===void 0||ae<=ke)&&(zt===void 0||zt<ge)&&1.99<ge&&(ke=ae,ot=In,zt=ge)}return{successful:!!(b.delimiter=ot),bestDelimiter:ot}})(ie,b.newline,b.skipEmptyLines,b.comments,b.delimitersToGuess)).successful?b.delimiter=re.bestDelimiter:(R=!0,b.delimiter=u.DefaultDelimiter),H.meta.delimiter=b.delimiter),_(b));return b.preview&&b.header&&re.preview++,w=ie,A=new h(re),H=A.parse(w,be,ne),W(),G?{meta:{paused:!0}}:H||{meta:{paused:!1}}},this.paused=function(){return G},this.pause=function(){G=!0,A.abort(),w=N(b.chunk)?"":w.substring(A.getCharIndex())},this.resume=function(){j.streamer._halted?(G=!1,j.streamer.parseChunk(w,!0)):setTimeout(j.resume,3)},this.aborted=function(){return Y},this.abort=function(){Y=!0,A.abort(),H.meta.aborted=!0,N(b.complete)&&b.complete(H),w=""},this.guessLineEndings=function(Se,re){Se=Se.substring(0,1048576);var re=new RegExp(y(re)+"([^]*?)"+y(re),"gm"),ne=(Se=Se.replace(re,"")).split("\r"),re=Se.split(`
`),Se=1<re.length&&re[0].length<ne[0].length;if(ne.length===1||Se)return`
`;for(var Oe=0,je=0;je<ne.length;je++)ne[je][0]===`
`&&Oe++;return Oe>=ne.length/2?`\r
`:"\r"}}function y(b){return b.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function h(b){var w=(b=b||{}).delimiter,A=b.newline,R=b.comments,L=b.step,M=b.preview,F=b.fastMode,U=null,D=!1,j=b.quoteChar==null?'"':b.quoteChar,V=j;if(b.escapeChar!==void 0&&(V=b.escapeChar),(typeof w!="string"||-1<u.BAD_DELIMITERS.indexOf(w))&&(w=","),R===w)throw new Error("Comment character same as delimiter");R===!0?R="#":(typeof R!="string"||-1<u.BAD_DELIMITERS.indexOf(R))&&(R=!1),A!==`
`&&A!=="\r"&&A!==`\r
`&&(A=`
`);var z=0,G=!1;this.parse=function(Y,Z,H){if(typeof Y!="string")throw new Error("Input must be a string");var oe=Y.length,W=w.length,he=A.length,xe=R.length,ie=N(L),be=[],ne=[],re=[],Se=z=0;if(!Y)return ae();if(F||F!==!1&&Y.indexOf(j)===-1){for(var Oe=Y.split(A),je=0;je<Oe.length;je++){if(re=Oe[je],z+=re.length,je!==Oe.length-1)z+=A.length;else if(H)return ae();if(!R||re.substring(0,xe)!==R){if(ie){if(be=[],zt(re.split(w)),ge(),G)return ae()}else zt(re.split(w));if(M&&M<=je)return be=be.slice(0,M),ae(!0)}}return ae()}for(var Ee=Y.indexOf(w,z),Re=Y.indexOf(A,z),ot=new RegExp(y(V)+y(j),"g"),ke=Y.indexOf(j,z);;)if(Y[z]===j)for(ke=z,z++;;){if((ke=Y.indexOf(j,ke+1))===-1)return H||ne.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:be.length,index:z}),Kt();if(ke===oe-1)return Kt(Y.substring(z,ke).replace(ot,j));if(j===V&&Y[ke+1]===V)ke++;else if(j===V||ke===0||Y[ke-1]!==V){Ee!==-1&&Ee<ke+1&&(Ee=Y.indexOf(w,ke+1));var qe=tn((Re=Re!==-1&&Re<ke+1?Y.indexOf(A,ke+1):Re)===-1?Ee:Math.min(Ee,Re));if(Y.substr(ke+1+qe,W)===w){re.push(Y.substring(z,ke).replace(ot,j)),Y[z=ke+1+qe+W]!==j&&(ke=Y.indexOf(j,z)),Ee=Y.indexOf(w,z),Re=Y.indexOf(A,z);break}if(qe=tn(Re),Y.substring(ke+1+qe,ke+1+qe+he)===A){if(re.push(Y.substring(z,ke).replace(ot,j)),In(ke+1+qe+he),Ee=Y.indexOf(w,z),ke=Y.indexOf(j,z),ie&&(ge(),G))return ae();if(M&&be.length>=M)return ae(!0);break}ne.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:be.length,index:z}),ke++}}else if(R&&re.length===0&&Y.substring(z,z+xe)===R){if(Re===-1)return ae();z=Re+he,Re=Y.indexOf(A,z),Ee=Y.indexOf(w,z)}else if(Ee!==-1&&(Ee<Re||Re===-1))re.push(Y.substring(z,Ee)),z=Ee+W,Ee=Y.indexOf(w,z);else{if(Re===-1)break;if(re.push(Y.substring(z,Re)),In(Re+he),ie&&(ge(),G))return ae();if(M&&be.length>=M)return ae(!0)}return Kt();function zt(Pe){be.push(Pe),Se=z}function tn(Pe){var Ce=0;return Ce=Pe!==-1&&(Pe=Y.substring(ke+1,Pe))&&Pe.trim()===""?Pe.length:Ce}function Kt(Pe){return H||(Pe===void 0&&(Pe=Y.substring(z)),re.push(Pe),z=oe,zt(re),ie&&ge()),ae()}function In(Pe){z=Pe,zt(re),re=[],Re=Y.indexOf(A,z)}function ae(Pe){if(b.header&&!Z&&be.length&&!D){var Ce=be[0],Le=Object.create(null),Ut=new Set(Ce);let xn=!1;for(let Qt=0;Qt<Ce.length;Qt++){let $t=Ce[Qt];if(Le[$t=N(b.transformHeader)?b.transformHeader($t,Qt):$t]){let Vt,zn=Le[$t];for(;Vt=$t+"_"+zn,zn++,Ut.has(Vt););Ut.add(Vt),Ce[Qt]=Vt,Le[$t]++,xn=!0,(U=U===null?{}:U)[Vt]=$t}else Le[$t]=1,Ce[Qt]=$t;Ut.add($t)}xn&&console.warn("Duplicate headers found and renamed."),D=!0}return{data:be,errors:ne,meta:{delimiter:w,linebreak:A,aborted:G,truncated:!!Pe,cursor:Se+(Z||0),renamedHeaders:U}}}function ge(){L(ae()),be=[],ne=[]}},this.abort=function(){G=!0},this.getCharIndex=function(){return z}}function C(b){var w=b.data,A=l[w.workerId],R=!1;if(w.error)A.userError(w.error,w.file);else if(w.results&&w.results.data){var L={abort:function(){R=!0,T(w.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:k,resume:k};if(N(A.userStep)){for(var M=0;M<w.results.data.length&&(A.userStep({data:w.results.data[M],errors:w.results.errors,meta:w.results.meta},L),!R);M++);delete w.results}else N(A.userChunk)&&(A.userChunk(w.results,L,w.file),delete w.results)}w.finished&&!R&&T(w.workerId,w.results)}function T(b,w){var A=l[b];N(A.userComplete)&&A.userComplete(w),A.terminate(),delete l[b]}function k(){throw new Error("Not implemented.")}function _(b){if(typeof b!="object"||b===null)return b;var w,A=Array.isArray(b)?[]:{};for(w in b)A[w]=_(b[w]);return A}function S(b,w){return function(){b.apply(w,arguments)}}function N(b){return typeof b=="function"}return u.parse=function(b,w){var A=(w=w||{}).dynamicTyping||!1;if(N(A)&&(w.dynamicTypingFunction=A,A={}),w.dynamicTyping=A,w.transform=!!N(w.transform)&&w.transform,!w.worker||!u.WORKERS_SUPPORTED)return A=null,u.NODE_STREAM_INPUT,typeof b=="string"?(b=(R=>R.charCodeAt(0)!==65279?R:R.slice(1))(b),A=new(w.download?f:v)(w)):b.readable===!0&&N(b.read)&&N(b.on)?A=new x(w):(r.File&&b instanceof File||b instanceof Object)&&(A=new g(w)),A.stream(b);(A=(()=>{var R;return!!u.WORKERS_SUPPORTED&&(R=(()=>{var L=r.URL||r.webkitURL||null,M=n.toString();return u.BLOB_URL||(u.BLOB_URL=L.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",M,")();"],{type:"text/javascript"})))})(),(R=new r.Worker(R)).onmessage=C,R.id=c++,l[R.id]=R)})()).userStep=w.step,A.userChunk=w.chunk,A.userComplete=w.complete,A.userError=w.error,w.step=N(w.step),w.chunk=N(w.chunk),w.complete=N(w.complete),w.error=N(w.error),delete w.worker,A.postMessage({input:b,config:w,workerId:A.id})},u.unparse=function(b,w){var A=!1,R=!0,L=",",M=`\r
`,F='"',U=F+F,D=!1,j=null,V=!1,z=((()=>{if(typeof w=="object"){if(typeof w.delimiter!="string"||u.BAD_DELIMITERS.filter(function(Z){return w.delimiter.indexOf(Z)!==-1}).length||(L=w.delimiter),typeof w.quotes!="boolean"&&typeof w.quotes!="function"&&!Array.isArray(w.quotes)||(A=w.quotes),typeof w.skipEmptyLines!="boolean"&&typeof w.skipEmptyLines!="string"||(D=w.skipEmptyLines),typeof w.newline=="string"&&(M=w.newline),typeof w.quoteChar=="string"&&(F=w.quoteChar),typeof w.header=="boolean"&&(R=w.header),Array.isArray(w.columns)){if(w.columns.length===0)throw new Error("Option columns is empty");j=w.columns}w.escapeChar!==void 0&&(U=w.escapeChar+F),w.escapeFormulae instanceof RegExp?V=w.escapeFormulae:typeof w.escapeFormulae=="boolean"&&w.escapeFormulae&&(V=/^[=+\-@\t\r].*$/)}})(),new RegExp(y(F),"g"));if(typeof b=="string"&&(b=JSON.parse(b)),Array.isArray(b)){if(!b.length||Array.isArray(b[0]))return G(null,b,D);if(typeof b[0]=="object")return G(j||Object.keys(b[0]),b,D)}else if(typeof b=="object")return typeof b.data=="string"&&(b.data=JSON.parse(b.data)),Array.isArray(b.data)&&(b.fields||(b.fields=b.meta&&b.meta.fields||j),b.fields||(b.fields=Array.isArray(b.data[0])?b.fields:typeof b.data[0]=="object"?Object.keys(b.data[0]):[]),Array.isArray(b.data[0])||typeof b.data[0]=="object"||(b.data=[b.data])),G(b.fields||[],b.data||[],D);throw new Error("Unable to serialize unrecognized input");function G(Z,H,oe){var W="",he=(typeof Z=="string"&&(Z=JSON.parse(Z)),typeof H=="string"&&(H=JSON.parse(H)),Array.isArray(Z)&&0<Z.length),xe=!Array.isArray(H[0]);if(he&&R){for(var ie=0;ie<Z.length;ie++)0<ie&&(W+=L),W+=Y(Z[ie],ie);0<H.length&&(W+=M)}for(var be=0;be<H.length;be++){var ne=(he?Z:H[be]).length,re=!1,Se=he?Object.keys(H[be]).length===0:H[be].length===0;if(oe&&!he&&(re=oe==="greedy"?H[be].join("").trim()==="":H[be].length===1&&H[be][0].length===0),oe==="greedy"&&he){for(var Oe=[],je=0;je<ne;je++){var Ee=xe?Z[je]:je;Oe.push(H[be][Ee])}re=Oe.join("").trim()===""}if(!re){for(var Re=0;Re<ne;Re++){0<Re&&!Se&&(W+=L);var ot=he&&xe?Z[Re]:Re;W+=Y(H[be][ot],Re)}be<H.length-1&&(!oe||0<ne&&!Se)&&(W+=M)}}return W}function Y(Z,H){var oe,W;return Z==null?"":Z.constructor===Date?JSON.stringify(Z).slice(1,25):(W=!1,V&&typeof Z=="string"&&V.test(Z)&&(Z="'"+Z,W=!0),oe=Z.toString().replace(z,U),(W=W||A===!0||typeof A=="function"&&A(Z,H)||Array.isArray(A)&&A[H]||((he,xe)=>{for(var ie=0;ie<xe.length;ie++)if(-1<he.indexOf(xe[ie]))return!0;return!1})(oe,u.BAD_DELIMITERS)||-1<oe.indexOf(L)||oe.charAt(0)===" "||oe.charAt(oe.length-1)===" ")?F+oe+F:oe)}},u.RECORD_SEP=String.fromCharCode(30),u.UNIT_SEP=String.fromCharCode(31),u.BYTE_ORDER_MARK="\uFEFF",u.BAD_DELIMITERS=["\r",`
`,'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!i&&!!r.Worker,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=h,u.ParserHandle=E,u.NetworkStreamer=f,u.FileStreamer=g,u.StringStreamer=v,u.ReadableStreamStreamer=x,r.jQuery&&((s=r.jQuery).fn.parse=function(b){var w=b.config||{},A=[];return this.each(function(M){if(!(s(this).prop("tagName").toUpperCase()==="INPUT"&&s(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var F=0;F<this.files.length;F++)A.push({file:this.files[F],inputElem:this,instanceConfig:s.extend({},w)})}),R(),this;function R(){if(A.length===0)N(b.complete)&&b.complete();else{var M,F,U,D,j=A[0];if(N(b.before)){var V=b.before(j.file,j.inputElem);if(typeof V=="object"){if(V.action==="abort")return M="AbortError",F=j.file,U=j.inputElem,D=V.reason,void(N(b.error)&&b.error({name:M},F,U,D));if(V.action==="skip")return void L();typeof V.config=="object"&&(j.instanceConfig=s.extend(j.instanceConfig,V.config))}else if(V==="skip")return void L()}var z=j.instanceConfig.complete;j.instanceConfig.complete=function(G){N(z)&&z(G,j.file,j.inputElem),L()},u.parse(j.file,j.instanceConfig)}}function L(){A.splice(0,1),R()}}),o&&(r.onmessage=function(b){b=b.data,u.WORKER_ID===void 0&&b&&(u.WORKER_ID=b.workerId),typeof b.input=="string"?r.postMessage({workerId:u.WORKER_ID,results:u.parse(b.input,b.config),finished:!0}):(r.File&&b.input instanceof File||b.input instanceof Object)&&(b=u.parse(b.input,b.config))&&r.postMessage({workerId:u.WORKER_ID,results:b,finished:!0})}),(f.prototype=Object.create(d.prototype)).constructor=f,(g.prototype=Object.create(d.prototype)).constructor=g,(v.prototype=Object.create(v.prototype)).constructor=v,(x.prototype=Object.create(d.prototype)).constructor=x,u})})(FT);var x7=FT.exports;const w7=()=>{const{user:t,rol:e}=Qe(),[n,r]=p.useState([]),[s,i]=p.useState([]),[o,l]=p.useState(!1),[c,u]=p.useState(0),d=["nombre","direccion","ciudad","region","telefono","email","web","categoria","descripcion","coordenadas_lat","coordenadas_lng"],f=p.useCallback(C=>{const T=C[0];T&&x7.parse(T,{header:!0,complete:k=>{console.log("CSV parsed:",k.data),r(k.data),g(k.data)},error:k=>{console.error("Error parsing CSV:",k)}})},[]),g=C=>{const T=C.map((k,_)=>{var b,w,A,R;const S=[],N=[];return(b=k.nombre)!=null&&b.trim()||S.push("Nombre es obligatorio"),(w=k.direccion)!=null&&w.trim()||S.push("Dirección es obligatoria"),(A=k.telefono)!=null&&A.trim()||N.push("Teléfono recomendado"),(R=k.web)!=null&&R.trim()||N.push("Sitio web recomendado"),k.email&&!/\S+@\S+\.\S+/.test(k.email)&&S.push("Formato de email inválido"),k.web&&!k.web.startsWith("http")&&N.push("URL debe empezar con http:// o https://"),{index:_,data:k,isValid:S.length===0,errors:S,warnings:N}});i(T)},v=async()=>{if(e!=="admin"){alert("Solo administradores pueden realizar carga masiva");return}l(!0),u(0);try{const C=s.filter(k=>k.isValid),T=500;for(let k=0;k<C.length;k+=T){const _=fk($),S=C.slice(k,k+T);S.forEach(N=>{const b=we(Q($,"empresas")),w={...N.data,zona:"AV10_JULIO",calles:x(N.data.direccion),estado:"Enviada",origen:"catastro_masivo",fechaCreacion:qn(),fechaActualizacion:qn(),webValidada:!1,logoAsignado:!1,visitaAgente:!1,agenteAsignado:null,fechaVisita:null,creadoPor:t.uid,loteImportacion:`catastro_${new Date().getTime()}`,ubicacion:N.data.coordenadas_lat&&N.data.coordenadas_lng?{lat:parseFloat(N.data.coordenadas_lat),lng:parseFloat(N.data.coordenadas_lng)}:null};_.set(b,w)}),await _.commit(),u((k+S.length)/C.length*100)}alert(`✅ Catastro completado: ${C.length} empresas cargadas`),r([]),i([])}catch(C){console.error("Error en carga masiva:",C),alert("Error durante la carga masiva")}finally{l(!1),u(0)}},x=C=>["Avenida Matta","Santa Isabel","Vicuña Mackenna","Autopista Central","Av. Matta"].filter(k=>C.toLowerCase().includes(k.toLowerCase())),{getRootProps:E,getInputProps:y,isDragActive:h}=Lb({onDrop:f,accept:{"text/csv":[".csv"],"application/vnd.ms-excel":[".csv"]},multiple:!1});return e!=="admin"?a.createElement("div",{className:"text-center p-8"},a.createElement("p",{className:"text-red-600"},"Solo administradores pueden acceder al catastro masivo"),a.createElement("p",{className:"text-gray-500 mt-2"},"Tu rol actual: ",e||"Sin rol")):a.createElement("div",{className:"max-w-6xl mx-auto p-6"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg"},a.createElement("div",{className:"p-6 border-b"},a.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"📊 Catastro Masivo - Zona AV10 de Julio"),a.createElement("p",{className:"text-gray-600 mt-2"},"Cargar empresas desde CSV - Área: Av. Matta, Santa Isabel, Vicuña Mackenna, Autopista Central")),a.createElement("div",{className:"p-6"},a.createElement("div",{...E(),className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${h?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-400"}`},a.createElement("input",{...y()}),a.createElement("div",{className:"text-4xl mb-4"},"📄"),h?a.createElement("p",{className:"text-blue-600"},"Suelta el archivo CSV aquí..."):a.createElement("div",null,a.createElement("p",{className:"text-gray-700 font-medium"},"Arrastra un archivo CSV o haz clic para seleccionar"),a.createElement("p",{className:"text-sm text-gray-500 mt-2"},"Columnas esperadas: ",d.join(", ")))),a.createElement("div",{className:"mt-4 text-center"},a.createElement("button",{className:"text-blue-600 hover:text-blue-800 underline text-sm"},"📥 Descargar plantilla CSV"))),s.length>0&&a.createElement("div",{className:"p-6 border-t"},a.createElement("h3",{className:"text-lg font-semibold mb-4"},"📋 Resultados de Validación"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},a.createElement("div",{className:"bg-green-50 p-4 rounded-lg text-center"},a.createElement("div",{className:"text-2xl font-bold text-green-600"},s.filter(C=>C.isValid).length),a.createElement("div",{className:"text-sm text-green-800"},"Registros Válidos")),a.createElement("div",{className:"bg-red-50 p-4 rounded-lg text-center"},a.createElement("div",{className:"text-2xl font-bold text-red-600"},s.filter(C=>!C.isValid).length),a.createElement("div",{className:"text-sm text-red-800"},"Con Errores")),a.createElement("div",{className:"bg-yellow-50 p-4 rounded-lg text-center"},a.createElement("div",{className:"text-2xl font-bold text-yellow-600"},s.filter(C=>C.warnings.length>0).length),a.createElement("div",{className:"text-sm text-yellow-800"},"Con Advertencias"))),s.some(C=>!C.isValid)&&a.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4"},a.createElement("h4",{className:"font-semibold text-red-900 mb-2"},"❌ Registros con Errores:"),a.createElement("div",{className:"max-h-40 overflow-y-auto"},s.filter(C=>!C.isValid).slice(0,10).map((C,T)=>a.createElement("div",{key:T,className:"text-sm text-red-800 mb-1"},"Fila ",C.index+2,": ",C.errors.join(", "))))),a.createElement("div",{className:"flex justify-between items-center"},a.createElement("button",{onClick:()=>{r([]),i([])},className:"text-gray-600 hover:text-gray-800"},"🗑️ Limpiar datos"),a.createElement("button",{onClick:v,disabled:o||s.filter(C=>C.isValid).length===0,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"},o?"Procesando...":`✅ Cargar ${s.filter(C=>C.isValid).length} empresas`)),o&&a.createElement("div",{className:"mt-4"},a.createElement("div",{className:"bg-gray-200 rounded-full h-2"},a.createElement("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${c}%`}})),a.createElement("p",{className:"text-center text-sm text-gray-600 mt-2"},c.toFixed(0),"% completado")))))};function Zg(t,e={}){const[n,r]=p.useState([]),[s,i]=p.useState(!0),[o,l]=p.useState(null),{where:c,orderBy:u,limit:d,realtime:f=!0}=e;p.useEffect(()=>{let E;const y=()=>{let h=Q($,t);return c&&(h=pe(h,fe(...c))),u&&(h=pe(h,Et(...u))),d&&(h=pe(h,jo(d))),h};return f?E=Dt(y(),h=>{const C=h.docs.map(T=>({id:T.id,...T.data()}));r(C),i(!1)},h=>{l(h),i(!1)}):ue(y()).then(h=>{const C=h.docs.map(T=>({id:T.id,...T.data()}));r(C),i(!1)}).catch(h=>{l(h),i(!1)}),()=>{E&&E()}},[t,JSON.stringify(e)]);const g=p.useCallback(async E=>{try{return(await ze(Q($,t),{...E,fechaCreacion:new Date,fechaActualizacion:new Date})).id}catch(y){throw new Error(`Error adding document: ${y.message}`)}},[t]),v=p.useCallback(async(E,y)=>{try{await Me(we($,t,E),{...y,fechaActualizacion:new Date})}catch(h){throw new Error(`Error updating document: ${h.message}`)}},[t]),x=p.useCallback(async E=>{try{await ws(we($,t,E))}catch(y){throw new Error(`Error deleting document: ${y.message}`)}},[t]);return{data:n,loading:s,error:o,add:g,update:v,remove:x,refetch:()=>i(!0)}}const et={ENVIADA:"Enviada",EN_REVISION:"En Revisión",ACTIVA:"Activa",RECHAZADA:"Rechazada",SUSPENDIDA:"Suspendida",VISITADA:"Visitada"},bN={[et.ENVIADA]:[et.EN_REVISION,et.RECHAZADA,et.VISITADA],[et.EN_REVISION]:[et.ACTIVA,et.RECHAZADA,et.VISITADA],[et.VISITADA]:[et.EN_REVISION,et.ACTIVA,et.RECHAZADA],[et.ACTIVA]:[et.SUSPENDIDA],[et.SUSPENDIDA]:[et.ACTIVA,et.RECHAZADA],[et.RECHAZADA]:[]};class yN{static puedeTransicionar(e,n){return(bN[e]||[]).includes(n)}static obtenerSiguientesPasos(e){return bN[e]||[]}static validarRequisitosActivacion(e){const n={webValidada:e.webValidada===!0,logoAsignado:e.logoAsignado===!0,informacionCompleta:!!(e.nombre&&e.direccion&&e.telefono),sinConflictos:!e.flagConflicto};return{puedeActivar:Object.values(n).every(Boolean),requisitos:n,faltantes:Object.entries(n).filter(([s,i])=>!i).map(([s])=>s)}}static generarRazonCambioEstado(e,n,r=""){const s={[`${et.ENVIADA}-${et.EN_REVISION}`]:"Empresa pasó a revisión manual",[`${et.EN_REVISION}-${et.ACTIVA}`]:"Validación completada exitosamente",[`${et.VISITADA}-${et.ACTIVA}`]:"Visita de agente completada y validada",[`${et.ACTIVA}-${et.SUSPENDIDA}`]:"Empresa suspendida por administrador"},i=`${e}-${n}`;return s[i]||r||`Cambio de ${e} a ${n}`}}function _7(){const[t,e]=p.useState(!1),n=async(o,l,c="",u={})=>{e(!0);try{const d={estado:l,fechaActualizacion:new Date,ultimoCambioEstado:{fecha:new Date,nuevoEstado:l,motivo:c,...u},...u};switch(l){case et.ACTIVA:d.fechaActivacion=new Date,d.visible=!0;break;case et.RECHAZADA:d.fechaRechazo=new Date,d.visible=!1;break;case et.SUSPENDIDA:d.fechaSuspension=new Date,d.visible=!1;break;case et.VISITADA:d.visitaAgente=!0,d.fechaVisita=new Date;break}return await Me(we($,"empresas",o),d),{success:!0}}catch(d){return console.error("Error cambiando estado:",d),{success:!1,error:d.message}}finally{e(!1)}};return{cambiarEstado:n,marcarVisitaAgente:async(o,l)=>await n(o,et.VISITADA,"Visita realizada por agente de campo",{visitaAgente:!0,datosVisita:{...l,fecha:new Date}}),validarWeb:async(o,l)=>{e(!0);try{const c={webValidada:l.existe&&l.respondiendo,validacionWeb:l,fechaActualizacion:new Date};return await Me(we($,"empresas",o),c),{success:!0}}catch(c){return console.error("Error validando web:",c),{success:!1,error:c.message}}finally{e(!1)}},asignarLogo:async(o,l)=>{e(!0);try{const c={logoUrl:l,logoAsignado:!0,fechaActualizacion:new Date};return await Me(we($,"empresas",o),c),{success:!0}}catch(c){return console.error("Error asignando logo:",c),{success:!1,error:c.message}}finally{e(!1)}},loading:t,validarRequisitos:yN.validarRequisitosActivacion,obtenerSiguientesPasos:yN.obtenerSiguientesPasos}}const N7=()=>{const{rol:t}=Qe(),[e,n]=p.useState("Enviada"),[r,s]=p.useState(null),[i,o]=p.useState(!1),{cambiarEstado:l,validarWeb:c,asignarLogo:u,loading:d}=_7(),{data:f,loading:g}=Zg("empresas",{where:["estado","==",e],orderBy:["fechaCreacion","desc"]}),v=async h=>{o(!0);try{return{existe:!0,respondiendo:(await fetch("https://httpbin.org/delay/1")).ok,tiempoRespuesta:1200,titulo:"Sitio web de empresa",descripcion:"Descripción del sitio",esComercial:!0}}catch(C){return console.error("Error validando sitio web:",C),{existe:!1,error:C.message}}finally{o(!1)}},x=async(h,C)=>{try{return await new Promise(T=>setTimeout(T,1e3)),`https://via.placeholder.com/150x150?text=${encodeURIComponent(h.substring(0,2))}`}catch(T){return console.error("Error buscando logo:",T),null}},E=async(h,C)=>{try{switch(C){case"validar_web":if(h.web){const _=await v(h.web);await c(h.id,_)}break;case"asignar_logo":const T=await x(h.nombre,h.web);T&&await u(h.id,T);break;case"activar":await l(h.id,"Activa","Activación manual por administrador");break;case"rechazar":const k=prompt("Motivo de rechazo:");k&&await l(h.id,"Rechazada",k);break;case"revisar":await l(h.id,"En Revisión","Marcada para revisión manual");break}s(null)}catch(T){console.error("Error procesando empresa:",T),alert("Error al procesar la empresa")}},y=({empresa:h})=>{var C,T,k;return a.createElement("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow"},a.createElement("div",{className:"flex justify-between items-start mb-3"},a.createElement("div",null,a.createElement("h3",{className:"font-semibold text-gray-900"},h.nombre),a.createElement("p",{className:"text-sm text-gray-600"},h.direccion),a.createElement("p",{className:"text-xs text-gray-500"},"Zona: ",h.zona," | Creado: ",((k=(T=(C=h.fechaCreacion)==null?void 0:C.toDate)==null?void 0:T.call(C))==null?void 0:k.toLocaleDateString())||"N/A")),a.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${h.estado==="Enviada"?"bg-yellow-100 text-yellow-800":h.estado==="En Revisión"?"bg-blue-100 text-blue-800":h.estado==="Activa"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},h.estado)),a.createElement("div",{className:"flex space-x-3 mb-3 text-xs"},a.createElement("span",{className:`flex items-center ${h.webValidada?"text-green-600":"text-gray-400"}`},h.webValidada?"✅":"❓"," Web"),a.createElement("span",{className:`flex items-center ${h.logoAsignado?"text-green-600":"text-gray-400"}`},h.logoAsignado?"✅":"❓"," Logo"),a.createElement("span",{className:`flex items-center ${h.visitaAgente?"text-green-600":"text-gray-400"}`},h.visitaAgente?"✅":"❓"," Visita")),a.createElement("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600 mb-3"},a.createElement("div",null,"📞 ",h.telefono||"No disponible"),a.createElement("div",null,"✉️ ",h.email||"No disponible"),a.createElement("div",null,"🌐 ",h.web?a.createElement("a",{href:h.web,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},h.web.length>30?h.web.substring(0,30)+"...":h.web):"No disponible"),a.createElement("div",null,"🏷️ ",h.categoria||"Sin categoría")),a.createElement("div",{className:"flex flex-wrap gap-2"},a.createElement("button",{onClick:()=>s(h),className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded hover:bg-blue-200"},"👁️ Ver detalles"),!h.webValidada&&h.web&&a.createElement("button",{onClick:()=>E(h,"validar_web"),disabled:i||d,className:"text-xs bg-yellow-100 text-yellow-700 px-2 py-1 rounded hover:bg-yellow-200 disabled:opacity-50"},"🔍 Validar web"),!h.logoAsignado&&a.createElement("button",{onClick:()=>E(h,"asignar_logo"),disabled:d,className:"text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded hover:bg-purple-200 disabled:opacity-50"},"🖼️ Buscar logo"),h.webValidada&&h.logoAsignado&&h.estado==="Enviada"&&a.createElement("button",{onClick:()=>E(h,"activar"),disabled:d,className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded hover:bg-green-200 disabled:opacity-50"},"✅ Activar"),a.createElement("button",{onClick:()=>E(h,"rechazar"),disabled:d,className:"text-xs bg-red-100 text-red-700 px-2 py-1 rounded hover:bg-red-200 disabled:opacity-50"},"❌ Rechazar")))};return t!=="admin"?a.createElement("div",{className:"text-center p-8"},a.createElement("p",{className:"text-red-600"},"Solo administradores pueden acceder al panel de validación"),a.createElement("p",{className:"text-gray-500 mt-2"},"Tu rol actual: ",t||"Sin rol")):a.createElement("div",{className:"max-w-7xl mx-auto p-6"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg"},a.createElement("div",{className:"p-6 border-b"},a.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"🔍 Panel de Validación - Catastro AV10 de Julio"),a.createElement("p",{className:"text-gray-600 mt-2"},"Validación y activación de empresas del catastro masivo")),a.createElement("div",{className:"p-6 border-b bg-gray-50"},a.createElement("div",{className:"flex flex-wrap gap-4 items-center"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Estado:"),a.createElement("select",{value:e,onChange:h=>n(h.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm"},a.createElement("option",{value:"Enviada"},"Enviadas"),a.createElement("option",{value:"En Revisión"},"En Revisión"),a.createElement("option",{value:"Activa"},"Activas"),a.createElement("option",{value:"Rechazada"},"Rechazadas"))),a.createElement("div",{className:"flex-1"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm"},a.createElement("div",{className:"bg-yellow-50 p-3 rounded text-center"},a.createElement("div",{className:"font-bold text-yellow-600"},(f==null?void 0:f.filter(h=>h.estado==="Enviada").length)||0),a.createElement("div",{className:"text-yellow-800"},"Pendientes")),a.createElement("div",{className:"bg-blue-50 p-3 rounded text-center"},a.createElement("div",{className:"font-bold text-blue-600"},(f==null?void 0:f.filter(h=>h.estado==="En Revisión").length)||0),a.createElement("div",{className:"text-blue-800"},"En Revisión")),a.createElement("div",{className:"bg-green-50 p-3 rounded text-center"},a.createElement("div",{className:"font-bold text-green-600"},(f==null?void 0:f.filter(h=>h.estado==="Activa").length)||0),a.createElement("div",{className:"text-green-800"},"Activadas")),a.createElement("div",{className:"bg-red-50 p-3 rounded text-center"},a.createElement("div",{className:"font-bold text-red-600"},(f==null?void 0:f.filter(h=>h.estado==="Rechazada").length)||0),a.createElement("div",{className:"text-red-800"},"Rechazadas")))))),a.createElement("div",{className:"p-6"},g?a.createElement("div",{className:"text-center py-8"},a.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),a.createElement("p",{className:"mt-2 text-gray-600"},"Cargando empresas...")):(f==null?void 0:f.length)>0?a.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4"},f.map(h=>a.createElement(y,{key:h.id,empresa:h}))):a.createElement("div",{className:"text-center py-8 text-gray-500"},'No hay empresas con estado "',e,'"'))),r&&a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},a.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},a.createElement("div",{className:"p-6"},a.createElement("div",{className:"flex justify-between items-start mb-4"},a.createElement("h2",{className:"text-xl font-bold text-gray-900"},r.nombre),a.createElement("button",{onClick:()=>s(null),className:"text-gray-400 hover:text-gray-600"},"✕")),a.createElement("div",{className:"space-y-4"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},a.createElement("div",null,a.createElement("strong",null,"Dirección:")," ",r.direccion),a.createElement("div",null,a.createElement("strong",null,"Ciudad:")," ",r.ciudad),a.createElement("div",null,a.createElement("strong",null,"Región:")," ",r.region),a.createElement("div",null,a.createElement("strong",null,"Teléfono:")," ",r.telefono),a.createElement("div",null,a.createElement("strong",null,"Email:")," ",r.email),a.createElement("div",null,a.createElement("strong",null,"Sitio Web:"),r.web&&a.createElement("a",{href:r.web,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline ml-1"},r.web))),r.descripcion&&a.createElement("div",null,a.createElement("strong",null,"Descripción:"),a.createElement("p",{className:"mt-1 text-gray-700"},r.descripcion)),r.validacionWeb&&a.createElement("div",{className:"bg-gray-50 p-4 rounded-lg"},a.createElement("strong",null,"Validación Web:"),a.createElement("div",{className:"mt-2 text-sm"},a.createElement("div",null,"✅ Existe: ",r.validacionWeb.existe?"Sí":"No"),a.createElement("div",null,"⚡ Respondiendo: ",r.validacionWeb.respondiendo?"Sí":"No"),r.validacionWeb.titulo&&a.createElement("div",null,"📄 Título: ",r.validacionWeb.titulo))))))))},C7=()=>{const{user:t,rol:e}=Qe(),[n,r]=p.useState(!1),[s,i]=p.useState(null),[o,l]=p.useState({nombre:"",email:"",telefono:"",zona:"",activo:!0}),{data:c,loading:u}=Zg("agentes",{orderBy:["fechaCreacion","desc"]}),{data:d}=Zg("empresas",{where:["agenteAsignado","!=",null]}),f=["AV10_JULIO_NORTE","AV10_JULIO_SUR","AV10_JULIO_CENTRO","MATTA_ORIENTE","MATTA_PONIENTE","SANTA_ISABEL_NORTE","SANTA_ISABEL_SUR","VICUNA_MACKENNA_NORTE","VICUNA_MACKENNA_SUR","AUTOPISTA_CENTRAL"],g=async E=>{E.preventDefault();try{const y=await ze(Q($,"agentes"),{...o,fechaCreacion:new Date,empresasAsignadas:0,visitasRealizadas:0,empresasActivadas:0});await ze(Q($,"usuarios"),{email:o.email,nombre:o.nombre,rol:"agente",agenteId:y.id,telefono:o.telefono,zona:o.zona,activo:o.activo,fechaCreacion:new Date,creadoPorAdmin:!0}),l({nombre:"",email:"",telefono:"",zona:"",activo:!0}),r(!1),alert("Agente creado exitosamente. El agente podrá hacer login con su email.")}catch(y){console.error("Error creando agente:",y),alert("Error al crear agente: "+y.message)}},v=async(E,y)=>{try{const h=await ue(pe(Q($,"empresas"),fe("agenteAsignado","==",null),fe("zona","==","AV10_JULIO"),fe("estado","in",["Enviada","En Revisión"])));if(h.docs.length===0){alert("No hay empresas disponibles para asignar en esta zona");return}const C=fk($);h.docs.forEach(T=>{C.update(T.ref,{agenteAsignado:E,fechaAsignacion:new Date})}),await C.commit(),await Me(we($,"agentes",E),{empresasAsignadas:h.docs.length}),alert(`${h.docs.length} empresas asignadas al agente`)}catch(h){console.error("Error asignando empresas:",h),alert("Error al asignar empresas")}},x=({agente:E})=>{var T;const y=(d==null?void 0:d.filter(k=>k.agenteAsignado===E.id))||[],h=y.filter(k=>k.visitaAgente).length,C=y.filter(k=>k.estado==="Activa").length;return a.createElement("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow"},a.createElement("div",{className:"flex justify-between items-start mb-4"},a.createElement("div",null,a.createElement("h3",{className:"text-lg font-semibold text-gray-900"},E.nombre),a.createElement("p",{className:"text-sm text-gray-600"},E.email),a.createElement("p",{className:"text-sm text-gray-600"},E.telefono)),a.createElement("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${E.activo?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},E.activo?"Activo":"Inactivo")),a.createElement("div",{className:"mb-4"},a.createElement("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded"},"Zona: ",(T=E.zona)==null?void 0:T.replace(/_/g," "))),a.createElement("div",{className:"grid grid-cols-3 gap-4 mb-4"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-xl font-bold text-blue-600"},y.length),a.createElement("div",{className:"text-xs text-gray-600"},"Asignadas")),a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-xl font-bold text-green-600"},h),a.createElement("div",{className:"text-xs text-gray-600"},"Visitadas")),a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-xl font-bold text-purple-600"},C),a.createElement("div",{className:"text-xs text-gray-600"},"Activadas"))),a.createElement("div",{className:"mb-4"},a.createElement("div",{className:"flex justify-between text-xs text-gray-600 mb-1"},a.createElement("span",null,"Progreso de visitas"),a.createElement("span",null,y.length>0?Math.round(h/y.length*100):0,"%")),a.createElement("div",{className:"w-full bg-gray-200 rounded-full h-2"},a.createElement("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${y.length>0?h/y.length*100:0}%`}}))),a.createElement("div",{className:"flex flex-wrap gap-2"},a.createElement("button",{onClick:()=>i(E),className:"text-xs bg-blue-100 text-blue-700 px-3 py-1 rounded hover:bg-blue-200"},"👁️ Ver empresas"),a.createElement("button",{onClick:()=>v(E.id,E.zona),className:"text-xs bg-green-100 text-green-700 px-3 py-1 rounded hover:bg-green-200"},"📋 Asignar empresas"),a.createElement("button",{className:"text-xs bg-purple-100 text-purple-700 px-3 py-1 rounded hover:bg-purple-200"},"📊 Ver reportes")))};return e!=="admin"?a.createElement("div",{className:"text-center p-8"},a.createElement("p",{className:"text-red-600"},"Solo administradores pueden acceder a la gestión de agentes"),a.createElement("p",{className:"text-gray-500 mt-2"},"Tu rol actual: ",e||"Sin rol")):a.createElement("div",{className:"max-w-7xl mx-auto p-6"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg"},a.createElement("div",{className:"p-6 border-b"},a.createElement("div",{className:"flex justify-between items-center"},a.createElement("div",null,a.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"👥 Gestión de Agentes de Campo"),a.createElement("p",{className:"text-gray-600 mt-2"},"Administración de agentes y asignación de territorios AV10 de Julio")),a.createElement("button",{onClick:()=>r(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700"},"➕ Nuevo Agente"))),a.createElement("div",{className:"p-6 border-b bg-gray-50"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4"},a.createElement("div",{className:"bg-white p-4 rounded-lg text-center"},a.createElement("div",{className:"text-2xl font-bold text-blue-600"},(c==null?void 0:c.length)||0),a.createElement("div",{className:"text-sm text-gray-600"},"Agentes Totales")),a.createElement("div",{className:"bg-white p-4 rounded-lg text-center"},a.createElement("div",{className:"text-2xl font-bold text-green-600"},(c==null?void 0:c.filter(E=>E.activo).length)||0),a.createElement("div",{className:"text-sm text-gray-600"},"Agentes Activos")),a.createElement("div",{className:"bg-white p-4 rounded-lg text-center"},a.createElement("div",{className:"text-2xl font-bold text-purple-600"},(d==null?void 0:d.length)||0),a.createElement("div",{className:"text-sm text-gray-600"},"Empresas Asignadas")),a.createElement("div",{className:"bg-white p-4 rounded-lg text-center"},a.createElement("div",{className:"text-2xl font-bold text-orange-600"},(d==null?void 0:d.filter(E=>E.visitaAgente).length)||0),a.createElement("div",{className:"text-sm text-gray-600"},"Visitas Realizadas")))),a.createElement("div",{className:"p-6"},u?a.createElement("div",{className:"text-center py-8"},a.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),a.createElement("p",{className:"mt-2 text-gray-600"},"Cargando agentes...")):(c==null?void 0:c.length)>0?a.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6"},c.map(E=>a.createElement(x,{key:E.id,agente:E}))):a.createElement("div",{className:"text-center py-8 text-gray-500"},"No hay agentes registrados"))),n&&a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},a.createElement("div",{className:"bg-white rounded-lg max-w-md w-full"},a.createElement("form",{onSubmit:g,className:"p-6"},a.createElement("h2",{className:"text-xl font-bold text-gray-900 mb-4"},"Nuevo Agente de Campo"),a.createElement("div",{className:"space-y-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Nombre completo"),a.createElement("input",{type:"text",required:!0,value:o.nombre,onChange:E=>l({...o,nombre:E.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Email"),a.createElement("input",{type:"email",required:!0,value:o.email,onChange:E=>l({...o,email:E.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Teléfono"),a.createElement("input",{type:"tel",required:!0,value:o.telefono,onChange:E=>l({...o,telefono:E.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Zona asignada"),a.createElement("select",{required:!0,value:o.zona,onChange:E=>l({...o,zona:E.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2"},a.createElement("option",{value:""},"Seleccionar zona"),f.map(E=>a.createElement("option",{key:E,value:E},E.replace(/_/g," ")))))),a.createElement("div",{className:"flex justify-end space-x-3 mt-6"},a.createElement("button",{type:"button",onClick:()=>r(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"},"Cancelar"),a.createElement("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"},"Crear Agente"))))),s&&a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"},a.createElement("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto"},a.createElement("div",{className:"p-6"},a.createElement("div",{className:"flex justify-between items-start mb-4"},a.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Empresas - ",s.nombre),a.createElement("button",{onClick:()=>i(null),className:"text-gray-400 hover:text-gray-600"},"✕")),a.createElement("div",{className:"space-y-3"},d==null?void 0:d.filter(E=>E.agenteAsignado===s.id).map(E=>a.createElement("div",{key:E.id,className:"border border-gray-200 rounded-lg p-4"},a.createElement("div",{className:"flex justify-between items-start"},a.createElement("div",null,a.createElement("h3",{className:"font-medium text-gray-900"},E.nombre),a.createElement("p",{className:"text-sm text-gray-600"},E.direccion)),a.createElement("div",{className:"flex space-x-2"},a.createElement("span",{className:`px-2 py-1 rounded text-xs ${E.visitaAgente?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`},E.visitaAgente?"✅ Visitada":"⏰ Pendiente"),a.createElement("span",{className:`px-2 py-1 rounded text-xs ${E.estado==="Activa"?"bg-green-100 text-green-800":E.estado==="En Revisión"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`},E.estado))))))))))};function S7(){const{user:t}=Qe(),[e,n]=p.useState([]),[r,s]=p.useState(!0),[i,o]=p.useState(!1),[l,c]=p.useState(null),[u,d]=p.useState({nombre:"",email:"",telefono:"",zona_asignada:"",password:"",generar_password:!1,enviar_email:!1,activo:!0}),[f,g]=p.useState(!1),[v,x]=p.useState(!1),[E,y]=p.useState(null),[h,C]=p.useState("");p.useEffect(()=>{T()},[]);const T=async()=>{try{s(!0);const D=pe(Q($,"agentes"),Et("nombre")),V=(await ue(D)).docs.map(z=>({id:z.id,...z.data()}));n(V)}catch(D){console.error("Error cargando agentes:",D)}finally{s(!1)}},k=()=>{const D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#$%&";let j="";for(let V=0;V<12;V++)j+=D.charAt(Math.floor(Math.random()*D.length));return j},_=()=>{const D=k();d(j=>({...j,password:D,generar_password:!0}))},S=(D=null)=>{D?(c(D),d({nombre:D.nombre||"",email:D.email||"",telefono:D.telefono||"",zona_asignada:D.zona_asignada||"",password:"",generar_password:!1,enviar_email:!1,activo:D.activo!==!1})):(c(null),d({nombre:"",email:"",telefono:"",zona_asignada:"",password:"",generar_password:!1,enviar_email:!1,activo:!0})),o(!0)},N=()=>{o(!1),c(null),d({nombre:"",email:"",telefono:"",zona_asignada:"",password:"",generar_password:!1,enviar_email:!1,activo:!0})},b=async D=>{if(D.preventDefault(),!u.nombre||!u.email||!l&&!u.password){alert("Por favor, completa todos los campos requeridos. La contraseña es obligatoria para nuevos agentes.");return}if(!l&&u.password.length<6){alert("La contraseña debe tener al menos 6 caracteres");return}try{if(g(!0),l){const j={nombre:u.nombre,telefono:u.telefono,zona_asignada:u.zona_asignada,activo:u.activo,fecha_actualizacion:new Date,admin_responsable:t==null?void 0:t.email};await Me(we($,"agentes",l.id),j),alert("Agente actualizado exitosamente")}else{const j={nombre:u.nombre,email:u.email,telefono:u.telefono,zona_asignada:u.zona_asignada,rol:"agente",activo:u.activo,fecha_creacion:new Date,admin_creador:t==null?void 0:t.email,password_temporal:u.password,requiere_registro:!0,permisos:{crear_solicitudes:!0,activar_empresas:!0,gestionar_perfil:!0}},V=await ze(Q($,"agentes"),j);await ze(Q($,"usuarios"),{email:u.email,nombre:u.nombre,rol:"agente",estado:"pendiente_registro",fecha_creacion:new Date,agente_id:V.id}),alert(`✅ Agente creado exitosamente!

📋 CREDENCIALES PARA EL AGENTE:
👤 Email: ${u.email}
🔑 Contraseña: ${u.password}

⚠️ INSTRUCCIONES:
• Envía estas credenciales al agente
• El agente debe registrarse en la plataforma con estos datos
• Una vez registrado, podrá acceder a su panel`)}await T(),N()}catch(j){console.error("Error guardando agente:",j),j.code==="auth/email-already-in-use"?alert("Este email ya está registrado en el sistema"):j.code==="auth/weak-password"?alert("La contraseña debe tener al menos 6 caracteres"):alert("Error al guardar el agente: "+j.message)}finally{g(!1)}},w=async D=>{try{await Me(we($,"agentes",D.id),{activo:!D.activo,fecha_actualizacion:new Date}),await T(),alert(`Agente ${D.activo?"desactivado":"activado"} exitosamente`)}catch(j){console.error("Error cambiando estado del agente:",j),alert("Error al cambiar el estado del agente")}},A=async D=>{if(window.confirm(`¿Estás seguro de eliminar al agente ${D.nombre}? Esta acción no se puede deshacer.`))try{await ws(we($,"agentes",D.id)),await T(),alert("Agente eliminado exitosamente")}catch(j){console.error("Error eliminando agente:",j),alert("Error al eliminar el agente")}},R=D=>{y(D),C(""),x(!0)},L=()=>{x(!1),y(null),C("")},M=()=>{const D=k();C(D)},F=async()=>{if(!h||h.length<6){alert("La nueva clave debe tener al menos 6 caracteres");return}try{g(!0),await Me(we($,"agentes",E.id),{password_temporal:h,ultima_actualizacion_clave:new Date,admin_que_cambio_clave:t==null?void 0:t.email,requiere_cambio_clave:!0}),alert(`✅ Nueva contraseña temporal asignada para ${E.nombre}:

📧 Email: ${E.email}
🔑 Nueva contraseña: ${h}

⚠️ IMPORTANTE:
• El agente debe usar esta nueva contraseña en su próximo acceso
• Si ya está registrado, debe cambiar su contraseña desde su perfil
• Si no está registrado, debe usar /registro-agente con estas credenciales`),await T(),L()}catch(D){console.error("Error cambiando clave:",D),alert("Error al cambiar la clave del agente")}finally{g(!1)}},U={total:e.length,activos:e.filter(D=>D.activo!==!1).length,inactivos:e.filter(D=>D.activo===!1).length};return r?a.createElement("div",{className:"flex items-center justify-center p-8"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.createElement("p",{className:"text-gray-600"},"Cargando agentes..."))):a.createElement("div",{className:"p-6"},a.createElement("div",{className:"mb-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Gestión de Agentes de Campo"),a.createElement("p",{className:"text-gray-600"},"Administra los agentes que pueden crear solicitudes y activar empresas en terreno")),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center"},a.createElement("div",{className:"text-2xl font-bold text-blue-800"},U.total),a.createElement("div",{className:"text-blue-600 text-sm"},"Total Agentes")),a.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center"},a.createElement("div",{className:"text-2xl font-bold text-green-800"},U.activos),a.createElement("div",{className:"text-green-600 text-sm"},"Agentes Activos")),a.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center"},a.createElement("div",{className:"text-2xl font-bold text-red-800"},U.inactivos),a.createElement("div",{className:"text-red-600 text-sm"},"Agentes Inactivos"))),a.createElement("div",{className:"mb-6"},a.createElement("button",{onClick:()=>S(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},"➕ Agregar Nuevo Agente")),a.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},a.createElement("div",{className:"overflow-x-auto"},a.createElement("table",{className:"min-w-full"},a.createElement("thead",{className:"bg-gray-50"},a.createElement("tr",null,a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Agente"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Contacto"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Zona Asignada"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Estado"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Fecha Creación"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Acciones"))),a.createElement("tbody",{className:"divide-y divide-gray-200"},e.map(D=>{var j,V,z;return a.createElement("tr",{key:D.id,className:"hover:bg-gray-50"},a.createElement("td",{className:"px-6 py-4"},a.createElement("div",null,a.createElement("div",{className:"font-medium text-gray-900"},D.nombre),a.createElement("div",{className:"text-sm text-gray-500"},"ID: ",D.id.slice(-6)))),a.createElement("td",{className:"px-6 py-4"},a.createElement("div",{className:"text-sm"},a.createElement("div",null,D.email),a.createElement("div",{className:"text-gray-500"},D.telefono))),a.createElement("td",{className:"px-6 py-4"},a.createElement("span",{className:"text-sm text-gray-900"},D.zona_asignada||"Sin asignar")),a.createElement("td",{className:"px-6 py-4"},a.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${D.activo!==!1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},D.activo!==!1?"Activo":"Inactivo")),a.createElement("td",{className:"px-6 py-4 text-sm text-gray-500"},((z=(V=(j=D.fecha_creacion)==null?void 0:j.toDate)==null?void 0:V.call(j))==null?void 0:z.toLocaleDateString())||"N/A"),a.createElement("td",{className:"px-6 py-4"},a.createElement("div",{className:"flex items-center space-x-2"},a.createElement("button",{onClick:()=>S(D),className:"text-blue-600 hover:text-blue-800 text-sm underline"},"Editar"),a.createElement("button",{onClick:()=>R(D),className:"text-purple-600 hover:text-purple-800 text-sm underline",title:"Cambiar contraseña del agente"},"🔑 Clave"),a.createElement("button",{onClick:()=>w(D),className:`text-sm underline ${D.activo!==!1?"text-red-600 hover:text-red-800":"text-green-600 hover:text-green-800"}`},D.activo!==!1?"Desactivar":"Activar"),a.createElement("button",{onClick:()=>A(D),className:"text-red-600 hover:text-red-800 text-sm underline"},"Eliminar"))))})))),e.length===0&&a.createElement("div",{className:"text-center py-8"},a.createElement("p",{className:"text-gray-500"},"No hay agentes registrados"),a.createElement("button",{onClick:()=>S(),className:"mt-2 text-blue-600 hover:text-blue-800 underline"},"Agregar el primer agente"))),i&&a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},a.createElement("h3",{className:"text-lg font-semibold mb-4"},l?"Editar Agente":"Agregar Nuevo Agente"),a.createElement("form",{onSubmit:b,className:"space-y-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombre completo *"),a.createElement("input",{type:"text",value:u.nombre,onChange:D=>d(j=>({...j,nombre:D.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email *"),a.createElement("input",{type:"email",value:u.email,onChange:D=>d(j=>({...j,email:D.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:l})),!l&&a.createElement("div",{className:"space-y-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña *"),a.createElement("div",{className:"flex gap-2"},a.createElement("input",{type:"password",value:u.password,onChange:D=>d(j=>({...j,password:D.target.value})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!l,minLength:6,placeholder:"Ingresa contraseña (mínimo 6 caracteres)"}),a.createElement("button",{type:"button",onClick:_,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",title:"Generar contraseña segura automáticamente"},"🎲 Generar")),a.createElement("p",{className:"text-xs text-gray-500 mt-1"},"El agente podrá iniciar sesión inmediatamente con estas credenciales")),u.password&&u.password.length>=6&&a.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},a.createElement("h4",{className:"font-medium text-green-800 mb-2"},"✅ Credenciales listas"),a.createElement("div",{className:"bg-white p-3 rounded border font-mono text-sm"},a.createElement("strong",null,"Usuario:")," ",u.email||"(ingresa email)",a.createElement("br",null),a.createElement("strong",null,"Contraseña:")," ",u.password),a.createElement("p",{className:"text-sm text-green-700 mt-2"},"📱 Envía estas credenciales al agente de forma segura (WhatsApp, email, etc.)"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono"),a.createElement("input",{type:"tel",value:u.telefono,onChange:D=>d(j=>({...j,telefono:D.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Zona asignada"),a.createElement("input",{type:"text",value:u.zona_asignada,onChange:D=>d(j=>({...j,zona_asignada:D.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Santiago Centro, Las Condes, etc."})),a.createElement("div",{className:"flex items-center"},a.createElement("input",{type:"checkbox",id:"activo",checked:u.activo,onChange:D=>d(j=>({...j,activo:D.target.checked})),className:"rounded"}),a.createElement("label",{htmlFor:"activo",className:"ml-2 text-sm text-gray-700"},"Agente activo")),a.createElement("div",{className:"flex justify-end space-x-3 pt-4"},a.createElement("button",{type:"button",onClick:N,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400",disabled:f},"Cancelar"),a.createElement("button",{type:"submit",disabled:f,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"},f?"Guardando...":l?"Actualizar":"Crear Agente"))))),a.createElement("div",{className:"mt-8 bg-blue-50 border border-blue-200 rounded-lg p-4"},a.createElement("h4",{className:"font-medium text-blue-900 mb-2"},"🔐 Permisos de los Agentes:"),a.createElement("ul",{className:"text-sm text-blue-800 space-y-1"},a.createElement("li",null,"• Crear solicitudes de registro de empresas"),a.createElement("li",null,"• Activar empresas directamente desde terreno"),a.createElement("li",null,"• Gestionar su perfil y zona asignada"),a.createElement("li",null,"• Ver empresas de su zona"))),v&&a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4"},a.createElement("div",{className:"p-6"},a.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"🔑 Cambiar Contraseña - ",E==null?void 0:E.nombre),a.createElement("div",{className:"space-y-4"},a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3"},a.createElement("p",{className:"text-sm text-blue-800"},a.createElement("strong",null,"Agente:")," ",E==null?void 0:E.nombre,a.createElement("br",null),a.createElement("strong",null,"Email:")," ",E==null?void 0:E.email)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nueva Contraseña *"),a.createElement("div",{className:"flex gap-2"},a.createElement("input",{type:"password",value:h,onChange:D=>C(D.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",minLength:6,placeholder:"Ingresa nueva contraseña (mín. 6 caracteres)"}),a.createElement("button",{type:"button",onClick:M,className:"px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",title:"Generar contraseña segura"},"🎲"))),h&&h.length>=6&&a.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3"},a.createElement("p",{className:"text-sm text-green-800 mb-2"},a.createElement("strong",null,"Nuevas credenciales:")),a.createElement("div",{className:"bg-white p-2 rounded border font-mono text-sm"},a.createElement("strong",null,"Usuario:")," ",E==null?void 0:E.email,a.createElement("br",null),a.createElement("strong",null,"Contraseña:")," ",h)),a.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3"},a.createElement("p",{className:"text-sm text-yellow-800"},"⚠️ ",a.createElement("strong",null,"Importante:")," Envía las nuevas credenciales al agente de forma segura. El agente podrá usar la nueva contraseña inmediatamente."))),a.createElement("div",{className:"flex justify-end space-x-3 mt-6"},a.createElement("button",{onClick:L,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",disabled:f},"Cancelar"),a.createElement("button",{onClick:F,disabled:f||!h||h.length<6,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50"},f?"Cambiando...":"Cambiar Contraseña"))))))}function k7(){const[t,e]=p.useState(!1),[n,r]=p.useState(""),[s,i]=p.useState(!1),o=async()=>{e(!0),r("");try{const d=(await Pm(Fn,"admin@av10dejulio.com","admin123456")).user;await Jx(we($,"usuarios",d.uid),{email:d.email,rol:"admin",nombre:"Administrador",created:new Date,activo:!0}),r("✅ Usuario admin creado exitosamente!")}catch(u){console.error("Error creando admin:",u),u.code==="auth/email-already-in-use"?(r("⚠️ El email ya está en uso. Intentando actualizar rol..."),await l()):r(`❌ Error: ${u.message}`)}e(!1)},l=async()=>{try{const u=Fn.currentUser;u?(await Jx(we($,"usuarios",u.uid),{email:u.email,rol:"admin",nombre:"Administrador",updated:new Date,activo:!0},{merge:!0}),r("✅ Rol actualizado a admin para el usuario actual!")):r("❌ No hay usuario logueado para actualizar")}catch(u){r(`❌ Error actualizando rol: ${u.message}`)}},c=async()=>{e(!0),r("");try{const u=Fn.currentUser;if(u){const d=await di(we($,"usuarios",u.uid));if(d.exists()){const f=d.data();r(`Usuario actual: ${f.email} - Rol: ${f.rol}`)}else r("Usuario autenticado pero sin documento en usuarios - Crea el documento admin")}else r("No hay usuario autenticado")}catch(u){r(`Error verificando usuario: ${u.message}`)}e(!1)};return a.createElement("div",{className:"fixed top-4 right-4 bg-white border border-gray-300 rounded-lg shadow-lg p-4 max-w-xs z-50"},a.createElement("div",{className:"flex justify-between items-center mb-2"},a.createElement("h3",{className:"font-bold text-sm"},"Admin Setup"),a.createElement("button",{onClick:()=>i(!s),className:"text-gray-500 hover:text-gray-700 text-xs"},s?"📖":"📕")),!s&&a.createElement(a.Fragment,null,a.createElement("button",{onClick:c,disabled:t,className:"w-full mb-2 bg-blue-500 text-white px-3 py-1 rounded text-xs hover:bg-blue-600 disabled:opacity-50"},t?"Verificando...":"Verificar Usuario"),a.createElement("button",{onClick:o,disabled:t,className:"w-full mb-2 bg-green-500 text-white px-3 py-1 rounded text-xs hover:bg-green-600 disabled:opacity-50"},t?"Creando...":"Crear/Actualizar Admin"),a.createElement("button",{onClick:l,disabled:t,className:"w-full mb-2 bg-purple-500 text-white px-3 py-1 rounded text-xs hover:bg-purple-600 disabled:opacity-50"},t?"Actualizando...":"Hacer Admin Actual"),n&&a.createElement("div",{className:"text-xs mt-2 p-2 bg-gray-100 rounded max-h-20 overflow-y-auto"},n),a.createElement("div",{className:"text-xs mt-2 text-gray-600"},"Email: admin@av10dejulio.com",a.createElement("br",null),"Pass: admin123456")))}const Xg=({value:t=0,onChange:e=null,readonly:n=!1,size:r="md",showValue:s=!0,className:i="",color:o="yellow"})=>{const[l,c]=p.useState(0),[u,d]=p.useState(t);p.useEffect(()=>{d(t)},[t]);const f={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"},g={yellow:{filled:"text-yellow-400",empty:"text-gray-300"},blue:{filled:"text-blue-400",empty:"text-gray-300"},red:{filled:"text-red-400",empty:"text-gray-300"},green:{filled:"text-green-400",empty:"text-gray-300"}},v=C=>{n||(d(C),e&&e(C))},x=C=>{n||c(C)},E=()=>{n||c(0)},y=l||u||t,h=g[o]||g.yellow;return a.createElement("div",{className:`flex items-center gap-1 ${i}`},a.createElement("div",{className:"flex items-center"},[1,2,3,4,5].map(C=>a.createElement("button",{key:C,type:"button",className:`${f[r]} ${n?"cursor-default":"cursor-pointer hover:scale-110"} transition-transform duration-150 focus:outline-none`,onClick:()=>v(C),onMouseEnter:()=>x(C),onMouseLeave:E,disabled:n,"aria-label":`${C} star${C!==1?"s":""}`},a.createElement("svg",{className:`w-full h-full fill-current transition-colors duration-150 ${C<=y?h.filled:h.empty}`,viewBox:"0 0 24 24"},a.createElement("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}))))),s&&a.createElement("span",{className:"text-sm text-gray-600 ml-2 font-medium"},y>0?y.toFixed(1):"0.0"," / 5"))},zT=({proveedorId:t,productoId:e=null,showModeration:n=!1,limitCount:r=10})=>{const{user:s,rol:i}=Qe(),[o,l]=p.useState([]),[c,u]=p.useState(!0),[d,f]=p.useState("all"),[g,v]=p.useState("");p.useEffect(()=>{x()},[t,e,d]);const x=async()=>{u(!0);try{let T=[fe("proveedorId","==",t)];e?T.push(fe("productoId","==",e)):T.push(fe("productoId","==",null)),n&&d!=="all"?T.push(fe("estado","==",d)):n||T.push(fe("estado","==","aprobada")),T.push(Et("fecha","desc")),r&&T.push(jo(r));const k=pe(Q($,"reseñas"),...T),_=await ue(k);l(_.docs.map(S=>({id:S.id,...S.data()})))}catch(T){console.error("Error fetching reviews:",T),l([])}finally{u(!1)}},E=async(T,k)=>{v(T);try{await Me(we($,"reseñas",T),{estado:k,moderadoPor:s.uid,fechaModeracion:new Date}),l(o.map(_=>_.id===T?{..._,estado:k}:_))}catch(_){console.error("Error moderating review:",_)}finally{v("")}},y=async T=>{if(window.confirm("¿Estás seguro de que quieres eliminar esta reseña?")){v(T);try{await ws(we($,"reseñas",T)),l(o.filter(k=>k.id!==T))}catch(k){console.error("Error deleting review:",k)}finally{v("")}}},h=T=>T?T.toDate?T.toDate().toLocaleDateString():T instanceof Date?T.toLocaleDateString():new Date(T).toLocaleDateString():"",C=T=>{switch(T){case"aprobada":return"bg-green-100 text-green-800";case"pendiente":return"bg-yellow-100 text-yellow-800";case"rechazada":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return c?a.createElement("div",{className:"flex justify-center py-8"},a.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})):a.createElement("div",{className:"space-y-4"},n&&a.createElement("div",{className:"flex flex-wrap gap-2 mb-4"},a.createElement("button",{onClick:()=>f("all"),className:`px-3 py-1 rounded text-sm ${d==="all"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Todas"),a.createElement("button",{onClick:()=>f("pendiente"),className:`px-3 py-1 rounded text-sm ${d==="pendiente"?"bg-yellow-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Pendientes"),a.createElement("button",{onClick:()=>f("aprobada"),className:`px-3 py-1 rounded text-sm ${d==="aprobada"?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Aprobadas"),a.createElement("button",{onClick:()=>f("rechazada"),className:`px-3 py-1 rounded text-sm ${d==="rechazada"?"bg-red-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Rechazadas")),o.length===0?a.createElement("div",{className:"text-center py-8 text-gray-500"},d==="all"||!n?"No hay reseñas aún":`No hay reseñas ${d}s`):a.createElement("div",{className:"space-y-4"},o.map(T=>a.createElement("div",{key:T.id,className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm"},a.createElement("div",{className:"flex items-start justify-between"},a.createElement("div",{className:"flex-1"},a.createElement("div",{className:"flex items-center gap-3 mb-2"},a.createElement(Xg,{value:T.puntaje,readonly:!0,size:"sm",showValue:!1}),a.createElement("span",{className:"text-sm text-gray-600"},"por ",T.usuarioNombre||T.usuarioEmail),a.createElement("span",{className:"text-xs text-gray-400"},h(T.fecha)),n&&a.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${C(T.estado)}`},T.estado||"pendiente")),a.createElement("p",{className:"text-gray-800 text-sm leading-relaxed"},T.comentario)),n&&i==="admin"&&a.createElement("div",{className:"flex flex-col gap-1 ml-4"},T.estado!=="aprobada"&&a.createElement("button",{onClick:()=>E(T.id,"aprobada"),disabled:g===T.id,className:"px-2 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50"},"✓ Aprobar"),T.estado!=="rechazada"&&a.createElement("button",{onClick:()=>E(T.id,"rechazada"),disabled:g===T.id,className:"px-2 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700 disabled:opacity-50"},"✗ Rechazar"),a.createElement("button",{onClick:()=>y(T.id),disabled:g===T.id,className:"px-2 py-1 bg-gray-600 text-white text-xs rounded hover:bg-gray-700 disabled:opacity-50"},"🗑 Eliminar")))))))};function Db({children:t}){const{user:e,rol:n,loading:r}=Qe();return r?a.createElement("div",null,"Cargando..."):e&&n==="admin"?t:a.createElement(JI,{to:"/login"})}const I7=()=>{Qe();const[t,e]=p.useState([]),[n,r]=p.useState({}),[s,i]=p.useState({}),[o,l]=p.useState(!0),[c,u]=p.useState("pendiente"),[d,f]=p.useState({total:0,pendiente:0,aprobada:0,rechazada:0});p.useEffect(()=>{v(),g()},[c]);const g=async()=>{try{const y=pe(Q($,"reseñas")),h=await ue(y),C={total:0,pendiente:0,aprobada:0,rechazada:0};h.docs.forEach(T=>{const k=T.data();C.total++,C[k.estado||"pendiente"]++}),f(C)}catch(y){console.error("Error fetching stats:",y)}},v=async()=>{l(!0);try{let y;c==="all"?y=pe(Q($,"reseñas"),Et("fecha","desc")):y=pe(Q($,"reseñas"),fe("estado","==",c),Et("fecha","desc"));const C=(await ue(y)).docs.map(N=>({id:N.id,...N.data()}));e(C);const T=[...new Set(C.map(N=>N.proveedorId))],k=[...new Set(C.filter(N=>N.productoId).map(N=>N.productoId))],_={};for(const N of T)try{const b=await di(we($,"empresas",N));b.exists()&&(_[N]=b.data())}catch(b){console.error("Error fetching provider:",N,b)}r(_);const S={};for(const N of k)try{const b=await di(we($,"productos",N));b.exists()&&(S[N]=b.data())}catch(b){console.error("Error fetching product:",N,b)}i(S)}catch(y){console.error("Error fetching reviews:",y)}finally{l(!1)}},x=y=>y?y.toDate?y.toDate().toLocaleString():y instanceof Date?y.toLocaleString():new Date(y).toLocaleString():"",E=y=>{switch(y){case"aprobada":return"bg-green-100 text-green-800";case"pendiente":return"bg-yellow-100 text-yellow-800";case"rechazada":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return a.createElement(Db,null,a.createElement(xu,null,a.createElement("div",{className:"max-w-7xl mx-auto"},a.createElement("div",{className:"mb-8"},a.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Moderación de Reseñas"),a.createElement("p",{className:"text-gray-600"},"Gestiona y modera las reseñas de proveedores y productos")),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-8"},a.createElement("div",{className:"bg-blue-100 p-4 rounded-lg text-center"},a.createElement("div",{className:"text-2xl font-bold text-blue-900"},d.total),a.createElement("div",{className:"text-sm text-blue-700"},"Total")),a.createElement("div",{className:"bg-yellow-100 p-4 rounded-lg text-center"},a.createElement("div",{className:"text-2xl font-bold text-yellow-900"},d.pendiente),a.createElement("div",{className:"text-sm text-yellow-700"},"Pendientes")),a.createElement("div",{className:"bg-green-100 p-4 rounded-lg text-center"},a.createElement("div",{className:"text-2xl font-bold text-green-900"},d.aprobada),a.createElement("div",{className:"text-sm text-green-700"},"Aprobadas")),a.createElement("div",{className:"bg-red-100 p-4 rounded-lg text-center"},a.createElement("div",{className:"text-2xl font-bold text-red-900"},d.rechazada),a.createElement("div",{className:"text-sm text-red-700"},"Rechazadas"))),a.createElement("div",{className:"flex flex-wrap gap-2 mb-6"},a.createElement("button",{onClick:()=>u("all"),className:`px-4 py-2 rounded text-sm font-medium ${c==="all"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Todas (",d.total,")"),a.createElement("button",{onClick:()=>u("pendiente"),className:`px-4 py-2 rounded text-sm font-medium ${c==="pendiente"?"bg-yellow-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Pendientes (",d.pendiente,")"),a.createElement("button",{onClick:()=>u("aprobada"),className:`px-4 py-2 rounded text-sm font-medium ${c==="aprobada"?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Aprobadas (",d.aprobada,")"),a.createElement("button",{onClick:()=>u("rechazada"),className:`px-4 py-2 rounded text-sm font-medium ${c==="rechazada"?"bg-red-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},"Rechazadas (",d.rechazada,")")),o?a.createElement("div",{className:"flex justify-center py-12"},a.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})):t.length===0?a.createElement("div",{className:"text-center py-12 text-gray-500"},"No hay reseñas ",c==="all"?"":c+"s"," en este momento"):a.createElement("div",{className:"space-y-4"},t.map(y=>{var h,C,T;return a.createElement("div",{key:y.id,className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm"},a.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4"},a.createElement("div",{className:"lg:col-span-2"},a.createElement("div",{className:"flex items-start justify-between mb-3"},a.createElement("div",null,a.createElement("div",{className:"flex items-center gap-2 mb-1"},a.createElement("div",{className:"flex text-yellow-400"},"★".repeat(y.puntaje),"☆".repeat(5-y.puntaje)),a.createElement("span",{className:"text-sm text-gray-600"},y.puntaje,"/5"),a.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${E(y.estado)}`},y.estado||"pendiente")),a.createElement("div",{className:"text-sm text-gray-600"},"Por: ",y.usuarioNombre||y.usuarioEmail),a.createElement("div",{className:"text-xs text-gray-400"},x(y.fecha)))),a.createElement("p",{className:"text-gray-800 mb-3 leading-relaxed"},y.comentario)),a.createElement("div",{className:"bg-gray-50 p-4 rounded-lg"},a.createElement("h4",{className:"font-medium text-gray-900 mb-2"},y.productoId?"Producto":"Proveedor"),y.productoId?a.createElement("div",null,a.createElement("div",{className:"text-sm font-medium text-gray-800"},((h=s[y.productoId])==null?void 0:h.nombre)||"Producto eliminado"),a.createElement("div",{className:"text-xs text-gray-600 mt-1"},"Proveedor: ",((C=n[y.proveedorId])==null?void 0:C.nombre)||"N/A")):a.createElement("div",{className:"text-sm font-medium text-gray-800"},((T=n[y.proveedorId])==null?void 0:T.nombre)||"Proveedor eliminado"),a.createElement("div",{className:"mt-4"},a.createElement(zT,{proveedorId:y.proveedorId,productoId:y.productoId,showModeration:!0,limitCount:1})))))})))))},T7=()=>{const{user:t}=Qe(),[e,n]=p.useState([]),[r,s]=p.useState(!0),[i,o]=p.useState("all"),[l,c]=p.useState(null),[u,d]=p.useState(""),[f,g]=p.useState(!1);p.useEffect(()=>{v()},[i]);const v=async()=>{s(!0);try{let S=pe(Q($,"tickets"),Et("fechaCreacion","desc")),b=(await ue(S)).docs.map(w=>({id:w.id,...w.data()}));i!=="all"&&(b=b.filter(w=>{switch(i){case"abierto":return w.estado==="abierto";case"en_proceso":return w.estado==="en_proceso";case"resuelto":return w.estado==="resuelto";case"cerrado":return w.estado==="cerrado";case"alta_prioridad":return w.prioridad==="alta"||w.prioridad==="urgente";case"sin_respuesta":return!w.respuestas||w.respuestas.length===0;default:return!0}})),n(b)}catch(S){console.error("Error fetching tickets:",S)}finally{s(!1)}},x=async S=>{if(c(S),!S.visto)try{await Me(we($,"tickets",S.id),{visto:!0,fechaActualizacion:qn()}),n(N=>N.map(b=>b.id===S.id?{...b,visto:!0}:b))}catch(N){console.error("Error marking ticket as seen:",N)}},E=async(S,N)=>{try{await Me(we($,"tickets",S),{estado:N,fechaActualizacion:qn(),...N==="resuelto"&&{resuelto:!0}}),n(b=>b.map(w=>w.id===S?{...w,estado:N}:w)),l&&l.id===S&&c(b=>({...b,estado:N}))}catch(b){console.error("Error updating ticket status:",b)}},y=async()=>{if(!(!u.trim()||!l)){g(!0);try{const S={mensaje:u.trim(),autor:t.displayName||t.email,autorId:t.uid,fecha:qn(),esAdmin:!0},N=l.respuestas||[];N.push(S),await Me(we($,"tickets",l.id),{respuestas:N,estado:"en_proceso",fechaActualizacion:qn()}),c(b=>({...b,respuestas:N,estado:"en_proceso"})),n(b=>b.map(w=>w.id===l.id?{...w,respuestas:N,estado:"en_proceso"}:w)),d("")}catch(S){console.error("Error sending response:",S)}finally{g(!1)}}},h=S=>{switch(S){case"abierto":return"bg-blue-100 text-blue-800";case"en_proceso":return"bg-yellow-100 text-yellow-800";case"resuelto":return"bg-green-100 text-green-800";case"cerrado":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},C=S=>{switch(S){case"baja":return"text-green-600";case"media":return"text-yellow-600";case"alta":return"text-orange-600";case"urgente":return"text-red-600";default:return"text-gray-600"}},T=S=>S?(S.toDate?S.toDate():new Date(S)).toLocaleString():"",_=(()=>{const S=e.length,N=e.filter(R=>R.estado==="abierto").length,b=e.filter(R=>R.estado==="en_proceso").length,w=e.filter(R=>R.estado==="resuelto").length,A=e.filter(R=>!R.respuestas||R.respuestas.length===0).length;return{total:S,abiertos:N,enProceso:b,resueltos:w,sinRespuesta:A}})();return r?a.createElement("div",{className:"flex justify-center py-8"},a.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})):a.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6"},a.createElement("div",{className:"lg:col-span-2"},a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6"},a.createElement("div",{className:"bg-white p-3 rounded-lg shadow-sm text-center"},a.createElement("div",{className:"text-xl font-bold text-blue-600"},_.total),a.createElement("div",{className:"text-xs text-gray-600"},"Total")),a.createElement("div",{className:"bg-white p-3 rounded-lg shadow-sm text-center"},a.createElement("div",{className:"text-xl font-bold text-blue-600"},_.abiertos),a.createElement("div",{className:"text-xs text-gray-600"},"Abiertos")),a.createElement("div",{className:"bg-white p-3 rounded-lg shadow-sm text-center"},a.createElement("div",{className:"text-xl font-bold text-yellow-600"},_.enProceso),a.createElement("div",{className:"text-xs text-gray-600"},"En Proceso")),a.createElement("div",{className:"bg-white p-3 rounded-lg shadow-sm text-center"},a.createElement("div",{className:"text-xl font-bold text-green-600"},_.resueltos),a.createElement("div",{className:"text-xs text-gray-600"},"Resueltos")),a.createElement("div",{className:"bg-white p-3 rounded-lg shadow-sm text-center"},a.createElement("div",{className:"text-xl font-bold text-red-600"},_.sinRespuesta),a.createElement("div",{className:"text-xs text-gray-600"},"Sin Respuesta"))),a.createElement("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6"},a.createElement("div",{className:"flex flex-wrap gap-2"},[{key:"all",label:"Todos"},{key:"abierto",label:"Abiertos"},{key:"en_proceso",label:"En Proceso"},{key:"resuelto",label:"Resueltos"},{key:"alta_prioridad",label:"Alta Prioridad"},{key:"sin_respuesta",label:"Sin Respuesta"}].map(S=>a.createElement("button",{key:S.key,onClick:()=>o(S.key),className:`px-3 py-1 rounded text-sm ${i===S.key?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`},S.label)))),a.createElement("div",{className:"space-y-3"},e.map(S=>a.createElement("div",{key:S.id,onClick:()=>x(S),className:`bg-white rounded-lg shadow-sm border p-4 cursor-pointer hover:shadow-md transition-shadow ${(l==null?void 0:l.id)===S.id?"ring-2 ring-blue-500":""} ${S.visto?"":"border-l-4 border-l-blue-500"}`},a.createElement("div",{className:"flex items-start justify-between mb-2"},a.createElement("div",{className:"flex-1"},a.createElement("h3",{className:"font-medium text-gray-900 mb-1"},S.asunto),a.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600"},a.createElement("span",null,S.nombre),a.createElement("span",null,"•"),a.createElement("span",null,S.email),a.createElement("span",null,"•"),a.createElement("span",null,T(S.fechaCreacion)))),a.createElement("div",{className:"flex flex-col items-end gap-1"},a.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${h(S.estado)}`},S.estado),a.createElement("span",{className:`text-xs font-medium ${C(S.prioridad)}`},S.prioridad))),a.createElement("p",{className:"text-sm text-gray-700 line-clamp-2"},S.mensaje),a.createElement("div",{className:"flex items-center justify-between mt-2"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded"},S.tipo),S.categoria&&a.createElement("span",{className:"bg-gray-100 text-gray-700 text-xs px-2 py-1 rounded"},S.categoria)),S.respuestas&&S.respuestas.length>0&&a.createElement("span",{className:"text-xs text-green-600 font-medium"},S.respuestas.length," respuesta(s)")))),e.length===0&&a.createElement("div",{className:"text-center py-8 text-gray-500"},"No hay tickets para mostrar"))),a.createElement("div",{className:"lg:col-span-1"},l?a.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 sticky top-4"},a.createElement("div",{className:"mb-4"},a.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-2"},l.asunto),a.createElement("div",{className:"flex items-center justify-between mb-3"},a.createElement("span",{className:`px-2 py-1 rounded text-sm font-medium ${h(l.estado)}`},l.estado),a.createElement("select",{value:l.estado,onChange:S=>E(l.id,S.target.value),className:"text-sm border border-gray-300 rounded px-2 py-1"},a.createElement("option",{value:"abierto"},"Abierto"),a.createElement("option",{value:"en_proceso"},"En Proceso"),a.createElement("option",{value:"resuelto"},"Resuelto"),a.createElement("option",{value:"cerrado"},"Cerrado"))),a.createElement("div",{className:"text-sm text-gray-600 space-y-1"},a.createElement("div",null,a.createElement("strong",null,"De:")," ",l.nombre),a.createElement("div",null,a.createElement("strong",null,"Email:")," ",l.email),l.telefono&&a.createElement("div",null,a.createElement("strong",null,"Teléfono:")," ",l.telefono),a.createElement("div",null,a.createElement("strong",null,"Tipo:")," ",l.tipo),l.categoria&&a.createElement("div",null,a.createElement("strong",null,"Categoría:")," ",l.categoria),a.createElement("div",null,a.createElement("strong",null,"Prioridad:"),a.createElement("span",{className:C(l.prioridad)}," "+l.prioridad)),a.createElement("div",null,a.createElement("strong",null,"Fecha:")," ",T(l.fechaCreacion)))),a.createElement("div",{className:"mb-4"},a.createElement("h3",{className:"font-medium text-gray-900 mb-2"},"Mensaje:"),a.createElement("div",{className:"bg-gray-50 p-3 rounded text-sm text-gray-700"},l.mensaje)),l.respuestas&&l.respuestas.length>0&&a.createElement("div",{className:"mb-4"},a.createElement("h3",{className:"font-medium text-gray-900 mb-2"},"Respuestas:"),a.createElement("div",{className:"space-y-2 max-h-40 overflow-y-auto"},l.respuestas.map((S,N)=>a.createElement("div",{key:N,className:"bg-blue-50 p-3 rounded text-sm"},a.createElement("div",{className:"font-medium text-blue-900 mb-1"},S.autor," - ",T(S.fecha)),a.createElement("div",{className:"text-blue-800"},S.mensaje))))),a.createElement("div",null,a.createElement("h3",{className:"font-medium text-gray-900 mb-2"},"Responder:"),a.createElement("textarea",{value:u,onChange:S=>d(S.target.value),placeholder:"Escribe tu respuesta...",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4}),a.createElement("button",{onClick:y,disabled:!u.trim()||f,className:"w-full mt-2 bg-blue-600 text-white py-2 px-4 rounded text-sm hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"},f?"Enviando...":"Enviar Respuesta"))):a.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 text-center text-gray-500"},"Selecciona un ticket para ver los detalles")))},A7=()=>a.createElement(xu,null,a.createElement("div",{className:"space-y-6"},a.createElement("div",null,a.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Gestión de Tickets y Feedback"),a.createElement("p",{className:"text-gray-600 mt-2"},"Administra las consultas, sugerencias, reclamos y solicitudes de soporte de los usuarios.")),a.createElement(T7,null))),P7=()=>{const{user:t}=Qe(),[e,n]=p.useState([]),[r,s]=p.useState(!0),[i,o]=p.useState(!1),[l,c]=p.useState(null),[u,d]=p.useState({titulo:"",tipo:"blog",categoria:"mantenimiento",contenido:"",descripcion:"",videoUrl:"",imagenUrl:"",tags:"",orden:0,estado:"activo"}),f=[{value:"blog",label:"Artículo de Blog"},{value:"tip",label:"Tip/Consejo"},{value:"tutorial",label:"Tutorial"},{value:"video",label:"Video"},{value:"faq",label:"Pregunta Frecuente"}],g=[{value:"mantenimiento",label:"Mantenimiento Vehicular"},{value:"repuestos",label:"Selección de Repuestos"},{value:"seguridad",label:"Seguridad Vial"},{value:"general",label:"General"}];p.useEffect(()=>{v()},[]);const v=async()=>{s(!0);try{const _=pe(Q($,"recursos_educativos"),Et("orden","asc"),Et("fechaCreacion","desc")),S=await ue(_);n(S.docs.map(N=>({id:N.id,...N.data()})))}catch(_){console.error("Error fetching resources:",_)}finally{s(!1)}},x=async _=>{if(_.preventDefault(),!u.titulo.trim()||!u.contenido.trim()){alert("Por favor completa los campos obligatorios");return}try{const S={...u,tags:u.tags.split(",").map(N=>N.trim()).filter(N=>N),orden:parseInt(u.orden)||0,fechaActualizacion:qn(),actualizadoPor:t.uid};l?await Me(we($,"recursos_educativos",l.id),S):(S.fechaCreacion=qn(),S.creadoPor=t.uid,await ze(Q($,"recursos_educativos"),S)),h(),v()}catch(S){console.error("Error saving resource:",S),alert("Error al guardar el recurso")}},E=_=>{c(_),d({..._,tags:Array.isArray(_.tags)?_.tags.join(", "):""}),o(!0)},y=async _=>{if(window.confirm("¿Estás seguro de que quieres eliminar este recurso?"))try{await ws(we($,"recursos_educativos",_)),v()}catch(S){console.error("Error deleting resource:",S),alert("Error al eliminar el recurso")}},h=()=>{d({titulo:"",tipo:"blog",categoria:"mantenimiento",contenido:"",descripcion:"",videoUrl:"",imagenUrl:"",tags:"",orden:0,estado:"activo"}),c(null),o(!1)},C=_=>_?_.toDate?_.toDate().toLocaleDateString():_ instanceof Date?_.toLocaleDateString():new Date(_).toLocaleDateString():"",T=_=>{switch(_){case"activo":return"bg-green-100 text-green-800";case"borrador":return"bg-yellow-100 text-yellow-800";case"archivado":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},k=_=>{switch(_){case"blog":return"📝";case"tip":return"💡";case"tutorial":return"🎓";case"video":return"🎥";case"faq":return"❓";default:return"📄"}};return a.createElement(Db,null,a.createElement(xu,null,a.createElement("div",{className:"max-w-7xl mx-auto"},a.createElement("div",{className:"mb-8 flex justify-between items-center"},a.createElement("div",null,a.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Gestión de Recursos Educativos"),a.createElement("p",{className:"text-gray-600"},"Administra contenido educativo para usuarios")),a.createElement("button",{onClick:()=>o(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700"},"Nuevo Recurso")),i&&a.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-8"},a.createElement("div",{className:"flex justify-between items-center mb-4"},a.createElement("h2",{className:"text-xl font-semibold"},l?"Editar Recurso":"Nuevo Recurso"),a.createElement("button",{onClick:h,className:"text-gray-500 hover:text-gray-700"},"✕")),a.createElement("form",{onSubmit:x,className:"space-y-4"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Título *"),a.createElement("input",{type:"text",value:u.titulo,onChange:_=>d({...u,titulo:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Tipo de Recurso"),a.createElement("select",{value:u.tipo,onChange:_=>d({...u,tipo:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},f.map(_=>a.createElement("option",{key:_.value,value:_.value},_.label)))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Categoría"),a.createElement("select",{value:u.categoria,onChange:_=>d({...u,categoria:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},g.map(_=>a.createElement("option",{key:_.value,value:_.value},_.label)))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Estado"),a.createElement("select",{value:u.estado,onChange:_=>d({...u,estado:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},a.createElement("option",{value:"activo"},"Activo"),a.createElement("option",{value:"borrador"},"Borrador"),a.createElement("option",{value:"archivado"},"Archivado")))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Descripción Breve"),a.createElement("textarea",{value:u.descripcion,onChange:_=>d({...u,descripcion:_.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Descripción corta para mostrar en listados..."})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Contenido *"),a.createElement("textarea",{value:u.contenido,onChange:_=>d({...u,contenido:_.target.value}),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Contenido completo del recurso...",required:!0})),u.tipo==="video"&&a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"URL del Video"),a.createElement("input",{type:"url",value:u.videoUrl,onChange:_=>d({...u,videoUrl:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://youtube.com/..."})),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"URL de Imagen"),a.createElement("input",{type:"url",value:u.imagenUrl,onChange:_=>d({...u,imagenUrl:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Tags (separados por comas)"),a.createElement("input",{type:"text",value:u.tags,onChange:_=>d({...u,tags:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"mantenimiento, aceite, filtros"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Orden"),a.createElement("input",{type:"number",value:u.orden,onChange:_=>d({...u,orden:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0"}))),a.createElement("div",{className:"flex gap-2"},a.createElement("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700"},l?"Actualizar":"Crear"," Recurso"),a.createElement("button",{type:"button",onClick:h,className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400"},"Cancelar")))),r?a.createElement("div",{className:"flex justify-center py-12"},a.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})):a.createElement("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden"},a.createElement("div",{className:"overflow-x-auto"},a.createElement("table",{className:"min-w-full divide-y divide-gray-200"},a.createElement("thead",{className:"bg-gray-50"},a.createElement("tr",null,a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Recurso"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tipo"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Categoría"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Fecha"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),a.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},e.map(_=>{var S,N;return a.createElement("tr",{key:_.id,className:"hover:bg-gray-50"},a.createElement("td",{className:"px-6 py-4"},a.createElement("div",{className:"flex items-start"},a.createElement("span",{className:"text-2xl mr-3"},k(_.tipo)),a.createElement("div",null,a.createElement("div",{className:"text-sm font-medium text-gray-900"},_.titulo),_.descripcion&&a.createElement("div",{className:"text-sm text-gray-500 mt-1"},_.descripcion.substring(0,100),"..."),_.tags&&_.tags.length>0&&a.createElement("div",{className:"flex flex-wrap gap-1 mt-2"},_.tags.slice(0,3).map((b,w)=>a.createElement("span",{key:w,className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full"},b)),_.tags.length>3&&a.createElement("span",{className:"text-xs text-gray-500"},"+",_.tags.length-3," más"))))),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},a.createElement("span",{className:"text-sm text-gray-900"},((S=f.find(b=>b.value===_.tipo))==null?void 0:S.label)||_.tipo)),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},a.createElement("span",{className:"text-sm text-gray-900"},((N=g.find(b=>b.value===_.categoria))==null?void 0:N.label)||_.categoria)),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},a.createElement("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${T(_.estado)}`},_.estado)),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},C(_.fechaCreacion)),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},a.createElement("div",{className:"flex gap-2"},a.createElement("button",{onClick:()=>E(_),className:"text-blue-600 hover:text-blue-900"},"Editar"),a.createElement("button",{onClick:()=>y(_.id),className:"text-red-600 hover:text-red-900"},"Eliminar"))))})))),e.length===0&&a.createElement("div",{className:"text-center py-12 text-gray-500"},"No hay recursos educativos creados aún")))))};function R7({empresa:t,onLogoUpload:e,saving:n}){const[r,s]=p.useState(!1),[i,o]=p.useState(!1),[l,c]=p.useState(t.logo||null),[u,d]=p.useState(t.galeria||[]),[f,g]=p.useState(!1),v=p.useRef(null),x=p.useRef(null),E=b=>{b.preventDefault(),b.stopPropagation(),b.type==="dragenter"||b.type==="dragover"?s(!0):b.type==="dragleave"&&s(!1)},y=b=>{b.preventDefault(),b.stopPropagation(),s(!1),b.dataTransfer.files&&b.dataTransfer.files[0]&&C(b.dataTransfer.files[0])},h=b=>{b.preventDefault(),b.target.files&&b.target.files[0]&&C(b.target.files[0])},C=async b=>{if(!b.type.includes("png")&&!b.type.includes("jpeg")&&!b.type.includes("jpg")){alert("Por favor, selecciona un archivo PNG o JPG");return}if(b.size>2*1024*1024){alert("El archivo es muy grande. Máximo 2MB");return}try{o(!0);const w=new FileReader;w.onload=R=>c(R.target.result),w.readAsDataURL(b);const A=await e(b);c(A)}catch(w){console.error("Error subiendo logo:",w),alert("Error al subir el logo. Inténtalo nuevamente."),c(t.logo||null)}finally{o(!1)}},T=()=>{var b;(b=v.current)==null||b.click()},k=async()=>{if(window.confirm("¿Estás seguro de que quieres eliminar el logo?"))try{o(!0),await e(null),c(null)}catch(b){console.error("Error eliminando logo:",b),alert("Error al eliminar el logo")}finally{o(!1)}},_=async b=>{try{g(!0);const w=[];for(let R of b){if(!R.type.includes("image/")){alert(`${R.name} no es una imagen válida`);continue}if(R.size>5*1024*1024){alert(`${R.name} es muy grande. Máximo 5MB por imagen`);continue}const L=$c(Wc,`galeria/empresas/${t.id}/${Date.now()}-${R.name}`);await Dm(L,R);const M=await Mm(L);w.push(M)}const A=[...u,...w];d(A),await e(null,"galeria",A)}catch(w){console.error("Error subiendo imágenes:",w),alert("Error al subir las imágenes")}finally{g(!1)}},S=async b=>{if(window.confirm("¿Eliminar esta imagen de la galería?")){const w=u.filter((A,R)=>R!==b);d(w),await e(null,"galeria",w)}},N=async()=>{if(window.confirm("¿Generar un logo automático basado en el nombre de la empresa?"))try{o(!0);const b=document.createElement("canvas");b.width=400,b.height=400;const w=b.getContext("2d"),A=w.createLinearGradient(0,0,400,400);A.addColorStop(0,"#3B82F6"),A.addColorStop(1,"#1E40AF"),w.fillStyle=A,w.fillRect(0,0,400,400);const L=(t.nombre||"Empresa").split(" ").map(M=>M.charAt(0)).join("").substring(0,3);w.fillStyle="white",w.font="bold 120px Arial",w.textAlign="center",w.textBaseline="middle",w.fillText(L,200,200),b.toBlob(async M=>{try{const F=$c(Wc,`logos/empresas/auto-${t.id}-${Date.now()}.png`);await Dm(F,M);const U=await Mm(F);await e({logoURL:U,esAutomatico:!0}),c(U)}catch(F){throw console.error("Error subiendo logo automático:",F),F}},"image/png")}catch(b){console.error("Error generando logo:",b),alert("Error al generar el logo automático")}finally{o(!1)}};return a.createElement("div",{className:"p-6 space-y-8"},a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Gestión de Logo y Galería"),a.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("h4",{className:"text-md font-medium text-gray-700 mb-3"},"Logo de la Empresa"),a.createElement("div",{className:"border-2 border-gray-200 rounded-lg p-6 text-center bg-gray-50"},l?a.createElement("div",{className:"space-y-4"},a.createElement("img",{src:l,alt:"Logo de la empresa",className:"w-32 h-32 object-contain mx-auto bg-white border rounded-lg shadow-sm"}),a.createElement("div",{className:"space-y-2"},a.createElement("p",{className:"text-sm text-gray-600"},"Logo cargado correctamente"),a.createElement("div",{className:"flex justify-center gap-2"},a.createElement("button",{onClick:k,disabled:i,className:"text-red-600 hover:text-red-800 text-sm underline disabled:opacity-50"},"Eliminar logo")))):a.createElement("div",{className:"space-y-4"},a.createElement("div",{className:"w-32 h-32 bg-gray-200 rounded-lg mx-auto flex items-center justify-center"},a.createElement("span",{className:"text-4xl text-gray-400"},"🖼️")),a.createElement("p",{className:"text-gray-500"},"No hay logo asignado"),!t.web&&a.createElement("button",{onClick:N,disabled:i,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 transition-colors text-sm"},"✨ Generar Logo Automático")))),a.createElement("div",null,a.createElement("h4",{className:"text-md font-medium text-gray-700 mb-3"},"Subir Nuevo Logo"),a.createElement("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${r?"border-blue-500 bg-blue-50":"border-gray-300 bg-gray-50 hover:border-gray-400"}`,onDragEnter:E,onDragLeave:E,onDragOver:E,onDrop:y},a.createElement("div",{className:"space-y-4"},a.createElement("div",{className:"text-4xl"},"📁"),i?a.createElement("div",{className:"space-y-2"},a.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),a.createElement("p",{className:"text-blue-600"},"Subiendo logo...")):a.createElement(a.Fragment,null,a.createElement("div",{className:"space-y-2"},a.createElement("p",{className:"text-gray-700 font-medium"},"Arrastra y suelta un archivo aquí"),a.createElement("p",{className:"text-gray-500 text-sm"},"o haz clic para seleccionar")),a.createElement("button",{onClick:T,disabled:i||n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors"},"Seleccionar Archivo")))),a.createElement("input",{ref:v,type:"file",className:"hidden",accept:".png,.jpg,.jpeg",onChange:h}),a.createElement("div",{className:"mt-4 text-sm text-gray-600 space-y-1"},a.createElement("p",null,"• Formatos permitidos: PNG, JPG, JPEG"),a.createElement("p",null,"• Tamaño máximo: 2MB"),a.createElement("p",null,"• Recomendado: Logo cuadrado (500x500px) con fondo transparente")))),a.createElement("div",{className:"border-t border-gray-200 pt-8"},a.createElement("div",{className:"flex items-center justify-between mb-4"},a.createElement("div",null,a.createElement("h4",{className:"text-md font-medium text-gray-700"},"Galería de Fotos del Local"),a.createElement("p",{className:"text-sm text-gray-500 mt-1"},"Sube fotos del local, productos o servicios para el perfil web")),a.createElement("button",{onClick:()=>{var b;return(b=x.current)==null?void 0:b.click()},disabled:f,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors"},f?"Subiendo...":"📷 Agregar Fotos")),a.createElement("input",{ref:x,type:"file",className:"hidden",accept:"image/*",multiple:!0,onChange:b=>b.target.files.length>0&&_(Array.from(b.target.files))}),u.length>0?a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},u.map((b,w)=>a.createElement("div",{key:w,className:"relative group"},a.createElement("img",{src:b,alt:`Foto ${w+1}`,className:"w-full h-32 object-cover rounded-lg border"}),a.createElement("button",{onClick:()=>S(w),className:"absolute top-2 right-2 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-xs"},"✕")))):a.createElement("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center"},a.createElement("div",{className:"text-4xl text-gray-400 mb-2"},"📸"),a.createElement("p",{className:"text-gray-500"},"No hay fotos en la galería"),a.createElement("p",{className:"text-gray-400 text-sm mt-1"},"Las fotos ayudan a los clientes a conocer mejor tu local")),a.createElement("div",{className:"mt-4 text-sm text-gray-600"},a.createElement("p",null,"• Máximo 5MB por imagen • Formatos: JPG, PNG • Recomendado: fotos del local, productos, equipo"))),a.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},a.createElement("h5",{className:"font-medium text-blue-900 mb-2"},"💡 Consejos para un buen logo:"),a.createElement("ul",{className:"text-sm text-blue-800 space-y-1"},a.createElement("li",null,"• Usa un fondo transparente (PNG) para mejor integración"),a.createElement("li",null,"• Asegúrate de que sea legible en tamaños pequeños"),a.createElement("li",null,"• Mantén un diseño simple y reconocible"),a.createElement("li",null,"• Usa colores que representen tu marca"))),!t.web&&a.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},a.createElement("h5",{className:"font-medium text-green-900 mb-2"},"🌐 Perfil Web para PYME:"),a.createElement("ul",{className:"text-sm text-green-800 space-y-1"},a.createElement("li",null,"• Tu empresa tendrá un perfil web completo"),a.createElement("li",null,"• Los clientes podrán ver fotos y información"),a.createElement("li",null,"• Incluye horarios, servicios y contacto"),a.createElement("li",null,"• Perfecto para emprendimientos sin sitio web")),t.logoAsignado&&u.length>0&&a.createElement("div",{className:"mt-2 flex items-center gap-2 text-green-700"},a.createElement("span",null,"✓"),a.createElement("span",{className:"text-sm font-medium"},"Perfil listo para publicar")))),t.logoAsignado&&a.createElement("div",{className:"mt-4"},a.createElement("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm"},a.createElement("span",null,"✓"),"Logo asignado correctamente")))}const fd=[{id:"lunes",label:"Lunes"},{id:"martes",label:"Martes"},{id:"miercoles",label:"Miércoles"},{id:"jueves",label:"Jueves"},{id:"viernes",label:"Viernes"},{id:"sabado",label:"Sábado"},{id:"domingo",label:"Domingo"}],L7=[{label:"Horario Comercial (9:00 - 18:00)",inicio:"09:00",fin:"18:00"},{label:"Jornada Completa (8:00 - 17:00)",inicio:"08:00",fin:"17:00"},{label:"Medio Día (9:00 - 13:00)",inicio:"09:00",fin:"13:00"},{label:"Tarde (14:00 - 20:00)",inicio:"14:00",fin:"20:00"},{label:"Extendido (7:00 - 21:00)",inicio:"07:00",fin:"21:00"}];function D7({empresa:t,onUpdate:e,saving:n}){const[r,s]=p.useState(t.horarios||{lunes:{activo:!0,inicio:"09:00",fin:"18:00"},martes:{activo:!0,inicio:"09:00",fin:"18:00"},miercoles:{activo:!0,inicio:"09:00",fin:"18:00"},jueves:{activo:!0,inicio:"09:00",fin:"18:00"},viernes:{activo:!0,inicio:"09:00",fin:"18:00"},sabado:{activo:!1,inicio:"09:00",fin:"13:00"},domingo:{activo:!1,inicio:"10:00",fin:"14:00"}}),[i,o]=p.useState(!1),[l,c]=p.useState({inicio:"09:00",fin:"18:00"}),u=(x,E,y)=>{const h={...r,[x]:{...r[x],[E]:y}};s(h)},d=()=>{if(!i)return;const x={...r};fd.forEach(E=>{x[E.id]&&(x[E.id]={...x[E.id],inicio:l.inicio,fin:l.fin})}),s(x)},f=x=>{const E={...r};fd.forEach(y=>{E[y.id]={...E[y.id],inicio:x.inicio,fin:x.fin,activo:y.id!=="domingo"}}),s(E)},g=()=>{e("horarios",r)},v=()=>{const x=fd.filter(y=>{var h;return(h=r[y.id])==null?void 0:h.activo});if(x.length===0)return"Sin horarios definidos";const E={};return x.forEach(y=>{const h=r[y.id],C=`${h.inicio}-${h.fin}`;E[C]||(E[C]={dias:[],horario:h}),E[C].dias.push(y.label)}),Object.values(E).map(y=>`${y.dias.length===1?y.dias[0]:y.dias.length===y.dias.length?y.dias.join(", "):`${y.dias[0]} a ${y.dias[y.dias.length-1]}`}: ${y.horario.inicio} - ${y.horario.fin}`).join(" | ")};return a.createElement("div",{className:"p-6"},a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Gestión de Horarios"),a.createElement("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg"},a.createElement("h4",{className:"font-medium text-blue-900 mb-2"},"Horarios Actuales:"),a.createElement("p",{className:"text-blue-800 text-sm"},v())),a.createElement("div",{className:"mb-6 space-y-4"},a.createElement("div",null,a.createElement("h4",{className:"font-medium text-gray-700 mb-3"},"Herramientas Rápidas"),a.createElement("div",{className:"space-y-2"},a.createElement("label",{className:"text-sm text-gray-600"},"Aplicar horario predefinido:"),a.createElement("div",{className:"flex flex-wrap gap-2"},L7.map((x,E)=>a.createElement("button",{key:E,onClick:()=>f(x),className:"px-3 py-1 text-xs bg-gray-100 text-gray-700 rounded-full hover:bg-gray-200 transition-colors"},x.label)))),a.createElement("div",{className:"mt-4 p-3 border border-gray-200 rounded-lg"},a.createElement("div",{className:"flex items-center gap-2 mb-2"},a.createElement("input",{type:"checkbox",id:"aplicarATodos",checked:i,onChange:x=>o(x.target.checked),className:"rounded"}),a.createElement("label",{htmlFor:"aplicarATodos",className:"text-sm font-medium text-gray-700"},"Aplicar el mismo horario a todos los días activos")),i&&a.createElement("div",{className:"flex items-center gap-4"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("label",{className:"text-sm text-gray-600"},"Desde:"),a.createElement("input",{type:"time",value:l.inicio,onChange:x=>c(E=>({...E,inicio:x.target.value})),className:"px-2 py-1 border border-gray-300 rounded text-sm"})),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("label",{className:"text-sm text-gray-600"},"Hasta:"),a.createElement("input",{type:"time",value:l.fin,onChange:x=>c(E=>({...E,fin:x.target.value})),className:"px-2 py-1 border border-gray-300 rounded text-sm"})),a.createElement("button",{onClick:d,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700"},"Aplicar"))))),a.createElement("div",{className:"space-y-3"},a.createElement("h4",{className:"font-medium text-gray-700"},"Configuración Detallada por Día"),fd.map(x=>{var E,y,h,C,T;return a.createElement("div",{key:x.id,className:"border border-gray-200 rounded-lg p-4"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",{className:"flex items-center gap-4 flex-1"},a.createElement("div",{className:"w-20"},a.createElement("span",{className:"font-medium text-gray-900"},x.label)),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("input",{type:"checkbox",checked:((E=r[x.id])==null?void 0:E.activo)||!1,onChange:k=>u(x.id,"activo",k.target.checked),className:"rounded"}),a.createElement("span",{className:"text-sm text-gray-600"},"Abierto")),((y=r[x.id])==null?void 0:y.activo)&&a.createElement("div",{className:"flex items-center gap-4"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("label",{className:"text-sm text-gray-600"},"Desde:"),a.createElement("input",{type:"time",value:((h=r[x.id])==null?void 0:h.inicio)||"09:00",onChange:k=>u(x.id,"inicio",k.target.value),className:"px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("label",{className:"text-sm text-gray-600"},"Hasta:"),a.createElement("input",{type:"time",value:((C=r[x.id])==null?void 0:C.fin)||"18:00",onChange:k=>u(x.id,"fin",k.target.value),className:"px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})))),!((T=r[x.id])!=null&&T.activo)&&a.createElement("span",{className:"text-sm text-gray-500 italic"},"Cerrado")))})),a.createElement("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg"},a.createElement("h5",{className:"font-medium text-yellow-900 mb-2"},"📝 Notas sobre horarios:"),a.createElement("ul",{className:"text-sm text-yellow-800 space-y-1"},a.createElement("li",null,"• Los horarios se muestran a los clientes en la información de la empresa"),a.createElement("li",null,"• Puedes tener diferentes horarios para cada día de la semana"),a.createElement("li",null,'• Los días marcados como "Cerrado" no mostrarán horarios'),a.createElement("li",null,"• Se recomienda mantener horarios consistentes y actualizados"))),a.createElement("div",{className:"mt-6 flex justify-end"},a.createElement("button",{onClick:g,disabled:n,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors"},n?"Guardando...":"Guardar Horarios")))}function M7({empresa:t,onUpdate:e}){const[n,r]=p.useState({descripcionCompleta:t.descripcionCompleta||"",servicios:t.servicios||[],galeria:t.galeria||[],contactoAdicional:t.contactoAdicional||{whatsapp:"",facebook:"",instagram:"",direccionCompleta:""},caracteristicas:t.caracteristicas||[],testimonios:t.testimonios||[]}),[s,i]=p.useState(""),[o,l]=p.useState(""),[c,u]=p.useState({cliente:"",comentario:"",rating:5}),[d,f]=p.useState(!1),g=()=>{if(s.trim()){const k=[...n.servicios,s.trim()];r(_=>({..._,servicios:k})),i("")}},v=k=>{const _=n.servicios.filter((S,N)=>N!==k);r(S=>({...S,servicios:_}))},x=()=>{if(o.trim()){const k=[...n.caracteristicas,o.trim()];r(_=>({..._,caracteristicas:k})),l("")}},E=k=>{const _=n.caracteristicas.filter((S,N)=>N!==k);r(S=>({...S,caracteristicas:_}))},y=()=>{if(c.cliente.trim()&&c.comentario.trim()){const k=[...n.testimonios,{...c}];r(_=>({..._,testimonios:k})),u({cliente:"",comentario:"",rating:5})}},h=k=>{const _=n.testimonios.filter((S,N)=>N!==k);r(S=>({...S,testimonios:_}))},C=()=>{Object.keys(n).forEach(k=>{e(k,n[k])}),alert("Perfil web actualizado correctamente")},T=()=>{if(!t.horarios)return"Horarios no definidos";const k=Object.entries(t.horarios).filter(([_,S])=>S.activo).map(([_,S])=>`${_.charAt(0).toUpperCase()+_.slice(1)}: ${S.inicio} - ${S.fin}`);return k.length>0?k.join(", "):"Cerrado todos los días"};return d?a.createElement("div",{className:"p-6"},a.createElement("div",{className:"flex items-center justify-between mb-6"},a.createElement("h3",{className:"text-lg font-semibold"},"Vista Previa del Perfil Web"),a.createElement("button",{onClick:()=>f(!1),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200"},"← Volver a Editar")),a.createElement("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden shadow-lg max-w-4xl mx-auto"},a.createElement("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6"},a.createElement("div",{className:"flex items-center gap-6"},t.logo&&a.createElement("img",{src:t.logo,alt:t.nombre,className:"w-20 h-20 bg-white rounded-lg p-2 object-contain"}),a.createElement("div",null,a.createElement("h1",{className:"text-3xl font-bold"},t.nombre),a.createElement("p",{className:"text-blue-100 mt-1"},t.categoria),a.createElement("div",{className:"flex items-center gap-4 mt-2 text-sm"},t.telefono&&a.createElement("span",null,"📞 ",t.telefono),t.email&&a.createElement("span",null,"📧 ",t.email))))),a.createElement("div",{className:"p-6 space-y-8"},n.descripcionCompleta&&a.createElement("section",null,a.createElement("h2",{className:"text-xl font-semibold mb-3"},"Acerca de Nosotros"),a.createElement("p",{className:"text-gray-700 leading-relaxed"},n.descripcionCompleta)),n.servicios.length>0&&a.createElement("section",null,a.createElement("h2",{className:"text-xl font-semibold mb-3"},"Nuestros Servicios"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},n.servicios.map((k,_)=>a.createElement("div",{key:_,className:"flex items-center gap-2 p-3 bg-blue-50 rounded-lg"},a.createElement("span",{className:"text-blue-600"},"✓"),a.createElement("span",null,k))))),n.caracteristicas.length>0&&a.createElement("section",null,a.createElement("h2",{className:"text-xl font-semibold mb-3"},"¿Por qué Elegirnos?"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},n.caracteristicas.map((k,_)=>a.createElement("div",{key:_,className:"flex items-center gap-2 p-3 border border-gray-200 rounded-lg"},a.createElement("span",{className:"text-green-600"},"⭐"),a.createElement("span",null,k))))),a.createElement("section",null,a.createElement("h2",{className:"text-xl font-semibold mb-3"},"Horarios de Atención"),a.createElement("div",{className:"bg-gray-50 p-4 rounded-lg"},a.createElement("p",{className:"text-gray-700"},T()))),n.testimonios.length>0&&a.createElement("section",null,a.createElement("h2",{className:"text-xl font-semibold mb-3"},"Lo que Dicen Nuestros Clientes"),a.createElement("div",{className:"space-y-4"},n.testimonios.map((k,_)=>a.createElement("div",{key:_,className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded"},a.createElement("div",{className:"flex items-center gap-1 mb-2"},[...Array(5)].map((S,N)=>a.createElement("span",{key:N,className:`text-lg ${N<k.rating?"text-yellow-500":"text-gray-300"}`},"⭐"))),a.createElement("p",{className:"text-gray-700 italic"},'"',k.comentario,'"'),a.createElement("p",{className:"text-gray-600 text-sm mt-2"},"- ",k.cliente))))),a.createElement("section",null,a.createElement("h2",{className:"text-xl font-semibold mb-3"},"Contacto"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",{className:"space-y-3"},t.direccion&&a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",null,"📍"),a.createElement("span",null,t.direccion)),n.contactoAdicional.whatsapp&&a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",null,"📱"),a.createElement("span",null,"WhatsApp: ",n.contactoAdicional.whatsapp))),a.createElement("div",{className:"space-y-3"},n.contactoAdicional.facebook&&a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",null,"📘"),a.createElement("span",null,"Facebook: ",n.contactoAdicional.facebook)),n.contactoAdicional.instagram&&a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",null,"📷"),a.createElement("span",null,"Instagram: ",n.contactoAdicional.instagram)))))))):a.createElement("div",{className:"p-6"},a.createElement("div",{className:"flex items-center justify-between mb-6"},a.createElement("div",null,a.createElement("h3",{className:"text-lg font-semibold"},"Perfil Web de la Empresa"),a.createElement("p",{className:"text-gray-600 text-sm mt-1"},t.web?"Información adicional para complementar el sitio web existente":"Crea un perfil web completo para empresas sin sitio web propio")),a.createElement("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200"},"👁️ Vista Previa")),a.createElement("div",{className:"space-y-8"},a.createElement("section",null,a.createElement("h4",{className:"font-medium text-gray-900 mb-3"},"Descripción Completa"),a.createElement("textarea",{value:n.descripcionCompleta,onChange:k=>r(_=>({..._,descripcionCompleta:k.target.value})),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe detalladamente la empresa, su historia, misión, especialidades..."})),a.createElement("section",null,a.createElement("h4",{className:"font-medium text-gray-900 mb-3"},"Servicios Ofrecidos"),a.createElement("div",{className:"space-y-3"},a.createElement("div",{className:"flex gap-2"},a.createElement("input",{type:"text",value:s,onChange:k=>i(k.target.value),onKeyPress:k=>k.key==="Enter"&&g(),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Reparación de frenos, Venta de repuestos..."}),a.createElement("button",{onClick:g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},"Agregar")),a.createElement("div",{className:"space-y-2"},n.servicios.map((k,_)=>a.createElement("div",{key:_,className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg"},a.createElement("span",null,k),a.createElement("button",{onClick:()=>v(_),className:"text-red-600 hover:text-red-800"},"✕")))))),a.createElement("section",null,a.createElement("h4",{className:"font-medium text-gray-900 mb-3"},"Características Distintivas"),a.createElement("div",{className:"space-y-3"},a.createElement("div",{className:"flex gap-2"},a.createElement("input",{type:"text",value:o,onChange:k=>l(k.target.value),onKeyPress:k=>k.key==="Enter"&&x(),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: 20 años de experiencia, Garantía extendida..."}),a.createElement("button",{onClick:x,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"},"Agregar")),a.createElement("div",{className:"space-y-2"},n.caracteristicas.map((k,_)=>a.createElement("div",{key:_,className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg"},a.createElement("span",null,k),a.createElement("button",{onClick:()=>E(_),className:"text-red-600 hover:text-red-800"},"✕")))))),a.createElement("section",null,a.createElement("h4",{className:"font-medium text-gray-900 mb-3"},"Información de Contacto Adicional"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"WhatsApp"),a.createElement("input",{type:"text",value:n.contactoAdicional.whatsapp,onChange:k=>r(_=>({..._,contactoAdicional:{..._.contactoAdicional,whatsapp:k.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"+56 9 1234 5678"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Facebook"),a.createElement("input",{type:"text",value:n.contactoAdicional.facebook,onChange:k=>r(_=>({..._,contactoAdicional:{..._.contactoAdicional,facebook:k.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"@empresapage"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Instagram"),a.createElement("input",{type:"text",value:n.contactoAdicional.instagram,onChange:k=>r(_=>({..._,contactoAdicional:{..._.contactoAdicional,instagram:k.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"@empresa"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Dirección Completa"),a.createElement("input",{type:"text",value:n.contactoAdicional.direccionCompleta,onChange:k=>r(_=>({..._,contactoAdicional:{..._.contactoAdicional,direccionCompleta:k.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Calle, número, comuna, región"})))),a.createElement("section",null,a.createElement("h4",{className:"font-medium text-gray-900 mb-3"},"Testimonios de Clientes"),a.createElement("div",{className:"space-y-4"},a.createElement("div",{className:"border border-gray-200 rounded-lg p-4"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3"},a.createElement("input",{type:"text",value:c.cliente,onChange:k=>u(_=>({..._,cliente:k.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre del cliente"}),a.createElement("select",{value:c.rating,onChange:k=>u(_=>({..._,rating:parseInt(k.target.value)})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},a.createElement("option",{value:5},"5 estrellas"),a.createElement("option",{value:4},"4 estrellas"),a.createElement("option",{value:3},"3 estrellas"),a.createElement("option",{value:2},"2 estrellas"),a.createElement("option",{value:1},"1 estrella")),a.createElement("button",{onClick:y,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700"},"Agregar")),a.createElement("textarea",{value:c.comentario,onChange:k=>u(_=>({..._,comentario:k.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Comentario del cliente..."})),a.createElement("div",{className:"space-y-3"},n.testimonios.map((k,_)=>a.createElement("div",{key:_,className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},a.createElement("div",{className:"flex items-center justify-between mb-2"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:"font-medium"},k.cliente),a.createElement("div",{className:"flex"},[...Array(5)].map((S,N)=>a.createElement("span",{key:N,className:`${N<k.rating?"text-yellow-500":"text-gray-300"}`},"⭐")))),a.createElement("button",{onClick:()=>h(_),className:"text-red-600 hover:text-red-800"},"✕")),a.createElement("p",{className:"text-gray-700"},'"',k.comentario,'"')))))),a.createElement("div",{className:"flex justify-end pt-6 border-t border-gray-200"},a.createElement("button",{onClick:C,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},"Guardar Perfil Web"))))}function O7(){const{empresaId:t}=GI(),e=ft(),[n,r]=p.useState(null),[s,i]=p.useState(!0),[o,l]=p.useState(!1),[c,u]=p.useState("general"),[d,f]=p.useState("");p.useEffect(()=>{g()},[t]);const g=async()=>{try{const y=we($,"empresas",t),h=await di(y);h.exists()?r({id:h.id,...h.data()}):f("Empresa no encontrada")}catch(y){console.error("Error cargando empresa:",y),f("Error al cargar la empresa")}finally{i(!1)}},v=async(y,h)=>{try{l(!0),await Me(we($,"empresas",t),{[y]:h,fecha_actualizacion:new Date}),r(C=>({...C,[y]:h})),setTimeout(()=>l(!1),1e3)}catch(C){console.error("Error actualizando empresa:",C),f("Error al actualizar la empresa"),l(!1)}},x=async(y,h="logo",C=null)=>{try{if(l(!0),h==="galeria"){await Me(we($,"empresas",t),{galeria:C,fecha_actualizacion:new Date}),r(_=>({..._,galeria:C}));return}if(y===null)return await Me(we($,"empresas",t),{logo:null,logoAsignado:!1,fecha_actualizacion:new Date}),r(_=>({..._,logo:null,logoAsignado:!1})),null;if(y.logoURL)return await Me(we($,"empresas",t),{logo:y.logoURL,logoAsignado:!0,logoAutomatico:y.esAutomatico||!1,fecha_actualizacion:new Date}),r(_=>({..._,logo:y.logoURL,logoAsignado:!0})),y.logoURL;const T=$c(Wc,`logos/empresas/${t}-${Date.now()}`);await Dm(T,y);const k=await Mm(T);return await Me(we($,"empresas",t),{logo:k,logoAsignado:!0,fecha_actualizacion:new Date}),r(_=>({..._,logo:k,logoAsignado:!0})),k}catch(T){throw console.error("Error subiendo logo:",T),T}finally{l(!1)}};if(s)return a.createElement("div",{className:"flex items-center justify-center p-8"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.createElement("p",{className:"text-gray-600"},"Cargando empresa...")));if(d)return a.createElement("div",{className:"p-6"},a.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4"},a.createElement("p",{className:"text-red-800"},d),a.createElement("button",{onClick:()=>e("/admin/empresas"),className:"mt-2 text-red-600 underline"},"Volver al listado")));if(!n)return null;const E=[{id:"general",label:"Información General",icon:"📋"},{id:"logo",label:"Logo",icon:"🖼️"},{id:"horarios",label:"Horarios",icon:"🕒"},{id:"perfil",label:"Perfil Web",icon:"🌐"}];return a.createElement("div",{className:"p-6 max-w-6xl mx-auto"},a.createElement("div",{className:"mb-6"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",null,a.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Editar Empresa: ",n.nombre),a.createElement("p",{className:"text-gray-600 mt-1"},"Gestiona la información, logo, horarios y perfil web de la empresa")),a.createElement("div",{className:"flex items-center gap-3"},o&&a.createElement("div",{className:"flex items-center gap-2 text-green-600"},a.createElement("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600"}),a.createElement("span",{className:"text-sm"},"Guardando...")),a.createElement("button",{onClick:()=>e("/admin/empresas"),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors"},"← Volver"))),a.createElement("div",{className:"mt-4 flex items-center gap-4"},a.createElement("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${n.estado==="Activa"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},n.estado||"Sin estado"),n.web?a.createElement("a",{href:n.web.startsWith("http")?n.web:`https://${n.web}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm underline"},"🔗 Ver sitio web"):a.createElement("a",{href:`/perfil-empresa/${t}`,target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:text-green-800 text-sm underline"},"🌐 Ver Perfil Público"))),a.createElement("div",{className:"mb-6"},a.createElement("div",{className:"border-b border-gray-200"},a.createElement("nav",{className:"-mb-px flex space-x-8"},E.map(y=>a.createElement("button",{key:y.id,onClick:()=>u(y.id),className:`py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${c===y.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`},a.createElement("span",{className:"mr-2"},y.icon),y.label))))),a.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},c==="general"&&a.createElement(V7,{empresa:n,onUpdate:v,saving:o}),c==="logo"&&a.createElement(R7,{empresa:n,onLogoUpload:x,saving:o}),c==="horarios"&&a.createElement(D7,{empresa:n,onUpdate:v,saving:o}),c==="perfil"&&a.createElement(M7,{empresa:n,onUpdate:v})))}function V7({empresa:t,onUpdate:e,saving:n}){const[r,s]=p.useState({nombre:t.nombre||"",email:t.email||"",telefono:t.telefono||"",direccion:t.direccion||"",web:t.web||"",categoria:t.categoria||"",descripcion:t.descripcion||"",estado:t.estado||"Inactiva"}),i=l=>{const{name:c,value:u}=l.target;s(d=>({...d,[c]:u}))},o=()=>{Object.keys(r).forEach(l=>{r[l]!==t[l]&&e(l,r[l])})};return a.createElement("div",{className:"p-6"},a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Información General"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombre de la empresa *"),a.createElement("input",{type:"text",name:"nombre",value:r.nombre,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email *"),a.createElement("input",{type:"email",name:"email",value:r.email,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono"),a.createElement("input",{type:"tel",name:"telefono",value:r.telefono,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Sitio web"),a.createElement("input",{type:"url",name:"web",value:r.web,onChange:i,placeholder:"https://ejemplo.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Categoría"),a.createElement("select",{name:"categoria",value:r.categoria,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},a.createElement("option",{value:""},"Seleccionar categoría"),a.createElement("option",{value:"Repuestos"},"Repuestos"),a.createElement("option",{value:"Servicios"},"Servicios"),a.createElement("option",{value:"Talleres"},"Talleres"),a.createElement("option",{value:"Seguros"},"Seguros"),a.createElement("option",{value:"Venta de Vehículos"},"Venta de Vehículos"),a.createElement("option",{value:"Otros"},"Otros"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Estado"),a.createElement("select",{name:"estado",value:r.estado,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},a.createElement("option",{value:"Activa"},"Activa"),a.createElement("option",{value:"Inactiva"},"Inactiva"),a.createElement("option",{value:"En Revisión"},"En Revisión"),a.createElement("option",{value:"Suspendida"},"Suspendida")))),a.createElement("div",{className:"mt-6"},a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Dirección"),a.createElement("input",{type:"text",name:"direccion",value:r.direccion,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",{className:"mt-6"},a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Descripción"),a.createElement("textarea",{name:"descripcion",value:r.descripcion,onChange:i,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Descripción de la empresa y sus servicios..."})),a.createElement("div",{className:"mt-6 flex justify-end"},a.createElement("button",{onClick:o,disabled:n,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors"},n?"Guardando...":"Guardar Cambios")))}function ph(t){return t?t.startsWith("http")?t:`/images/${t}`:""}function fh(t){if(!t)return"bg-gray-100 text-gray-800";switch(t.toLowerCase()){case"enviado":case"pendiente":return"bg-yellow-100 text-yellow-800";case"activo":case"activa":return"bg-green-100 text-green-800";case"revision":case"en revisión":case"en revision":return"bg-orange-100 text-orange-800";case"cancelado":case"inactivo":case"inactiva":return"bg-red-100 text-red-800";case"suspendido":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}}function j7(){const[t,e]=p.useState([]),[n,r]=p.useState([]),[s,i]=p.useState({estado:"",busqueda:"",tipoVista:"grid",mostrar:"todos"}),[o,l]=p.useState(!0),[c,u]=p.useState(null),[d,f]=p.useState(!1),g=ft();p.useEffect(()=>{console.log("🔍 ListadoProveedoresAdmin: Iniciando carga de datos...");const h=pe(Q($,"empresas"),Et("fecha_registro","desc")),C=Dt(h,_=>{const S=_.docs.map(N=>({id:N.id,...N.data(),tipo:"empresa"}));console.log("🏢 Empresas cargadas:",S.length,S),e(S)},_=>{console.error("❌ Error cargando empresas:",_);const S=Q($,"empresas");Dt(S,N=>{const b=N.docs.map(w=>({id:w.id,...w.data(),tipo:"empresa"}));console.log("🏢 Empresas cargadas (sin orden):",b.length,b),e(b)})}),T=pe(Q($,"solicitudes_empresa"),Et("fecha_solicitud","desc")),k=Dt(T,_=>{const S=_.docs.map(N=>({id:N.id,...N.data(),tipo:"solicitud"}));console.log("📋 Solicitudes cargadas:",S.length,S),r(S),l(!1)},_=>{console.error("❌ Error cargando solicitudes:",_);const S=Q($,"solicitudes_empresa");Dt(S,N=>{const b=N.docs.map(w=>({id:w.id,...w.data(),tipo:"solicitud"}));console.log("📋 Solicitudes cargadas (sin orden):",b.length,b),r(b),l(!1)})});return()=>{C(),k()}},[]);const v=()=>{let h=[];return(s.mostrar==="todos"||s.mostrar==="empresas")&&(h=[...h,...t]),(s.mostrar==="todos"||s.mostrar==="solicitudes")&&(h=[...h,...n]),console.log(`📊 Combinando datos: filtro="${s.mostrar}", empresas=${t.length}, solicitudes=${n.length}, total=${h.length}`),h},x=v().filter(h=>{var C,T,k,_,S,N,b;if(s.estado&&h.estado!==s.estado)return!1;if(s.busqueda){const w=s.busqueda.toLowerCase();return((C=h.nombre)==null?void 0:C.toLowerCase().includes(w))||((T=h.nombre_empresa)==null?void 0:T.toLowerCase().includes(w))||((k=h.email)==null?void 0:k.toLowerCase().includes(w))||((_=h.email_empresa)==null?void 0:_.toLowerCase().includes(w))||((S=h.rut)==null?void 0:S.toLowerCase().includes(w))||((N=h.rut_empresa)==null?void 0:N.toLowerCase().includes(w))||((b=h.agente_nombre)==null?void 0:b.toLowerCase().includes(w))}return!0});console.log(`🔍 Después del filtrado: ${x.length} items mostrados de ${v().length} totales`),console.log("📋 Items filtrados:",x);const E=async(h,C)=>{try{await Me(we($,"empresas",h),{estado:C,fechaActualizacion:new Date})}catch(T){console.error("Error al actualizar estado:",T)}},y=h=>h?(h.toDate?h.toDate():new Date(h)).toLocaleDateString("es-CL"):"N/A";return o?a.createElement("div",{className:"flex items-center justify-center h-64"},a.createElement("div",{className:"text-lg"},"Cargando proveedores...")):a.createElement("div",{className:"p-6 bg-gray-50 min-h-screen"},a.createElement("div",{className:"mb-6"},a.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Gestión de Proveedores y Empresas"),a.createElement("p",{className:"text-gray-600"},"Administra empresas activas y solicitudes de registro (incluyendo las de agentes de campo)")),a.createElement("div",{className:"mb-6 bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-lg p-4"},a.createElement("div",{className:"flex items-start"},a.createElement("div",{className:"flex-shrink-0"},a.createElement("span",{className:"text-2xl"},"ℹ️")),a.createElement("div",{className:"ml-3"},a.createElement("h3",{className:"text-sm font-medium text-green-900 mb-2"},"Vista Unificada: Empresas y Solicitudes"),a.createElement("div",{className:"text-sm text-green-700 space-y-1"},a.createElement("p",null,"• ",a.createElement("strong",null,"Empresas Activas"),": Proveedores ya registrados y funcionando"),a.createElement("p",null,"• ",a.createElement("strong",null,"Solicitudes"),": Nuevas empresas pendientes (web y agentes de campo)"),a.createElement("p",null,"• ",a.createElement("strong",null,"Filtros"),': Usa el filtro "Mostrar" para ver solo empresas, solo solicitudes o ambos'))))),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6"},a.createElement("div",{className:"bg-white rounded-lg shadow p-4"},a.createElement("div",{className:"flex items-center"},a.createElement("div",{className:"p-2 bg-green-100 rounded-lg"},a.createElement("span",{className:"text-xl"},"🏢")),a.createElement("div",{className:"ml-3"},a.createElement("p",{className:"text-xl font-bold text-gray-900"},t.length),a.createElement("p",{className:"text-gray-600 text-sm"},"Empresas Activas")))),a.createElement("div",{className:"bg-white rounded-lg shadow p-4"},a.createElement("div",{className:"flex items-center"},a.createElement("div",{className:"p-2 bg-blue-100 rounded-lg"},a.createElement("span",{className:"text-xl"},"📋")),a.createElement("div",{className:"ml-3"},a.createElement("p",{className:"text-xl font-bold text-blue-900"},n.length),a.createElement("p",{className:"text-blue-600 text-sm"},"Solicitudes Total")))),a.createElement("div",{className:"bg-white rounded-lg shadow p-4"},a.createElement("div",{className:"flex items-center"},a.createElement("div",{className:"p-2 bg-green-100 rounded-lg"},a.createElement("span",{className:"text-xl"},"✅")),a.createElement("div",{className:"ml-3"},a.createElement("p",{className:"text-xl font-bold text-green-600"},t.filter(h=>h.estado==="activa").length),a.createElement("p",{className:"text-green-600 text-sm"},"Activas")))),a.createElement("div",{className:"bg-white rounded-lg shadow p-4"},a.createElement("div",{className:"flex items-center"},a.createElement("div",{className:"p-2 bg-yellow-100 rounded-lg"},a.createElement("span",{className:"text-xl"},"⏳")),a.createElement("div",{className:"ml-3"},a.createElement("p",{className:"text-xl font-bold text-yellow-600"},n.filter(h=>h.estado==="pendiente"||h.estado==="en_revision").length),a.createElement("p",{className:"text-yellow-600 text-sm"},"Pendientes")))),a.createElement("div",{className:"bg-white rounded-lg shadow p-4"},a.createElement("div",{className:"flex items-center"},a.createElement("div",{className:"p-2 bg-purple-100 rounded-lg"},a.createElement("span",{className:"text-xl"},"👨‍💼")),a.createElement("div",{className:"ml-3"},a.createElement("p",{className:"text-xl font-bold text-purple-600"},n.filter(h=>h.agente_id||h.origen==="agente_campo").length),a.createElement("p",{className:"text-purple-600 text-sm"},"De Agentes"))))),a.createElement("div",{className:"bg-white rounded-lg shadow mb-6 p-6"},a.createElement("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},a.createElement("div",{className:"flex flex-col md:flex-row gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Mostrar"),a.createElement("select",{value:s.mostrar,onChange:h=>i({...s,mostrar:h.target.value}),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},a.createElement("option",{value:"todos"},"Todo (Empresas y Solicitudes)"),a.createElement("option",{value:"empresas"},"Solo Empresas Activas"),a.createElement("option",{value:"solicitudes"},"Solo Solicitudes"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Estado"),a.createElement("select",{value:s.estado,onChange:h=>i({...s,estado:h.target.value}),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},a.createElement("option",{value:""},"Todos los estados"),a.createElement("option",{value:"activa"},"Activos"),a.createElement("option",{value:"pendiente"},"Pendientes"),a.createElement("option",{value:"en_revision"},"En Revisión"),a.createElement("option",{value:"activada"},"Activadas (Visible en Home)"),a.createElement("option",{value:"credenciales_asignadas"},"Con Credenciales"),a.createElement("option",{value:"inactiva"},"Inactivos"),a.createElement("option",{value:"rechazada"},"Rechazadas"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Buscar"),a.createElement("input",{type:"text",placeholder:"Buscar por nombre, email, RUT o agente...",value:s.busqueda,onChange:h=>i({...s,busqueda:h.target.value}),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 min-w-64"}))),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Vista:"),a.createElement("div",{className:"flex bg-gray-100 rounded-lg p-1"},a.createElement("button",{onClick:()=>i({...s,tipoVista:"grid"}),className:`px-3 py-1 rounded text-sm ${s.tipoVista==="grid"?"bg-white shadow text-blue-600":"text-gray-600 hover:text-gray-900"}`},"📊 Tarjetas"),a.createElement("button",{onClick:()=>i({...s,tipoVista:"table"}),className:`px-3 py-1 rounded text-sm ${s.tipoVista==="table"?"bg-white shadow text-blue-600":"text-gray-600 hover:text-gray-900"}`},"📋 Tabla"))))),a.createElement("div",{className:"mb-4 flex justify-between items-center"},a.createElement("p",{className:"text-gray-600"},"Mostrando ",x.length," de ",v().length," elementos (",t.length," empresas activas, ",n.length," solicitudes)"),a.createElement("button",{onClick:async()=>{console.log("=== DEBUG INFO ==="),console.log("Proveedores:",t),console.log("Solicitudes:",n),console.log("Filtros:",s),console.log("Items filtrados:",x),console.log("Total items:",v());try{const h=await ue(Q($,"empresas"));console.log("=== EMPRESAS EN FIRESTORE ==="),console.log("Total documentos en empresas:",h.size),h.docs.forEach(T=>{console.log(`Empresa ${T.id}:`,T.data())});const C=await ue(Q($,"solicitudes_empresa"));console.log("=== SOLICITUDES EN FIRESTORE ==="),console.log("Total documentos en solicitudes:",C.size),C.docs.forEach(T=>{console.log(`Solicitud ${T.id}:`,T.data())})}catch(h){console.error("Error en debug:",h)}},className:"px-3 py-1 bg-yellow-500 text-white rounded text-sm hover:bg-yellow-600"},"🐛 Debug")),x.length===0?a.createElement("div",{className:"bg-white rounded-lg shadow p-12 text-center"},a.createElement("span",{className:"text-6xl mb-4 block"},"🔍"),a.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No se encontraron elementos"),a.createElement("p",{className:"text-gray-600"},"Intenta ajustar los filtros de búsqueda")):a.createElement(a.Fragment,null,s.tipoVista==="grid"&&a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},x.map(h=>a.createElement("div",{key:`${h.tipo}-${h.id}`,className:"bg-white rounded-lg shadow hover:shadow-lg transition-shadow p-6"},a.createElement("div",{className:"flex items-start justify-between mb-4"},a.createElement("div",{className:"flex items-center"},a.createElement("div",{className:"w-12 h-12 rounded flex items-center justify-center"},h.tipo==="empresa"?h.logo?a.createElement("img",{src:ph(h.logo),alt:"Logo",className:"w-12 h-12 object-contain rounded border bg-gray-50"}):a.createElement("div",{className:"w-12 h-12 bg-green-100 rounded flex items-center justify-center"},a.createElement("span",{className:"text-green-600 text-xl"},"🏢")):a.createElement("div",{className:"w-12 h-12 bg-blue-100 rounded flex items-center justify-center"},a.createElement("span",{className:"text-blue-600 text-xl"},"📋"))),a.createElement("div",{className:"ml-3"},a.createElement("h3",{className:"font-semibold text-gray-900"},h.nombre||h.nombre_empresa||"Sin nombre"),a.createElement("p",{className:"text-sm text-gray-600"},h.rut||h.rut_empresa||"Sin RUT"),h.tipo==="solicitud"&&a.createElement("p",{className:"text-xs text-blue-600 font-medium"},h.agente_nombre?`Por agente: ${h.agente_nombre}`:"Solicitud web"))),a.createElement("div",{className:"flex flex-col items-end"},a.createElement("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${fh(h.estado)}`},h.estado||"Sin estado"),a.createElement("span",{className:"text-xs text-gray-500 mt-1"},h.tipo==="empresa"?"Empresa":"Solicitud"))),a.createElement("div",{className:"space-y-2 mb-4"},a.createElement("div",{className:"flex items-center text-sm text-gray-600"},a.createElement("span",{className:"w-4"},"📧"),a.createElement("span",{className:"ml-2"},h.email||h.email_empresa||"Sin email")),h.telefono||h.telefono_empresa?a.createElement("div",{className:"flex items-center text-sm text-gray-600"},a.createElement("span",{className:"w-4"},"📱"),a.createElement("span",{className:"ml-2"},h.telefono||h.telefono_empresa)):null,h.tipo==="empresa"&&a.createElement("div",{className:"flex items-center text-sm text-gray-600"},a.createElement("span",{className:"w-4"},"🌐"),a.createElement("span",{className:"ml-2"},h.web?a.createElement("a",{href:h.web.startsWith("http")?h.web:`https://${h.web}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},h.web):"Sin sitio web")),a.createElement("div",{className:"flex items-center text-sm text-gray-600"},a.createElement("span",{className:"w-4"},"📅"),a.createElement("span",{className:"ml-2"},h.tipo==="empresa"?`Registrado: ${y(h.fecha_registro)}`:`Solicitado: ${y(h.fecha_solicitud)}`))),a.createElement("div",{className:"flex gap-2"},a.createElement("button",{onClick:()=>{u(h),f(!0)},className:"flex-1 bg-blue-600 text-white px-3 py-2 rounded text-sm hover:bg-blue-700 transition-colors"},"Ver Detalles"),h.tipo==="empresa"?a.createElement("button",{onClick:()=>g(`/admin/editar-empresa/${h.id}`),className:"flex-1 bg-gray-600 text-white px-3 py-2 rounded text-sm hover:bg-gray-700 transition-colors"},"Editar"):a.createElement("button",{onClick:()=>g("/admin/solicitudes-registro"),className:"flex-1 bg-purple-600 text-white px-3 py-2 rounded text-sm hover:bg-purple-700 transition-colors"},"Gestionar"))))),s.tipoVista==="table"&&a.createElement("div",{className:"bg-white rounded-lg shadow overflow-hidden"},a.createElement("div",{className:"overflow-x-auto"},a.createElement("table",{className:"min-w-full divide-y divide-gray-200"},a.createElement("thead",{className:"bg-gray-50"},a.createElement("tr",null,a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tipo / Empresa"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Contacto"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Fecha / Agente"),a.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),a.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},x.map(h=>a.createElement("tr",{key:`${h.tipo}-${h.id}`,className:"hover:bg-gray-50"},a.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},a.createElement("div",{className:"flex items-center"},h.tipo==="empresa"?h.logo?a.createElement("img",{src:ph(h.logo),alt:"Logo",className:"w-10 h-10 object-contain rounded border bg-gray-50"}):a.createElement("div",{className:"w-10 h-10 bg-green-100 rounded flex items-center justify-center"},a.createElement("span",{className:"text-green-600"},"🏢")):a.createElement("div",{className:"w-10 h-10 bg-blue-100 rounded flex items-center justify-center"},a.createElement("span",{className:"text-blue-600"},"📋")),a.createElement("div",{className:"ml-4"},a.createElement("div",{className:"text-sm font-medium text-gray-900"},h.nombre||h.nombre_empresa||"Sin nombre"),a.createElement("div",{className:"text-sm text-gray-500"},h.rut||h.rut_empresa||"Sin RUT"),a.createElement("div",{className:"text-xs text-gray-400"},h.tipo==="empresa"?"Empresa Activa":"Solicitud")))),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},a.createElement("div",{className:"text-sm text-gray-900"},h.email||h.email_empresa||"Sin email"),a.createElement("div",{className:"text-sm text-gray-500"},h.telefono||h.telefono_empresa||"Sin teléfono")),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},a.createElement("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${fh(h.estado)}`},h.estado||"Sin estado")),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},a.createElement("div",null,h.tipo==="empresa"?y(h.fecha_registro):y(h.fecha_solicitud)),h.agente_nombre&&a.createElement("div",{className:"text-xs text-purple-600"},"Agente: ",h.agente_nombre)),a.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},a.createElement("div",{className:"flex space-x-2"},a.createElement("button",{onClick:()=>{u(h),f(!0)},className:"text-blue-600 hover:text-blue-900"},"Ver"),h.tipo==="empresa"?a.createElement(a.Fragment,null,a.createElement("button",{onClick:()=>g(`/admin/editar-empresa/${h.id}`),className:"text-gray-600 hover:text-gray-900"},"Editar"),a.createElement("select",{value:h.estado||"",onChange:C=>E(h.id,C.target.value),className:"text-xs border border-gray-300 rounded px-2 py-1"},a.createElement("option",{value:"activa"},"Activo"),a.createElement("option",{value:"inactiva"},"Inactivo"),a.createElement("option",{value:"suspendida"},"Suspendido"))):a.createElement("button",{onClick:()=>g("/admin/solicitudes-registro"),className:"text-purple-600 hover:text-purple-900"},"Gestionar")))))))))),d&&c&&a.createElement("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},a.createElement("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white"},a.createElement("div",{className:"mt-3"},a.createElement("div",{className:"flex justify-between items-center mb-4"},a.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Detalles del Proveedor"),a.createElement("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600"},"✕")),a.createElement("div",{className:"space-y-4 max-h-96 overflow-y-auto"},a.createElement("div",{className:"flex items-center mb-6"},c.logo?a.createElement("img",{src:ph(c.logo),alt:"Logo",className:"w-16 h-16 object-contain rounded border bg-gray-50"}):a.createElement("div",{className:"w-16 h-16 bg-gray-200 rounded flex items-center justify-center"},a.createElement("span",{className:"text-gray-500 text-2xl"},"🏢")),a.createElement("div",{className:"ml-4"},a.createElement("h4",{className:"text-xl font-semibold"},c.nombre||"Sin nombre"),a.createElement("p",{className:"text-gray-600"},c.rut||"Sin RUT"))),a.createElement("div",{className:"grid grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Email"),a.createElement("p",{className:"text-sm text-gray-900"},c.email||"N/A")),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Teléfono"),a.createElement("p",{className:"text-sm text-gray-900"},c.telefono||"N/A")),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Dirección"),a.createElement("p",{className:"text-sm text-gray-900"},c.direccion||"N/A")),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Estado"),a.createElement("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${fh(c.estado)}`},c.estado||"Sin estado")),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Sitio Web"),c.web?a.createElement("a",{href:c.web.startsWith("http")?c.web:`https://${c.web}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-sm"},c.web):a.createElement("p",{className:"text-sm text-gray-900"},"N/A")),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Fecha de Registro"),a.createElement("p",{className:"text-sm text-gray-900"},y(c.fechaRegistro))))),a.createElement("div",{className:"mt-6 flex justify-end space-x-3"},a.createElement("button",{onClick:()=>{g(`/admin/editar-empresa/${c.id}`),f(!1)},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"},"Editar Proveedor"),a.createElement("button",{onClick:()=>f(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400"},"Cerrar"))))))}function F7(){const{user:t,rol:e}=Qe(),[n,r]=p.useState([]),[s,i]=p.useState([]),[o,l]=p.useState([]),[c,u]=p.useState([]),[d,f]=p.useState(!0),[g,v]=p.useState("cotizar"),[x,E]=p.useState(!1);p.useState({}),p.useEffect(()=>{y()},[]);const y=async()=>{try{const k=await ue(Q($,"companias_seguros"));r(k.docs.map(S=>({id:S.id,...S.data()})));const _=await ue(Q($,"tipos_seguros"));if(i(_.docs.map(S=>({id:S.id,...S.data()}))),t){const S=pe(Q($,"cotizaciones_seguros"),fe("userId","==",t.uid)),N=await ue(S);l(N.docs.map(A=>({id:A.id,...A.data()})));const b=pe(Q($,"polizas_seguros"),fe("userId","==",t.uid)),w=await ue(b);u(w.docs.map(A=>({id:A.id,...A.data()})))}}catch(k){console.error("Error loading data:",k)}finally{f(!1)}},h=async k=>{try{const _={userId:t.uid,vehiculo:k,estado:"pendiente",fechaCreacion:new Date,companias:n.map(S=>({id:S.id,nombre:S.nombre,cotizacion:C(k,S)}))};await ze(Q($,"cotizaciones_seguros"),_),await y(),E(!1)}catch(_){console.error("Error creating cotización:",_)}},C=(k,_)=>{const S=k.valor*.02,N=k.antiguedad>10?1.3:1,b=k.region==="RM"?1.2:1;return Math.round(S*N*b*_.factor)},T=async(k,_)=>{try{const S=o.find(w=>w.id===k),N=S.companias.find(w=>w.id===_),b={userId:t.uid,cotizacionId:k,companiaId:_,vehiculo:S.vehiculo,prima:N.cotizacion,estado:"activa",fechaInicio:new Date,fechaVencimiento:new Date(Date.now()+365*24*60*60*1e3),numeroPoliza:`POL-${Date.now()}`};await ze(Q($,"polizas_seguros"),b),await Me(we($,"cotizaciones_seguros",k),{estado:"contratada"}),await y()}catch(S){console.error("Error contracting insurance:",S)}};return d?a.createElement("div",{className:"container mx-auto px-4 py-8"},a.createElement("div",{className:"animate-pulse"},a.createElement("div",{className:"h-8 bg-gray-300 rounded mb-4"}),a.createElement("div",{className:"space-y-4"},[1,2,3].map(k=>a.createElement("div",{key:k,className:"h-20 bg-gray-300 rounded"}))))):a.createElement("div",{className:"container mx-auto px-4 py-8"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg p-6"},a.createElement("h1",{className:"text-3xl font-bold text-gray-800 mb-6"},"🛡️ Seguros Automotrices"),a.createElement("div",{className:"flex space-x-4 mb-6 border-b"},a.createElement("button",{className:`pb-2 px-4 ${g==="cotizar"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>v("cotizar")},"Cotizar Seguro"),a.createElement("button",{className:`pb-2 px-4 ${g==="cotizaciones"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>v("cotizaciones")},"Mis Cotizaciones"),a.createElement("button",{className:`pb-2 px-4 ${g==="polizas"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>v("polizas")},"Mis Pólizas"),e==="admin"&&a.createElement("button",{className:`pb-2 px-4 ${g==="admin"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>v("admin")},"Administración")),g==="cotizar"&&a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"bg-blue-50 p-4 rounded-lg"},a.createElement("h3",{className:"text-lg font-semibold mb-2"},"Cotiza tu seguro automotriz"),a.createElement("p",{className:"text-gray-700 mb-4"},"Compara precios de las principales compañías de seguros en Chile"),a.createElement("button",{className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",onClick:()=>E(!0)},"Iniciar Cotización")),a.createElement("div",null,a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Compañías Disponibles"),a.createElement("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4"},n.map(k=>{var _;return a.createElement("div",{key:k.id,className:"border rounded-lg p-4"},a.createElement("div",{className:"flex items-center gap-3 mb-2"},a.createElement("img",{src:k.logo||"/images/default-insurance.png",alt:k.nombre,className:"w-12 h-12 object-contain"}),a.createElement("div",null,a.createElement("h4",{className:"font-semibold"},k.nombre),a.createElement("div",{className:"flex items-center gap-1"},a.createElement("span",{className:"text-yellow-500"},"★"),a.createElement("span",{className:"text-sm"},k.rating||4.5)))),a.createElement("p",{className:"text-sm text-gray-600"},k.descripcion),a.createElement("div",{className:"mt-2 flex flex-wrap gap-1"},(_=k.cobertura)==null?void 0:_.map(S=>a.createElement("span",{key:S,className:"text-xs bg-gray-100 px-2 py-1 rounded"},S))))})))),g==="cotizaciones"&&a.createElement("div",{className:"space-y-4"},a.createElement("h3",{className:"text-lg font-semibold"},"Mis Cotizaciones"),o.length===0?a.createElement("p",{className:"text-gray-500"},"No tienes cotizaciones aún."):o.map(k=>a.createElement("div",{key:k.id,className:"border rounded-lg p-4"},a.createElement("div",{className:"flex justify-between items-start mb-2"},a.createElement("div",null,a.createElement("h4",{className:"font-semibold"},k.vehiculo.marca," ",k.vehiculo.modelo," ",k.vehiculo.año),a.createElement("p",{className:"text-sm text-gray-600"},"Patente: ",k.vehiculo.patente)),a.createElement("span",{className:`px-2 py-1 rounded text-xs ${k.estado==="pendiente"?"bg-yellow-100 text-yellow-800":k.estado==="contratada"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`},k.estado)),a.createElement("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-3 mt-4"},k.companias.map(_=>a.createElement("div",{key:_.id,className:"border rounded p-3"},a.createElement("div",{className:"flex justify-between items-center"},a.createElement("span",{className:"font-medium"},_.nombre),a.createElement("span",{className:"text-lg font-bold text-blue-600"},"$",_.cotizacion.toLocaleString())),k.estado==="pendiente"&&a.createElement("button",{className:"w-full mt-2 bg-green-600 text-white py-1 px-3 rounded text-sm hover:bg-green-700",onClick:()=>T(k.id,_.id)},"Contratar"))))))),g==="polizas"&&a.createElement("div",{className:"space-y-4"},a.createElement("h3",{className:"text-lg font-semibold"},"Mis Pólizas"),c.length===0?a.createElement("p",{className:"text-gray-500"},"No tienes pólizas contratadas."):c.map(k=>a.createElement("div",{key:k.id,className:"border rounded-lg p-4"},a.createElement("div",{className:"flex justify-between items-start mb-4"},a.createElement("div",null,a.createElement("h4",{className:"font-semibold"},"Póliza #",k.numeroPoliza),a.createElement("p",{className:"text-sm text-gray-600"},k.vehiculo.marca," ",k.vehiculo.modelo," ",k.vehiculo.año)),a.createElement("span",{className:`px-2 py-1 rounded text-xs ${k.estado==="activa"?"bg-green-100 text-green-800":k.estado==="vencida"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`},k.estado)),a.createElement("div",{className:"grid md:grid-cols-3 gap-4 text-sm"},a.createElement("div",null,a.createElement("span",{className:"text-gray-600"},"Prima Mensual:"),a.createElement("p",{className:"font-semibold"},"$",(k.prima/12).toLocaleString())),a.createElement("div",null,a.createElement("span",{className:"text-gray-600"},"Inicio:"),a.createElement("p",{className:"font-semibold"},new Date(k.fechaInicio.seconds*1e3).toLocaleDateString())),a.createElement("div",null,a.createElement("span",{className:"text-gray-600"},"Vencimiento:"),a.createElement("p",{className:"font-semibold"},new Date(k.fechaVencimiento.seconds*1e3).toLocaleDateString()))),a.createElement("div",{className:"flex gap-2 mt-4"},a.createElement("button",{className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Ver Detalles"),a.createElement("button",{className:"bg-gray-600 text-white px-4 py-2 rounded text-sm hover:bg-gray-700"},"Descargar Póliza")))))),x&&a.createElement(z7,{onClose:()=>E(!1),onSubmit:h,tiposSeguros:s}))}function z7({onClose:t,onSubmit:e,tiposSeguros:n}){const[r,s]=p.useState({marca:"",modelo:"",año:"",patente:"",valor:"",uso:"particular",region:"",tipoSeguro:""}),i=o=>{o.preventDefault(),e(r)};return a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto"},a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Datos del Vehículo"),a.createElement("form",{onSubmit:i,className:"space-y-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Marca"),a.createElement("input",{type:"text",className:"w-full border rounded px-3 py-2",value:r.marca,onChange:o=>s(l=>({...l,marca:o.target.value})),required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Modelo"),a.createElement("input",{type:"text",className:"w-full border rounded px-3 py-2",value:r.modelo,onChange:o=>s(l=>({...l,modelo:o.target.value})),required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Año"),a.createElement("input",{type:"number",className:"w-full border rounded px-3 py-2",value:r.año,onChange:o=>s(l=>({...l,año:parseInt(o.target.value)})),min:"1990",max:new Date().getFullYear()+1,required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Patente"),a.createElement("input",{type:"text",className:"w-full border rounded px-3 py-2",value:r.patente,onChange:o=>s(l=>({...l,patente:o.target.value.toUpperCase()})),placeholder:"XXXX00",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Valor del Vehículo (UF)"),a.createElement("input",{type:"number",className:"w-full border rounded px-3 py-2",value:r.valor,onChange:o=>s(l=>({...l,valor:parseInt(o.target.value)})),required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Uso del Vehículo"),a.createElement("select",{className:"w-full border rounded px-3 py-2",value:r.uso,onChange:o=>s(l=>({...l,uso:o.target.value})),required:!0},a.createElement("option",{value:"particular"},"Particular"),a.createElement("option",{value:"comercial"},"Comercial"),a.createElement("option",{value:"taxi"},"Taxi"),a.createElement("option",{value:"uber"},"Uber/Cabify"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Región"),a.createElement("select",{className:"w-full border rounded px-3 py-2",value:r.region,onChange:o=>s(l=>({...l,region:o.target.value})),required:!0},a.createElement("option",{value:""},"Seleccionar región"),a.createElement("option",{value:"RM"},"Región Metropolitana"),a.createElement("option",{value:"V"},"Valparaíso"),a.createElement("option",{value:"VIII"},"Biobío"),a.createElement("option",{value:"IX"},"La Araucanía"),a.createElement("option",{value:"X"},"Los Lagos"))),a.createElement("div",{className:"flex gap-2 pt-4"},a.createElement("button",{type:"button",className:"flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded hover:bg-gray-50",onClick:t},"Cancelar"),a.createElement("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700"},"Cotizar")))))}function U7(){const{user:t,rol:e}=Qe(),[n,r]=p.useState([]),[s,i]=p.useState([]),[o,l]=p.useState([]),[c,u]=p.useState(!0),[d,f]=p.useState("agendar"),[g,v]=p.useState(!1),[x,E]=p.useState(null);p.useEffect(()=>{y()},[]);const y=async()=>{try{const k=await ue(Q($,"centros_revision"));if(r(k.docs.map(_=>({id:_.id,..._.data()}))),t){const _=pe(Q($,"revisiones_tecnicas"),fe("userId","==",t.uid)),S=await ue(_);i(S.docs.map(w=>({id:w.id,...w.data()})));const N=pe(Q($,"vehiculos_usuario"),fe("userId","==",t.uid)),b=await ue(N);l(b.docs.map(w=>({id:w.id,...w.data()})))}}catch(k){console.error("Error loading data:",k)}finally{u(!1)}},h=async k=>{try{const _={userId:t.uid,centroId:k.centroId,vehiculoId:k.vehiculoId,fechaCita:k.fecha,horaCita:k.hora,tipoRevision:k.tipo,estado:"agendada",precio:k.precio,fechaCreacion:new Date};await ze(Q($,"revisiones_tecnicas"),_),await y(),v(!1)}catch(_){console.error("Error scheduling revision:",_)}},C=k=>{if(!k)return null;const _=new Date(k.fecha.seconds*1e3);return _.setFullYear(_.getFullYear()+1),_},T=k=>{if(!k)return null;const S=k-new Date;return Math.ceil(S/(1e3*60*60*24))};return c?a.createElement("div",{className:"container mx-auto px-4 py-8"},a.createElement("div",{className:"animate-pulse"},a.createElement("div",{className:"h-8 bg-gray-300 rounded mb-4"}),a.createElement("div",{className:"space-y-4"},[1,2,3].map(k=>a.createElement("div",{key:k,className:"h-20 bg-gray-300 rounded"}))))):a.createElement("div",{className:"container mx-auto px-4 py-8"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg p-6"},a.createElement("h1",{className:"text-3xl font-bold text-gray-800 mb-6"},"🔧 Revisión Técnica"),a.createElement("div",{className:"flex space-x-4 mb-6 border-b"},a.createElement("button",{className:`pb-2 px-4 ${d==="agendar"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>f("agendar")},"Agendar Cita"),a.createElement("button",{className:`pb-2 px-4 ${d==="revisiones"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>f("revisiones")},"Mis Revisiones"),a.createElement("button",{className:`pb-2 px-4 ${d==="recordatorios"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>f("recordatorios")},"Recordatorios"),e==="admin"&&a.createElement("button",{className:`pb-2 px-4 ${d==="admin"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>f("admin")},"Administración")),d==="agendar"&&a.createElement("div",{className:"space-y-6"},o.length>0&&a.createElement("div",{className:"bg-yellow-50 p-4 rounded-lg"},a.createElement("h3",{className:"text-lg font-semibold mb-3"},"Estado de tus Vehículos"),a.createElement("div",{className:"space-y-3"},o.map(k=>{const _=s.filter(b=>b.vehiculoId===k.id&&b.estado==="aprobada").sort((b,w)=>{var A,R;return((A=w.fecha)==null?void 0:A.seconds)-((R=b.fecha)==null?void 0:R.seconds)})[0],S=C(_),N=S?T(S):null;return a.createElement("div",{key:k.id,className:"flex justify-between items-center border-b pb-2"},a.createElement("div",null,a.createElement("h4",{className:"font-medium"},k.marca," ",k.modelo," - ",k.patente),a.createElement("p",{className:"text-sm text-gray-600"},_?`Última revisión: ${new Date(_.fecha.seconds*1e3).toLocaleDateString()}`:"Sin revisiones registradas")),a.createElement("div",{className:"text-right"},N!==null&&a.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${N<0?"bg-red-100 text-red-800":N<=30?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`},N<0?"Vencida":N<=30?`${N} días restantes`:"Al día")))}))),a.createElement("div",null,a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Centros de Revisión Técnica"),a.createElement("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4"},n.map(k=>{var _,S;return a.createElement("div",{key:k.id,className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},a.createElement("div",{className:"flex items-start justify-between mb-3"},a.createElement("div",null,a.createElement("h4",{className:"font-semibold"},k.nombre),a.createElement("p",{className:"text-sm text-gray-600"},k.direccion),a.createElement("p",{className:"text-sm text-gray-600"},k.comuna,", ",k.region)),a.createElement("div",{className:"text-right"},a.createElement("div",{className:"flex items-center gap-1"},a.createElement("span",{className:"text-yellow-500"},"★"),a.createElement("span",{className:"text-sm"},k.rating||4.2)),a.createElement("p",{className:"text-sm text-gray-600"},k.distancia||"2.5"," km"))),a.createElement("div",{className:"space-y-2 mb-4"},a.createElement("div",{className:"flex justify-between text-sm"},a.createElement("span",null,"Precio desde:"),a.createElement("span",{className:"font-semibold"},"$",(_=k.precioBase)==null?void 0:_.toLocaleString())),a.createElement("div",{className:"flex justify-between text-sm"},a.createElement("span",null,"Tiempo promedio:"),a.createElement("span",null,k.tiempoPromedio||"45"," min")),a.createElement("div",{className:"flex justify-between text-sm"},a.createElement("span",null,"Horarios:"),a.createElement("span",null,k.horarios||"L-V 8-18, S 8-14"))),a.createElement("div",{className:"flex flex-wrap gap-1 mb-3"},(S=k.servicios)==null?void 0:S.map(N=>a.createElement("span",{key:N,className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded"},N))),a.createElement("button",{className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700",onClick:()=>{E(k),v(!0)}},"Agendar Cita"))})))),d==="revisiones"&&a.createElement("div",{className:"space-y-4"},a.createElement("h3",{className:"text-lg font-semibold"},"Historial de Revisiones"),s.length===0?a.createElement("p",{className:"text-gray-500"},"No tienes revisiones registradas."):a.createElement("div",{className:"space-y-4"},s.sort((k,_)=>{var S,N;return((S=_.fechaCreacion)==null?void 0:S.seconds)-((N=k.fechaCreacion)==null?void 0:N.seconds)}).map(k=>{var N;const _=n.find(b=>b.id===k.centroId),S=o.find(b=>b.id===k.vehiculoId);return a.createElement("div",{key:k.id,className:"border rounded-lg p-4"},a.createElement("div",{className:"flex justify-between items-start mb-3"},a.createElement("div",null,a.createElement("h4",{className:"font-semibold"},S==null?void 0:S.marca," ",S==null?void 0:S.modelo," - ",S==null?void 0:S.patente),a.createElement("p",{className:"text-sm text-gray-600"},_==null?void 0:_.nombre),a.createElement("p",{className:"text-sm text-gray-600"},k.fechaCita&&new Date(k.fechaCita.seconds*1e3).toLocaleDateString(),k.horaCita&&` - ${k.horaCita}`)),a.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${k.estado==="agendada"?"bg-blue-100 text-blue-800":k.estado==="en_proceso"?"bg-yellow-100 text-yellow-800":k.estado==="aprobada"?"bg-green-100 text-green-800":k.estado==="rechazada"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`},k.estado)),a.createElement("div",{className:"grid md:grid-cols-3 gap-4 text-sm"},a.createElement("div",null,a.createElement("span",{className:"text-gray-600"},"Tipo:"),a.createElement("p",{className:"font-medium"},k.tipoRevision)),a.createElement("div",null,a.createElement("span",{className:"text-gray-600"},"Precio:"),a.createElement("p",{className:"font-medium"},"$",(N=k.precio)==null?void 0:N.toLocaleString())),a.createElement("div",null,a.createElement("span",{className:"text-gray-600"},"Resultado:"),a.createElement("p",{className:"font-medium"},k.estado==="aprobada"?"✅ Aprobada":k.estado==="rechazada"?"❌ Rechazada":"⏳ Pendiente"))),k.observaciones&&a.createElement("div",{className:"mt-3 p-3 bg-gray-50 rounded"},a.createElement("span",{className:"text-sm font-medium"},"Observaciones:"),a.createElement("p",{className:"text-sm mt-1"},k.observaciones)),a.createElement("div",{className:"flex gap-2 mt-4"},a.createElement("button",{className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Ver Certificado"),k.estado==="agendada"&&a.createElement("button",{className:"bg-yellow-600 text-white px-4 py-2 rounded text-sm hover:bg-yellow-700"},"Reprogramar")))}))),d==="recordatorios"&&a.createElement("div",{className:"space-y-4"},a.createElement("h3",{className:"text-lg font-semibold"},"Recordatorios de Vencimiento"),a.createElement("div",{className:"bg-blue-50 p-4 rounded-lg"},a.createElement("h4",{className:"font-semibold mb-2"},"Configurar Notificaciones"),a.createElement("div",{className:"space-y-3"},a.createElement("label",{className:"flex items-center gap-2"},a.createElement("input",{type:"checkbox",className:"rounded",defaultChecked:!0}),a.createElement("span",null,"Email 30 días antes del vencimiento")),a.createElement("label",{className:"flex items-center gap-2"},a.createElement("input",{type:"checkbox",className:"rounded",defaultChecked:!0}),a.createElement("span",null,"Email 7 días antes del vencimiento")),a.createElement("label",{className:"flex items-center gap-2"},a.createElement("input",{type:"checkbox",className:"rounded"}),a.createElement("span",null,"SMS 3 días antes del vencimiento")),a.createElement("label",{className:"flex items-center gap-2"},a.createElement("input",{type:"checkbox",className:"rounded"}),a.createElement("span",null,"Notificaciones push en la app"))),a.createElement("button",{className:"mt-3 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"Guardar Preferencias")),a.createElement("div",null,a.createElement("h4",{className:"font-semibold mb-3"},"Próximos Vencimientos"),a.createElement("div",{className:"space-y-3"},o.map(k=>{const _=s.filter(b=>b.vehiculoId===k.id&&b.estado==="aprobada").sort((b,w)=>{var A,R;return((A=w.fecha)==null?void 0:A.seconds)-((R=b.fecha)==null?void 0:R.seconds)})[0],S=C(_),N=S?T(S):null;return S?a.createElement("div",{key:k.id,className:"border rounded-lg p-4"},a.createElement("div",{className:"flex justify-between items-center"},a.createElement("div",null,a.createElement("h5",{className:"font-medium"},k.marca," ",k.modelo," - ",k.patente),a.createElement("p",{className:"text-sm text-gray-600"},"Vence: ",S.toLocaleDateString())),a.createElement("div",{className:"text-right"},a.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${N<0?"bg-red-100 text-red-800":N<=30?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`},N<0?`Vencida hace ${Math.abs(N)} días`:N===0?"Vence hoy":`${N} días restantes`),N<=30&&a.createElement("button",{className:"block mt-2 bg-blue-600 text-white px-3 py-1 rounded text-xs hover:bg-blue-700"},"Agendar Ahora")))):null}))))),g&&x&&a.createElement($7,{centro:x,vehiculos:o,onClose:()=>v(!1),onSubmit:h}))}function $7({centro:t,vehiculos:e,onClose:n,onSubmit:r}){const[s,i]=p.useState({vehiculoId:"",fecha:"",hora:"",tipo:"anual",precio:t.precioBase||25e3}),[o]=p.useState(["09:00","09:30","10:00","10:30","11:00","11:30","14:00","14:30","15:00","15:30","16:00","16:30"]),l=u=>{u.preventDefault(),r({...s,centroId:t.id})},c=[];for(let u=1;u<=30;u++){const d=new Date;d.setDate(d.getDate()+u),d.getDay()!==0&&c.push(d.toISOString().split("T")[0])}return a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto"},a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Agendar en ",t.nombre),a.createElement("form",{onSubmit:l,className:"space-y-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Vehículo"),a.createElement("select",{className:"w-full border rounded px-3 py-2",value:s.vehiculoId,onChange:u=>i(d=>({...d,vehiculoId:u.target.value})),required:!0},a.createElement("option",{value:""},"Seleccionar vehículo"),e.map(u=>a.createElement("option",{key:u.id,value:u.id},u.marca," ",u.modelo," - ",u.patente)))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Tipo de Revisión"),a.createElement("select",{className:"w-full border rounded px-3 py-2",value:s.tipo,onChange:u=>i(d=>({...d,tipo:u.target.value})),required:!0},a.createElement("option",{value:"anual"},"Revisión Anual"),a.createElement("option",{value:"semestral"},"Revisión Semestral (Transporte)"),a.createElement("option",{value:"primera_vez"},"Primera Vez"),a.createElement("option",{value:"reinspeccion"},"Reinspección"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Fecha"),a.createElement("select",{className:"w-full border rounded px-3 py-2",value:s.fecha,onChange:u=>i(d=>({...d,fecha:u.target.value})),required:!0},a.createElement("option",{value:""},"Seleccionar fecha"),c.map(u=>{const d=new Date(u);return a.createElement("option",{key:u,value:u},d.toLocaleDateString("es-CL",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))}))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Hora"),a.createElement("select",{className:"w-full border rounded px-3 py-2",value:s.hora,onChange:u=>i(d=>({...d,hora:u.target.value})),required:!0},a.createElement("option",{value:""},"Seleccionar hora"),o.map(u=>a.createElement("option",{key:u,value:u},u)))),a.createElement("div",{className:"bg-gray-50 p-3 rounded"},a.createElement("div",{className:"flex justify-between items-center"},a.createElement("span",{className:"font-medium"},"Total a pagar:"),a.createElement("span",{className:"text-lg font-bold"},"$",s.precio.toLocaleString())),a.createElement("p",{className:"text-xs text-gray-600 mt-1"},"Pago en efectivo o tarjeta en el centro")),a.createElement("div",{className:"flex gap-2 pt-4"},a.createElement("button",{type:"button",className:"flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded hover:bg-gray-50",onClick:n},"Cancelar"),a.createElement("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700"},"Confirmar Cita")))))}function B7(){const{user:t,rol:e}=Qe(),[n,r]=p.useState([]),[s,i]=p.useState([]),[o,l]=p.useState([]),[c,u]=p.useState(!0),[d,f]=p.useState("buscar"),[g,v]=p.useState(!1),[x,E]=p.useState(null),[y,h]=p.useState({servicio:"",ubicacion:"",emergencia:!1,precio:""});p.useEffect(()=>{C()},[]);const C=async()=>{try{const _=await ue(Q($,"vulcanizadoras"));r(_.docs.map(N=>({id:N.id,...N.data()})));const S=await ue(Q($,"tipos_servicios_vulcanizadora"));if(i(S.docs.map(N=>({id:N.id,...N.data()}))),t){const N=pe(Q($,"servicios_vulcanizadora"),fe("userId","==",t.uid)),b=await ue(N);l(b.docs.map(w=>({id:w.id,...w.data()})))}}catch(_){console.error("Error loading data:",_)}finally{u(!1)}},T=async _=>{try{const S={userId:t.uid,vulcanizadoraId:_.vulcanizadoraId,tipoServicio:_.tipoServicio,descripcion:_.descripcion,ubicacion:_.ubicacion,emergencia:_.emergencia,estado:"solicitado",fechaSolicitud:new Date,precioEstimado:_.precioEstimado};await ze(Q($,"servicios_vulcanizadora"),S),await C(),v(!1)}catch(S){console.error("Error requesting service:",S)}},k=n.filter(_=>{var S,N;return!(y.servicio&&!((S=_.servicios)!=null&&S.includes(y.servicio))||y.ubicacion&&!((N=_.comuna)!=null&&N.toLowerCase().includes(y.ubicacion.toLowerCase()))||y.emergencia&&!_.emergencia24h)});return c?a.createElement("div",{className:"container mx-auto px-4 py-8"},a.createElement("div",{className:"animate-pulse"},a.createElement("div",{className:"h-8 bg-gray-300 rounded mb-4"}),a.createElement("div",{className:"space-y-4"},[1,2,3].map(_=>a.createElement("div",{key:_,className:"h-20 bg-gray-300 rounded"}))))):a.createElement("div",{className:"container mx-auto px-4 py-8"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg p-6"},a.createElement("h1",{className:"text-3xl font-bold text-gray-800 mb-6"},"🏁 Vulcanizaciones"),a.createElement("div",{className:"flex space-x-4 mb-6 border-b"},a.createElement("button",{className:`pb-2 px-4 ${d==="buscar"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>f("buscar")},"Buscar Servicios"),a.createElement("button",{className:`pb-2 px-4 ${d==="emergencia"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>f("emergencia")},"🆘 Emergencia"),a.createElement("button",{className:`pb-2 px-4 ${d==="servicios"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>f("servicios")},"Mis Servicios"),e==="admin"&&a.createElement("button",{className:`pb-2 px-4 ${d==="admin"?"border-b-2 border-blue-500 text-blue-600":"text-gray-600"}`,onClick:()=>f("admin")},"Administración")),d==="buscar"&&a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"bg-gray-50 p-4 rounded-lg"},a.createElement("h3",{className:"font-semibold mb-3"},"Filtrar Servicios"),a.createElement("div",{className:"grid md:grid-cols-4 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Tipo de Servicio"),a.createElement("select",{className:"w-full border rounded px-3 py-2",value:y.servicio,onChange:_=>h(S=>({...S,servicio:_.target.value}))},a.createElement("option",{value:""},"Todos los servicios"),a.createElement("option",{value:"parche"},"Parche de Neumático"),a.createElement("option",{value:"cambio_neumatico"},"Cambio de Neumático"),a.createElement("option",{value:"balanceado"},"Balanceado"),a.createElement("option",{value:"alineacion"},"Alineación"),a.createElement("option",{value:"rotacion"},"Rotación de Neumáticos"),a.createElement("option",{value:"valvula"},"Cambio de Válvula"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Ubicación"),a.createElement("input",{type:"text",className:"w-full border rounded px-3 py-2",placeholder:"Comuna o sector",value:y.ubicacion,onChange:_=>h(S=>({...S,ubicacion:_.target.value}))})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Disponibilidad"),a.createElement("label",{className:"flex items-center gap-2 mt-2"},a.createElement("input",{type:"checkbox",checked:y.emergencia,onChange:_=>h(S=>({...S,emergencia:_.target.checked}))}),a.createElement("span",{className:"text-sm"},"24 horas"))),a.createElement("div",{className:"flex items-end"},a.createElement("button",{className:"w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700",onClick:()=>{}},"Buscar")))),a.createElement("div",null,a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Vulcanizadoras Disponibles (",k.length,")"),a.createElement("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4"},k.map(_=>{var S,N;return a.createElement("div",{key:_.id,className:"border rounded-lg p-4 hover:shadow-md transition-shadow"},a.createElement("div",{className:"flex items-start justify-between mb-3"},a.createElement("div",null,a.createElement("h4",{className:"font-semibold"},_.nombre),a.createElement("p",{className:"text-sm text-gray-600"},_.direccion),a.createElement("p",{className:"text-sm text-gray-600"},_.comuna),a.createElement("p",{className:"text-sm text-gray-600"},_.telefono)),a.createElement("div",{className:"text-right"},a.createElement("div",{className:"flex items-center gap-1"},a.createElement("span",{className:"text-yellow-500"},"★"),a.createElement("span",{className:"text-sm"},_.rating||4.3)),a.createElement("p",{className:"text-sm text-gray-600"},_.distancia||"1.2"," km"))),a.createElement("div",{className:"mb-3"},a.createElement("div",{className:"flex flex-wrap gap-1"},(S=_.servicios)==null?void 0:S.map(b=>a.createElement("span",{key:b,className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded"},b)))),a.createElement("div",{className:"space-y-1 mb-3 text-sm"},a.createElement("div",{className:"flex justify-between"},a.createElement("span",null,"Horarios:"),a.createElement("span",{className:"font-medium"},_.horarios||"L-S 8-20")),a.createElement("div",{className:"flex justify-between"},a.createElement("span",null,"Tiempo respuesta:"),a.createElement("span",{className:"font-medium"},_.tiempoRespuesta||"15"," min")),a.createElement("div",{className:"flex justify-between"},a.createElement("span",null,"Precio desde:"),a.createElement("span",{className:"font-medium"},"$",(N=_.precioBase)==null?void 0:N.toLocaleString()))),a.createElement("div",{className:"flex gap-1 mb-3"},_.emergencia24h&&a.createElement("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded"},"24h"),_.servicioDomicilio&&a.createElement("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded"},"A domicilio"),_.promociones&&a.createElement("span",{className:"text-xs bg-orange-100 text-orange-800 px-2 py-1 rounded"},"Promociones")),a.createElement("div",{className:"flex gap-2"},a.createElement("button",{className:"flex-1 bg-blue-600 text-white py-2 px-3 rounded text-sm hover:bg-blue-700",onClick:()=>{E(_),v(!0)}},"Solicitar Servicio"),a.createElement("button",{className:"bg-gray-200 text-gray-700 py-2 px-3 rounded text-sm hover:bg-gray-300"},"📞")))})))),d==="emergencia"&&a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6"},a.createElement("div",{className:"flex items-center gap-3 mb-4"},a.createElement("span",{className:"text-4xl"},"🆘"),a.createElement("div",null,a.createElement("h3",{className:"text-xl font-bold text-red-800"},"Servicio de Emergencia"),a.createElement("p",{className:"text-red-700"},"Disponible las 24 horas, los 7 días de la semana"))),a.createElement("div",{className:"grid md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("h4",{className:"font-semibold mb-2"},"¿Qué incluye?"),a.createElement("ul",{className:"space-y-1 text-sm"},a.createElement("li",null,"✅ Asistencia en carretera"),a.createElement("li",null,"✅ Cambio de neumático pinchado"),a.createElement("li",null,"✅ Reparación temporal en sitio"),a.createElement("li",null,"✅ Remolque a vulcanizadora más cercana"),a.createElement("li",null,"✅ Tiempo de respuesta: 15-30 minutos"))),a.createElement("div",null,a.createElement("h4",{className:"font-semibold mb-2"},"Tarifas de Emergencia"),a.createElement("div",{className:"space-y-1 text-sm"},a.createElement("div",{className:"flex justify-between"},a.createElement("span",null,"Servicio base (07:00-22:00):"),a.createElement("span",{className:"font-medium"},"$25.000")),a.createElement("div",{className:"flex justify-between"},a.createElement("span",null,"Recargo nocturno (22:00-07:00):"),a.createElement("span",{className:"font-medium"},"+$10.000")),a.createElement("div",{className:"flex justify-between"},a.createElement("span",null,"Fin de semana/festivos:"),a.createElement("span",{className:"font-medium"},"+$5.000"))))),a.createElement("div",{className:"flex gap-4 mt-6"},a.createElement("button",{className:"bg-red-600 text-white px-6 py-3 rounded-lg text-lg font-semibold hover:bg-red-700"},"🚨 Llamar Emergencia"),a.createElement("button",{className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700"},"📍 Compartir Ubicación"))),a.createElement("div",null,a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Vulcanizadoras 24 Horas"),a.createElement("div",{className:"grid md:grid-cols-2 gap-4"},n.filter(_=>_.emergencia24h).map(_=>a.createElement("div",{key:_.id,className:"border rounded-lg p-4 bg-red-50"},a.createElement("div",{className:"flex justify-between items-start mb-2"},a.createElement("div",null,a.createElement("h4",{className:"font-semibold"},_.nombre),a.createElement("p",{className:"text-sm text-gray-600"},_.comuna)),a.createElement("span",{className:"bg-red-100 text-red-800 px-2 py-1 rounded text-xs"},"24h")),a.createElement("div",{className:"flex justify-between items-center"},a.createElement("div",null,a.createElement("p",{className:"text-sm font-medium"},"📞 ",_.telefono),a.createElement("p",{className:"text-sm text-gray-600"},_.distancia||"2.1"," km")),a.createElement("button",{className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700"},"Llamar"))))))),d==="servicios"&&a.createElement("div",{className:"space-y-4"},a.createElement("h3",{className:"text-lg font-semibold"},"Historial de Servicios"),o.length===0?a.createElement("p",{className:"text-gray-500"},"No tienes servicios registrados."):a.createElement("div",{className:"space-y-4"},o.sort((_,S)=>{var N,b;return((N=S.fechaSolicitud)==null?void 0:N.seconds)-((b=_.fechaSolicitud)==null?void 0:b.seconds)}).map(_=>{var N;const S=n.find(b=>b.id===_.vulcanizadoraId);return a.createElement("div",{key:_.id,className:"border rounded-lg p-4"},a.createElement("div",{className:"flex justify-between items-start mb-3"},a.createElement("div",null,a.createElement("h4",{className:"font-semibold"},S==null?void 0:S.nombre),a.createElement("p",{className:"text-sm text-gray-600"},_.tipoServicio),a.createElement("p",{className:"text-sm text-gray-600"},_.fechaSolicitud&&new Date(_.fechaSolicitud.seconds*1e3).toLocaleString())),a.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${_.estado==="solicitado"?"bg-blue-100 text-blue-800":_.estado==="en_proceso"?"bg-yellow-100 text-yellow-800":_.estado==="completado"?"bg-green-100 text-green-800":_.estado==="cancelado"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`},_.estado)),_.descripcion&&a.createElement("p",{className:"text-sm text-gray-700 mb-3"},_.descripcion),a.createElement("div",{className:"grid md:grid-cols-3 gap-4 text-sm"},a.createElement("div",null,a.createElement("span",{className:"text-gray-600"},"Ubicación:"),a.createElement("p",{className:"font-medium"},_.ubicacion)),a.createElement("div",null,a.createElement("span",{className:"text-gray-600"},"Precio:"),a.createElement("p",{className:"font-medium"},_.precioFinal?`$${_.precioFinal.toLocaleString()}`:`Est. $${(N=_.precioEstimado)==null?void 0:N.toLocaleString()}`)),a.createElement("div",null,a.createElement("span",{className:"text-gray-600"},"Emergencia:"),a.createElement("p",{className:"font-medium"},_.emergencia?"🆘 Sí":"✅ Normal"))),a.createElement("div",{className:"flex gap-2 mt-4"},a.createElement("button",{className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Ver Detalles"),_.estado==="completado"&&a.createElement("button",{className:"bg-yellow-600 text-white px-4 py-2 rounded text-sm hover:bg-yellow-700"},"Calificar Servicio")))})))),g&&x&&a.createElement(q7,{vulcanizadora:x,servicios:s,onClose:()=>v(!1),onSubmit:T}))}function q7({vulcanizadora:t,servicios:e,onClose:n,onSubmit:r}){const[s,i]=p.useState({tipoServicio:"",descripcion:"",ubicacion:"",emergencia:!1,precioEstimado:0}),[o,l]=p.useState(!1),c=d=>{d.preventDefault(),r({...s,vulcanizadoraId:t.id})},u=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(d=>{const{latitude:f,longitude:g}=d.coords;i(v=>({...v,ubicacion:`${f}, ${g}`})),l(!0)},d=>{console.error("Error getting location:",d),alert("No se pudo obtener la ubicación. Por favor, ingresa manualmente.")})};return a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto"},a.createElement("h3",{className:"text-lg font-semibold mb-4"},"Solicitar Servicio - ",t.nombre),a.createElement("form",{onSubmit:c,className:"space-y-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Tipo de Servicio"),a.createElement("select",{className:"w-full border rounded px-3 py-2",value:s.tipoServicio,onChange:d=>{var v;const f=d.target.value,g=((v=t.precios)==null?void 0:v[f])||t.precioBase||15e3;i(x=>({...x,tipoServicio:f,precioEstimado:g}))},required:!0},a.createElement("option",{value:""},"Seleccionar servicio"),a.createElement("option",{value:"parche"},"Parche de Neumático"),a.createElement("option",{value:"cambio_neumatico"},"Cambio de Neumático"),a.createElement("option",{value:"balanceado"},"Balanceado"),a.createElement("option",{value:"alineacion"},"Alineación"),a.createElement("option",{value:"rotacion"},"Rotación de Neumáticos"),a.createElement("option",{value:"valvula"},"Cambio de Válvula"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Descripción del Problema"),a.createElement("textarea",{className:"w-full border rounded px-3 py-2",rows:"3",placeholder:"Describe tu problema o necesidad...",value:s.descripcion,onChange:d=>i(f=>({...f,descripcion:d.target.value})),required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium mb-1"},"Ubicación"),a.createElement("div",{className:"flex gap-2"},a.createElement("input",{type:"text",className:"flex-1 border rounded px-3 py-2",placeholder:"Dirección o coordenadas",value:s.ubicacion,onChange:d=>i(f=>({...f,ubicacion:d.target.value})),required:!0}),a.createElement("button",{type:"button",className:"bg-blue-600 text-white px-3 py-2 rounded hover:bg-blue-700",onClick:u},"📍")),o&&a.createElement("p",{className:"text-xs text-green-600 mt-1"},"✅ Ubicación obtenida automáticamente")),a.createElement("div",null,a.createElement("label",{className:"flex items-center gap-2"},a.createElement("input",{type:"checkbox",checked:s.emergencia,onChange:d=>{const f=d.target.checked;i(g=>({...g,emergencia:f,precioEstimado:f?g.precioEstimado*1.5:g.precioEstimado/1.5}))}}),a.createElement("span",{className:"text-sm"},"🆘 Servicio de emergencia (+50%)"))),a.createElement("div",{className:"bg-gray-50 p-3 rounded"},a.createElement("div",{className:"flex justify-between items-center"},a.createElement("span",{className:"font-medium"},"Precio estimado:"),a.createElement("span",{className:"text-lg font-bold"},"$",Math.round(s.precioEstimado).toLocaleString())),a.createElement("p",{className:"text-xs text-gray-600 mt-1"},"El precio final puede variar según la evaluación técnica")),a.createElement("div",{className:"flex gap-2 pt-4"},a.createElement("button",{type:"button",className:"flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded hover:bg-gray-50",onClick:n},"Cancelar"),a.createElement("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700"},"Solicitar Servicio")))))}const W7=()=>{Qe(),p.useState([]),p.useState([]);const t={aceite_usado:{nombre:"Aceite de Motor",descripcion:"Entrega el aceite usado de tu cambio",puntos:50,beneficio:"Descuento en próximo cambio de aceite"},neumaticos:{nombre:"Neumáticos Viejos",descripcion:"Al cambiar neumáticos, entrega los usados",puntos:200,beneficio:"Crédito para alineación o balanceo"},bateria:{nombre:"Batería Agotada",descripcion:"Cambio de batería con reciclaje",puntos:300,beneficio:"Descuento en nueva batería"},filtros:{nombre:"Filtros Usados",descripcion:"Filtros de aceite, aire y combustible",puntos:30,beneficio:"Acumulable para servicios gratuitos"}},e=[{vehiculo:"Toyota Corolla 2018",material:"aceite_usado",fecha_estimada:"2025-02-15",km_actuales:85e3,km_proximo_cambio:9e4},{vehiculo:"Toyota Corolla 2018",material:"neumaticos",fecha_estimada:"2025-06-01",razon:"Desgaste estimado según uso"}];return a.createElement("div",{className:"p-6 bg-gray-50 min-h-screen"},a.createElement("div",{className:"max-w-6xl mx-auto"},a.createElement("div",{className:"bg-gradient-to-r from-green-600 to-blue-600 text-white p-6 rounded-lg mb-6"},a.createElement("h1",{className:"text-2xl font-bold"},"♻️ Mi Centro de Reciclaje"),a.createElement("p",{className:"mt-2"},"Recicla responsablemente y obtén beneficios para tu vehículo")),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},a.createElement("div",{className:"bg-white p-4 rounded-lg shadow"},a.createElement("h3",{className:"text-lg font-semibold text-green-600"},"🏆 Puntos EcoAV10"),a.createElement("p",{className:"text-3xl font-bold"},"1,250"),a.createElement("p",{className:"text-sm text-gray-600"},"Puntos acumulados")),a.createElement("div",{className:"bg-white p-4 rounded-lg shadow"},a.createElement("h3",{className:"text-lg font-semibold text-blue-600"},"💰 Ahorros"),a.createElement("p",{className:"text-3xl font-bold"},"$45,000"),a.createElement("p",{className:"text-sm text-gray-600"},"En descuentos obtenidos")),a.createElement("div",{className:"bg-white p-4 rounded-lg shadow"},a.createElement("h3",{className:"text-lg font-semibold text-purple-600"},"🌱 Impacto"),a.createElement("p",{className:"text-3xl font-bold"},"85 kg"),a.createElement("p",{className:"text-sm text-gray-600"},"CO₂ evitado"))),a.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},a.createElement("div",{className:"bg-white rounded-lg shadow p-6"},a.createElement("h2",{className:"text-xl font-bold mb-4"},"📅 Próximos Reciclajes"),e.map((n,r)=>a.createElement("div",{key:r,className:"border-b py-4 last:border-b-0"},a.createElement("div",{className:"flex justify-between items-start"},a.createElement("div",{className:"flex-1"},a.createElement("h3",{className:"font-semibold"},t[n.material].nombre),a.createElement("p",{className:"text-sm text-gray-600"},n.vehiculo),a.createElement("p",{className:"text-sm text-green-600"},"+",t[n.material].puntos," puntos EcoAV10"),n.km_actuales&&a.createElement("p",{className:"text-sm text-orange-600"},"Próximo cambio en ",n.km_proximo_cambio-n.km_actuales," km")),a.createElement("div",{className:"text-right"},a.createElement("p",{className:"text-sm font-semibold"},n.fecha_estimada),a.createElement("button",{className:"bg-green-600 text-white px-3 py-1 rounded text-sm mt-2 hover:bg-green-700"},"Programar"))))),a.createElement("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg"},a.createElement("h3",{className:"font-semibold text-blue-800"},"💡 Consejo Eco"),a.createElement("p",{className:"text-sm text-blue-700"},"El aceite usado se puede reciclar indefinidamente. ¡Una sola gota puede contaminar 1000 litros de agua!"))),a.createElement("div",{className:"bg-white rounded-lg shadow p-6"},a.createElement("h2",{className:"text-xl font-bold mb-4"},"🔄 Materiales que Puedes Reciclar"),Object.entries(t).map(([n,r])=>a.createElement("div",{key:n,className:"border-b py-4 last:border-b-0"},a.createElement("div",{className:"flex justify-between items-start"},a.createElement("div",{className:"flex-1"},a.createElement("h3",{className:"font-semibold"},r.nombre),a.createElement("p",{className:"text-sm text-gray-600"},r.descripcion),a.createElement("p",{className:"text-sm text-green-600"},"Beneficio: ",r.beneficio)),a.createElement("div",{className:"text-right"},a.createElement("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-sm"},"+",r.puntos," pts"))))))),a.createElement("div",{className:"bg-white rounded-lg shadow p-6 mt-6"},a.createElement("h2",{className:"text-xl font-bold mb-4"},"📊 Historial de Reciclaje"),a.createElement("div",{className:"overflow-x-auto"},a.createElement("table",{className:"w-full"},a.createElement("thead",null,a.createElement("tr",{className:"border-b"},a.createElement("th",{className:"text-left py-2"},"Fecha"),a.createElement("th",{className:"text-left py-2"},"Material"),a.createElement("th",{className:"text-left py-2"},"Vehículo"),a.createElement("th",{className:"text-left py-2"},"Puntos"),a.createElement("th",{className:"text-left py-2"},"Beneficio"))),a.createElement("tbody",null,a.createElement("tr",{className:"border-b"},a.createElement("td",{className:"py-2"},"12/01/2025"),a.createElement("td",{className:"py-2"},"Aceite de Motor"),a.createElement("td",{className:"py-2"},"Toyota Corolla"),a.createElement("td",{className:"py-2 text-green-600"},"+50"),a.createElement("td",{className:"py-2"},"$5,000 descuento aplicado")),a.createElement("tr",{className:"border-b"},a.createElement("td",{className:"py-2"},"08/01/2025"),a.createElement("td",{className:"py-2"},"Filtro de Aceite"),a.createElement("td",{className:"py-2"},"Toyota Corolla"),a.createElement("td",{className:"py-2 text-green-600"},"+30"),a.createElement("td",{className:"py-2"},"Puntos acumulados")),a.createElement("tr",{className:"border-b"},a.createElement("td",{className:"py-2"},"15/12/2024"),a.createElement("td",{className:"py-2"},"Batería"),a.createElement("td",{className:"py-2"},"Toyota Corolla"),a.createElement("td",{className:"py-2 text-green-600"},"+300"),a.createElement("td",{className:"py-2"},"$15,000 descuento aplicado")))))),a.createElement("div",{className:"bg-white rounded-lg shadow p-6 mt-6"},a.createElement("h2",{className:"text-xl font-bold mb-4"},"🎁 Canjea tus Puntos EcoAV10"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},a.createElement("div",{className:"border rounded-lg p-4"},a.createElement("h3",{className:"font-semibold"},"Cambio de Aceite"),a.createElement("p",{className:"text-sm text-gray-600"},"Servicio completo"),a.createElement("p",{className:"text-lg font-bold text-green-600"},"1,000 puntos"),a.createElement("button",{className:"w-full bg-green-600 text-white py-2 rounded mt-2 hover:bg-green-700"},"Canjear")),a.createElement("div",{className:"border rounded-lg p-4"},a.createElement("h3",{className:"font-semibold"},"Alineación"),a.createElement("p",{className:"text-sm text-gray-600"},"Alineación computarizada"),a.createElement("p",{className:"text-lg font-bold text-blue-600"},"800 puntos"),a.createElement("button",{className:"w-full bg-blue-600 text-white py-2 rounded mt-2 hover:bg-blue-700"},"Canjear")),a.createElement("div",{className:"border rounded-lg p-4"},a.createElement("h3",{className:"font-semibold"},"Revisión Completa"),a.createElement("p",{className:"text-sm text-gray-600"},"Check-up vehicular"),a.createElement("p",{className:"text-lg font-bold text-purple-600"},"600 puntos"),a.createElement("button",{className:"w-full bg-purple-600 text-white py-2 rounded mt-2 hover:bg-purple-700"},"Canjear"))))))},H7=()=>{Qe(),p.useState([]),p.useState({notificaciones_email:!0,notificaciones_push:!0,anticipacion_dias:30});const t={permiso_circulacion:{nombre:"Permiso de Circulación",mes_vencimiento:3,icono:"📋",color:"red",recordatorios:[60,30,15,7,1],requisitos:["revision_tecnica","seguro_obligatorio","multas_pagadas"],proveedores:["municipalidad","gestores_automotrices"]},seguro_obligatorio:{nombre:"Seguro Obligatorio",mes_vencimiento:3,icono:"🛡️",color:"blue",recordatorios:[45,20,10,5],requisitos:["vehiculo_vigente"],proveedores:["compañias_seguro"]},revision_tecnica:{nombre:"Revisión Técnica",tipo:"anual",icono:"🔧",color:"green",recordatorios:[60,30,15,7],requisitos:["vehiculo_operativo"],proveedores:["plantas_revision"]},mantenimiento_preventivo:{nombre:"Mantenimiento Preventivo",tipo:"km_o_tiempo",icono:"⚙️",color:"orange",intervalos:{aceite:{km:5e3,meses:6},filtros:{km:15e3,meses:12},frenos:{km:2e4,meses:18},neumaticos:{km:4e4,años:4}}}},e=[{id:1,tipo:"permiso_circulacion",vehiculo:"Toyota Corolla 2018 - ABCD12",fecha_vencimiento:"2025-03-31",dias_restantes:45,estado:"pendiente",acciones_requeridas:[{tarea:"Renovar revisión técnica",completada:!1,vencimiento:"2025-02-28"},{tarea:"Renovar seguro obligatorio",completada:!1,vencimiento:"2025-03-15"},{tarea:"Verificar multas pendientes",completada:!0,fecha_completada:"2025-01-10"}]},{id:2,tipo:"seguro_obligatorio",vehiculo:"Toyota Corolla 2018 - ABCD12",fecha_vencimiento:"2025-03-15",dias_restantes:30,estado:"pendiente",cotizaciones_disponibles:[{compañia:"Mapfre",precio:45e3,cobertura:"SOAP"},{compañia:"Liberty",precio:42e3,cobertura:"SOAP"},{compañia:"HDI",precio:47e3,cobertura:"SOAP + RC"}]},{id:3,tipo:"mantenimiento_preventivo",vehiculo:"Toyota Corolla 2018 - ABCD12",servicio:"Cambio de aceite",km_actual:87500,km_proximo:9e4,fecha_estimada:"2025-02-20",dias_restantes:15,estado:"urgente"}],n=(s,i)=>i==="urgente"?"border-red-500 bg-red-50":i==="proximo"?"border-yellow-500 bg-yellow-50":"border-gray-300 bg-white",r=s=>s<=7?"🚨":s<=15?"⚠️":s<=30?"⏰":"📅";return a.createElement("div",{className:"p-6 bg-gray-50 min-h-screen"},a.createElement("div",{className:"max-w-6xl mx-auto"},a.createElement("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 rounded-lg mb-6"},a.createElement("h1",{className:"text-2xl font-bold"},"🔔 Centro de Recordatorios AV10"),a.createElement("p",{className:"mt-2"},"Mantén tu vehículo al día con recordatorios inteligentes")),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},a.createElement("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-red-500"},a.createElement("h3",{className:"text-lg font-semibold text-red-600"},"🚨 Urgentes"),a.createElement("p",{className:"text-2xl font-bold"},"2"),a.createElement("p",{className:"text-sm text-gray-600"},"Requieren atención inmediata")),a.createElement("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-yellow-500"},a.createElement("h3",{className:"text-lg font-semibold text-yellow-600"},"⚠️ Próximos"),a.createElement("p",{className:"text-2xl font-bold"},"3"),a.createElement("p",{className:"text-sm text-gray-600"},"En los próximos 30 días")),a.createElement("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-green-500"},a.createElement("h3",{className:"text-lg font-semibold text-green-600"},"✅ Completados"),a.createElement("p",{className:"text-2xl font-bold"},"8"),a.createElement("p",{className:"text-sm text-gray-600"},"Este año")),a.createElement("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-blue-500"},a.createElement("h3",{className:"text-lg font-semibold text-blue-600"},"💰 Ahorrado"),a.createElement("p",{className:"text-2xl font-bold"},"$85,000"),a.createElement("p",{className:"text-sm text-gray-600"},"En multas evitadas"))),a.createElement("div",{className:"space-y-4"},e.map(s=>{var i,o;return a.createElement("div",{key:s.id,className:`rounded-lg border-2 p-6 shadow-sm ${n(s.tipo,s.estado)}`},a.createElement("div",{className:"flex items-start justify-between"},a.createElement("div",{className:"flex-1"},a.createElement("div",{className:"flex items-center gap-3 mb-2"},a.createElement("span",{className:"text-2xl"},r(s.dias_restantes)),a.createElement("div",null,a.createElement("h3",{className:"text-lg font-bold"},(i=t[s.tipo])==null?void 0:i.icono," ",(o=t[s.tipo])==null?void 0:o.nombre),a.createElement("p",{className:"text-sm text-gray-600"},s.vehiculo))),s.tipo==="permiso_circulacion"&&a.createElement("div",{className:"mt-4"},a.createElement("h4",{className:"font-semibold mb-2"},"📋 Acciones Requeridas:"),a.createElement("div",{className:"space-y-2"},s.acciones_requeridas.map((l,c)=>a.createElement("div",{key:c,className:"flex items-center gap-2"},a.createElement("input",{type:"checkbox",checked:l.completada,className:"rounded",readOnly:!0}),a.createElement("span",{className:l.completada?"line-through text-gray-500":""},l.tarea),l.vencimiento&&!l.completada&&a.createElement("span",{className:"text-red-600 text-sm"},"(Vence: ",l.vencimiento,")"),l.completada&&a.createElement("span",{className:"text-green-600 text-sm"},"✓ ",l.fecha_completada))))),s.tipo==="seguro_obligatorio"&&a.createElement("div",{className:"mt-4"},a.createElement("h4",{className:"font-semibold mb-2"},"💰 Cotizaciones Disponibles:"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2"},s.cotizaciones_disponibles.map((l,c)=>a.createElement("div",{key:c,className:"border rounded p-3 bg-white"},a.createElement("h5",{className:"font-semibold"},l.compañia),a.createElement("p",{className:"text-green-600 font-bold"},"$",l.precio.toLocaleString()),a.createElement("p",{className:"text-sm text-gray-600"},l.cobertura),a.createElement("button",{className:"w-full bg-blue-600 text-white px-3 py-1 rounded text-sm mt-2 hover:bg-blue-700"},"Contratar"))))),s.tipo==="mantenimiento_preventivo"&&a.createElement("div",{className:"mt-4"},a.createElement("div",{className:"flex items-center gap-4"},a.createElement("div",null,a.createElement("span",{className:"text-sm text-gray-600"},"KM Actual:"),a.createElement("span",{className:"font-bold ml-1"},s.km_actual.toLocaleString())),a.createElement("div",null,a.createElement("span",{className:"text-sm text-gray-600"},"Próximo servicio:"),a.createElement("span",{className:"font-bold ml-1"},s.km_proximo.toLocaleString())),a.createElement("div",null,a.createElement("span",{className:"text-sm text-gray-600"},"Faltan:"),a.createElement("span",{className:"font-bold ml-1 text-orange-600"},s.km_proximo-s.km_actual," km"))))),a.createElement("div",{className:"text-right"},a.createElement("div",{className:"mb-2"},a.createElement("span",{className:"text-sm text-gray-600"},"Vence en:"),a.createElement("p",{className:"text-xl font-bold text-red-600"},s.dias_restantes," días"),a.createElement("p",{className:"text-sm text-gray-600"},s.fecha_vencimiento||s.fecha_estimada)),a.createElement("div",{className:"space-y-2"},a.createElement("button",{className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 w-full"},"Ver Proveedores"),a.createElement("button",{className:"bg-green-600 text-white px-4 py-2 rounded text-sm hover:bg-green-700 w-full"},"Programar"),a.createElement("button",{className:"border border-gray-300 text-gray-700 px-4 py-2 rounded text-sm hover:bg-gray-100 w-full"},"Posponer")))))})),a.createElement("div",{className:"bg-white rounded-lg shadow p-6 mt-6"},a.createElement("h2",{className:"text-xl font-bold mb-4"},"📅 Calendario Marzo 2025 - Renovaciones"),a.createElement("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4"},a.createElement("h3",{className:"font-bold text-red-800"},"🚨 ¡Mes Crítico para Renovaciones!"),a.createElement("p",{className:"text-red-700"},"En marzo vencen permisos de circulación y seguros obligatorios. Programa tus trámites con anticipación para evitar multas.")),a.createElement("div",{className:"grid grid-cols-7 gap-2 text-center"},["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"].map(s=>a.createElement("div",{key:s,className:"font-bold p-2 bg-gray-100 rounded"},s)),Array.from({length:31},(s,i)=>i+1).map(s=>a.createElement("div",{key:s,className:`p-2 border rounded ${s===15?"bg-blue-100 border-blue-500":s===31?"bg-red-100 border-red-500":"border-gray-200"}`},a.createElement("div",{className:"font-semibold"},s),s===15&&a.createElement("div",{className:"text-xs text-blue-700"},"Seguros"),s===31&&a.createElement("div",{className:"text-xs text-red-700"},"Permisos")))))))};function G7(){return a.createElement(xu,null,a.createElement(Sb,null,a.createElement(Ie,{index:!0,element:a.createElement(J8,null)}),a.createElement(Ie,{path:"servicios/seguros",element:a.createElement(F7,null)}),a.createElement(Ie,{path:"servicios/revision-tecnica",element:a.createElement(U7,null)}),a.createElement(Ie,{path:"servicios/vulcanizaciones",element:a.createElement(B7,null)}),a.createElement(Ie,{path:"servicios/reciclaje",element:a.createElement(W7,null)}),a.createElement(Ie,{path:"recordatorios",element:a.createElement(H7,null)}),a.createElement(Ie,{path:"empresas",element:a.createElement(t7,null)}),a.createElement(Ie,{path:"editar-empresa/:empresaId",element:a.createElement(O7,null)}),a.createElement(Ie,{path:"solicitudes-registro",element:a.createElement(n7,null)}),a.createElement(Ie,{path:"marcas",element:a.createElement(J$,null)}),a.createElement(Ie,{path:"tipos-empresa",element:a.createElement(a7,null)}),a.createElement(Ie,{path:"categorias",element:a.createElement(b7,null)}),a.createElement(Ie,{path:"solicitudes-cliente",element:a.createElement(p7,null)}),a.createElement(Ie,{path:"solicitudes-comunidad",element:a.createElement(f7,null)}),a.createElement(Ie,{path:"notificaciones",element:a.createElement(v7,null)}),a.createElement(Ie,{path:"validacion-clientes",element:a.createElement(y7,null)}),a.createElement(Ie,{path:"estadisticas",element:a.createElement(E7,null)}),a.createElement(Ie,{path:"moderacion-reseñas",element:a.createElement(I7,null)}),a.createElement(Ie,{path:"gestion-tickets",element:a.createElement(A7,null)}),a.createElement(Ie,{path:"recursos-educativos",element:a.createElement(P7,null)}),a.createElement(Ie,{path:"configuracion-sistema",element:a.createElement(k7,null)}),a.createElement(Ie,{path:"catastro-masivo",element:a.createElement(w7,null)}),a.createElement(Ie,{path:"panel-validacion",element:a.createElement(N7,null)}),a.createElement(Ie,{path:"agentes-campo",element:a.createElement(C7,null)}),a.createElement(Ie,{path:"gestion-agentes",element:a.createElement(S7,null)}),a.createElement(Ie,{path:"campañas",element:a.createElement(l7,null)}),a.createElement(Ie,{path:"productos",element:a.createElement(d7,null)}),a.createElement(Ie,{path:"proveedores",element:a.createElement(j7,null)})))}function K7(){const{user:t}=Qe(),[e,n]=p.useState({nombre:"",email:"",telefono:"",direccion:"",categoria:"",descripcion:"",rut:"",contacto_nombre:"",contacto_telefono:"",encargado_nombre:"",encargado_telefono:"",encargado_email:"",encargado_fecha_nacimiento:"",encargado_cargo:"",documentacion_validada:!1,documento_empresa_verificado:!1,firma_acuerdo_obtenida:!1,direccion_verificada:!1,horarios:{lunes:{activo:!1,inicio:"09:00",fin:"18:00"},martes:{activo:!1,inicio:"09:00",fin:"18:00"},miercoles:{activo:!1,inicio:"09:00",fin:"18:00"},jueves:{activo:!1,inicio:"09:00",fin:"18:00"},viernes:{activo:!1,inicio:"09:00",fin:"18:00"},sabado:{activo:!1,inicio:"09:00",fin:"18:00"},domingo:{activo:!1,inicio:"09:00",fin:"18:00"}},activar_inmediatamente:!1}),[r,s]=p.useState(!1),[i,o]=p.useState(""),l=["Mecánica","Repuestos","Lubricantes","Neumáticos","Cerrajería","Electrónica","Pintura","Seguros","Otros servicios"],c=v=>{const{name:x,value:E,type:y,checked:h}=v.target;n(C=>({...C,[x]:y==="checkbox"?h:E}))},u=(v,x,E)=>{n(y=>({...y,horarios:{...y.horarios,[v]:{...y.horarios[v],[x]:E}}}))},d=()=>{const x=["nombre","email","telefono","direccion","categoria"].filter(E=>!e[E]);if(x.length>0)return o(`Faltan los siguientes campos: ${x.join(", ")}`),!1;if(e.documentacion_validada){const y=[{campo:"documento_empresa_verificado",nombre:"Documento que acredita empresa"},{campo:"firma_acuerdo_obtenida",nombre:"Firma de acuerdo"},{campo:"direccion_verificada",nombre:"Verificación de dirección"}].filter(h=>!e[h.campo]);if(y.length>0)return o(`Si marcas "Documentación validada", debes confirmar: ${y.map(h=>h.nombre).join(", ")}`),!1}return e.encargado_nombre&&!e.encargado_telefono?(o("Si ingresas el nombre del encargado, el teléfono es requerido"),!1):!0},f=async()=>{try{const v=pe(Q($,"agentes"),fe("uid","==",t.uid),fe("activo","==",!0)),x=await ue(v);if(x.empty)return o("No tienes permisos de agente"),!1;const E=x.docs[0],y=E.data();return y.activo?{...y,id:E.id}:(o("Tu cuenta de agente está desactivada"),!1)}catch(v){return console.error("Error verificando permisos:",v),o("Error verificando permisos"),!1}},g=async v=>{var x,E;if(v.preventDefault(),!!d()){s(!0),o("");try{const y=await f();if(!y){s(!1);return}const h=new Date,C={nombre_empresa:e.nombre,email_empresa:e.email,telefono_empresa:e.telefono,direccion_empresa:e.direccion,categoria:e.categoria,descripcion:e.descripcion,rut_empresa:e.rut,representante_nombre:e.contacto_nombre||e.nombre,representante_email:e.email,representante_telefono:e.contacto_telefono||e.telefono,encargado_nombre:e.encargado_nombre,encargado_telefono:e.encargado_telefono,encargado_email:e.encargado_email,encargado_fecha_nacimiento:e.encargado_fecha_nacimiento,encargado_cargo:e.encargado_cargo,horarios:e.horarios,estado:e.activar_inmediatamente&&((x=y.permisos)!=null&&x.activar_empresas)?"activada":"pendiente",fecha_solicitud:h,agente_id:y.id,agente_nombre:y.nombre,agente_email:y.email,agente_zona:y.zona_asignada,tipo_solicitud:"agente_terreno",documentacion_validada_por_agente:e.documentacion_validada,documento_empresa_verificado:e.documento_empresa_verificado,firma_acuerdo_obtenida:e.firma_acuerdo_obtenida,direccion_verificada_presencial:e.direccion_verificada,visita_agente_requerida:!1,validacion_presencial_completada:e.documentacion_validada,notas_agente:`Solicitud creada en terreno por agente ${y.nombre}. ${e.documentacion_validada?"Documentación validada presencialmente.":"Pendiente validación documental."}`},T=await ze(Q($,"solicitudes_empresa"),C);if(e.activar_inmediatamente&&((E=y.permisos)!=null&&E.activar_empresas)){const k={...C,estado:"activa",etapa_proceso:"activada_sin_credenciales",fecha_activacion:h,solicitud_id:T.id,web:"",logo:"",verificada:!1,activa:!0,tiene_credenciales_asignadas:!1};delete k.fecha_solicitud,delete k.tipo_solicitud,delete k.notas_agente,await ze(Q($,"empresas"),k),o("¡Empresa creada y activada exitosamente! (Visible en home, pendiente asignar credenciales)")}else o("Solicitud enviada para revisión. Será procesada por el administrador.");n({nombre:"",email:"",telefono:"",direccion:"",categoria:"",descripcion:"",rut:"",contacto_nombre:"",contacto_telefono:"",encargado_nombre:"",encargado_telefono:"",encargado_email:"",encargado_fecha_nacimiento:"",encargado_cargo:"",documentacion_validada:!1,documento_empresa_verificado:!1,firma_acuerdo_obtenida:!1,direccion_verificada:!1,horarios:{lunes:{activo:!1,inicio:"09:00",fin:"18:00"},martes:{activo:!1,inicio:"09:00",fin:"18:00"},miercoles:{activo:!1,inicio:"09:00",fin:"18:00"},jueves:{activo:!1,inicio:"09:00",fin:"18:00"},viernes:{activo:!1,inicio:"09:00",fin:"18:00"},sabado:{activo:!1,inicio:"09:00",fin:"18:00"},domingo:{activo:!1,inicio:"09:00",fin:"18:00"}},activar_inmediatamente:!1})}catch(y){console.error("Error creando solicitud:",y),o("Error al procesar la solicitud: "+y.message)}finally{s(!1)}}};return a.createElement("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-lg"},a.createElement("h2",{className:"text-2xl font-bold text-gray-800 mb-6"},"📋 Registro de Empresa en Terreno"),i&&a.createElement("div",{className:`p-4 rounded-lg mb-6 ${i.includes("exitosamente")?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`},i),a.createElement("form",{onSubmit:g,className:"space-y-6"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombre de la Empresa *"),a.createElement("input",{type:"text",name:"nombre",value:e.nombre,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Categoría *"),a.createElement("select",{name:"categoria",value:e.categoria,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0},a.createElement("option",{value:""},"Seleccionar categoría"),l.map(v=>a.createElement("option",{key:v,value:v},v)))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email *"),a.createElement("input",{type:"email",name:"email",value:e.email,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono *"),a.createElement("input",{type:"tel",name:"telefono",value:e.telefono,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"RUT (opcional)"),a.createElement("input",{type:"text",name:"rut",value:e.rut,onChange:c,placeholder:"12.345.678-9",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contacto Principal"),a.createElement("input",{type:"text",name:"contacto_nombre",value:e.contacto_nombre,onChange:c,placeholder:"Nombre del contacto",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Dirección *"),a.createElement("input",{type:"text",name:"direccion",value:e.direccion,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Descripción del Negocio"),a.createElement("textarea",{name:"descripcion",value:e.descripcion,onChange:c,rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe brevemente el negocio y sus servicios..."})),a.createElement("div",null,a.createElement("h3",{className:"text-lg font-medium text-gray-800 mb-4"},"👤 Datos del Encargado (para comunicación personalizada)"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombre del Encargado"),a.createElement("input",{type:"text",name:"encargado_nombre",value:e.encargado_nombre,onChange:c,placeholder:"Ej: Juan Pérez",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Cargo"),a.createElement("input",{type:"text",name:"encargado_cargo",value:e.encargado_cargo,onChange:c,placeholder:"Ej: Gerente, Propietario, Encargado",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono del Encargado"),a.createElement("input",{type:"tel",name:"encargado_telefono",value:e.encargado_telefono,onChange:c,placeholder:"+56 9 1234 5678",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email del Encargado"),a.createElement("input",{type:"email",name:"encargado_email",value:e.encargado_email,onChange:c,placeholder:"encargado@empresa.com",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Fecha de Nacimiento",a.createElement("span",{className:"text-xs text-gray-500 ml-1"},"(para saludos de cumpleaños)")),a.createElement("input",{type:"date",name:"encargado_fecha_nacimiento",value:e.encargado_fecha_nacimiento,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})))),a.createElement("div",null,a.createElement("h3",{className:"text-lg font-medium text-gray-800 mb-4"},"📋 Validación Presencial (Agente de Campo)"),a.createElement("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg border border-blue-200"},a.createElement("div",{className:"flex items-center space-x-3"},a.createElement("input",{type:"checkbox",name:"documentacion_validada",checked:e.documentacion_validada,onChange:c,className:"rounded text-blue-600 focus:ring-blue-500",id:"documentacion_validada"}),a.createElement("label",{htmlFor:"documentacion_validada",className:"text-sm font-medium text-gray-700"},"✅ Documentación validada presencialmente")),e.documentacion_validada&&a.createElement("div",{className:"ml-6 space-y-3 p-3 bg-white rounded border"},a.createElement("p",{className:"text-sm text-gray-600 mb-2"},a.createElement("strong",null,"Confirma las siguientes validaciones:")),a.createElement("div",{className:"flex items-center space-x-3"},a.createElement("input",{type:"checkbox",name:"documento_empresa_verificado",checked:e.documento_empresa_verificado,onChange:c,className:"rounded text-green-600",id:"documento_empresa_verificado"}),a.createElement("label",{htmlFor:"documento_empresa_verificado",className:"text-sm text-gray-700"},"Documento que acredita la empresa verificado")),a.createElement("div",{className:"flex items-center space-x-3"},a.createElement("input",{type:"checkbox",name:"firma_acuerdo_obtenida",checked:e.firma_acuerdo_obtenida,onChange:c,className:"rounded text-green-600",id:"firma_acuerdo_obtenida"}),a.createElement("label",{htmlFor:"firma_acuerdo_obtenida",className:"text-sm text-gray-700"},"Firma de acuerdo comercial obtenida")),a.createElement("div",{className:"flex items-center space-x-3"},a.createElement("input",{type:"checkbox",name:"direccion_verificada",checked:e.direccion_verificada,onChange:c,className:"rounded text-green-600",id:"direccion_verificada"}),a.createElement("label",{htmlFor:"direccion_verificada",className:"text-sm text-gray-700"},"Dirección verificada presencialmente"))),a.createElement("div",{className:"text-xs text-blue-700 bg-blue-100 p-2 rounded"},"💡 ",a.createElement("strong",null,"Nota:"),' Para agentes de campo, la validación presencial es opcional pero recomendada. Si marcas "Documentación validada", la solicitud tendrá prioridad en el procesamiento.'))),a.createElement("div",null,a.createElement("h3",{className:"text-lg font-medium text-gray-800 mb-4"},"🕒 Horarios de Atención"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},Object.entries(e.horarios).map(([v,x])=>a.createElement("div",{key:v,className:"border border-gray-200 rounded-lg p-4"},a.createElement("div",{className:"flex items-center justify-between mb-2"},a.createElement("label",{className:"font-medium text-gray-700 capitalize"},v),a.createElement("input",{type:"checkbox",checked:x.activo,onChange:E=>u(v,"activo",E.target.checked),className:"rounded text-blue-600"})),x.activo&&a.createElement("div",{className:"flex gap-2"},a.createElement("input",{type:"time",value:x.inicio,onChange:E=>u(v,"inicio",E.target.value),className:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm"}),a.createElement("span",{className:"text-gray-500 text-sm py-1"},"-"),a.createElement("input",{type:"time",value:x.fin,onChange:E=>u(v,"fin",E.target.value),className:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm"})))))),a.createElement("div",{className:"flex items-center"},a.createElement("input",{type:"checkbox",name:"activar_inmediatamente",checked:e.activar_inmediatamente,onChange:c,className:"rounded text-blue-600 mr-2"}),a.createElement("label",{className:"text-sm text-gray-700"},"Activar empresa inmediatamente (requiere permisos especiales)")),a.createElement("div",{className:"flex justify-end space-x-4"},a.createElement("button",{type:"button",onClick:()=>{n({nombre:"",email:"",telefono:"",direccion:"",categoria:"",descripcion:"",rut:"",contacto_nombre:"",contacto_telefono:"",encargado_nombre:"",encargado_telefono:"",encargado_email:"",encargado_fecha_nacimiento:"",encargado_cargo:"",documentacion_validada:!1,documento_empresa_verificado:!1,firma_acuerdo_obtenida:!1,direccion_verificada:!1,horarios:{lunes:{activo:!1,inicio:"09:00",fin:"18:00"},martes:{activo:!1,inicio:"09:00",fin:"18:00"},miercoles:{activo:!1,inicio:"09:00",fin:"18:00"},jueves:{activo:!1,inicio:"09:00",fin:"18:00"},viernes:{activo:!1,inicio:"09:00",fin:"18:00"},sabado:{activo:!1,inicio:"09:00",fin:"18:00"},domingo:{activo:!1,inicio:"09:00",fin:"18:00"}},activar_inmediatamente:!1}),o("")},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",disabled:r},"Limpiar"),a.createElement("button",{type:"submit",disabled:r,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50"},r?"Procesando...":"Enviar Solicitud"))))}function EN(){const{user:t}=Qe(),[e,n]=p.useState("dashboard"),[r,s]=p.useState([]),[i,o]=p.useState([]),[l,c]=p.useState({}),[u,d]=p.useState(!0);p.useEffect(()=>{t&&f()},[t]);const f=async()=>{try{d(!0);const v=pe(Q($,"agentes"),fe("uid","==",t.uid)),x=await ue(v);if(x.empty){console.error("No se encontró el agente con uid:",t.uid),d(!1);return}const E=x.docs[0],y=E.id;if(!E.data().activo){console.error("Agente desactivado"),d(!1);return}const C=pe(Q($,"solicitudes_empresa"),fe("agente_id","==",y),Et("fecha_solicitud","desc")),k=(await ue(C)).docs.map(w=>({id:w.id,...w.data()}));s(k);const _=pe(Q($,"empresas"),fe("agente_id","==",y),Et("fecha_activacion","desc")),N=(await ue(_)).docs.map(w=>({id:w.id,...w.data()}));o(N);const b={total_solicitudes:k.length,pendientes:k.filter(w=>w.estado==="pendiente").length,aprobadas:k.filter(w=>w.estado==="aprobada").length,empresas_activas:N.filter(w=>w.estado==="activa").length,empresas_inactivas:N.filter(w=>w.estado==="inactiva").length};c(b)}catch(v){console.error("Error cargando datos del agente:",v)}finally{d(!1)}},g=v=>v?(v.toDate?v.toDate():new Date(v)).toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return u?a.createElement("div",{className:"flex items-center justify-center p-8"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.createElement("p",{className:"text-gray-600"},"Cargando panel de agente..."))):a.createElement("div",{className:"p-6"},a.createElement("div",{className:"mb-6"},a.createElement("h1",{className:"text-3xl font-bold text-gray-800"},"Panel de Agente"),a.createElement("p",{className:"text-gray-600"},"Gestiona solicitudes y empresas desde terreno")),a.createElement("div",{className:"flex flex-wrap gap-2 mb-6"},a.createElement("button",{onClick:()=>n("dashboard"),className:`px-4 py-2 rounded-lg transition-colors ${e==="dashboard"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`},"📊 Dashboard"),a.createElement("button",{onClick:()=>n("nuevo"),className:`px-4 py-2 rounded-lg transition-colors ${e==="nuevo"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`},"➕ Nueva Empresa"),a.createElement("button",{onClick:()=>n("solicitudes"),className:`px-4 py-2 rounded-lg transition-colors ${e==="solicitudes"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`},"📋 Mis Solicitudes"),a.createElement("button",{onClick:()=>n("empresas"),className:`px-4 py-2 rounded-lg transition-colors ${e==="empresas"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`},"🏢 Empresas Activadas")),e==="dashboard"&&a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},a.createElement("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-200"},a.createElement("h3",{className:"text-lg font-semibold text-blue-800"},"Total Solicitudes"),a.createElement("p",{className:"text-3xl font-bold text-blue-600"},l.total_solicitudes||0)),a.createElement("div",{className:"bg-yellow-50 p-6 rounded-lg border border-yellow-200"},a.createElement("h3",{className:"text-lg font-semibold text-yellow-800"},"Pendientes"),a.createElement("p",{className:"text-3xl font-bold text-yellow-600"},l.pendientes||0)),a.createElement("div",{className:"bg-green-50 p-6 rounded-lg border border-green-200"},a.createElement("h3",{className:"text-lg font-semibold text-green-800"},"Empresas Activas"),a.createElement("p",{className:"text-3xl font-bold text-green-600"},l.empresas_activas||0)),a.createElement("div",{className:"bg-purple-50 p-6 rounded-lg border border-purple-200"},a.createElement("h3",{className:"text-lg font-semibold text-purple-800"},"Aprobadas"),a.createElement("p",{className:"text-3xl font-bold text-purple-600"},l.aprobadas||0))),a.createElement("div",{className:"bg-white rounded-lg shadow border border-gray-200"},a.createElement("div",{className:"p-6 border-b border-gray-200"},a.createElement("h3",{className:"text-xl font-semibold text-gray-800"},"Actividad Reciente")),a.createElement("div",{className:"p-6"},r.length===0?a.createElement("p",{className:"text-gray-500 text-center py-8"},"No hay solicitudes registradas. ¡Comienza registrando tu primera empresa!"):a.createElement("div",{className:"space-y-4"},r.slice(0,5).map(v=>a.createElement("div",{key:v.id,className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},a.createElement("div",null,a.createElement("h4",{className:"font-medium text-gray-800"},v.nombre),a.createElement("p",{className:"text-sm text-gray-600"},v.categoria," • ",g(v.fecha_solicitud))),a.createElement("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${v.estado==="pendiente"?"bg-yellow-100 text-yellow-800":v.estado==="aprobada"?"bg-green-100 text-green-800":v.estado==="rechazada"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`},v.estado))))))),e==="nuevo"&&a.createElement(K7,null),e==="solicitudes"&&a.createElement("div",{className:"bg-white rounded-lg shadow border border-gray-200"},a.createElement("div",{className:"p-6 border-b border-gray-200"},a.createElement("h3",{className:"text-xl font-semibold text-gray-800"},"Mis Solicitudes")),a.createElement("div",{className:"p-6"},r.length===0?a.createElement("p",{className:"text-gray-500 text-center py-8"},"No hay solicitudes registradas"):a.createElement("div",{className:"overflow-x-auto"},a.createElement("table",{className:"w-full"},a.createElement("thead",null,a.createElement("tr",{className:"border-b border-gray-200"},a.createElement("th",{className:"text-left py-3 px-4 font-medium text-gray-700"},"Empresa"),a.createElement("th",{className:"text-left py-3 px-4 font-medium text-gray-700"},"Categoría"),a.createElement("th",{className:"text-left py-3 px-4 font-medium text-gray-700"},"Estado"),a.createElement("th",{className:"text-left py-3 px-4 font-medium text-gray-700"},"Fecha"),a.createElement("th",{className:"text-left py-3 px-4 font-medium text-gray-700"},"Contacto"))),a.createElement("tbody",null,r.map(v=>a.createElement("tr",{key:v.id,className:"border-b border-gray-100 hover:bg-gray-50"},a.createElement("td",{className:"py-3 px-4"},a.createElement("div",null,a.createElement("p",{className:"font-medium text-gray-800"},v.nombre),a.createElement("p",{className:"text-sm text-gray-600"},v.direccion))),a.createElement("td",{className:"py-3 px-4 text-gray-700"},v.categoria),a.createElement("td",{className:"py-3 px-4"},a.createElement("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${v.estado==="pendiente"?"bg-yellow-100 text-yellow-800":v.estado==="aprobada"?"bg-green-100 text-green-800":v.estado==="rechazada"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`},v.estado)),a.createElement("td",{className:"py-3 px-4 text-gray-700"},g(v.fecha_solicitud)),a.createElement("td",{className:"py-3 px-4"},a.createElement("div",{className:"text-sm"},a.createElement("p",{className:"text-gray-800"},v.email),a.createElement("p",{className:"text-gray-600"},v.telefono)))))))))),e==="empresas"&&a.createElement("div",{className:"bg-white rounded-lg shadow border border-gray-200"},a.createElement("div",{className:"p-6 border-b border-gray-200"},a.createElement("h3",{className:"text-xl font-semibold text-gray-800"},"Empresas Activadas")),a.createElement("div",{className:"p-6"},i.length===0?a.createElement("p",{className:"text-gray-500 text-center py-8"},"No hay empresas activadas"):a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},i.map(v=>a.createElement("div",{key:v.id,className:"border border-gray-200 rounded-lg p-4"},a.createElement("div",{className:"flex items-start justify-between mb-3"},a.createElement("h4",{className:"font-medium text-gray-800"},v.nombre),a.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${v.estado==="activa"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`},v.estado)),a.createElement("div",{className:"space-y-2 text-sm text-gray-600"},a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Categoría:")," ",v.categoria),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Dirección:")," ",v.direccion),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Teléfono:")," ",v.telefono),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Activada:")," ",g(v.fecha_activacion))),v.web?a.createElement("a",{href:v.web.startsWith("http")?v.web:`https://${v.web}`,target:"_blank",rel:"noopener noreferrer",className:"inline-block mt-3 text-blue-600 hover:text-blue-800 text-sm"},"Ver sitio web →"):a.createElement("a",{href:`/empresa/${v.id}`,target:"_blank",rel:"noopener noreferrer",className:"inline-block mt-3 text-blue-600 hover:text-blue-800 text-sm"},"Ver perfil público →")))))))}function Q7(){return a.createElement(xu,null,a.createElement(Sb,null,a.createElement(Ie,{index:!0,element:a.createElement(EN,null)}),a.createElement(Ie,{path:"*",element:a.createElement(EN,null)})))}function J7(){const{user:t,rol:e}=Qe(),n=ft();return p.useEffect(()=>{n(t?e==="admin"?"/admin":e==="proveedor"?"/dashboard/proveedor":e==="agente"?"/agente":e==="mecanico"?"/dashboard/mecanico":"/dashboard/cliente":"/login")},[t,e,n]),a.createElement("div",null,"Cargando dashboard...")}function hh({children:t,rol:e}){const{user:n,rol:r,loading:s}=Qe();return console.log("ProtectedRoute - User:",n==null?void 0:n.email,"Required rol:",e,"User rol:",r,"Loading:",s),s?a.createElement("div",{className:"flex items-center justify-center min-h-screen"},a.createElement("div",{className:"text-lg"},"Verificando permisos...")):n?e&&r!==e?(console.log(`ProtectedRoute - Access denied: required ${e}, user has ${r}`),a.createElement("div",{className:"flex items-center justify-center min-h-screen"},a.createElement("div",{className:"text-center"},a.createElement("h2",{className:"text-xl font-bold text-red-600 mb-2"},"Acceso Denegado"),a.createElement("p",{className:"text-gray-600 mb-4"},"Se requiere rol '",e,"' pero tienes rol '",r||"ninguno","'"),a.createElement("button",{onClick:()=>window.history.back(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"Volver")))):(console.log("ProtectedRoute - Access granted"),t):(console.log("ProtectedRoute - Redirecting to login: no user"),a.createElement(JI,{to:"/login"}))}const UT={"Arica y Parinacota":["Arica","Camarones","Putre","General Lagos"],Tarapacá:["Iquique","Alto Hospicio","Pozo Almonte","Camiña","Colchane","Huara","Pica"],Antofagasta:["Antofagasta","Mejillones","Sierra Gorda","Taltal","Calama","Ollagüe","San Pedro de Atacama","Tocopilla","María Elena"],Atacama:["Copiapó","Caldera","Tierra Amarilla","Chañaral","Diego de Almagro","Vallenar","Alto del Carmen","Freirina","Huasco"],Coquimbo:["La Serena","Coquimbo","Andacollo","La Higuera","Paiguano","Vicuña","Illapel","Canela","Los Vilos","Salamanca","Ovalle","Combarbalá","Monte Patria","Punitaqui","Río Hurtado"],Valparaíso:["Valparaíso","Casablanca","Concón","Juan Fernández","Puchuncaví","Quintero","Viña del Mar","Isla de Pascua","Los Andes","Calle Larga","Rinconada","San Esteban","La Ligua","Cabildo","Papudo","Petorca","Zapallar","Quillota","Calera","Hijuelas","La Cruz","Nogales","San Antonio","Algarrobo","Cartagena","El Quisco","El Tabo","Santo Domingo","San Felipe","Catemu","Llaillay","Panquehue","Putaendo","Santa María","Quilpué","Limache","Olmué","Villa Alemana"],Metropolitana:["Santiago","Cerrillos","Cerro Navia","Conchalí","El Bosque","Estación Central","Huechuraba","Independencia","La Cisterna","La Florida","La Granja","La Pintana","La Reina","Las Condes","Lo Barnechea","Lo Espejo","Lo Prado","Macul","Maipú","Ñuñoa","Pedro Aguirre Cerda","Peñalolén","Providencia","Pudahuel","Quilicura","Quinta Normal","Recoleta","Renca","San Joaquín","San Miguel","San Ramón","Vitacura","Puente Alto","Pirque","San José de Maipo","Colina","Lampa","Tiltil","San Bernardo","Buin","Calera de Tango","Paine","Melipilla","Alhué","Curacaví","María Pinto","San Pedro","Talagante","El Monte","Isla de Maipo","Padre Hurtado","Peñaflor"],"O'Higgins":["Rancagua","Codegua","Coinco","Coltauco","Doñihue","Graneros","Las Cabras","Machalí","Malloa","Mostazal","Olivar","Peumo","Pichidegua","Quinta de Tilcoco","Rengo","Requínoa","San Vicente","Pichilemu","La Estrella","Litueche","Marchihue","Navidad","Paredones","San Fernando","Chépica","Chimbarongo","Lolol","Nancagua","Palmilla","Peralillo","Placilla","Pumanque","Santa Cruz"],Maule:["Talca","Constitución","Curepto","Empedrado","Maule","Pelarco","Pencahue","Río Claro","San Clemente","San Rafael","Cauquenes","Chanco","Pelluhue","Curicó","Hualañé","Licantén","Molina","Rauco","Romeral","Sagrada Familia","Teno","Vichuquén","Linares","Colbún","Longaví","Parral","Retiro","San Javier","Villa Alegre","Yerbas Buenas"],Ñuble:["Chillán","Bulnes","Cobquecura","Coelemu","Coihueco","Chillán Viejo","El Carmen","Ninhue","Ñiquén","Pemuco","Pinto","Portezuelo","Quillón","Quirihue","Ránquil","San Carlos","San Fabián","San Ignacio","San Nicolás","Treguaco","Yungay"],Biobío:["Concepción","Coronel","Chiguayante","Florida","Hualqui","Lota","Penco","San Pedro de la Paz","Santa Juana","Talcahuano","Tomé","Hualpén","Lebu","Arauco","Cañete","Contulmo","Curanilahue","Los Álamos","Tirúa","Los Ángeles","Antuco","Cabrero","Laja","Mulchén","Nacimiento","Negrete","Quilaco","Quilleco","San Rosendo","Santa Bárbara","Tucapel","Yumbel","Alto Biobío"],"La Araucanía":["Temuco","Carahue","Cunco","Curarrehue","Freire","Galvarino","Gorbea","Lautaro","Loncoche","Melipeuco","Nueva Imperial","Padre Las Casas","Perquenco","Pitrufquén","Pucón","Saavedra","Teodoro Schmidt","Toltén","Vilcún","Villarrica","Cholchol","Angol","Collipulli","Curacautín","Ercilla","Lonquimay","Los Sauces","Lumaco","Purén","Renaico","Traiguén","Victoria"],"Los Ríos":["Valdivia","Corral","Lanco","Los Lagos","Máfil","Mariquina","Paillaco","Panguipulli","La Unión","Futrono","Lago Ranco","Río Bueno"],"Los Lagos":["Puerto Montt","Calbuco","Cochamó","Fresia","Frutillar","Los Muermos","Llanquihue","Maullín","Puerto Varas","Castro","Ancud","Chonchi","Curaco de Vélez","Dalcahue","Puqueldón","Queilén","Quellón","Quemchi","Quinchao","Osorno","Puerto Octay","Purranque","Puyehue","Río Negro","San Juan de la Costa","San Pablo","Chaitén","Futaleufú","Hualaihué","Palena"],Aysén:["Coyhaique","Lago Verde","Aysén","Cisnes","Guaitecas","Cochrane","O'Higgins","Tortel","Chile Chico","Río Ibáñez"],Magallanes:["Punta Arenas","Laguna Blanca","Río Verde","San Gregorio","Cabo de Hornos","Antártica","Porvenir","Primavera","Timaukel","Natales","Torres del Paine"]},$T=()=>Object.keys(UT),Ym=t=>UT[t]||[];function Y7(){const t=ft(),[e,n]=p.useState(1),[r,s]=p.useState({nombres:"",apellidos:"",rut:"",telefono:"",email:"",direccion:"",comuna:"",ciudad:"",region:"",fecha_nacimiento:"",profesion:"",empresa:"",motivo_registro:"",servicios_interes:[],acepta_terminos:!1,acepta_notificaciones:!0,password:"",confirm_password:""}),[i,o]=p.useState({}),[l,c]=p.useState(!1),[u,d]=p.useState(!1),[f,g]=p.useState(5),[v,x]=p.useState([]),[E,y]=p.useState([]);p.useEffect(()=>{x($T())},[]),p.useEffect(()=>{r.region?(y(Ym(r.region)),r.comuna&&!Ym(r.region).includes(r.comuna)&&s(S=>({...S,comuna:""}))):y([])},[r.region]);const h=S=>{const{name:N,value:b,type:w,checked:A}=S.target;s(w==="checkbox"?N==="servicios_interes"?R=>({...R,servicios_interes:A?[...R.servicios_interes,b]:R.servicios_interes.filter(L=>L!==b)}):R=>({...R,[N]:A}):R=>({...R,[N]:b})),i[N]&&o(R=>({...R,[N]:""}))},C=()=>{const S={};return e===1?(r.nombres.trim()||(S.nombres="Los nombres son obligatorios"),r.apellidos.trim()||(S.apellidos="Los apellidos son obligatorios"),r.rut.trim()||(S.rut="El RUT es obligatorio"),r.telefono.trim()||(S.telefono="El teléfono es obligatorio"),r.email.trim()||(S.email="El email es obligatorio"),r.email&&!/\S+@\S+\.\S+/.test(r.email)&&(S.email="El email no es válido")):e===2?(r.direccion.trim()||(S.direccion="La dirección es obligatoria"),r.comuna.trim()||(S.comuna="La comuna es obligatoria"),r.ciudad.trim()||(S.ciudad="La ciudad es obligatoria"),r.region.trim()||(S.region="La región es obligatoria")):e===3?(r.fecha_nacimiento||(S.fecha_nacimiento="La fecha de nacimiento es obligatoria"),r.motivo_registro.trim()||(S.motivo_registro="El motivo de registro es obligatorio"),r.servicios_interes.length===0&&(S.servicios_interes="Selecciona al menos un servicio de interés")):e===4&&(r.password||(S.password="La contraseña es obligatoria"),r.password&&r.password.length<6&&(S.password="La contraseña debe tener al menos 6 caracteres"),r.password!==r.confirm_password&&(S.confirm_password="Las contraseñas no coinciden"),r.acepta_terminos||(S.acepta_terminos="Debes aceptar los términos y condiciones")),o(S),Object.keys(S).length===0},T=()=>{C()&&n(S=>S+1)},k=()=>{n(S=>S-1)},_=async S=>{if(S.preventDefault(),!!C()){c(!0);try{const N=pe(Q($,"solicitudes_cliente"),fe("email","==",r.email));if(!(await ue(N)).empty){o({email:"Ya existe una solicitud con este email"}),c(!1);return}const{password:w,confirm_password:A,...R}=r,L={...R,fecha_solicitud:new Date,estado_general:"enviada",etapa_actual:"validacion_datos",progreso_porcentaje:0,etapas:{validacion_datos:{estado:"pendiente",fecha_inicio:new Date,fecha_fin:null,comentarios:"",responsable:null},confirmacion_final:{estado:"pendiente",fecha_inicio:null,fecha_fin:null,comentarios:"",responsable:null}},documentos_adjuntos:[],notas_admin:"",agente_asignado:null,fecha_entrevista:null,puntuacion_evaluacion:null,motivo_rechazo:"",fecha_aprobacion:null,ip_registro:window.location.hostname,user_agent:navigator.userAgent,referencia:"web_directa",tipo_registro:"sin_auth",password_hash:btoa(r.password)},M=await ze(Q($,"solicitudes_cliente"),L);await sa.createInAppNotification("admin","validacion","Nueva Solicitud de Cliente",`${r.nombres} ${r.apellidos} ha enviado una solicitud de registro`,{solicitudId:M.id,clienteNombre:`${r.nombres} ${r.apellidos}`,clienteEmail:r.email,etapaActual:"revision_inicial",origen:"registro_cliente"}),d(!0);const F=setInterval(()=>{g(U=>U<=1?(clearInterval(F),t("/"),0):U-1)},1e3)}catch(N){console.error("Error creating client request:",N),alert("Error al enviar la solicitud. Por favor, intenta nuevamente.")}finally{c(!1)}}};return u?a.createElement("div",{className:"text-center space-y-6"},a.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6"},a.createElement("div",{className:"text-6xl mb-4"},"✅"),a.createElement("h2",{className:"text-2xl font-bold text-green-800 mb-2"},"¡Solicitud enviada exitosamente!"),a.createElement("p",{className:"text-green-700 mb-4"},"Hemos recibido tu solicitud de registro y será procesada en las próximas 24-48 horas."),a.createElement("div",{className:"bg-white border border-green-200 rounded-lg p-4 mb-4"},a.createElement("h3",{className:"font-semibold text-green-800 mb-2"},"¿Qué sigue ahora?"),a.createElement("div",{className:"text-sm text-green-700 text-left space-y-1"},a.createElement("p",null,"1. 📋 Nuestro equipo revisará tu información"),a.createElement("p",null,"2. ✉️ Te contactaremos por email para confirmar datos"),a.createElement("p",null,"3. 👤 Se te asignará un agente de campo local"),a.createElement("p",null,"4. 📞 Programaremos una breve entrevista (opcional)"),a.createElement("p",null,"5. 🎉 Una vez aprobado, recibirás tus credenciales de acceso"))),a.createElement("div",{className:"space-y-3"},a.createElement("p",{className:"text-sm text-green-600"},"📧 Te enviaremos actualizaciones a: ",a.createElement("strong",null,r.email)),a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4"},a.createElement("p",{className:"text-blue-800 text-center"},"🔄 Serás redirigido al inicio en ",a.createElement("strong",null,f)," segundos...")),a.createElement("div",{className:"flex gap-3 justify-center"},a.createElement("button",{onClick:()=>t("/"),className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors"},"Ir al Inicio Ahora"),a.createElement("button",{onClick:()=>t("/registro-proveedor"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors"},"Registrar Proveedor"))))):a.createElement("form",{onSubmit:e===4?_:S=>{S.preventDefault(),T()}},e===1&&a.createElement("div",{className:"space-y-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Información Personal"),a.createElement("div",{className:"grid md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombres *"),a.createElement("input",{type:"text",name:"nombres",value:r.nombres,onChange:h,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.nombres?"border-red-500":"border-gray-300"}`,placeholder:"Ingresa tus nombres"}),i.nombres&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},i.nombres)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Apellidos *"),a.createElement("input",{type:"text",name:"apellidos",value:r.apellidos,onChange:h,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.apellidos?"border-red-500":"border-gray-300"}`,placeholder:"Ingresa tus apellidos"}),i.apellidos&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},i.apellidos)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"RUT *"),a.createElement("input",{type:"text",name:"rut",value:r.rut,onChange:h,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.rut?"border-red-500":"border-gray-300"}`,placeholder:"12.345.678-9"}),i.rut&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},i.rut)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono *"),a.createElement("input",{type:"tel",name:"telefono",value:r.telefono,onChange:h,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.telefono?"border-red-500":"border-gray-300"}`,placeholder:"+56 9 1234 5678"}),i.telefono&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},i.telefono)),a.createElement("div",{className:"md:col-span-2"},a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email *"),a.createElement("input",{type:"email",name:"email",value:r.email,onChange:h,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.email?"border-red-500":"border-gray-300"}`,placeholder:"tu@email.com"}),i.email&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},i.email)))),e===2&&a.createElement("div",{className:"space-y-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Información de Residencia"),a.createElement("div",{className:"space-y-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Dirección *"),a.createElement("input",{type:"text",name:"direccion",value:r.direccion,onChange:h,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.direccion?"border-red-500":"border-gray-300"}`,placeholder:"Calle, número, departamento"}),i.direccion&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},i.direccion)),a.createElement("div",{className:"grid md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Comuna *"),a.createElement("input",{type:"text",name:"comuna",value:r.comuna,onChange:h,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.comuna?"border-red-500":"border-gray-300"}`,placeholder:"Tu comuna"}),i.comuna&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},i.comuna)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Ciudad *"),a.createElement("input",{type:"text",name:"ciudad",value:r.ciudad,onChange:h,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.ciudad?"border-red-500":"border-gray-300"}`,placeholder:"Tu ciudad"}),i.ciudad&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},i.ciudad))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Región *"),a.createElement("select",{name:"region",value:r.region,onChange:h,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.region?"border-red-500":"border-gray-300"}`},a.createElement("option",{value:""},"Selecciona tu región"),a.createElement("option",{value:"Arica y Parinacota"},"Arica y Parinacota"),a.createElement("option",{value:"Tarapacá"},"Tarapacá"),a.createElement("option",{value:"Antofagasta"},"Antofagasta"),a.createElement("option",{value:"Atacama"},"Atacama"),a.createElement("option",{value:"Coquimbo"},"Coquimbo"),a.createElement("option",{value:"Valparaíso"},"Valparaíso"),a.createElement("option",{value:"Metropolitana"},"Metropolitana"),a.createElement("option",{value:"O'Higgins"},"O'Higgins"),a.createElement("option",{value:"Maule"},"Maule"),a.createElement("option",{value:"Ñuble"},"Ñuble"),a.createElement("option",{value:"Biobío"},"Biobío"),a.createElement("option",{value:"La Araucanía"},"La Araucanía"),a.createElement("option",{value:"Los Ríos"},"Los Ríos"),a.createElement("option",{value:"Los Lagos"},"Los Lagos"),a.createElement("option",{value:"Aysén"},"Aysén"),a.createElement("option",{value:"Magallanes"},"Magallanes")),i.region&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},i.region)))),e===3&&a.createElement("div",{className:"space-y-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Información Adicional"),a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"grid md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Fecha de Nacimiento *"),a.createElement("input",{type:"date",name:"fecha_nacimiento",value:r.fecha_nacimiento,onChange:h,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.fecha_nacimiento?"border-red-500":"border-gray-300"}`}),i.fecha_nacimiento&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},i.fecha_nacimiento)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Profesión"),a.createElement("input",{type:"text",name:"profesion",value:r.profesion,onChange:h,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Tu profesión"}))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Empresa (Opcional)"),a.createElement("input",{type:"text",name:"empresa",value:r.empresa,onChange:h,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre de tu empresa"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Motivo de Registro *"),a.createElement("textarea",{name:"motivo_registro",value:r.motivo_registro,onChange:h,rows:3,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.motivo_registro?"border-red-500":"border-gray-300"}`,placeholder:"Cuéntanos por qué quieres registrarte en nuestra plataforma"}),i.motivo_registro&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},i.motivo_registro)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-3"},"Servicios de Interés *"),a.createElement("div",{className:"grid md:grid-cols-2 gap-3"},["Repuestos y Autopartes","Mantención Preventiva","Reparaciones Mecánicas","Seguros Automotrices","Revisión Técnica","Vulcanización","Servicios de Emergencia","Reciclaje de Vehículos"].map(S=>a.createElement("label",{key:S,className:"flex items-center space-x-2"},a.createElement("input",{type:"checkbox",name:"servicios_interes",value:S,checked:r.servicios_interes.includes(S),onChange:h,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("span",{className:"text-sm text-gray-700"},S)))),i.servicios_interes&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},i.servicios_interes)))),e===4&&a.createElement("div",{className:"space-y-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Credenciales y Confirmación"),a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},a.createElement("h3",{className:"font-semibold text-blue-900 mb-2"},"Configura tu contraseña"),a.createElement("p",{className:"text-sm text-blue-800"},"Esta contraseña se usará para crear tu cuenta una vez que tu solicitud sea aprobada.")),a.createElement("div",{className:"grid md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña *"),a.createElement("input",{type:"password",name:"password",value:r.password,onChange:h,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.password?"border-red-500":"border-gray-300"}`,placeholder:"Mínimo 6 caracteres"}),i.password&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},i.password)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirmar Contraseña *"),a.createElement("input",{type:"password",name:"confirm_password",value:r.confirm_password,onChange:h,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${i.confirm_password?"border-red-500":"border-gray-300"}`,placeholder:"Repite tu contraseña"}),i.confirm_password&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},i.confirm_password))),a.createElement("div",{className:"bg-gray-50 rounded-lg p-6"},a.createElement("h3",{className:"font-semibold text-lg mb-4"},"Resumen de tu información:"),a.createElement("div",{className:"grid md:grid-cols-2 gap-4 text-sm"},a.createElement("div",null,a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Nombre:")," ",r.nombres," ",r.apellidos),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"RUT:")," ",r.rut),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Email:")," ",r.email),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Teléfono:")," ",r.telefono),r.profesion&&a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Profesión:")," ",r.profesion)),a.createElement("div",null,a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Dirección:")," ",r.direccion),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Comuna:")," ",r.comuna),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Ciudad:")," ",r.ciudad),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Región:")," ",r.region),r.empresa&&a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Empresa:")," ",r.empresa)))),a.createElement("div",{className:"space-y-4"},a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("input",{type:"checkbox",name:"acepta_terminos",checked:r.acepta_terminos,onChange:h,className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("label",{className:"text-sm text-gray-700"},"Acepto los ",a.createElement("a",{href:"/terminos",target:"_blank",className:"text-blue-600 hover:underline"},"términos y condiciones")," de AV10 de Julio *")),i.acepta_terminos&&a.createElement("p",{className:"text-red-500 text-sm"},i.acepta_terminos),a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("input",{type:"checkbox",name:"acepta_notificaciones",checked:r.acepta_notificaciones,onChange:h,className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("label",{className:"text-sm text-gray-700"},"Acepto recibir notificaciones sobre recordatorios, ofertas y novedades de la plataforma"))),a.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},a.createElement("h4",{className:"font-semibold text-green-900 mb-2"},"¿Qué sigue después?"),a.createElement("div",{className:"text-sm text-green-800 space-y-1"},a.createElement("p",null,"1. Recibirás un email de confirmación inmediatamente"),a.createElement("p",null,"2. Tu solicitud será revisada en 24-48 horas"),a.createElement("p",null,"3. Te contactaremos para validar la información"),a.createElement("p",null,"4. Se te asignará un agente de campo de tu zona"),a.createElement("p",null,"5. Una vez aprobado, se activará tu cuenta con la contraseña elegida")))),a.createElement("div",{className:"flex justify-between mt-8"},e>1&&a.createElement("button",{type:"button",onClick:k,className:"bg-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-400 transition-colors"},"← Anterior"),a.createElement("div",{className:"flex-1"}),a.createElement("div",{className:"flex-1 flex justify-center items-center"},a.createElement("div",{className:"flex space-x-2"},[1,2,3,4].map(S=>a.createElement("div",{key:S,className:`w-3 h-3 rounded-full ${S<=e?"bg-blue-600":"bg-gray-300"}`}))),a.createElement("span",{className:"ml-3 text-sm text-gray-600"},"Paso ",e," de 4")),a.createElement("div",{className:"flex-1 flex justify-end"},e<4?a.createElement("button",{type:"button",onClick:T,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors"},"Siguiente →"):a.createElement("button",{type:"submit",disabled:l,className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50"},l?"Enviando Solicitud...":"📨 Enviar Solicitud"))))}function Z7(){const{user:t}=Qe(),e=ft(),[n,r]=p.useState(null),[s,i]=p.useState(!0),[o,l]=p.useState(1),[c,u]=p.useState({nombres:"",apellidos:"",rut:"",telefono:"",email:"",direccion:"",comuna:"",ciudad:"",region:"",fecha_nacimiento:"",profesion:"",empresa:"",motivo_registro:"",servicios_interes:[],acepta_terminos:!1,acepta_notificaciones:!0}),[d,f]=p.useState({}),[g,v]=p.useState(!1),[x,E]=p.useState(null);p.useEffect(()=>{(async()=>{if(!t){i(!1);return}try{const S=pe(Q($,"perfiles_clientes"),fe("uid","==",t.uid)),N=await ue(S);if(N.empty){const b=pe(Q($,"solicitudes_cliente"),fe("uid","==",t.uid)),w=await ue(b);if(!w.empty){const A={id:w.docs[0].id,...w.docs[0].data()};E(A)}}else{const b=N.docs[0].data();r(b)}}catch(S){console.error("Error checking existing profile:",S)}finally{i(!1)}})()},[t]);const y=_=>{const{name:S,value:N,type:b,checked:w}=_.target;u(b==="checkbox"?S==="servicios_interes"?A=>({...A,servicios_interes:w?[...A.servicios_interes,N]:A.servicios_interes.filter(R=>R!==N)}):A=>({...A,[S]:w}):A=>({...A,[S]:N})),d[S]&&f(A=>({...A,[S]:""}))},h=()=>{const _={};return o===1?(c.nombres.trim()||(_.nombres="Los nombres son obligatorios"),c.apellidos.trim()||(_.apellidos="Los apellidos son obligatorios"),c.rut.trim()||(_.rut="El RUT es obligatorio"),c.telefono.trim()||(_.telefono="El teléfono es obligatorio"),c.email.trim()||(_.email="El email es obligatorio"),c.email&&!/\S+@\S+\.\S+/.test(c.email)&&(_.email="El email no es válido")):o===2?(c.direccion.trim()||(_.direccion="La dirección es obligatoria"),c.comuna.trim()||(_.comuna="La comuna es obligatoria"),c.ciudad.trim()||(_.ciudad="La ciudad es obligatoria"),c.region.trim()||(_.region="La región es obligatoria")):o===3?(c.fecha_nacimiento||(_.fecha_nacimiento="La fecha de nacimiento es obligatoria"),c.motivo_registro.trim()||(_.motivo_registro="El motivo de registro es obligatorio"),c.servicios_interes.length===0&&(_.servicios_interes="Selecciona al menos un servicio de interés")):o===4&&(c.acepta_terminos||(_.acepta_terminos="Debes aceptar los términos y condiciones")),f(_),Object.keys(_).length===0},C=()=>{h()&&l(_=>_+1)},T=()=>{l(_=>_-1)},k=async _=>{if(_.preventDefault(),!!h()){v(!0);try{const S={...c,uid:t.uid,email_usuario:t.email,fecha_solicitud:new Date,estado_general:"enviada",etapa_actual:"revision_inicial",progreso_porcentaje:10,etapas:{revision_inicial:{estado:"pendiente",fecha_inicio:new Date,fecha_fin:null,comentarios:"",responsable:null},validacion_datos:{estado:"pendiente",fecha_inicio:null,fecha_fin:null,comentarios:"",responsable:null},asignacion_agente:{estado:"pendiente",fecha_inicio:null,fecha_fin:null,comentarios:"",responsable:null},entrevista:{estado:"pendiente",fecha_inicio:null,fecha_fin:null,comentarios:"",responsable:null},aprobacion_final:{estado:"pendiente",fecha_inicio:null,fecha_fin:null,comentarios:"",responsable:null}},documentos_adjuntos:[],notas_admin:"",agente_asignado:null,fecha_entrevista:null,puntuacion_evaluacion:null,motivo_rechazo:"",fecha_aprobacion:null,ip_registro:window.location.hostname,user_agent:navigator.userAgent,referencia:"web_directa"},N=await ze(Q($,"solicitudes_cliente"),S);await sa.createInAppNotification("admin","validacion","Nueva Solicitud de Cliente",`${c.nombres} ${c.apellidos} ha enviado una solicitud de registro`,{solicitudId:N.id,clienteNombre:`${c.nombres} ${c.apellidos}`,clienteEmail:c.email,etapaActual:"revision_inicial",origen:"registro_cliente"}),E({id:N.id,...S,estado_general:"enviada"})}catch(S){console.error("Error creating client request:",S),alert("Error al enviar la solicitud. Por favor, intenta nuevamente.")}finally{v(!1)}}};return t?s?a.createElement("div",{className:"min-h-screen flex items-center justify-center"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.createElement("p",{className:"text-gray-600"},"Cargando..."))):a.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},a.createElement("div",{className:"max-w-2xl mx-auto px-4"},a.createElement("div",{className:"bg-white rounded-lg shadow-md p-8"},a.createElement("div",{className:"text-center mb-8"},a.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Registro de Cliente"),a.createElement("p",{className:"text-gray-600"},"Completa tu perfil para acceder a todos nuestros servicios")),n?a.createElement("div",{className:"text-center space-y-4"},a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6"},a.createElement("h2",{className:"text-xl font-semibold text-blue-800 mb-2"},"¡Tu perfil ya está registrado!"),a.createElement("p",{className:"text-blue-600 mb-4"},"Estado: ",a.createElement("span",{className:"font-medium capitalize"},n.estado_validacion)),n.estado_validacion==="pendiente"&&a.createElement("p",{className:"text-sm text-blue-600 mb-4"},"Tu perfil está siendo revisado por nuestro equipo. Te notificaremos cuando esté aprobado."),n.estado_validacion==="validado"&&a.createElement("p",{className:"text-sm text-green-600 mb-4"},"¡Tu perfil ha sido validado! Ya puedes acceder a tu dashboard."),a.createElement("div",{className:"space-y-2"},a.createElement("button",{onClick:()=>e("/dashboard"),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors"},"Ir al Dashboard")))):x?a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6"},a.createElement("h2",{className:"text-xl font-semibold text-blue-800 mb-4"},"Tu solicitud está en proceso"),a.createElement("div",{className:"flex items-center justify-between mb-6"},a.createElement("div",null,a.createElement("p",{className:"text-sm text-gray-600"},"Estado de solicitud:"),a.createElement("span",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium ${x.estado_general==="enviada"?"bg-blue-100 text-blue-800":x.estado_general==="en_revision"?"bg-yellow-100 text-yellow-800":x.estado_general==="aprobada"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},x.estado_general==="enviada"?"Enviada":x.estado_general==="en_revision"?"En Revisión":x.estado_general==="aprobada"?"Aprobada":"Rechazada")),a.createElement("div",{className:"text-right"},a.createElement("p",{className:"text-sm text-gray-600"},"Progreso:"),a.createElement("div",{className:"flex items-center"},a.createElement("div",{className:"w-24 bg-gray-200 rounded-full h-2 mr-2"},a.createElement("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${x.progreso_porcentaje}%`}})),a.createElement("span",{className:"text-sm font-medium text-blue-600"},x.progreso_porcentaje,"%")))),a.createElement("div",{className:"space-y-4"},a.createElement("h3",{className:"font-semibold text-gray-900"},"Etapas del proceso:"),Object.entries(x.etapas||{}).map(([_,S],N)=>{const b={revision_inicial:"1. Revisión Inicial",validacion_datos:"2. Validación de Datos",asignacion_agente:"3. Asignación de Agente",entrevista:"4. Entrevista",aprobacion_final:"5. Aprobación Final"};return a.createElement("div",{key:_,className:"flex items-center space-x-3"},a.createElement("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${S.estado==="completada"?"bg-green-500 text-white":S.estado==="en_proceso"?"bg-blue-500 text-white":S.estado==="rechazada"?"bg-red-500 text-white":"bg-gray-300 text-gray-600"}`},S.estado==="completada"?"✓":S.estado==="rechazada"?"✗":N+1),a.createElement("div",{className:"flex-1"},a.createElement("p",{className:"font-medium text-gray-900"},b[_]),a.createElement("p",{className:"text-sm text-gray-600"},S.estado==="completada"?"Completada":S.estado==="en_proceso"?"En proceso":S.estado==="rechazada"?"Rechazada":"Pendiente",S.fecha_fin&&` - ${new Date(S.fecha_fin.toDate()).toLocaleDateString()}`),S.comentarios&&a.createElement("p",{className:"text-sm text-blue-600 mt-1"},S.comentarios)))})),x.estado_general==="enviada"&&a.createElement("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg"},a.createElement("p",{className:"text-sm text-blue-800"},"📋 Tu solicitud ha sido recibida y será revisada en las próximas 24-48 horas.")),x.agente_asignado&&a.createElement("div",{className:"mt-6 p-4 bg-green-50 rounded-lg"},a.createElement("p",{className:"text-sm text-green-800"},"👤 Agente asignado: ",x.agente_asignado.nombre),x.fecha_entrevista&&a.createElement("p",{className:"text-sm text-green-700 mt-1"},"📅 Entrevista programada: ",new Date(x.fecha_entrevista.toDate()).toLocaleDateString())),a.createElement("div",{className:"mt-6 text-center"},a.createElement("button",{onClick:()=>e("/dashboard"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors"},"Ver Mi Dashboard")))):a.createElement("form",{onSubmit:o===4?k:_=>{_.preventDefault(),C()}},o===1&&a.createElement("div",{className:"space-y-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Información Personal"),a.createElement("div",{className:"grid md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombres *"),a.createElement("input",{type:"text",name:"nombres",value:c.nombres,onChange:y,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.nombres?"border-red-500":"border-gray-300"}`,placeholder:"Ingresa tus nombres"}),d.nombres&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},d.nombres)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Apellidos *"),a.createElement("input",{type:"text",name:"apellidos",value:c.apellidos,onChange:y,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.apellidos?"border-red-500":"border-gray-300"}`,placeholder:"Ingresa tus apellidos"}),d.apellidos&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},d.apellidos)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"RUT *"),a.createElement("input",{type:"text",name:"rut",value:c.rut,onChange:y,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.rut?"border-red-500":"border-gray-300"}`,placeholder:"12.345.678-9"}),d.rut&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},d.rut)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono *"),a.createElement("input",{type:"tel",name:"telefono",value:c.telefono,onChange:y,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.telefono?"border-red-500":"border-gray-300"}`,placeholder:"+56 9 1234 5678"}),d.telefono&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},d.telefono)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email *"),a.createElement("input",{type:"email",name:"email",value:c.email,onChange:y,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.email?"border-red-500":"border-gray-300"}`,placeholder:"tu@email.com"}),d.email&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},d.email)))),o===2&&a.createElement("div",{className:"space-y-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Información de Residencia"),a.createElement("div",{className:"space-y-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Dirección *"),a.createElement("input",{type:"text",name:"direccion",value:c.direccion,onChange:y,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.direccion?"border-red-500":"border-gray-300"}`,placeholder:"Calle, número, departamento"}),d.direccion&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},d.direccion)),a.createElement("div",{className:"grid md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Comuna *"),a.createElement("input",{type:"text",name:"comuna",value:c.comuna,onChange:y,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.comuna?"border-red-500":"border-gray-300"}`,placeholder:"Tu comuna"}),d.comuna&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},d.comuna)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Ciudad *"),a.createElement("input",{type:"text",name:"ciudad",value:c.ciudad,onChange:y,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.ciudad?"border-red-500":"border-gray-300"}`,placeholder:"Tu ciudad"}),d.ciudad&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},d.ciudad))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Región *"),a.createElement("select",{name:"region",value:c.region,onChange:y,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.region?"border-red-500":"border-gray-300"}`},a.createElement("option",{value:""},"Selecciona tu región"),a.createElement("option",{value:"Arica y Parinacota"},"Arica y Parinacota"),a.createElement("option",{value:"Tarapacá"},"Tarapacá"),a.createElement("option",{value:"Antofagasta"},"Antofagasta"),a.createElement("option",{value:"Atacama"},"Atacama"),a.createElement("option",{value:"Coquimbo"},"Coquimbo"),a.createElement("option",{value:"Valparaíso"},"Valparaíso"),a.createElement("option",{value:"Metropolitana"},"Metropolitana"),a.createElement("option",{value:"O'Higgins"},"O'Higgins"),a.createElement("option",{value:"Maule"},"Maule"),a.createElement("option",{value:"Ñuble"},"Ñuble"),a.createElement("option",{value:"Biobío"},"Biobío"),a.createElement("option",{value:"La Araucanía"},"La Araucanía"),a.createElement("option",{value:"Los Ríos"},"Los Ríos"),a.createElement("option",{value:"Los Lagos"},"Los Lagos"),a.createElement("option",{value:"Aysén"},"Aysén"),a.createElement("option",{value:"Magallanes"},"Magallanes")),d.region&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},d.region)))),o===3&&a.createElement("div",{className:"space-y-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Información Adicional"),a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"grid md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Fecha de Nacimiento *"),a.createElement("input",{type:"date",name:"fecha_nacimiento",value:c.fecha_nacimiento,onChange:y,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.fecha_nacimiento?"border-red-500":"border-gray-300"}`}),d.fecha_nacimiento&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},d.fecha_nacimiento)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Profesión"),a.createElement("input",{type:"text",name:"profesion",value:c.profesion,onChange:y,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Tu profesión"}))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Empresa (Opcional)"),a.createElement("input",{type:"text",name:"empresa",value:c.empresa,onChange:y,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre de tu empresa"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Motivo de Registro *"),a.createElement("textarea",{name:"motivo_registro",value:c.motivo_registro,onChange:y,rows:3,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.motivo_registro?"border-red-500":"border-gray-300"}`,placeholder:"Cuéntanos por qué quieres registrarte en nuestra plataforma"}),d.motivo_registro&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},d.motivo_registro)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-3"},"Servicios de Interés *"),a.createElement("div",{className:"grid md:grid-cols-2 gap-3"},["Repuestos y Autopartes","Mantención Preventiva","Reparaciones Mecánicas","Seguros Automotrices","Revisión Técnica","Vulcanización","Servicios de Emergencia","Reciclaje de Vehículos"].map(_=>a.createElement("label",{key:_,className:"flex items-center space-x-2"},a.createElement("input",{type:"checkbox",name:"servicios_interes",value:_,checked:c.servicios_interes.includes(_),onChange:y,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("span",{className:"text-sm text-gray-700"},_)))),d.servicios_interes&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},d.servicios_interes)))),o===4&&a.createElement("div",{className:"space-y-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Credenciales y Confirmación"),a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},a.createElement("h3",{className:"font-semibold text-blue-900 mb-2"},"Configura tu contraseña"),a.createElement("p",{className:"text-sm text-blue-800"},"Esta contraseña se usará para crear tu cuenta una vez que tu solicitud sea aprobada.")),a.createElement("div",{className:"grid md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña *"),a.createElement("input",{type:"password",name:"password",value:c.password,onChange:y,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.password?"border-red-500":"border-gray-300"}`,placeholder:"Mínimo 6 caracteres"}),d.password&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},d.password)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirmar Contraseña *"),a.createElement("input",{type:"password",name:"confirm_password",value:c.confirm_password,onChange:y,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${d.confirm_password?"border-red-500":"border-gray-300"}`,placeholder:"Repite tu contraseña"}),d.confirm_password&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},d.confirm_password))),a.createElement("div",{className:"bg-gray-50 rounded-lg p-6"},a.createElement("h3",{className:"font-semibold text-lg mb-4"},"Resumen de tu información:"),a.createElement("div",{className:"grid md:grid-cols-2 gap-4 text-sm"},a.createElement("div",null,a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Nombre:")," ",c.nombres," ",c.apellidos),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"RUT:")," ",c.rut),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Email:")," ",c.email),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Teléfono:")," ",c.telefono),c.profesion&&a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Profesión:")," ",c.profesion)),a.createElement("div",null,a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Dirección:")," ",c.direccion),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Comuna:")," ",c.comuna),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Ciudad:")," ",c.ciudad),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Región:")," ",c.region),c.empresa&&a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Empresa:")," ",c.empresa)))),a.createElement("div",{className:"space-y-4"},a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("input",{type:"checkbox",name:"acepta_terminos",checked:c.acepta_terminos,onChange:y,className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("label",{className:"text-sm text-gray-700"},"Acepto los ",a.createElement("a",{href:"/terminos",target:"_blank",className:"text-blue-600 hover:underline"},"términos y condiciones")," de AV10 de Julio *")),d.acepta_terminos&&a.createElement("p",{className:"text-red-500 text-sm"},d.acepta_terminos),a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("input",{type:"checkbox",name:"acepta_notificaciones",checked:c.acepta_notificaciones,onChange:y,className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("label",{className:"text-sm text-gray-700"},"Acepto recibir notificaciones sobre recordatorios, ofertas y novedades de la plataforma"))),a.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},a.createElement("h4",{className:"font-semibold text-green-900 mb-2"},"¿Qué sigue después?"),a.createElement("div",{className:"text-sm text-green-800 space-y-1"},a.createElement("p",null,"1. Recibirás un email de confirmación inmediatamente"),a.createElement("p",null,"2. Tu solicitud será revisada en 24-48 horas"),a.createElement("p",null,"3. Te contactaremos para validar la información"),a.createElement("p",null,"4. Se te asignará un agente de campo de tu zona"),a.createElement("p",null,"5. Una vez aprobado, se activará tu cuenta con la contraseña elegida")))),a.createElement("div",{className:"flex justify-between mt-8"},o>1&&a.createElement("button",{type:"button",onClick:T,className:"bg-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-400 transition-colors"},"← Anterior"),a.createElement("div",{className:"flex-1"}),a.createElement("div",{className:"flex-1 flex justify-center items-center"},a.createElement("div",{className:"flex space-x-2"},[1,2,3,4].map(_=>a.createElement("div",{key:_,className:`w-3 h-3 rounded-full ${_<=o?"bg-blue-600":"bg-gray-300"}`}))),a.createElement("span",{className:"ml-3 text-sm text-gray-600"},"Paso ",o," de 4")),a.createElement("div",{className:"flex-1 flex justify-end"},o<4?a.createElement("button",{type:"button",onClick:C,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors"},"Siguiente →"):a.createElement("button",{type:"submit",disabled:g,className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50"},g?"Enviando Solicitud...":"📨 Enviar Solicitud"))))))):a.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},a.createElement("div",{className:"max-w-2xl mx-auto px-4"},a.createElement("div",{className:"bg-white rounded-lg shadow-md p-8"},a.createElement("div",{className:"text-center mb-8"},a.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Registro de Cliente"),a.createElement("p",{className:"text-gray-600"},"Completa tu información para solicitar acceso a nuestros servicios"),a.createElement("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg"},a.createElement("p",{className:"text-sm text-blue-800"},"ℹ️ No necesitas tener una cuenta para enviar tu solicitud. El acceso se creará después de la aprobación."))),a.createElement(Y7,null))))}function xN(){const t=ft(),[e,n]=p.useState(1),[r,s]=p.useState({nombre_empresa:"",rut_empresa:"",direccion_empresa:"",comuna:"",ciudad:"Santiago",region:"Metropolitana",telefono_empresa:"",email_empresa:"",web_actual:"",nombres_representante:"",apellidos_representante:"",cargo_representante:"",telefono_representante:"",email_representante:"",descripcion_negocio:"",anos_funcionamiento:"",numero_empleados:"",horario_atencion:"",categorias_servicios:[],marcas_vehiculos:[],necesita_pagina_web:!1,tipo_pagina_web:"",tiene_redes_sociales:!1,redes_sociales:{facebook:"",instagram:"",whatsapp:"",tiktok:""},password:"",confirm_password:"",acepta_terminos:!1,acepta_notificaciones:!0,acepta_visita_campo:!0}),[i,o]=p.useState([]),[l,c]=p.useState([]),[u,d]=p.useState([]),[f,g]=p.useState([]),[v,x]=p.useState({}),[E,y]=p.useState(!1),[h,C]=p.useState(!1),[T,k]=p.useState(5);p.useEffect(()=>{d($T())},[]),p.useEffect(()=>{r.region?(g(Ym(r.region)),r.comuna&&!Ym(r.region).includes(r.comuna)&&s(L=>({...L,comuna:""}))):g([])},[r.region]),p.useEffect(()=>{async function L(){try{const F=(await ue(Q($,"categorias"))).docs.map(j=>j.data().nombre);o(F);const D=(await ue(Q($,"marcas"))).docs.map(j=>j.data().nombre);c(D)}catch(M){console.error("Error loading categories and brands:",M)}}L()},[]);const _=["Arica y Parinacota","Tarapacá","Antofagasta","Atacama","Coquimbo","Valparaíso","Metropolitana","O'Higgins","Maule","Ñuble","Biobío","La Araucanía","Los Ríos","Los Lagos","Aysén","Magallanes"],S=[{tipo:"basica",nombre:"Página Básica",precio:"$299.990",descripcion:"Sitio web simple con información básica de tu empresa",incluye:["Página principal con información de contacto","Galería de servicios básica","Formulario de contacto","Responsive (adaptable a móviles)","Hosting incluido por 1 año"]},{tipo:"intermedia",nombre:"Página Intermedia",precio:"$549.990",descripcion:"Sitio web completo con funcionalidades avanzadas",incluye:["Todo lo de la página básica","Catálogo de productos/servicios","Sistema de citas online","Integración con redes sociales","Chat en vivo","Blog/noticias","SEO básico"]},{tipo:"completa",nombre:"Página Completa",precio:"$899.990",descripcion:"Plataforma e-commerce completa para tu negocio",incluye:["Todo lo de la página intermedia","Tienda online completa","Sistema de pagos integrado","Gestión de inventario","Dashboard administrativo","App móvil básica","SEO avanzado y marketing digital","Soporte prioritario por 6 meses"]}],N=L=>{const{name:M,value:F,type:U,checked:D}=L.target;if(U==="checkbox")s(M==="categorias_servicios"?j=>({...j,categorias_servicios:D?[...j.categorias_servicios,F]:j.categorias_servicios.filter(V=>V!==F)}):M==="marcas_vehiculos"?j=>({...j,marcas_vehiculos:D?[...j.marcas_vehiculos,F]:j.marcas_vehiculos.filter(V=>V!==F)}):j=>({...j,[M]:D}));else if(M.startsWith("redes_sociales.")){const j=M.split(".")[1];s(V=>({...V,redes_sociales:{...V.redes_sociales,[j]:F}}))}else s(j=>({...j,[M]:F}));v[M]&&x(j=>({...j,[M]:""}))},b=()=>{const L={};return e===1?(r.nombre_empresa.trim()||(L.nombre_empresa="El nombre de la empresa es obligatorio"),r.rut_empresa.trim()||(L.rut_empresa="El RUT de la empresa es obligatorio"),r.direccion_empresa.trim()||(L.direccion_empresa="La dirección es obligatoria"),r.telefono_empresa.trim()||(L.telefono_empresa="El teléfono es obligatorio"),r.email_empresa.trim()||(L.email_empresa="El email de la empresa es obligatorio"),r.email_empresa&&!/\S+@\S+\.\S+/.test(r.email_empresa)&&(L.email_empresa="El email no es válido")):e===2?(r.nombres_representante.trim()||(L.nombres_representante="Los nombres del representante son obligatorios"),r.apellidos_representante.trim()||(L.apellidos_representante="Los apellidos del representante son obligatorios"),r.email_representante.trim()||(L.email_representante="El email del representante es obligatorio"),r.email_representante&&!/\S+@\S+\.\S+/.test(r.email_representante)&&(L.email_representante="El email no es válido")):e===3?(r.descripcion_negocio.trim()||(L.descripcion_negocio="La descripción del negocio es obligatoria"),r.anos_funcionamiento||(L.anos_funcionamiento="Los años de funcionamiento son obligatorios"),r.horario_atencion.trim()||(L.horario_atencion="El horario de atención es obligatorio"),r.categorias_servicios.length===0&&(L.categorias_servicios="Selecciona al menos una categoría de servicio"),r.marcas_vehiculos.length===0&&(L.marcas_vehiculos="Selecciona al menos una marca de vehículo")):e===4?r.necesita_pagina_web&&!r.tipo_pagina_web&&(L.tipo_pagina_web="Selecciona el tipo de página web que necesitas"):e===5&&(r.password||(L.password="La contraseña es obligatoria"),r.password&&r.password.length<6&&(L.password="La contraseña debe tener al menos 6 caracteres"),r.password!==r.confirm_password&&(L.confirm_password="Las contraseñas no coinciden"),r.acepta_terminos||(L.acepta_terminos="Debes aceptar los términos y condiciones")),x(L),Object.keys(L).length===0},w=()=>{b()&&n(L=>L+1)},A=()=>{n(L=>L-1)},R=async L=>{if(L.preventDefault(),!!b()){y(!0);try{const M=pe(Q($,"solicitudes_proveedor"),fe("email_empresa","==",r.email_empresa));if(!(await ue(M)).empty){x({email_empresa:"Ya existe una solicitud con este email de empresa"}),y(!1);return}const{password:U,confirm_password:D,...j}=r,V={...j,fecha_solicitud:new Date,estado_general:"enviada",etapa_actual:"revision_inicial",progreso_porcentaje:15,etapas:{revision_inicial:{estado:"pendiente",fecha_inicio:new Date,fecha_fin:null,comentarios:"",responsable:null},validacion_documentos:{estado:"pendiente",fecha_inicio:null,fecha_fin:null,comentarios:"",responsable:null},verificacion_ubicacion:{estado:"pendiente",fecha_inicio:null,fecha_fin:null,comentarios:"",responsable:null},visita_campo:{estado:"pendiente",fecha_inicio:null,fecha_fin:null,fecha_programada:null,agente_asignado:null,comentarios:"",responsable:null},aprobacion_final:{estado:"pendiente",fecha_inicio:null,fecha_fin:null,comentarios:"",responsable:null}},documentos_adjuntos:[],notas_admin:"",agente_campo_asignado:null,fecha_visita_programada:null,resultado_visita:null,fotos_establecimiento:[],verificacion_ubicacion:!1,calificacion_inicial:null,servicios_adicionales:{necesita_pagina_web:r.necesita_pagina_web,tipo_pagina_web:r.tipo_pagina_web,estado_servicio_web:r.necesita_pagina_web?"solicitado":"no_aplica",presupuesto_web_enviado:!1,fecha_inicio_desarrollo:null},ip_registro:window.location.hostname,user_agent:navigator.userAgent,referencia:"web_directa",tipo_registro:"sin_auth_proveedor",password_hash:btoa(U)},z=await ze(Q($,"solicitudes_proveedor"),V);await sa.createInAppNotification("admin","validacion","Nueva Solicitud de Proveedor",`${r.nombre_empresa} (${r.nombres_representante} ${r.apellidos_representante}) ha enviado una solicitud de registro`,{solicitudId:z.id,empresaNombre:r.nombre_empresa,representante:`${r.nombres_representante} ${r.apellidos_representante}`,email:r.email_empresa,necesitaWeb:r.necesita_pagina_web,tipoWeb:r.tipo_pagina_web,etapaActual:"revision_inicial",origen:"registro_proveedor"}),C(!0);const G=setInterval(()=>{k(Y=>Y<=1?(clearInterval(G),t("/"),0):Y-1)},1e3)}catch(M){console.error("Error creating provider request:",M),alert("Error al enviar la solicitud. Por favor, intenta nuevamente.")}finally{y(!1)}}};return h?a.createElement("div",{className:"text-center space-y-6"},a.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6"},a.createElement("div",{className:"text-6xl mb-4"},"🏪"),a.createElement("h2",{className:"text-2xl font-bold text-green-800 mb-2"},"¡Solicitud de proveedor enviada exitosamente!"),a.createElement("p",{className:"text-green-700 mb-4"},"Hemos recibido tu solicitud para unirte como proveedor en AV10 de Julio. Tu empresa será revisada en las próximas 48-72 horas."),a.createElement("div",{className:"bg-white border border-green-200 rounded-lg p-4 mb-4"},a.createElement("h3",{className:"font-semibold text-green-800 mb-2"},"¿Qué sigue ahora?"),a.createElement("div",{className:"text-sm text-green-700 text-left space-y-1"},a.createElement("p",null,"1. 📋 Revisaremos la información de tu empresa"),a.createElement("p",null,"2. 📞 Te contactaremos para validar datos y coordinar"),a.createElement("p",null,"3. 📍 Verificaremos la ubicación de tu establecimiento"),a.createElement("p",null,"4. 👥 Un agente de campo visitará tu negocio"),r.necesita_pagina_web&&a.createElement("p",null,"5. 💻 Te enviaremos el presupuesto para tu página web (",r.tipo_pagina_web,")"),a.createElement("p",null,r.necesita_pagina_web?"6":"5",". ✅ Una vez aprobado, activaremos tu cuenta de proveedor"))),r.necesita_pagina_web&&a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4"},a.createElement("h3",{className:"font-semibold text-blue-800 mb-2"},"Servicio de Página Web Solicitado"),a.createElement("p",{className:"text-sm text-blue-700"},"Has solicitado una ",a.createElement("strong",null,"página web ",r.tipo_pagina_web),". Nuestro equipo de desarrollo te contactará con un presupuesto detallado y cronograma.")),a.createElement("div",{className:"space-y-3"},a.createElement("p",{className:"text-sm text-green-600"},"📧 Te enviaremos actualizaciones a: ",a.createElement("strong",null,r.email_empresa)),a.createElement("p",{className:"text-sm text-green-600"},"📱 Y también al representante: ",a.createElement("strong",null,r.email_representante)),a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4"},a.createElement("p",{className:"text-blue-800 text-center"},"🔄 Serás redirigido al inicio en ",a.createElement("strong",null,T)," segundos...")),a.createElement("div",{className:"flex gap-3 justify-center"},a.createElement("button",{onClick:()=>t("/"),className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors"},"Ir al Inicio Ahora"),a.createElement("button",{onClick:()=>t("/registro-cliente"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors"},"Registrar Cliente"))))):a.createElement("div",{className:"max-w-4xl mx-auto"},a.createElement("div",{className:"mb-8 text-center"},a.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Registro de Proveedor - AV10 de Julio"),a.createElement("p",{className:"text-gray-600"},"Únete a la red de proveedores más grande del sector automotriz")),a.createElement("form",{onSubmit:e===5?R:L=>{L.preventDefault(),w()}},e===1&&a.createElement("div",{className:"space-y-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Información de la Empresa"),a.createElement("div",{className:"grid md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombre de la Empresa *"),a.createElement("input",{type:"text",name:"nombre_empresa",value:r.nombre_empresa,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${v.nombre_empresa?"border-red-500":"border-gray-300"}`,placeholder:"Ej: Repuestos Chile S.A."}),v.nombre_empresa&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.nombre_empresa)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"RUT de la Empresa *"),a.createElement("input",{type:"text",name:"rut_empresa",value:r.rut_empresa,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${v.rut_empresa?"border-red-500":"border-gray-300"}`,placeholder:"12.345.678-9"}),v.rut_empresa&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.rut_empresa)),a.createElement("div",{className:"md:col-span-2"},a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Dirección del Establecimiento *"),a.createElement("input",{type:"text",name:"direccion_empresa",value:r.direccion_empresa,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${v.direccion_empresa?"border-red-500":"border-gray-300"}`,placeholder:"Dirección completa donde los clientes pueden encontrarte"}),v.direccion_empresa&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.direccion_empresa)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Comuna *"),a.createElement("input",{type:"text",name:"comuna",value:r.comuna,onChange:N,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Comuna del establecimiento"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Región *"),a.createElement("select",{name:"region",value:r.region,onChange:N,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},_.map(L=>a.createElement("option",{key:L,value:L},L)))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono de la Empresa *"),a.createElement("input",{type:"tel",name:"telefono_empresa",value:r.telefono_empresa,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${v.telefono_empresa?"border-red-500":"border-gray-300"}`,placeholder:"+56 2 1234 5678"}),v.telefono_empresa&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.telefono_empresa)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email de la Empresa *"),a.createElement("input",{type:"email",name:"email_empresa",value:r.email_empresa,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${v.email_empresa?"border-red-500":"border-gray-300"}`,placeholder:"contacto@tuempresa.com"}),v.email_empresa&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.email_empresa)),a.createElement("div",{className:"md:col-span-2"},a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Página Web (Opcional)"),a.createElement("input",{type:"url",name:"web_actual",value:r.web_actual,onChange:N,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://www.tuempresa.com (si tienes una)"}),a.createElement("p",{className:"text-sm text-gray-500 mt-1"},"Si no tienes página web, ¡no te preocupes! Te ayudamos a crear una en los siguientes pasos.")))),e===2&&a.createElement("div",{className:"space-y-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Información del Representante"),a.createElement("div",{className:"grid md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombres del Representante *"),a.createElement("input",{type:"text",name:"nombres_representante",value:r.nombres_representante,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${v.nombres_representante?"border-red-500":"border-gray-300"}`,placeholder:"Nombres del propietario o gerente"}),v.nombres_representante&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.nombres_representante)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Apellidos del Representante *"),a.createElement("input",{type:"text",name:"apellidos_representante",value:r.apellidos_representante,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${v.apellidos_representante?"border-red-500":"border-gray-300"}`,placeholder:"Apellidos del propietario o gerente"}),v.apellidos_representante&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.apellidos_representante)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Cargo en la Empresa"),a.createElement("input",{type:"text",name:"cargo_representante",value:r.cargo_representante,onChange:N,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Propietario, Gerente General, etc."})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono Personal"),a.createElement("input",{type:"tel",name:"telefono_representante",value:r.telefono_representante,onChange:N,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"+56 9 1234 5678"})),a.createElement("div",{className:"md:col-span-2"},a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email Personal del Representante *"),a.createElement("input",{type:"email",name:"email_representante",value:r.email_representante,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${v.email_representante?"border-red-500":"border-gray-300"}`,placeholder:"tu.email@personal.com"}),v.email_representante&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.email_representante),a.createElement("p",{className:"text-sm text-gray-500 mt-1"},"Este email se usará para notificaciones importantes y comunicación directa contigo.")))),e===3&&a.createElement("div",{className:"space-y-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Información del Negocio"),a.createElement("div",{className:"space-y-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Descripción del Negocio *"),a.createElement("textarea",{name:"descripcion_negocio",value:r.descripcion_negocio,onChange:N,rows:4,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${v.descripcion_negocio?"border-red-500":"border-gray-300"}`,placeholder:"Describe qué servicios ofreces, tu especialidad y qué te hace único en el mercado..."}),v.descripcion_negocio&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.descripcion_negocio)),a.createElement("div",{className:"grid md:grid-cols-3 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Años de Funcionamiento *"),a.createElement("select",{name:"anos_funcionamiento",value:r.anos_funcionamiento,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${v.anos_funcionamiento?"border-red-500":"border-gray-300"}`},a.createElement("option",{value:""},"Selecciona"),a.createElement("option",{value:"menos_1"},"Menos de 1 año"),a.createElement("option",{value:"1_3"},"1-3 años"),a.createElement("option",{value:"3_5"},"3-5 años"),a.createElement("option",{value:"5_10"},"5-10 años"),a.createElement("option",{value:"mas_10"},"Más de 10 años")),v.anos_funcionamiento&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.anos_funcionamiento)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Número de Empleados"),a.createElement("select",{name:"numero_empleados",value:r.numero_empleados,onChange:N,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},a.createElement("option",{value:""},"Selecciona"),a.createElement("option",{value:"1"},"Solo yo"),a.createElement("option",{value:"2_5"},"2-5 empleados"),a.createElement("option",{value:"6_10"},"6-10 empleados"),a.createElement("option",{value:"11_20"},"11-20 empleados"),a.createElement("option",{value:"mas_20"},"Más de 20 empleados"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Horario de Atención *"),a.createElement("input",{type:"text",name:"horario_atencion",value:r.horario_atencion,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${v.horario_atencion?"border-red-500":"border-gray-300"}`,placeholder:"Ej: Lun-Vie 8:00-18:00"}),v.horario_atencion&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.horario_atencion))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-3"},"Categorías de Servicios que Ofreces *"),a.createElement("div",{className:"grid md:grid-cols-3 gap-3 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-4"},i.map(L=>a.createElement("label",{key:L,className:"flex items-center space-x-2"},a.createElement("input",{type:"checkbox",name:"categorias_servicios",value:L,checked:r.categorias_servicios.includes(L),onChange:N,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("span",{className:"text-sm text-gray-700"},L)))),v.categorias_servicios&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.categorias_servicios)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-3"},"Marcas de Vehículos que Atiendes *"),a.createElement("div",{className:"grid md:grid-cols-4 gap-3 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-4"},l.map(L=>a.createElement("label",{key:L,className:"flex items-center space-x-2"},a.createElement("input",{type:"checkbox",name:"marcas_vehiculos",value:L,checked:r.marcas_vehiculos.includes(L),onChange:N,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("span",{className:"text-sm text-gray-700"},L)))),v.marcas_vehiculos&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.marcas_vehiculos)))),e===4&&a.createElement("div",{className:"space-y-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"¿Necesitas una Página Web?"),a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6"},a.createElement("h3",{className:"font-semibold text-blue-900 mb-3"},"🌐 ¡Te ayudamos a tener presencia digital!"),a.createElement("p",{className:"text-blue-800 mb-4"},"Si no tienes página web o quieres mejorar la que tienes, ofrecemos servicios completos de desarrollo web especializados para empresas del sector automotriz."),a.createElement("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-blue-700"},a.createElement("div",null,a.createElement("p",null,"✅ Diseño profesional y moderno"),a.createElement("p",null,"✅ Optimizado para móviles"),a.createElement("p",null,"✅ Integración con redes sociales")),a.createElement("div",null,a.createElement("p",null,"✅ SEO para aparecer en Google"),a.createElement("p",null,"✅ Sistema de citas online"),a.createElement("p",null,"✅ Hosting y dominio incluidos")))),a.createElement("div",{className:"space-y-4"},a.createElement("div",{className:"flex items-center space-x-3"},a.createElement("input",{type:"checkbox",name:"necesita_pagina_web",checked:r.necesita_pagina_web,onChange:N,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("label",{className:"text-lg font-medium text-gray-700"},"Sí, quiero que me ayuden con una página web")),r.necesita_pagina_web&&a.createElement("div",{className:"space-y-4 ml-6"},a.createElement("h3",{className:"font-semibold text-gray-900 mb-4"},"Elige el plan que mejor se adapte a tu negocio:"),a.createElement("div",{className:"grid gap-6"},S.map(L=>a.createElement("div",{key:L.tipo,className:"border border-gray-200 rounded-lg p-6 hover:border-blue-300 transition-colors"},a.createElement("label",{className:"flex items-start space-x-3 cursor-pointer"},a.createElement("input",{type:"radio",name:"tipo_pagina_web",value:L.tipo,checked:r.tipo_pagina_web===L.tipo,onChange:N,className:"mt-1 text-blue-600 focus:ring-blue-500"}),a.createElement("div",{className:"flex-1"},a.createElement("div",{className:"flex justify-between items-start mb-2"},a.createElement("h4",{className:"text-lg font-semibold text-gray-900"},L.nombre),a.createElement("span",{className:"text-2xl font-bold text-blue-600"},L.precio)),a.createElement("p",{className:"text-gray-600 mb-3"},L.descripcion),a.createElement("div",{className:"grid md:grid-cols-2 gap-1"},L.incluye.map((M,F)=>a.createElement("p",{key:F,className:"text-sm text-gray-700"},"✓ ",M)))))))),v.tipo_pagina_web&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.tipo_pagina_web)),a.createElement("div",{className:"mt-8 space-y-4"},a.createElement("div",{className:"flex items-center space-x-3"},a.createElement("input",{type:"checkbox",name:"tiene_redes_sociales",checked:r.tiene_redes_sociales,onChange:N,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("label",{className:"text-lg font-medium text-gray-700"},"Tengo redes sociales para mi negocio")),r.tiene_redes_sociales&&a.createElement("div",{className:"ml-6 grid md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Facebook"),a.createElement("input",{type:"url",name:"redes_sociales.facebook",value:r.redes_sociales.facebook,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://facebook.com/tu-negocio"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Instagram"),a.createElement("input",{type:"url",name:"redes_sociales.instagram",value:r.redes_sociales.instagram,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://instagram.com/tu-negocio"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"WhatsApp Business"),a.createElement("input",{type:"tel",name:"redes_sociales.whatsapp",value:r.redes_sociales.whatsapp,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"+56 9 1234 5678"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"TikTok"),a.createElement("input",{type:"url",name:"redes_sociales.tiktok",value:r.redes_sociales.tiktok,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://tiktok.com/@tu-negocio"})))))),e===5&&a.createElement("div",{className:"space-y-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Credenciales y Confirmación"),a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},a.createElement("h3",{className:"font-semibold text-blue-900 mb-2"},"Configura tu contraseña"),a.createElement("p",{className:"text-sm text-blue-800"},"Esta contraseña se usará para crear tu cuenta de proveedor una vez que tu solicitud sea aprobada.")),a.createElement("div",{className:"grid md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña *"),a.createElement("input",{type:"password",name:"password",value:r.password,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${v.password?"border-red-500":"border-gray-300"}`,placeholder:"Mínimo 6 caracteres"}),v.password&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.password)),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirmar Contraseña *"),a.createElement("input",{type:"password",name:"confirm_password",value:r.confirm_password,onChange:N,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${v.confirm_password?"border-red-500":"border-gray-300"}`,placeholder:"Repite tu contraseña"}),v.confirm_password&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},v.confirm_password))),a.createElement("div",{className:"bg-gray-50 rounded-lg p-6"},a.createElement("h3",{className:"font-semibold text-lg mb-4"},"Resumen de tu solicitud:"),a.createElement("div",{className:"grid md:grid-cols-2 gap-4 text-sm"},a.createElement("div",null,a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Empresa:")," ",r.nombre_empresa),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"RUT:")," ",r.rut_empresa),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Representante:")," ",r.nombres_representante," ",r.apellidos_representante),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Email empresa:")," ",r.email_empresa),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Teléfono:")," ",r.telefono_empresa)),a.createElement("div",null,a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Dirección:")," ",r.direccion_empresa),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Comuna:")," ",r.comuna),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Región:")," ",r.region),a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Servicios:")," ",r.categorias_servicios.length," categorías"),r.necesita_pagina_web&&a.createElement("p",null,a.createElement("span",{className:"font-medium"},"Página web:")," ",r.tipo_pagina_web)))),a.createElement("div",{className:"space-y-4"},a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("input",{type:"checkbox",name:"acepta_terminos",checked:r.acepta_terminos,onChange:N,className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("label",{className:"text-sm text-gray-700"},"Acepto los ",a.createElement("a",{href:"/terminos",target:"_blank",className:"text-blue-600 hover:underline"},"términos y condiciones")," para proveedores de AV10 de Julio *")),v.acepta_terminos&&a.createElement("p",{className:"text-red-500 text-sm"},v.acepta_terminos),a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("input",{type:"checkbox",name:"acepta_notificaciones",checked:r.acepta_notificaciones,onChange:N,className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("label",{className:"text-sm text-gray-700"},"Acepto recibir notificaciones sobre nuevos clientes, promociones y novedades de la plataforma")),a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("input",{type:"checkbox",name:"acepta_visita_campo",checked:r.acepta_visita_campo,onChange:N,className:"mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("label",{className:"text-sm text-gray-700"},"Acepto que un agente de campo visite mi establecimiento para verificar la información (requerido para aprobar la solicitud)"))),a.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},a.createElement("h4",{className:"font-semibold text-green-900 mb-2"},"¿Qué sigue después?"),a.createElement("div",{className:"text-sm text-green-800 space-y-1"},a.createElement("p",null,"1. Recibirás un email de confirmación inmediatamente"),a.createElement("p",null,"2. Revisaremos tu solicitud en 48-72 horas"),a.createElement("p",null,"3. Te contactaremos para coordinar la visita de verificación"),a.createElement("p",null,"4. Un agente visitará tu establecimiento para validar la información"),r.necesita_pagina_web&&a.createElement("p",null,"5. Te enviaremos el presupuesto detallado para tu página web"),a.createElement("p",null,r.necesita_pagina_web?"6":"5",". Una vez aprobado, activaremos tu cuenta de proveedor")))),a.createElement("div",{className:"flex justify-between mt-8"},e>1&&a.createElement("button",{type:"button",onClick:A,className:"bg-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-400 transition-colors"},"← Anterior"),a.createElement("div",{className:"flex-1"}),a.createElement("div",{className:"flex-1 flex justify-center items-center"},a.createElement("div",{className:"flex space-x-2"},[1,2,3,4,5].map(L=>a.createElement("div",{key:L,className:`w-3 h-3 rounded-full ${L<=e?"bg-blue-600":"bg-gray-300"}`}))),a.createElement("span",{className:"ml-3 text-sm text-gray-600"},"Paso ",e," de 5")),a.createElement("div",{className:"flex-1 flex justify-end"},e<5?a.createElement("button",{type:"button",onClick:w,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors"},"Siguiente →"):a.createElement("button",{type:"submit",disabled:E,className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50"},E?"Enviando Solicitud...":"🏪 Enviar Solicitud de Proveedor")))))}function wN(){const{user:t}=Qe(),e=ft(),[n,r]=p.useState(null),[s,i]=p.useState(!0);return p.useEffect(()=>{(async()=>{if(!t){i(!1);return}try{const l=pe(Q($,"empresas"),fe("uid","==",t.uid)),c=await ue(l);if(!c.empty){r(c.docs[0].data()),i(!1);return}const u=pe(Q($,"solicitudes_proveedor"),fe("email_empresa","==",t.email)),d=await ue(u);if(!d.empty){const f=d.docs[0].data();r({...f,tipo:"solicitud_pendiente"})}}catch(l){console.error("Error checking existing profile:",l)}finally{i(!1)}})()},[t]),t?s?a.createElement("div",{className:"flex items-center justify-center min-h-screen"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.createElement("p",{className:"text-gray-600"},"Verificando información del proveedor..."))):n?n.tipo==="solicitud_pendiente"?a.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-8 px-4"},a.createElement("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-lg p-6 text-center"},a.createElement("div",{className:"text-6xl mb-4"},"⏳"),a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"Solicitud en Proceso"),a.createElement("p",{className:"text-gray-600 mb-4"},"Ya tienes una solicitud de proveedor en proceso de revisión. Te contactaremos pronto con el estado de tu solicitud."),a.createElement("div",{className:"space-y-2 text-sm text-gray-500"},a.createElement("p",null,"Estado: ",a.createElement("span",{className:"font-medium"},n.estado_general)),a.createElement("p",null,"Etapa: ",a.createElement("span",{className:"font-medium"},n.etapa_actual))),a.createElement("button",{onClick:()=>e("/"),className:"mt-4 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors"},"Volver al Inicio"))):a.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-8 px-4"},a.createElement("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-lg p-6 text-center"},a.createElement("div",{className:"text-6xl mb-4"},"✅"),a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-2"},"¡Ya eres un Proveedor!"),a.createElement("p",{className:"text-gray-600 mb-4"},"Tu empresa ",a.createElement("strong",null,n.nombre)," ya está registrada como proveedor en nuestra plataforma."),a.createElement("button",{onClick:()=>e("/dashboard/proveedor"),className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors"},"Ir al Dashboard"))):a.createElement("div",{className:"min-h-screen bg-gray-50 py-8 px-4"},a.createElement("div",{className:"container mx-auto"},a.createElement(xN,null))):a.createElement("div",{className:"min-h-screen bg-gray-50 py-8 px-4"},a.createElement("div",{className:"container mx-auto"},a.createElement(xN,null)))}function X7(){const t=ft(),[e,n]=p.useState({email:"",password:"",confirmarPassword:""}),[r,s]=p.useState(!1),[i,o]=p.useState(""),l=g=>{const{name:v,value:x}=g.target;n(E=>({...E,[v]:x}))},c=()=>!e.email||!e.password||!e.confirmarPassword?(o("Por favor, completa todos los campos"),!1):e.password!==e.confirmarPassword?(o("Las contraseñas no coinciden"),!1):e.password.length<6?(o("La contraseña debe tener al menos 6 caracteres"),!1):!0,u=async g=>{try{const v=pe(Q($,"agentes"),fe("email","==",g),fe("requiere_registro","==",!0)),x=await ue(v);if(!x.empty)return{tipo:"requiere_registro",id:x.docs[0].id,...x.docs[0].data()};const E=pe(Q($,"agentes"),fe("email","==",g),fe("requiere_registro","==",!1)),y=await ue(E);return y.empty?null:{tipo:"ya_registrado",id:y.docs[0].id,...y.docs[0].data()}}catch(v){return console.error("Error buscando agente:",v),null}},d=async(g,v)=>{try{await Me(we($,"agentes",g.id),{uid:v,requiere_registro:!1,fecha_activacion:new Date,password_temporal:null});const x=pe(Q($,"usuarios"),fe("email","==",g.email)),E=await ue(x);if(E.empty)await ze(Q($,"usuarios"),{uid:v,email:g.email,nombre:g.nombre,rol:"agente",activo:!0,fecha_registro:new Date});else{const y=E.docs[0];await Me(we($,"usuarios",y.id),{uid:v,estado:"activo",fecha_activacion:new Date})}}catch(x){throw console.error("Error activando agente:",x),x}},f=async g=>{if(g.preventDefault(),!!c()){s(!0),o("");try{const v=await u(e.email);if(!v){o(a.createElement("div",{className:"text-left"},a.createElement("p",{className:"font-semibold text-red-600 mb-2"},"Email no encontrado"),a.createElement("p",{className:"text-sm mb-3"},"Este email no está registrado como agente en el sistema."),a.createElement("p",{className:"text-sm text-gray-600"},"Contacta al administrador para que te agregue como agente."))),s(!1);return}if(v.tipo==="ya_registrado"){o(a.createElement("div",{className:"text-left"},a.createElement("p",{className:"font-semibold text-blue-600 mb-2"},"¡Ya tienes cuenta registrada!"),a.createElement("p",{className:"text-sm mb-3"},"Tu email ya está registrado en el sistema. Usa el login normal."),a.createElement("button",{onClick:()=>t("/login"),className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Ir al Login"))),s(!1);return}if(v.password_temporal!==e.password){o(a.createElement("div",{className:"text-left"},a.createElement("p",{className:"font-semibold text-red-600 mb-2"},"Contraseña incorrecta"),a.createElement("p",{className:"text-sm mb-3"},"La contraseña no coincide con la asignada por el administrador."),a.createElement("p",{className:"text-sm text-gray-600"},"Verifica las credenciales o contacta al administrador."))),s(!1);return}const x=await Pm(Fn,e.email,e.password);await d(v,x.user.uid),o(a.createElement("div",{className:"text-left"},a.createElement("p",{className:"font-semibold text-green-600 mb-2"},"¡Registro completado!"),a.createElement("p",{className:"text-sm"},"Redirigiendo a tu panel de agente..."))),setTimeout(()=>{t("/agente")},2e3)}catch(v){if(console.error("Error en registro:",v),v.code==="auth/email-already-in-use"){const x=await u(e.email);if(x&&x.tipo==="ya_registrado")o(a.createElement("div",{className:"text-left"},a.createElement("p",{className:"font-semibold text-blue-600 mb-2"},"Email ya registrado"),a.createElement("p",{className:"text-sm mb-3"},"Este email ya tiene una cuenta activa. Usa el login normal."),a.createElement("button",{onClick:()=>t("/login"),className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Ir al Login")));else try{await zk(Fn,e.email,e.password),o(a.createElement("div",{className:"text-left"},a.createElement("p",{className:"font-semibold text-green-600 mb-2"},"Iniciando sesión"),a.createElement("p",{className:"text-sm"},"Ya tenías cuenta creada. Redirigiendo..."))),setTimeout(()=>{t("/agente")},1500)}catch{o(a.createElement("div",{className:"text-left"},a.createElement("p",{className:"font-semibold text-red-600 mb-2"},"Email ya registrado"),a.createElement("p",{className:"text-sm mb-3"},"Este email ya tiene cuenta pero la contraseña no coincide."),a.createElement("button",{onClick:()=>t("/login"),className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700"},"Ir al Login")))}}else v.code==="auth/weak-password"?o("La contraseña debe tener al menos 6 caracteres"):o("Error en el registro: "+v.message)}finally{s(!1)}}};return a.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-100 via-white to-green-100 py-12 px-4"},a.createElement("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-8"},a.createElement("div",{className:"text-center mb-8"},a.createElement("h1",{className:"text-3xl font-bold text-gray-800 mb-2"},"Registro de Agente"),a.createElement("p",{className:"text-gray-600"},"Completa tu registro con las credenciales proporcionadas por el administrador")),a.createElement("form",{onSubmit:f,className:"space-y-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email (Usuario) *"),a.createElement("input",{type:"email",name:"email",value:e.email,onChange:l,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"tu.email@empresa.com",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Contraseña proporcionada por admin *"),a.createElement("input",{type:"password",name:"password",value:e.password,onChange:l,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Contraseña temporal",required:!0,minLength:6})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirmar contraseña *"),a.createElement("input",{type:"password",name:"confirmarPassword",value:e.confirmarPassword,onChange:l,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Confirma la contraseña",required:!0,minLength:6})),i&&a.createElement("div",{className:`p-4 rounded-lg text-sm ${typeof i=="string"&&(i.includes("exitosamente")||i.includes("Redirigiendo")||i.includes("Iniciando sesión"))||typeof i=="object"&&i.props&&i.props.children&&i.props.children.some(g=>g.props&&g.props.children&&(g.props.children.includes("completado")||g.props.children.includes("Iniciando sesión")))?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`},i),a.createElement("button",{type:"submit",disabled:r,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},r?a.createElement("div",{className:"flex items-center justify-center"},a.createElement("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Procesando..."):"Completar Registro")),a.createElement("div",{className:"mt-8 p-4 bg-blue-50 border border-blue-200 rounded-lg"},a.createElement("h3",{className:"font-medium text-blue-800 mb-2"},"📋 Instrucciones:"),a.createElement("ul",{className:"text-sm text-blue-700 space-y-1"},a.createElement("li",null,"• Usa el email y contraseña que te proporcionó el administrador"),a.createElement("li",null,"• Después del registro podrás acceder a tu panel de agente"),a.createElement("li",null,"• Desde tu panel podrás crear solicitudes de empresas"),a.createElement("li",null,"• Contacta al admin si tienes problemas con las credenciales")),a.createElement("div",{className:"mt-3 pt-3 border-t border-blue-200"},a.createElement("button",{onClick:()=>t("/ayuda-agentes"),className:"text-blue-600 hover:text-blue-800 underline text-sm"},"🆘 ¿Tienes problemas? Ver guía completa"))),a.createElement("div",{className:"mt-6 text-center"},a.createElement("p",{className:"text-sm text-gray-600"},"¿Ya tienes cuenta?"," ",a.createElement("button",{onClick:()=>t("/login"),className:"text-blue-600 hover:text-blue-800 underline"},"Iniciar sesión aquí")))))}function eB(){const[t,e]=p.useState({nombre_empresa:"",rut_empresa:"",direccion:"",telefono:"",email:"",sitio_web:"",nombre_representante:"",rut_representante:"",cargo_representante:"",telefono_representante:"",email_representante:"",categoria:"",marcas:[],descripcion_servicios:"",años_experiencia:"",numero_empleados:"",horario_atencion:"",logo_url:"",documento_constitucion:"",certificado_vigencia:"",autorizacion_sectorial:"",motivacion:"",beneficios_esperados:""}),[n,r]=p.useState([]),[s,i]=p.useState([]),[o,l]=p.useState(!1),[c,u]=p.useState(1),d=4;p.useEffect(()=>{f(),g()},[]);const f=async()=>{try{const N=(await ue(Q($,"categorias"))).docs.map(b=>({id:b.id,...b.data()}));r(N)}catch(S){console.error("Error cargando categorías:",S)}},g=async()=>{try{const N=(await ue(Q($,"marcas"))).docs.map(b=>({id:b.id,...b.data()}));i(N)}catch(S){console.error("Error cargando marcas:",S)}},v=S=>{const{name:N,value:b}=S.target;e(w=>({...w,[N]:b}))},x=S=>{e(N=>({...N,marcas:N.marcas.includes(S)?N.marcas.filter(b=>b!==S):[...N.marcas,S]}))},E=()=>{c<d&&u(c+1)},y=()=>{c>1&&u(c-1)},h=async S=>{S.preventDefault(),l(!0);try{const N={...t,estado_general:"pendiente_revision",tipo_solicitud:"comunidad",fecha_solicitud:new Date,fecha_actualizacion:new Date,etapas:{documentos:"pendiente",validacion_comercial:"pendiente",visita_campo:"pendiente",decision_final:"pendiente"},progreso_porcentaje:25,observaciones_admin:"",requiere_visita_campo:!0};await ze(Q($,"solicitudes_comunidad"),N),alert("¡Solicitud enviada exitosamente! Recibirá una respuesta en los próximos días hábiles."),e({nombre_empresa:"",rut_empresa:"",direccion:"",telefono:"",email:"",sitio_web:"",nombre_representante:"",rut_representante:"",cargo_representante:"",telefono_representante:"",email_representante:"",categoria:"",marcas:[],descripcion_servicios:"",años_experiencia:"",numero_empleados:"",horario_atencion:"",logo_url:"",documento_constitucion:"",certificado_vigencia:"",autorizacion_sectorial:"",motivacion:"",beneficios_esperados:""}),u(1)}catch(N){console.error("Error enviando solicitud:",N),alert("Error al enviar la solicitud. Intente nuevamente.")}finally{l(!1)}},C=()=>a.createElement("div",{className:"space-y-6"},a.createElement("h3",{className:"text-xl font-semibold text-gray-800 mb-4"},"Información de la Empresa"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombre de la Empresa *"),a.createElement("input",{type:"text",name:"nombre_empresa",value:t.nombre_empresa,onChange:v,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"RUT de la Empresa *"),a.createElement("input",{type:"text",name:"rut_empresa",value:t.rut_empresa,onChange:v,placeholder:"12.345.678-9",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",{className:"md:col-span-2"},a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Dirección *"),a.createElement("input",{type:"text",name:"direccion",value:t.direccion,onChange:v,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono *"),a.createElement("input",{type:"tel",name:"telefono",value:t.telefono,onChange:v,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email *"),a.createElement("input",{type:"email",name:"email",value:t.email,onChange:v,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",{className:"md:col-span-2"},a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Sitio Web"),a.createElement("input",{type:"url",name:"sitio_web",value:t.sitio_web,onChange:v,placeholder:"https://ejemplo.com",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})))),T=()=>a.createElement("div",{className:"space-y-6"},a.createElement("h3",{className:"text-xl font-semibold text-gray-800 mb-4"},"Representante Legal"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Nombre Completo *"),a.createElement("input",{type:"text",name:"nombre_representante",value:t.nombre_representante,onChange:v,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"RUT *"),a.createElement("input",{type:"text",name:"rut_representante",value:t.rut_representante,onChange:v,placeholder:"12.345.678-9",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Cargo *"),a.createElement("input",{type:"text",name:"cargo_representante",value:t.cargo_representante,onChange:v,placeholder:"Gerente General, Propietario, etc.",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Teléfono *"),a.createElement("input",{type:"tel",name:"telefono_representante",value:t.telefono_representante,onChange:v,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",{className:"md:col-span-2"},a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email *"),a.createElement("input",{type:"email",name:"email_representante",value:t.email_representante,onChange:v,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})))),k=()=>a.createElement("div",{className:"space-y-6"},a.createElement("h3",{className:"text-xl font-semibold text-gray-800 mb-4"},"Información del Negocio"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Categoría *"),a.createElement("select",{name:"categoria",value:t.categoria,onChange:v,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0},a.createElement("option",{value:""},"Seleccionar categoría"),n.map(S=>a.createElement("option",{key:S.id,value:S.nombre},S.nombre)))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Años de Experiencia *"),a.createElement("input",{type:"number",name:"años_experiencia",value:t.años_experiencia,onChange:v,min:"0",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Número de Empleados *"),a.createElement("select",{name:"numero_empleados",value:t.numero_empleados,onChange:v,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0},a.createElement("option",{value:""},"Seleccionar"),a.createElement("option",{value:"1-5"},"1-5 empleados"),a.createElement("option",{value:"6-10"},"6-10 empleados"),a.createElement("option",{value:"11-25"},"11-25 empleados"),a.createElement("option",{value:"26-50"},"26-50 empleados"),a.createElement("option",{value:"51+"},"Más de 50 empleados"))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Horario de Atención *"),a.createElement("input",{type:"text",name:"horario_atencion",value:t.horario_atencion,onChange:v,placeholder:"Lun-Vie 9:00-18:00",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",{className:"md:col-span-2"},a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Descripción de Servicios *"),a.createElement("textarea",{name:"descripcion_servicios",value:t.descripcion_servicios,onChange:v,rows:"4",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describa detalladamente los servicios que ofrece su empresa...",required:!0}))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-3"},"Marcas que Atiende *"),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3"},s.map(S=>a.createElement("label",{key:S.id,className:"flex items-center space-x-2 cursor-pointer"},a.createElement("input",{type:"checkbox",checked:t.marcas.includes(S.id),onChange:()=>x(S.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("span",{className:"text-sm text-gray-700"},S.nombre)))))),_=()=>a.createElement("div",{className:"space-y-6"},a.createElement("h3",{className:"text-xl font-semibold text-gray-800 mb-4"},"Documentación y Motivación"),a.createElement("div",{className:"grid grid-cols-1 gap-6"},a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"URL del Logo de la Empresa *"),a.createElement("input",{type:"url",name:"logo_url",value:t.logo_url,onChange:v,placeholder:"https://ejemplo.com/logo.png",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Documento de Constitución (URL) *"),a.createElement("input",{type:"url",name:"documento_constitucion",value:t.documento_constitucion,onChange:v,placeholder:"https://ejemplo.com/constitucion.pdf",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Certificado de Vigencia (URL) *"),a.createElement("input",{type:"url",name:"certificado_vigencia",value:t.certificado_vigencia,onChange:v,placeholder:"https://ejemplo.com/vigencia.pdf",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Autorización Sectorial (URL - si aplica)"),a.createElement("input",{type:"url",name:"autorizacion_sectorial",value:t.autorizacion_sectorial,onChange:v,placeholder:"https://ejemplo.com/autorizacion.pdf",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"¿Por qué quiere formar parte de nuestra comunidad? *"),a.createElement("textarea",{name:"motivacion",value:t.motivacion,onChange:v,rows:"4",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Explique su motivación para unirse a la comunidad AV10 de Julio...",required:!0})),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"¿Qué beneficios espera obtener? *"),a.createElement("textarea",{name:"beneficios_esperados",value:t.beneficios_esperados,onChange:v,rows:"3",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describa qué beneficios espera obtener al formar parte de la comunidad...",required:!0}))));return a.createElement("div",{className:"max-w-4xl mx-auto p-6 bg-white"},a.createElement("div",{className:"mb-8"},a.createElement("h2",{className:"text-3xl font-bold text-gray-800 mb-2"},"Solicitud para Unirse a la Comunidad AV10 de Julio"),a.createElement("p",{className:"text-gray-600"},"Complete este formulario para formar parte de nuestra red de empresas automotrices.")),a.createElement("div",{className:"mb-8"},a.createElement("div",{className:"flex items-center justify-between mb-2"},a.createElement("span",{className:"text-sm font-medium text-gray-700"},"Paso ",c," de ",d),a.createElement("span",{className:"text-sm font-medium text-gray-700"},Math.round(c/d*100),"% Completado")),a.createElement("div",{className:"w-full bg-gray-200 rounded-full h-2"},a.createElement("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${c/d*100}%`}}))),a.createElement("form",{onSubmit:h},c===1&&C(),c===2&&T(),c===3&&k(),c===4&&_(),a.createElement("div",{className:"flex justify-between mt-8 pt-6 border-t"},a.createElement("button",{type:"button",onClick:y,disabled:c===1,className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 disabled:opacity-50 disabled:cursor-not-allowed"},"Anterior"),c<d?a.createElement("button",{type:"button",onClick:E,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"},"Siguiente"):a.createElement("button",{type:"submit",disabled:o,className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 disabled:opacity-50"},o?"Enviando...":"Enviar Solicitud"))))}const BT=({empresa:t,size:e="md"})=>{const n=[],s={sm:{text:"text-xs",padding:"px-1.5 py-0.5",icon:"text-xs"},md:{text:"text-xs",padding:"px-2 py-1",icon:"text-sm"},lg:{text:"text-sm",padding:"px-3 py-1.5",icon:"text-base"}}[e],i=()=>{if(!t)return!1;const c=t.fechaRegistro||t.fechaCreacion,u=c&&new Date-(c.toDate?c.toDate():new Date(c))<2*365*24*60*60*1e3;return t.esPyme||u||t.numeroProductos&&t.numeroProductos<50},o=()=>{if(!t)return!1;const c=t.fechaRegistro||t.fechaCreacion,u=c&&new Date-(c.toDate?c.toDate():new Date(c))<6*30*24*60*60*1e3;return t.esEmprendimiento||u||t.numeroProductos&&t.numeroProductos<10},l=()=>t?t.esLocal||t.region&&t.region.toLowerCase().includes("metropolitana")||t.ciudad&&["santiago","providencia","las condes","vitacura"].includes(t.ciudad.toLowerCase()):!1;return o()?n.push({text:"🚀 Emprendimiento",bgColor:"bg-purple-100",textColor:"text-purple-800",borderColor:"border-purple-300"}):i()&&n.push({text:"⭐ PyME",bgColor:"bg-blue-100",textColor:"text-blue-800",borderColor:"border-blue-300"}),l()&&n.push({text:"📍 Local",bgColor:"bg-green-100",textColor:"text-green-800",borderColor:"border-green-300"}),t&&t.esNuevo&&n.push({text:"✨ Nuevo",bgColor:"bg-yellow-100",textColor:"text-yellow-800",borderColor:"border-yellow-300"}),t&&t.verificado&&n.push({text:"✓ Verificado",bgColor:"bg-emerald-100",textColor:"text-emerald-800",borderColor:"border-emerald-300"}),t&&t.esPremium&&n.push({text:"👑 Premium",bgColor:"bg-amber-100",textColor:"text-amber-800",borderColor:"border-amber-300"}),n.length===0?null:a.createElement("div",{className:"flex flex-wrap gap-1"},n.map((c,u)=>a.createElement("span",{key:u,className:`
            ${s.text} ${s.padding} 
            ${c.bgColor} ${c.textColor} ${c.borderColor}
            border rounded-full font-medium whitespace-nowrap
            inline-flex items-center gap-1
          `},c.text)))},qT=({proveedorId:t,showReviews:e=!0,compact:n=!1})=>{const[r,s]=p.useState({totalReviews:0,averageRating:0,ratingDistribution:{5:0,4:0,3:0,2:0,1:0}}),[i,o]=p.useState(!0);p.useEffect(()=>{l()},[t]);const l=async()=>{o(!0);try{const d=pe(Q($,"reseñas"),fe("proveedorId","==",t),fe("estado","==","aprobada")),g=(await ue(d)).docs.map(h=>h.data());if(g.length===0){s({totalReviews:0,averageRating:0,ratingDistribution:{5:0,4:0,3:0,2:0,1:0}});return}const v=g.length,E=g.reduce((h,C)=>h+C.puntaje,0)/v,y={5:0,4:0,3:0,2:0,1:0};g.forEach(h=>{y[h.puntaje]=(y[h.puntaje]||0)+1}),s({totalReviews:v,averageRating:E,ratingDistribution:y})}catch(d){console.error("Error fetching reputation stats:",d)}finally{o(!1)}},c=d=>d>=4.5?{label:"Excelente",color:"text-green-600",bgColor:"bg-green-100"}:d>=4?{label:"Muy Bueno",color:"text-blue-600",bgColor:"bg-blue-100"}:d>=3.5?{label:"Bueno",color:"text-yellow-600",bgColor:"bg-yellow-100"}:d>=3?{label:"Regular",color:"text-orange-600",bgColor:"bg-orange-100"}:{label:"Necesita Mejorar",color:"text-red-600",bgColor:"bg-red-100"};if(i)return a.createElement("div",{className:"flex justify-center py-4"},a.createElement("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}));const u=c(r.averageRating);return n?a.createElement("div",{className:"flex items-center gap-2"},a.createElement(Xg,{value:r.averageRating,readonly:!0,size:"sm",showValue:!1}),a.createElement("span",{className:"text-sm text-gray-600"},r.averageRating.toFixed(1)," (",r.totalReviews," reseñas)")):a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm"},a.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Reputación del Proveedor"),r.totalReviews===0?a.createElement("div",{className:"text-center py-8 text-gray-500"},a.createElement("p",null,"Este proveedor aún no tiene reseñas")):a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-4xl font-bold text-gray-900 mb-2"},r.averageRating.toFixed(1)),a.createElement(Xg,{value:r.averageRating,readonly:!0,size:"lg",showValue:!1}),a.createElement("div",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium mt-3 ${u.bgColor} ${u.color}`},u.label),a.createElement("div",{className:"text-sm text-gray-600 mt-2"},"Basado en ",r.totalReviews," reseña",r.totalReviews!==1?"s":"")),a.createElement("div",{className:"space-y-2"},[5,4,3,2,1].map(d=>{const f=r.ratingDistribution[d]||0,g=r.totalReviews>0?f/r.totalReviews*100:0;return a.createElement("div",{key:d,className:"flex items-center gap-2 text-sm"},a.createElement("span",{className:"w-8 text-right"},d,"★"),a.createElement("div",{className:"flex-1 bg-gray-200 rounded-full h-2"},a.createElement("div",{className:"bg-yellow-400 h-2 rounded-full transition-all duration-300",style:{width:`${g}%`}})),a.createElement("span",{className:"w-8 text-gray-600"},f))})))),e&&a.createElement("div",null,a.createElement("h4",{className:"text-lg font-semibold text-gray-900 mb-4"},"Reseñas de Clientes"),a.createElement(zT,{proveedorId:t,limitCount:5})))},tB=({onFiltersChange:t,initialFilters:e={},showRegionFilter:n=!0,showTypeFilter:r=!0,showVerificationFilter:s=!0})=>{const i=ft(),{user:o,rol:l}=Qe(),[c,u]=p.useState({region:"",ciudad:"",tipoProveedor:"",verificado:"",esLocal:!1,esPyme:!1,esEmprendimiento:!1,esPremium:!1,...e}),[d,f]=p.useState([]),[g,v]=p.useState([]),[x,E]=p.useState(!1),y=["Región de Arica y Parinacota","Región de Tarapacá","Región de Antofagasta","Región de Atacama","Región de Coquimbo","Región de Valparaíso","Región Metropolitana","Región del Libertador General Bernardo O'Higgins","Región del Maule","Región de Ñuble","Región del Biobío","Región de La Araucanía","Región de Los Ríos","Región de Los Lagos","Región Aysén del General Carlos Ibáñez del Campo","Región de Magallanes y de la Antártica Chilena"];p.useEffect(()=>{h()},[]),p.useEffect(()=>{t(c)},[c,t]);const h=async()=>{try{const S=(await ue(Q($,"empresas"))).docs.map(w=>w.data()),N=[...new Set(S.filter(w=>w.region).map(w=>w.region))].sort(),b=[...new Set(S.filter(w=>w.ciudad).map(w=>w.ciudad))].sort();f(N),v(b)}catch(_){console.error("Error fetching regiones y ciudades:",_),f(y)}},C=(_,S)=>{u(N=>({...N,[_]:S}))},T=()=>{u({region:"",ciudad:"",tipoProveedor:"",verificado:"",esLocal:!1,esPyme:!1,esEmprendimiento:!1,esPremium:!1})},k=Object.values(c).filter(_=>_&&_!==""&&_!==!1).length;return a.createElement("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm"},a.createElement("div",{className:"flex items-center justify-between mb-4"},a.createElement("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2"},"🔍 Filtros Avanzados",k>0&&a.createElement("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full"},k)),a.createElement("div",{className:"flex items-center gap-2"},o&&l==="admin"&&a.createElement("button",{onClick:()=>i("/admin/tipos-empresa"),className:"bg-blue-600 hover:bg-blue-700 text-white text-xs px-3 py-1 rounded-md flex items-center gap-1 transition-colors",title:"Gestionar tipos de empresa"},"🏢 Tipos de Empresa"),k>0&&a.createElement("button",{onClick:T,className:"text-sm text-red-600 hover:text-red-800 underline"},"Limpiar filtros"),a.createElement("button",{onClick:()=>E(!x),className:"text-sm text-blue-600 hover:text-blue-800 underline"},x?"Ocultar":"Mostrar"," filtros"))),x&&a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},n&&a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Región"),a.createElement("select",{value:c.region,onChange:_=>C("region",_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"},a.createElement("option",{value:""},"Todas las regiones"),d.map(_=>a.createElement("option",{key:_,value:_},_)))),a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Ciudad"),a.createElement("select",{value:c.ciudad,onChange:_=>C("ciudad",_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"},a.createElement("option",{value:""},"Todas las ciudades"),g.map(_=>a.createElement("option",{key:_,value:_},_)))),r&&a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Tipo de Proveedor"),a.createElement("select",{value:c.tipoProveedor,onChange:_=>C("tipoProveedor",_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"},a.createElement("option",{value:""},"Todos los tipos"),a.createElement("option",{value:"emprendimiento"},"🚀 Emprendimientos"),a.createElement("option",{value:"pyme"},"⭐ PyMEs"),a.createElement("option",{value:"empresa"},"🏢 Empresas"),a.createElement("option",{value:"local"},"📍 Locales"))),s&&a.createElement("div",null,a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Estado"),a.createElement("select",{value:c.verificado,onChange:_=>C("verificado",_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"},a.createElement("option",{value:""},"Todos los estados"),a.createElement("option",{value:"verificado"},"✓ Verificados"),a.createElement("option",{value:"premium"},"👑 Premium"),a.createElement("option",{value:"nuevo"},"✨ Nuevos"))),a.createElement("div",{className:"col-span-full"},a.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Características Especiales"),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3"},a.createElement("label",{className:"flex items-center gap-2"},a.createElement("input",{type:"checkbox",checked:c.esLocal,onChange:_=>C("esLocal",_.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("span",{className:"text-sm"},"📍 Proveedor Local")),a.createElement("label",{className:"flex items-center gap-2"},a.createElement("input",{type:"checkbox",checked:c.esPyme,onChange:_=>C("esPyme",_.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("span",{className:"text-sm"},"⭐ PyME")),a.createElement("label",{className:"flex items-center gap-2"},a.createElement("input",{type:"checkbox",checked:c.esEmprendimiento,onChange:_=>C("esEmprendimiento",_.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("span",{className:"text-sm"},"🚀 Emprendimiento")),a.createElement("label",{className:"flex items-center gap-2"},a.createElement("input",{type:"checkbox",checked:c.esPremium,onChange:_=>C("esPremium",_.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.createElement("span",{className:"text-sm"},"👑 Premium"))))),k>0&&a.createElement("div",{className:"mt-4 pt-4 border-t border-gray-200"},a.createElement("div",{className:"flex flex-wrap gap-2"},a.createElement("span",{className:"text-sm text-gray-600"},"Filtros activos:"),c.region&&a.createElement("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded"},"📍 ",c.region),c.ciudad&&a.createElement("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded"},"🏙️ ",c.ciudad),c.tipoProveedor&&a.createElement("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded"},c.tipoProveedor==="emprendimiento"&&"🚀 Emprendimientos",c.tipoProveedor==="pyme"&&"⭐ PyMEs",c.tipoProveedor==="empresa"&&"🏢 Empresas",c.tipoProveedor==="local"&&"📍 Locales"),c.verificado&&a.createElement("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded"},c.verificado==="verificado"&&"✓ Verificados",c.verificado==="premium"&&"👑 Premium",c.verificado==="nuevo"&&"✨ Nuevos"),(c.esLocal||c.esPyme||c.esEmprendimiento||c.esPremium)&&a.createElement("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded"},"Características especiales"))))},nB=()=>{const t=ft(),[e,n]=p.useState([]),[r,s]=p.useState([]),[i,o]=p.useState(!0),[l,c]=p.useState({}),[u,d]=p.useState("nombre");p.useEffect(()=>{f()},[]),p.useEffect(()=>{g()},[e,l,u]);const f=async()=>{o(!0);try{const E=pe(Q($,"empresas"),fe("estado","==","Activa"),Et("nombre")),h=(await ue(E)).docs.map(C=>({id:C.id,...C.data()}));n(h)}catch(E){console.error("Error fetching providers:",E)}finally{o(!1)}},g=()=>{let E=[...e];l.search&&(E=E.filter(y=>{var h,C;return((h=y.nombre)==null?void 0:h.toLowerCase().includes(l.search.toLowerCase()))||((C=y.descripcion)==null?void 0:C.toLowerCase().includes(l.search.toLowerCase()))})),E.sort((y,h)=>{switch(u){case"nombre":return y.nombre.localeCompare(h.nombre);case"fecha":const C=new Date(y.fechaRegistro||y.createdAt||0);return new Date(h.fechaRegistro||h.createdAt||0)-C;default:return 0}}),s(E)},x=(()=>({total:r.length,premium:r.filter(E=>E.esPremium).length}))();return i?a.createElement("div",{className:"min-h-screen bg-gray-50"},a.createElement(Bg,null),a.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},a.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}))):a.createElement("div",{className:"min-h-screen bg-gray-50"},a.createElement(Bg,null),a.createElement("div",{className:"max-w-7xl mx-auto px-4 py-8"},a.createElement("div",{className:"bg-gradient-to-r from-blue-600 via-blue-700 to-blue-800 rounded-2xl text-white p-8 mb-8"},a.createElement("div",{className:"max-w-4xl mx-auto text-center"},a.createElement("div",{className:"mb-6"},a.createElement("span",{className:"bg-yellow-400 text-blue-900 px-4 py-2 rounded-full text-sm font-bold"},"¡COMUNIDAD ACTIVA!")),a.createElement("h1",{className:"text-4xl md:text-5xl font-bold mb-4"},"📋 ",e.length,"+ Proveedores Automotrices"),a.createElement("p",{className:"text-xl md:text-2xl text-blue-100 mb-6"},"Descubre mas de ",a.createElement("strong",{className:"text-yellow-400"},e.length," proveedores verificados")," que forman parte de nuestra comunidad: vulcanizaciones, talleres mecanicos, centros de pintura, venta de repuestos y servicios especializados."),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8"},a.createElement("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4"},a.createElement("div",{className:"text-3xl font-bold text-yellow-400"},x.total),a.createElement("div",{className:"text-sm text-blue-200"},"Proveedores Totales")),a.createElement("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4"},a.createElement("div",{className:"text-3xl font-bold text-yellow-400"},Math.floor(x.total*.7)),a.createElement("div",{className:"text-sm text-blue-200"},"Locales Establecidos")),a.createElement("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4"},a.createElement("div",{className:"text-3xl font-bold text-yellow-400"},Math.floor(x.total*.4)),a.createElement("div",{className:"text-sm text-blue-200"},"PyMEs Activas")),a.createElement("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4"},a.createElement("div",{className:"text-3xl font-bold text-yellow-400"},Math.floor(x.total*.2)),a.createElement("div",{className:"text-sm text-blue-200"},"Emprendimientos"))),a.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},a.createElement("button",{onClick:()=>t("/proveedores"),className:"bg-white text-blue-700 px-8 py-3 rounded-lg font-semibold hover:bg-blue-50 transition-colors shadow-lg"},"🔍 Explorar Catálogo"),a.createElement("button",{onClick:()=>t("/proveedores-locales"),className:"bg-blue-400 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-300 transition-colors shadow-lg"},"🏪 Ver Empresas"),a.createElement("button",{onClick:()=>t("/login?tipo=cliente"),className:"bg-yellow-400 text-blue-900 px-8 py-3 rounded-lg font-semibold hover:bg-yellow-300 transition-colors shadow-lg"},"👤 Área Cliente"),a.createElement("button",{onClick:()=>t("/login?tipo=empresa"),className:"bg-green-400 text-white px-8 py-3 rounded-lg font-semibold hover:bg-green-300 transition-colors shadow-lg"},"🏢 Área Empresa"),a.createElement("button",{onClick:()=>t("/registro-cliente"),className:"border-2 border-white text-white px-8 py-3 rounded-lg font-semibold hover:bg-white hover:text-blue-700 transition-colors"},"➕ ",a.createElement("span",null,"Registrarse")))),a.createElement("div",{className:"relative"},a.createElement("div",{className:"relative z-10 bg-white/10 backdrop-blur-sm rounded-2xl p-8 border border-white/20"},a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"text-center"},a.createElement("h3",{className:"text-2xl font-bold text-white mb-4"},"🎯 Encuentra lo que Buscas"),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center"},a.createElement("div",{className:"bg-white/10 rounded-lg p-3"},a.createElement("div",{className:"text-2xl mb-1"},"🔧"),a.createElement("div",{className:"text-sm"},"Talleres")),a.createElement("div",{className:"bg-white/10 rounded-lg p-3"},a.createElement("div",{className:"text-2xl mb-1"},"🏁"),a.createElement("div",{className:"text-sm"},"Vulcanización")),a.createElement("div",{className:"bg-white/10 rounded-lg p-3"},a.createElement("div",{className:"text-2xl mb-1"},"🎨"),a.createElement("div",{className:"text-sm"},"Pintura")),a.createElement("div",{className:"bg-white/10 rounded-lg p-3"},a.createElement("div",{className:"text-2xl mb-1"},"⚙️"),a.createElement("div",{className:"text-sm"},"Repuestos")))))))),a.createElement("div",{className:"bg-white rounded-xl shadow-sm p-8 mb-8"},a.createElement("div",{className:"max-w-4xl mx-auto"},a.createElement("h2",{className:"text-3xl font-bold text-gray-900 text-center mb-6"},"💎 Beneficios de Formar Parte de Nuestra Comunidad"),a.createElement("div",{className:"grid md:grid-cols-3 gap-6 mb-8"},a.createElement("div",{className:"text-center p-6 bg-blue-50 rounded-xl"},a.createElement("div",{className:"bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4"},a.createElement("span",{className:"text-2xl"},"👥")),a.createElement("h3",{className:"font-semibold text-lg mb-2"},"Acceso a Clientes"),a.createElement("p",{className:"text-gray-600"},"Conecta con cientos de duenos de vehiculos que buscan servicios confiables en tu area.")),a.createElement("div",{className:"text-center p-6 bg-green-50 rounded-xl"},a.createElement("div",{className:"bg-green-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4"},a.createElement("span",{className:"text-2xl"},"📱")),a.createElement("h3",{className:"font-semibold text-lg mb-2"},"Presencia Digital"),a.createElement("p",{className:"text-gray-600"},"Tu negocio aparecera en nuestra plataforma donde miles de usuarios buscan servicios automotrices.")),a.createElement("div",{className:"text-center p-6 bg-purple-50 rounded-xl"},a.createElement("div",{className:"bg-purple-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4"},a.createElement("span",{className:"text-2xl"},"🚀")),a.createElement("h3",{className:"font-semibold text-lg mb-2"},"Herramientas Gratuitas"),a.createElement("p",{className:"text-gray-600"},"Gestion de campanas, analisis de mercado y herramientas de promocion sin costo adicional."))),a.createElement("div",{className:"text-center"},a.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},a.createElement("button",{onClick:()=>t("/registro-pyme"),className:"bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors shadow-lg"},"🚀 Unirse a la Comunidad"),a.createElement("button",{onClick:()=>t("/contacto"),className:"border-2 border-blue-600 text-blue-600 px-8 py-3 rounded-lg font-semibold hover:bg-blue-50 transition-colors"},"💬 Más Información"))))),a.createElement("div",{className:"bg-gradient-to-r from-orange-50 to-yellow-50 border border-orange-200 rounded-xl p-6 mb-8"},a.createElement("div",{className:"max-w-4xl mx-auto text-center"},a.createElement("div",{className:"flex items-center justify-center mb-4"},a.createElement("span",{className:"text-3xl mr-3"},"📊"),a.createElement("h2",{className:"text-2xl font-bold text-orange-800"},"Estado Actual de la Comunidad")),a.createElement("p",{className:"text-lg text-orange-700 mb-6"},"Actualmente tenemos ",a.createElement("strong",{className:"text-orange-800"},e.length," proveedores registrados"),"y estan ",a.createElement("strong",null,"verificados y activos")," en la plataforma. Todos ellos pueden solicitar formar parte de promociones y beneficios especiales."),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},a.createElement("div",{className:"bg-white rounded-lg p-4 border border-orange-200"},a.createElement("strong",null,"✅ Verificados:")," Información validada"),a.createElement("div",{className:"bg-white rounded-lg p-4 border border-orange-200"},a.createElement("strong",null,"🎯 Activos:")," Reciben consultas diariamente"),a.createElement("div",{className:"bg-white rounded-lg p-4 border border-orange-200"},a.createElement("strong",null,"💎 Premium:")," Acceso a beneficios especiales")))),a.createElement("div",{className:"mb-6",id:"proveedores-grid"},a.createElement(tB,{onFiltersChange:c,totalResults:r.length})),a.createElement("div",{className:"mb-6 flex items-center justify-between"},a.createElement("div",{className:"text-sm text-gray-600"},"Mostrando ",r.length," de ",e.length," proveedores"),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("label",{className:"text-sm text-gray-600"},"Ordenar por:"),a.createElement("select",{value:u,onChange:E=>d(E.target.value),className:"border border-gray-300 rounded px-3 py-1 text-sm"},a.createElement("option",{value:"nombre"},"Nombre A-Z"),a.createElement("option",{value:"fecha"},"Mas recientes")))),r.length===0?a.createElement("div",{className:"text-center py-12"},a.createElement("div",{className:"text-gray-500 text-lg mb-4"},"🔍 No se encontraron proveedores con los filtros aplicados"),a.createElement("button",{onClick:()=>c({}),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors"},"Limpiar Filtros")):a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},r.map(E=>a.createElement("div",{key:E.id,className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow"},a.createElement("div",{className:"p-4 border-b border-gray-100"},a.createElement("div",{className:"flex items-start gap-3"},a.createElement("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0"},a.createElement("span",{className:"text-blue-600 font-bold text-lg"},E.nombre?E.nombre.charAt(0).toUpperCase():"?")),a.createElement("div",{className:"flex-1 min-w-0"},a.createElement("h3",{className:"font-semibold text-gray-900 text-lg truncate"},E.nombre||"Sin nombre"),a.createElement("div",{className:"mt-1"},a.createElement(BT,{provider:E,compact:!0}))))),a.createElement("div",{className:"p-4"},a.createElement("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2"},E.descripcion||"Proveedor de servicios automotrices"),E.categorias&&E.categorias.length>0&&a.createElement("div",{className:"mb-4"},a.createElement("div",{className:"flex flex-wrap gap-1"},E.categorias.slice(0,3).map((y,h)=>a.createElement("span",{key:h,className:"bg-blue-50 text-blue-700 text-xs px-2 py-1 rounded-full"},y)),E.categorias.length>3&&a.createElement("span",{className:"bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded-full"},"+",E.categorias.length-3," mas"))),a.createElement("div",{className:"mb-4"},a.createElement(qT,{proveedorId:E.id,compact:!0,showReviews:!1}))),a.createElement("div",{className:"p-4 bg-gray-50 border-t border-gray-100"},a.createElement("div",{className:"flex gap-2"},a.createElement("button",{onClick:()=>t("/proveedor/"+E.id),className:"flex-1 bg-blue-600 text-white text-sm py-2 px-3 rounded hover:bg-blue-700 transition-colors"},"Ver Perfil"),E.web&&a.createElement("a",{href:E.web,target:"_blank",rel:"noopener noreferrer",className:"bg-gray-200 text-gray-700 text-sm py-2 px-3 rounded hover:bg-gray-300 transition-colors"},"🌐 Web")))))),a.createElement("div",{className:"mt-12 bg-gradient-to-r from-blue-600 via-blue-700 to-blue-800 rounded-2xl text-white p-8"},a.createElement("div",{className:"max-w-4xl mx-auto text-center"},a.createElement("h3",{className:"text-3xl font-bold mb-4"},"🚀 ¿Tienes un Nuevo Negocio Automotriz?"),a.createElement("p",{className:"text-lg text-blue-100 mb-6"},"Si aun no estas en nuestro catastro, ",a.createElement("strong",null,"registrate ahora")," para formar parte de la mayor red de proveedores automotrices de la Av. 10 de Julio."),a.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},a.createElement("button",{onClick:()=>t("/registro-pyme"),className:"bg-white text-blue-700 px-8 py-3 rounded-lg font-semibold hover:bg-blue-50 transition-colors shadow-lg"},"📝 Registrar Mi Negocio"),a.createElement("button",{onClick:()=>t("/login?tipo=cliente"),className:"bg-blue-400 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-300 transition-colors shadow-lg"},"🔑 Acceso Clientes"),a.createElement("button",{onClick:()=>t("/contacto"),className:"bg-blue-500 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-400 transition-colors border-2 border-blue-400"},"💬 Hablar con Asesor"))))))},rB=()=>{var x;const t=ft(),[e,n]=p.useState([]),[r,s]=p.useState([]),[i,o]=p.useState(!0),[l,c]=p.useState("todos"),u=[{id:"vulcanizaciones",nombre:"Vulcanizaciones",icono:"🏁",descripcion:"Reparación de neumáticos, balanceo, alineación",servicios:["Reparación de neumáticos","Balanceo","Alineación","Venta de neumáticos"],ejemplos:["Vulcanización Express","Neumáticos 24/7","Centro de Llantas"],color:"bg-blue-50 border-blue-200 text-blue-800"},{id:"mecanica",nombre:"Talleres Mecánicos",icono:"🔧",descripcion:"Talleres de reparación mecánica y mantención",servicios:["Mantención preventiva","Reparaciones motor","Sistema eléctrico","Frenos"],ejemplos:["Taller Don Juan","Mecánica Rápida","Auto Service"],color:"bg-green-50 border-green-200 text-green-800"},{id:"lavado",nombre:"Lavado de Autos",icono:"🚿",descripcion:"Lavado, encerado y detailing automotriz",servicios:["Lavado completo","Encerado","Detailing","Limpieza interior"],ejemplos:["Car Wash Express","Lavado Premium","Detailing Pro"],color:"bg-cyan-50 border-cyan-200 text-cyan-800"},{id:"electricidad",nombre:"Electricidad Automotriz",icono:"⚡",descripcion:"Especialistas en sistemas eléctricos",servicios:["Diagnóstico computarizado","Aire acondicionado","Alarmas","Audio"],ejemplos:["Electro Auto","Diagnóstico Express","Audio Car"],color:"bg-yellow-50 border-yellow-200 text-yellow-800"},{id:"pintura",nombre:"Pintura y Carrocería",icono:"🎨",descripcion:"Pintura automotriz y trabajos de carrocería",servicios:["Pintura completa","Retoque","Pulido","Desabolladura"],ejemplos:["Pintura Express","Carrocería Total","Retoque Pro"],color:"bg-purple-50 border-purple-200 text-purple-800"},{id:"lubricentros",nombre:"Lubricentros",icono:"🛢️",descripción:"Cambio de aceite y lubricación",servicios:["Cambio de aceite","Filtros","Lubricación","Revisión básica"],ejemplos:["Lubri Express","Quick Oil","Centro Lubricación"],color:"bg-orange-50 border-orange-200 text-orange-800"},{id:"accesorios",nombre:"Accesorios",icono:"✨",descripcion:"Instalación de accesorios y personalización",servicios:["Insulfilm","Fundas","Cromados","Tuning básico"],ejemplos:["Accesorios Pro","Tuning Express","Auto Style"],color:"bg-pink-50 border-pink-200 text-pink-800"},{id:"gruas",nombre:"Grúas y Auxilio",icono:"🚛",descripción:"Servicios de grúa y rescate vehicular",servicios:["Grúa 24/7","Auxilio mecánico","Remolque","Rescate"],ejemplos:["Grúa Express","Auxilio 24h","Rescate Rápido"],color:"bg-red-50 border-red-200 text-red-800"}];p.useEffect(()=>{d()},[]),p.useEffect(()=>{g()},[e,l]);const d=async()=>{o(!0);try{const E=pe(Q($,"empresas"),fe("estado","==","Activa"),Et("nombre")),C=(await ue(E)).docs.map(T=>({id:T.id,...T.data()})).filter(T=>f(T));n(C)}catch(E){console.error("Error fetching providers:",E)}finally{o(!1)}},f=E=>{const y=E.fechaRegistro||E.fechaCreacion,h=y&&new Date-(y.toDate?y.toDate():new Date(y))<3*365*24*60*60*1e3;return E.esPyme||E.esEmprendimiento||h||E.numeroProductos&&E.numeroProductos<100||E.empleados&&E.empleados<20||u.some(C=>{var T;return((T=E.categorias)==null?void 0:T.some(k=>C.servicios.some(_=>k.toLowerCase().includes(_.toLowerCase())||_.toLowerCase().includes(k.toLowerCase()))))||E.nombre.toLowerCase().includes(C.nombre.toLowerCase())})},g=()=>{let E=[...e];if(l!=="todos"){const y=u.find(h=>h.id===l);y&&(E=E.filter(h=>[y.nombre,...y.servicios,y.descripcion.toLowerCase()].some(T=>{var k,_,S;return((k=h.categorias)==null?void 0:k.some(N=>N.toLowerCase().includes(T.toLowerCase())))||((_=h.servicios)==null?void 0:_.some(N=>N.toLowerCase().includes(T.toLowerCase())))||((S=h.descripcion)==null?void 0:S.toLowerCase().includes(T.toLowerCase()))||h.nombre.toLowerCase().includes(T.toLowerCase())})))}s(E)},v=E=>E?(E.toDate?E.toDate():new Date(E)).toLocaleDateString():"";return i?a.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},a.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})):a.createElement("div",{className:"min-h-screen bg-gray-50"},a.createElement("div",{className:"max-w-7xl mx-auto px-4 py-8"},a.createElement("div",{className:"bg-gradient-to-r from-green-600 via-blue-600 to-purple-600 rounded-2xl text-white p-8 mb-8"},a.createElement("div",{className:"max-w-4xl mx-auto text-center"},a.createElement("div",{className:"mb-6"},a.createElement("span",{className:"bg-yellow-400 text-blue-900 px-4 py-2 rounded-full text-sm font-bold"},"¡PARA PyMEs y EMPRENDEDORES!")),a.createElement("h1",{className:"text-4xl md:text-5xl font-bold mb-4"},"🏪 ",e.length,"+ PyMEs y Emprendimientos Locales"),a.createElement("p",{className:"text-xl md:text-2xl text-blue-100 mb-6"},"Vulcanizadoras, talleres mecánicos, lavado de autos y más servicios de barrio"),a.createElement("p",{className:"text-lg text-blue-200 max-w-3xl mx-auto mb-8"},"Conecta con ",a.createElement("strong",{className:"text-yellow-400"},"emprendedores locales")," que ofrecen servicios automotrices de calidad en tu sector. Muchos de ellos están comenzando su transformación digital y necesitan tu apoyo."),a.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},a.createElement("button",{onClick:()=>t("/registro-pyme"),className:"bg-yellow-400 text-blue-900 px-8 py-3 rounded-lg font-semibold hover:bg-yellow-500 transition-colors shadow-lg"},"🚀 Registrar Mi PyME"),a.createElement("button",{onClick:()=>t("/login?tipo=empresa"),className:"bg-white text-blue-700 px-8 py-3 rounded-lg font-semibold hover:bg-blue-50 transition-colors shadow-lg"},"🏢 Acceso Empresas"),a.createElement("button",{onClick:()=>{const E=document.getElementById("sectores-pymes");E==null||E.scrollIntoView({behavior:"smooth"})},className:"bg-white/20 text-white px-8 py-3 rounded-lg font-semibold hover:bg-white/30 transition-colors border-2 border-white/30"},"🔍 Explorar PyMEs")))),a.createElement("div",{className:"bg-white rounded-xl shadow-sm p-8 mb-8"},a.createElement("div",{className:"max-w-4xl mx-auto"},a.createElement("h2",{className:"text-3xl font-bold text-gray-900 text-center mb-6"},"🎁 Programa Especial para PyMEs y Emprendimientos"),a.createElement("div",{className:"grid md:grid-cols-2 gap-8"},a.createElement("div",{className:"space-y-4"},a.createElement("div",{className:"flex items-start gap-3"},a.createElement("div",{className:"bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"✓"),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"Ayuda para Crear Tu Página Web"),a.createElement("p",{className:"text-gray-600"},"Te ayudamos a crear tu presencia digital sin costo adicional. Perfil completo con fotos y servicios."))),a.createElement("div",{className:"flex items-start gap-3"},a.createElement("div",{className:"bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"✓"),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"1 Campaña Semanal Gratis"),a.createElement("p",{className:"text-gray-600"},"Promociona tus servicios con una campaña publicitaria semanal gratuita para destacar entre la competencia."))),a.createElement("div",{className:"flex items-start gap-3"},a.createElement("div",{className:"bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"✓"),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"Ingreso de Productos Sin Límite"),a.createElement("p",{className:"text-gray-600"},"Agrega todos tus productos y servicios con fotos, precios y descripciones detalladas."))),a.createElement("div",{className:"flex items-start gap-3"},a.createElement("div",{className:"bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"✓"),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"Asesoría Digital Personalizada"),a.createElement("p",{className:"text-gray-600"},"Sesiones gratuitas para ayudarte a maximizar tu presencia online y atraer más clientes.")))),a.createElement("div",{className:"space-y-4"},a.createElement("div",{className:"flex items-start gap-3"},a.createElement("div",{className:"bg-blue-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"⭐"),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"Acceso Directo a Clientes Locales"),a.createElement("p",{className:"text-gray-600"},"Conecta con vecinos y clientes de tu sector que buscan servicios confiables y cercanos."))),a.createElement("div",{className:"flex items-start gap-3"},a.createElement("div",{className:"bg-blue-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"⭐"),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"Herramientas de Gestión Simples"),a.createElement("p",{className:"text-gray-600"},"Dashboard fácil de usar para gestionar citas, clientes y ventas desde tu celular."))),a.createElement("div",{className:"flex items-start gap-3"},a.createElement("div",{className:"bg-blue-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"⭐"),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"Red de Colaboración Local"),a.createElement("p",{className:"text-gray-600"},"Conecta con otros emprendedores de tu sector para colaborar y referir clientes."))),a.createElement("div",{className:"flex items-start gap-3"},a.createElement("div",{className:"bg-blue-500 text-white w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1"},"⭐"),a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},"Soporte Técnico en Español"),a.createElement("p",{className:"text-gray-600"},"Equipo de soporte local que entiende las necesidades de los emprendedores chilenos."))))),a.createElement("div",{className:"text-center mt-8"},a.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},a.createElement("button",{onClick:()=>t("/registro-pyme"),className:"bg-gradient-to-r from-green-600 to-blue-600 text-white px-10 py-4 rounded-xl font-semibold text-lg hover:from-green-700 hover:to-blue-700 transition-all transform hover:scale-105 shadow-lg"},"🚀 Comenzar Mi Transformación Digital"),a.createElement("button",{onClick:()=>t("/login?tipo=empresa"),className:"bg-white text-green-600 px-10 py-4 rounded-xl font-semibold text-lg hover:bg-green-50 transition-all border-2 border-green-600 shadow-lg"},"🏢 Ya Tengo Cuenta - Ingresar"))))),a.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-8",id:"sectores-pymes"},a.createElement("h3",{className:"text-2xl font-bold text-gray-900 mb-6 text-center"},"🔍 Explora PyMEs por Sector"),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-3"},a.createElement("button",{onClick:()=>c("todos"),className:`p-3 rounded-lg border-2 text-center transition-colors ${l==="todos"?"bg-blue-600 text-white border-blue-600":"bg-gray-50 border-gray-200 text-gray-700 hover:border-blue-300 hover:bg-blue-50"}`},a.createElement("div",{className:"text-lg mb-1"},"🏪"),a.createElement("div",{className:"text-xs font-medium"},"Todos")),u.map(E=>a.createElement("button",{key:E.id,onClick:()=>c(E.id),className:`p-3 rounded-lg border-2 text-center transition-colors ${l===E.id?"bg-blue-600 text-white border-blue-600":"bg-gray-50 border-gray-200 text-gray-700 hover:border-blue-300 hover:bg-blue-50"}`,title:E.descripcion},a.createElement("div",{className:"text-lg mb-1"},E.icono),a.createElement("div",{className:"text-xs font-medium"},E.nombre)))),l!=="todos"&&a.createElement("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg"},(()=>{const E=u.find(y=>y.id===l);return E?a.createElement("div",null,a.createElement("h4",{className:"font-semibold text-blue-900 mb-2 flex items-center gap-2"},a.createElement("span",null,E.icono),E.nombre),a.createElement("p",{className:"text-blue-800 mb-3"},E.descripcion),a.createElement("div",{className:"space-y-2"},a.createElement("div",null,a.createElement("span",{className:"text-sm font-medium text-blue-700"},"Servicios típicos:"),a.createElement("div",{className:"flex flex-wrap gap-2 mt-1"},E.servicios.map((y,h)=>a.createElement("span",{key:h,className:"bg-blue-200 text-blue-800 px-3 py-1 rounded-full text-sm"},y)))),a.createElement("div",null,a.createElement("span",{className:"text-sm font-medium text-blue-700"},"Ejemplos:"),a.createElement("div",{className:"flex flex-wrap gap-2 mt-1"},E.ejemplos.map((y,h)=>a.createElement("span",{key:h,className:"bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm"},y)))))):null})())),a.createElement("div",{className:"bg-white rounded-xl shadow-sm p-8 mb-8"},a.createElement("h3",{className:"text-2xl font-bold text-gray-900 text-center mb-6"},"📊 Nuestra Comunidad de PyMEs"),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-3xl font-bold text-green-600 mb-2"},r.length),a.createElement("div",{className:"text-sm text-gray-600"},"PyMEs Activas")),a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-3xl font-bold text-blue-600 mb-2"},r.filter(E=>E.esEmprendimiento||E.fechaRegistro&&new Date-(E.fechaRegistro.toDate?E.fechaRegistro.toDate():new Date(E.fechaRegistro))<6*30*24*60*60*1e3).length),a.createElement("div",{className:"text-sm text-gray-600"},"🚀 Emprendimientos")),a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-3xl font-bold text-purple-600 mb-2"},"8"),a.createElement("div",{className:"text-sm text-gray-600"},"🏭 Sectores Cubiertos")),a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-3xl font-bold text-yellow-600 mb-2"},"95%"),a.createElement("div",{className:"text-sm text-gray-600"},"😊 Satisfacción")))),a.createElement("div",{className:"mb-6 text-center"},a.createElement("h3",{className:"text-xl font-semibold text-gray-900 mb-2"},l==="todos"?`${r.length} PyMEs y Emprendimientos Disponibles`:`${r.length} ${((x=u.find(E=>E.id===l))==null?void 0:x.nombre)||"Proveedores"} Disponibles`),a.createElement("p",{className:"text-gray-600"},"Conecta directamente con emprendedores locales que entienden tus necesidades")),r.length===0?a.createElement("div",{className:"text-center py-12"},a.createElement("div",{className:"text-gray-500 text-lg mb-4"},"No se encontraron PyMEs en este sector"),a.createElement("button",{onClick:()=>c("todos"),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"Ver todas las PyMEs")):a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},r.map(E=>a.createElement("div",{key:E.id,className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow"},a.createElement("div",{className:"p-4 border-b border-gray-100"},a.createElement("div",{className:"flex items-start gap-3"},E.logo&&a.createElement("img",{src:E.logo,alt:E.nombre,className:"w-12 h-12 object-contain rounded flex-shrink-0"}),a.createElement("div",{className:"flex-1 min-w-0"},a.createElement("h3",{className:"font-semibold text-gray-900 truncate"},E.nombre),a.createElement("div",{className:"mt-1"},a.createElement(BT,{empresa:E,size:"sm"}))))),a.createElement("div",{className:"p-4"},a.createElement("div",{className:"space-y-2 text-sm"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:"text-gray-500"},"📍"),a.createElement("span",{className:"text-gray-700"},E.ciudad,", ",E.region)),E.telefono&&a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:"text-gray-500"},"📞"),a.createElement("span",{className:"text-gray-700"},E.telefono)),E.fechaRegistro&&a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:"text-gray-500"},"📅"),a.createElement("span",{className:"text-gray-700"},"Desde ",v(E.fechaRegistro)))),E.categorias&&E.categorias.length>0&&a.createElement("div",{className:"mt-3"},a.createElement("div",{className:"text-xs text-gray-500 mb-1"},"Servicios:"),a.createElement("div",{className:"flex flex-wrap gap-1"},E.categorias.slice(0,3).map((y,h)=>a.createElement("span",{key:h,className:"bg-green-100 text-green-700 text-xs px-2 py-1 rounded"},y)),E.categorias.length>3&&a.createElement("span",{className:"text-xs text-gray-500"},"+",E.categorias.length-3," más"))),a.createElement("div",{className:"mt-3"},a.createElement(qT,{proveedorId:E.id,compact:!0,showReviews:!1}))),a.createElement("div",{className:"p-4 bg-gray-50 border-t border-gray-100"},a.createElement("div",{className:"flex gap-2"},a.createElement("button",{onClick:()=>t(`/proveedor/${E.id}`),className:"flex-1 bg-green-600 text-white text-sm py-2 px-3 rounded hover:bg-green-700 transition-colors"},"Ver PyME"),E.telefono&&a.createElement("button",{onClick:()=>window.open(`https://wa.me/56${E.telefono.replace(/[^\d]/g,"")}`,"_blank"),className:"bg-green-500 text-white text-sm py-2 px-3 rounded hover:bg-green-600 transition-colors"},"📱 WhatsApp")))))),a.createElement("div",{className:"mt-12 space-y-8"},a.createElement("div",{className:"bg-gradient-to-r from-green-600 to-blue-600 rounded-2xl p-8 text-white"},a.createElement("div",{className:"max-w-3xl mx-auto text-center"},a.createElement("h3",{className:"text-3xl font-bold mb-4"},"🚀 ¿Tienes una PyME o Emprendimiento Automotriz?"),a.createElement("p",{className:"text-lg text-green-100 mb-6"},a.createElement("strong",null,"¡Te ayudamos a digitalizarte!")," Crearemos tu página web, te daremos una campaña semanal gratis y podrás agregar todos tus productos sin costo. Solo necesitas ganas de crecer."),a.createElement("div",{className:"bg-white/10 rounded-lg p-4 mb-6"},a.createElement("h4",{className:"font-semibold mb-2"},"🎁 Incluye:"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm"},a.createElement("div",null,"✅ Página web gratuita"),a.createElement("div",null,"✅ 1 campaña semanal"),a.createElement("div",null,"✅ Productos ilimitados"))),a.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},a.createElement("button",{onClick:()=>t("/registro-pyme"),className:"bg-yellow-400 text-blue-900 px-10 py-4 rounded-xl font-bold text-lg hover:bg-yellow-500 transition-colors shadow-xl transform hover:scale-105"},"🌟 Registrar Mi PyME Gratis"),a.createElement("button",{onClick:()=>t("/login?tipo=empresa"),className:"bg-white text-blue-700 px-10 py-4 rounded-xl font-bold text-lg hover:bg-blue-50 transition-colors shadow-xl border-2 border-white"},"🏢 Ya Tengo Cuenta")))),a.createElement("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-8 text-white"},a.createElement("div",{className:"max-w-3xl mx-auto text-center"},a.createElement("h3",{className:"text-3xl font-bold mb-4"},"🏠 ¿Buscas Servicios Automotrices Locales?"),a.createElement("p",{className:"text-lg text-blue-100 mb-6"},"Encuentra emprendedores de tu barrio que ofrecen servicios personalizados, precios justos y la cercanía que necesitas para el cuidado de tu vehículo."),a.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},a.createElement("button",{onClick:()=>t("/registro-cliente"),className:"bg-white text-blue-700 px-8 py-3 rounded-lg font-semibold hover:bg-blue-50 transition-colors shadow-lg"},"👤 Registrar Mi Vehículo"),a.createElement("button",{onClick:()=>t("/login?tipo=cliente"),className:"bg-blue-400 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-300 transition-colors shadow-lg"},"🔑 Acceso Clientes"),a.createElement("button",{onClick:()=>{const E=document.getElementById("sectores-pymes");E==null||E.scrollIntoView({behavior:"smooth"})},className:"bg-blue-500 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-400 transition-colors border-2 border-blue-400"},"🔍 Explorar PyMEs")))))))};function aB(){var N;const{empresaId:t}=GI(),[e,n]=p.useState(null),[r,s]=p.useState([]),[i,o]=p.useState([]),[l,c]=p.useState(!0),[u,d]=p.useState(""),[f,g]=p.useState(null),[v,x]=p.useState("info");p.useEffect(()=>{E(),y(),h()},[t]);const E=async()=>{try{const b=we($,"empresas",t),w=await di(b);if(w.exists()){const A={id:w.id,...w.data()};n(A)}else d("Empresa no encontrada")}catch(b){console.error("Error cargando empresa:",b),d("Error al cargar la empresa")}finally{c(!1)}},y=async()=>{try{const b=pe(Q($,"productos"),fe("empresaId","==",t)),A=(await ue(b)).docs.map(R=>({id:R.id,...R.data()}));s(A)}catch(b){console.error("Error cargando productos:",b)}},h=async()=>{try{const b=pe(Q($,"campañas"),fe("empresaId","==",t)),A=(await ue(b)).docs.map(R=>({id:R.id,...R.data()}));o(A)}catch(b){console.error("Error cargando campañas:",b)}},C=()=>{if(!e.horarios)return"Horarios no definidos";const b=["lunes","martes","miercoles","jueves","viernes","sabado","domingo"],w=["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"];return b.map((A,R)=>{const L=e.horarios[A];return!L||!L.activo?`${w[R]}: Cerrado`:`${w[R]}: ${L.inicio} - ${L.fin}`}).join(`
`)},T=()=>{if(e.direccion){const b=encodeURIComponent(e.direccion);window.open(`https://www.google.com/maps/search/?api=1&query=${b}`,"_blank")}},k=b=>b?b.startsWith("http")?b:`/images/${b}`:"",_=b=>{g(b)},S=()=>{g(null)};return l?a.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gray-50"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.createElement("p",{className:"text-gray-600"},"Cargando perfil..."))):u||!e?a.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gray-50"},a.createElement("div",{className:"text-center bg-white p-8 rounded-lg shadow-lg"},a.createElement("div",{className:"text-6xl mb-4"},"🏢"),a.createElement("h1",{className:"text-2xl font-bold text-gray-900 mb-2"},"Empresa no encontrada"),a.createElement("p",{className:"text-gray-600"},"La empresa que buscas no existe o no está disponible."))):e.web&&!window.location.hash?(window.location.href=e.web.startsWith("http")?e.web:`https://${e.web}`,null):a.createElement("div",{className:"min-h-screen bg-gray-50"},a.createElement("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white relative"},e.imagenLocal&&a.createElement("div",{className:"absolute inset-0 opacity-20"},a.createElement("img",{src:k(e.imagenLocal),alt:"Local",className:"w-full h-full object-cover"})),a.createElement("div",{className:"relative max-w-6xl mx-auto px-4 py-12"},a.createElement("div",{className:"flex flex-col md:flex-row items-center gap-8"},e.logo&&a.createElement("div",{className:"flex-shrink-0"},a.createElement("img",{src:k(e.logo),alt:e.nombre,className:"w-40 h-40 bg-white rounded-xl p-4 object-contain shadow-2xl border-4 border-white"})),a.createElement("div",{className:"text-center md:text-left flex-1"},a.createElement("h1",{className:"text-4xl md:text-5xl font-bold mb-4 drop-shadow-lg"},e.nombre),e.categoria&&a.createElement("p",{className:"text-xl text-blue-100 mb-4 drop-shadow"},e.categoria),a.createElement("div",{className:"flex flex-wrap justify-center md:justify-start gap-4 text-sm mb-6"},e.telefono&&a.createElement("div",{className:"flex items-center gap-2 bg-blue-700 bg-opacity-50 px-4 py-2 rounded-full backdrop-blur-sm"},a.createElement("span",null,"📞"),a.createElement("span",null,e.telefono)),e.email&&a.createElement("div",{className:"flex items-center gap-2 bg-blue-700 bg-opacity-50 px-4 py-2 rounded-full backdrop-blur-sm"},a.createElement("span",null,"📧"),a.createElement("span",null,e.email))),e.direccion&&a.createElement("div",{className:"flex flex-col md:flex-row items-center gap-4"},a.createElement("div",{className:"flex items-center gap-2 text-blue-100"},a.createElement("span",null,"📍"),a.createElement("span",null,e.direccion)),a.createElement("button",{onClick:T,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center gap-2"},"🗺️ Ver en Mapa")))))),a.createElement("div",{className:"bg-white shadow-sm border-b"},a.createElement("div",{className:"max-w-6xl mx-auto px-4"},a.createElement("nav",{className:"flex space-x-8"},a.createElement("button",{onClick:()=>x("info"),className:`py-4 px-1 border-b-2 font-medium text-sm ${v==="info"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`},"📋 Información"),r.length>0&&a.createElement("button",{onClick:()=>x("productos"),className:`py-4 px-1 border-b-2 font-medium text-sm ${v==="productos"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`},"🛍️ Productos (",r.length,")"),i.length>0&&a.createElement("button",{onClick:()=>x("campanas"),className:`py-4 px-1 border-b-2 font-medium text-sm ${v==="campanas"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`},"🎯 Ofertas (",i.length,")"),a.createElement("button",{onClick:()=>x("contacto"),className:`py-4 px-1 border-b-2 font-medium text-sm ${v==="contacto"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`},"📞 Contacto")))),a.createElement("div",{className:"max-w-6xl mx-auto px-4 py-12"},v==="info"&&a.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},a.createElement("div",{className:"lg:col-span-2 space-y-8"},(e.descripcionCompleta||e.descripcion)&&a.createElement("section",{className:"bg-white rounded-xl shadow-sm p-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-4"},"Acerca de Nosotros"),a.createElement("p",{className:"text-gray-700 leading-relaxed text-lg"},e.descripcionCompleta||e.descripcion)),e.servicios&&e.servicios.length>0&&a.createElement("section",{className:"bg-white rounded-xl shadow-sm p-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-4"},"Nuestros Servicios"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},e.servicios.map((b,w)=>a.createElement("div",{key:w,className:"flex items-center gap-3 p-4 bg-blue-50 rounded-lg border-l-4 border-blue-500"},a.createElement("span",{className:"text-blue-600 text-xl"},"✓"),a.createElement("span",{className:"font-medium text-gray-800"},b))))),e.galeria&&e.galeria.length>0&&a.createElement("section",{className:"bg-white rounded-xl shadow-sm p-6"},a.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-4"},"Galería"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},e.galeria.map((b,w)=>a.createElement("div",{key:w,className:"relative group cursor-pointer",onClick:()=>_(k(b))},a.createElement("img",{src:k(b),alt:`Foto ${w+1}`,className:"w-full h-48 object-cover rounded-lg transition-transform group-hover:scale-105"}),a.createElement("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all rounded-lg flex items-center justify-center"},a.createElement("span",{className:"text-white text-2xl opacity-0 group-hover:opacity-100 transition-opacity"},"🔍"))))))),a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6"},a.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2"},a.createElement("span",null,"🕒"),"Horarios de Atención"),a.createElement("div",{className:"space-y-2 text-sm"},C().split(`
`).map((b,w)=>a.createElement("div",{key:w,className:"flex justify-between py-1 border-b border-gray-100 last:border-0"},a.createElement("span",{className:"font-medium text-gray-700"},b.split(":")[0],":"),a.createElement("span",{className:"text-gray-600"},b.split(":").slice(1).join(":").trim()))))),e.direccion&&a.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6"},a.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2"},a.createElement("span",null,"📍"),"Ubicación"),a.createElement("p",{className:"text-gray-700 mb-4"},e.direccion),a.createElement("button",{onClick:T,className:"w-full bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg transition-colors flex items-center justify-center gap-2"},"🗺️ Abrir en Google Maps")))),v==="productos"&&a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},r.map(b=>a.createElement("div",{key:b.id,className:"bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow"},b.imagen&&a.createElement("img",{src:k(b.imagen),alt:b.nombre,className:"w-full h-48 object-cover"}),a.createElement("div",{className:"p-4"},a.createElement("h3",{className:"font-bold text-gray-900 mb-2"},b.nombre),b.descripcion&&a.createElement("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2"},b.descripcion),b.precio&&a.createElement("p",{className:"text-xl font-bold text-green-600"},"$",b.precio.toLocaleString()),b.categoria&&a.createElement("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full mt-2"},b.categoria))))),v==="campanas"&&a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},i.map(b=>a.createElement("div",{key:b.id,className:"bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl shadow-lg overflow-hidden text-white"},b.imagen&&a.createElement("img",{src:k(b.imagen),alt:b.titulo,className:"w-full h-48 object-cover"}),a.createElement("div",{className:"p-6"},a.createElement("h3",{className:"text-2xl font-bold mb-3"},b.titulo),b.descripcion&&a.createElement("p",{className:"text-purple-100 mb-4"},b.descripcion),b.descuento&&a.createElement("div",{className:"bg-yellow-400 text-purple-900 px-4 py-2 rounded-lg font-bold text-lg mb-4"},b.descuento,"% OFF"),b.fechaFin&&a.createElement("p",{className:"text-purple-200 text-sm"},"Válido hasta: ",new Date(b.fechaFin.seconds*1e3).toLocaleDateString()))))),v==="contacto"&&a.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8"},a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6"},a.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4"},"Información de Contacto"),a.createElement("div",{className:"space-y-4"},e.telefono&&a.createElement("div",{className:"flex items-center gap-3"},a.createElement("span",{className:"text-green-600 text-xl"},"📱"),a.createElement("div",null,a.createElement("p",{className:"text-sm text-gray-600"},"Teléfono"),a.createElement("a",{href:`tel:${e.telefono}`,className:"font-medium text-blue-600 hover:text-blue-800"},e.telefono))),e.email&&a.createElement("div",{className:"flex items-center gap-3"},a.createElement("span",{className:"text-blue-600 text-xl"},"📧"),a.createElement("div",null,a.createElement("p",{className:"text-sm text-gray-600"},"Email"),a.createElement("a",{href:`mailto:${e.email}`,className:"font-medium text-blue-600 hover:text-blue-800"},e.email))),((N=e.contactoAdicional)==null?void 0:N.whatsapp)&&a.createElement("div",{className:"flex items-center gap-3"},a.createElement("span",{className:"text-green-600 text-xl"},"💬"),a.createElement("div",null,a.createElement("p",{className:"text-sm text-gray-600"},"WhatsApp"),a.createElement("a",{href:`https://wa.me/${e.contactoAdicional.whatsapp.replace(/\D/g,"")}`,target:"_blank",rel:"noopener noreferrer",className:"font-medium text-green-600 hover:text-green-800"},e.contactoAdicional.whatsapp))),e.direccion&&a.createElement("div",{className:"flex items-start gap-3"},a.createElement("span",{className:"text-red-600 text-xl"},"📍"),a.createElement("div",{className:"flex-1"},a.createElement("p",{className:"text-sm text-gray-600"},"Dirección"),a.createElement("p",{className:"font-medium text-gray-800 mb-2"},e.direccion),a.createElement("button",{onClick:T,className:"text-blue-600 hover:text-blue-800 text-sm underline"},"Ver en Google Maps")))))),a.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6"},a.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4"},"Horarios de Atención"),a.createElement("div",{className:"space-y-3"},C().split(`
`).map((b,w)=>{const[A,R]=b.split(":"),L=R.trim()==="Cerrado";return a.createElement("div",{key:w,className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-0"},a.createElement("span",{className:"font-medium text-gray-700"},A,":"),a.createElement("span",{className:`${L?"text-red-600":"text-green-600"} font-medium`},R.trim()))}))))),f&&a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4",onClick:S},a.createElement("div",{className:"relative max-w-4xl max-h-full"},a.createElement("img",{src:f,alt:"Imagen ampliada",className:"max-w-full max-h-full object-contain rounded-lg"}),a.createElement("button",{onClick:S,className:"absolute top-4 right-4 bg-white bg-opacity-20 text-white rounded-full w-10 h-10 flex items-center justify-center hover:bg-opacity-30 transition-colors"},"✕"))),a.createElement("footer",{className:"bg-gray-800 text-white py-8"},a.createElement("div",{className:"max-w-6xl mx-auto px-4 text-center"},a.createElement("p",{className:"text-gray-400"},"Perfil empresarial de ",e.nombre," • Plataforma AV10deJulio"))))}function sB(){const t=ft(),[e,n]=p.useState([]),[r,s]=p.useState(!0),[i,o]=p.useState(""),[l,c]=p.useState(null),[u,d]=p.useState(!1);p.useEffect(()=>{f()},[]);const f=async()=>{try{s(!0);const E=(await ue(Q($,"agentes"))).docs.map(y=>({id:y.id,...y.data()}));n(E)}catch(x){console.error("Error cargando agentes:",x)}finally{s(!1)}},g=async()=>{try{d(!0);const x="agente.prueba@test.com",E="test123456",y=pe(Q($,"agentes"),fe("email","==",x));if(!(await ue(y)).empty){alert("Ya existe un agente de prueba con este email");return}const C={nombre:"Agente de Prueba",email:x,telefono:"+56912345678",zona_asignada:"Zona de Prueba",rol:"agente",activo:!0,fecha_creacion:new Date,admin_creador:"debug@system.com",password_temporal:E,requiere_registro:!0,permisos:{crear_solicitudes:!0,activar_empresas:!0,gestionar_perfil:!0}};await ze(Q($,"agentes"),C),alert(`✅ Agente de prueba creado!

📧 Email: ${x}
🔑 Contraseña: ${E}

🔗 Ahora puedes:
1. Ir a /registro-agente
2. Usar estas credenciales
3. Completar el registro
4. Después hacer login normal`),await f()}catch(x){console.error("Error creando agente de prueba:",x),alert("Error creando agente de prueba: "+x.message)}finally{d(!1)}},v=async()=>{if(i)try{const x=pe(Q($,"agentes"),fe("email","==",i),fe("requiere_registro","==",!0)),E=await ue(x);if(E.empty)c({encontrado:!1,agente:null});else{const y={id:E.docs[0].id,...E.docs[0].data()};c({encontrado:!0,agente:y})}}catch(x){console.error("Error verificando agente:",x),c({error:x.message})}};return r?a.createElement("div",{className:"p-4"},"Cargando agentes..."):a.createElement("div",{className:"p-6 max-w-4xl mx-auto"},a.createElement("h1",{className:"text-2xl font-bold mb-6"},"Debug: Estado de Agentes"),a.createElement("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg mb-6"},a.createElement("h2",{className:"text-lg font-semibold mb-3"},"Navegación Rápida"),a.createElement("div",{className:"flex gap-2 flex-wrap"},a.createElement("button",{onClick:()=>t("/registro-agente"),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"📝 Ir a Registro de Agente"),a.createElement("button",{onClick:()=>t("/login"),className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"},"🔐 Ir a Login"),a.createElement("button",{onClick:()=>t("/admin"),className:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700"},"👑 Ir a Admin"),a.createElement("button",{onClick:()=>t("/"),className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700"},"🏠 Ir a Inicio"),a.createElement("button",{onClick:()=>t("/debug-sesion-agente"),className:"bg-orange-600 text-white px-4 py-2 rounded hover:bg-orange-700"},"🔍 Debug Sesión Agente"))),a.createElement("div",{className:"bg-purple-50 border border-purple-200 p-4 rounded-lg mb-6"},a.createElement("h2",{className:"text-lg font-semibold mb-3"},"🧪 Testing del Error 400"),a.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Sigue estos pasos para probar y solucionar el error 400:"),a.createElement("div",{className:"space-y-2 text-sm"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs font-semibold"},"PASO 1"),a.createElement("span",null,"Crear agente de prueba ↓")),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs font-semibold"},"PASO 2"),a.createElement("span",null,"Copiar credenciales (botón 📋)")),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs font-semibold"},"PASO 3"),a.createElement("span",null,"Ir a Login e intentar acceso (debería fallar)")),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs font-semibold"},"PASO 4"),a.createElement("span",null,"Ir a Registro de Agente (botón 🚀)")),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs font-semibold"},"PASO 5"),a.createElement("span",null,"Completar registro con credenciales copiadas")),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs font-semibold"},"PASO 6"),a.createElement("span",null,"Probar login normal (debería funcionar)")))),a.createElement("div",{className:"bg-green-50 border border-green-200 p-4 rounded-lg mb-6"},a.createElement("h2",{className:"text-lg font-semibold mb-3"},"Crear Agente de Prueba"),a.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Si no tienes agentes en el sistema, puedes crear uno de prueba para testing."),a.createElement("div",{className:"flex gap-2"},a.createElement("button",{onClick:g,disabled:u,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 disabled:bg-gray-400"},u?"Creando...":"🔧 Crear Agente de Prueba"),a.createElement("button",{onClick:()=>{const x=`🧪 TESTING ERROR 400 - AGENTES

📧 Credenciales de prueba:
Email: agente.prueba@test.com
Contraseña: test123456

📋 Pasos para probar:
1. Crea agente de prueba (botón verde)
2. Ve a /login e intenta acceder (ERROR 400 esperado)
3. Ve a /registro-agente 
4. Usa las credenciales de arriba
5. Completa el registro
6. Ahora ya puedes hacer login normal

🌐 URLs importantes:
- Debug: http://localhost:5182/debug-agentes
- Login: http://localhost:5182/login  
- Registro: http://localhost:5182/registro-agente
- Admin: http://localhost:5182/admin`;navigator.clipboard.writeText(x),alert("📋 Instrucciones completas copiadas al portapapeles")},className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"📋 Copiar Instrucciones"))),a.createElement("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg mb-6"},a.createElement("h2",{className:"text-lg font-semibold mb-3"},"Verificar Email Específico"),a.createElement("div",{className:"flex gap-2 mb-3"},a.createElement("input",{type:"email",value:i,onChange:x=>o(x.target.value),placeholder:"Email del agente",className:"flex-1 px-3 py-2 border rounded"}),a.createElement("button",{onClick:v,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},"Verificar")),l&&a.createElement("div",{className:"mt-3 p-3 bg-white border rounded"},l.error?a.createElement("p",{className:"text-red-600"},"Error: ",l.error):l.encontrado?a.createElement("div",{className:"text-green-600"},a.createElement("p",null,a.createElement("strong",null,"✅ Agente encontrado que requiere registro:")),a.createElement("pre",{className:"text-sm mt-2 bg-gray-100 p-2 rounded"},JSON.stringify(l.agente,null,2))):a.createElement("p",{className:"text-red-600"},"❌ No se encontró agente con ese email que requiera registro"))),a.createElement("div",{className:"bg-white border rounded-lg p-4"},a.createElement("h2",{className:"text-lg font-semibold mb-3"},"Todos los Agentes (",e.length,")"),e.length===0?a.createElement("div",{className:"text-center py-6"},a.createElement("p",{className:"text-gray-600 mb-4"},"No hay agentes en la base de datos"),a.createElement("p",{className:"text-sm text-blue-600"},"💡 Crea un agente de prueba usando el botón de arriba")):a.createElement("div",{className:"space-y-3"},e.map(x=>{var E,y,h;return a.createElement("div",{key:x.id,className:"border p-3 rounded bg-gray-50"},a.createElement("div",{className:"grid grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("p",null,a.createElement("strong",null,"Nombre:")," ",x.nombre),a.createElement("p",null,a.createElement("strong",null,"Email:")," ",x.email),a.createElement("p",null,a.createElement("strong",null,"Activo:")," ",x.activo?"✅ Sí":"❌ No")),a.createElement("div",null,a.createElement("p",null,a.createElement("strong",null,"Requiere Registro:")," ",x.requiere_registro?"🔶 Sí":"✅ No"),a.createElement("p",null,a.createElement("strong",null,"Zona:")," ",x.zona_asignada),a.createElement("p",null,a.createElement("strong",null,"Fecha Creación:")," ",((h=(y=(E=x.fecha_creacion)==null?void 0:E.toDate)==null?void 0:y.call(E))==null?void 0:h.toLocaleDateString())||"N/A"))),x.password_temporal&&a.createElement("div",{className:"mt-2 p-2 bg-yellow-100 border border-yellow-300 rounded text-sm"},a.createElement("p",null,a.createElement("strong",null,"Contraseña Temporal:")," ",x.password_temporal)),x.requiere_registro&&x.password_temporal&&a.createElement("div",{className:"mt-3 flex gap-2"},a.createElement("button",{onClick:()=>t("/registro-agente"),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700"},"🚀 Ir a Registro"),a.createElement("button",{onClick:()=>{navigator.clipboard.writeText(`Email: ${x.email}
Contraseña: ${x.password_temporal}`),alert("Credenciales copiadas al portapapeles")},className:"bg-gray-600 text-white px-3 py-1 rounded text-sm hover:bg-gray-700"},"📋 Copiar Credenciales"),a.createElement("button",{onClick:()=>t("/login"),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700"},"🔐 Ir a Login")))}))))}function iB(){var d,f,g;const{user:t}=Qe(),[e,n]=p.useState(null),[r,s]=p.useState(null),[i,o]=p.useState(!0),[l,c]=p.useState("");p.useEffect(()=>{t&&u()},[t]);const u=async()=>{try{o(!0),c("");const v=pe(Q($,"usuarios"),fe("uid","==",t.uid)),x=await ue(v);x.empty||s(x.docs[0].data());const E=pe(Q($,"agentes"),fe("uid","==",t.uid)),y=await ue(E);if(y.empty)c("No se encontraron datos de agente para este usuario");else{const h=y.docs[0];n({id:h.id,...h.data()})}}catch(v){console.error("Error verificando datos:",v),c("Error verificando datos: "+v.message)}finally{o(!1)}};return t?i?a.createElement("div",{className:"p-6 max-w-2xl mx-auto"},a.createElement("div",{className:"text-center"},a.createElement("p",null,"Verificando datos del agente..."))):a.createElement("div",{className:"p-6 max-w-4xl mx-auto"},a.createElement("h1",{className:"text-2xl font-bold mb-6"},"Debug: Sesión de Agente"),a.createElement("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg mb-6"},a.createElement("h2",{className:"text-lg font-semibold mb-3"},"🔐 Usuario de Firebase Auth"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},a.createElement("div",null,a.createElement("p",null,a.createElement("strong",null,"UID:")," ",t.uid),a.createElement("p",null,a.createElement("strong",null,"Email:")," ",t.email)),a.createElement("div",null,a.createElement("p",null,a.createElement("strong",null,"Email Verificado:")," ",t.emailVerified?"✅ Sí":"❌ No"),a.createElement("p",null,a.createElement("strong",null,"Fecha Creación:")," ",new Date(t.metadata.creationTime).toLocaleString())))),a.createElement("div",{className:"bg-green-50 border border-green-200 p-4 rounded-lg mb-6"},a.createElement("h2",{className:"text-lg font-semibold mb-3"},"👤 Datos en colección 'usuarios'"),r?a.createElement("div",{className:"bg-white p-3 rounded border"},a.createElement("pre",{className:"text-sm overflow-auto"},JSON.stringify(r,null,2))):a.createElement("p",{className:"text-gray-600"},"No se encontraron datos en la colección 'usuarios'")),a.createElement("div",{className:"bg-purple-50 border border-purple-200 p-4 rounded-lg mb-6"},a.createElement("h2",{className:"text-lg font-semibold mb-3"},"🕵️ Datos en colección 'agentes'"),e?a.createElement("div",null,a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},a.createElement("div",null,a.createElement("p",null,a.createElement("strong",null,"ID Documento:")," ",e.id),a.createElement("p",null,a.createElement("strong",null,"Nombre:")," ",e.nombre),a.createElement("p",null,a.createElement("strong",null,"Email:")," ",e.email),a.createElement("p",null,a.createElement("strong",null,"Activo:")," ",e.activo?"✅ Sí":"❌ No")),a.createElement("div",null,a.createElement("p",null,a.createElement("strong",null,"Zona:")," ",e.zona_asignada),a.createElement("p",null,a.createElement("strong",null,"Requiere Registro:")," ",e.requiere_registro?"🔶 Sí":"✅ No"),a.createElement("p",null,a.createElement("strong",null,"Fecha Creación:")," ",((g=(f=(d=e.fecha_creacion)==null?void 0:d.toDate)==null?void 0:f.call(d))==null?void 0:g.toLocaleString())||"N/A"),a.createElement("p",null,a.createElement("strong",null,"UID Firebase:")," ",e.uid))),e.permisos&&a.createElement("div",{className:"bg-white p-3 rounded border"},a.createElement("h3",{className:"font-semibold mb-2"},"Permisos:"),a.createElement("pre",{className:"text-sm"},JSON.stringify(e.permisos,null,2)))):a.createElement("div",{className:"bg-red-100 border border-red-300 p-3 rounded"},a.createElement("p",{className:"text-red-700 font-semibold"},"❌ No se encontraron datos de agente"),a.createElement("p",{className:"text-red-600 text-sm mt-1"},l))),a.createElement("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg"},a.createElement("h2",{className:"text-lg font-semibold mb-3"},"🔍 Diagnóstico"),a.createElement("div",{className:"space-y-2 text-sm"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:`w-3 h-3 rounded-full ${t?"bg-green-500":"bg-red-500"}`}),a.createElement("span",null,"Usuario autenticado en Firebase Auth")),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:`w-3 h-3 rounded-full ${r?"bg-green-500":"bg-yellow-500"}`}),a.createElement("span",null,"Registro en colección 'usuarios'")),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:`w-3 h-3 rounded-full ${e?"bg-green-500":"bg-red-500"}`}),a.createElement("span",null,"Registro en colección 'agentes'")),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:`w-3 h-3 rounded-full ${e!=null&&e.activo?"bg-green-500":"bg-red-500"}`}),a.createElement("span",null,"Agente activo")),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:`w-3 h-3 rounded-full ${e!=null&&e.requiere_registro?"bg-yellow-500":"bg-green-500"}`}),a.createElement("span",null,"Registro completado"))),e&&e.activo&&!e.requiere_registro?a.createElement("div",{className:"mt-4 p-3 bg-green-100 border border-green-300 rounded"},a.createElement("p",{className:"text-green-800 font-semibold"},"✅ Todo está configurado correctamente"),a.createElement("p",{className:"text-green-700 text-sm"},"El agente debería poder acceder a todas las funciones.")):a.createElement("div",{className:"mt-4 p-3 bg-red-100 border border-red-300 rounded"},a.createElement("p",{className:"text-red-800 font-semibold"},"❌ Hay problemas de configuración"),a.createElement("p",{className:"text-red-700 text-sm"},"El agente puede tener acceso limitado o nulo.")))):a.createElement("div",{className:"p-6 max-w-2xl mx-auto"},a.createElement("div",{className:"bg-red-50 border border-red-200 p-4 rounded-lg"},a.createElement("h2",{className:"text-lg font-semibold text-red-800 mb-2"},"No hay usuario autenticado"),a.createElement("p",{className:"text-red-600"},"Debes hacer login primero para ver esta información.")))}function oB(){const t=ft();return a.createElement("div",{className:"min-h-screen bg-gradient-to-br from-blue-100 via-white to-green-100 py-12 px-4"},a.createElement("div",{className:"max-w-4xl mx-auto"},a.createElement("div",{className:"text-center mb-12"},a.createElement("h1",{className:"text-4xl font-bold text-gray-800 mb-4"},"👥 Guía para Agentes de Campo"),a.createElement("p",{className:"text-xl text-gray-600"},"¿Tienes problemas para acceder? Aquí te explicamos paso a paso")),a.createElement("div",{className:"grid md:grid-cols-2 gap-8 mb-12"},a.createElement("div",{className:"bg-white rounded-xl shadow-lg p-8 border-2 border-blue-200"},a.createElement("div",{className:"text-center mb-6"},a.createElement("div",{className:"text-6xl mb-4"},"🔑"),a.createElement("h2",{className:"text-2xl font-bold text-blue-800"},"Soy Agente Nuevo"),a.createElement("p",{className:"text-gray-600 mt-2"},"El admin me creó pero es mi primera vez")),a.createElement("div",{className:"space-y-4 mb-6"},a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-sm font-semibold"},"1"),a.createElement("div",null,a.createElement("p",{className:"font-medium"},"El admin me creó en el sistema"),a.createElement("p",{className:"text-sm text-gray-600"},"Me proporcionó email y contraseña temporal"))),a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-sm font-semibold"},"2"),a.createElement("div",null,a.createElement("p",{className:"font-medium"},"Necesito completar mi registro"),a.createElement("p",{className:"text-sm text-gray-600"},"Solo la primera vez, después uso login normal"))),a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-sm font-semibold"},"3"),a.createElement("div",null,a.createElement("p",{className:"font-medium"},"Uso las credenciales temporales"),a.createElement("p",{className:"text-sm text-gray-600"},"Email y contraseña que me dio el admin")))),a.createElement("button",{onClick:()=>t("/registro-agente"),className:"w-full bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors font-medium"},"Completar Registro Inicial")),a.createElement("div",{className:"bg-white rounded-xl shadow-lg p-8 border-2 border-green-200"},a.createElement("div",{className:"text-center mb-6"},a.createElement("div",{className:"text-6xl mb-4"},"✅"),a.createElement("h2",{className:"text-2xl font-bold text-green-800"},"Ya soy Agente Activo"),a.createElement("p",{className:"text-gray-600 mt-2"},"Ya completé mi registro antes")),a.createElement("div",{className:"space-y-4 mb-6"},a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("div",{className:"flex-shrink-0 w-6 h-6 bg-green-100 rounded-full flex items-center justify-center text-green-600 text-sm font-semibold"},"1"),a.createElement("div",null,a.createElement("p",{className:"font-medium"},"Ya tengo cuenta activa"),a.createElement("p",{className:"text-sm text-gray-600"},"Completé el registro inicial anteriormente"))),a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("div",{className:"flex-shrink-0 w-6 h-6 bg-green-100 rounded-full flex items-center justify-center text-green-600 text-sm font-semibold"},"2"),a.createElement("div",null,a.createElement("p",{className:"font-medium"},"Uso login normal"),a.createElement("p",{className:"text-sm text-gray-600"},"Como cualquier usuario del sistema"))),a.createElement("div",{className:"flex items-start space-x-3"},a.createElement("div",{className:"flex-shrink-0 w-6 h-6 bg-green-100 rounded-full flex items-center justify-center text-green-600 text-sm font-semibold"},"3"),a.createElement("div",null,a.createElement("p",{className:"font-medium"},"Accedo a mi panel de agente"),a.createElement("p",{className:"text-sm text-gray-600"},"Puedo crear solicitudes de empresas")))),a.createElement("button",{onClick:()=>t("/login"),className:"w-full bg-green-600 text-white py-3 px-6 rounded-lg hover:bg-green-700 transition-colors font-medium"},"Iniciar Sesión Normal"))),a.createElement("div",{className:"bg-white rounded-xl shadow-lg p-8 mb-8"},a.createElement("h3",{className:"text-2xl font-bold text-gray-800 mb-6 text-center"},"🚨 Errores Comunes y Soluciones"),a.createElement("div",{className:"grid md:grid-cols-2 gap-8"},a.createElement("div",null,a.createElement("h4",{className:"text-lg font-semibold text-red-600 mb-4"},'❌ "Email ya registrado pero la contraseña no coincide"'),a.createElement("div",{className:"space-y-3"},a.createElement("p",{className:"text-sm text-gray-700"},a.createElement("strong",null,"Causa:"),' Estás usando "Registro de Agente" cuando ya tienes cuenta activa.'),a.createElement("p",{className:"text-sm text-gray-700"},a.createElement("strong",null,"Solución:")," Usa el login normal con tu contraseña habitual."),a.createElement("button",{onClick:()=>t("/login"),className:"bg-red-100 text-red-700 px-4 py-2 rounded text-sm hover:bg-red-200"},"Ir al Login Normal"))),a.createElement("div",null,a.createElement("h4",{className:"text-lg font-semibold text-orange-600 mb-4"},'⚠️ "Email no encontrado en el sistema"'),a.createElement("div",{className:"space-y-3"},a.createElement("p",{className:"text-sm text-gray-700"},a.createElement("strong",null,"Causa:")," El admin no te ha creado como agente aún."),a.createElement("p",{className:"text-sm text-gray-700"},a.createElement("strong",null,"Solución:")," Contacta al administrador para que te agregue."),a.createElement("div",{className:"bg-orange-100 text-orange-700 px-3 py-2 rounded text-sm"},"📞 Contacta al administrador del sistema"))),a.createElement("div",null,a.createElement("h4",{className:"text-lg font-semibold text-blue-600 mb-4"},'🔐 "Contraseña no coincide con la temporal"'),a.createElement("div",{className:"space-y-3"},a.createElement("p",{className:"text-sm text-gray-700"},a.createElement("strong",null,"Causa:")," La contraseña que ingresaste no es la que te dio el admin."),a.createElement("p",{className:"text-sm text-gray-700"},a.createElement("strong",null,"Solución:")," Verifica las credenciales o contacta al admin."),a.createElement("div",{className:"bg-blue-100 text-blue-700 px-3 py-2 rounded text-sm"},"📝 Verifica email y contraseña temporal"))),a.createElement("div",null,a.createElement("h4",{className:"text-lg font-semibold text-green-600 mb-4"},'✅ "Ya tienes cuenta registrada"'),a.createElement("div",{className:"space-y-3"},a.createElement("p",{className:"text-sm text-gray-700"},a.createElement("strong",null,"Causa:")," Tu registro ya fue completado anteriormente."),a.createElement("p",{className:"text-sm text-gray-700"},a.createElement("strong",null,"Solución:")," Usa el login normal, no el registro."),a.createElement("button",{onClick:()=>t("/login"),className:"bg-green-100 text-green-700 px-4 py-2 rounded text-sm hover:bg-green-200"},"Ir al Login Normal"))))),a.createElement("div",{className:"bg-gradient-to-r from-blue-600 to-green-600 rounded-xl shadow-lg p-8 text-white text-center"},a.createElement("h3",{className:"text-2xl font-bold mb-4"},"¿Sigues teniendo problemas?"),a.createElement("p",{className:"text-blue-100 mb-6"},"Si después de seguir esta guía aún no puedes acceder, contacta al administrador del sistema."),a.createElement("div",{className:"space-y-2"},a.createElement("p",{className:"text-sm"},"📧 Incluye tu email en el mensaje"),a.createElement("p",{className:"text-sm"},"🔍 Describe el error específico que ves"),a.createElement("p",{className:"text-sm"},"📱 Menciona si eres agente nuevo o existente"))),a.createElement("div",{className:"text-center mt-8"},a.createElement("button",{onClick:()=>t("/"),className:"text-gray-600 hover:text-gray-800 underline"},"← Volver al inicio"))))}const lB=()=>{const[t,e]=p.useState(!1);p.useState(null);const n=[{id:"suggestion",title:"Sugerencia",description:"Comparte una idea para mejorar",icon:Pz,color:"bg-yellow-500 hover:bg-yellow-600"},{id:"complaint",title:"Reclamo",description:"Reporta un problema",icon:rT,color:"bg-red-500 hover:bg-red-600"},{id:"general",title:"Consulta",description:"Haz una pregunta",icon:jm,color:"bg-blue-500 hover:bg-blue-600"}],r=s=>{window.location.href=`/contacto?type=${s}`};return a.createElement(a.Fragment,null,a.createElement("div",{className:"fixed bottom-6 right-6 z-50"},a.createElement("button",{onClick:()=>e(!t),className:"bg-blue-600 hover:bg-blue-700 text-white rounded-full p-4 shadow-lg transition-all duration-200 hover:scale-105","aria-label":"Feedback rápido"},t?a.createElement(aT,{className:"h-6 w-6"}):a.createElement(jm,{className:"h-6 w-6"}))),t&&a.createElement("div",{className:"fixed bottom-24 right-6 z-50"},a.createElement("div",{className:"bg-white rounded-lg shadow-xl border border-gray-200 p-4 w-72"},a.createElement("div",{className:"mb-4"},a.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-2"},"¿Cómo podemos ayudarte?"),a.createElement("p",{className:"text-sm text-gray-600"},"Selecciona el tipo de mensaje que quieres enviar")),a.createElement("div",{className:"space-y-2"},n.map(s=>{const i=s.icon;return a.createElement("button",{key:s.id,onClick:()=>r(s.id),className:`w-full flex items-center p-3 rounded-lg text-white transition-colors ${s.color}`},a.createElement(i,{className:"h-5 w-5 mr-3"}),a.createElement("div",{className:"text-left"},a.createElement("div",{className:"font-medium"},s.title),a.createElement("div",{className:"text-sm opacity-90"},s.description)))})),a.createElement("div",{className:"mt-4 pt-3 border-t border-gray-200"},a.createElement("a",{href:"/contacto",className:"block w-full text-center py-2 px-4 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors"},"Ver todas las opciones"))),a.createElement("div",{className:"fixed inset-0 z-40",onClick:()=>e(!1)})))};class cB{constructor(){this.messaging=null,this.isSupported=!1,this.init()}async init(){if(this.isSupported="serviceWorker"in navigator&&"PushManager"in window,!this.isSupported){console.warn("Push notifications no soportadas en este navegador");return}try{await this.registerServiceWorker(),typeof window<"u"&&(this.messaging=VI(),this.setupMessageHandling())}catch(e){console.error("Error inicializando notificaciones:",e)}}async registerServiceWorker(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register("/sw.js");return console.log("Service Worker registrado:",e),e}catch(e){throw console.error("Error registrando Service Worker:",e),e}}async requestPermission(){if(!this.isSupported)throw new Error("Notificaciones no soportadas");const e=await Notification.requestPermission();return e==="granted"?(console.log("Permiso de notificaciones concedido"),!0):e==="denied"?(console.log("Permiso de notificaciones denegado"),!1):(console.log("Permiso de notificaciones no decidido"),!1)}async getRegistrationToken(){if(!this.messaging)throw new Error("Firebase Messaging no inicializado");try{const e=await jI(this.messaging,{vapidKey:"BEl62iUYgUivxIhf6Ydtwqr2oXIFOOcNVKqF8sD_ECGRt1Ue6kf0lKrKQK2BdHWnU_0XEU1LoXOQ"});return e?(console.log("Token de registro obtenido:",e),e):(console.log("No se pudo obtener el token de registro"),null)}catch(e){throw console.error("Error obteniendo token:",e),e}}setupMessageHandling(){this.messaging&&FI(this.messaging,e=>{console.log("Mensaje recibido en primer plano:",e),this.showForegroundNotification(e)})}showForegroundNotification(e){const{title:n,body:r,icon:s}=e.notification||{};this.showInAppNotification({title:n||"AV10 de Julio",body:r||"Nueva notificación",icon:s||"/logo192.png",data:e.data})}showInAppNotification(e){const n=document.createElement("div");n.className="fixed top-4 right-4 bg-blue-600 text-white p-4 rounded-lg shadow-lg z-50 max-w-sm",n.innerHTML=`
      <div class="flex items-start">
        <img src="${e.icon}" alt="Icon" class="w-8 h-8 mr-3 rounded">
        <div class="flex-1">
          <h4 class="font-semibold">${e.title}</h4>
          <p class="text-sm opacity-90">${e.body}</p>
        </div>
        <button class="ml-2 text-white hover:text-gray-200" onclick="this.parentElement.parentElement.remove()">
          ×
        </button>
      </div>
    `,document.body.appendChild(n),setTimeout(()=>{n.parentElement&&n.remove()},5e3)}async sendRecordatorioMantenimiento(e,n){const r={title:"🔧 Recordatorio de Mantenimiento",body:`Es hora de realizar el mantenimiento de tu ${n.marca} ${n.modelo}`,icon:"/logo192.png",data:{type:"recordatorio_mantenimiento",userId:e,vehiculoId:n.id,url:`/vehiculos/${n.id}/servicios`}};return this.sendNotification(r)}async sendEstadoSolicitud(e,n,r){const s={title:"📋 Actualización de Solicitud",body:`Tu solicitud de ${n} ha sido ${r}`,icon:"/logo192.png",data:{type:"estado_solicitud",userId:e,solicitudTipo:n,estado:r,url:"/dashboard"}};return this.sendNotification(s)}async sendNuevaEmpresaAsignada(e,n){const r={title:"🏢 Nueva Empresa Asignada",body:`Se te ha asignado ${n.nombre} para validación`,icon:"/logo192.png",data:{type:"nueva_empresa_asignada",agenteId:e,empresaId:n.id,url:"/dashboard/agente"}};return this.sendNotification(r)}async sendNotification(e){this.isSupported&&Notification.permission==="granted"&&new Notification(e.title,{body:e.body,icon:e.icon,data:e.data})}async subscribeUser(e,n){try{if(!await this.requestPermission())throw new Error("Permisos de notificación no concedidos");const s=await this.getRegistrationToken();if(!s)throw new Error("No se pudo obtener token de registro");return await this.saveTokenToFirestore(e,s,n),{success:!0,token:s}}catch(r){return console.error("Error suscribiendo usuario:",r),{success:!1,error:r.message}}}async saveTokenToFirestore(e,n,r){const{doc:s,setDoc:i,getFirestore:o}=await zg(()=>import("./index.esm-92972791.js"),[]),l=o(),c={token:n,userId:e,userType:r,createdAt:new Date,active:!0,platform:this.getPlatform()};await i(s(l,"push_tokens",`${e}_${n.slice(-10)}`),c)}getPlatform(){const e=navigator.userAgent;return/android/i.test(e)?"android":/iPad|iPhone|iPod/.test(e)?"ios":"web"}async unsubscribeUser(e){try{const{collection:n,query:r,where:s,getDocs:i,updateDoc:o,getFirestore:l}=await zg(()=>import("./index.esm-92972791.js"),[]),c=l(),u=n(c,"push_tokens"),d=r(u,s("userId","==",e),s("active","==",!0)),g=(await i(d)).docs.map(v=>o(v.ref,{active:!1,unsubscribedAt:new Date}));return await Promise.all(g),{success:!0}}catch(n){return console.error("Error desuscribiendo usuario:",n),{success:!1,error:n.message}}}}const Fi=new cB;function uB(){const{user:t}=Qe(),[e,n]=p.useState(!1),[r,s]=p.useState(!1),[i,o]=p.useState("default");p.useEffect(()=>{"Notification"in window&&o(Notification.permission),l()},[t]);const l=async()=>{if(t)try{const f=localStorage.getItem(`notifications_${t.uid}`);n(f==="true")}catch(f){console.error("Error verificando estado de suscripción:",f)}},c=async()=>{if(!t){alert("Debes estar logueado para recibir notificaciones");return}s(!0);try{const f=await Fi.subscribeUser(t.uid,t.rol);if(f.success)n(!0),o("granted"),localStorage.setItem(`notifications_${t.uid}`,"true"),Fi.showInAppNotification({title:"🔔 Notificaciones Activadas",body:"Ahora recibirás notificaciones importantes sobre tu cuenta",icon:"/logo192.png"});else throw new Error(f.error)}catch(f){console.error("Error suscribiendo a notificaciones:",f),alert("Error al activar notificaciones: "+f.message)}s(!1)},u=async()=>{if(t){s(!0);try{const f=await Fi.unsubscribeUser(t.uid);if(f.success)n(!1),localStorage.removeItem(`notifications_${t.uid}`),Fi.showInAppNotification({title:"🔕 Notificaciones Desactivadas",body:"Ya no recibirás notificaciones push",icon:"/logo192.png"});else throw new Error(f.error)}catch(f){console.error("Error desuscribiendo notificaciones:",f),alert("Error al desactivar notificaciones: "+f.message)}s(!1)}},d=f=>{const g={cliente:["🔧 Recordatorios de mantenimiento","📋 Estado de solicitudes","🏪 Nuevos proveedores en tu área","💰 Ofertas especiales"],proveedor:["📬 Nuevas solicitudes de clientes","📊 Reportes de rendimiento","🎯 Nuevas campañas disponibles","✅ Estado de validaciones"],agente:["🏢 Nuevas empresas asignadas","📍 Recordatorios de visitas","📊 Reportes de actividad","🎯 Objetivos y metas"],admin:["🚨 Alertas del sistema","📈 Reportes automáticos","👥 Actividad de usuarios","🔄 Estados de procesos"]};return g[f]||g.cliente};return Fi.isSupported?i==="denied"?a.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4"},a.createElement("div",{className:"flex"},a.createElement("div",{className:"flex-shrink-0"},a.createElement("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},a.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))),a.createElement("div",{className:"ml-3"},a.createElement("p",{className:"text-sm text-red-700"},"Las notificaciones están bloqueadas. Para habilitarlas, ve a la configuración de tu navegador.")))):a.createElement("div",{className:"bg-white rounded-lg border border-gray-200 p-6"},a.createElement("div",{className:"flex items-center justify-between mb-4"},a.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"🔔 Notificaciones Push"),a.createElement("div",{className:"flex items-center"},e?a.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},"Activas"):a.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},"Inactivas"))),a.createElement("div",{className:"mb-4"},a.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Recibe notificaciones importantes directamente en tu dispositivo:"),a.createElement("ul",{className:"text-sm text-gray-600 space-y-1"},d(t==null?void 0:t.rol).map((f,g)=>a.createElement("li",{key:g,className:"flex items-start"},a.createElement("span",{className:"mr-2"},"•"),a.createElement("span",null,f))))),a.createElement("div",{className:"flex space-x-3"},e?a.createElement("button",{onClick:u,disabled:r,className:"flex-1 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"},r?a.createElement("div",{className:"flex items-center justify-center"},a.createElement("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},a.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),"Desactivando..."):"Desactivar Notificaciones"):a.createElement("button",{onClick:c,disabled:r,className:"flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"},r?a.createElement("div",{className:"flex items-center justify-center"},a.createElement("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},a.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),"Activando..."):"Activar Notificaciones"),e&&a.createElement("button",{onClick:()=>{Fi.showInAppNotification({title:"🧪 Notificación de Prueba",body:"Esta es una notificación de prueba para verificar el funcionamiento del sistema",icon:"/logo192.png"})},className:"px-3 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg text-sm font-medium transition-colors"},"Prueba")),i==="default"&&a.createElement("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg"},a.createElement("p",{className:"text-xs text-blue-700"},"💡 ",a.createElement("strong",null,"Tip:"),' Al activar las notificaciones, tu navegador te pedirá permiso. Asegúrate de hacer clic en "Permitir" para recibir las notificaciones.'))):a.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},a.createElement("div",{className:"flex"},a.createElement("div",{className:"flex-shrink-0"},a.createElement("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},a.createElement("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"}))),a.createElement("div",{className:"ml-3"},a.createElement("p",{className:"text-sm text-yellow-700"},"Las notificaciones push no están disponibles en este navegador."))))}const dB=[{nombre:"Mapfre",logo:"/images/mapfre-logo.png",rating:4.2,factor:1,descripcion:"Seguro automotriz completo con cobertura nacional",cobertura:["Responsabilidad Civil","Daños Propios","Robo","Incendio"],telefono:"+56 2 2000 0000",email:"contacto@mapfre.cl",sitioWeb:"https://www.mapfre.cl"},{nombre:"Zurich",logo:"/images/zurich-logo.png",rating:4.5,factor:1.1,descripcion:"Seguros premium con servicio de asistencia 24/7",cobertura:["Responsabilidad Civil","Daños Propios","Robo","Incendio","Fenómenos Naturales"],telefono:"+56 2 2100 0000",email:"seguros@zurich.cl",sitioWeb:"https://www.zurich.cl"},{nombre:"Liberty",logo:"/images/liberty-logo.png",rating:4,factor:.95,descripcion:"Seguros accesibles con planes flexibles",cobertura:["Responsabilidad Civil","Daños Propios","Robo"],telefono:"+56 2 2200 0000",email:"info@liberty.cl",sitioWeb:"https://www.liberty.cl"}],mB=[{nombre:"PRT Santiago Centro",direccion:"Av. Libertador Bernardo O'Higgins 1234",comuna:"Santiago",region:"RM",telefono:"+56 2 2300 0000",rating:4.3,precioBase:25e3,tiempoPromedio:45,horarios:"L-V 8:00-18:00, S 8:00-14:00",servicios:["Revisión Anual","Revisión Semestral","Primera Vez","Reinspección"],latitud:-33.4489,longitud:-70.6693},{nombre:"Centro Técnico Las Condes",direccion:"Av. Apoquindo 5678",comuna:"Las Condes",region:"RM",telefono:"+56 2 2400 0000",rating:4.6,precioBase:28e3,tiempoPromedio:40,horarios:"L-V 8:30-19:00, S 9:00-15:00",servicios:["Revisión Anual","Revisión Semestral","Primera Vez","Reinspección","Gases"],latitud:-33.415,longitud:-70.5747},{nombre:"Revisión Técnica Maipú",direccion:"Av. Pajaritos 9876",comuna:"Maipú",region:"RM",telefono:"+56 2 2500 0000",rating:4.1,precioBase:23e3,tiempoPromedio:50,horarios:"L-V 8:00-17:30, S 8:30-13:00",servicios:["Revisión Anual","Revisión Semestral","Primera Vez"],latitud:-33.5123,longitud:-70.7507}],pB=[{nombre:"Vulcanización Express",direccion:"Av. Grecia 1234",comuna:"Ñuñoa",telefono:"+56 9 8765 4321",rating:4.4,precioBase:15e3,tiempoRespuesta:15,horarios:"L-D 8:00-22:00",emergencia24h:!0,servicioDomicilio:!0,promociones:!0,servicios:["parche","cambio_neumatico","balanceado","alineacion","valvula"],precios:{parche:8e3,cambio_neumatico:5e3,balanceado:12e3,alineacion:25e3,valvula:3e3},latitud:-33.4569,longitud:-70.5874},{nombre:"Neumáticos del Sur",direccion:"Av. Vicuña Mackenna 5678",comuna:"La Florida",telefono:"+56 9 7654 3210",rating:4.2,precioBase:12e3,tiempoRespuesta:20,horarios:"L-S 8:30-20:00",emergencia24h:!1,servicioDomicilio:!0,promociones:!1,servicios:["parche","cambio_neumatico","balanceado","rotacion"],precios:{parche:7e3,cambio_neumatico:4500,balanceado:1e4,rotacion:8e3},latitud:-33.5206,longitud:-70.5986},{nombre:"Vulca Rápido 24H",direccion:"Av. Providencia 9876",comuna:"Providencia",telefono:"+56 9 6543 2109",rating:4.7,precioBase:18e3,tiempoRespuesta:10,horarios:"24 horas",emergencia24h:!0,servicioDomicilio:!0,promociones:!0,servicios:["parche","cambio_neumatico","balanceado","alineacion","valvula","rotacion"],precios:{parche:1e4,cambio_neumatico:6e3,balanceado:15e3,alineacion:3e4,valvula:4e3,rotacion:12e3},latitud:-33.4255,longitud:-70.6118}],fB=[{nombre:"Responsabilidad Civil",descripcion:"Cobertura obligatoria por daños a terceros",obligatorio:!0},{nombre:"Daños Propios",descripcion:"Cobertura para daños en tu propio vehículo",obligatorio:!1},{nombre:"Robo e Incendio",descripcion:"Protección contra robo total y daños por incendio",obligatorio:!1},{nombre:"Fenómenos Naturales",descripcion:"Cobertura para daños por terremotos, inundaciones, etc.",obligatorio:!1}],hB=async()=>{try{if(console.log("Inicializando datos de servicios..."),(await ue(Q($,"companias_seguros"))).empty){console.log("Agregando compañías de seguros...");for(const s of dB)await ze(Q($,"companias_seguros"),s)}if((await ue(Q($,"centros_revision"))).empty){console.log("Agregando centros de revisión técnica...");for(const s of mB)await ze(Q($,"centros_revision"),s)}if((await ue(Q($,"vulcanizadoras"))).empty){console.log("Agregando vulcanizadoras...");for(const s of pB)await ze(Q($,"vulcanizadoras"),s)}if((await ue(Q($,"tipos_seguros"))).empty){console.log("Agregando tipos de seguros...");for(const s of fB)await ze(Q($,"tipos_seguros"),s)}return console.log("Datos de servicios inicializados correctamente"),!0}catch(t){return console.error("Error inicializando datos de servicios:",t),!1}};function gB(){const[t,e]=p.useState(null),[n,r]=p.useState(null),[s,i]=p.useState(!0);return p.useEffect(()=>{hB();const o=ab(Fn,l=>{if(e(l),l){const c=Q($,"usuarios"),u=Dt(c,d=>{const g=d.docs.map(v=>({id:v.id,...v.data()})).find(v=>v.uid===l.uid||v.email===l.email);r(g),i(!1)});return()=>u()}else r(null),i(!1)});return()=>o()},[]),s?a.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gray-50"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),a.createElement("p",{className:"mt-4 text-gray-600"},"Cargando AV10 de Julio..."))):a.createElement(lz,null,a.createElement(bz,null,a.createElement("div",{className:"min-h-screen bg-gray-50"},t&&a.createElement(uB,{user:t}),a.createElement(Sb,null,a.createElement(Ie,{path:"/",element:a.createElement(Fw,null)}),a.createElement(Ie,{path:"/login",element:a.createElement(Kz,null)}),a.createElement(Ie,{path:"/dashboard",element:a.createElement(hh,null,a.createElement(J7,null))}),a.createElement(Ie,{path:"/admin/*",element:a.createElement(hh,null,a.createElement(Db,null,a.createElement(G7,null)))}),a.createElement(Ie,{path:"/agente/*",element:a.createElement(hh,null,a.createElement(Q7,null))}),a.createElement(Ie,{path:"/registro-cliente",element:a.createElement(Z7,null)}),a.createElement(Ie,{path:"/registro-pyme",element:a.createElement(wN,null)}),a.createElement(Ie,{path:"/registro-proveedor",element:a.createElement(wN,null)}),a.createElement(Ie,{path:"/registro-agente",element:a.createElement(X7,null)}),a.createElement(Ie,{path:"/debug-agentes",element:a.createElement(sB,null)}),a.createElement(Ie,{path:"/debug-sesion-agente",element:a.createElement(iB,null)}),a.createElement(Ie,{path:"/ayuda-agentes",element:a.createElement(oB,null)}),a.createElement(Ie,{path:"/solicitud-comunidad",element:a.createElement(eB,null)}),a.createElement(Ie,{path:"/proveedores",element:a.createElement(nB,null)}),a.createElement(Ie,{path:"/proveedores-locales",element:a.createElement(rB,null)}),a.createElement(Ie,{path:"/empresa/:empresaId",element:a.createElement(aB,null)}),a.createElement(Ie,{path:"*",element:a.createElement(Fw,null)})),a.createElement(lB,null))))}class vB extends a.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("ErrorBoundary atrapó un error:",e,n)}render(){var e;return this.state.hasError?a.createElement("div",{className:"p-8 text-center text-red-700"},a.createElement("h1",null,"¡Algo salió mal!"),a.createElement("p",null,(e=this.state.error)==null?void 0:e.toString())):this.props.children}}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registrado con éxito:",t)}).catch(t=>{console.log("SW registración falló:",t)})});gh.createRoot(document.getElementById("root")).render(a.createElement(vB,null,a.createElement(gB,null)));export{Q as $,pk as A,ui as B,Fr as C,Ot as D,x9 as E,wi as F,Fv as G,E9 as H,wB as I,or as J,v3 as K,y3 as L,ze as M,KB as N,QB as O,U3 as P,cn as Q,zB as R,kB as S,Nt as T,m9 as U,Pp as V,F3 as W,d9 as X,GB as Y,PB as Z,rS as _,Vc as a,CB as a0,b3 as a1,I3 as a2,y9 as a3,ws as a4,u9 as a5,DB as a6,b9 as a7,we as a8,jB as a9,VB as aA,Dt as aB,t9 as aC,FB as aD,Et as aE,i9 as aF,o9 as aG,V3 as aH,pe as aI,X2 as aJ,SB as aK,c9 as aL,qn as aM,Jx as aN,h9 as aO,bB as aP,JB as aQ,BB as aR,$B as aS,HB as aT,MB as aU,Me as aV,f9 as aW,RB as aX,fe as aY,fk as aZ,TB as aa,AB as ab,LB as ac,v9 as ad,WB as ae,qB as af,St as ag,fu as ah,A3 as ai,n9 as aj,di as ak,YB as al,ZB as am,ue as an,XB as ao,e9 as ap,E3 as aq,g9 as ar,p9 as as,IB as at,jo as au,UB as av,OB as aw,r9 as ax,s9 as ay,a9 as az,x3 as b,Fo as c,_i as d,it as e,te as f,el as g,mu as h,Md as i,jp as j,pu as k,Op as l,Kv as m,zo as n,Vp as o,Bs as p,z3 as q,Tt as r,ni as s,de as t,EB as u,uD as v,vt as w,w9 as x,Ue as y,yB as z};
